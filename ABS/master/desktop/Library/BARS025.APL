.head 0 +  Application Description:
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B10000 002C000000020000 0003000000000000 0005020000FCFFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773034B50
0080: 4B
.enddata
.data DT_MAKERUNDLG
0000: 02000000001D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0020: 6578651D513A5C42 41525339385C4C49 42524152595C4241 52533031352E646C
0040: 6C1D513A5C424152 5339385C4C494252 4152595C42415253 3031352E61706300
0060: 000101011D513A5C 4241525339385C4C 4942524152595C42 4152533031352E72
0080: 756E1D513A5C4241 525339385C4C4942 524152595C424152 533031352E646C6C
00A0: 1D513A5C42415253 39385C4C49425241 52595C4241525330 31352E6170630000
00C0: 010101175C424152 5339385C42494E5C 424152533032352E 617064175C424152
00E0: 5339385C42494E5C 424152533031352E 646C6C175C424152 5339385C42494E5C
0100: 424152533031352E 6170630000010101 1D513A5C42415253 39385C4C49425241
0120: 52595C4241525330 31352E61706C1D51 3A5C424152533938 5C4C494252415259
0140: 5C42415253303135 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42
0160: 4152533031352E61 70630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: Bars010.apd
.head 2 -  Dynalib: Bars017.apd
.head 2 -  !
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: Docwis6.apl
.head 2 -  ! File Include: Docfun6.apl
.head 2 -  File Include: Winapi.apl
.head 2 -  File Include: Xsalcpt.apl
.head 2 -  File Include: vttblwin.apl
.head 2 -  File Include: Vtmeter.apl
.head 2 -  File Include: vtdos.apl
.head 2 -  File Include: Vtfile.apl
.head 2 -  File Include: Genlabel.apl
.head 2 -  File Include: XSALIMG.APL
.head 2 -  File Include: qckdvc.apl
.head 2 -  File Include: XSALSPL.APL
.head 2 -  File Include: Vtcomm.apl
.head 2 -  File Include: Vtcal.apl
.head 2 -  File Include: signfile.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Number: #################
.head 3 -  Number: #000
.head 3 -  Number: #00000
.head 3 -  Date/Time: dd/MM/yyyy hhhh:mm:ss
.head 2 +  External Functions
.head 3 +  ! Library name: IctBob.Dll
.head 4 +  Function: llopen
.head 5 -  Description: открытие файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns 
.head 6 -  Number: HANDLE
.head 5 +  Parameters 
.head 6 -  ! первый параметр: имя файла, второй: тип открытия
.head 6 -  String: LPCSTR
.head 6 -  Number: INT
.head 4 +  ! Function: llcreat
.head 5 -  Description: создание файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns 
.head 6 -  Number: HANDLE
.head 5 +  Parameters 
.head 6 -  ! первый параметр: имя файла, второй: тип открытия
.head 6 -  String: LPCSTR
.head 6 -  Number: INT
.head 4 +  Function: llclose
.head 5 -  Description: закрытие файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns 
.head 6 -  Number: HANDLE
.head 5 +  Parameters 
.head 6 -  Number: HANDLE
.head 4 +  ! Function: llread
.head 5 -  Description: чтение файла (C++)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns 
.head 6 -  Number: UINT
.head 5 +  Parameters 
.head 6 -  Number: HANDLE
.head 6 -  String: LPVOID
.head 6 -  Number: UINT
.head 4 +  Function: llwrite
.head 5 -  Description: 
.head 5 -  Export Ordinal: 0
.head 5 +  Returns 
.head 6 -  Number: UINT
.head 5 +  Parameters 
.head 6 -  Number: HANDLE
.head 6 -  String: LPCSTR
.head 6 -  Number: UINT
.head 4 +  Function: lllseek
.head 5 -  Description: 
.head 5 -  Export Ordinal: 0
.head 5 +  Returns 
.head 6 -  Number: LONG
.head 5 +  Parameters 
.head 6 -  Number: HANDLE
.head 6 -  Number: LONG
.head 6 -  Number: INT
.head 4 +  ! Function: llstr2str
.head 5 -  Description: преобразование строки HEXtoBIN
.head 5 -  Export Ordinal: 0
.head 5 -  Returns 
.head 5 +  Parameters 
.head 6 -  String: LPSTR
.head 6 -  Receive String: LPVOID
.head 6 -  Number: ULONG
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  String: ApdNum   =  '25'
.head 4 -  String: ApdVer   =  '01'
.head 4 -  !
.head 4 -  Number: RB_NOTUSE_RF   =  1 ! не использовать РФ
.head 4 -  Number: RB_USE_RF   =  2 ! Использовать РФ
.head 4 -  Number: RB_CANCEL_NETTO_KR   =  3 ! Остновить нетто-кредит
.head 4 -  ! История изменений: -----------------------------------------------------|
.head 4 -  ! 06 31-01-02  NATA    Добавила кнопку "Підкріплення з котлових"
.head 4 -  !
.head 4 -  ! Для формирование отчетов из форм.
.head 4 -  Number: REPORT_RB_KS  = 1 !! Отчет для модуля расчетный банк НБУ- состояние коррсчета
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 2157703476
0000: A00000003D000000 0000000000000000 0200000600000006 010000E0010D0000
0020: 00FF3F1301820002 04000000FFFFE817 010002FE00FFA31B 010002FB00FF8F1F
0040: 0100EE0200FF3F23 01BA000200FFFF
.enddata
.head 3 -  Number: nFetchRes
.head 3 -  Number: nHaveTOBO
.head 3 -  !
.head 3 -  Window Handle: hWin0
.head 3 -  Window Handle: hWin1
.head 3 -  Window Handle: hWin10
.head 3 -  Window Handle: hWin11
.head 3 -  Window Handle: hWin12
.head 3 -  Window Handle: hWin14
.head 3 -  Window Handle: hWin97
.head 3 -  Window Handle: hWin96
.head 3 -  Window Handle: hWin98 
.head 3 -  Window Handle: hWin28
.head 3 -  Window Handle: hWin29
.head 3 -  Window Handle: hWin30
.head 3 -  ! Window Handle: hWin_CCK
.head 3 -  !
.head 3 -  Boolean: bFormulaSum
.head 3 -  Boolean: bEnableTbl
.head 3 -  Boolean: bApdInited
.head 2 +  Internal Functions
.head 3 +  Function: Sel025	! __exported
.head 4 -  Description: Bars025_Selector
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call Ini025()
.head 5 -  Set nHaveTOBO = GetGlobalOptionEx('HAVETOBO')
.head 5 +  Select Case nMode
.head 6 -  ! резерфный фонд
.head 6 +  Case 0
.head 7 +  If not IsWindow(hWin0)
.head 8 -  Set hWin0 = SalCreateWindow(RB_MFO, hWndParent,nPar, strPar01,strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(RB_MFO)
.head 7 -  Break
.head 6 -  ! нетто (дебет nPar=-1, кредит nPar=1)
.head 6 +  Case 1
.head 7 +  If nPar = 1 OR nPar = -1
.head 8 +  If not IsWindow(hWin1)
.head 9 -  Set hWin1 = SalCreateWindow(RB_NET, hWndParent, nPar, strPar01, strPar02)
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop (RB_NET)
.head 7 +  Else
.head 8 +  If nPar = 2 ! Перегляд стану коррахунків
.head 9 +  If not IsWindow(hWin1)
.head 10 -  Set hWin1 = SalCreateWindow(rbKS, hWndParent)
.head 9 +  Else
.head 10 -  Call SalBringWindowToTop(rbKS)
.head 7 -  Break
.head 6 +  Case 10
.head 7 +  If not IsWindow(hWin10)
.head 8 -  Set hWin10 = SalCreateWindow(wLom, hWndParent, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(wLom)
.head 7 -  Break
.head 6 +  Case 11
.head 7 +  If not IsWindow(hWin11)
.head 8 -  Set hWin11 = SalCreateWindow(zLom, hWndParent, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (zLom)
.head 7 -  Break
.head 6 +  Case 12
.head 7 +  If not IsWindow(hWin12)
.head 8 -  Set hWin12 = SalCreateWindow(ImpCostMet, hWndParent, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(ImpCostMet)
.head 7 -  Break
.head 6 +  Case 14
.head 7 +  If not IsWindow(hWin14)
.head 8 -  Set hWin14 = SalCreateWindow(LO4, hWndParent, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(LO4)
.head 7 -  Break
.head 6 +  Case 25  ! формирование SKUPKA.DBF
.head 7 -  Call SalModalDialog(dlgFormSkupka, hWndParent, strPar01, strPar02)
.head 7 -  Break
.head 6 +  Case 28  ! импорт коммунальные платежи MAJAR
.head 7 +  If not IsWindow(hWin28)
.head 8 -  Set hWin28 = SalCreateWindow(kp_MAJAR, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(kp_MAJAR)
.head 7 -  Break
.head 6 +  Case 29  ! импорт коммунальные платежи UTEL
.head 7 +  If not IsWindow(hWin29)
.head 8 -  Set hWin29 = SalCreateWindow(kp_UTEL, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(kp_UTEL)
.head 7 -  Break
.head 6 +  Case 30  ! импорт DBF для коммунальных платежей и не только
.head 7 -  Call SalModalDialog(dlg_LoadDbf, hWndParent, strPar01, strPar02)
.head 7 +  ! If not IsWindow(hWin30)
.head 8 -  Set hWin30 = SalCreateWindow(frm_LoadDbf, hWndParent, strPar01, strPar02)
.head 7 +  ! Else
.head 8 -  Call SalBringWindowToTop(dlg_LoadDbf)
.head 7 -  Break
.head 6 +  Case 96  ! Курсы пок-прод по ТОБО
.head 7 +  If not IsWindow(hWin96)
.head 8 -  Set hWin96 = SalCreateWindow(KPK, hWndParent, nMode, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(KPK)
.head 7 -  Break
.head 6 +  Case 97  ! Прямой ввод в папки (так назіваеміе ком.платежи в АЖИО) в тек день
.head 7 +  If not IsWindow(hWin97)
.head 8 -  Set hWin97 = SalCreateWindow(KP, hWndParent, nMode, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(KP)
.head 7 -  Break
.head 6 +  Case 197 ! Прямой ввод в папки (так назіваеміе ком.платежи в АЖИО) в БУД день
.head 7 +  If not IsWindow(hWin97)
.head 8 -  Set hWin97 = SalCreateWindow(KP, hWndParent, nMode, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(KP)
.head 7 -  Break
.head 6 +  Case 297 ! Погашення кредиту готівкою
.head 7 +  ! If not IsWindow(hWin_CCK)
.head 8 -  Set hWin_CCK = SalCreateWindow(CCK, hWndParent, nMode, nPar, strPar01, strPar02)
.head 7 +  ! Else
.head 8 -  Call SalBringWindowToTop (hWin_CCK)
.head 7 -  Call Sel017(hWndMDI, NUMBER_Null, nMode, nPar, strPar01, strPar02, NUMBER_Null)
.head 7 -  Break
.head 6 +  Case 98
.head 7 +  If not IsWindow(hWin98)
.head 8 -  Set hWin98 = SalCreateWindow(PO, hWndParent, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(PO)
.head 7 -  Break
.head 3 +  Function: num_to_str_point
.head 4 -  Description: Функция преобразования числа в строку. В качестве разделителя использует точку!
.head 4 +  Returns
.head 5 -  String: Out_Num
.head 4 +  Parameters
.head 5 -  Number: Inp_Num
.head 5 -  Number: Aft_Pnt
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: tmp
.head 4 +  Actions
.head 5 +  If Inp_Num = NUMBER_Null
.head 6 -  Set Inp_Num = 0
.head 5 -  Set tmp = SalNumberToStrX(Inp_Num, Aft_Pnt)
.head 5 -  Return SalStrLeftX(tmp, SalStrLength(tmp) - (Aft_Pnt+1)) || '.' || SalStrRightX(tmp, Aft_Pnt)
.head 3 +  Function: Ini025
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not bApdInited
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars025.lng"
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 6 -  Call DocWisInit( 'Vkv' )
.head 6 -  ! ! ====================================================
.head 6 -  ! ! dlg_LoadDbf
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTWndTitle','Загрузка файла')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.pbRun','Выполнить')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.pbExit','Отменить')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.pbChoose','Выбрать...')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cbTransCode','Перекодировать из кодировки OEM (DOS) в ANSI (WIN)')
.head 6 -  ! !
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTBtnDelNew','НОВАЯ')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTBtnNoDelNew','ЗАМЕНА')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTBtnNo','ОТКАЗ')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTBtnNoDelPlusNew1','НОВЫЕ ДАННЫЕ')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTBtnNoDelPlusNew2','ДОБАВИТЬ')
.head 6 -  ! ! Msg
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsgTable','Таблица')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg11','уже существует (пустая) !')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg12','Удалить таблицу')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg13','и создать НОВУЮ ?')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg21','уже существует c данными !')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg22','Удалить таблицу и создать НОВУЮ')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg23','НЕ удалять таблицу, УДАЛИТЬ старые данные')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg24','НЕ удалять таблицу, добавить ТОЛЬКО НОВЫЕ данные')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsg25','НЕ удалять таблицу, добавить ВСЕ данные')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsgDel','Невозможно удалить записи из таблицы')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTMsgFileOk','Обработка файла завершена!')
.head 6 -  ! ! Err
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTErrDir','Не удалось переити в каталог')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTErrDB','Нет доступа к базе данных')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTErrFileOpen','Не удалось открыть файл')
.head 6 -  ! ! Constant
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTLoadFile','Загрузка файла')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTConfirm','Подтверждение')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTQuery','ЗАПРОС')
.head 6 -  Call CurrentLangTable.AddAtom('dlg_LoadDbf.cTLoad','Загрузка')
.head 6 -  ! ! ====================================================
.head 6 -  Set bApdInited = TRUE
.head 5 -  Return bApdInited
.head 3 +  Function: ShowApdVersion
.head 4 -  Description: Показать версию APD
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sWin
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strText
.head 5 -  Number: nLength
.head 4 +  Actions
.head 5 -  Call SalStrSetBufferLength( strText, 160 )
.head 5 -  Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
.head 5 -  Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 641414869
0000: E4030000CA010000 0000000000000000 0200000600FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F61003C00 000B5F005F457272
0040: 6F72426100736556 0100000D003C0000 010DFA0000FF6F0D 00EE0100FF3F1A00
0060: B800000100FFFFE0 2700000001FE00FF 03340000000204F8 000000FF0F380000
0080: 00EE0200FF3F3C00 B800000200FFFF80 40000000030400FE 00FF834400000002
00A0: FB00FF0F48000000 EE0200FF3F4C00B8 00000300FFFFE050 00000003FE00FF83
00C0: 5400000001FB00FF 0F01800D00110001 0000065F005F466C 61671E0000EC0001
00E0: 00D9010D00FF7F01 08801A0000020000 00000B6351756963 6B805461626C6538
0100: 00EC000200D9010D 00FF7F0D73000100 FFFF0101804E0000 0003000000000963
0120: 536967006E46696C 65A00000E0000600 0000D9010D00FF7F 0D73000100FFFFCD
0140: 1A0001FD00FF3727 0001F700FFDF34DC 000100FF7F417000 00000100FFFF0101
0160: 8022000000040200 000A6347656E0646 7465727400D80000 04003302040001FA
0180: 0000078001000000 FFC60400010DFE00 FF831100000002FB 00FF0F15000000EE
01A0: 0100FF3F01800622 00050000001A0B47 4446697F00F60400 8E02000100FE00C9
01C0: 80010000BF04B100 010D00FFFFE61100 02FE00FF9B150001 FB00FF0F
.enddata
.head 3 +  ! Functional Class: cDocPerekryt
.winattr
.end
.head 4 -  Description: 
.head 4 +  Derived From 
.head 5 -  Class: cDoc
.head 4 -  Class Variables 
.head 4 +  Instance Variables 
.head 5 -  Boolean: bSignInit
.head 4 +  Functions 
.head 5 +  Function: sIni
.head 6 -  Description: Инициализировать ЭЦП
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 +  Static Variables 
.head 7 -  ! Boolean: bSignInited
.head 7 -  ! Number: nTim
.head 6 +  Local variables 
.head 7 -  ! String: strUxDateTime
.head 7 -  String: strDay
.head 7 -  Number: nDay
.head 7 -  Number: nErrorSign
.head 7 -  String: strErrorSign
.head 7 -  String: strPinCode
.head 6 -  Actions 
.head 3 +  Functional Class: cDoc_KP_SIGN
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cDoc
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: NLS_CASH
.head 5 -  String: NLS_NLK
.head 5 -  Number: FLI       ! флаг межбанк
.head 4 +  Functions
.head 5 +  Function: pLnk
.head 6 -  Description: Оплата связанных транзакций
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nFlgBlank ! Пустой параметр
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If m_nPyD and (m_nFlg=1 or m_nFlg=2)   ! Визируем только f38 1 и 2
.head 8 +  If not Pay(2,m_nRef,m_dDatV1,'',NUMBER_Null,NUMBER_Null,'',NUMBER_Null,NUMBER_Null,'')
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: iDoc
.head 6 -  Description: Временная блокировка оплаті по факту
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set cDoc.m_nPyD=0   ! Запретить оплату по факт остатку
.head 7 -  Return cDoc.iDoc()
.head 5 +  Function: oDoc
.head 6 -  Description: Оплатить документ 
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  While TRUE
.head 8 +  If cDoc.oDoc()
.head 9 +  If FLI = 1
.head 10 +  If not 
 cDoc.PayV
(0, cDoc.m_nRef, cDoc.m_dDatV1, cDoc.m_sTT, 1,
 cDoc.A.Kv, NLS_CASH, cDoc.A.S, 
 cDoc.B.Kv, NLS_NLK,  cDoc.B.S)
.head 11 -  Break
.head 9 +  If cDoc.m_nFlg = 1 
.head 10 +  If not cDoc.P_Fac(cDoc.m_nRef, SalFmtFormatDateTime(cDoc.m_dDatV1, 'MM-dd-yyyy'))
.head 11 -  Break
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 3 +  Functional Class: cDoc_KP_nSIGN
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cDoc
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: NLS_CASH
.head 5 -  String: NLS_NLK
.head 5 -  Number: FLI       ! флаг межбанк
.head 4 +  Functions
.head 5 +  Function: pLnk
.head 6 -  Description: Оплата связанных транзакций
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nFlgBlank ! Пустой параметр
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If m_nPyD and (m_nFlg=1 or m_nFlg=2)   ! Визируем только f38 1 и 2
.head 8 +  If not Pay(2,m_nRef,m_dDatV1,'',NUMBER_Null,NUMBER_Null,'',NUMBER_Null,NUMBER_Null,'')
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: cPushButtonLabeled
.head 3 -  Radio Button: cRadioButtonLabeled
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table: cQuickTable
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cXSalHSplitter
.head 2 -  Application Actions
.head 1 +  Table Window: RB_MFO
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Створення резерву 
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.175"
.head 4 -  Top:    0.719"
.head 4 -  Width:  13.05"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Добавити новий запис'
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Вилучити запис'
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.817"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перечитати'
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.783"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Зберегти ручні зміни'
.head 4 -  Line
.head 5 -  Resource Id: 33696
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.333"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Знайти запис по контексту'
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.85"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Відфільтрувати потрібні записи'
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.767"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.367"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Надрукувати таблицю'
.head 4 -  Line
.head 5 -  Resource Id: 33697
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Завершити'
.head 4 -  Line
.head 5 -  Resource Id: 33698
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pb_Run
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.267"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Виконати розрахунок автоматично'
.head 6 +  On SAM_Click
.head 7 -  ! изменили сумму фонда через процедуру
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 8 +  If SqlPLSQLCommand(hSql(), "RB.REZ (RB_MFO.dDat ) " )
.head 9 -  Call SqlCommit( hSql() )
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call MessageNoWait( 'Ошибка при выполнении процедуры !',"RB.REZ" , 30, 1 )
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbDoc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.3"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Tomail.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Виставити інформаційний дебет на поповнення резерву'
.head 6 +  On SAM_Click
.head 7 -  ! последняя перечитка для проверки на повторный пуск с двух станций (окон)
.head 7 +  If SqlPrepareAndExecute( hSql(),
   "SELECT ref FROM oper where tt='RID' and dk=2 and sos >=0 and VDAT=:RB_MFO.dDat")
and not SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set RB_MFO.nRow = TBL_MinRow
.head 8 -  ! залочились до commit (roll)
.head 8 +  If SqlPrepareAndExecute( hSql(),"SELECT nlsb FROM RB_MFO FOR UPDATE OF nlsb NOWAIT" )
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Set RB_MFO.bOPL = TRUE
.head 9 +  While SalTblFindNextRow( hWndForm, RB_MFO.nRow, 0 , 0 )
.head 10 -  Call SalTblSetContext( hWndForm, RB_MFO.nRow )
.head 10 +  If RB_MFO.bOPL 
.head 11 +  If RB_MFO.REZ > RB_MFO.OSTC
.head 12 -  Set RB_MFO.nS = RB_MFO.REZ - RB_MFO.OSTC
.head 12 -  Set RB_MFO.REF = NUMBER_Null
.head 12 -  Call cDoc.SetDoc( RB_MFO.REF, 'RID', 2, 2, Str(RB_MFO.REF),
     RB_MFO.dDat, RB_MFO.dDat, RB_MFO.dDat, RB_MFO.dDat,
     RB_MFO.NLSF,  Subs(GetBankName(),1,38) ,
     GetBankMfo(), '', RB_MFO.n980, RB_MFO.nS, GetBankOkpoS(), 
     RB_MFO.NLSFB, Subs(RB_MFO.NAME,1,38),
     RB_MFO.MFO,   '', RB_MFO.n980, RB_MFO.nS, RB_MFO.OKPOB,
    'Поповнення резервного фонду в Розрахунковому Банку',
    '',GetIdOper(),'',NUMBER_Null,0)
.head 12 +  If cDoc.oDoc()
.head 13 -  Set RB_MFO.REF = cDoc.m_nRef
.head 12 +  Else
.head 13 -  Set RB_MFO.bOPL = FALSE
.head 10 +  Else
.head 11 -  Break
.head 9 -  ! завершение (откат) всего пакета и разлочивание
.head 9 +  If RB_MFO.bOPL
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SqlCommitEx(hSql(), "FOND - inf.DEBET")
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 7 -  !
.head 7 -  Call SalDisableWindow( pbDoc )
.head 2 +  Contents
.head 3 +  Column: MFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
банку
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва банку
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Розрахункова 
сума
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSTC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Фактична
сума
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: NLSFB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок фонду
в обс.банку
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок фонду
в РБ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф
 Д-інф
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  Boolean: bDEBET
.head 3 -  Boolean: bOPL
.head 3 -  Number: nRow
.head 3 -  Number: nS
.head 3 -  Number: n980
.head 3 -  Date/Time: dDat
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 6 )
.head 4 -  Set RB_MFO.nTabInstance = 1
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set RB_MFO.strFilterTblName = 'RB_MFO'
.head 4 -  Set RB_MFO.strPrintFileName = 'RB_MFO'
.head 4 -  Set RB_MFO.dDat = GetBankDate()
.head 4 -  Set RB_MFO.n980 = GetBaseVal()
.head 4 -  !
.head 4 -  Set RB_MFO.strSqlPopulate =
"SELECT RB_MFO.MFO,  b.nb , RB_MFO.REZ, a.ostc, RB_MFO.NLSF, a.nls, RB_MFO.OKPOB
 INTO  :RB_MFO.MFO, :RB_MFO.NAME, :RB_MFO.REZ,
       :RB_MFO.OSTC,:RB_MFO.NLSFB,:RB_MFO.NLSF,:RB_MFO.OKPOB
 FROM  RB_MFO, banks b , accounts a
 where RB_MFO.mfo = b.mfo and  RB_MFO.accf = a.acc (+) 
 ORDER BY 1" 
.head 4 -  !
.head 4 -  Set RB_MFO.strSqlUpdate =
"UPDATE RB_MFO SET REZ=:RB_MFO.REZ WHERE MFO=:RB_MFO.MFO "
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set RB_MFO.bDEBET = FALSE
.head 4 -  Call SalEnableWindow( pbDoc )
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  ! кнопка ВЫСТАВИТЬ оплату
.head 4 +  If SqlPrepareAndExecute( hSql(),
   "SELECT ref FROM oper where tt='RID' and dk=2 and sos >=0 and VDAT=:RB_MFO.dDat")
and SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set RB_MFO.bDEBET = FALSE
.head 4 +  If RB_MFO.bDEBET = FALSE
.head 5 -  Call SalDisableWindow( pbDoc )
.head 3 +  On UM_FetchRowDone
.head 4 +  If RB_MFO.REZ > RB_MFO.OSTC
.head 5 -  Set RB_MFO.bDEBET = TRUE
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
.head 1 +  Table Window: RB_NET
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Виконання НЕТТО розрахунків
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.075"
.head 4 -  Top:    0.896"
.head 4 -  Width:  17.267"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 4000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.44"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.017"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 9405
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.92"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.35"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 9406
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 9407
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text: Стан кор. рахунків на:
.head 5 -  Resource Id: 14030
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.183"
.head 6 -  Top:    0.095"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: KS_TIME
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.483"
.head 7 -  Top:    0.071"
.head 7 -  Width:  2.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: DateTime
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Дата+Час стану коррахунків' )
.head 6 +  On SAM_Create
.head 7 -  Call SqlPrepareAndExecute ( hSql(), ' select max(dat) from RB_ZAG_LAB into :KS_DATE_TIME' )
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set RB_NET.KS_TIME=KS_DATE_TIME 
.head 4 +  Data Field: Dat_B
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.283"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Time
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 
"MIN Час початку РБ НЕТТО-" || IifS(RB_NET.nSign =-1,"ДЕБЕТ","КРЕДИТ" ) )
.head 4 +  Data Field: Dat_T
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.683"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Time
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 
"Реальний Час початку РБ НЕТТО-" || IifS(RB_NET.nSign =-1,"ДЕБЕТ","КРЕДИТ" ) )
.head 4 +  Data Field: Dat_E
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.083"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Time
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 
"MAX Час початку РБ НЕТТО-"|| IifS(RB_NET.nSign =-1,"ДЕБЕТ","КРЕДИТ" ) )
.head 4 -  !
.head 4 +  Pushbutton: pb_NETO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F1
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BF1.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F1. Переглянути НЕТТО-файл '
.head 7 -  Call SalDisableWindow( pb_NETO )
.head 6 +  On SAM_Click
.head 7 -  Call FunNSIEditF('RB_NET', 1 )
.head 4 +  Pushbutton: pb_KS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.9"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F2
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BF2.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F2. Переглянути файл КорРахункiв'
.head 7 -  Call SalDisableWindow( pb_KS )
.head 6 +  On SAM_Click
.head 7 -  Call FunNSIEditF('RB_KS', 1 )
.head 4 -  Line
.head 5 -  Resource Id: 26237
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  6.383"
.head 6 -  Begin Y:  0.071"
.head 6 -  End X:  6.383"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 26238
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  7.483"
.head 6 -  Begin Y:  0.071"
.head 6 -  End X:  7.483"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 2 +  Contents
.head 3 +  Column: FDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
нетто
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: IDC  
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
 ПЦ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: IDU    
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
 Учасн.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMDB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма 
дебета
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Прогноз
КорРах
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KSWRK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: КорРах
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RFOSTB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пл. остаток 
на счету РФ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RFOSTC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на сч. РФ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.367"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSTC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НЕТТО-
сума
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DELTA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дельта-
сума
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: NLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок
в обс.банку
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф
Д-факт
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TIP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPOB 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сч-транзит
ПЦ в РБ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.25"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAM_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наим ПЦ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.25"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата+Час з  
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: DateTime
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: EDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата+Час по
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: DateTime
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSTB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НЕТТО-
сума
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: POSTDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата+Час
прийняття
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: DateTime
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NETTO_DEBET
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNazn
.head 5 -  Number: nRef1
.head 5 -  Number: nRef2
.head 5 -  Number: nPriority ! 0 - обычный , 1 - СТП
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set RB_NET.nFAZA = 0
.head 5 -  Call SalSetWindowText( hWndForm, 'Виконання ' || strPar01 )
.head 5 -  Call SalHideWindow( RB_NET.KS )
.head 5 -  Call SalHideWindow( RB_NET.SUMDB )
.head 5 -  Call SalHideWindow( RB_NET.RFOSTB )
.head 5 -  Call SalHideWindow( RB_NET.RFOSTC )
.head 5 -  Call SalHideWindow( RB_NET.KSWRK )
.head 5 -  Call SalHideWindow( RB_NET.DELTA )
.head 5 -  Call SalShowWindow( RB_NET.IDC )
.head 5 -  Call SalShowWindow( RB_NET.IDU )
.head 5 -  Call SalShowWindow( RB_NET.FDAT )
.head 5 -  Call SalShowWindow( RB_NET.OSTC )
.head 5 -  Call SalTblSetColumnTitle( RB_NET.OSTC, 'НЕТТО-
Дебет' )
.head 5 -  Set RB_NET.sTT = 'RRD'
.head 5 -  Set RB_NET.sTTO= 'RRO'
.head 5 -  Set RB_NET.nDk = 0
.head 5 -  ! -------------------
.head 5 -  Set RB_NET.strSqlPopulate =
"SELECT n.fdat, n.IDC, n.IDU, n.s, t.nls, substr(t.name, 1,38),
        r.MFO, substr(r.name,1,38),  r.NLSB, r.OKPOB, r.tip,
        n.BDATe, n.EDATe, n.fdat
 INTO  :RB_NET.FDAT, :RB_NET.IDC,  :RB_NET.IDU, :RB_NET.OSTC,
       :RB_NET.NLSA, :RB_NET.NAM_A,:RB_NET.MFO, :RB_NET.NAME,
       :RB_NET.NLSB, :RB_NET.OKPOB,:RB_NET.TIP,
       :RB_NET.BDAT, :RB_NET.EDAT, :RB_NET.POSTDATE
 FROM  RB_NET n, rb_uch r,  rb_centr t
 where n.otm is null and r.idc= n.idc and r.idu=n.idu and
       t.id = n.idc  and n.s < 0
 ORDER BY r.MFO, n.fdat"
.head 5 -  Set RB_NET.nKol = 0
.head 5 -  Call SalTblPopulate(hWndForm, hSql(), RB_NET.strSqlPopulate, TBL_FillAll)
.head 5 +  If RB_NET.nKol > 0
.head 6 -  ! последняя перечитка для проверки на повторный пуск с двух станций (окон)
.head 6 +  If SqlPrepareAndExecute( hSql(),
   "select ref
      from oper
     where tt=:RB_NET.sTT
       and dk=:RB_NET.nDk
       and sos >= 0
       and VDAT=:RB_NET.dDat
   ")
and SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Set sERR = "D2.Спроба виконати повторно(одночасно) "|| strPar01
.head 7 -  Return FALSE
.head 6 -  ! -------------------
.head 6 -  ! НЕ залочились до commit (roll)
.head 6 +  If not SqlPrepareAndExecute( hSql(),"SELECT otm FROM RB_net FOR UPDATE OF otm NOWAIT" ) 
.head 7 -  Set sERR = "D3.Занято "|| strPar01
.head 7 -  Return FALSE
.head 6 -  ! -------------------
.head 6 -  ! свободный полет 
.head 6 -  Set RB_NET.nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow( hWndForm, RB_NET.nRow, 0 , 0 )
.head 7 -  Call SalTblSetContext( hWndForm, RB_NET.nRow )
.head 7 -  Set RB_NET.REF = NUMBER_Null
.head 7 -  Set nRef1 = NUMBER_Null
.head 7 -  Set nRef2 = NUMBER_Null
.head 7 +  If RB_NET.MFO=RB_NET.aMFO   !'300001'
.head 8 -  Set RB_NET.sTT = 'RRV'
.head 8 -  Set nPriority = 0
.head 7 +  Else
.head 8 -  Set RB_NET.sTT = 'RRD'
.head 8 -  Set nPriority = 1
.head 7 +  If SqlPrepareAndExecute ( hSql(),
'select u.DOGNAME, i.sumk, i.nlsk, i.nazk, i.nazr
   into :DogName, :SUM_KOM, :NLS_KOM, :NAZ_KOM, :NAZ_NET
   from RB_UCH u, RB_TIP i
  where u.idc=:RB_NET.IDC and u.idu=:RB_NET.IDU
    and i.tip=:RB_NET.TIP' )
and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set sNazn = DogName || ' '   ||
NAZ_NET || ' з ' ||
SalFmtFormatDateTime( RB_NET.BDAT, 'dd/MM/yyyy hhhh:mm:ss' ) ||' по '||
SalFmtFormatDateTime( RB_NET.EDAT, 'dd/MM/yyyy hhhh:mm:ss' )
.head 8 -  Call cDoc.SetDoc( nRef1, sTT, nDk, 6, Str(RB_NET.REF),
     RB_NET.FDAT, RB_NET.dDat, RB_NET.dDat, RB_NET.dDat,
     RB_NET.NLSA, RB_NET.NAM_A, GetBankMfo(), '', RB_NET.n980, - RB_NET.OSTC, GetBankOkpoS(),
     RB_NET.NLSB, RB_NET.NAME,  RB_NET.MFO,   '', RB_NET.n980, - RB_NET.OSTC, RB_NET.OKPOB,
     sNazn, '',GetIdOper(),'',NUMBER_Null, nPriority)
.head 8 +  If cDoc.oDoc()
.head 9 -  Set nRef1 = cDoc.m_nRef
.head 9 +  If SUM_KOM != NUMBER_Null and SUM_KOM >0 and
   NLS_KOM != STRING_Null
.head 10 -  Set sNazn = Subs(
DogName || ' '||
NAZ_KOM || ' з ' ||
SalFmtFormatDateTime( RB_NET.BDAT, 'dd/MM/yyyy hhhh:mm:ss' ) ||' по '||
SalFmtFormatDateTime( RB_NET.EDAT, 'dd/MM/yyyy hhhh:mm:ss' )
, 1, 160 )
.head 10 -  Call cDoc.SetDoc( nRef2, sTTO, nDk, 6, Str(RB_NET.REF),
     RB_NET.FDAT, RB_NET.dDat, RB_NET.dDat, RB_NET.dDat,
     NLS_KOM, RB_NET.NAM_A, GetBankMfo(), '', RB_NET.n980, SUM_KOM, GetBankOkpoS(),
     RB_NET.NLSB, RB_NET.NAME,  RB_NET.MFO,   '', RB_NET.n980, SUM_KOM, RB_NET.OKPOB,
     sNazn, '',GetIdOper(),'',NUMBER_Null,1 )
.head 10 +  If cDoc.oDoc()
.head 11 -  Set nRef2 = cDoc.m_nRef
.head 11 +  If NOT SqlPrepareAndExecute( hSql(),"UPDATE oper set refL=:nRef2 where ref=:nRef1 " )
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Set sERR = "D4.Невдала спроба зв.операції "|| strPar01
.head 12 -  Return FALSE
.head 10 +  Else
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Set sERR = "D4.Невдала спроба стягнути ком."|| strPar01
.head 11 -  Return FALSE
.head 9 -  ! Call Debug('Дата неттинга : '||SalFmtFormatDateTime( RB_NET.FDAT, 'dd/MM/yyyy hhhh:mm:ss' ))
.head 9 -  !
.head 9 -  ! Call Debug('Изменения OTM = 1 where otm is null' )
.head 9 -  !
.head 9 +  If SqlPrepareAndExecute( hSql(),
"update rb_net set otm = 1
  where fdat=:RB_NET.POSTDATE
    and idc=:RB_NET.IDC
    and idu=:RB_NET.IDU
    and otm IS NULL" )
.head 10 -  Set RB_NET.REF = nRef1
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Set sERR = "D5.Невдала спроба відмітити cплату(otm=1) "|| strPar01
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Set sERR = "D4.Невдала спроба стягнути "|| strPar01
.head 9 -  Return FALSE
.head 6 -  ! -------------------
.head 6 -  Return TRUE
.head 5 -  ! -------------------
.head 5 -  Set sERR = "D1.Відсутня інф. для " || strPar01
.head 5 -  Return FALSE
.head 3 -  !
.head 3 +  Function: SOS_KREDIT
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call SalSetWindowText( hWndForm, 'Виконання '|| strPar01 )
.head 5 -  Set RB_NET.sTT = 'RRK'
.head 5 -  Set RB_NET.nDk = 1
.head 5 -  ! -------------------
.head 5 -  ! 1. НЕ весь дебет имеет OMT =1
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT otm FROM RB_net where s<0 and otm is null" )
and SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set sERR = "K1.НЕвиконано НЕТТО-ДЕБЕТ "
.head 6 -  Return FALSE
.head 5 -  ! -------------------
.head 5 -  ! 2. есть незавизированые RRD
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT ref FROM oper WHERE tt in ('RRD','RRO') and dk=0 and sos>0 and sos<5 and vdat=:RB_NET.dDat " )
and SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set sERR = "K2.НЕзавізовано НЕТТО-ДЕБЕТ "
.head 6 -  Return FALSE
.head 5 -  ! -------------------
.head 5 -  ! 3. есть незаквитованные RRD
.head 5 -  ! !! временно 
.head 5 -  ! If FALSE
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT o.ref FROM oper o, arc_rrp a 
   WHERE o.tt in ('RRD','RRO') and o.sos=5 and o.dk=0 and o.vdat=:RB_NET.dDat and 
         o.ref=a.ref and o.mfoa<>o.mfob and 
(a.fn_b is null 
 or 
 a.fn_b in (select Z.fn from zag_b Z where Z.fn = a.fn_b and Z.dat= a.dat_b and Z.otm <=3 )
 ) " )
and SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set sERR = "K3.НЕзаквитовано НЕТТО-ДЕБЕТ "
.head 6 -  Return FALSE
.head 5 -  ! -------------------
.head 5 -  ! перечитка для проверки на повторный пуск с двух станций (окон)
.head 5 +  If SqlPrepareAndExecute( hSql(),
   "SELECT ref FROM oper where tt=:RB_NET.sTT and dk=:RB_NET.nDk and sos >=0 and VDAT=:RB_NET.dDat")
and SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set sERR = "K4.Спроба виконати повторно(одночасно) "|| strPar01
.head 6 -  Return FALSE
.head 5 -  ! -------------------
.head 5 -  ! НЕ залочились до commit (roll)
.head 5 +  If not SqlPrepareAndExecute
( hSql(),"SELECT otm FROM RB_net FOR UPDATE OF otm NOWAIT" ) 
.head 6 -  Set sERR = "K5.Занято "|| strPar01
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: REZ_KREDIT
.head 4 -  Description: Проверка есть ли по данным участникам запись по коррсчету.
Проверка для дебетовых платежей. Для данных участников, если 'корр.счет' -  'остаток на рез.фонде' < 0
таким учстникам проставляется отметка otm = -2
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: NOT_KS
.head 5 -  Number: nChooseStep
.head 4 +  Actions
.head 5 +  If not SOS_KREDIT()
.head 6 -  Return FALSE
.head 5 -  ! -------------------
.head 5 -  ! а есть ли по всем нашим участникам записи в файле корсчеов ?
.head 5 -  !
.head 5 +  If SqlPrepareAndExecute( hSql(),
"select count(*) into :NOT_KS
   from rb_net n, rb_uch u
  where nvl(n.otm,0) < 2
    and n.idc = u.idc
    and n.idu = u.idu
    and n.s < 0
    and u.mfo not in (select mfo from rb_ks)
    and u.mfo <> :RB_NET.aMFO
    and u.tip not in ('N', 'P', 'S')
")
and SqlFetchNext( hSql(), nFetchRes )
and NOT_KS>0
.head 6 -  Call SalTblPopulate(hWndForm, hSql(),
"select n.FDAT, u.idc, u.idu, u.MFO, u.name, u.NLSB, u.OKPOB, n.S
   into :RB_NET.FDAT, :RB_NET.IDC, :RB_NET.IDU, :RB_NET.MFO,
        :RB_NET.NAME, :RB_NET.NLSB,:RB_NET.OKPOB, :RB_NET.OSTC
   from rb_net n, rb_uch u
  where nvl(n.otm,0) < 2
    and n.idc = u.idc
    and n.idu = u.idu
    and n.s < 0
    and u.mfo not in (select mfo from rb_ks)
    and u.mfo <> :RB_NET.aMFO
    and u.tip not in ('N', 'P', 'S')
  order by u.MFO", TBL_FillAll)
.head 6 -  Set sERR = "R11. Відсутні записи по КорРахунках "|| Str(NOT_KS) || " учасників дебетової позиції."
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  ! проверить необходимость и возможность покрытия из резервного фонда 
.head 5 -  Set RB_NET.nFAZA = 1 
.head 5 -  !
.head 5 -  ! виноватые могут быть только те, на кого сегодня выставляли реальный дебет
и ! только банки (tip='B')
.head 5 -  Set RB_NET.strSqlPopulate =
"select m.MFO, substr(b.nb,1,38),  m.NLSB, m.OKPOB, k.ks, 
        k.forwks, a.ostB,
        a.nls,   Nvl(substr(a.nms,1,38),'Не відкр.рах.РФ'), 
        n.s,
        a.ostb, a.ostc, n.fdat, n.idu, n.idc
   into :RB_NET.MFO,  :RB_NET.NAME, :RB_NET.NLSB,:RB_NET.OKPOB,
        :RB_NET.KS,   :RB_NET.KSWRK,
        :RB_NET.OSTC, :RB_NET.NLSA, :RB_NET.NAM_A,
        :RB_NET.SUMDB,
        :RB_NET.RFOSTB, :RB_NET.RFOSTC, :RB_NET.POSTDATE, :RB_NET.IDU, :RB_NET.IDC
   from banks b, rb_ks k, rb_mfo m, accounts a, rb_uch u, rb_net n
  where k.mfo=m.mfo and m.accf = a.acc (+) 
    and m.mfo=b.mfo and k.ks < 0 and k.mfo  = u.mfo
    and u.idc = n.idc and u.idu = n.idu 
    and n.s < 0 and n.otm = 1 and u.tip = 'B' 
  order by m.mfo" 
.head 5 -  !
.head 5 -  Set RB_NET.nKol = 0
.head 5 -  Set RB_NET.sMFO = '*'
.head 5 -  Set RB_NET.bKREDIT = TRUE
.head 5 -  Set nAccF = 0
.head 5 -  ! Call Debug('Перед населением выполняем update rb_net set otm = -2 where s < 0 and otm = 1 and (IDC,IDU) in (select IDC,IDU from RB_UCH where mfo='||RB_NET.MFO ) 
.head 5 -  !
.head 5 -  ! Call Debug('Перед населением тех, у кого отрицательный КС')
.head 5 -  Call SalTblPopulate(hWndForm, hSql(), RB_NET.strSqlPopulate, TBL_FillAll)
.head 5 -  ! Call Debug('Населили таблицу с отрицательными коррсчетами')
.head 5 -  ! ANNY
.head 5 -  ! !!@
.head 5 -  ! Call SqlCommit(hSql())
.head 5 -  ! есть такая необходимость
.head 5 +  If RB_NET.nKol > 0
.head 6 -  ! Call Debug('Выбрались банки с типом B , которые участвовали в нетто-дебете')
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalModalDialog(rb_choose_step, hWndForm, nChooseStep)
.head 6 +  If nChooseStep  = RB_CANCEL_NETTO_KR
.head 7 -  Return FALSE
.head 6 +  If nAccF > 0 AND nChooseStep  = RB_USE_RF
.head 7 -  Set sERR = "R12. Не заповнено рахунки рез.фонду " || Str(nAccF) || ' шт.'
.head 7 -  Return FALSE
.head 6 -  Call SalHideWindow( RB_NET.IDC )
.head 6 -  Call SalShowWindow( RB_NET.IDU )
.head 6 -  Call SalHideWindow( RB_NET.FDAT )
.head 6 -  Call SalShowWindow( RB_NET.KS )
.head 6 -  Call SalShowWindow( RB_NET.SUMDB )
.head 6 -  Call SalShowWindow( RB_NET.RFOSTB )
.head 6 -  Call SalShowWindow( RB_NET.RFOSTC )
.head 6 -  Call SalShowWindow( RB_NET.KSWRK )
.head 6 -  Call SalShowWindow( RB_NET.DELTA )
.head 6 -  Call SalSetWindowText( hWndForm, 'Виконання ПІДКРІПЛЕННЯ коррахунків з резерву' )
.head 6 -  Call SalTblSetColumnTitle( RB_NET.OSTC, 'Сума фонду' )
.head 6 -  ! -------------------
.head 6 +  If nChooseStep  = RB_USE_RF
.head 7 -  ! но нет пока возможности  (тоесть разница Корр счета - остаток на РФ < 0)
.head 7 +  If RB_NET.bKREDIT = FALSE
.head 8 -  ! Call Debug('У какого то из банков дельта < 0, (тоесть разница Корр счета - остаток на РФ < 0)  - делаем откат')
.head 8 -  ! откат 
.head 8 +  If SalMessageBox( "Виконати остаточний ВІДКАТ НЕТТО-ДЕБЕТА  ? ",
"Увага! Присутній ДЕБЕТОВИЙ КорРах і недостатньо резерву для його погашення ", MB_IconQuestion | MB_YesNo) = IDYES
.head 9 -  Return OTKAT()
.head 8 -  ! -------------------
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Set sERR = "K12. Відкладено " || strPar01
.head 8 -  Return FALSE
.head 7 -  ! -------------------
.head 7 -  ! Call Debug('Ни у какого из банков нет  дельта < 0 -  делаем нормальный нетто кредит')
.head 7 -  ! есть возможность и мы делаем  подкрепление в свободном полете
.head 6 -  Set RB_NET.nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow( hWndForm, RB_NET.nRow, 0 , 0 )
.head 7 -  Call SalTblSetContext( hWndForm, RB_NET.nRow )
.head 7 -  Set RB_NET.REF = NUMBER_Null
.head 7 -  ! Погасить на сумму дебетового платежа
.head 7 +  If nChooseStep  = RB_USE_RF
.head 8 -  ! Call Debug('Выполняем документ - подкрепление!')
.head 8 -  Call cDoc.SetDoc( RB_NET.REF, sTT, nDk, 6, Str(RB_NET.REF),
     RB_NET.dDat, RB_NET.dDat, RB_NET.dDat, RB_NET.dDat,
     RB_NET.NLSA, RB_NET.NAM_A, GetBankMfo(), '', RB_NET.n980, -RB_NET.SUMDB, GetBankOkpoS(), 
     RB_NET.NLSB, RB_NET.NAME,  RB_NET.MFO,   '', RB_NET.n980, -RB_NET.SUMDB, RB_NET.OKPOB,
    'Підкріплення з резервного фонду', '',GetIdOper(),'',NUMBER_Null, 1 )
.head 8 -  ! Call Debug('Референс: '||SalNumberToStrX(RB_NET.REF, 0) )
.head 8 +  If cDoc.oDoc()
.head 9 +  If SqlPrepareAndExecute( hSql(),
"UPDATE RB_net set otm=1 
 WHERE fdat=:RB_NET.POSTDATE and idc=:RB_NET.IDC and idu=:RB_NET.IDU" )
.head 10 -  Set RB_NET.REF = cDoc.m_nRef
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Set sERR = "K7.Невдала спроба відмітити (otm=1) cплату підкріплення "|| strPar01
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Set sERR = "K6.Невдала спроба cплатити підкріплення "|| strPar01
.head 9 -  Return FALSE
.head 8 -  Call MessageNoWait( "Виконано ПІДКРІПЛЕННЯ КорРах з резерву",'Повідомлення',3,0)
.head 7 +  Else
.head 8 -  ! Call Debug("Обновляем otm = 1 для уч= "|| SalNumberToStrX(RB_NET.IDU, 0)||'  Для РЦ='||SalNumberToStrX(RB_NET.IDC, 0)  ||' Дата = '||SalFmtFormatDateTime(RB_NET.POSTDATE,'dd/mm/yyyy hhhh:mm:ss')  )
.head 8 -  If SqlPrepareAndExecute( hSql(),
"UPDATE RB_net set otm=1 
 WHERE fdat=:RB_NET.POSTDATE and idc=:RB_NET.IDC and idu=:RB_NET.IDU" )
.head 8 -  ! ANNY@
.head 8 -  ! Call SqlCommit(hSql())
.head 8 -  ! Call Debug('Закомитили')
.head 5 -  ! -------------------
.head 5 -  Return TRUE
.head 3 +  Function: OTKAT
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nPriority
.head 4 +  Actions
.head 5 -  ! -------------------
.head 5 -  ! Call Debug('Выплняем функцию отката (OTKAT)' )
.head 5 -  ! делаем откат НЕТТО-ДЕБЕТА
.head 5 -  Set RB_NET.nFAZA = 3 
.head 5 -  Call SalSetWindowText( hWndForm, 'Виконання процедури ВІДКАТУ НЕТТО-ДЕБЕТА' )
.head 5 -  Call SalHideWindow( RB_NET.DELTA )
.head 5 -  Call SalHideWindow( RB_NET.KS )
.head 5 -  Call SalHideWindow( RB_NET.SUMDB )
.head 5 -  Call SalHideWindow( RB_NET.RFOSTB )
.head 5 -  Call SalHideWindow( RB_NET.RFOSTC )
.head 5 -  Call SalHideWindow( RB_NET.KSWRK )
.head 5 -  Call SalShowWindow( RB_NET.IDC )
.head 5 -  Call SalShowWindow( RB_NET.IDU )
.head 5 -  Call SalShowWindow( RB_NET.FDAT )
.head 5 -  Call SalTblSetColumnTitle( RB_NET.OSTC, 'НЕТТО-Дебет' )
.head 5 -  !
.head 5 -  Set RB_NET.nKol = 0
.head 5 -  ! -------------------
.head 5 -  Set RB_NET.strSqlPopulate =
"select n.fdat, n.idc, n.idu, n.s, a.nls, substr(a.nms, 1,38), 
        r.mfo, substr(r.name,1,38),  r.nlsb, r.okpob, n.fdat
   into :RB_NET.FDAT, :RB_NET.IDC, :RB_NET.IDU, :RB_NET.OSTC, 
        :RB_NET.NLSA, :RB_NET.NAM_A,
        :RB_NET.MFO,  :RB_NET.NAME, :RB_NET.NLSB,:RB_NET.OKPOB, :RB_NET.POSTDATE
   from rb_net n, rb_uch r, rb_centr t, accounts a 
  where (n.otm = 1 or n.otm = -2) 
    and r.idc = n.idc 
    and r.idu = n.idu 
    and t.id = n.idc 
    and n.s < 0 
    and a.nls = t.nls 
    and a.kv = 980 
  order by r.mfo, n.fdat" 
.head 5 -  !
.head 5 -  Call SalTblPopulate(hWndForm, hSql(), RB_NET.strSqlPopulate, TBL_FillAll)
.head 5 -  !
.head 5 +  If RB_NET.nKol > 0
.head 6 -  ! -------------------
.head 6 -  ! Call Debug('RB: Нашли дебетов. докмунеты '||SalNumberToStrX(RB_NET.nKol,0))
.head 6 -  ! свободный полет 
.head 6 -  Set RB_NET.nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow( hWndForm, RB_NET.nRow, 0 , 0 )
.head 7 -  Call SalTblSetContext( hWndForm, RB_NET.nRow )
.head 7 -  Set RB_NET.REF = NUMBER_Null
.head 7 +  If RB_NET.MFO = RB_NET.aMFO   !'300001'
.head 8 -  Set RB_NET.sTT = 'RRV'
.head 8 -  Set nPriority = 0
.head 7 +  Else
.head 8 -  Set RB_NET.sTT = 'RRK'
.head 8 -  Set nPriority = 1
.head 7 -  Call cDoc.SetDoc( RB_NET.REF, sTT, nDk, 6, Str(RB_NET.REF),
     RB_NET.dDat, RB_NET.dDat, RB_NET.dDat, RB_NET.dDat,
     RB_NET.NLSA, RB_NET.NAM_A, GetBankMfo(), '', RB_NET.n980, - RB_NET.OSTC, GetBankOkpoS(), 
     RB_NET.NLSB, RB_NET.NAME,  RB_NET.MFO,   '', RB_NET.n980, - RB_NET.OSTC, RB_NET.OKPOB,
    'Повернення ДЕБЕТУ ПЦ', '',GetIdOper(),'',NUMBER_Null, nPriority )
.head 7 +  If cDoc.oDoc()
.head 8 -  ! Call Debug('RB: Сформировали докумнет отката. Установим для кредитовых участников отм=2, которые не в черном списке')
.head 8 -  ! Call Debug('RB: Для участника: '|| SalNumberToStrX(RB_NET.IDU,0)||
           '       Для центра: '|| SalNumberToStrX(RB_NET.IDC,0)||
           '            дата1: '|| SalFmtFormatDateTime(RB_NET.FDAT,'dd/MM/yyyy hhhh:mm:ss')||
           '            дата2: '|| SalFmtFormatDateTime(RB_NET.POSTDATE,'dd/MM/yyyy hhhh:mm:ss')
           )
.head 8 -  ! Проставляем отм = 2 для тех участников, которые не вчерном списке (ну и те которые оделения ОПЕРУ)
.head 8 +  If SqlPrepareAndExecute( hSql(),
"update rb_net 
    set otm = 2 
  where fdat = :RB_NET.POSTDATE 
    and idc  = :RB_NET.IDC 
    and idu  = :RB_NET.IDU 
    and otm  = 1"
 )
.head 9 -  Set RB_NET.REF = cDoc.m_nRef
.head 9 -  ! ANNY
.head 9 -  ! Call SqlCommit(hSql())
.head 9 -  ! Call Debug('RB: Обновили otm = 2 всех, у кого была отметка 1 (тоесть те кто не виноват)')
.head 9 -  !
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Set sERR = "Z5.Невдала спроба відмітити (otm=2) НЕТТО-СТОРНО "
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Set sERR = "Z4.Невдала спроба сплати НЕТТО-СТОРНО"
.head 8 -  Return FALSE
.head 6 -  ! -------------------
.head 6 -  ! отметка о невостребованных записях
.head 6 -  ! Call Debug('Обновляем otm = 0 where s> 0 and (otm is null or otm<>3) ' )
.head 6 +  If not SqlPrepareAndExecute( hSql(),"
  update rb_net 
     set otm=0 
   where s >= 0 and (otm is null or otm<>3)"
  )
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Set sERR = "Z15.Невдала спроба відмітити (otm=0) невикористані записи в НЕТТО-СТОРНО"
.head 7 -  Return FALSE
.head 6 -  ! -------------------
.head 6 -  ! выставляем otm=-3 для всех виноватых
.head 6 -  ! Call Debug('Обновляем otm = 0 where s> 0 and (otm is null or otm<>3) ' )
.head 6 +  If SqlPrepareAndExecute( hSql(),
"update rb_net 
    set otm = -3 
  where otm = -2" )
.head 7 -  Call SqlCommit(hSql())
.head 7 -  ! Call Debug('RB: Обновили otm = -3 всех, у кого была отметка -2 (тоесть те кто виноват)')
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Set sERR = "Z14.Невдала спроба обновити rb_net(otm=-3)"
.head 7 -  Return FALSE
.head 6 -  ! завершение всего пакета и разлочивание
.head 6 -  Set sERR = "Z11. Виконано остаточний ВІДКАТ НЕТТО-ДЕБЕТА !"
.head 6 -  Call SqlCommitEx(hSql(), sERR )
.head 6 -  Return FALSE
.head 5 -  ! -------------------
.head 5 -  Set sERR = "Z1.Відсутня інф. для процедури НЕТТО-СТОРНО " 
.head 5 -  Return FALSE
.head 3 +  Function: NETTO_KREDIT
.head 4 -  Description: Выполнение НЕТТО - кредита
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNazn
.head 5 -  Number: nRef1
.head 5 -  Number: nRef2
.head 5 -  Number: nPriority
.head 4 +  Actions
.head 5 +  If not REZ_KREDIT()
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 +  If SalMessageBox( "Продовжити формувати платежі на кредитових учасників?",
"Увага!", MB_IconQuestion | MB_YesNo) = IDNO
.head 7 -  Return FALSE
.head 5 -  ! -------------------
.head 5 -  ! делаем НЕТТО-КРЕДИТ
.head 5 -  Call SalSetWindowText( hWndForm, 'Виконання '|| strPar01 )
.head 5 -  Call SalHideWindow( RB_NET.KS )
.head 5 -  Call SalHideWindow( RB_NET.SUMDB )
.head 5 -  Call SalHideWindow( RB_NET.RFOSTB )
.head 5 -  Call SalHideWindow( RB_NET.RFOSTC )
.head 5 -  Call SalHideWindow( RB_NET.KSWRK )
.head 5 -  Call SalHideWindow( RB_NET.KS )
.head 5 -  Call SalHideWindow( RB_NET.DELTA )
.head 5 -  Call SalShowWindow( RB_NET.IDC )
.head 5 -  Call SalShowWindow( RB_NET.IDU )
.head 5 -  Call SalShowWindow( RB_NET.FDAT )
.head 5 -  Call SalShowWindow( RB_NET.OSTC )
.head 5 -  Call SalTblSetColumnTitle( RB_NET.OSTC, 'НЕТТО-Кредит' )
.head 5 -  Set RB_NET.nFAZA = 2
.head 5 -  Set RB_NET.nKol = 0
.head 5 -  Set RB_NET.strSqlPopulate =
"SELECT n.fdat, n.IDC, n.IDU, 
        n.s, 
        t.nls, substr(t.name, 1,38),
        r.MFO, substr(r.name,1,38),  r.NLSB, r.OKPOB, r.tip,
        n.BDATe, n.EDATe, n.fdat
 INTO  :RB_NET.FDAT, :RB_NET.IDC, :RB_NET.IDU, 
       :RB_NET.OSTC,
       :RB_NET.NLSA, :RB_NET.NAM_A,
       :RB_NET.MFO,  :RB_NET.NAME, :RB_NET.NLSB,:RB_NET.OKPOB,
       :RB_NET.TIP,  :RB_NET.BDAT, :RB_NET.EDAT, :RB_NET.POSTDATE
 FROM  RB_NET n, rb_uch r,  rb_centr t
 where n.otm is null and r.idc= n.idc and r.idu=n.idu and
       t.id = n.idc and n.s >0
 ORDER BY r.MFO, n.fdat"
.head 5 -  Call SalTblPopulate(hWndForm, hSql(), RB_NET.strSqlPopulate, TBL_FillAll)
.head 5 +  If RB_NET.nKol > 0
.head 6 -  Set RB_NET.sTT = 'RRK'
.head 6 -  ! Call Debug('Есть кредитовые участники - ')
.head 6 -  ! ANNY
.head 6 -  ! Call SqlCommitEx(hSql(),'Есть кредитовые участники - ')
.head 6 -  Set RB_NET.sTTO= 'RRO'
.head 6 -  Set RB_NET.nDk = 1
.head 6 -  ! свободный полет 
.head 6 -  Set RB_NET.nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow( hWndForm, RB_NET.nRow, 0 , 0 )
.head 7 -  Call SalTblSetContext( hWndForm, RB_NET.nRow )
.head 7 -  Set RB_NET.REF = NUMBER_Null
.head 7 -  Set nRef1 = NUMBER_Null
.head 7 -  Set nRef2 = NUMBER_Null
.head 7 +  If RB_NET.MFO=RB_NET.aMFO   !'300001'
.head 8 -  Set RB_NET.sTT = 'RRV'
.head 8 -  Set nPriority = 0
.head 7 +  Else
.head 8 -  Set RB_NET.sTT = 'RRK'
.head 8 -  Set nPriority = 1
.head 7 +  If SqlPrepareAndExecute ( hSql(), 
'SELECT u.DOGNAME, i.sumk, i.nlsk, i.nazk, i.nazr
 INTO :DogName, :SUM_KOM, :NLS_KOM, :NAZ_KOM, :NAZ_NET
 FROM RB_UCH u, RB_TIP i
 WHERE u.idc=:RB_NET.IDC and u.idu=:RB_NET.IDU 
   and i.tip=:RB_NET.TIP' ) 
and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set sNazn = Subs(NAZ_NET || ' з ' || SalFmtFormatDateTime( RB_NET.BDAT, 'dd/MM/yyyy hhhh:mm:ss' ) ||' по '||
SalFmtFormatDateTime( RB_NET.EDAT, 'dd/MM/yyyy hhhh:mm:ss' )
, 1, 160 )
.head 8 -  Call cDoc.SetDoc( RB_NET.REF, sTT, nDk, 6, Str(RB_NET.REF),
     RB_NET.FDAT, RB_NET.dDat, RB_NET.dDat, RB_NET.dDat,
     RB_NET.NLSA, RB_NET.NAM_A, GetBankMfo(), '', RB_NET.n980,  RB_NET.OSTC, GetBankOkpoS(), 
     RB_NET.NLSB, RB_NET.NAME,  RB_NET.MFO,   '', RB_NET.n980,  RB_NET.OSTC, RB_NET.OKPOB,
    sNazn, '',GetIdOper(),'',NUMBER_Null,1)
.head 8 +  If cDoc.oDoc()
.head 9 -  Set nRef1 = cDoc.m_nRef 
.head 9 +  If SUM_KOM != NUMBER_Null and SUM_KOM >0 and 
   NLS_KOM != STRING_Null
.head 10 -  Set sNazn = Subs( 
DogName || ' '   || 
NAZ_KOM || ' з ' || 
SalFmtFormatDateTime( RB_NET.BDAT, 'dd/MM/yyyy hhhh:mm:ss' ) ||' по '||
SalFmtFormatDateTime( RB_NET.EDAT, 'dd/MM/yyyy hhhh:mm:ss' )
, 1, 160 )
.head 10 -  Call cDoc.SetDoc( nRef2, sTTO, 1-nDk, 6, Str(RB_NET.REF),
     RB_NET.FDAT, RB_NET.dDat, RB_NET.dDat, RB_NET.dDat,
     NLS_KOM, RB_NET.NAM_A, GetBankMfo(), '', RB_NET.n980, SUM_KOM, GetBankOkpoS(), 
     RB_NET.NLSB, RB_NET.NAME,  RB_NET.MFO,   '', RB_NET.n980, SUM_KOM, RB_NET.OKPOB,
     sNazn, '',GetIdOper(),'',NUMBER_Null,1)
.head 10 +  If cDoc.oDoc() 
.head 11 -  Set nRef2 = cDoc.m_nRef 
.head 11 +  If NOT SqlPrepareAndExecute( hSql(),"UPDATE oper set refL=:nRef2 where ref=:nRef1 " )
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Set sERR = "K4.Невдала спроба зв.операції "|| strPar01
.head 12 -  Return FALSE
.head 10 +  Else
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Set sERR = "K4.Невдала спроба стягнути ком."|| strPar01
.head 11 -  Return FALSE
.head 9 +  If SqlPrepareAndExecute( hSql(),
"UPDATE RB_net set otm=1 
 WHERE fdat = :RB_NET.POSTDATE and idc=:RB_NET.IDC and idu=:RB_NET.IDU and otm IS NULL" )
.head 10 -  Set RB_NET.REF = cDoc.m_nRef
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Set sERR = "K10.Невдала спроба відмітити сплату (otm=1) " || strPar01
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Set sERR = "K9.Невдала спроба сплати " || strPar01
.head 9 -  Return FALSE
.head 6 -  ! -------------------
.head 6 -  ! выставляем otm=3 для успешного дебета и кредита
.head 6 +  If SqlPrepareAndExecute( hSql(),
"UPDATE RB_net set otm=3 WHERE otm=1" )
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Set sERR = "K13.Невдала спроба обновити rb_net(otm=3)" || strPar01
.head 7 -  Return FALSE
.head 5 -  ! -------------------
.head 5 -  Set sERR = "K8.Відсутня інф. для " || strPar01
.head 5 -  Return FALSE
.head 3 +  Function: F_TIME
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nSign
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: PB
.head 5 -  String: PE
.head 5 -  String: PS
.head 5 -  ! String: PT
.head 4 +  Actions
.head 5 +  If nSign = -1 
.head 6 -  Set PB = 'RBND_B'
.head 6 -  Set PE = 'RBND_E'
.head 6 -  Set PS = 'ДЕБЕТ'
.head 5 +  Else
.head 6 -  Set PB = 'RBNK_B'
.head 6 -  Set PE = 'RBNK_E'
.head 6 -  Set PS = 'КРЕДИТ'
.head 5 +  If SqlPrepareAndExecute( hSql(), 
"SELECT to_date(b.val,'HH24:MI:SS'), to_date(e.val,'HH24:MI:SS'),
   sysdate
 INTO :Dat_B, :Dat_E, :Dat_T 
 FROM params b, params e WHERE b.par=:PB and e.par=:PE " ) 
and NOT SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set sERR = "N0.Не задано часові параметри запуску НЕТТО-"||PS
.head 6 -  Return FALSE
.head 5 +  If Dat_T < Dat_B OR Dat_T > Dat_E
.head 6 -  Set sERR = "N1.Порушено часові параметри запуску НЕТТО-"||PS
.head 6 -  Return FALSE
.head 5 -  ! !!
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nSign
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  String: sERR
.head 3 -  String: sTT
.head 3 -  String: sTTO
.head 3 -  String: sMFO
.head 3 -  String: aMFO
.head 3 -  Number: nRow
.head 3 -  Number: nS
.head 3 -  Number: nDk
.head 3 -  Number: nKol
.head 3 -  Number: n980
.head 3 -  Number: nFAZA ! 0 - ДЕБЕТ, 1-ФОНД, 2-КРЕДИТ, 3-ОТКАТ ДЕБЕТА
.head 3 -  Boolean: bKREDIT
.head 3 -  Date/Time: dDat
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  String: strBuf
.head 3 -  Date/Time: KS_DATE_TIME
.head 3 -  !
.head 3 -  String: DogName
.head 3 -  String: NAZ_NET
.head 3 -  Number: SUM_KOM
.head 3 -  String: NLS_KOM
.head 3 -  String: NAZ_KOM
.head 3 -  !
.head 3 -  Number: nAccF
.head 3 -  Number: nSTP
.head 3 -  Number: i1
.head 3 -  Number: i2
.head 3 -  Number: i3
.head 3 -  Number: i4
.head 3 -  ! Date/Time: Dat_B
.head 3 -  ! Date/Time: Dat_E
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 7 )
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set RB_NET.strPrintFileName = 'RB_NET'
.head 4 -  Set RB_NET.dDat = GetBankDate()
.head 4 -  Set RB_NET.n980 = GetBaseVal()
.head 4 -  Set RB_NET.aMFO = GetBankMfo()
.head 3 +  On SAM_CreateComplete
.head 4 +  If NOT F_TIME(RB_NET.nSign )
OR ( RB_NET.nSign =-1 and not NETTO_DEBET()  or 
     RB_NET.nSign = 1 and not NETTO_KREDIT() 
   )
.head 5 -  Call SqlRollbackEx( hSql(), strPar01 )
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 +  If SalStrLength(sERR) > 0 
.head 6 -  Call MessageNoWait(sERR , 'Помилка ', 0, 1)
.head 6 -  Call SalSendMsg( pbExit, SAM_Click, 0, 0 )
.head 4 +  Else
.head 5 -  ! завершение всего пакета и разлочивание
.head 5 -  Call SqlCommitEx(hSql(), strPar01 )
.head 5 -  Call MessageNoWait( strPar01 || ' виконано !','Повідомлення',3,0)
.head 3 -  On UM_Populate
.head 3 +  On UM_FetchRowDone
.head 4 -  Call SaveInfoToLog('FAZA ='||SalNumberToStrX(RB_NET.nFAZA,0))
.head 4 +  If RB_NET.nFAZA = 1 
.head 5 +  If RB_NET.sMFO = RB_NET.MFO
.head 6 -  Set RB_NET.KS = NUMBER_Null
.head 5 -  Set RB_NET.sMFO = RB_NET.MFO
.head 5 -  ! Set RB_NET.DELTA = RB_NET.KS +  RB_NET.OSTC 
.head 5 -  Set RB_NET.DELTA = RB_NET.SUMDB + RB_NET.OSTC 
.head 5 -  Call SaveInfoToLog('RB: Для МФО '||RB_NET.MFO||'сумма дб: '|| SalNumberToStrX( RB_NET.SUMDB,0)||' KS='||SalNumberToStrX( RB_NET.KS, 0 )||'  OST рф='||SalNumberToStrX(RB_NET.OSTC, 0 )||' Delta='||SalNumberToStrX(RB_NET.DELTA, 0 ))
.head 5 +  If RB_NET.DELTA < 0
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Maize )
.head 6 -  Call SalDateToStr( RB_NET.dDat, strBuf )
.head 6 -  Call SalStrLeft (strBuf, 10, strBuf)
.head 6 -  !
.head 6 -  Call SaveInfoToLog('RB: delta (<0) ='||SalNumberToStrX( RB_NET.DELTA, 0 )||' MFO='||RB_NET.MFO||' dDAT='||strBuf )
.head 6 -  Call SaveInfoToLog('RB: Находим данные, которые подлежат обновлению на otm = -2 ')
.head 6 -  !
.head 6 -  ! Call SqlPrepareAndExecute( hSqlAux2(),
"select idc, idu, otm, s
   into :i1, :i2, :i3, :i4
   from rb_net 
  where s < 0 and otm = 1 
    and (IDC,IDU) in (select IDC,IDU from RB_UCH where mfo=:RB_NET.MFO ) " ) 
.head 6 +  ! While SqlFetchNext(hSqlAux2(), nFetchRes)
.head 7 -  Call SaveInfoToLog('RB: Выбранные данные: i1='|| SalNumberToStrX(i1,0)||' i2='|| SalNumberToStrX(i2,0)||' i3='|| SalNumberToStrX(i3,0)||' i4='|| SalNumberToStrX(i4,0))
.head 6 -  !
.head 6 -  !
.head 6 -  Call SaveInfoToLog('RB: Обновляем для МФО='||RB_NET.MFO)
.head 6 +  If SqlPrepareAndExecute( hSqlAux2(),
"update rb_net set otm = -2 
  where s < 0 and otm = 1 
    and (idc, idu) in (select idc, idu from rb_uch where mfo=:RB_NET.MFO ) " ) 
.head 7 -  Call SaveInfoToLog('RB: Обновили для '||RB_NET.MFO )
.head 6 +  Else
.head 7 -  Call SaveInfoToLog('RB: Ошибка обновления для МФО='||RB_NET.MFO)
.head 6 -  Set RB_NET.bKREDIT = FALSE
.head 4 -  Set RB_NET.nKol = RB_NET.nKol + 1
.head 4 +  If RB_NET.NLSA = STRING_Null
.head 5 -  Set nAccF = nAccF + 1
.head 1 +  Form Window: wLom
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Скупка та прийом на експертизу цінностей із дорогоцінних металів
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   2.425"
.head 4 -  Top:    1.052"
.head 4 -  Width:  13.133"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 9.131"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: BankName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.117"
.head 6 -  Top:    0.071"
.head 6 -  Width:  7.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: BankMfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: BankDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: EXPERT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.717"
.head 6 -  Top:    4.976"
.head 6 -  Width:  3.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 44595
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    0.417"
.head 5 -  Width:  12.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.214"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Прийнято у гр.
.head 4 -  Resource Id: 44588
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.933"
.head 5 -  Top:    0.548"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Underline
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: FIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 60
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.5"
.head 6 -  Top:    0.548"
.head 6 -  Width:  7.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Ідентифікаційний код
.head 4 -  Resource Id: 44593
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.183"
.head 5 -  Top:    0.94"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: OKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.233"
.head 6 -  Top:    0.905"
.head 6 -  Width:  1.617"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If Len(OKPO) = 0
.head 7 -  Return VALIDATE_Ok
.head 6 +  If not DopustOKPO(OKPO)
.head 7 -  Call MessageNoWait('Неприпустимий код ЄДР' || IifS(Len(VisStrTrim(OKPO))!=8, 'ФО!', 'ПОУ!'), 'Увага!', 7, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set OKPO = VisStrRightTrim(OKPO)
.head 7 +  If Len(OKPO) = 10 and OKPO != '0000000000'
.head 8 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Sky)
.head 8 -  Call XSalTooltipShow(hWndItem, IifS(Mod(Val(Subs(OKPO, 9, 1)) ,2)=0, 'ж', 'ч'))
.head 8 -  Call SalMessageBeep(MB_Ok)
.head 7 -  Return VALIDATE_Ok
.head 5 +  ! On SAM_SetFocus
.head 6 +  If Len(OKPO) = 10 and DopustOKPO(OKPO)
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Sky)
.head 7 -  Call XSalTooltipShow(hWndItem, IifS(Mod(Val(Subs(OKPO, 9, 1)), 2)=0, 'ж', 'ч'))
.head 7 -  Call SalMessageBeep(MB_Ok)
.head 5 +  On SAM_TooltipSetText
.head 6 +  If Len(OKPO) = 10 and DopustOKPO(OKPO) and OKPO != '0000000000'
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Sky)
.head 7 -  Call XSalTooltipShow(hWndItem, IifS(Mod(Val(Subs(OKPO, 9, 1)), 2)=0, 'ж', 'ч'))
.head 7 -  Call SalMessageBeep(MB_Ok)
.head 3 -  Background Text: Дата нарождення
.head 4 -  Resource Id: 61452
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.917"
.head 5 -  Top:    1.405"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: BDAY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.467"
.head 6 -  Top:    1.381"
.head 6 -  Width:  1.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Громадянство
.head 4 -  Resource Id: 61454
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.933"
.head 5 -  Top:    1.405"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: Citizenship
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.017"
.head 6 -  Top:    1.381"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Документ: серія
.head 4 -  Resource Id: 44591
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.533"
.head 5 -  Top:    1.714"
.head 5 -  Width:  1.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: PASPS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    1.679"
.head 6 -  Width:  0.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: №
.head 4 -  Resource Id: 44592
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.983"
.head 5 -  Top:    1.726"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: PASPN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.45"
.head 6 -  Top:    1.679"
.head 6 -  Width:  1.617"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Виданий
.head 4 -  Resource Id: 44594
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.05"
.head 5 -  Top:    1.726"
.head 5 -  Width:  1.05"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: ATRT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.217"
.head 6 -  Top:    1.679"
.head 6 -  Width:  4.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: ATRD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.567"
.head 6 -  Top:    1.679"
.head 6 -  Width:  1.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Адреса
.head 4 -  Resource Id: 44590
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.417"
.head 5 -  Top:    2.012"
.head 5 -  Width:  1.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: ADR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    1.976"
.head 6 -  Width:  9.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Телефон
.head 4 -  Resource Id: 65203
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.417"
.head 5 -  Top:    2.31"
.head 5 -  Width:  1.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: TEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    2.274"
.head 6 -  Width:  9.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 44603
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    2.631"
.head 5 -  Width:  12.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Група F4
.head 4 -  Resource Id: 42781
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    2.798"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb_GRP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.583"
.head 5 -  Top:    2.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F4
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Help.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Light Periwinkle
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F4.Вибрати групу'
.head 5 +  On SAM_Click
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Call FunNSIGetFiltered('LOM_GRP', 'GR_NAME', 'gr_id>0', sTmp, L_GRP)
.head 6 -  ! Call Debug(sTmp)
.head 6 +  If sTmp != STRING_Null
.head 7 -  ! Call SalEnableWindow(L_IZD)
.head 7 -  Call SalEnableWindow(L_ZNJ)
.head 7 -  Call SalSetFocus(L_IZD)
.head 7 -  Set sGr_id = sTmp
.head 7 +  If sGr_id = '4'
.head 8 -  Call SalDisableWindow(L_IZD)
.head 8 -  Call SalDisableWindow(L_ZAG)
.head 8 -  Call SalDisableWindow(L_ZNJ)
.head 8 -  Call SalDisableWindow(L_LIG)
.head 8 -  Call SalEnableWindow(L_EDN)
.head 8 -  Call SalShowWindow(L_NOM)
.head 8 -  Call SalDisableWindow(L_NOM)
.head 8 -  Call SalShowWindow(T_NOM)
.head 7 +  Else If sGr_id = '5'
.head 8 -  ! Call SalDisableWindow(L_IZD)
.head 8 -  Call SalEnableWindow(L_IZD)
.head 8 -  Call SalEnableWindow(L_ZAG)
.head 8 -  Call SalEnableWindow(L_ZNJ)
.head 8 -  Call SalDisableWindow(L_LIG)
.head 8 -  Call SalEnableWindow(L_EDN)
.head 8 -  Call SalShowWindow(L_NOM)
.head 8 -  Call SalEnableWindow(L_NOM)
.head 8 -  Call SalShowWindow(T_NOM)
.head 7 +  Else
.head 8 -  ! Call SalDisableWindow(L_IZD)
.head 8 -  Call SalEnableWindow(L_IZD)
.head 8 -  Call SalEnableWindow(L_ZAG)
.head 8 -  Call SalEnableWindow(L_ZNJ)
.head 8 -  Call SalDisableWindow(L_LIG)
.head 8 -  Call SalEnableWindow(L_EDN)
.head 8 -  Call SalHideWindow(L_NOM)
.head 8 -  Call SalHideWindow(T_NOM)
.head 6 +  Else
.head 7 +  If not sGr_id
.head 8 -  ! Call Debug('Не вибрана група')
.head 8 -  Call MessageNoWait('Не вибрана група!', 'УВАГА!', 0, 1)
.head 8 -  ! Call SalDestroyWindow(hWndForm)
.head 3 +  Data Field: L_GRP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.133"
.head 6 -  Top:    2.738"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Найменування цінностей F11
.head 4 -  Resource Id: 44589
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    3.19"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb_IZD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.583"
.head 5 -  Top:    3.095"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F11
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Help.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Sky
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F11.Вибрати виріб'
.head 5 +  On SAM_Click
.head 6 +  If sGr_id
.head 7 -  Set sTmp = STRING_Null
.head 7 -  ! If sGr_id = '4' or sGr_id = '5'
.head 7 +  If sGr_id = '4'
.head 8 -  Call FunNSIGetFiltered('LOM_MON', 'NAME', 'grp=' || sGr_id, sTmp, L_IZD)
.head 8 -  Set sMon_id = sTmp
.head 8 -  Call SalEnableWindow(L_EDN)
.head 8 -  Call SalDisableWindow(L_ZNJ)
.head 8 -  Call SalDisableWindow(L_ZAG)
.head 8 -  Call SalSendMsg(pb_MET, SAM_Click, 0, 0)
.head 8 -  Call SalDisableWindow(pb_MET)
.head 8 -  Call SalSetFocus(L_IZD)
.head 8 -  Return VALIDATE_Ok
.head 7 +  Else
.head 8 -  Call FunNSIGetFiltered('LOM_IZD', 'NAME', 'grp_id=' || sGr_id, sTmp, L_IZD)
.head 8 -  Set sMon_id = ''
.head 8 -  Call SalEnableWindow(L_EDN)
.head 8 -  Call SalSetFocus(L_IZD)
.head 8 -  Return VALIDATE_Ok
.head 3 +  Data Field: L_IZD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.133"
.head 6 -  Top:    3.095"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalEnableWindow(L_EDN)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Кількість
.head 4 -  Resource Id: 44597
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.033"
.head 5 -  Top:    3.155"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.238"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: L_EDN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.683"
.head 6 -  Top:    3.06"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If L_EDN = NUMBER_Null or L_EDN < 1
.head 7 -  Set L_EDN = 1
.head 6 -  Call f_Summa()
.head 6 -  ! Call Debug('after f_Summa, sGr_id=' || sGr_id)
.head 6 -  ! If not (sGr_id = '4' or sGr_id = '5')
.head 6 +  If sGr_id != '4'
.head 7 -  Call SalEnableWindow(L_ZAG)
.head 7 -  Call SalEnableWindow(L_ZNJ)
.head 6 +  Else
.head 7 -  ! Call Debug('sMon_id=' || sMon_id)
.head 7 -  Set L_ZAG = L_EDN * Val(GetValueStr("
    SELECT to_char(weight)
    FROM   LOM_MON
    WHERE  MON_ID='" || sMon_id || "'"))
.head 7 -  Set L_LIG = L_ZAG
.head 7 -  Set L_ZNJ = NUMBER_Null
.head 7 -  Call SalDisableWindow(L_ZAG)
.head 7 -  Call SalDisableWindow(L_ZNJ)
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_KillFocus
.head 6 +  If L_EDN = NUMBER_Null or L_EDN < 1
.head 7 -  Set L_EDN = 1
.head 6 -  Call f_Summa()
.head 6 +  If sGr_id != '4'
.head 7 -  Call SalEnableWindow(L_ZAG)
.head 7 -  Call SalEnableWindow(L_ZNJ)
.head 6 +  Else
.head 7 -  ! Call Debug('sMon_id=' || sMon_id)
.head 7 -  Set L_ZAG = L_EDN * Val(GetValueStr("
    SELECT to_char(weight)
    FROM   LOM_MON
    WHERE  MON_ID='" || sMon_id || "'"))
.head 7 -  Set L_LIG = L_ZAG
.head 7 -  Set L_ZNJ = NUMBER_Null
.head 7 -  Call SalDisableWindow(L_ZAG)
.head 7 -  Call SalDisableWindow(L_ZNJ)
.head 3 +  Data Field: L_NOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.683"
.head 6 -  Top:    2.667"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If L_EDN = NUMBER_Null or L_EDN < 1
.head 7 -  Set L_EDN = 1
.head 6 -  Call f_Summa()
.head 6 -  Call SalEnableWindow(L_ZAG)
.head 6 -  Call SalEnableWindow(L_ZNJ)
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_KillFocus
.head 6 +  If L_EDN = NUMBER_Null or L_EDN < 1
.head 7 -  Set L_EDN = 1
.head 6 -  Call f_Summa()
.head 3 -  !
.head 3 -  Background Text: Метал F12
.head 4 -  Resource Id: 44596
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    3.583"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb_MET
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.583"
.head 5 -  Top:    3.452"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F12
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Help.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Maize
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F12.Вибрати метал та пробу'
.head 5 +  On SAM_Click
.head 6 -  ! If sGr_id = '4' or sGr_id = '5'
.head 6 +  If sGr_id = '4'
.head 7 -  Call SalDisableWindow(L_ZAG)
.head 7 -  Call SalDisableWindow(L_NOM)
.head 7 -  ! If SqlPrepareAndExecute(hSql(), "
   SELECT m.cena_kup,m.cena_met,m.metal,m.nls2210,m.nls2223,m.nls2749,m.nls9819,m.nls2749,
          trim(substr(a4.nms,1,38)),m.nls9819,trim(substr(a9.nms,1,38)),m.met,m.proba
   INTO   :L_CEN,:L_NOM,:L_MET,:NLS2210,:NLS2223,:NLS2749,:NLS9819,:NLS,:NMS,:NLS9,:sNms9,:nMet,:nProba
   FROM   lom_mon m, accounts a2, accounts a3, accounts a4, accounts a9
   WHERE  m.mon_id='" || sMon_id || "' and a2.kv=:n980 and a2.nls=m.nls2210 and a3.kv=:n980 and
          a3.nls=m.nls2223 and a4.kv=:n980 and a4.nls=m.nls2749 and a9.kv=:n980 and a9.nls=m.nls9819") and
   SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! If SqlPrepareAndExecute(hSql(), "
   SELECT m.cena_kup,m.cena_met,m.metal,m.nls2223,m.nls2749,m.nls9819,m.nls2749,
          trim(substr(a4.nms,1,38)),m.nls9819,trim(substr(a9.nms,1,38)),m.met,m.proba
   INTO   :L_CEN,:L_NOM,:L_MET,:NLS2223,:NLS2749,:NLS9819,:NLS,:NMS,:NLS9,:sNms9,:nMet,:nProba
   FROM   lom_mon m, accounts a3, accounts a4, accounts a9
   WHERE  m.mon_id='" || sMon_id || "' and a3.kv=:n980 and a3.nls=m.nls2223 and a4.kv=:n980 and a4.nls=m.nls2749 and
          a9.kv=:n980 and a9.nls=m.nls9819") and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! If SqlPrepareAndExecute(hSql(), "
   SELECT m.cena_kup,m.cena_met,m.metal,m.nls2223,m.nls2749,m.nls9819,m.nls2749,
          trim(substr(a4.nms,1,38)),m.nls9819,trim(substr(a9.nms,1,38)),m.met,m.proba
   INTO   :L_CEN,:L_NOM,:L_MET,:NLS2223,:NLS2749,:NLS9819,:NLS,:NMS,:NLS9,:sNms9,:nMet,:nProba
   FROM   lom_mon m, accounts a4, accounts a9
   WHERE  m.mon_id='" || sMon_id || "' and a4.kv=:n980 and a4.nls=m.nls2749 and a9.kv=:n980 and
          a9.nls=m.nls9819") and SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If sMon_id
.head 8 -  If SqlPrepareAndExecute(hSql(), "
   SELECT m.cena_kup,m.cena_met,m.metal,m.nls2749,m.nls9819,m.nls2749,trim(substr(a4.nms,1,38)),m.nls9819,
          trim(substr(a9.nms,1,38)),m.met,m.proba
   INTO   :L_CEN,:L_NOM,:L_MET,:NLS2749,:NLS9819,:NLS,:NMS,:NLS9,:sNms9,:nMet,:nProba
   FROM   lom_mon m, accounts a4, accounts a9
   WHERE  m.mon_id='" || sMon_id || "' and a4.kv=:n980 and a4.nls=m.nls2749 and a9.kv=:n980 and
          a9.nls=m.nls9819") and SqlFetchNext(hSql(), nFetchRes)
.head 8 +  Else
.head 9 -  ! Call Debug('Не описані рахунки обліку')
.head 9 -  Call MessageNoWait('Не описані або не існують рахунки обліку!', 'УВАГА!', 0, 1)
.head 9 -  ! Call SalDestroyWindow(hWndForm)
.head 6 +  Else
.head 7 +  If sGr_id = '1' or sGr_id = '2' or sGr_id = '3' or sGr_id = '5'
.head 8 -  Set sTmp = STRING_Null
.head 8 -  ! Call FunNSIGetFiltered('LOM_MET', 'NAME', 'nls is not null and nls9 is not null and nvl(cena,0)>0 and
     grp=' || sGr_id, sTmp, L_MET)
.head 8 -  ! Call FunNSIGetFilteredAltPK('LOM_MET', 'MET', 'NAME', 'nls is not null and nls9 is not null and nvl(cena,0)>0 and
     grp=' || sGr_id, sTmp, L_MET)
.head 8 -  Call FunNSIGetFilteredAltPK('LOM_MET', 'MET', 'NAME', 'nls9 is not null and nvl(cena,0)>0 and grp=' || sGr_id,
     sTmp, L_MET)
.head 8 -  ! Call Debug(sTmp)
.head 8 +  If sTmp != STRING_Null
.head 9 -  Set sExp = GetValueStr("
    select cod
    from   lom_isp
    where  userid=" || SalStrTrimX(Left(sExpert, 6)))
.head 9 -  ! Call Debug(sExp)
.head 9 +  If sGr_id = '5'
.head 10 -  Set sSqlMet = "
    SELECT m.cena,null,m.nls9,null,trim(substr(a9.nms,1,38)),m.proba,m.met1
    INTO   :L_CEN,:NLS,:NLS9,:NMS,:sNms9,:nProba,:nMet
    FROM   lom_met m, accounts a9
    WHERE  a9.kv=:n980 and a9.nls=m.nls9 and m.grp=:sGr_id and
           (replace(to_char(m.met),',','.')='" || sTmp || "' or
            replace(to_char(m.met),'.',',')='" || sTmp || "')"
.head 9 +  Else
.head 10 +  If sExp = 'EXP1'
.head 11 -  Set sSqlMet = "
    SELECT m.cena,m.nls,m.nls9,trim(substr(a2.nms,1,38)),trim(substr(a9.nms,1,38)),m.proba,m.met1
    INTO   :L_CEN,:NLS,:NLS9,:NMS,:sNms9,:nProba,:nMet
    FROM   lom_met m, accounts a2, accounts a9
    WHERE  a2.kv=:n980 and a9.kv=:n980 and a2.nls=m.nls and a9.nls=m.nls9 and m.grp=:sGr_id and
           (replace(to_char(m.met),',','.')='" || sTmp || "' or
            replace(to_char(m.met),'.',',')='" || sTmp || "')"
.head 10 +  Else
.head 11 -  Set sSqlMet = "
    SELECT m.cena,m.nls2,m.nls9,trim(substr(a2.nms,1,38)),trim(substr(a9.nms,1,38)),m.proba,m.met1
    INTO   :L_CEN,:NLS,:NLS9,:NMS,:sNms9,:nProba,:nMet
    FROM   lom_met m, accounts a2, accounts a9
    WHERE  a2.kv=:n980 and a9.kv=:n980 and a2.nls=m.nls2 and a9.nls=m.nls9 and m.grp=:sGr_id and
           (replace(to_char(m.met),',','.')='" || sTmp || "' or
            replace(to_char(m.met),'.',',')='" || sTmp || "')"
.head 9 -  ! Call Debug(sSqlMet)
.head 9 +  If SqlPrepareAndExecute(hSql(), sSqlMet) and SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Call SalEnableWindow(L_ZAG)
.head 10 -  Call SalEnableWindow(L_ZNJ)
.head 10 -  Call f_Summa()
.head 10 -  Call SalSetFocus(L_ZAG)
.head 10 -  Call SalMapEnterToTab(TRUE)
.head 9 +  Else
.head 10 -  ! Call Debug('Не описані рахунки обліку')
.head 10 -  Call MessageNoWait('Не описані або не існують рахунки обліку!', 'УВАГА!', 0, 1)
.head 10 -  ! Call SalDestroyWindow(hWndForm)
.head 3 +  Data Field: L_MET
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.133"
.head 6 -  Top:    3.452"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Ціна
.head 4 -  Resource Id: 44600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.033"
.head 5 -  Top:    3.548"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.238"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: L_CEN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.683"
.head 6 -  Top:    3.452"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: ЗАГ.вага
.head 4 -  Resource Id: 44598
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.533"
.head 5 -  Top:    3.94"
.head 5 -  Width:  1.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: L_ZAG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.75"
.head 6 -  Top:    3.881"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call f_Tochka(hWndItem)
.head 6 +  If L_ZAG = NUMBER_Null or L_ZAG <= 0
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Set L_LIG = L_ZAG - L_ZNJ
.head 6 -  Call f_Summa()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Знижка
.head 4 -  Resource Id: 44599
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.983"
.head 5 -  Top:    3.94"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: L_ZNJ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.083"
.head 6 -  Top:    3.881"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull(L_ZNJ)
.head 7 -  Call f_Tochka(hWndItem)
.head 7 +  If L_ZNJ < 0 or L_ZNJ > L_ZAG
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Set L_LIG = L_ZAG - L_ZNJ
.head 7 -  Call f_Summa()
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Лігатурна вага
.head 4 -  Resource Id: 44601
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.883"
.head 5 -  Top:    3.94"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: L_LIG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.583"
.head 6 -  Top:    3.881"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Сума
.head 4 -  Resource Id: 44602
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.033"
.head 5 -  Top:    3.94"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.238"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: L_SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.683"
.head 6 -  Top:    3.845"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Multiline Field: ml1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    4.31"
.head 6 -  Width:  11.617"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.464"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Data Field: sKVIT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.433"
.head 6 -  Top:    5.012"
.head 6 -  Width:  1.967"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Italic-Underline
.head 5 -  Text Color: Default
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: nRef
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.4"
.head 6 -  Top:    5.012"
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold-Italic-Underline
.head 5 -  Text Color: Default
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: sDETALI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.433"
.head 6 -  Top:    5.25"
.head 6 -  Width:  3.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Italic-Underline
.head 5 -  Text Color: Default
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    2.036"
.head 6 -  Width:  1.617"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NLS9
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    2.036"
.head 6 -  Width:  1.617"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  !
.head 3 +  Pushbutton: pb_New
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.25"
.head 5 -  Top:    4.976"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F1
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F1. Новий з витяжкою'
.head 5 +  On SAM_Click
.head 6 -  Call f_ClearO()
.head 6 -  Call SalHideWindow(pb_F5)
.head 3 +  Pushbutton: pb_Kup
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.9"
.head 5 -  Top:    4.976"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F10
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Execute.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F10. К У П И Т И '
.head 5 +  On SAM_Click
.head 6 -  Set bNoRek = FALSE
.head 6 +  If L_SUM >= 150000
.head 7 -  ! If SalIsNull(FIO) or SalIsNull(PASPS) or SalIsNull(PASPN) or SalIsNull(ATRT) or SalIsNull(ATRD) or
   SalIsNull(ADR) or SalIsNull(TEL) or SalIsNull(OKPO) or SalIsNull(Citizenship) or SalIsNull(BDAY)
.head 7 +  If SalIsNull(FIO) or SalIsNull(OKPO) or SalIsNull(PASPS) or SalIsNull(PASPN) or SalIsNull(ATRT) or
   SalIsNull(ATRD) or SalIsNull(ADR) or SalIsNull(TEL) or SalIsNull(Citizenship) or SalIsNull(BDAY)
.head 8 -  Set bNoRek = TRUE
.head 8 -  ! Call SalMessageBox('Не всі реквізити клієнта заповнені', 'Помилка заповнення реквізитів', MB_Ok)
.head 6 +  Else
.head 7 -  ! If SalIsNull(FIO) or SalIsNull(OKPO)
.head 7 +  If SalIsNull(FIO) or SalIsNull(OKPO)
.head 8 -  Set bNoRek = TRUE
.head 8 -  ! Call SalMessageBox('Не всі реквізити клієнта заповнені', 'Помилка заповнення реквізитів', MB_Ok)
.head 7 +  If OKPO = '0000000000' and (SalIsNull(PASPS) or SalIsNull(PASPN))
.head 8 -  Set bNoRek = TRUE
.head 8 -  ! Call SalMessageBox('Не всі реквізити клієнта заповнені', 'Помилка заповнення реквізитів', MB_Ok)
.head 6 +  If bNoRek
.head 7 -  Call SalMessageBox('Не всі реквізити клієнта заповнені', 'Помилка заповнення реквізитів', MB_Ok)
.head 6 +  Else
.head 7 +  If wLom.L_ZAG > 300 and wLom.L_EDN > 1 and sGr_id = '1'
.head 8 -  Call SalMessageBox('Загальна вага виробів перевищує 300 Гр.' || PutCrLf() ||
     'Прийміть їх декількома квитанціями', 'Увага!', MB_Ok)
.head 8 -  Call SalSetFocus(wLom.L_EDN)
.head 7 +  Else If wLom.L_EDN > 50
.head 8 -  Call SalMessageBox('Загальна кількість виробів перевищує 50 шт.' || PutCrLf() ||
     'Прийміть їх декількома квитанціями', 'Увага!', MB_Ok)
.head 8 -  Call SalSetFocus(wLom.L_EDN)
.head 7 +  Else
.head 8 +  If sGr_id = '4' or sGr_id = '5'
.head 9 -  Set sDETALI = "Купівля інвестиційних монет" || IifS(sGr_id='5', " (пошкоджені)", "")
.head 9 +  If rbG
.head 10 -  Call f_Opl('LO3', NLS, NMS, nVob, BankMfo, sNlsB, sNmsB, GetBankOkpoS(), sDETALI, nSk)
.head 9 +  Else
.head 10 +  If SalIsNull(dfNLS) or SalIsNull(dfNMS) or SalIsNull(dfOKPO) or SalIsNull(dfMFO) or SalIsNull(mlNAZN)
.head 11 -  Call SalMessageBox('Не заповнені всі реквізити для перерахування коштів', 'Помилка заповнення реквізитів',
     MB_Ok)
.head 10 +  Else
.head 11 -  Call f_Opl('LOB', NLS, NMS, nVob, dfMFO, dfNLS, dfNMS, dfOKPO, mlNAZN, NUMBER_Null)
.head 8 +  Else If sGr_id = '2' or sGr_id = '3'
.head 9 -  Set sDETALI = "Купівля банківських металів " || IifS(sGr_id='3', "не ", "") || "визнаного виробника"
.head 9 -  Call f_Opl('LO2', sNlsT, sNmsT, nVob, BankMfo, sNlsB, sNmsB, GetBankOkpoS(), sDETALI, nSk)
.head 8 +  Else
.head 9 -  Set sDETALI = "Купівля дорогоцінних металів в брухті"
.head 9 -  Call f_Opl('LO2', sNlsT, sNmsT, nVob, BankMfo, sNlsB, sNmsB, GetBankOkpoS(), sDETALI, nSk)
.head 3 +  Pushbutton: pb_Kom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.45"
.head 5 -  Top:    4.988"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F7
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\A_bkld.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F7. Взяти комісію за термінову оцінку'
.head 5 +  On SAM_Click
.head 6 -  Set sDETALI = "Комісія за термінову оцінку" 
.head 6 -  Call f_LO7(sDETALI)
.head 3 +  Pushbutton: pb_Exp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.35"
.head 5 -  Top:    4.976"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F9
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Docview.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F9. на ЭКСПЕРТИЗУ'
.head 5 +  On SAM_Click
.head 6 +  If SalIsNull(FIO) 
.head 7 -  Call SalMessageBox('Не введений реквізит ФІО клієнта', 'Помилка заповнення реквізитів', MB_Ok)
.head 6 +  Else
.head 7 -  Set sDETALI = "Принято для оцінки"
.head 7 -  Call f_Opl('LO9', NLS9, sNms9, nVob9, BankMfo, sNlsB9, sNmsB9, GetBankOkpoS(), sDETALI, NUMBER_Null)
.head 3 +  Pushbutton: pb_F5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbPrint
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.8"
.head 5 -  Top:    4.976"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F5
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F5. Друкувати квитанцію'
.head 5 +  On SAM_Click
.head 6 +  If wParam
.head 7 -  Set cDoc.m_nRef = wParam
.head 6 -  Call cDoc.pDoc()
.head 3 -  !
.head 3 +  Pushbutton: pb_Clear
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbRefresh
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.7"
.head 5 -  Top:    4.976"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F8
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F8. Новий з очисткою'
.head 5 +  On SAM_Click
.head 6 -  Call f_ClearD()
.head 6 -  Call f_ClearO()
.head 6 -  Call SalHideWindow(pb_F5)
.head 3 +  Pushbutton: pb_Exit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.15"
.head 5 -  Top:    4.976"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'ESC. Завершити'
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 -  !
.head 3 -  Line
.head 4 -  Resource Id: 61461
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.383"
.head 5 -  Begin Y:  1.262"
.head 5 -  End X:  12.333"
.head 5 -  End Y:  1.262"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 +  Data Field: T_NOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.183"
.head 6 -  Top:    2.726"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmb2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    5.881"
.head 5 -  Width:  4.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.06"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If bCAS_P
.head 7 -  Call SalListPopulate(hWndItem, hSql(), T("
     select lpad(to_char(m_isp),6)||' '||m_nms
     from   (select m_isp,m_nms
             from   V_CASKC_K
             union
             select z_isp,z_nms
             from   V_CASKC_Z) order by m_isp"))
.head 3 +  ! Combo Box: cmbExpert
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    5.238"
.head 5 -  Width:  4.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.06"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SalListPopulate(hWndItem, hSql(), T("
     select lpad(to_char(userid),6)||' '||fio
     from   lom_isp
     where  cod in ('EXP1','EXP2')
     order by userid"))
.head 6 -  Set nEntries = SalListQueryCount(hWndItem) 
.head 6 -  Set nI = 0
.head 6 +  While nI < nEntries
.head 7 -  Call SalListSetSelect(hWndItem, nI)
.head 7 +  If Val(Left(cmbExpert, 6)) = GetUserId()
.head 8 -  Break 
.head 7 -  Set nI = nI + 1
.head 6 +  If nI = nEntries
.head 7 -  Call SalListSetSelect(hWndItem, 0)
.head 3 +  Data Field: df30
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.383"
.head 6 -  Top:    5.69"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 18694
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.45"
.head 5 -  Top:    5.417"
.head 5 -  Width:  4.917"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.798"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Gray
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFormaR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.467"
.head 6 -  Top:    5.5"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Radio Button: rbG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Готівкова
.head 4 -  Window Location and Size
.head 5 -  Left:   10.383"
.head 5 -  Top:    5.702"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If rbG
.head 7 -  Call SalHideWindow(dfZagPer)
.head 7 -  Call SalHideWindow(dfZagMFO)
.head 7 -  Call SalHideWindow(dfZagNLS)
.head 7 -  Call SalHideWindow(dfZagNMS)
.head 7 -  Call SalHideWindow(dfZaOKPO)
.head 7 -  Call SalHideWindow(dfZaNAZN)
.head 7 -  Call SalHideWindow(dfMFO)
.head 7 -  Call SalHideWindow(dfNLS)
.head 7 -  Call SalHideWindow(dfNMS)
.head 7 -  Call SalHideWindow(dfOKPO)
.head 7 -  Call SalHideWindow(mlNAZN)
.head 3 +  Radio Button: rbN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Безготівкова
.head 4 -  Window Location and Size
.head 5 -  Left:   10.383"
.head 5 -  Top:    5.94"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If rbN
.head 7 -  Call SalShowWindow(dfZagPer)
.head 7 -  Call SalShowWindow(dfZagMFO)
.head 7 -  Call SalShowWindow(dfZagNLS)
.head 7 -  Call SalShowWindow(dfZagNMS)
.head 7 -  Call SalShowWindow(dfZaOKPO)
.head 7 -  Call SalShowWindow(dfZaNAZN)
.head 7 -  Call SalShowWindow(dfMFO)
.head 7 -  Call SalShowWindow(dfNLS)
.head 7 -  Call SalShowWindow(dfNMS)
.head 7 -  Call SalShowWindow(dfOKPO)
.head 7 -  Call SalShowWindow(mlNAZN)
.head 3 -  !
.head 3 +  Data Field: dfZagPer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.533"
.head 6 -  Top:    6.274"
.head 6 -  Width:  6.817"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfZagMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.55"
.head 6 -  Top:    6.524"
.head 6 -  Width:  2.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfZagNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.55"
.head 6 -  Top:    6.762"
.head 6 -  Width:  2.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfZagNMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.55"
.head 6 -  Top:    7.0"
.head 6 -  Width:  2.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfZaOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.55"
.head 6 -  Top:    7.238"
.head 6 -  Width:  2.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfZaNAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.533"
.head 6 -  Top:    7.464"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  !
.head 4 -  Message Actions 
.head 3 +  Data Field: dfMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    6.488"
.head 6 -  Width:  4.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Set dfNLS = ''
.head 5 +  On SAM_Validate
.head 6 +  If not DopustMfo0(dfMFO) or VisStrTrim(dfMFO) != VisStrRightTrim(dfMFO)
.head 7 -  Call MessageNoWait('Неприпустимий код банку (МФО)!', 'Увага!', 7, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set dfMFO = VisStrRightTrim(dfMFO)
.head 7 +  If Len(dfMFO) > 0
.head 8 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Maize)
.head 8 -  Call XSalTooltipShow(hWndItem, GetValueStr("
     SELECT NB
     FROM   banks
     WHERE  mfo=" || dfMFO))
.head 8 -  Call SalMessageBeep(MB_Ok)
.head 7 -  Return VALIDATE_Ok
.head 5 +  ! On SAM_SetFocus
.head 6 -  ! Call SalMapEnterToTab(TRUE)
.head 6 +  If Len(dfMFO) > 0 and DopustMfo0(dfMFO)
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Maize)
.head 7 -  Call XSalTooltipShow(hWndItem, GetValueStr("
     SELECT NB
     FROM   banks
     WHERE  mfo=" || dfMFO))
.head 7 -  Call SalMessageBeep(MB_Ok)
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Call SalMapEnterToTab(TRUE)
.head 6 +  If Len(dfMFO) > 0 and DopustMfo0(dfMFO)
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Maize)
.head 7 -  Call XSalTooltipShow(hWndItem, GetValueStr("
     SELECT NB
     FROM   banks
     WHERE  mfo=" || dfMFO))
.head 7 -  Call SalMessageBeep(MB_Ok)
.head 5 +  ! On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 3 +  Data Field: dfNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    6.726"
.head 6 -  Width:  4.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 +  If not dfMFO
.head 7 -  Set dfNLS = ''
.head 7 -  Call MessageNoWait('Введіть код банку (МФО)!', 'Попередження!', 3, 1)
.head 7 -  Call SalSetFocus(dfMFO)
.head 5 +  On SAM_Validate
.head 6 +  If not DopustNls(dfNLS, dfMFO) or VisStrTrim(dfNLS) != VisStrRightTrim(dfNLS)
.head 7 -  Call MessageNoWait('Неприпустимий рахунок!', 'Увага!', 7, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set dfNLS = VisStrRightTrim(dfNLS)
.head 7 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    6.964"
.head 6 -  Width:  4.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If VisStrTrim(dfNMS) != VisStrRightTrim(dfNMS)
.head 7 -  Call MessageNoWait('Неприпустима назва рахунку!', 'Увага!', 7, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set dfNMS = VisStrRightTrim(dfNMS)
.head 7 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    7.202"
.head 6 -  Width:  4.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If Len(dfOKPO) = 0
.head 7 -  Return VALIDATE_Ok
.head 6 +  If not DopustOKPO(dfOKPO)
.head 7 -  Call MessageNoWait('Неприпустимий код ЄДР' || IifS(Len(VisStrTrim(dfOKPO))!=8, 'ФО!', 'ПОУ!'), 'Увага!', 7, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set dfOKPO = VisStrRightTrim(dfOKPO)
.head 7 +  If Len(dfOKPO) = 10 and dfOKPO != '0000000000'
.head 8 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Gray)
.head 8 -  Call XSalTooltipShow(hWndItem, IifS(Mod(Val(Subs(dfOKPO, 9, 1)) ,2)=0, 'ж', 'ч'))
.head 8 -  Call SalMessageBeep(MB_Ok)
.head 7 -  Return VALIDATE_Ok
.head 5 +  ! On SAM_SetFocus
.head 6 +  If Len(dfOKPO) = 10 and DopustOKPO(dfOKPO)
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Gray)
.head 7 -  Call XSalTooltipShow(hWndItem, IifS(Mod(Val(Subs(dfOKPO, 9, 1)), 2)=0, 'ж', 'ч'))
.head 7 -  Call SalMessageBeep(MB_Ok)
.head 5 +  On SAM_TooltipSetText
.head 6 +  If Len(dfOKPO) = 10 and DopustOKPO(dfOKPO) and dfOKPO != '0000000000'
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_Gray)
.head 7 -  Call XSalTooltipShow(hWndItem, IifS(Mod(Val(Subs(dfOKPO, 9, 1)), 2)=0, 'ж', 'ч'))
.head 7 -  Call SalMessageBeep(MB_Ok)
.head 3 +  Multiline Field: mlNAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   5.55"
.head 6 -  Top:    7.726"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.643"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: White
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If VisStrTrim(mlNAZN) != VisStrRightTrim(mlNAZN)
.head 7 -  Call MessageNoWait('Неприпустиме призначення платежу!', 'Увага!', 7, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set mlNAZN = VisStrRightTrim(mlNAZN)
.head 7 -  Return VALIDATE_Ok
.head 2 +  Functions
.head 3 +  Function: f_LO7
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sNazn
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: NLS6
.head 5 -  String: NLS1
.head 5 -  String: NMS6
.head 5 -  String: NMS1
.head 5 -  Number: SK
.head 5 -  Number: VOB
.head 5 -  Number: SUM
.head 5 -  String: sPasp
.head 5 -  String: sAtrt
.head 5 -  !
.head 5 -  Number: nCountUpd
.head 5 -  String: sBday
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT a6.nls,trim(substr(a6.nms,1,38)),a1.nls,trim(substr(a1.nms,1,38)),t.sk,v.vob,to_number(t.s)
   INTO   :NLS6,:NMS6,:NLS1,:NMS1,:SK,:VOB,:SUM
   FROM   tts t, accounts a6, accounts a1, TTS_VOB v
   WHERE  rownum=1 and v.tt=t.tt AND a6.kv=:n980 and a1.kv=:n980 and a6.nls=sb_acc(t.nlsm,'') and
          a1.nls=sb_acc(t.nlsk,'') and t.tt='LO7' and to_number(nvl(t.s,0))>0") and not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Call Debug("Не описана операція LO7 !")
.head 6 -  Call MessageNoWait('Не описана операція LO7 або не існують рахунки з опису операції!', 'УВАГА!', 0, 1)
.head 6 -  ! Call SalDestroyWindow(hWndForm)
.head 6 -  Return FALSE
.head 5 -  Set nRef = NUMBER_Null
.head 5 -  Call cDoc.SetDoc(nRef, 'LO7', 0, VOB, Str(nRef), BankDate, BankDate, BankDate, BankDate, NLS6, NMS6, BankMfo, '', n980,
     SUM, GetBankOkpoS(), NLS1, NMS1, BankMfo, '', n980, SUM, GetBankOkpoS(), sNazn, '', GetIdOper(), '', SK, 0)
.head 5 +  If cDoc.oDoc()
.head 6 -  Set nRef = cDoc.m_nRef
.head 6 -  Set sPasp = SalStrTrimX(PASPS || ' ' || PASPN)
.head 6 -  Set sAtrt = SalStrTrimX(ATRT || ' ' || SalFmtFormatDateTime(ATRD, 'dd/MM/yyyy'))
.head 6 -  Set sBday = SalFmtFormatDateTime(BDAY, 'dd/MM/yyyy')
.head 6 -  !
.head 6 -  Set nCountUpd = 0
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   update lom_w
   set    fio  =:FIO,
          pasp =:sPasp,
          atrt =:sAtrt,
          adres=:ADR,
          phone=:TEL,
          okpo =:OKPO,
          bday =:sBday,
          citiz=:Citizenship
   where  ref=:nRef")
.head 7 -  Call SqlGetModifiedRows(hSql(), nCountUpd)
.head 7 +  If nCountUpd = 0
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   lom_w (ref,fio,pasp,atrt,adres,phone,okpo,bday,grp,proba,met,citiz)
         values (:nRef,:FIO,:sPasp,:sAtrt,:ADR,:TEL,:OKPO,:sBday,:sGR_id,:nProba,:nMet,:Citizenship)")
.head 9 +  ! If SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'FIO'  ,:FIO)")   and
   SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'PASP' ,:sPasp)") and
   SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'ATRT' ,:sAtrt)") and
   SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'ADRES',:ADR)")   and
   SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'PHONE',:TEL)")   and
   SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'OKPO' ,:OKPO)")  and
   SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'BDAY' ,:sBday)") and
   SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'CITIZ',:Citizenship)")
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SalShowWindow(sKVIT)
.head 10 -  Call SalShowWindow(sDETALI)
.head 10 -  Call SalShowWindow(nRef)
.head 10 -  Call SalSendMsg(pb_F5, SAM_Click, 0, 0)
.head 10 -  !
.head 10 -  Call SalShowWindow(pb_F5)
.head 10 -  Call SalShowWindow(pb_New)
.head 10 -  !
.head 10 -  Call SalHideWindow(pb_Kup)
.head 10 -  Call SalHideWindow(pb_Kom)
.head 10 -  Call SalHideWindow(pb_Exp)
.head 10 -  Return TRUE
.head 9 +  If i_OPERW(nRef, 'FIO'  , FIO)         and i_OPERW(nRef, 'PASP' , sPasp)     and
   i_OPERW(nRef, 'ATRT' , sAtrt)       and i_OPERW(nRef, 'ADRES', ADR)       and
   i_OPERW(nRef, 'PHONE', TEL)         and i_OPERW(nRef, 'OKPO' , OKPO)      and
   i_OPERW(nRef, 'BDAY' , sBday)       and i_OPERW(nRef, 'GRP'  , sGr_id)    and
   i_OPERW(nRef, 'PROBA', Str(nProba)) and i_OPERW(nRef, 'MET'  , Str(nMet)) and
   i_OPERW(nRef, 'CITIZ', Citizenship)
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SalShowWindow(sKVIT)
.head 10 -  Call SalShowWindow(sDETALI)
.head 10 -  Call SalShowWindow(nRef)
.head 10 -  Call SalSendMsg(pb_F5, SAM_Click, 0, 0)
.head 10 -  !
.head 10 -  Call SalShowWindow(pb_F5)
.head 10 -  Call SalShowWindow(pb_New)
.head 10 -  !
.head 10 -  Call SalHideWindow(pb_Kup)
.head 10 -  Call SalHideWindow(pb_Kom)
.head 10 -  Call SalHideWindow(pb_Exp)
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Return FALSE
.head 5 +  Else
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Return FALSE
.head 3 +  Function: f_Opl
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sTT
.head 5 -  String: sNls
.head 5 -  String: sNms
.head 5 -  Number: nVob
.head 5 -  String: sMFOB
.head 5 -  String: sNlsB
.head 5 -  String: sNmsB
.head 5 -  String: sOKPOB
.head 5 -  String: sNazn
.head 5 -  Number: nSk 
.head 5 -  ! Call f_Opl('LOB', NLS, NMS, nVob, dfMFO, dfNLS, dfNMS, dfOKPO, mlNAZN, NUMBER_Null)
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSum
.head 5 -  Number: ref_LO1
.head 5 -  String: ref_LO2
.head 5 -  String: FORMUL
.head 5 -  Number: S2
.head 5 -  Number: i
.head 5 -  !
.head 5 -  Number: nRefLOA
.head 5 -  String: sNlsm
.head 5 -  String: sNlsk
.head 5 -  String: sNlsa
.head 5 -  String: sNmsa
.head 5 -  String: sNlsb
.head 5 -  String: sNmsb
.head 5 -  Number: nKVA
.head 5 -  Number: nKVK
.head 5 -  !
.head 5 -  String: sOkpob
.head 5 -  String: sOkpoa
.head 5 -  !
.head 5 -  String: sVOKPO
.head 5 -  !
.head 5 -  String: sPaspB
.head 4 +  Actions
.head 5 -  ! Call Debug('
sTT   = ' || sTT       || '
sNls  = ' || sNls      || '
sNms  = ' || sNms      || '
nVob  = ' || Str(nVob) || '
sMFOB = ' || sMFOB     || '
sNlsB = ' || sNlsB     || '
sNmsB = ' || sNmsB     || '
sOKPOB= ' || sOKPOB    || '
sNazn = ' || sNazn     || '
NLS   = ' || NLS       || '
NMS   = ' || NMS       || '
)
.head 5 -  Set nRef = NUMBER_Null
.head 5 -  Set nSum = L_SUM * 100 
.head 5 +  If sTT = 'LO2' and nLO2 = 2
.head 6 -  ! Set nRef = NUMBER_Null
.head 6 -  Call cDoc.SetDoc(nRef, 'LO1', 1, 6, Str(nRef), BankDate, BankDate, BankDate, BankDate, NLS, NMS, BankMfo, '', n980,
     nSum, GetBankOkpoS(), sNlsT, sNmsT, sMFOB, '', n980, nSum, sOKPOB, sNazn, '',GetIdOper(), '', NUMBER_Null, 0)
.head 6 +  If not cDoc.oDoc() or not f_OPERW(cDoc.m_nRef, 'LO1')
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 6 -  Set ref_LO1 = cDoc.m_nRef
.head 5 +  Else If sTT = 'LO2'
.head 6 -  Set sNls = NLS
.head 6 -  Set sNms = NMS
.head 5 -  ! If SqlPrepareAndExecute(hSql(), "
   SELECT S
   INTO   :FORMUL
   FROM   tts
   where  tt='LOR'")
.head 5 +  If sTT = 'LO2' or sTT = 'LO3' or sTT = 'LOB'
.head 6 +  If sTT = 'LOB'
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   SELECT S2
   INTO   :FORMUL
   FROM   tts
   where  tt='LOS'")
.head 8 +  If SqlFetchNext(hSql(), NFeechRez)
.head 9 -  Set FORMUL = SalStrUpperX(FORMUL)
.head 9 +  Loop
.head 10 -  ! Set i = SalStrScan(FORMUL, '#(S)')
.head 10 -  Set i = SalStrScan(FORMUL, '#(S2)')
.head 10 +  If i = -1
.head 11 -  Break
.head 10 -  ! Set FORMUL = SalStrReplaceX(FORMUL, i, 4, SalNumberToStrX(nSum, 0))
.head 10 -  Set FORMUL = SalStrReplaceX(FORMUL, i, 5, Str(nSum))
.head 9 +  If SqlPrepareAndExecute(hSql(), "
   select " || FORMUL || "
   into   :S2
   from   dual")
.head 10 -  Call SqlFetchNext(hSql(), NFeechRez)
.head 8 +  Else
.head 9 -  Call SalMessageBox('В операции LOS не прописана формула суммы!', 'Внимание!', MB_Ok)
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Call SalMessageBox('В операции LOS не прописана формула суммы!', 'Внимание!', MB_Ok)
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   SELECT S2
   INTO   :FORMUL
   FROM   tts
   where  tt='LOR'")
.head 8 +  If SqlFetchNext(hSql(), NFeechRez)
.head 9 -  Set FORMUL = SalStrUpperX(FORMUL)
.head 9 +  Loop
.head 10 -  ! Set i = SalStrScan(FORMUL, '#(S)')
.head 10 -  Set i = SalStrScan(FORMUL, '#(S2)')
.head 10 +  If i = -1
.head 11 -  Break
.head 10 -  ! Set FORMUL = SalStrReplaceX(FORMUL, i, 4, SalNumberToStrX(nSum, 0))
.head 10 -  Set FORMUL = SalStrReplaceX(FORMUL, i, 5, Str(nSum))
.head 9 +  If SqlPrepareAndExecute(hSql(), "
   select " || FORMUL || "
   into   :S2
   from   dual")
.head 10 -  Call SqlFetchNext(hSql(), NFeechRez)
.head 8 +  Else
.head 9 -  Call SalMessageBox('В операции LOR не прописана формула суммы!', 'Внимание!', MB_Ok)
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Call SalMessageBox('В операции LOR не прописана формула суммы!', 'Внимание!', MB_Ok)
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Return FALSE
.head 5 -  !
.head 5 -  ! Call Debug('sTT='||sTT)
.head 5 -  ! Call Debug('sNls='||sNls)
.head 5 -  ! Call Debug('sNlsB='||sNlsB)
.head 5 -  !
.head 5 +  If sTT = 'LO9'
.head 6 -  Call cDoc.SetDoc(nRef, sTT, 1, nVob, Str(nRef), BankDate, BankDate, BankDate, BankDate, sNls, sNms, BankMfo, '', n980,
     nSum, GetBankOkpoS(), sNlsB, sNmsB, sMFOB, '', n980, nSum, sOKPOB, sNazn, '', GetIdOper(), '', nSk, 0)
.head 5 +  Else
.head 6 -  ! Call Debug('
sTT   = ' || sTT       || '
sNls  = ' || sNls      || '
sNms  = ' || sNms      || '
nVob  = ' || Str(nVob) || '
sMFOB = ' || sMFOB     || '
sNlsB = ' || sNlsB     || '
sNmsB = ' || sNmsB     || '
sOKPOB= ' || sOKPOB    || '
sNazn = ' || sNazn
)
.head 6 +  If sTT != 'LOB'
.head 7 -  Call cDoc.SetDoc(nRef, sTT, 1, nVob, Str(nRef), BankDate, BankDate, BankDate, BankDate, sNls, sNms, BankMfo, '',
     n980, S2, GetBankOkpoS(), sNlsB, sNmsB, sMFOB, '', n980, nSum, sOKPOB, sNazn, '', GetIdOper(), '', nSk, 0)
.head 6 +  Else !! = 'LOB'
.head 7 -  ! Call cDoc.SetDoc(nRef, 'LOA', 1, nVob, Str(nRef), BankDate, BankDate, BankDate, BankDate, sNls, sNms, BankMfo, '',
     n980, S2, GetBankOkpoS(), sNlsB, sNmsB, sMFOB, '', n980, nSum, sOKPOB, sNazn, '', GetIdOper(), '', nSk, 0)
.head 7 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT nlsm,nlsk,kv,kvk
     INTO   :sNlsm,:sNlsk,:nKVA,:nKVK
     FROM   tts
     WHERE  tt='LOA'")
.head 7 +  If SqlFetchNext(hSql(), NFeechRez)
.head 8 -  ! Call Debug('sNlsm = ' || sNlsm)
.head 8 -  ! Call Debug('sNlsk = ' || sNlsk)
.head 8 +  If Left(sNlsm, 1) = '#' !! формула
.head 9 -  Set sNlsm = VisStrSubstitute(Right(sNlsm, Len(sNlsm)-1), '#(KVA)', Str(nKVA))
.head 9 -  Set sNlsa = GetValueStr("
    SELECT substr(" || sNlsm || ",1,20)
    FROM   dual")
.head 8 +  Else
.head 9 -  Set sNlsa = SalStrTrimX(sNlsm)
.head 8 -  !
.head 8 +  If Left(sNlsk, 1) = '#' !! формула
.head 9 -  Set sNlsk = VisStrSubstitute(Right(sNlsk, Len(sNlsk)-1), '#(KVA)', Str(nKVK))
.head 9 -  ! Call Debug('sNlsk = ' || sNlsk)
.head 9 -  Set sNlsb = GetValueStr("
    SELECT substr(" || sNlsk || ",1,20)
    FROM   dual")
.head 8 +  Else
.head 9 -  Set sNlsb = SalStrTrimX(sNlsk)
.head 8 -  ! Call Debug('sNlsb = ' || sNlsb)
.head 7 +  Else
.head 8 -  Set sNlsa = ''
.head 8 -  Set sNlsb = ''
.head 7 -  !
.head 7 +  If sNlsb = ''
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call MessageNoWait('Помилка налаштування! В картці оперції LOA не вказаний рахунок Б для ОПЛАТИ.', 'УВАГА!', 371,
     1)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Set sNmsb = GetValueStr("
    SELECT nms
    FROM   accounts
    WHERE  nls='" || sNlsb || "' and kv=" || Str(nKVK))
.head 8 -  !
.head 8 -  Set sOkpob = GetValueStr("
    SELECT c.okpo
    FROM   customer c, accounts a
    WHERE  a.nls='" || sNlsb || "' and a.kv=980 and c.rnk=a.rnk")
.head 7 -  !
.head 7 +  If sNlsa = ''
.head 8 -  Set sNlsa = sNls
.head 8 -  Set sNmsa = sNms
.head 7 +  Else
.head 8 -  Set sNmsa = GetValueStr("
    SELECT nms
    FROM   accounts
    WHERE  nls='" || sNlsa || "' and kv=" || Str(nKVA))
.head 7 -  !
.head 7 -  Set sOkpoa = GetValueStr("
    SELECT c.okpo
    FROM   customer c, accounts a
    WHERE  a.nls='" || sNlsa || "' and a.kv=980 and c.rnk=a.rnk")
.head 7 -  !
.head 7 -  ! Call Debug('
sNlsa = '          || sNlsa          || '
sNmsa = '          || sNmsa          || '
BankMfo = '        || BankMfo        || '
GetBankOkpoS() = ' || GetBankOkpoS() || '
sNlsb = '          || sNlsb          || '
sNmsb = '          || sNmsb          || '
sOkpob = '         || sOkpob         || '
sNazn = '          || sNazn          || '
GetIdOper() = '    || GetIdOper())
.head 7 -  !
.head 7 -  ! Call cDoc.SetDoc(nRef, 'LOA', 1, nVobLOA, Str(nRef), BankDate, BankDate, BankDate, BankDate, sNlsa, sNmsa, BankMfo,
     '', n980, nSum, GetBankOkpoS(), sNlsb, sNmsb, BankMfo, '', n980, nSum, sOkpob, sNazn, '', GetIdOper(), '',
     NUMBER_Null, 0)
.head 7 -  Call cDoc.SetDoc(nRef, 'LOA', 1, nVobLOA, Str(nRef), BankDate, BankDate, BankDate, BankDate, sNlsa, sNmsa, BankMfo,
     '', n980, nSum, sOkpoa, sNlsb, sNmsb, BankMfo, '', n980, nSum, sOkpob, sNazn, '', GetIdOper(), '', NUMBER_Null,
     0)
.head 7 -  !
.head 7 +  If cDoc.oDoc() and f_OPERW(cDoc.m_nRef, 'LOA')
.head 8 -  Set nRefLOA = cDoc.m_nRef
.head 8 -  Set nRef = NUMBER_Null
.head 8 -  !
.head 8 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT nlsm,kv
     INTO   :sNlsm,:nKVA
     FROM   tts
     WHERE  tt='LOB'")
.head 8 +  If SqlFetchNext(hSql(), NFeechRez)
.head 9 +  If Left(sNlsm, 1) = '#' !! формула
.head 10 -  Set sNlsm = VisStrSubstitute(Right(sNlsm, Len(sNlsm)-1), '#(KVA)', Str(nKVA))
.head 10 -  Set sNlsa = GetValueStr("
    SELECT substr(" || sNlsm || ",1,20)
    FROM   dual")
.head 9 +  Else
.head 10 -  Set sNlsa = SalStrTrimX(sNlsm)
.head 8 +  Else
.head 9 -  Set sNlsa = ''
.head 8 -  !
.head 8 +  If sNlsa = ''
.head 9 -  Set sNlsa = sNls
.head 9 -  Set sNmsa = sNms
.head 8 +  Else
.head 9 -  Set sNmsa = GetValueStr("
    SELECT nms
    FROM   accounts
    WHERE  nls='" || sNlsa || "' and kv=" || Str(nKVA))
.head 8 -  !
.head 8 -  Set sOkpoa = GetValueStr("
    SELECT c.okpo
    FROM   customer c, accounts a
    WHERE  a.nls='" || sNlsa || "' and a.kv=980 and c.rnk=a.rnk")
.head 8 -  !
.head 8 -  ! Call cDoc.SetDoc(nRef, 'LOB', 1, nVob, Str(nRef), BankDate, BankDate, BankDate, BankDate, sNls, sNms, BankMfo,
     '', n980, S2, GetBankOkpoS(), sNlsB, sNmsB, sMFOB, '', n980, nSum, sOKPOB, sNazn, '', GetIdOper(), '',
     NUMBER_Null, 0)
.head 8 -  Call cDoc.SetDoc(nRef, 'LOB', 1, nVobLOB, Str(nRef), BankDate, BankDate, BankDate, BankDate, sNlsa, sNmsa,
     BankMfo, '', n980, S2, sOkpoa, sNlsB, sNmsB, sMFOB, '', n980, nSum, sOKPOB, sNazn, '', GetIdOper(), '',
     NUMBER_Null, 0)
.head 8 -  ! If cDoc.oDoc() and SqlPrepareAndExecute(hSql(), "
   UPDATE oper
   SET    refl=:cDoc.m_nRef
   WHERE  ref=:nRefLOA") and SqlPrepareAndExecute(hSql(), "
   UPDATE oper
   SET    chk=null
   WHERE  ref=:cDoc.m_nRef") and SqlPrepareAndExecute(hSql(), "
   UPDATE oper
   SET    nextvisagrp='XX',currvisagrp=null
   WHERE  ref=:cDoc.m_nRef")
.head 8 +  If cDoc.oDoc()
.head 9 -  Set nRef = cDoc.m_nRef
.head 9 -  Set sPaspB = SalStrTrimX(PASPS || ' ' || PASPN)
.head 9 +  If IifN(dfOKPO='0000000000', IifN(i_OPERW(nRef, 'ф', sPaspB), 1, 0), 1)=1 and
   IifN(dfOKPO='0000000000', IifN(i_d_rec(nRef, 'ф', sPaspB), 1, 0), 1)=1
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SalShowWindow(sKVIT)
.head 10 -  Call SalShowWindow(sDETALI)
.head 10 -  Call SalShowWindow(nRef)
.head 10 -  ! Set cDoc.m_nRef = nRefLOA
.head 10 -  ! Call SalSendMsg(pb_F5, SAM_Click, 0, 0)
.head 10 -  Call SalSendMsg(pb_F5, SAM_Click, nRefLOA, 0)
.head 10 -  ! Set cDoc.m_nRef = nRef
.head 10 -  !
.head 10 -  Call SalShowWindow(pb_F5)
.head 10 -  Call SalShowWindow(pb_New)
.head 10 -  !
.head 10 -  Call SalHideWindow(pb_Kup)
.head 10 -  Call SalHideWindow(pb_Kom)
.head 10 -  Call SalHideWindow(pb_Exp)
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Return FALSE
.head 5 +  If cDoc.oDoc() and f_OPERW(cDoc.m_nRef, sTT)
.head 6 -  Set nRef = cDoc.m_nRef
.head 6 -  Set bLL = TRUE
.head 6 -  Set bO2 = TRUE
.head 6 -  Set bLIM = TRUE
.head 6 +  If sTT = 'LO2' or sTT = 'LO3'
.head 7 -  ! контроль лимита
.head 7 -  Set bLIM = f_limit(OKPO, PASPS, PASPN, nSum/100)
.head 7 +  If bLIM
.head 8 -  ! записать сумму операции (insert) в LOMDAT и в LOMALL
.head 8 -  Set sVOKPO = IifS(OKPO='0000000000', PASPS || PASPN, OKPO)
.head 8 -  Set bLL = SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   lomdat (DATO,DATB,FIO,OKPO,S,REF,BRANCH)
          VALUES (trunc(sysdate),:BankDate,:FIO,:sVOKPO,:nSum,:nRef,sys_context('bars_context','user_branch'))")
   and SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   lomall (DATO,DATB,FIO,OKPO,S,REF,BRANCH)
          VALUES (trunc(sysdate),:BankDate,:FIO,:sVOKPO,:nSum,:nRef,sys_context('bars_context','user_branch'))")
.head 7 +  Else
.head 8 -  ! выдать сообщение
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call MessageNoWait('Перевищення суми доходу отриманого одним продавцем інвестиційних монет протягом одного дня, '
     || 'операція відхилена! Введіть реквізити для безготівкової операції.', 'УВАГА!', 3711, 1)
.head 8 -  Set rbN = 1
.head 8 -  Call SalShowWindow(dfZagPer)
.head 8 -  Call SalShowWindow(dfZagMFO)
.head 8 -  Call SalShowWindow(dfZagNLS)
.head 8 -  Call SalShowWindow(dfZagNMS)
.head 8 -  Call SalShowWindow(dfZaOKPO)
.head 8 -  Call SalShowWindow(dfZaNAZN)
.head 8 -  Call SalShowWindow(dfMFO)
.head 8 -  Call SalShowWindow(dfNLS)
.head 8 -  Call SalShowWindow(dfNMS)
.head 8 -  Call SalShowWindow(dfOKPO)
.head 8 -  Call SalShowWindow(mlNAZN)
.head 8 -  Call SalSetFocus(dfMFO)
.head 8 -  Return FALSE
.head 6 -  ! Call SqlPrepareAndExecute(hSql(), "
     UPDATE oper
     set s2=(select max(s)
             from   opldok
             where ref=:nRef and tt='LOR' and dk=1)
     where ref=:nRef")
.head 6 +  If sTT = 'LO2' and nLO2 = 2
.head 7 -  Set ref_LO2 = SalNumberToStrX(cDoc.m_nRef,0)
.head 7 -  Set bO2 = SqlPrepareAndExecute(hSql(), "
    INSERT
    INTO   operw (ref,tag,value)
          VALUES (:ref_LO1,'L_LO2',:ref_LO2)")
.head 6 +  If bLL and bO2 and bLIM
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalShowWindow(sKVIT)
.head 7 -  Call SalShowWindow(sDETALI)
.head 7 -  Call SalShowWindow(nRef)
.head 7 -  Call SalSendMsg(pb_F5, SAM_Click, 0, 0)
.head 7 -  !
.head 7 -  Call SalShowWindow(pb_F5)
.head 7 -  Call SalShowWindow(pb_New)
.head 7 -  !
.head 7 -  Call SalHideWindow(pb_Kup)
.head 7 -  Call SalHideWindow(pb_Kom)
.head 7 -  Call SalHideWindow(pb_Exp)
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Return FALSE
.head 3 +  Function: f_ClearO !! сделка
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalHideWindow(sKVIT)
.head 5 -  Call SalHideWindow(sDETALI)
.head 5 -  Call SalHideWindow(nRef)
.head 5 -  Set L_GRP   = STRING_Null
.head 5 -  Set L_IZD   = STRING_Null
.head 5 -  Set L_MET   = STRING_Null
.head 5 -  Set L_CEN   = NUMBER_Null
.head 5 -  Set L_EDN   = NUMBER_Null
.head 5 -  Set L_ZAG   = NUMBER_Null
.head 5 -  Set L_ZNJ   = NUMBER_Null
.head 5 -  Set L_LIG   = NUMBER_Null
.head 5 -  Set L_SUM   = NUMBER_Null
.head 5 -  !
.head 5 -  Set L_NOM   = NUMBER_Null
.head 5 -  Set NLS2210 = STRING_Null
.head 5 -  Set NLS2223 = STRING_Null
.head 5 -  Set NLS2749 = STRING_Null
.head 5 -  Set NLS9819 = STRING_Null
.head 5 -  !
.head 5 -  Set ml1     = STRING_Null
.head 5 -  Call SalDisableWindow(L_EDN)
.head 5 -  Call SalDisableWindow(L_ZAG)
.head 5 -  Call SalDisableWindow(L_ZNJ)
.head 5 -  !
.head 5 -  Call SalHideWindow(pb_New)
.head 5 -  Call SalHideWindow(pb_Kup)
.head 5 -  Call SalHideWindow(pb_Kom)
.head 5 -  Call SalHideWindow(pb_Exp)
.head 5 -  Call SalHideWindow(pb_F5)
.head 5 -  !
.head 5 -  ! Call SalDisableWindow(BDAY)
.head 5 -  ! Call SalDisableWindow(Citizenship)
.head 5 -  ! Call SalDisableWindow(PASPS)
.head 5 -  ! Call SalDisableWindow(PASPN)
.head 5 -  ! Call SalDisableWindow(ATRT)
.head 5 -  ! Call SalDisableWindow(ATRD)
.head 5 -  ! Call SalDisableWindow(ADR)
.head 5 -  ! Call SalDisableWindow(TEL)
.head 5 -  !
.head 5 -  Call SalDisableWindow(L_NOM)
.head 5 -  Call SalHideWindow(T_NOM)
.head 5 -  !
.head 5 -  Call SalEnableWindow(pb_MET)
.head 5 -  !
.head 5 -  Set cmb2 = STRING_Null
.head 3 +  Function: f_limit
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sOKPO
.head 5 -  String: sPASPS
.head 5 -  String: sPASPN
.head 5 -  Number: nS
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSprev
.head 5 -  String: sTOKPO
.head 4 +  Actions
.head 5 -  ! Call Debug('nGLimit = ' || Str(nGLimit))
.head 5 -  ! Call Debug('nS = ' || Str(nS))
.head 5 -  Set sTOKPO = IifS(sOKPO='0000000000', sPASPS || sPASPN, sOKPO)
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT eq/100
   into   :nSprev
   from   LOMDEQ
   where  OKPO=:sTOKPO and DATO=trunc(sysdate)") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Call Debug('nSprev = ' || Str(nSprev))
.head 6 -  Return nGLimit=0 or nS+nSprev<=nGLimit
.head 5 +  Else
.head 6 -  Return nGLimit=0 or nS<=nGLimit
.head 3 +  Function: f_ClearD !! ФИО, ...
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set FIO         = STRING_Null
.head 5 -  Set OKPO        = STRING_Null
.head 5 -  Set ADR         = STRING_Null
.head 5 -  Set TEL         = STRING_Null
.head 5 -  Set PASPS       = STRING_Null
.head 5 -  Set PASPN       = STRING_Null
.head 5 -  Set ATRT        = STRING_Null
.head 5 -  Set ATRD        = DATETIME_Null
.head 5 -  !
.head 5 -  Set BDAY        = DATETIME_Null
.head 5 -  Set Citizenship = STRING_Null
.head 5 -  !
.head 5 -  Set dfMFO       = STRING_Null
.head 5 -  Set dfNLS       = STRING_Null
.head 5 -  Set dfNMS       = STRING_Null
.head 5 -  Set dfOKPO      = STRING_Null
.head 5 -  Set mlNAZN      = STRING_Null
.head 5 -  Call SalHideWindow(dfZagPer)
.head 5 -  Call SalHideWindow(dfZagMFO)
.head 5 -  Call SalHideWindow(dfZagNLS)
.head 5 -  Call SalHideWindow(dfZagNMS)
.head 5 -  Call SalHideWindow(dfZaOKPO)
.head 5 -  Call SalHideWindow(dfZaNAZN)
.head 5 -  Call SalHideWindow(dfMFO)
.head 5 -  Call SalHideWindow(dfNLS)
.head 5 -  Call SalHideWindow(dfNMS)
.head 5 -  Call SalHideWindow(dfOKPO)
.head 5 -  Call SalHideWindow(mlNAZN)
.head 5 -  Set rbG = 1
.head 5 -  !
.head 5 -  Call SalSetFocus(FIO)
.head 3 +  Function: f_Summa
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! If sGr_id = '4' or sGr_id = '5'
.head 5 +  If sGr_id = '3'
.head 6 +  If f_Null(L_CEN) > 0
.head 7 -  Set L_SUM = L_LIG * nProba / 1000 * L_CEN
.head 7 -  Set ml1 = SumPr(L_SUM*100, 'F', 'Грн', "коп")
.head 7 -  Call SalShowWindow(pb_Kup)
.head 7 -  Call SalShowWindow(pb_Kom)
.head 7 -  Call SalShowWindow(pb_Exp)
.head 6 +  Else
.head 7 -  Set L_SUM = NUMBER_Null
.head 7 -  Set ml1   = STRING_Null
.head 7 -  Call SalHideWindow(pb_Kup)
.head 7 -  Call SalHideWindow(pb_Kom)
.head 7 -  Call SalHideWindow(pb_Exp)
.head 5 +  Else If sGr_id = '4'
.head 6 +  If f_Null(L_CEN) > 0 and f_Null(L_EDN) > 0
.head 7 -  Set L_SUM = L_EDN * L_CEN
.head 7 -  Set ml1 = SumPr(L_SUM*100, 'F', 'Грн', "коп")
.head 7 -  Call SalShowWindow(pb_Kup)
.head 7 -  Call SalShowWindow(pb_Kom)
.head 7 -  Call SalShowWindow(pb_Exp)
.head 7 +  ! If L_SUM >= 150000
.head 8 -  Call SalEnableWindow(BDAY)
.head 8 -  Call SalEnableWindow(Citizenship)
.head 8 -  Call SalEnableWindow(PASPS)
.head 8 -  Call SalEnableWindow(PASPN)
.head 8 -  Call SalEnableWindow(ATRT)
.head 8 -  Call SalEnableWindow(ATRD)
.head 8 -  Call SalEnableWindow(ADR)
.head 8 -  Call SalEnableWindow(TEL)
.head 7 +  ! Else
.head 8 -  Call SalDisableWindow(BDAY)
.head 8 -  Call SalDisableWindow(Citizenship)
.head 8 -  Call SalDisableWindow(PASPS)
.head 8 -  Call SalDisableWindow(PASPN)
.head 8 -  Call SalDisableWindow(ATRT)
.head 8 -  Call SalDisableWindow(ATRD)
.head 8 -  Call SalDisableWindow(ADR)
.head 8 -  Call SalDisableWindow(TEL)
.head 6 +  Else
.head 7 -  Set L_SUM = NUMBER_Null
.head 7 -  Set ml1   = STRING_Null
.head 7 -  Call SalHideWindow(pb_Kup)
.head 7 -  Call SalHideWindow(pb_Kom)
.head 7 -  Call SalHideWindow(pb_Exp)
.head 5 +  Else
.head 6 +  If f_Null(L_LIG) > 0 and f_Null(L_CEN) > 0 and f_Null(L_EDN) > 0
.head 7 -  Set L_SUM = L_LIG * L_CEN
.head 7 -  Set ml1 = SumPr(L_SUM*100, 'F', 'Грн', "коп")
.head 7 -  Call SalShowWindow(pb_Kup)
.head 7 -  Call SalShowWindow(pb_Kom)
.head 7 -  Call SalShowWindow(pb_Exp)
.head 7 +  ! If L_SUM >= 150000
.head 8 -  Call SalEnableWindow(BDAY)
.head 8 -  Call SalEnableWindow(Citizenship)
.head 8 -  Call SalEnableWindow(PASPS)
.head 8 -  Call SalEnableWindow(PASPN)
.head 8 -  Call SalEnableWindow(ATRT)
.head 8 -  Call SalEnableWindow(ATRD)
.head 8 -  Call SalEnableWindow(ADR)
.head 8 -  Call SalEnableWindow(TEL)
.head 7 +  ! Else
.head 8 -  Call SalDisableWindow(BDAY)
.head 8 -  Call SalDisableWindow(Citizenship)
.head 8 -  Call SalDisableWindow(PASPS)
.head 8 -  Call SalDisableWindow(PASPN)
.head 8 -  Call SalDisableWindow(ATRT)
.head 8 -  Call SalDisableWindow(ATRD)
.head 8 -  Call SalDisableWindow(ADR)
.head 8 -  Call SalDisableWindow(TEL)
.head 6 +  Else
.head 7 -  Set L_SUM = NUMBER_Null
.head 7 -  Set ml1   = STRING_Null
.head 7 -  Call SalHideWindow(pb_Kup)
.head 7 -  Call SalHideWindow(pb_Kom)
.head 7 -  Call SalHideWindow(pb_Exp)
.head 3 +  Function: f_Null
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nTmp
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return IifN(nTmp=NUMBER_Null, 0, nTmp)
.head 3 +  Function: f_Tochka
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 4 +  Static Variables
.head 5 -  String: sTmp
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sTmp = SalStrRepeatX(' ', 20)
.head 5 -  Call SalGetWindowText(hWnd, sTmp, 20)
.head 5 +  While SalStrScan(sTmp, sDecimal2) > 0
.head 6 -  Set sTmp = SalStrReplaceX(sTmp, SalStrScan(sTmp, sDecimal2), 1, sDecimal)
.head 5 -  Call SalFmtStrToField(hWnd, sTmp, TRUE)
.head 3 +  Function: f_OPERW
.head 4 -  Description: Вставка доп.реквизитов по РЕФ
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRef
.head 5 -  String: sTTo
.head 4 +  Static Variables
.head 5 -  String: sPasp
.head 5 -  String: sAtrt
.head 4 +  Local variables
.head 5 -  String: s1
.head 5 -  String: s2
.head 5 -  String: s3
.head 5 -  String: s4
.head 5 -  String: s5
.head 5 -  !
.head 5 -  String: sL_EDN
.head 5 -  String: sL_NOM
.head 5 -  String: sBday
.head 5 -  Number: nCountUpd
.head 4 +  Actions
.head 5 -  Set sPasp = SalStrTrimX(PASPS || ' ' || PASPN)
.head 5 -  Set sAtrt = SalStrTrimX(ATRT || ' ' || SalFmtFormatDateTime(ATRD, 'dd/MM/yyyy'))
.head 5 -  Set sBday = SalFmtFormatDateTime(BDAY, 'dd/MM/yyyy')
.head 5 -  Set s1 = num_to_str_point(L_ZAG, 2)
.head 5 -  Set s2 = num_to_str_point(L_ZNJ, 2)
.head 5 -  Set s3 = num_to_str_point(L_LIG, 2)
.head 5 -  Set s4 = num_to_str_point(L_CEN, 2)
.head 5 -  Set s5 = num_to_str_point(L_SUM, 2)
.head 5 -  Set sL_EDN = Str(L_EDN)
.head 5 -  Set sL_NOM = Str(L_NOM)
.head 5 -  !
.head 5 -  Set nCountUpd = 0
.head 5 +  If sTTo = 'LOA'
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   update lom_w
   set    fio    =:FIO,
          pasp   =:sPasp,
          atrt   =:sAtrt,
          adres  =:ADR,
          phone  =:TEL,
          okpo   =:OKPO,
          bday   =:sBday,
          citiz  =:Citizenship,
          l_izd  =:L_IZD,
          l_edn  =:L_EDN,
          l_met  =:L_MET,
          l_nom  =:L_NOM,
          l_zag  =:L_ZAG,
          l_znj  =:L_ZNJ,
          l_lig  =:L_LIG,
          l_cen  =:L_CEN,
          l_sum  =:L_SUM,
          grp    =:sGr_id,
          proba  =:nProba,
          met    =:nMet,
          l_exp  =:sExpert,
          l_monid=:sMon_id,
          MFOB   =:dfMFO,
          NLSB   =:dfNLS,
          NMSB   =:dfNMS,
          OKPOB  =:dfOKPO,
          NAZNB  =:mlNAZN
   where  ref=:nRef")
.head 7 -  Call SqlGetModifiedRows(hSql(), nCountUpd)
.head 7 +  If nCountUpd = 0
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   lom_w (ref,fio,pasp,atrt,adres,phone,okpo,bday,citiz,l_izd,l_edn,l_met,l_nom,l_zag,l_znj,l_lig,l_cen,
                 l_sum,N2210,N2223,N2749,N9819,grp,proba,met,l_exp,l_monid,MFOB,NLSB,NMSB,OKPOB,NAZNB)
         values (:nRef,:FIO,:sPasp,:sAtrt,:ADR,:TEL,:OKPO,:sBday,:Citizenship,:L_IZD,:L_EDN,:L_MET,:L_NOM,:L_ZAG,
                 :L_ZNJ,:L_LIG,:L_CEN,:L_SUM,:NLS2210,:NLS2223,:NLS2749,:NLS9819,:sGr_id,:nProba,:nMet,:sExpert,
                 :sMon_id,:dfMFO,:dfNLS,:dfNMS,:dfOKPO,:mlNAZN)")
.head 9 -  ! Return SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'FIO'  ,:FIO)")         and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'PASP' ,:sPasp)")       and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'ATRT' ,:sAtrt)")       and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'ADRES',:ADR)")         and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'PHONE',:TEL)")         and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'OKPO' ,:OKPO)")        and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'BDAY' ,:sBday)")       and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'CITIZ',:Citizenship)") and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_IZD',:L_IZD)")       and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_EDN',:sL_EDN)")      and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_MET',:L_MET)")       and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_NOM',:sL_NOM)")      and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_ZAG',:s1)")          and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_ZNJ',:s2)")          and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_LIG',:s3)")          and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_CEN',:s4)")          and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_SUM',:s5)")          and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'N2210',:NLS2210)")     and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'N2223',:NLS2223)")     and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'N2749',:NLS2749)")     and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'N9819',:NLS9819)")
.head 9 -  Return i_OPERW(nRef, 'FIO'  , FIO)         and i_OPERW(nRef, 'PASP' , sPasp)       and
       i_OPERW(nRef, 'ATRT' , sAtrt)       and i_OPERW(nRef, 'ADRES', ADR)         and
       i_OPERW(nRef, 'PHONE', TEL)         and i_OPERW(nRef, 'OKPO' , OKPO)        and
       i_OPERW(nRef, 'BDAY' , sBday)       and i_OPERW(nRef, 'CITIZ', Citizenship) and
       i_OPERW(nRef, 'L_IZD', L_IZD)       and i_OPERW(nRef, 'L_EDN', sL_EDN)      and
       i_OPERW(nRef, 'L_MET', L_MET)       and i_OPERW(nRef, 'L_NOM', sL_NOM)      and
       i_OPERW(nRef, 'L_ZAG', s1)          and i_OPERW(nRef, 'L_ZNJ', s2)          and
       i_OPERW(nRef, 'L_LIG', s3)          and i_OPERW(nRef, 'L_CEN', s4)          and
       i_OPERW(nRef, 'L_SUM', s5)          and i_OPERW(nRef, 'N2210', NLS2210)     and
       i_OPERW(nRef, 'N2223', NLS2223)     and i_OPERW(nRef, 'N2749', NLS2749)     and
       i_OPERW(nRef, 'N9819', NLS9819)     and i_OPERW(nRef, 'GRP'  , sGr_id)      and
       i_OPERW(nRef, 'PROBA', Str(nProba)) and i_OPERW(nRef, 'MET'  , Str(nMet))   and
       i_OPERW(nRef, 'L_EXP', sExpert)     and i_OPERW(nRef, 'MONID', sMon_id)     and
       i_OPERW(nRef, 'MFOB', dfMFO)        and i_OPERW(nRef, 'NLSB' , dfNLS)       and
       i_OPERW(nRef, 'NMSB', dfNMS)        and i_OPERW(nRef, 'OKPOB', dfOKPO)      and
       i_OPERW(nRef, 'NAZNB', mlNAZN)      and i_OPERW(nRef, 'CAS_P', SalStrTrimX(Left(cmb2, 6)))
.head 8 +  Else
.head 9 -  Return FALSE
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   update lom_w
   set    fio    =:FIO,
          pasp   =:sPasp,
          atrt   =:sAtrt,
          adres  =:ADR,
          phone  =:TEL,
          okpo   =:OKPO,
          bday   =:sBday,
          citiz  =:Citizenship,
          l_izd  =:L_IZD,
          l_edn  =:L_EDN,
          l_met  =:L_MET,
          l_nom  =:L_NOM,
          l_zag  =:L_ZAG,
          l_znj  =:L_ZNJ,
          l_lig  =:L_LIG,
          l_cen  =:L_CEN,
          l_sum  =:L_SUM,
          grp    =:sGr_id,
          proba  =:nProba,
          met    =:nMet,
          l_exp  =:sExpert,
          l_monid=:sMon_id
   where  ref=:nRef")
.head 7 -  Call SqlGetModifiedRows(hSql(), nCountUpd)
.head 7 +  If nCountUpd = 0
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   lom_w (ref,fio,pasp,atrt,adres,phone,okpo,bday,citiz,l_izd,l_edn,l_met,l_nom,l_zag,l_znj,l_lig,l_cen,
                 l_sum,N2210,N2223,N2749,N9819,grp,proba,met,l_exp,l_monid)
         values (:nRef,:FIO,:sPasp,:sAtrt,:ADR,:TEL,:OKPO,:sBday,:Citizenship,:L_IZD,:L_EDN,:L_MET,:L_NOM,:L_ZAG,
                 :L_ZNJ,:L_LIG,:L_CEN,:L_SUM,:NLS2210,:NLS2223,:NLS2749,:NLS9819,:sGr_id,:nProba,:nMet,:sExpert,
                 :sMon_id)")
.head 9 -  ! Return SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'FIO'  ,:FIO)")         and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'PASP' ,:sPasp)")       and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'ATRT' ,:sAtrt)")       and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'ADRES',:ADR)")         and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'PHONE',:TEL)")         and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'OKPO' ,:OKPO)")        and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'BDAY' ,:sBday)")       and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'CITIZ',:Citizenship)") and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_IZD',:L_IZD)")       and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_EDN',:sL_EDN)")      and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_MET',:L_MET)")       and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_NOM',:sL_NOM)")      and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_ZAG',:s1)")          and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_ZNJ',:s2)")          and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_LIG',:s3)")          and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_CEN',:s4)")          and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'L_SUM',:s5)")          and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'N2210',:NLS2210)")     and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'N2223',:NLS2223)")     and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'N2749',:NLS2749)")     and
       SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'N9819',:NLS9819)")
.head 9 -  Return i_OPERW(nRef, 'FIO'  , FIO)         and i_OPERW(nRef, 'PASP' , sPasp)       and
       i_OPERW(nRef, 'ATRT' , sAtrt)       and i_OPERW(nRef, 'ADRES', ADR)         and
       i_OPERW(nRef, 'PHONE', TEL)         and i_OPERW(nRef, 'OKPO' , OKPO)        and
       i_OPERW(nRef, 'BDAY' , sBday)       and i_OPERW(nRef, 'CITIZ', Citizenship) and
       i_OPERW(nRef, 'L_IZD', L_IZD)       and i_OPERW(nRef, 'L_EDN', sL_EDN)      and
       i_OPERW(nRef, 'L_MET', L_MET)       and i_OPERW(nRef, 'L_NOM', sL_NOM)      and
       i_OPERW(nRef, 'L_ZAG', s1)          and i_OPERW(nRef, 'L_ZNJ', s2)          and
       i_OPERW(nRef, 'L_LIG', s3)          and i_OPERW(nRef, 'L_CEN', s4)          and
       i_OPERW(nRef, 'L_SUM', s5)          and i_OPERW(nRef, 'N2210', NLS2210)     and
       i_OPERW(nRef, 'N2223', NLS2223)     and i_OPERW(nRef, 'N2749', NLS2749)     and
       i_OPERW(nRef, 'N9819', NLS9819)     and i_OPERW(nRef, 'GRP'  , sGr_id)      and
       i_OPERW(nRef, 'PROBA', Str(nProba)) and i_OPERW(nRef, 'MET'  , Str(nMet))   and
       i_OPERW(nRef, 'L_EXP', sExpert)     and i_OPERW(nRef, 'MONID', sMon_id)     and
       i_OPERW(nRef, 'CAS_P', SalStrTrimX(Left(cmb2, 6)))
.head 8 +  Else
.head 9 -  Return FALSE
.head 6 +  Else
.head 7 -  Return FALSE
.head 3 +  Function: i_OPERW
.head 4 -  Description: Вставка доп.реквизитов по РЕФ
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRef
.head 5 -  String: sTag
.head 5 -  String: sVal
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If sVal = STRING_Null or Len(sVal) = 0
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return SqlPrepareAndExecute(hSql(), "
       INSERT
       INTO   operw (ref,tag,value)
             VALUES (:nRef,:sTag,:sVal)")
.head 3 +  Function: i_d_rec
.head 4 -  Description: Вставка # в D_REC
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRef
.head 5 -  String: sTag
.head 5 -  String: sVal
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sPlus
.head 4 +  Actions
.head 5 +  If sVal = STRING_Null or Len(sVal) = 0
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Set sPlus = '#' || sTag || sVal || '#'
.head 6 -  Return SqlPrepareAndExecute(hSql(), "
       UPDATE oper
       set    d_rec=replace(d_rec||:sPlus,'##','#')
       where  ref=:nRef")
.head 3 +  Function: DopustMfo0
.head 4 -  Description: проверка МФО банка на допустимость
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sMfo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If Len(sMfo) = 0
.head 6 -  Return TRUE
.head 5 +  If SqlPrepareAndExecute(hSqlAux(), '
   SELECT nb
   FROM   banks
   WHERE  mfo=:sMfo and
          blk=0')
.head 6 +  If SqlFetchNext(hSqlAux(), nFetchRes)
.head 7 -  Return nFetchRes=FETCH_Ok
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: DopustNls
.head 4 -  Description: проверка МФО банка на допустимость
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sNls
.head 5 -  String: sMfo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nKod
.head 5 -  String: sSab
.head 5 -  String: sMfo5
.head 5 -  String: sNlsV
.head 4 +  Actions
.head 5 +  If Len(sNls) = 0
.head 6 -  Return TRUE
.head 5 +  If Left(sMfo, 1) = '8'
.head 6 -  Set nKod = 3
.head 5 +  Else
.head 6 -  Set sSab = GetValueStr("
    SELECT SAB
    FROM   BANKS
    WHERE  MFO='" || sMfo || "' and BLK<>4")
.head 6 +  If Len(sSab) = 0
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 +  ! If Subs(sSAB, 3, 1) = 'H'
.head 8 -  Set nKod = 1
.head 7 +  ! Else
.head 8 -  Set nKod = 2
.head 7 -  Set nKod = IifN(Subs(sSab, 3, 1)='H', 1, 2)
.head 6 -  !
.head 6 +  If SqlPrepareAndExecute(hSqlAux(), "
   SELECT KOD
   INTO   :nKod
   FROM   NOSEP
   WHERE  KOD=:nKod and
          (SUBSTR(:sNls,1,4)=NBS OR SUBSTR(:sNls,1,3)=NBS OR SUBSTR(:sNls,1,2)=NBS OR SUBSTR(:sNls,1,1)=NBS)") and
   SqlFetchNext(hSqlAux(), nFetchRes)
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  ! Call Debug(sMfo)
.head 7 -  ! Call Debug(sNls)
.head 7 -  Set sMfo5 = Left(sMfo, 5)
.head 7 +  If SqlPrepareAndExecute(hSqlAux(), "
   SELECT substr(VKRZN(:sMfo5,:sNls),1,15)
   INTO   :sNlsV
   FROM   dual") and SqlFetchNext(hSqlAux(), nFetchRes)
.head 8 -  ! Call Debug(sNlsV)
.head 8 -  Return sNlsV=sNls
.head 7 +  Else
.head 8 -  Return FALSE
.head 3 +  Function: DopustOKPO
.head 4 -  Description: проверка OKPO на допустимость
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sOKPO
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRes
.head 4 +  Actions
.head 5 +  If Len(sOKPO) = 0
.head 6 -  Return TRUE
.head 5 +  If SqlPrepareAndExecute(hSqlAux(), "
   SELECT f_validokpo(:sOKPO)
   INTO   :nRes
   FROM   dual") and SqlFetchNext(hSqlAux(), nFetchRes)
.head 6 +  If nRes = 0
.head 7 -  Return TRUE
.head 5 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: LO2
.head 3 -  String: LO9
.head 2 +  Window Variables
.head 3 -  Number: nLO2
.head 3 -  String: sTmp
.head 3 -  String: NMS
.head 3 -  String: sNms9
.head 3 -  Number: MET
.head 3 -  Number: n980
.head 3 -  Number: nSk
.head 3 -  Number: nVob
.head 3 -  Number: nVob9
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  !
.head 3 -  String: sNlsT
.head 3 -  String: sNmsT
.head 3 -  !
.head 3 -  String: sNlsB
.head 3 -  String: sNlsB9
.head 3 -  String: sNmsB
.head 3 -  String: sNmsB9
.head 3 -  !
.head 3 -  String: sDecimal   ! симв десятичной точки
.head 3 -  String: sDecimal2  ! симв десятичной точки alt
.head 3 -  String: sSql
.head 3 -  Number: NFeechRez
.head 3 -  !
.head 3 -  String: sGr_id
.head 3 -  String: sMon_id
.head 3 -  Boolean: bNoRek
.head 3 -  ! NLS2210,NLS2223,NLS2749,NLS9819
.head 3 -  String: NLS2210
.head 3 -  String: NLS2223
.head 3 -  String: NLS2749
.head 3 -  String: NLS9819
.head 3 -  !
.head 3 -  Number: nMet
.head 3 -  Number: nProba
.head 3 -  !
.head 3 -  Boolean: bCAS_P
.head 3 -  !
.head 3 -  Number: nUserid
.head 3 -  String: sSqlMet
.head 3 -  String: sExp
.head 3 -  Number: nI
.head 3 -  Number: nEntries
.head 3 -  !
.head 3 -  String: sExpert
.head 3 -  !
.head 3 -  Boolean: bLL
.head 3 -  Boolean: bO2
.head 3 -  Boolean: bLIM
.head 3 -  Number: nGLimit
.head 3 -  !
.head 3 -  Number: nVobLOA
.head 3 -  Number: nVobLOB
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sDecimal = SalStrMidX(SalNumberToStrX(1.1, 1), 1, 1)
.head 4 +  If sDecimal = '.'
.head 5 -  Set sDecimal2 = ','
.head 4 +  Else
.head 5 -  Set sDecimal2 = '.'
.head 4 -  Set BankName = GetBankName()
.head 4 -  Set BankMfo  = GetBankMfo()
.head 4 -  Set BankDate = GetBankDate()
.head 4 -  Set EXPERT   = GetUserRealName()
.head 4 -  Set sKVIT    = "Квитанція № "
.head 4 -  Set n980     = GetBaseVal()
.head 4 -  Set T_NOM    = 'Номінал монети'
.head 4 -  Set dfFormaR = 'Форма розрахунку'
.head 4 -  Set dfZagPer = 'Реквізити для перерахування коштів'
.head 4 -  Set dfZagMFO = 'Код банку (МФО)'
.head 4 -  Set dfZagNLS = 'Рахунок'
.head 4 -  Set dfZagNMS = 'Назва рахунку'
.head 4 -  Set dfZaOKPO = 'Код ЄДРФО/ЄДРПОУ'
.head 4 -  Set dfZaNAZN = 'Призначення платежу'
.head 4 +  If SqlPrepareAndExecute(hSql(), "
   SELECT 2
   INTO   :nLO2
   FROM   params
   WHERE  par='LO2' and val='2'") and not SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set nLO2 = 1
.head 4 -  ! sNlsB - счет кассы
.head 4 -  ! sNlsT - счет транзита
.head 4 -  ! sNlsB9 -контрсчет по внеб
.head 4 -  ! Set sSql = IifS(nLO2=1, "
    SELECT a2.nls,trim(substr(a2.nms,1,38)),a9.nls,trim(substr(a9.nms,1,38)),t2.sk,v2.vob,v9.vob
    INTO   :sNlsB,:sNmsB,:sNlsB9,:sNmsB9,:nSk,:nVob,:nVob9
    FROM   tts t2, tts t9, tts t3, tts t4, accounts a2, accounts a9, accounts a6, TTS_VOB v2, TTS_VOB v9
    WHERE  rownum=1 and v2.tt=t2.tt and v9.tt=t9.tt and a2.kv=:n980 and a9.kv=:n980 and a2.nls=sb_acc(t3.nlsk,'') and
           a9.nls=sb_acc(t9.nlsk,'') and t2.tt=:LO2 and t9.tt=:LO9 and t3.TT='LOR' and t4.tt='LOT' and
           a6.nls=sb_acc(t4.NLSK,'')", "
    SELECT a2.nls,trim(substr(a2.nms,1,38)),a4.nls,trim(substr(a4.nms,1,38)),a9.nls,trim(substr(a9.nms,1,38)),t2.sk,
           v2.vob,v9.vob
    INTO   :sNlsB,:sNmsB,:sNlsT,:sNmsT,:sNlsB9,:sNmsB9,:nSk,:nVob,:nVob9
    FROM   tts t2, tts t9, tts t3, tts t4, accounts a2, accounts a4, accounts a6, accounts a9, TTS_VOB v2, TTS_VOB v9
    WHERE  rownum=1 and v2.tt=t2.tt and v9.tt=t9.tt and a2.kv=:n980 and a9.kv=:n980 and a2.nls=sb_acc(t3.nlsk,'') and
           a9.nls=sb_acc(t9.nlsk,'') and a4.kv=:n980 and a4.nls=sb_acc(t2.nlsm,'') and t2.tt=:LO2 and t9.tt=:LO9 and
           t3.TT='LOR' and t4.tt='LOT' and a6.nls=sb_acc(t4.NLSK,'')")
.head 4 -  Set sSql = IifS(nLO2=1, "
    SELECT a2.nls,trim(substr(a2.nms,1,38)),a9.nls,trim(substr(a9.nms,1,38)),t2.sk,v2.vob,v9.vob
    INTO   :sNlsB,:sNmsB,:sNlsB9,:sNmsB9,:nSk,:nVob,:nVob9
    FROM   tts t2, tts t9, tts t3, accounts a2, accounts a9, accounts a6, TTS_VOB v2, TTS_VOB v9
    WHERE  rownum=1 and v2.tt=t2.tt and v9.tt=t9.tt and a2.kv=:n980 and a9.kv=:n980 and a2.nls=sb_acc(t3.nlsk,'') and
           a9.nls=sb_acc(t9.nlsk,'') and t2.tt=:LO2 and t9.tt=:LO9 and t3.TT='LOR'", "
    SELECT a2.nls,trim(substr(a2.nms,1,38)),a4.nls,trim(substr(a4.nms,1,38)),a9.nls,trim(substr(a9.nms,1,38)),t2.sk,
           v2.vob,v9.vob
    INTO   :sNlsB,:sNmsB,:sNlsT,:sNmsT,:sNlsB9,:sNmsB9,:nSk,:nVob,:nVob9
    FROM   tts t2, tts t9, tts t3, accounts a2, accounts a4, accounts a6, accounts a9, TTS_VOB v2, TTS_VOB v9
    WHERE  rownum=1 and v2.tt=t2.tt and v9.tt=t9.tt and a2.kv=:n980 and a9.kv=:n980 and a2.nls=sb_acc(t3.nlsk,'') and
           a9.nls=sb_acc(t9.nlsk,'') and a4.kv=:n980 and a4.nls=sb_acc(t2.nlsm,'') and t2.tt=:LO2 and t9.tt=:LO9 and
           t3.TT='LOR'")
.head 4 +  If SqlPrepareAndExecute(hSql(), sSql) and not SqlFetchNext(hSql(), nFetchRes)
.head 5 -  ! Call Debug("Не описані операції " || LO2 || ',' || LO9 || ', LOR, LOT')
.head 5 -  Call MessageNoWait("Не описані операції " || LO2 || ',' || LO9 || ', LOR aбо відсутні рахунки', 'УВАГА!', 0, 1)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  !
.head 4 -  Set bCAS_P = Val(GetValueStr("
    select to_char(text_length)
    from   ALL_VIEWS
    where  view_name='V_CASKC_Z' and owner='BARS'")) > 0
.head 4 +  If bCAS_P
.head 5 -  Set df30 = 'Виконавець для підбору касира'
.head 4 +  Else
.head 5 -  Call SalHideWindow(cmb2)
.head 5 -  Call SalHideWindow(df30)
.head 4 -  ! Set df31 = 'Експерт'
.head 4 -  !
.head 4 -  Set sExpert = GetValueStr("
     select lpad(to_char(userid),6)||' '||fio
     from   lom_isp
     where  cod in ('EXP1','EXP2') and userid=" || Str(GetUserId()))
.head 4 +  If Len(sExpert) = 0
.head 5 -  Call MessageNoWait('Ви не є екпертом. Необхідно закінчити відповідні курси.', 'УВАГА!', 37, 1)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  !
.head 4 -  Set nGLimit = GetGlobalOptionEx('LOMLIMIT')
.head 4 -  Set rbG = 1
.head 4 -  !
.head 4 -  ! Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  ! Call SalGetProfileString('EsselefortrafunMFO',  'Values', '', dfMFO,  '')
.head 4 -  ! Call SalGetProfileString('EsselefortrafunNLS',  'Values', '', dfNLS,  '')
.head 4 -  ! Call SalGetProfileString('EsselefortrafunNMS',  'Values', '', dfNMS,  '')
.head 4 -  ! Call SalGetProfileString('EsselefortrafunOKPO', 'Values', '', dfOKPO, '')
.head 4 -  ! Call SalGetProfileString('EsselefortrafunNAZN', 'Values', '', mlNAZN, '')
.head 4 -  !
.head 4 -  Call SalHideWindow(dfZagPer)
.head 4 -  Call SalHideWindow(dfZagMFO)
.head 4 -  Call SalHideWindow(dfZagNLS)
.head 4 -  Call SalHideWindow(dfZagNMS)
.head 4 -  Call SalHideWindow(dfZaOKPO)
.head 4 -  Call SalHideWindow(dfZaNAZN)
.head 4 -  Call SalHideWindow(dfMFO)
.head 4 -  Call SalHideWindow(dfNLS)
.head 4 -  Call SalHideWindow(dfNMS)
.head 4 -  Call SalHideWindow(dfOKPO)
.head 4 -  Call SalHideWindow(mlNAZN)
.head 4 -  ! Call Debug(Str(nGLimit))
.head 4 -  !
.head 4 -  Set nVobLOA = Val(GetValueStr("
    SELECT to_char(vob)
    FROM   tts_vob
    WHERE  tt='LOA'"))
.head 4 +  If not nVobLOA
.head 5 -  Set nVobLOA = 6
.head 4 -  Set nVobLOB = Val(GetValueStr("
    SELECT to_char(vob)
    FROM   tts_vob
    WHERE  tt='LOB'"))
.head 4 +  If not nVobLOB
.head 5 -  Set nVobLOB = 6
.head 4 -  !
.head 4 -  Call f_ClearO()
.head 4 -  Call f_ClearD()
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalDisableWindow(EXPERT)
.head 4 -  Call SalHideWindow(EXPERT)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 3 +  ! On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalSetProfileString('EsselefortrafunMFO',  'Values', dfMFO,  '')
.head 4 -  Call SalSetProfileString('EsselefortrafunNLS',  'Values', dfNLS,  '')
.head 4 -  Call SalSetProfileString('EsselefortrafunNMS',  'Values', dfNMS,  '')
.head 4 -  Call SalSetProfileString('EsselefortrafunOKPO', 'Values', dfOKPO, '')
.head 4 -  Call SalSetProfileString('EsselefortrafunNAZN', 'Values', mlNAZN, '')
.head 1 +  Form Window: LO4
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Оплата цінностей після еспертизи (рекламації) ГРН
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   2.575"
.head 4 -  Top:    1.198"
.head 4 -  Width:  12.95"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.083"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Оплата цінностей після еспертизи (рекламації) ГРН
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: BankName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.117"
.head 6 -  Top:    0.071"
.head 6 -  Width:  7.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: BankMfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: BankDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 14652
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    0.31"
.head 5 -  Width:  12.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 6.976"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Вид документа
.head 4 -  Resource Id: 14682
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.367"
.head 5 -  Top:    0.393"
.head 5 -  Width:  3.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbVOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.617"
.head 5 -  Top:    0.369"
.head 5 -  Width:  4.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListPopulate(hWndItem, hSql(), T("
     select lpad(to_char(v.vob),3)||' '||v.name
     from   vob v, tts_vob t
     where  t.tt='LO4' and v.vob=t.vob"))
.head 6 +  If sVOB
.head 7 -  Call SalListSelectString(hWndItem, -1, sVOB)
.head 6 +  Else
.head 7 -  Call SalListSetSelect(hWndItem, 0)
.head 3 -  Background Text: №
.head 4 -  Resource Id: 14673
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.15"
.head 5 -  Top:    0.679"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.617"
.head 6 -  Top:    0.619"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 +  If sND
.head 7 -  Set dfND = sND
.head 3 -  Background Text: від
.head 4 -  Resource Id: 14674
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.15"
.head 5 -  Top:    0.929"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDatd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.617"
.head 6 -  Top:    0.869"
.head 6 -  Width:  2.083"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sDatd
.head 7 -  Set dfDatd = SalStrToDate(sDatd)
.head 3 -  !
.head 3 -  Line
.head 4 -  Resource Id: 14683
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.45"
.head 5 -  Begin Y:  3.607"
.head 5 -  End X:  12.0"
.head 5 -  End Y:  3.607"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: Платник
.head 4 -  Resource Id: 14653
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.7"
.head 5 -  Top:    1.226"
.head 5 -  Width:  1.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Рахунок
.head 4 -  Resource Id: 14654
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.7"
.head 5 -  Top:    1.488"
.head 5 -  Width:  1.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.05"
.head 6 -  Top:    1.44"
.head 6 -  Width:  2.067"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sNLSA
.head 7 -  Set dfNLSA = sNLSA
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendMsg(dfNMSA, SAM_Create, 0, 0)
.head 3 +  Data Field: dfNMSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.183"
.head 6 -  Top:    1.44"
.head 6 -  Width:  6.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If dfNLSA
.head 7 -  Set dfNMSA = GetValueStr("
    SELECT nms
    from   accounts
    where  nls='"||dfNLSA||"' and kv=980")
.head 6 +  Else
.head 7 +  ! If sNMSA
.head 8 -  Set dfNMSA = sNMSA
.head 7 -  Set dfNMSA = STRING_Null
.head 3 -  Background Text: МФО
.head 4 -  Resource Id: 14687
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.7"
.head 5 -  Top:    1.798"
.head 5 -  Width:  1.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfMFOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.05"
.head 6 -  Top:    1.762"
.head 6 -  Width:  2.067"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfMFOA = BankMfo
.head 3 -  Background Text: Ідентифікаційний код
.head 4 -  Resource Id: 14655
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.233"
.head 5 -  Top:    1.798"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfOKPOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    1.762"
.head 6 -  Width:  1.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sOKPOA
.head 7 -  Set dfOKPOA = sOKPOA
.head 3 -  !
.head 3 -  Line
.head 4 -  Resource Id: 14686
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.45"
.head 5 -  Begin Y:  2.107"
.head 5 -  End X:  12.0"
.head 5 -  End Y:  2.107"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: Отримувач
.head 4 -  Resource Id: 14675
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.167"
.head 5 -  Width:  1.583"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Рахунок
.head 4 -  Resource Id: 14676
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.7"
.head 5 -  Top:    2.405"
.head 5 -  Width:  1.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.05"
.head 6 -  Top:    2.345"
.head 6 -  Width:  2.067"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sNLSB
.head 7 -  Set dfNLSB = sNLSB
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendMsg(dfNMSB, SAM_Create, 0, 0)
.head 3 +  Data Field: dfNMSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.233"
.head 6 -  Top:    2.345"
.head 6 -  Width:  6.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If dfNLSB
.head 7 -  Set dfNMSB = GetValueStr("
    SELECT nms
    from   accounts
    where  nls='"||dfNLSB||"' and kv=980")
.head 6 +  Else
.head 7 +  ! If sNMSB
.head 8 -  Set dfNMSB = sNMSB
.head 7 -  Set dfNMSB = STRING_Null
.head 3 -  Background Text: МФО
.head 4 -  Resource Id: 14684
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.7"
.head 5 -  Top:    2.726"
.head 5 -  Width:  1.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfMFOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.05"
.head 6 -  Top:    2.69"
.head 6 -  Width:  2.067"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfMFOB = BankMfo
.head 3 -  Background Text: Ідентифікаційний код
.head 4 -  Resource Id: 14656
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.317"
.head 5 -  Top:    5.786"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfOKPOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.217"
.head 6 -  Top:    2.69"
.head 6 -  Width:  1.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sOKPOB
.head 7 -  Set dfOKPOB = sOKPOB
.head 3 -  Background Text: Сума
.head 4 -  Resource Id: 14664
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.867"
.head 5 -  Top:    6.631"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.483"
.head 6 -  Top:    2.679"
.head 6 -  Width:  1.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 +  If nS
.head 7 -  Set dfS = nS
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendMsg(mlSUMPR, SAM_Create, 0, 0)
.head 3 -  Background Text: СК
.head 4 -  Resource Id: 14670
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.217"
.head 5 -  Top:    2.714"
.head 5 -  Width:  0.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.617"
.head 6 -  Top:    2.679"
.head 6 -  Width:  0.417"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nSK
.head 7 -  Set dfSK = nSK
.head 3 +  Multiline Field: mlSUMPR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 200
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.467"
.head 6 -  Top:    3.06"
.head 6 -  Width:  11.617"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.464"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If dfS
.head 7 -  Set mlSUMPR = SumPr(dfS*100, 'F', 'грн', 'коп.')
.head 6 +  Else
.head 7 -  Set mlSUMPR = STRING_Null
.head 3 -  !
.head 3 -  Line
.head 4 -  Resource Id: 14685
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.45"
.head 5 -  Begin Y:  1.202"
.head 5 -  End X:  12.0"
.head 5 -  End Y:  1.202"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Background Text: Призначення платежу
.head 4 -  Resource Id: 14679
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    3.75"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: mlNAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   2.433"
.head 6 -  Top:    3.726"
.head 6 -  Width:  5.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.571"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sNAZN
.head 7 -  Set mlNAZN = sNAZN
.head 3 -  Background Text: ПІБ фіз.особи
.head 4 -  Resource Id: 14680
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    4.393"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.417"
.head 6 -  Top:    4.333"
.head 6 -  Width:  5.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sFIO
.head 7 -  Set dfFIO = sFIO
.head 3 -  Background Text: Адреса
.head 4 -  Resource Id: 14681
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    4.643"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfADR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.433"
.head 6 -  Top:    4.607"
.head 6 -  Width:  5.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sADR
.head 7 -  Set dfADR = sADR
.head 3 -  Background Text: Документ: серія
.head 4 -  Resource Id: 14671
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    4.94"
.head 5 -  Width:  1.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSER
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.417"
.head 6 -  Top:    4.905"
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sSER
.head 7 -  Set dfSER = sSER
.head 3 -  Background Text: №
.head 4 -  Resource Id: 14672
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.683"
.head 5 -  Top:    4.952"
.head 5 -  Width:  0.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.15"
.head 6 -  Top:    4.905"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sNOM
.head 7 -  Set dfNOM = sNOM
.head 3 -  Background Text: Виданий
.head 4 -  Resource Id: 14678
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.217"
.head 5 -  Top:    5.226"
.head 5 -  Width:  1.05"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfORGAN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 70
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.417"
.head 6 -  Top:    5.19"
.head 6 -  Width:  5.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sORGAN
.head 7 -  Set dfORGAN = sORGAN
.head 3 -  Background Text: Дата видачі
.head 4 -  Resource Id: 21571
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.533"
.head 5 -  Top:    5.512"
.head 5 -  Width:  1.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDATV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.417"
.head 6 -  Top:    5.464"
.head 6 -  Width:  2.083"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sDATV
.head 7 -  Set dfDATV = SalStrToDate(sDATV)
.head 3 -  Background Text: Ідентифікаційний код
.head 4 -  Resource Id: 14677
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.217"
.head 5 -  Top:    2.726"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.417"
.head 6 -  Top:    5.762"
.head 6 -  Width:  2.083"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sOKPO
.head 7 -  Set dfOKPO = sOKPO
.head 3 -  Background Text: Дата нарождення
.head 4 -  Resource Id: 14669
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.533"
.head 5 -  Top:    6.071"
.head 5 -  Width:  1.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfBDAY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.417"
.head 6 -  Top:    6.024"
.head 6 -  Width:  2.083"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sBDAY
.head 7 -  Set dfBDAY = SalStrToDate(sBDAY)
.head 3 -  !
.head 3 -  Background Text: Група
.head 4 -  Resource Id: 14667
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.783"
.head 5 -  Top:    3.762"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  ! Data Field: dfGRP
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    6.679"
.head 6 -  Width:  2.05"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 +  If sGRP
.head 7 -  Set cmbGRP = sGRP
.head 3 +  Combo Box: cmbGRP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.267"
.head 5 -  Top:    3.726"
.head 5 -  Width:  2.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListPopulate(hWndItem, hSql(), T("
     select to_char(gr_id)||' '||gr_name
     from   lom_grp"))
.head 6 +  If sGRP
.head 7 -  Call SalListSelectString(hWndItem, -1, sGRP)
.head 6 +  Else
.head 7 -  Call SalListSetSelect(hWndItem, 0)
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendMsg(cmbBARAHLO, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(cmbMETPROB, SAM_Create, 0, 0)
.head 6 -  Set sGRP = cmbGRP
.head 3 -  Background Text: Назва виробу
.head 4 -  Resource Id: 14657
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.783"
.head 5 -  Top:    4.06"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  ! Data Field: dfBARAHLO
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.267"
.head 6 -  Top:    4.036"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 +  If cmbGRP
.head 7 -  Call SalListPopulate(hWndItem, hSql(), T("
     select name
     from   lom_izd
     where  grp_id="||Left(cmbGRP, At(' ', cmbGRP)-1)))
.head 6 +  Else 
.head 7 -  Call SalListPopulate(hWndItem, hSql(), T("
     select name
     from   lom_izd"))
.head 6 +  If sBARAHLO
.head 7 -  Call SalListSelectString(hWndItem, -1, sBARAHLO)
.head 6 +  Else 
.head 7 -  Call SalListSetSelect(hWndItem, 0)
.head 3 +  Combo Box: cmbBARAHLO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.267"
.head 5 -  Top:    4.012"
.head 5 -  Width:  2.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbGRP
.head 7 -  Call SalListPopulate(hWndItem, hSql(), T("
     select name
     from   lom_izd
     where  grp_id="||Left(cmbGRP, At(' ', cmbGRP)-1)))
.head 6 +  Else
.head 7 -  Call SalListPopulate(hWndItem, hSql(), T("
     select name
     from   lom_izd"))
.head 6 +  If sBARAHLO
.head 7 -  Call SalListSelectString(hWndItem, -1, sBARAHLO)
.head 6 +  Else
.head 7 -  Call SalListSetSelect(hWndItem, 0)
.head 5 +  On SAM_Click
.head 6 -  Set sBARAHLO = cmbBARAHLO
.head 3 -  Background Text: Номінал монети
.head 4 -  Resource Id: 21596
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.817"
.head 5 -  Top:    4.345"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNOMMON
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.267"
.head 6 -  Top:    4.31"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sNOMMON
.head 7 -  Set dfNOMMON = sNOMMON
.head 3 -  Background Text: Метал, проба
.head 4 -  Resource Id: 14658
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.867"
.head 5 -  Top:    4.643"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  ! Data Field: dfMETPROB
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.267"
.head 6 -  Top:    4.595"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 +  If sMETPROB
.head 7 -  Set dfMETPROB = sMETPROB
.head 3 +  Combo Box: cmbMETPROB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.267"
.head 5 -  Top:    4.595"
.head 5 -  Width:  2.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbGRP
.head 7 -  Call SalListPopulate(hWndItem, hSql(), T("
     select name
     from   lom_met
     where  grp="||Left(cmbGRP, At(' ', cmbGRP)-1)))
.head 6 +  Else
.head 7 -  Call SalListPopulate(hWndItem, hSql(), T("
     select name
     from   lom_met"))
.head 6 +  If sMETPROB
.head 7 -  Call SalListSelectString(hWndItem, -1, sMETPROB)
.head 6 +  Else
.head 7 -  Call SalListSetSelect(hWndItem, 0)
.head 5 +  On SAM_Click
.head 6 -  Set sMETPROB = cmbMETPROB
.head 3 -  Background Text: Кількість
.head 4 -  Resource Id: 14659
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.867"
.head 5 -  Top:    4.929"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCNT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.267"
.head 6 -  Top:    4.869"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nCNT
.head 7 -  Set dfCNT = nCNT
.head 3 -  Background Text: Заг.вага
.head 4 -  Resource Id: 14660
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.867"
.head 5 -  Top:    5.202"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfZAG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.267"
.head 6 -  Top:    5.155"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nZAG
.head 7 -  Set dfZAG = nZAG
.head 3 -  Background Text: Знижка
.head 4 -  Resource Id: 14668
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.867"
.head 5 -  Top:    5.512"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfZNJ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.267"
.head 6 -  Top:    5.452"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nZNJ
.head 7 -  Set dfZNJ = nZNJ
.head 3 -  Background Text: Ліг.вага
.head 4 -  Resource Id: 14661
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.867"
.head 5 -  Top:    5.798"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfLIG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.267"
.head 6 -  Top:    5.75"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nLIG
.head 7 -  Set dfLIG = nLIG
.head 3 -  Background Text: Маса металу в чистоті
.head 4 -  Resource Id: 14662
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.25"
.head 5 -  Top:    6.083"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfMASA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.267"
.head 6 -  Top:    6.024"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nMASA
.head 7 -  Set dfMASA = nMASA
.head 3 -  Background Text: Ціна
.head 4 -  Resource Id: 14663
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.867"
.head 5 -  Top:    6.357"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCOST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.267"
.head 6 -  Top:    6.31"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nCOST
.head 7 -  Set dfCOST = nCOST
.head 3 -  Background Text: Сума
.head 4 -  Resource Id: 14665
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.317"
.head 5 -  Top:    2.714"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.267"
.head 6 -  Top:    6.595"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Підстава для операції
.head 4 -  Resource Id: 14666
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.25"
.head 5 -  Top:    6.905"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfPIDST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.267"
.head 6 -  Top:    6.881"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sPIDST
.head 7 -  Set dfPIDST = sPIDST
.head 3 -  !
.head 3 +  Pushbutton: pb_Kup
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.417"
.head 5 -  Top:    6.845"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F10
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Execute.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F10. С П Л А Т И Т И '
.head 5 +  On SAM_Click
.head 6 +  If not SalIsWindowVisible(sDETALI)
.head 7 -  Set bNoRek = FALSE
.head 7 +  ! If SalIsNull(dfDatd) or SalIsNull(cmbVOB) or SalIsNull(dfND) or SalIsNull(dfNLSA) or SalIsNull(dfNMSA) or
   SalIsNull(dfMFOA) or SalIsNull(dfOKPOA) or SalIsNull(dfNLSB) or SalIsNull(dfNMSB) or SalIsNull(dfMFOB) or
   SalIsNull(dfOKPOB) or SalIsNull(dfSUM) or SalIsNull(dfSK) or SalIsNull(mlNAZN) or SalIsNull(dfFIO) or
   SalIsNull(dfADR) or SalIsNull(dfSER) or SalIsNull(dfNOM) or SalIsNull(dfORGAN) or SalIsNull(dfBDAY) or
   SalIsNull(dfOKPO) or SalIsNull(cmbGRP) or SalIsNull(cmbBARAHLO) or SalIsNull(cmbMETPROB) or SalIsNull(dfCNT) or
   SalIsNull(dfZAG) or SalIsNull(dfZNJ) or SalIsNull(dfLIG) or SalIsNull(dfMASA) or SalIsNull(dfCOST) or
   SalIsNull(dfS) or SalIsNull(dfPIDST)
.head 8 -  Set bNoRek = TRUE
.head 7 +  If SalIsNull(dfDatd) or SalIsNull(cmbVOB) or SalIsNull(dfND) or SalIsNull(dfNLSA) or SalIsNull(dfMFOA) or
   SalIsNull(dfOKPOA) or SalIsNull(dfNLSB) or SalIsNull(dfMFOB) or SalIsNull(dfOKPOB) or SalIsNull(dfSUM) or
   SalIsNull(dfSK) or SalIsNull(mlNAZN) or SalIsNull(dfFIO) or SalIsNull(dfADR) or SalIsNull(dfSER) or
   SalIsNull(dfNOM) or SalIsNull(dfORGAN) or SalIsNull(dfBDAY) or SalIsNull(dfOKPO) or SalIsNull(cmbGRP) or
   SalIsNull(cmbBARAHLO) or SalIsNull(cmbMETPROB) or SalIsNull(dfCNT) or SalIsNull(dfZAG) or SalIsNull(dfZNJ) or
   SalIsNull(dfLIG) or SalIsNull(dfMASA) or SalIsNull(dfCOST) or SalIsNull(dfS) or SalIsNull(dfPIDST)
.head 8 -  Set bNoRek = TRUE
.head 7 +  If bNoRek
.head 8 -  Call SalMessageBox('Не всі реквізити документу заповнені', 'Помилка заповнення реквізитів', MB_Ok)
.head 8 +  If SalIsNull(cmbVOB)
.head 9 -  Call SalSetFocus(cmbVOB)
.head 8 +  Else If SalIsNull(dfND)
.head 9 -  Call SalSetFocus(dfND)
.head 8 +  Else If SalIsNull(dfDatd)
.head 9 -  Call SalSetFocus(dfDatd)
.head 8 +  Else If SalIsNull(dfNLSA)
.head 9 -  Call SalSetFocus(dfNLSA)
.head 8 +  ! Else If SalIsNull(dfNMSA)
.head 9 -  Call SalSetFocus(dfNMSA)
.head 8 +  Else If SalIsNull(dfMFOA)
.head 9 -  Call SalSetFocus(dfMFOA)
.head 8 +  Else If SalIsNull(dfOKPOA)
.head 9 -  Call SalSetFocus(dfOKPOA)
.head 8 +  Else If SalIsNull(dfNLSB)
.head 9 -  Call SalSetFocus(dfNLSB)
.head 8 +  ! Else If SalIsNull(dfNMSB)
.head 9 -  Call SalSetFocus(dfNMSB)
.head 8 +  Else If SalIsNull(dfMFOB)
.head 9 -  Call SalSetFocus(dfMFOB)
.head 8 +  Else If SalIsNull(dfOKPOB)
.head 9 -  Call SalSetFocus(dfOKPOB)
.head 8 +  Else If SalIsNull(dfSUM)
.head 9 -  Call SalSetFocus(dfSUM)
.head 8 +  Else If SalIsNull(dfSK)
.head 9 -  Call SalSetFocus(dfSK)
.head 8 +  Else If SalIsNull(mlNAZN)
.head 9 -  Call SalSetFocus(mlNAZN)
.head 8 +  Else If SalIsNull(dfFIO)
.head 9 -  Call SalSetFocus(dfFIO)
.head 8 +  Else If SalIsNull(dfADR)
.head 9 -  Call SalSetFocus(dfADR)
.head 8 +  Else If SalIsNull(dfSER)
.head 9 -  Call SalSetFocus(dfSER)
.head 8 +  Else If SalIsNull(dfNOM)
.head 9 -  Call SalSetFocus(dfNOM)
.head 8 +  Else If SalIsNull(dfORGAN)
.head 9 -  Call SalSetFocus(dfORGAN)
.head 8 +  Else If SalIsNull(dfBDAY)
.head 9 -  Call SalSetFocus(dfBDAY)
.head 8 +  Else If SalIsNull(dfOKPO)
.head 9 -  Call SalSetFocus(dfOKPO)
.head 8 +  Else If SalIsNull(cmbGRP)
.head 9 -  Call SalSetFocus(cmbGRP)
.head 8 +  Else If SalIsNull(cmbBARAHLO)
.head 9 -  Call SalSetFocus(cmbBARAHLO)
.head 8 +  Else If SalIsNull(cmbMETPROB)
.head 9 -  Call SalSetFocus(cmbMETPROB)
.head 8 +  Else If SalIsNull(dfCNT)
.head 9 -  Call SalSetFocus(dfCNT)
.head 8 +  Else If SalIsNull(dfZAG)
.head 9 -  Call SalSetFocus(dfZAG)
.head 8 +  Else If SalIsNull(dfZNJ)
.head 9 -  Call SalSetFocus(dfZNJ)
.head 8 +  Else If SalIsNull(dfLIG)
.head 9 -  Call SalSetFocus(dfLIG)
.head 8 +  Else If SalIsNull(dfMASA)
.head 9 -  Call SalSetFocus(dfMASA)
.head 8 +  Else If SalIsNull(dfCOST)
.head 9 -  Call SalSetFocus(dfCOST)
.head 8 +  Else If SalIsNull(dfS)
.head 9 -  Call SalSetFocus(dfS)
.head 8 +  Else If SalIsNull(dfPIDST)
.head 9 -  Call SalSetFocus(dfPIDST)
.head 7 +  Else
.head 8 -  Call f_OplLO4(Left(VisStrLeftTrim(cmbVOB), At(' ', VisStrLeftTrim(cmbVOB))-1), dfDatd, dfND, dfMFOA, dfNLSA, dfNMSA,
     dfOKPOA, dfMFOB, dfNLSB, dfNMSB, dfOKPOB, dfS, mlNAZN, dfSK, dfFIO, dfADR, dfSER, dfNOM, dfORGAN, dfBDAY,
     dfOKPO, Left(cmbGRP, At(' ', cmbGRP)-1), cmbBARAHLO, cmbMETPROB, dfNOMMON, dfCNT, dfZAG, dfZNJ, dfLIG, dfMASA,
     dfCOST, dfSUM, dfPIDST)
.head 6 +  Else
.head 7 -  Call SalMessageBox('Необхідно ввести документ', 'Попередження', MB_Ok | MB_IconQuestion)
.head 3 +  Pushbutton: pb_New
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.917"
.head 5 -  Top:    6.845"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F1
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F1. Новий з витяжкою'
.head 5 +  On SAM_Click
.head 6 +  If SalIsWindowVisible(sDETALI)
.head 7 -  Call f_ClearO()
.head 3 +  Pushbutton: pb_Exit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.467"
.head 5 -  Top:    6.845"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'ESC. Завершити'
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 +  Data Field: sDETALI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.467"
.head 6 -  Top:    6.56"
.head 6 -  Width:  6.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold-Italic-Underline
.head 5 -  Text Color: Default
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbViewDoc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.6"
.head 5 -  Top:    6.845"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: E:\Bars98\RESOURCE\BMP\OPEN.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Перегляд документа'
.head 5 +  On SAM_Click
.head 6 +  If sDETALI
.head 7 -  Call DocView(hWndMDI, Val(Right(sDETALI, Len(sDETALI) - At('=', sDETALI))), 2, 0, '')                        
.head 2 +  Functions
.head 3 +  Function: f_OplLO4
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sVob
.head 5 -  Date/Time: dDatd
.head 5 -  String: sND
.head 5 -  String: sMFOA
.head 5 -  String: sNLSA
.head 5 -  String: sNMSA
.head 5 -  String: sOKPOA
.head 5 -  String: sMFOB
.head 5 -  String: sNLSB
.head 5 -  String: sNMSB
.head 5 -  String: sOKPOB
.head 5 -  Number: nSUM
.head 5 -  String: sNazn
.head 5 -  Number: nSK
.head 5 -  String: sFIO
.head 5 -  String: sADR
.head 5 -  String: sSER
.head 5 -  String: sNOM
.head 5 -  String: sORGAN
.head 5 -  Date/Time: dBDAY
.head 5 -  String: sOKPO
.head 5 -  String: sGRP
.head 5 -  String: sBARAHLO
.head 5 -  String: sMETPROB
.head 5 -  String: sNOMMON
.head 5 -  Number: nCNT
.head 5 -  Number: nZAG
.head 5 -  Number: nZNJ
.head 5 -  Number: nLIG
.head 5 -  Number: nMASA
.head 5 -  Number: nCOST
.head 5 -  Number: nS
.head 5 -  String: sPIDST
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSum
.head 5 -  Number: nRef
.head 5 -  ! Number: ref_LO1
.head 5 -  ! String: ref_LO2
.head 5 -  ! String: FORMUL
.head 5 -  ! Number: S2
.head 5 -  ! Number: i
.head 4 +  Actions
.head 5 -  Set nRef = NUMBER_Null
.head 5 -  Set nSum = nSUM * 100
.head 5 -  !
.head 5 -  Call cDoc.SetDoc(nRef, 'LO4', 1, Val(sVob), sND, BankDate, BankDate, BankDate, BankDate, sNLSA, sNMSA, sMFOA, '', n980,
     nSum, sOKPOA, sNLSB, sNMSB, sMFOB, '', n980, nSum, sOKPOB, sNazn, '', GetIdOper(), '', nSK, 0)
.head 5 +  If cDoc.oDoc()
.head 6 -  Set nRef = cDoc.m_nRef
.head 6 +  If f_OPERWLO4(nRef, sFIO, sADR, sSER, sNOM, sORGAN, sDATV, dfBDAY, sOKPO, sGRP, sBARAHLO, sMETPROB, sNOMMON, nCNT,
   nZAG, nZNJ, nLIG, nMASA, nCOST, nS, sPIDST)
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalShowWindow(sDETALI)
.head 7 -  Call SalShowWindow(pbViewDoc)
.head 7 -  Set sDETALI = 'Документ оплачен, реф.=' || Str(nRef)
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Return FALSE
.head 3 +  Function: f_ClearO !! сделка
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sDETALI = STRING_Null
.head 5 -  Call SalHideWindow(sDETALI)
.head 5 -  Call SalHideWindow(pbViewDoc)
.head 5 -  Set dfND    = STRING_Null
.head 5 -  Set dfS     = NUMBER_Null
.head 5 -  Set dfCNT   = NUMBER_Null
.head 5 -  Set dfZAG   = NUMBER_Null
.head 5 -  Set dfZNJ   = NUMBER_Null
.head 5 -  Set dfLIG   = NUMBER_Null
.head 5 -  Set dfMASA  = NUMBER_Null
.head 5 -  Set dfCOST  = NUMBER_Null
.head 5 -  Set dfSUM   = NUMBER_Null
.head 5 -  Set mlSUMPR = STRING_Null
.head 3 +  Function: f_OPERWLO4
.head 4 -  Description: Вставка доп.реквизитов по РЕФ:
f_OPERWLO4(cDoc.m_nRef, sFIO, sADR, sSER, sNOM, sORGAN, sDATV, dfBDAY, sOKPO, sGRP, sBARAHLO, sMETPROB,
           sNOMMON, nCNT, nZAG, nZNJ, nLIG, nMASA, nCOST, nS, sPIDST)
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRefO
.head 5 -  String: sFIO
.head 5 -  String: sADR
.head 5 -  String: sSER
.head 5 -  String: sNOM
.head 5 -  String: sORGAN
.head 5 -  String: sDATV
.head 5 -  Date/Time: dBDAY
.head 5 -  String: sOKPO
.head 5 -  String: sGRP
.head 5 -  String: sBARAHLO
.head 5 -  String: sMETPROB
.head 5 -  String: sNOMMON
.head 5 -  Number: nCNT
.head 5 -  Number: nZAG
.head 5 -  Number: nZNJ
.head 5 -  Number: nLIG
.head 5 -  Number: nMASA
.head 5 -  Number: nCOST
.head 5 -  Number: nS
.head 5 -  String: sPIDST
.head 4 +  Static Variables
.head 5 -  ! String: sPasp
.head 5 -  ! String: sAtrt
.head 4 +  Local variables
.head 5 -  String: s1
.head 5 -  String: s2
.head 5 -  String: s3
.head 5 -  String: s4
.head 5 -  String: s5
.head 5 -  String: s6
.head 5 -  String: s7
.head 5 -  String: sPasp
.head 5 -  String: sAtrt
.head 5 -  !
.head 5 -  ! String: sL_EDN
.head 5 -  ! String: sL_NOM
.head 5 -  String: sBday
.head 5 -  Number: nCountUpd
.head 5 -  Number: nNOMMON
.head 4 +  Actions
.head 5 -  Set sPasp = SalStrTrimX(sSER || ' ' || sNOM)
.head 5 -  Set sAtrt = SalStrTrimX(sORGAN || ' ' || SalFmtFormatDateTime(SalStrToDate(sDATV), 'dd/MM/yyyy'))
.head 5 -  Set sBday = SalFmtFormatDateTime(dBDAY, 'dd/MM/yyyy')
.head 5 -  Set s1 = num_to_str_point(nZAG, 2)
.head 5 -  Set s2 = num_to_str_point(nZNJ, 2)
.head 5 -  Set s3 = num_to_str_point(nLIG, 2)
.head 5 -  Set s4 = num_to_str_point(nCOST, 2)
.head 5 -  Set s5 = num_to_str_point(nS, 2)
.head 5 -  Set s6 = num_to_str_point(nMASA, 2)
.head 5 -  Set s7 = Str(nCNT)
.head 5 -  Set nNOMMON = Val(sNOMMON)
.head 5 -  ! Call DebugN(nRefO)
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   INSERT INTO lom_w (ref,fio,pasp,atrt,adres,okpo,bday,l_izd,l_edn,l_met,l_nom,l_zag,l_znj,l_lig,l_cen,l_sum,grp)
              values (:nRefO,:sFIO,:sPasp,:sAtrt,:sADR,:sOKPO,:sBday,:sBARAHLO,:nCNT,:sMETPROB,:nNOMMON,:nZAG,:nZNJ,
                      :nLIG, :nCOST,:nS,:sGRP)") and
   i_OPERW(nRefO, 'ADRES', sADR)  and i_OPERW(nRefO, 'ATRT' , sAtrt)    and i_OPERW(nRefO, 'BDAY' , sBday)    and
   i_OPERW(nRefO, 'FIO'  , sFIO)  and i_OPERW(nRefO, 'GRP'  , sGRP)     and i_OPERW(nRefO, 'L_CEN', s4)       and 
   i_OPERW(nRefO, 'L_CLR', s6)    and i_OPERW(nRefO, 'L_EDN', s7)       and i_OPERW(nRefO, 'L_IZD', sBARAHLO) and 
   i_OPERW(nRefO, 'L_LIG', s3)    and i_OPERW(nRefO, 'L_MET', sMETPROB) and i_OPERW(nRefO, 'L_NOM', sNOMMON)  and
   i_OPERW(nRefO, 'L_SUM', s5)    and i_OPERW(nRefO, 'L_ZAG', s1)       and i_OPERW(nRefO, 'L_ZNJ', s2)       and
   i_OPERW(nRefO, 'OKPO' , sOKPO) and i_OPERW(nRefO, 'PASP' , sPasp)    and i_OPERW(nRefO, 'PIDST', sPIDST)
.head 6 -  ! Call SqlCommit(hSql())
.head 6 -  ! Call Debug('INSERT INTO lom_w')
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  ! Call Debug('not insert INTO lom_w')
.head 6 -  Return FALSE
.head 3 +  Function: i_OPERW
.head 4 -  Description: Вставка доп.реквизитов по РЕФ
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nRefW
.head 5 -  String: sTag
.head 5 -  String: sVal
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If sVal = STRING_Null or Len(sVal) = 0
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return SqlPrepareAndExecute(hSql(), "
       INSERT
       INTO   operw (ref,tag,value)
             VALUES (:nRefW,:sTag,:sVal)")
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: sPar01
.head 3 -  String: sPar02
.head 2 +  Window Variables
.head 3 -  ! String: sTmp
.head 3 -  ! Number: MET
.head 3 -  Number: n980
.head 3 -  Number: nSK
.head 3 -  ! Number: nVob
.head 3 -  ! Number: nVob9
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  !
.head 3 -  ! String: sDecimal   ! симв десятичной точки
.head 3 -  ! String: sDecimal2  ! симв десятичной точки alt
.head 3 -  ! String: sSql
.head 3 -  ! Number: NFeechRez
.head 3 -  !
.head 3 -  Boolean: bNoRek
.head 3 -  !
.head 3 -  ! Number: nMet
.head 3 -  ! Number: nProba
.head 3 -  !
.head 3 -  ! Number: nUserid
.head 3 -  ! String: sExp
.head 3 -  ! Number: nI
.head 3 -  !
.head 3 -  String: sDatd
.head 3 -  String: sVOB
.head 3 -  String: sND
.head 3 -  String: sNLSA
.head 3 -  ! String: sNMSA
.head 3 -  String: sOKPOA
.head 3 -  String: sNLSB
.head 3 -  ! String: sNMSB
.head 3 -  String: sOKPOB
.head 3 -  String: sNAZN
.head 3 -  String: sFIO
.head 3 -  String: sADR
.head 3 -  String: sSER
.head 3 -  String: sNOM
.head 3 -  String: sORGAN
.head 3 -  String: sDATV
.head 3 -  String: sBDAY
.head 3 -  String: sOKPO
.head 3 -  String: sGRP
.head 3 -  String: sBARAHLO
.head 3 -  String: sMETPROB
.head 3 -  Number: nCNT
.head 3 -  Number: nZAG
.head 3 -  Number: nZNJ
.head 3 -  Number: nLIG
.head 3 -  Number: nMASA
.head 3 -  Number: nCOST
.head 3 -  Number: nS
.head 3 -  String: sPIDST
.head 3 -  !
.head 3 -  ! Number: nRef
.head 3 -  !
.head 3 -  String: sNOMMON
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Set sDecimal = SalStrMidX(SalNumberToStrX(1.1, 1), 1, 1)
.head 4 -  ! Set sDecimal2 = IifS(sDecimal='.', ',', '.')
.head 4 -  Set BankName = GetBankName()
.head 4 -  Set BankMfo  = GetBankMfo()
.head 4 -  Set BankDate = GetBankDate()
.head 4 -  Set n980     = GetBaseVal()
.head 4 -  !
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 -  Call SalGetProfileString  ('LO4', 'VOB',     '',  sVOB,     '')
.head 4 -  Call SalGetProfileString  ('LO4', 'DATD',    '',  sDatd,    '')
.head 4 -  Call SalGetProfileString  ('LO4', 'NLSA',    '',  sNLSA,    '')
.head 4 -  ! Call SalGetProfileString  ('LO4', 'NMSA',    '',  sNMSA,    '')
.head 4 -  Call SalGetProfileString  ('LO4', 'OKPOA',   '',  sOKPOA,   '')
.head 4 -  Call SalGetProfileString  ('LO4', 'NLSB',    '',  sNLSB,    '')
.head 4 -  ! Call SalGetProfileString  ('LO4', 'NMSB',    '',  sNMSB,    '')
.head 4 -  Call SalGetProfileString  ('LO4', 'OKPOB',   '',  sOKPOB,   '')
.head 4 -  Set nSK = SalGetProfileInt('LO4', 'SK',      NUMBER_Null,   '')
.head 4 -  Call SalGetProfileString  ('LO4', 'NAZN',    '',  sNAZN,    '')
.head 4 -  Call SalGetProfileString  ('LO4', 'FIO',     '',  sFIO,     '')
.head 4 -  Call SalGetProfileString  ('LO4', 'ADR',     '',  sADR,     '')
.head 4 -  Call SalGetProfileString  ('LO4', 'SER',     '',  sSER,     '')
.head 4 -  Call SalGetProfileString  ('LO4', 'NOM',     '',  sNOM,     '')
.head 4 -  Call SalGetProfileString  ('LO4', 'ORGAN',   '',  sORGAN,   '')
.head 4 -  Call SalGetProfileString  ('LO4', 'DATV',    '',  sDATV,    '')
.head 4 -  Call SalGetProfileString  ('LO4', 'BDAY',    '',  sBDAY,    '')
.head 4 -  Call SalGetProfileString  ('LO4', 'OKPO',    '',  sOKPO,    '')
.head 4 -  Call SalGetProfileString  ('LO4', 'GRP',     '',  sGRP,     '')
.head 4 -  Call SalGetProfileString  ('LO4', 'BARAHLO', '',  sBARAHLO, '')
.head 4 -  Call SalGetProfileString  ('LO4', 'NOMMON',  '',  sNOMMON,  '')
.head 4 -  Call SalGetProfileString  ('LO4', 'METPROB', '',  sMETPROB, '')
.head 4 -  Call SalGetProfileString  ('LO4', 'PIDST',   '',  sPIDST,   '')
.head 4 -  !
.head 4 -  Call f_ClearO()
.head 4 -  ! Call f_ClearD()
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalUseRegistry(TRUE, GetCompanyName())
.head 4 +  If cmbVOB
.head 5 -  Call SalSetProfileString('LO4', 'VOB',     cmbVOB,     '')
.head 4 +  If dfDatd
.head 5 -  Call SalDateToStr(dfDatd, sDatd)
.head 5 -  Call SalSetProfileString('LO4', 'DATD',    sDatd,      '')
.head 4 +  If dfNLSA
.head 5 -  Call SalSetProfileString('LO4', 'NLSA',    dfNLSA,     '')
.head 4 +  ! If dfNMSA
.head 5 -  Call SalSetProfileString('LO4', 'NMSA',    dfNMSA,     '')
.head 4 +  If dfOKPOA
.head 5 -  Call SalSetProfileString('LO4', 'OKPOA',   dfOKPOA,    '')
.head 4 +  If dfNLSB
.head 5 -  Call SalSetProfileString('LO4', 'NLSB',    dfNLSB,     '')
.head 4 +  ! If dfNMSB
.head 5 -  Call SalSetProfileString('LO4', 'NMSB',    dfNMSB,     '')
.head 4 +  If dfOKPOB
.head 5 -  Call SalSetProfileString('LO4', 'OKPOB',   dfOKPOB,    '')
.head 4 +  If dfSK
.head 5 -  Call SalSetProfileString('LO4', 'SK',      Str(dfSK),  '')
.head 4 +  If mlNAZN
.head 5 -  Call SalSetProfileString('LO4', 'NAZN',    mlNAZN,     '')
.head 4 +  If dfFIO
.head 5 -  Call SalSetProfileString('LO4', 'FIO',     dfFIO,      '')
.head 4 +  If dfADR
.head 5 -  Call SalSetProfileString('LO4', 'ADR',     dfADR,      '')
.head 4 +  If dfSER
.head 5 -  Call SalSetProfileString('LO4', 'SER',     dfSER,      '')
.head 4 +  If dfNOM
.head 5 -  Call SalSetProfileString('LO4', 'NOM',     dfNOM,      '')
.head 4 +  If dfORGAN
.head 5 -  Call SalSetProfileString('LO4', 'ORGAN',   dfORGAN,    '')
.head 4 +  If dfDATV
.head 5 -  Call SalDateToStr(dfDATV, sDATV)
.head 5 -  Call SalSetProfileString('LO4', 'DATV',    sDATV,      '')
.head 4 +  If dfBDAY
.head 5 -  Call SalDateToStr(dfBDAY, sBDAY)
.head 5 -  Call SalSetProfileString('LO4', 'BDAY',    sBDAY,      '')
.head 4 +  If dfOKPO
.head 5 -  Call SalSetProfileString('LO4', 'OKPO',    dfOKPO,     '')
.head 4 +  If cmbGRP
.head 5 -  Call SalSetProfileString('LO4', 'GRP',     cmbGRP,     '')
.head 4 +  If cmbBARAHLO
.head 5 -  Call SalSetProfileString('LO4', 'BARAHLO', cmbBARAHLO, '')
.head 4 +  If dfNOMMON
.head 5 -  Call SalSetProfileString('LO4', 'NOMMON',  dfNOMMON,   '')
.head 4 +  If cmbMETPROB
.head 5 -  Call SalSetProfileString('LO4', 'METPROB', cmbMETPROB, '')
.head 4 +  If dfPIDST
.head 5 -  Call SalSetProfileString('LO4', 'PIDST',   dfPIDST,    '')
.head 1 +  Form Window: PO
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ПОЗАБАЛАНСОВИЙ ОРДЕР по руху цінностей
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   2.363"
.head 4 -  Top:    0.958"
.head 4 -  Width:  12.917"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.333"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Bottom
.head 4 -  Visible? Yes
.head 4 -  Size: 0.464"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Data Field: nRef
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.317"
.head 7 -  Top:    0.071"
.head 7 -  Width:  2.417"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 12
.head 6 -  Font Enhancement: Bold-Italic-Underline
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPayDoc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.25"
.head 6 -  Top:    0.036"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F10. Ввести'
.head 6 +  On SAM_Click
.head 7 +  If f_Gotov()
.head 8 -  If f_Opl()
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.8"
.head 6 -  Top:    0.036"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SAVE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If PIDSTAVA!=STRING_Null
.head 8 -  Call SqlPrepareAndExecute(hSql(), "
     Insert
     into PO_PIDST (ID,TXT)
     values (" || Str(GetUserId()) || ",'" || PIDSTAVA || "')")
.head 7 +  If ZMIST != STRING_Null
.head 8 -  Call SqlPrepareAndExecute(hSql(), "
     Insert
     into PO_ZMIST (ID,TXT)
     values (" || Str(GetUserId()) || ",'" || ZMIST || "')")
.head 4 +  Pushbutton: pb_F5
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.717"
.head 6 -  Top:    0.036"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F5. Надрукувати МО'
.head 6 +  On SAM_Click
.head 7 -  Call cDoc.pDoc()
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 +  Pushbutton: pb_New
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.183"
.head 6 -  Top:    0.036"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F6
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F6. Новий з витяжною'
.head 6 +  On SAM_Click
.head 7 -  Call f_Clear2(rbP)
.head 7 -  Call SalHideWindow(pb_F5)
.head 7 -  Call SalHideWindow(pbSave)
.head 4 +  Pushbutton: pb_Clear
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.65"
.head 6 -  Top:    0.036"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F7
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F7. Новий з очисткою'
.head 6 +  On SAM_Click
.head 7 -  Call f_Clear2(rbP)
.head 7 -  Call f_Clear1(rbP)
.head 7 -  Call f_Clear0(rbP)
.head 7 -  Call SalHideWindow(pb_F5)
.head 7 -  Call SalHideWindow(pbSave)
.head 7 -  Call SalTblReset(tbl1)
.head 7 -  Call SalSendMsg(tbl1, SAM_Create, 0, 0)
.head 4 +  Pushbutton: pb_Exit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.117"
.head 6 -  Top:    0.036"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'ESC. Завершити'
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Background Text: Документ №
.head 5 -  Resource Id: 43504
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.417"
.head 6 -  Top:    0.107"
.head 6 -  Width:  1.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: NUM_DOC
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.717"
.head 7 -  Top:    0.06"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Data Field: BankName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.85"
.head 6 -  Top:    0.071"
.head 6 -  Width:  8.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: BankMfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.067"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: BankDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.317"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Radio Button: rbP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПРИБУТКОВИЙ 
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    0.5"
.head 5 -  Width:  2.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call f_Clear0(rbP)
.head 6 -  Call f_Resume()
.head 6 -  Set cb1 = 0
.head 3 +  Radio Button: rbM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВИДАТКОВИЙ
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    1.036"
.head 5 -  Width:  2.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call f_Clear0(rbP)
.head 6 -  Call f_Resume()
.head 6 -  Set cb1 = 0
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 42526
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.317"
.head 5 -  Top:    0.381"
.head 5 -  Width:  12.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: PRYNATO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.5"
.head 6 -  Width:  2.533"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbCLI1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.45"
.head 5 -  Top:    0.452"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F1
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Custbank.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Sky
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F1. Вибрати БАНК: Кому належать цінності'
.head 5 +  On SAM_Click
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 6 -  Call FunNSIGetFiltered("BANKS", "NB", "", sTmp, FIO1)
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 6 -  Call SalSendMsg(FIO1, SAM_Validate, 0, 0)
.head 6 -  !
.head 3 +  Pushbutton: pbFIO1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.9"
.head 5 -  Top:    0.452"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F11
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Custclsd.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Salmon
.head 4 -  Background Color: Sky
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F11. Вибрати ФО: Кому належать цінності'
.head 5 +  On SAM_Click
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 6 -  Call FunNSIGetFiltered("PODOTCH", "FIO", "", sTmp, FIO1)
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 6 -  Call SalSendMsg(FIO1, SAM_Validate, 0, 0)
.head 6 -  !
.head 3 +  Data Field: FIO1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.333"
.head 6 -  Top:    0.5"
.head 6 -  Width:  4.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call f_Sum()
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 6 +  If rbP
.head 7 -  Call SalSetFocus(NLSA)
.head 6 +  Else
.head 7 -  Call SalSetFocus(FIO2)
.head 3 -  !
.head 3 +  Data Field: VYDATY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.036"
.head 6 -  Width:  2.533"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbCLI2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.45"
.head 5 -  Top:    0.988"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F2
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Custcorp.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Maize
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F2. Вибрати БАНК: Хто отримує цінності'
.head 5 +  On SAM_Click
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 6 -  Call FunNSIGetFiltered ("BANKS", "NB", "", sTmp, FIO2)
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 6 -  Call SalSendMsg(FIO2, SAM_Validate, 0, 0)
.head 3 +  Pushbutton: pbFIO2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.9"
.head 5 -  Top:    0.988"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F12
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Custpers.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Maize
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F12. Вибрати ФО: Хто отримує цінності'
.head 5 +  On SAM_Click
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 6 -  Call FunNSIGetFiltered ("PODOTCH", "FIO", "", sTmp, FIO2)
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 6 -  Call SalSendMsg(FIO2, SAM_Validate, 0, 0)
.head 3 +  Data Field: FIO2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.333"
.head 6 -  Top:    1.036"
.head 6 -  Width:  4.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call f_Sum()
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 6 -  ! Call SalSetFocus(N1)
.head 3 -  !
.head 3 +  Data Field: KK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.333"
.head 6 -  Top:    2.512"
.head 6 -  Width:  2.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Введено: кількість')
.head 3 -  !
.head 3 -  Background Text: F3. Рахунок
.head 4 -  Resource Id: 42534
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.2"
.head 5 -  Top:    1.917"
.head 5 -  Width:  1.117"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.238"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbHelp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.7"
.head 5 -  Top:    1.917"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F3
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Help.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Light Green
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F3. Вибрати рахунок'
.head 5 +  On SAM_Click
.head 6 -  Set sTmp=STRING_Null
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 6 -  Call FunNSIGetFiltered("SALDO_PO", "NLS", "dazs is null AND kv=" || Str(KV) ||
     " AND substr(nbs,1,1)='9' AND pap<3 AND nbs in (select nbs from ps where pap<3) AND P=" ||
     SalNumberToStrX(rbP, 0), sTmp, NLSA)
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 6 -  Call SalSendMsg(NLSA, SAM_Validate, 0, 0)
.head 6 -  !
.head 3 +  Pushbutton: pbHelp2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.7"
.head 5 -  Top:    2.286"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F4
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Help.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Light Green
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F4. Вибрати рахунок'
.head 5 +  On SAM_Click
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 6 +  If NBUBANK
.head 7 -  Call FunNSIGetFiltered("SALDO_PO", "NLS", "dazs is null AND kv=" || Str(KV) ||
     " AND substr(nbs,1,1)='9' AND pap<3 AND nbs in (select nbs from ps where pap<3) AND P=" ||
     SalNumberToStrX(rbP, 0), sTmp, NLSB)
.head 6 +  Else
.head 7 -  Call FunNSIGetFiltered("SALDO_PO", "NLS", "dazs IS NULL AND kv=" || Str(KV) ||
     " AND SUBSTR(nbs,1,1)='9' AND nbs IN (SELECT DECODE(" || Str(rbP) || ",1,NBS_K,NBS_D) FROM PO_NBS WHERE DECODE("
     || Str(rbP) || ",1,NBS_D,NBS_K)=SUBSTR(" || NLSA || ",1,4) AND PO_DK=" || Str(rbP) || ")  AND P=" ||
     SalNumberToStrX(rbM, 0), sTmp, NLSB)
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 6 -  Call SalSendMsg(NLSB, SAM_Validate, 0, 0)
.head 6 -  !
.head 3 +  Pushbutton: pbHelp3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.717"
.head 5 -  Top:    4.5"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F8
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Help.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Light Green
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F8. Зміст операції'
.head 5 +  On SAM_Click
.head 6 -  Set sTmp=STRING_Null
.head 6 -  Call FunNSIGetFiltered("PO_ZMIST", "TXT", "ID=" || Str(GetUserId()), sTmp, ZMIST)
.head 6 -  Call SalSendMsg(ZMIST, SAM_Validate, 0, 0)
.head 6 -  !
.head 3 +  Pushbutton: pbHelp4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.717"
.head 5 -  Top:    4.893"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F9
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Help.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Light Green
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F9. Підстава'
.head 5 +  On SAM_Click
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 6 -  Call FunNSIGetFiltered("PO_PIDST", "TXT", "ID=" || Str(GetUserId()), sTmp, PIDSTAVA)
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 6 -  Call SalSendMsg(PIDSTAVA, SAM_Validate, 0, 0)
.head 6 -  !
.head 3 +  Data Field: PAP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.333"
.head 6 -  Top:    1.69"
.head 6 -  Width:  1.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: DKA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.167"
.head 6 -  Top:    1.929"
.head 6 -  Width:  0.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: DKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.167"
.head 6 -  Top:    2.262"
.head 6 -  Width:  0.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.7"
.head 6 -  Top:    1.631"
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If KV = NUMBER_Null
.head 7 -  Set KV = n980
.head 6 +  If SqlPrepareAndExecute( hSql(), "
   SELECT name,lcv,unit
   into :sKV,:sLCV,:sUnit
   from tabval
   where kv=:KV") and not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set sKV = "Помилка в коді валюти !"
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set ml1 = SumPr(SS*100, 'F', IifS(KV=980, 'Грн', sLCV), sUnit)
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Код валюти')
.head 3 +  Data Field: NLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.333"
.head 6 -  Top:    1.917"
.head 6 -  Width:  1.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 6 -  Set cb1 = 0
.head 6 -  Call f_Resume()
.head 6 +  If not SalIsNull(NLSA)
.head 7 +  If SqlPrepareAndExecute(hSql(),
"SELECT substr(s.nms,1,38), p.name, p.pap, c.OKPO
   INTO :NMSA, :PAP, :nPAP, :OKPOA
   from " || IifS((nPAP=1 and rbP) or (nPAP=2 and rbM), "SALDOD", "SALDOK") || " s, pap p, cust_acc u, customer c
  WHERE s.acc=u.acc and u.rnk=c.rnk and p.pap=s.pap AND s.dazs is null AND s.kv=:KV AND s.nls=:NLSA
    AND substr(s.nbs,1,1)='9' AND s.pap<3 AND s.nbs in (select nbs from ps where pap<3)") and
   not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set NLSA = STRING_Null
.head 8 -  Set NMSA = STRING_Null
.head 8 -  Set OKPOA = STRING_Null
.head 8 -  Call SalMessageBox("Рахунок не знайдено", "Помилка !", MB_IconExclamation)
.head 8 -  Call SalDisableWindow(cb1)
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Call f_DK()
.head 6 -  Call f_Sum()
.head 6 -  Call SalEnableWindow(cb1)
.head 6 -  Call SalSetFocus(tbl1)
.head 6 -  Call SalTblSetFocusCell(tbl1, 0, tbl1.col1, 0, 1)
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_KillFocus
.head 6 +  If wParam = SalWindowHandleToNumber(tbl1)
.head 7 -  Call SalTblSetFocusCell(tbl1, 0, tbl1.col1, 0, 1)
.head 3 +  Data Field: NMSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    1.917"
.head 6 -  Width:  3.767"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: sKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    1.655"
.head 6 -  Width:  3.767"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Сума загальна
.head 4 -  Resource Id: 42541
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.5"
.head 5 -  Top:    1.69"
.head 5 -  Width:  2.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: SS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.5"
.head 6 -  Top:    1.917"
.head 6 -  Width:  2.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Введено: сума')
.head 3 -  !
.head 3 +  Data Field: NMSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    2.274"
.head 6 -  Width:  3.767"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: OKPOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    1.917"
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: OKPOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    2.274"
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.333"
.head 6 -  Top:    2.262"
.head 6 -  Width:  1.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 +  If SqlPrepareAndExecute( hSql(), "
   SELECT substr(s.nms,1,38),c.OKPO
   INTO :NMSB,:OKPOB
   from " || IifS((nPAP=1 and rbP) or (nPAP=2 and rbM), "SALDOK", "SALDOD") || " s, cust_acc u, customer c
   WHERE s.acc=u.acc and u.rnk=c.rnk and s.dazs is null AND s.kv=:KV AND s.nls=:NLSB AND substr(s.nbs,1,1)='9'") and
   not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set NLSB = STRING_Null
.head 7 -  Set NMSB = STRING_Null
.head 7 -  Set OKPOB = STRING_Null
.head 7 -  Call SalMessageBox("Рахунок не знайдено", "Помилка !", MB_IconExclamation)
.head 7 -  Call f_Resume()
.head 3 -  !
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    2.81"
.head 6 -  Width:  11.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.393"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 34
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: col1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Найменування документів (цінностей)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 200
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  6.533"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Кількість
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.817"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col3
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.333"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nI
.head 5 -  Number: nNewRow
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set nI = 0
.head 6 +  While nI < 34
.head 7 -  Set nNewRow = SalTblInsertRow(tbl1, nI)					
.head 7 -  Call SalTblSetContext(tbl1, nNewRow)
.head 7 -  Set col1 = ''
.head 7 -  Set col2 = NUMBER_Null
.head 7 -  Set col3 = NUMBER_Null
.head 7 -  Set nI = nI + 1
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_HScrollByCols, FALSE)
.head 3 -  !
.head 3 +  Data Field: NI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    4.19"
.head 6 -  Width:  6.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: KI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.333"
.head 6 -  Top:    4.19"
.head 6 -  Width:  1.817"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set KK = SalTblColumnSum(tbl1, SalTblQueryColumnID(tbl1.col2), 0, 0)
.head 5 +  On SAM_Validate
.head 6 +  If KK != KI
.head 7 -  Call SalMessageBox("Нерівність по кількості на " || Str(KK-KI), "Помилка !", MB_IconExclamation)
.head 7 -  Call SalSetFocus(KI)
.head 6 +  Else
.head 7 -  Call f_Gotov()
.head 7 -  Call SalSetFocus(SI)
.head 3 +  Data Field: SI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.167"
.head 6 -  Top:    4.19"
.head 6 -  Width:  2.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set SS = SalTblColumnSum(tbl1, SalTblQueryColumnID(tbl1.col3), 0, 0)
.head 5 +  On SAM_Validate
.head 6 -  Call f_Tochka(hWndItem)
.head 6 +  If SS != SI
.head 7 -  Call SalMessageBox("Нерівність пл суми на " || SalNumberToStrX(SS-SI, 2), "Помилка !", MB_IconExclamation)
.head 7 -  Call SalSetFocus(SI)
.head 6 +  Else
.head 7 -  ! Set ml1 = SumPr(SS*100, 'F', 'Грн', "коп")
.head 7 -  Set ml1 = SumPr(SS*100, 'F', IifS(KV=980, 'Грн', sLCV), sUnit)
.head 7 -  Call f_Gotov()
.head 7 -  Call SalSetFocus(ZMIST)
.head 3 +  Data Field: ZMIST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.05"
.head 6 -  Top:    4.5"
.head 6 -  Width:  9.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call f_Sum()
.head 6 -  Call SalSetFocus(PIDSTAVA)
.head 3 -  !
.head 3 -  Background Text: Підстава
.head 4 -  Resource Id: 42544
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.533"
.head 5 -  Top:    5.0"
.head 5 -  Width:  1.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: PIDSTAVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.067"
.head 6 -  Top:    4.893"
.head 6 -  Width:  9.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call f_Sum()
.head 6 -  Call SalSetFocus(NUM_DOC)
.head 3 +  Data Field: PUSTO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.5"
.head 6 -  Top:    3.024"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Multiline Field: ml1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    5.298"
.head 6 -  Width:  11.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.512"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: nalej
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.367"
.head 6 -  Top:    0.762"
.head 6 -  Width:  4.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set nalej = 'F1, F11. Кому належать цінності'
.head 3 +  Data Field: otrim
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.383"
.head 6 -  Top:    1.286"
.head 6 -  Width:  4.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set otrim = 'F2, F12. Хто отримує цінності'
.head 3 +  Data Field: dfZm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    4.583"
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Check Box: cb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ручной ввод контр. счета
.head 4 -  Window Location and Size
.head 5 -  Left:   0.467"
.head 5 -  Top:    2.548"
.head 5 -  Width:  2.617"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cb1
.head 7 -  Call SalShowWindow(pbHelp2)
.head 7 -  Set df46 = 'F4. Рахунок'
.head 6 +  Else
.head 7 -  Call f_Resume()
.head 3 +  Data Field: df46
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.183"
.head 6 -  Top:    2.298"
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: f_Clear2
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: rb
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set ml1 = STRING_Null
.head 5 -  Set nRef = NUMBER_Null
.head 5 -  Set SS = 0
.head 5 -  Set KK = 0
.head 5 -  ! Set S1=0
.head 5 -  ! Set S2=0
.head 5 -  ! Set S3=0
.head 5 -  ! Set S4=0
.head 5 -  ! Set S5=0
.head 5 -  Set SI = 0
.head 5 -  ! Set K1=0
.head 5 -  ! Set K2=0
.head 5 -  ! Set K3=0
.head 5 -  ! Set K4=0
.head 5 -  ! Set K5=0
.head 5 -  Set KI = 0
.head 5 -  ! Set N1=STRING_Null
.head 5 -  ! Set N2=STRING_Null
.head 5 -  ! Set N3=STRING_Null
.head 5 -  ! Set N4=STRING_Null
.head 5 -  ! Set N5=STRING_Null
.head 5 -  ! Call SalSetFocus(N1)
.head 5 -  Call SalMapEnterToTab(TRUE)
.head 3 +  Function: f_Clear1 !! ФИО, ...
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: rb
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set FIO1 = STRING_Null
.head 5 -  Set FIO2 = STRING_Null
.head 5 -  Set NLSA = STRING_Null
.head 5 -  Set NLSB = sPOP_Nlsb
.head 5 -  Set PIDSTAVA = STRING_Null
.head 5 -  Set ZMIST = STRING_Null
.head 5 -  Set NUM_DOC = STRING_Null
.head 5 -  Set KV = n980
.head 5 -  Set sKV = s980
.head 5 -  Set cb1 = FALSE
.head 5 -  Call SalHideWindow(pbHelp2)
.head 5 -  Set df46 = ''
.head 5 -  Call SalSetFocus(FIO1)
.head 5 -  Call SalMapEnterToTab(TRUE)
.head 3 +  Function: f_Clear0 !! 
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Boolean: rb
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If rb
.head 6 -  Set FIO2 = BankName
.head 6 -  Call SalShowWindow(PRYNATO) 
.head 6 -  Call SalHideWindow(VYDATY) 
.head 6 -  Call SalHideWindow(FIO2)
.head 6 -  Call SalHideWindow(pbFIO2)
.head 6 -  Call SalHideWindow(pbCLI2)
.head 6 -  Call SalShowWindow(FIO1)
.head 6 -  Call SalShowWindow(pbFIO1)
.head 6 -  Call SalShowWindow(pbCLI1)
.head 6 -  Call SalShowWindow(nalej)
.head 6 -  Call SalHideWindow(otrim)
.head 5 +  Else
.head 6 -  Set FIO2 = STRING_Null
.head 6 -  Call SalHideWindow(PRYNATO) 
.head 6 -  Call SalShowWindow(VYDATY) 
.head 6 -  Call SalShowWindow(FIO2)
.head 6 -  Call SalShowWindow(pbFIO2)
.head 6 -  Call SalShowWindow(pbCLI2)
.head 6 -  Call SalHideWindow(FIO1)
.head 6 -  Call SalHideWindow(pbFIO1)
.head 6 -  Call SalHideWindow(pbCLI1)
.head 6 -  Call SalHideWindow(nalej)
.head 6 -  Call SalShowWindow(otrim)
.head 5 -  Call f_DK()
.head 3 +  Function: f_DK
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Нормальный ордер по отношению к основному счету 
.head 5 +  If nPar = 0
.head 6 +  If (nPAP=1 and rbP) or (nPAP=2 and rbM)
.head 7 -  Set DKA = 'Д'
.head 7 -  Set DKB = 'K'
.head 7 -  Set nDk = 1
.head 6 +  Else
.head 7 -  Set DKA = 'K'
.head 7 -  Set DKB = 'Д'
.head 7 -  Set nDk = 0
.head 5 -  ! Перевернутый ордер по отношению к основному счету 
.head 5 +  Else
.head 6 +  If (nPAP=1 and rbP) or (nPAP=2 and rbM)
.head 7 -  Set DKB = 'Д'
.head 7 -  Set DKA = 'K'
.head 7 -  Set nDk = 0
.head 6 +  Else
.head 7 -  Set DKB = 'K'
.head 7 -  Set DKA = 'Д'
.head 7 -  Set nDk = 1
.head 3 +  Function: f_Sum
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Set SS = S1 + S2 + S3 + S4 + S5 
.head 5 -  Set SS = SalTblColumnSum(tbl1, SalTblQueryColumnID(tbl1.col3), 0, 0)
.head 5 -  ! Set ml1 = IifS ( SS = SI, SumPr(  SS *100, 'F', 'Грн' , "коп" ) , STRING_Null )
.head 5 -  Set ml1 = IifS(SS = SI, SumPr(SS*100, 'F', IifS(KV=980, 'Грн', sLCV), sUnit), STRING_Null)
.head 5 -  Call SalMapEnterToTab(TRUE)
.head 5 -  Return f_Gotov()
.head 3 +  Function: f_Kol
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Set KK = K1 + K2 + K3 + K4 + K5
.head 5 -  Set KK = SalTblColumnSum(tbl1, SalTblQueryColumnID(tbl1.col2), 0, 0)
.head 5 -  Call SalMapEnterToTab(TRUE)
.head 5 -  Return f_Gotov()
.head 3 +  Function: f_Gotov
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If (N1=STRING_Null and S1!=0) or
     (N2=STRING_Null and S2!=0) or
     (N3=STRING_Null and S3!=0) or
     (N4=STRING_Null and S4!=0) or
     (N5=STRING_Null and S5!=0)
.head 6 -  Call SalMessageBox('Призначення платежу повинно бути заповнене', 'Увага', MB_Ok)
.head 6 -  Return FALSE
.head 5 +  If SS = SI and KK = KI and SS > 0 and KK > 0
.head 6 +  If PIDSTAVA != STRING_Null and (ZMIST != STRING_Null or dfZm = STRING_Null) and
   IifS(rbP, FIO1, FIO2) != STRING_Null and NLSA != STRING_Null
.head 7 -  Call SalShowWindow(pbPayDoc)
.head 7 -  Return TRUE
.head 5 -  Call SalHideWindow(pbPayDoc)
.head 5 -  Return FALSE
.head 3 +  Function: f_Tochka
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 4 +  Static Variables
.head 5 -  String: sTmp
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sTmp=SalStrRepeatX(' ', 20)
.head 5 -  Call SalGetWindowText(hWnd, sTmp, 20)
.head 5 +  While SalStrScan(sTmp, sDecimal2) > 0
.head 6 -  Set sTmp = SalStrReplaceX(sTmp, SalStrScan(sTmp, sDecimal2), 1, sDecimal)
.head 5 -  Call SalFmtStrToField(hWnd, sTmp, TRUE)
.head 3 +  Function: f_Opl
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSum
.head 5 -  ! String: s1
.head 5 -  ! String: s2
.head 5 -  ! String: s3
.head 5 -  ! String: s4
.head 5 -  ! String: s5
.head 5 -  String: sTT
.head 5 -  Number: nVob
.head 5 -  String: sNlsD
.head 5 -  String: sNlsK
.head 5 -  String: sNmsD
.head 5 -  String: sNmsK
.head 5 -  String: sOkpoD
.head 5 -  String: sOkpoK
.head 5 -  !
.head 5 -  Boolean: bOpl
.head 5 -  Number: nI
.head 5 -  String: sTagN
.head 5 -  String: sTagK
.head 5 -  String: sTagS
.head 5 -  String: sKolvo
.head 5 -  String: sSumma
.head 4 +  Actions
.head 5 -  Set nRef = NUMBER_Null
.head 5 -  Set nSum = SS * 100
.head 5 -  Set sTT  = IifS(rbP, POP, POM)
.head 5 -  Set nVob = IifN(rbP, nVobP, nVobM)
.head 5 +  If nDk = 1
.head 6 -  Set sNlsD  = NLSA
.head 6 -  Set sNlsK  = NLSB
.head 6 -  Set sNmsD  = NMSA
.head 6 -  Set sNmsK  = NMSB
.head 6 -  Set sOkpoD = OKPOA
.head 6 -  Set sOkpoK = OKPOB
.head 5 +  Else
.head 6 -  Set sNlsD  = NLSB
.head 6 -  Set sNlsK  = NLSA
.head 6 -  Set sNmsD  = NMSB
.head 6 -  Set sNmsK  = NMSA
.head 6 -  Set sOkpoD = OKPOB
.head 6 -  Set sOkpoK = OKPOA
.head 5 -  !
.head 5 -  Call cDoc.SetDoc(nRef, sTT, 1, nVob, NUM_DOC, BankDate, BankDate, BankDate, BankDate, sNlsD, sNmsD, BankMfo, '', KV,
     nSum, sOkpoD, sNlsK, sNmsK, BankMfo, '', KV, nSum, sOkpoK, PIDSTAVA, '', GetIdOper(), '', NUMBER_Null, 0)
.head 5 +  If cDoc.oDoc()
.head 6 -  Set nRef = cDoc.m_nRef
.head 6 -  Set nI = 0
.head 6 -  Set bOpl = TRUE
.head 6 +  While nI < 34
.head 7 -  Call SalTblSetFocusRow(tbl1, nI)
.head 7 -  Call SalTblSetContext(tbl1, nI)
.head 7 -  ! Call Debug(tbl1.col1)
.head 7 -  Set nI = nI + 1
.head 7 +  If Len(SalStrTrimX(tbl1.col1))>0 and tbl1.col2 != NUMBER_Null and tbl1.col3 != NUMBER_Null and
   tbl1.col2 > 0 and tbl1.col3 > 0
.head 8 -  Set sTagN = 'PO_N' || IifS(nI<10, Str(nI), IifS(nI<20, Chr(nI+55), Chr(nI+56)))
.head 8 -  Set sTagK = 'PO_K' || IifS(nI<10, Str(nI), IifS(nI<20, Chr(nI+55), Chr(nI+56)))
.head 8 -  Set sTagS = 'PO_S' || IifS(nI<10, Str(nI), IifS(nI<20, Chr(nI+55), Chr(nI+56)))
.head 8 -  Set sKolvo = Str(tbl1.col2)
.head 8 -  Set sSumma = num_to_str_comma(tbl1.col3, 2)
.head 8 -  ! Call Debug('sTagN='||sTagN)
.head 8 -  ! Call Debug('sTagK='||sTagK)
.head 8 -  ! Call Debug('sTagS='||sTagS)
.head 8 -  ! Call Debug('sKolvo='||sKolvo)
.head 8 -  ! Call Debug('sSumma='||sSumma)
.head 8 -  Set bOpl = bOpl and
    SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,:sTagN,:tbl1.col1)") and
    SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,:sTagK,:sKolvo)") and
    SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,:sTagS,:sSumma)")   
.head 6 -  Call SalTblSetFocusRow(tbl1, 0)
.head 6 -  ! Set s1 = num_to_str_comma(S1, 2)
.head 6 -  ! Set s2 = num_to_str_comma(S2, 2)
.head 6 -  ! Set s3 = num_to_str_comma(S3, 2)
.head 6 -  ! Set s4 = num_to_str_comma(S4, 2)
.head 6 -  ! Set s5 = num_to_str_comma(S5, 2)
.head 6 +  ! If K1 = 0
.head 7 -  Set N1 = '---'
.head 6 +  ! If K2 = 0
.head 7 -  Set N2 = '---'
.head 6 +  ! If K3 = 0
.head 7 -  Set N3 = '---'
.head 6 +  ! If K4 = 0
.head 7 -  Set N4 = '---'
.head 6 +  ! If K5 = 0
.head 7 -  Set N5 = '---'
.head 6 -  ! SqlPrepareAndExecute( hSql(), "INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_N1',:N1 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_N2',:N2 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_N3',:N3 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_N4',:N4 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_N5',:N5 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_K1',:K1 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_K2',:K2 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_K3',:K3 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_K4',:K4 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_K5',:K5 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_KK',:KK )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_S1',:s1 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_S2',:s2 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_S3',:s3)" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_S4',:s4 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_S5',:s5 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'FIO1',:FIO1 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'FIO2',:FIO2 )" )
and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_ZM',:ZMIST )" )
.head 6 +  If bOpl
.head 7 +  If SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'PO_KK',:KK)") and
   SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'FIO1',:FIO1)") and
   SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'FIO2',:FIO2)") and 
   SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:nRef,'PO_ZM',:ZMIST)")
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SaveFInfoToLog('Ввод док Ref' || SalNumberToStrX(nRef, 0) || ': ' || NLSA || '(' || Str(KV) || ') ' ||
     SalNumberToStrX(SS, 0) || ' -> ' || NLSB || '(' || Str(KV) || ') ' || SalNumberToStrX(SS, 0) || '[' || NMSB
     || '],[' || PIDSTAVA || '] ' || GetIdOper())
.head 8 -  Call SalShowWindow(nRef)
.head 8 -  Call SalSendMsg(pb_F5, SAM_Click, 0, 0)
.head 8 -  !
.head 8 -  Call SalShowWindow(pb_F5)
.head 8 -  Call SalShowWindow(pbSave)
.head 8 -  Call SalShowWindow(pb_New)
.head 8 -  !
.head 8 -  Call SalHideWindow(pbPayDoc)
.head 8 -  Return TRUE
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Return FALSE
.head 3 +  Function: f_Resume
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalHideWindow(pbHelp2)
.head 5 -  Set df46 = ''
.head 5 +  If SqlPrepareAndExecute(hSql(), sSql)
 and not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call Debug ("Не описані операції " || POP || ',' || POM)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 +  Function: num_to_str_comma
.head 4 -  Description: Функция преобразования числа в строку. В качестве разделителя использует запятую!
.head 4 +  Returns
.head 5 -  String: Out_Num
.head 4 +  Parameters
.head 5 -  Number: Inp_Num
.head 5 -  Number: Aft_Pnt
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: tmp
.head 4 +  Actions
.head 5 +  If Inp_Num = NUMBER_Null
.head 6 -  Set Inp_Num = 0
.head 5 -  Set tmp = SalNumberToStrX(Inp_Num, Aft_Pnt)
.head 5 -  Return SalStrLeftX(tmp, SalStrLength(tmp)-(Aft_Pnt+1)) || ',' || SalStrRightX(tmp, Aft_Pnt)
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: POP  !! прибутковий
.head 3 -  String: POM  !! видатковий
.head 2 +  Window Variables
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  Number: nPAP
.head 3 -  Number: nDk
.head 3 -  Number: nVobP
.head 3 -  Number: nVobM
.head 3 -  String: sTmp
.head 3 -  String: sSql
.head 3 -  String: s980
.head 3 -  Number: n980
.head 3 -  String: sDecimal2  ! симв десятичной точки alt
.head 3 -  String: sDecimal   ! симв десятичной точки
.head 3 -  String: sLCV
.head 3 -  String: sUnit
.head 3 -  Number: nTmp
.head 3 -  String: fNLS
.head 3 -  String: sPOP_Nlsb
.head 3 -  Boolean: NBUBANK
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sDecimal = SalStrMidX(SalNumberToStrX(1.1, 1), 1, 1)
.head 4 -  Call SalHideWindow(pbHelp2)
.head 4 -  Call SalDisableWindow(cb1)
.head 4 -  Set sDecimal2 = IifS(sDecimal='.', ',', '.')
.head 4 -  Set BankName = GetBankName()
.head 4 -  Set BankMfo  = GetBankMfo()
.head 4 -  Set BankDate = GetBankDate()
.head 4 -  Set n980     = GetBaseVal()
.head 4 +  If SqlPrepareAndExecute(hSql(), "SELECT nlsB INTO :fNLS FROM tts WHERE tt=:POP") and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If SalStrLeftX(fNLS, 1)='#'
.head 6 +  If not (SqlPrepareAndExecute(hSql(), 
        "SELECT substr(" || SalStrRightX(fNLS, SalStrLength(fNLS)-1) || ",1,15) INTO :sPOP_Nlsb FROM DUAL")
    and SqlFetchNext(hSql(), nFetchRes))
.head 7 -  Call Debug ("2) Не описані операції " || POP || ',' || POM)
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 5 +  Else
.head 6 -  Set sPOP_Nlsb = fNLS
.head 5 -  Set NLSB = sPOP_Nlsb
.head 4 +  Else
.head 5 -  Call Debug ("1) Не описані операції " || POP || ',' || POM)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Set sSql = 
"SELECT substr(ap.nms,1,38), vp.vob, vm.vob, c.OKPO, v.name, v.lcv, v.unit 
   INTO :NMSB, :nVobP, :nVobM, :OKPOB, :s980, :sLCV, :sUnit
   FROM tts tP, tts tM, TTS_VOB vp, TTS_VOB vm, accounts ap, customer c, tabval v
  WHERE tp.tt = :POP and tp.tt = vp.tt
    and tm.tt = :POM and tm.tt = vm.tt
    and ap.nls = :NLSB and ap.kv=:n980
    and ap.rnk = c.rnk
    and ap.kv = v.kv"
.head 4 +  If SqlPrepareAndExecute(hSql(), sSql) and not SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call Debug ("3) Не описані операції " || POP || ',' || POM)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Set KV = n980
.head 4 -  Set sKV = s980
.head 4 -  Set dfZm = 'Зміст операції'
.head 4 -  Set PRYNATO = 'Прийнято від'
.head 4 -  Set VYDATY = 'Видати'
.head 4 -  Set rbP = TRUE
.head 4 -  Set NI = 'Усього'
.head 4 -  Call f_Clear2(rbP)
.head 4 -  Call f_Clear1(rbP)
.head 4 -  Call f_Clear0(rbP)
.head 4 -  !
.head 4 -  Call SalHideWindow(pb_New)
.head 4 -  Call SalHideWindow(pbPayDoc)
.head 4 -  Call SalHideWindow(pb_F5)
.head 4 -  Call SalHideWindow(pbSave)
.head 4 -  Set NBUBANK = GetGlobalOption('NBUBANK')='1'
.head 4 +  If not NBUBANK
.head 5 -  Call SalHideWindow(ZMIST)
.head 5 -  Call SalHideWindow(dfZm)
.head 5 -  Set dfZm = STRING_Null
.head 5 -  Call SalHideWindow(pbHelp3)
.head 5 -  Set pbSave.strTip = 'Зберегти підставу операції'
.head 4 +  Else
.head 5 -  ! Call SalHideWindow(cb1)
.head 5 -  Set pbSave.strTip = 'Зберегти зміст операції і підставу'
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 1 +  Table Window: zLom
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Формування відправок до Державної скарбниці
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   3.075"
.head 4 -  Top:    1.76"
.head 4 -  Width:  13.067"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.786"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.033"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Вибрати дані за період'
.head 6 +  On SAM_Click
.head 7 +  If SalModalDialog(VDAT_POS, hWndForm, BankDate, dDat)
.head 8 -  Set DAT_V_POS = dDat
.head 8 -  Call NASELENIE()
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 8771
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  8.967"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  8.967"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.317"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.833"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.533"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Друк таблиці вибраних документів'
.head 4 -  Line
.head 5 -  Resource Id: 8772
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  8.3"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  8.3"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.533"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 8773
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: DAT1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.317"
.head 7 -  Top:    0.083"
.head 7 -  Width:  1.317"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Початок періоду для вибору даних')
.head 6 +  On SAM_KillFocus
.head 7 +  If bL
.head 8 -  Call f_Exp()
.head 8 -  Call SalTblReset(hWndForm)
.head 4 +  Data Field: DAT2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.667"
.head 7 -  Top:    0.083"
.head 7 -  Width:  1.317"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Кінець періоду для вибору даних')
.head 6 +  On SAM_KillFocus
.head 7 +  If bL
.head 8 -  Call f_Exp()
.head 8 -  Call SalTblReset(hWndForm)
.head 4 +  Data Field: dPos
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.333"
.head 7 -  Top:    0.405"
.head 7 -  Width:  2.65"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.31"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, '№ та ДАТА посилки')
.head 4 +  Pushbutton: pb_Pos
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.033"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Зформувати посилку'
.head 6 +  On SAM_Click
.head 7 -  Call SalDisableWindow(zLom.pb_Doc)
.head 7 -  Call zLom.f_Pos()
.head 4 +  Pushbutton: pb_Doc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.533"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Doc.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Опис цінностей сформованої посилки'
.head 6 +  On SAM_Click
.head 7 -  ! вызов функции печати
.head 7 -  ! Set POS = zLom.dPos
.head 7 -  ! Set sSqlPrint = "
    SELECT decode(o.tt,'LO2','Скупка','LO3','Скупка','Оцінка'),m1.NAME,substr(m.MET,-3),o.REF,o.VDAT,w.IZD,w.EDN,
           w.ZAG,w.ZNJ,w.LIG,w.CEN,(o.S+kor.s)/100,
           substr(p.value,1,9)||substr(F_DAT_LIT(to_date(substr(p.value,-10),'dd-mm-yyyy')),1,40),
           substr(LOM.ISP_VALUE('MVO1'),1,30),substr(LOM.ISP_VALUE('MVO2'),1,30),
           substr(LOM.ISP_VALUE('MVO3'),1,30),substr(LOM.ISP_VALUE('EXP1'),1,30)
    INTO   :PR,:NAME1,:MET,:REF,:VDAT,:IZD,:EDN,:ZAG,:ZNJ,:LIG,:CEN,:S,:POS,:MVO1,:MVO2,:MVO3,:EXP1
    FROM   (select ref,max(decode(tag,'L_IZD',value,' '))                           IZD,
                       max(decode(tag,'L_MET',value,' '))                           MET,
                       max(decode(tag,'L_EDN',to_number(replace(value,',','.')),0)) EDN,
                       max(decode(tag,'L_ZAG',to_number(replace(value,',','.')),0)) ZAG,
                       max(decode(tag,'L_ZNJ',to_number(replace(value,',','.')),0)) ZNJ,
                       max(decode(tag,'L_LIG',to_number(replace(value,',','.')),0)) LIG,
                       max(decode(tag,'L_CEN',value,' '))                           CEN
            from   operw
            group by ref) w,
            OPER o, OPERW p, LOM_MET m, LOM_MET1 m1,
            (select o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1) S,
                    to_number(w.value) ref
             from   oper o, operw w
             where  o.tt='LO5' and o.sos=5 and o.ref=w.ref and w.tag='R_LO2'
             UNION ALL
             (select 0,ref
              from   oper
              where  tt in ('LO2','LO3','LO9') and sos=5
              minus
              select 0,to_number(w.value)
              from   oper o, operw w
              where  w.tag='R_LO2' and o.ref=w.ref and o.sos=5 and o.tt='LO5')) kor
    WHERE  p.ref=o.ref and p.tag='L_POS' and p.value=:zLom.dPos and o.ref=w.ref and m.name=w.MET and
           m.MET1=m1.MET1 and o.ref=kor.ref
    ORDER BY 1,2,3,4"
.head 7 -  ! Set sSqlPrint = "
    SELECT decode(o.tt,'LO2','Скупка','LO3','Скупка','Оцінка'),m1.NAME,substr(m.MET,-3),o.REF,o.VDAT,w.IZD,w.EDN,
           w.ZAG,w.ZNJ,w.LIG,w.CEN,(o.S+kor.s)/100,
           substr(p.L_POS,1,9)||trim(substr(F_DAT_LIT(to_date(substr(p.L_POS,-10),'dd-mm-yyyy')),1,40)),
           substr(LOM.ISP_VALUE('MVO1'),1,30),substr(LOM.ISP_VALUE('MVO2'),1,30),
           substr(LOM.ISP_VALUE('MVO3'),1,30),substr(LOM.ISP_VALUE('EXP1'),1,30)
    INTO   :PR,:NAME1,:MET,:REF,:VDAT,:IZD,:EDN,:ZAG,:ZNJ,:LIG,:CEN,:S,:POS,:MVO1,:MVO2,:MVO3,:EXP1
    FROM   (select ref,L_IZD IZD,L_MET MET,L_EDN EDN,L_ZAG ZAG,L_ZNJ ZNJ,L_LIG LIG,L_CEN CEN
            from   lom_w) w, OPER o, LOM_W p, LOM_MET m, LOM_MET1 m1,
           (select o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1) S,to_number(w.value) ref
            from   oper o, operw w
            where  o.tt='LO5' and o.sos=5 and o.ref=w.ref and w.tag='R_LO2'
            UNION ALL
            (select 0,ref
             from   oper
             where  tt in ('LO2','LO3','LO9') and sos=5
             MINUS
             select 0,to_number(w.value)
             from   oper o, operw w
             where  w.tag='R_LO2' and o.ref=w.ref and o.sos=5 and o.tt='LO5')) kor
    WHERE  p.ref=o.ref and p.L_POS=:zLom.dPos and o.ref=w.ref and m.name=w.MET and m.MET1=m1.MET1 and o.ref=kor.ref
    ORDER BY 1,2,3,4"
.head 7 -  ! Set sSqlPrint = "
    SELECT decode(o.tt,'LO2','Скупка','LO3','Скупка','Оцінка'),m1.NAME,substr(m.MET,-3),o.REF,o.VDAT,w.IZD,w.EDN,
           w.ZAG,w.ZNJ,w.LIG,w.CEN,(o.S+kor.s)/100,
           substr(p.L_POS,1,9)||trim(substr(F_DAT_LIT(to_date(substr(p.L_POS,-10),'dd-mm-yyyy')),1,40)),
           substr(LOM.ISP_VALUE('MVO1'),1,30),substr(LOM.ISP_VALUE('MVO2'),1,30),
           substr(LOM.ISP_VALUE('MVO3'),1,30),substr(LOM.ISP_VALUE('EXP1'),1,30)
    INTO   :PR,:NAME1,:MET,:REF,:VDAT,:IZD,:EDN,:ZAG,:ZNJ,:LIG,:CEN,:S,:POS,:MVO1,:MVO2,:MVO3,:EXP1
    FROM   (select ref,L_IZD IZD,L_MET MET,L_EDN EDN,L_ZAG ZAG,L_ZNJ ZNJ,L_LIG LIG,L_CEN CEN
            from   lom_w) w, OPER o, LOM_W p, LOM_MET m, LOM_MET1 m1,
           (select o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1) S,k.reflom ref
            from   oper o, lomkor k
            where  o.tt='LO5' and o.sos=5 and o.ref=k.refkor
            UNION ALL
            (select 0,ref
             from   oper
             where  tt in ('LO2','LO3','LO9') and sos=5
             MINUS
             select 0,k.reflom
             from   oper o, lom_kor k
             where  o.ref=k.refkor and o.sos=5 and o.tt='LO5')) kor
    WHERE  p.ref=o.ref and p.L_POS=:zLom.dPos and o.ref=w.ref and m.name=w.MET and m.MET1=m1.MET1 and o.ref=kor.ref
    ORDER BY 1,2,3,4"
.head 7 -  Set sSqlPrint = "
    SELECT decode(o.tt,'LO2','Скупка','LO3','Скупка','Оцінка'),m1.NAME,substr(m.MET,-3),o.REF,o.VDAT,w.IZD,w.EDN,
           w.ZAG,w.ZNJ,w.LIG,w.CEN,(o.S2+kor.s)/100,
           substr(p.L_POS,1,9)||trim(substr(F_DAT_LIT(to_date(substr(p.L_POS,-10),'dd-mm-yyyy')),1,40)),
           substr(LOM.ISP_VALUE('MVO1'),1,30),substr(LOM.ISP_VALUE('MVO2'),1,30),
           substr(LOM.ISP_VALUE('MVO3'),1,30),substr(LOM.ISP_VALUE('EXP1'),1,30)
    INTO   :PR,:NAME1,:MET,:REF,:VDAT,:IZD,:EDN,:ZAG,:ZNJ,:LIG,:CEN,:S,:POS,:MVO1,:MVO2,:MVO3,:EXP1
    FROM   (select ref,L_IZD IZD,L_MET MET,L_EDN EDN,L_ZAG ZAG,L_ZNJ ZNJ,L_LIG LIG,L_CEN CEN
            from   lom_w) w, OPER o, LOM_W p, LOM_MET m, LOM_MET1 m1,
           (select o.S2*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1) S,k.reflom ref
            from   oper o, lomkor k
            where  o.tt='LO5' and o.sos=5 and o.ref=k.refkor
            UNION ALL
            (select 0,ref
             from   oper
             where  tt in ('LO2','LO3','LO9') and sos=5
             MINUS
             select 0,k.reflom
             from   oper o, lom_kor k
             where  o.ref=k.refkor and o.sos=5 and o.tt='LO5')) kor
    WHERE  p.ref=o.ref and p.L_POS=:zLom.dPos and o.ref=w.ref and m.name=w.MET and m.MET1=m1.MET1 and o.ref=kor.ref
    ORDER BY 1,2,3,4"
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set strFa = GetPrnDir() || "\\D9_" || Left(zLom.dPos, 4) || ".txt"
.head 7 -  Set strREP = 'POS,PR,NAME1,MET,REF,VDAT,IZD,EDN,ZAG,ZNJ,LIG,CEN,S,MVO1,MVO2,MVO3,EXP1'
.head 7 -  Set strCEN = strREP
.head 7 -  ! -------прочитать и запомнить предыдущие параметры принтера 
.head 7 -  Call SalPrtGetDefault(sDeviceDef, sDriverDef, sPortDef)
.head 7 -  ! -------Установка этого принтера как default нужна лишь для того чтоб
! -------при формировании текстового отчета - были нормальные параметры вывода
.head 7 -  Call SalPrtSetDefault('Generic / Text Only', 'WINSPOOL', 'FILE:')
.head 7 -  Call SalReportPrintToFile(hWndForm, GetTemplateDir() || "\\LOM9.qrp", strFa, strCEN, strREP, 1, RPT_PrintAll, 1, 1,
     FALSE, nInd)
.head 7 -  ! -------восстановить принтер
.head 7 -  Call SalPrtSetDefault(sDeviceDef, sDriverDef, sPortDef)
.head 7 -  !
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 +  Radio Button: rb2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Скуплено (брухт)
.head 5 -  Window Location and Size
.head 6 -  Left:   6.117"
.head 6 -  Top:    0.095"
.head 6 -  Width:  2.967"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.155"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  ! If rb2
.head 8 -  Call NASELENIE()
.head 7 +  If bL
.head 8 -  Call f_Exp()
.head 8 -  Call SalTblReset(hWndForm)
.head 4 +  Radio Button: rb3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Скуплено (зливки)
.head 5 -  Window Location and Size
.head 6 -  Left:   6.117"
.head 6 -  Top:    0.286"
.head 6 -  Width:  2.967"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.155"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  ! If rb2
.head 8 -  Call NASELENIE()
.head 7 +  If bL
.head 8 -  Call f_Exp()
.head 8 -  Call SalTblReset(hWndForm)
.head 4 +  Radio Button: rb9
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Для оцінки
.head 5 -  Window Location and Size
.head 6 -  Left:   6.117"
.head 6 -  Top:    0.488"
.head 6 -  Width:  2.967"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.15"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  ! If rb9
.head 8 -  Call NASELENIE()
.head 7 +  If bL
.head 8 -  Call f_Exp()
.head 8 -  Call SalTblReset(hWndForm)
.head 4 +  Pushbutton: pbUnpack
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.033"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\UNFORM.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Розформувати посилку'
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(Unform, zLom)
.head 4 +  ! Combo Box: cmbExpert
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.65"
.head 6 -  Top:    0.95"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.869"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? Yes
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? Yes
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 5 -  List Initialization 
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Call SalListPopulate(hWndItem, hSql(), T("
     select lpad(to_char(userid),6)||' '||fio
     from   lom_isp
     where  cod in ('EXP1','EXP2')
     order by userid"))
.head 7 -  Set nEntries = SalListQueryCount(hWndItem) 
.head 7 -  Set nI = 0
.head 7 +  While nI < nEntries
.head 8 -  Call SalListSetSelect(hWndItem, nI)
.head 8 +  If Val(Left(cmbExpert, 6)) = GetUserId()
.head 9 -  Break 
.head 8 -  Set nI = nI + 1
.head 7 +  If nI = nEntries
.head 8 -  Call SalListSetSelect(hWndItem, 0)
.head 4 +  ! Data Field: df31
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.667"
.head 7 -  Top:    1.22"
.head 7 -  Width:  4.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.226"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 4 +  Combo Box: cmbExpert
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.283"
.head 6 -  Top:    0.31"
.head 6 -  Width:  3.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.821"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? Yes
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? Yes
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If bL
.head 8 +  If rb2
.head 9 -  ! Call SalListPopulate(hWndItem, hSql(), T("
     select distinct
            w.l_exp
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt in ('LO2','LO3') and w.grp in ('1','5') and
            o.vdat between :DAT1 and :DAT2 and o.sos=5
     order by 1"))
.head 9 +  If bMULTI
.head 10 -  Call SalListPopulate(hWndItem, hSql(), T("
     select distinct
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt in ('LO2','LO3') and w.grp in ('1','5') and
            o.vdat between :DAT1 and :DAT2 and o.branch=sys_context('bars_context','user_branch')
     order by 1"))
.head 9 +  Else
.head 10 -  Call SalListPopulate(hWndItem, hSql(), T("
     select distinct
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt in ('LO2','LO3') and w.grp in ('1','5') and
            o.vdat between :DAT1 and :DAT2
     order by 1"))
.head 8 +  Else If rb3
.head 9 -  ! Call SalListPopulate(hWndItem, hSql(), T("
     select distinct
            w.l_exp
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt='LO2' and w.grp in ('2','3') and
            o.vdat between :DAT1 and :DAT2 and o.sos=5
     order by 1"))
.head 9 +  If bMULTI
.head 10 -  Call SalListPopulate(hWndItem, hSql(), T("
     select distinct
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt='LO2' and w.grp in ('2','3') and
            o.vdat between :DAT1 and :DAT2 and o.branch=sys_context('bars_context','user_branch')
     order by 1"))
.head 9 +  Else
.head 10 -  Call SalListPopulate(hWndItem, hSql(), T("
     select distinct
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt='LO2' and w.grp in ('2','3') and
            o.vdat between :DAT1 and :DAT2
     order by 1"))
.head 8 +  Else !! If rb9
.head 9 -  ! Call SalListPopulate(hWndItem, hSql(), T("
     select distinct
            w.l_exp
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt='LO9' and o.vdat between :DAT1 and :DAT2 and o.sos=5
     order by 1"))
.head 9 +  If bMULTI
.head 10 -  Call SalListPopulate(hWndItem, hSql(), T("
     select distinct
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt='LO9' and o.vdat between :DAT1 and :DAT2 and
            o.branch=sys_context('bars_context','user_branch')
     order by 1"))
.head 9 +  Else
.head 10 -  Call SalListPopulate(hWndItem, hSql(), T("
     select distinct
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt='LO9' and o.vdat between :DAT1 and :DAT2
     order by 1"))
.head 8 -  Set nEntries = SalListQueryCount(hWndItem) 
.head 8 -  Set nI = 0
.head 8 +  While nI < nEntries
.head 9 -  Call SalListSetSelect(hWndItem, nI)
.head 9 +  If Val(Left(cmbExpert, 6)) = GetUserId()
.head 10 -  Break
.head 9 -  Set nI = nI + 1
.head 8 +  If nI = nEntries
.head 9 -  Call SalListSetSelect(hWndItem, 0)
.head 4 +  Data Field: df31
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.283"
.head 7 -  Top:    0.071"
.head 7 -  Width:  3.55"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.19"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set df31 = 'Експерт'
.head 2 +  Contents
.head 3 +  ! Column: tPR 
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Опер.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: tMET
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Метал, проба
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: tREF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № квит
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: tVDAT 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: tIZD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва вибору
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: tEDN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Шт.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: tZAG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Заг.вага
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: tZNJ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Знижка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: tLIG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ліг.вага
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: tCEN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ціна
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: tS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  ! Function: NASELENIE
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If DAT_V_POS = DATETIME_Null
.head 6 -  Call SalMessageBox('Не заповнено дату відправки посилки!', 'Увага!', MB_Ok)
.head 6 -  Return FALSE
.head 5 +  If DAT1 = DATETIME_Null or DAT2 = DATETIME_Null
.head 6 -  Call SalMessageBox('Не заповнено період дат!', 'Увага!', MB_Ok)
.head 6 -  Return FALSE
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 5 -  Set zLom.strSqlPopulate =
"SELECT OPER.REF, OPER.VDAT, w.IZD, w.MET, w.EDN, w.ZAG, w.ZNJ, 
        w.LIG, w.CEN, (OPER.S+KOR.s)/100 S  
 INTO  :zLom.tREF, :zLom.tVDAT,
       :zLom.tIZD, :zLom.tMET, :zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,:zLom.tCEN,
       :zLom.tS
 FROM oper OPER , 
     (select ref, 
             max(decode(tag,'L_IZD',value, ' ')) IZD,
             max(decode(tag,'L_MET',value, ' ')) MET,
             max(decode(tag,'L_EDN',to_number(replace(value,',','.')),0)) EDN,
             max(decode(tag,'L_ZAG',to_number(replace(value,',','.')),0)) ZAG,
             max(decode(tag,'L_ZNJ',to_number(replace(value,',','.')),0)) ZNJ,
             max(decode(tag,'L_LIG',to_number(replace(value,',','.')),0)) LIG,
             max(decode(tag,'L_CEN',to_number(replace(value,',','.')),0)) CEN
     from operw 
     where ref not in (select ref from operw where tag='L_POS') 
     group by ref ) w,
	 (select o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1) S,
			       to_number(w.value) ref
				   from oper o,operw w
				   where o.tt='LO5' and o.sos=5 and o.ref=w.ref and
            	   w.tag='R_LO2'
                   UNION ALL
                   select 0,ref from oper  where tt in ('LO2','LO3','LO9') and  sos=5 and ref not in (select w.value from oper o,operw w
				                                                                             where w.tag='R_LO2' and o.ref=w.ref
											 and o.sos=5 and o.tt='LO5')) kor
 WHERE OPER.ref=w.ref and  OPER.sos=5 and OPER.REF=KOR.REF AND
       OPER.vdat >= :zLom.DAT1 and OPER.vdat <= :zLom.DAT2 and 
       OPER.tt in "|| IifS ( rb2, "('LO2','LO3')", "('LO9')" ) || "
 ORDER BY w.MET  "
.head 5 -  Set zLom.nKol = 0
.head 5 +  If SalTblPopulate(hWndForm, hSql(), zLom.strSqlPopulate, TBL_FillAll) 
and zLom.nKol > 0
.head 6 +  If SqlPrepareAndExecute( hSql(),
  "SELECT nvl(max(to_number(substr(valUe,1,4))),0)+1 
   INTO :zLom.nPos FROM operw  
               WHERE tag='L_POS' and 
       to_date(substr(value,-10),'dd/mm/yyyy')>to_date('01/01/'||substr(:zLom.sBankDay,-4),'dd/mm/yyyy') ")
and SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Call SalDateToStr( zLom.DAT_V_POS,zLom.DAT_VID)
.head 7 -  Set zLom.DAT_VID=SalStrMidX ( zLom.DAT_VID, 8, 2 )||'/'||SalStrMidX ( zLom.DAT_VID, 5, 2 )||'/'||SalStrMidX ( zLom.DAT_VID, 0, 4 )
.head 7 -  Set zLom.dPos = Subs( Str( 10000 + zLom.nPos) , 2, 4 ) || ' від '|| zLom.DAT_VID
.head 7 -  Call SalEnableWindow( pb_Pos )
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  Else 
.head 6 -  Call SalDisableWindow( pb_Pos )
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If DAT_V_POS = DATETIME_Null
.head 6 -  Call SalMessageBox('Не заповнено дату відправки посилки!', 'Увага!', MB_Ok)
.head 6 -  Return FALSE
.head 5 +  If DAT1 = DATETIME_Null or DAT2 = DATETIME_Null
.head 6 -  Call SalMessageBox('Не заповнено період дат!', 'Увага!', MB_Ok)
.head 6 -  Return FALSE
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 5 -  ! Set zLom.strSqlPopulate =
"select oper.ref, oper.VDAT, oper.s,
        (select value from operw where ref = oper.ref and tag = 'L_IZD') IZD,
        (select value from operw where ref = oper.ref and tag = 'L_MET') MET,
        (select to_number(replace(value,',','.')) from operw where ref = oper.ref and tag = 'L_EDN') EDN,
        (select to_number(replace(value,',','.')) from operw where ref = oper.ref and tag = 'L_ZAG') ZAG,
        (select to_number(replace(value,',','.')) from operw where ref = oper.ref and tag = 'L_ZNJ') ZNJ,
        (select to_number(replace(value,',','.')) from operw where ref = oper.ref and tag = 'L_LIG') LIG,
        (select to_number(replace(value,',','.')) from operw where ref = oper.ref and tag = 'L_CEN') CEN
   into :zLom.tREF, :zLom.tVDAT, :zLom.tS,
        :zLom.tIZD, :zLom.tMET, :zLom.tEDN, :zLom.tZAG, :zLom.tZNJ, :zLom.tLIG, :zLom.tCEN
   from ( select l.ref, l.vdat, l.s/100 s
            from oper l
           where l.tt = " || IifS ( rb2, "'LO2'", "'LO9'" ) || "
             and l.sos = 5
             and l.vdat >= :DAT1 and l.vdat <= :DAT2
             and not exists (select 1 from operw w where w.tag='R_LO2' and w.value = l.ref)
           union all
          SELECT l.REF, l.VDAT,
                 (l.S + (o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from oper l, oper o, operw w
           where l.tt = " || IifS ( rb2, "'LO2'", "'LO9'" ) || "
             and l.sos = 5
             and l.vdat >= :DAT1 and l.vdat <= :DAT2
             and o.tt = 'LO5' and o.sos = 5 and o.ref = w.ref and w.tag = 'R_LO2'
             and l.ref = w.value
        ) oper
  where not exists (select 1 from operw where ref = oper.ref and tag = 'L_POS')
  order by 5"
.head 5 +  If rb2
.head 6 -  ! Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s/100 s
            from   oper l, lom_w r
            where  l.tt in ('LO2', 'LO3') and l.sos=5 and r.ref=l.ref and r.GRP in ('1','5') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and not exists (select 1 from operw w where w.tag='R_LO2' and w.value=to_char(l.ref))
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_w m, operw w
            where  l.tt in ('LO2', 'LO3') and l.sos=5 and m.ref=l.ref and m.GRP in ('1','5') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and o.ref=w.ref and w.tag='R_LO2' and
                   to_char(l.ref)=w.value) oper,
           lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 6 -  ! Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s/100 s
            from   oper l, lom_w r
            where  l.tt in ('LO2', 'LO3') and l.sos=5 and r.ref=l.ref and r.GRP in ('1','5') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and not exists (select 1 from lom_kor k where k.reflom=l.ref) and
                   substr(r.l_exp,1,6)||replace(replace(substr(r.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_w m, lom_kor k
            where  l.tt in ('LO2', 'LO3') and l.sos=5 and m.ref=l.ref and m.GRP in ('1','5') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and l.ref=k.reflom and
                   substr(m.l_exp,1,6)||replace(replace(substr(m.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) oper,
           lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 6 +  If bL
.head 7 +  If SalIsWindowEnabled(cmbExpert)
.head 8 -  Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s2/100 s
            from   oper l, lom_w r
            where  l.tt in ('LO2', 'LO3') and l.sos=5 and r.ref=l.ref and r.GRP in ('1','5') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and not exists (select 1 from lom_kor k where k.reflom=l.ref) and
                   substr(r.l_exp,1,6)||replace(replace(substr(r.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S2+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_w m, lom_kor k
            where  l.tt in ('LO2', 'LO3') and l.sos=5 and m.ref=l.ref and m.GRP in ('1','5') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and l.ref=k.reflom and
                   substr(m.l_exp,1,6)||replace(replace(substr(m.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) oper,
           lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 7 +  Else
.head 8 -  Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s2/100 s
            from   oper l, lom_w r
            where  l.tt in ('LO2', 'LO3') and l.sos=5 and r.ref=l.ref and r.GRP in ('1','5') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and not exists (select 1 from lom_kor k where k.reflom=l.ref)
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S2+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_w m, lom_kor k
            where  l.tt in ('LO2', 'LO3') and l.sos=5 and m.ref=l.ref and m.GRP in ('1','5') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and l.ref=k.reflom) oper,
           lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 6 +  Else
.head 7 -  Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s2/100 s
            from   oper l, lom_w r
            where  l.tt in ('LO2', 'LO3') and l.sos=5 and r.ref=l.ref and r.GRP in ('1','5') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and not exists (select 1 from lom_kor k where k.reflom=l.ref)
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S2+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_w m, lom_kor k
            where  l.tt in ('LO2', 'LO3') and l.sos=5 and m.ref=l.ref and m.GRP in ('1','5') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and l.ref=k.reflom) oper, lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 5 +  Else If rb3
.head 6 -  ! Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s/100 s
            from   oper l, lom_w r
            where  l.tt='LO2' and l.sos=5 and r.ref=l.ref and r.GRP in ('2','3') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and not exists (select 1 from operw w where w.tag='R_LO2' and w.value=to_char(l.ref))
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_w m, operw w
            where  l.tt='LO2' and l.sos=5 and m.ref=l.ref and m.GRP in ('2','3') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and o.ref=w.ref and w.tag='R_LO2' and
                   to_char(l.ref)=w.value) oper,
           lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 6 -  ! Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s/100 s
            from   oper l, lom_w r
            where  l.tt='LO2' and l.sos=5 and r.ref=l.ref and r.GRP in ('2','3') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and not exists (select 1 from lom_kor k where k.reflom=l.ref) and
                   substr(r.l_exp,1,6)||replace(replace(substr(r.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_w m, lom_kor k
            where  l.tt='LO2' and l.sos=5 and m.ref=l.ref and m.GRP in ('2','3') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and l.ref=k.reflom and
                   substr(m.l_exp,1,6)||replace(replace(substr(m.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) oper,
           lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 6 +  If bL
.head 7 +  If SalIsWindowEnabled(cmbExpert)		
.head 8 -  Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s2/100 s
            from   oper l, lom_w r
            where  l.tt='LO2' and l.sos=5 and r.ref=l.ref and r.GRP in ('2','3') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and not exists (select 1 from lom_kor k where k.reflom=l.ref) and
                   substr(r.l_exp,1,6)||replace(replace(substr(r.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S2+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_w m, lom_kor k
            where  l.tt='LO2' and l.sos=5 and m.ref=l.ref and m.GRP in ('2','3') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and l.ref=k.reflom and
                   substr(m.l_exp,1,6)||replace(replace(substr(m.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) oper,
           lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 7 +  Else
.head 8 -  Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s2/100 s
            from   oper l, lom_w r
            where  l.tt='LO2' and l.sos=5 and r.ref=l.ref and r.GRP in ('2','3') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and not exists (select 1 from lom_kor k where k.reflom=l.ref)
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S2+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_w m, lom_kor k
            where  l.tt='LO2' and l.sos=5 and m.ref=l.ref and m.GRP in ('2','3') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and l.ref=k.reflom) oper,
           lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 6 +  Else
.head 7 -  Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s2/100 s
            from   oper l, lom_w r
            where  l.tt='LO2' and l.sos=5 and r.ref=l.ref and r.GRP in ('2','3') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and not exists (select 1 from lom_kor k where k.reflom=l.ref)
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S2+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_w m, lom_kor k
            where  l.tt='LO2' and l.sos=5 and m.ref=l.ref and m.GRP in ('2','3') and l.vdat>=:DAT1 and
                   l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and l.ref=k.reflom) oper, lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 5 +  Else !! rb9
.head 6 -  ! Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s/100 s
            from   oper l
            where  l.tt='LO9' and l.sos=5 and l.vdat>=:DAT1 and l.vdat<=:DAT2 and
                   not exists (select 1 from operw w where w.tag='R_LO2' and w.value=to_char(l.ref))
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, operw w
            where  l.tt='LO9' and l.sos=5 and l.vdat>=:DAT1 and l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and
                   o.ref=w.ref and w.tag='R_LO2' and to_char(l.ref)=w.value) oper, lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 6 -  ! Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s/100 s
            from   oper l, lom_w r
            where  l.tt='LO9' and l.sos=5 and l.vdat>=:DAT1 and l.vdat<=:DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref) and r.ref=l.ref and
                   substr(r.l_exp,1,6)||replace(replace(substr(r.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_kor k, lom_w m
            where  l.tt='LO9' and l.sos=5 and l.vdat>=:DAT1 and l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and
                   o.ref=k.refkor and l.ref=k.reflom and m.ref=l.ref and
                   substr(m.l_exp,1,6)||replace(replace(substr(m.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) oper,
           lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 6 +  If bL
.head 7 +  If SalIsWindowEnabled(cmbExpert)
.head 8 -  Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s2/100 s
            from   oper l, lom_w r
            where  l.tt='LO9' and l.sos=5 and l.vdat>=:DAT1 and l.vdat<=:DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref) and r.ref=l.ref and
                   substr(r.l_exp,1,6)||replace(replace(substr(r.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S2+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_kor k, lom_w m
            where  l.tt='LO9' and l.sos=5 and l.vdat>=:DAT1 and l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and
                   o.ref=k.refkor and l.ref=k.reflom and m.ref=l.ref and
                   substr(m.l_exp,1,6)||replace(replace(substr(m.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) oper,
           lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 7 +  Else
.head 8 -  Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s2/100 s
            from   oper l, lom_w r
            where  l.tt='LO9' and l.sos=5 and l.vdat>=:DAT1 and l.vdat<=:DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref) and r.ref=l.ref
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S2+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_kor k, lom_w m
            where  l.tt='LO9' and l.sos=5 and l.vdat>=:DAT1 and l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and
                   o.ref=k.refkor and l.ref=k.reflom and m.ref=l.ref) oper,
           lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 6 +  Else
.head 7 -  Set zLom.strSqlPopulate = "
    select oper.ref,oper.VDAT,oper.s,w.L_IZD IZD,w.L_MET MET,w.L_EDN EDN,w.L_ZAG ZAG,w.L_ZNJ ZNJ,w.L_LIG LIG,
           w.L_CEN CEN
    into   :zLom.tREF,:zLom.tVDAT,:zLom.tS,:zLom.tIZD,:zLom.tMET,:zLom.tEDN,:zLom.tZAG,:zLom.tZNJ,:zLom.tLIG,
           :zLom.tCEN
    from   (select distinct l.ref,l.vdat,l.s2/100 s
            from   oper l, lom_w r
            where  l.tt='LO9' and l.sos=5 and l.vdat>=:DAT1 and l.vdat<=:DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref) and r.ref=l.ref
            UNION ALL
            select distinct l.REF,l.VDAT,
                            (l.S2+(o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)))/100 S
            from   oper l, oper o, lom_kor k, lom_w m
            where  l.tt='LO9' and l.sos=5 and l.vdat>=:DAT1 and l.vdat<=:DAT2 and o.tt='LO5' and o.sos=5 and
                   o.ref=k.refkor and l.ref=k.reflom and m.ref=l.ref) oper, lom_w w
    where  not exists (select 1 from lom_w where ref=oper.ref and L_POS is not null) and w.ref=oper.ref
    order by 5"
.head 5 -  Set zLom.nKol = 0
.head 5 +  If SalTblPopulate(hWndForm, hSql(), zLom.strSqlPopulate, TBL_FillAll) and zLom.nKol > 0
.head 6 -  ! If SqlPrepareAndExecute(hSql(), "
   SELECT nvl(max(to_number(substr(value,1,4))),0)+1
   INTO   :zLom.nPos
   FROM   operw
   WHERE  tag='L_POS' and
          to_date(substr(value,-10),'dd/mm/yyyy')>to_date('01/01/'||substr(:zLom.sBankDay,-4),'dd/mm/yyyy')") and
   SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! If SqlPrepareAndExecute(hSql(), "
   SELECT nvl(max(to_number(substr(L_POS,1,4))),0)+1
   INTO   :zLom.nPos
   FROM   lom_w
   WHERE  L_POS is not null and
          to_date(substr(L_POS,-10),'dd/mm/yyyy')>to_date('01/01/'||substr(:zLom.sBankDay,-4),'dd/mm/yyyy')") and
   SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   SELECT min(num)
   from   conductor
   INTO   :zLom.nPos
   where  num not in (select to_number(substr(L_POS,1,4))
                      FROM   lom_w
                      WHERE  L_POS is not null and
                      to_date(substr(L_POS,-10),'dd/mm/yyyy')>
                      to_date('01/01/'||substr(:zLom.sBankDay,-4),'dd/mm/yyyy'))") and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalDateToStr(zLom.DAT_V_POS, zLom.DAT_VID)
.head 7 -  Set zLom.DAT_VID = SalStrMidX(zLom.DAT_VID, 8, 2) || '/' || SalStrMidX(zLom.DAT_VID, 5, 2) || '/' ||
    SalStrMidX(zLom.DAT_VID, 0, 4)
.head 7 -  Set zLom.dPos = Subs(Str(10000+zLom.nPos), 2, 4) || ' від ' || zLom.DAT_VID
.head 7 -  Call SalEnableWindow(pb_Pos)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  Else
.head 6 -  Call SalDisableWindow(pb_Pos)
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  Function: f_Pos
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp
.head 5 -  Number: ref
.head 5 -  !
.head 5 -  String: sSqlU
.head 5 -  String: sSqlI
.head 5 -  String: sSqlS
.head 4 +  Actions
.head 5 -  ! проверка (переносится из блока On SAM_Create сюда)
.head 5 -  ! If SqlPrepareAndExecute(hSql(), "
   SELECT a2.nls,substr(a2.nms,1,38),a9.nls,substr(a9.nms,1,38)
   INTO   :sNlsB,:sNmsB,:sNlsB9,:sNmsB9
   FROM   tts t2, accounts a2, tts t9, accounts a9
   WHERE  t2.tt=:LOV and a2.kv=:n980 and a2.nls=sb_acc(t2.nlsk,'') and t9.tt=:LOW and a9.kv=:n980 and
          a9.nls=sb_acc(t9.nlsk,'')") and
   SqlFetchNext(hSql(), nFetchRes)
.head 5 +  ! Else
.head 6 -  ! Call Debug("Не описані операції " || LOV || ' ' || LOW)
.head 6 -  Call MessageNoWait('Не описані операції ' || LOV || ', ' || LOW || ' або не існують рахунки з опису операцій!',
     'УВАГА!', 0, 1)
.head 6 -  ! Call SalDestroyWindow(hWndForm)
.head 6 -  Return FALSE
.head 5 +  If not rb9
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT a2.nls,substr(a2.nms,1,38)
   INTO   :sNlsB,:sNmsB,:sNlsB9,:sNmsB9
   FROM   tts t2, accounts a2
   WHERE  t2.tt=:LOV and a2.kv=:n980 and a2.nls=sb_acc(t2.nlsk,'')") and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  Else
.head 7 -  ! Call Debug("Не описані операції " || LOV || ' ' || LOW)
.head 7 -  Call MessageNoWait('Не описана операція ' || LOV || ' або не існують рахунки з опису операції!', 'УВАГА!', 0, 1)
.head 7 -  ! Call SalDestroyWindow(hWndForm)
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT a9.nls,substr(a9.nms,1,38)
   INTO   :sNlsB9,:sNmsB9
   FROM   tts t9, accounts a9
   WHERE  t9.tt=:LOW and a9.kv=:n980 and a9.nls=sb_acc(t9.nlsk,'')") and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  Else
.head 7 -  ! Call Debug("Не описані операції " || LOV || ' ' || LOW)
.head 7 -  Call MessageNoWait('Не описана операція ' || LOW || ' або не існують рахунки з опису операції!', 'УВАГА!', 0, 1)
.head 7 -  ! Call SalDestroyWindow(hWndForm)
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Set ref = NUMBER_Null
.head 5 -  Set Nazn = 'Передача посилки № '|| zLom.dPos || ' із скупленими дорогоцінними металами до Державної скарбниці'
.head 5 -  Set Nazn9 = 'Передача посилки № '|| zLom.dPos || ' з інвестиційними монетами до Державної скарбниці'
.head 5 -  !
.head 5 +  If rb2
.head 6 +  If SalIsWindowEnabled(cmbExpert)
.head 7 -  Set sSqlI = "
    INSERT
    INTO    operw (ref,tag,value) 
    SELECT  o.ref,'L_POS',:zLom.dPos
    FROM    oper o, lom_w w
    WHERE   o.tt in ('LO2','LO3') and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and o.ref=w.ref and
            w.L_POS is null and w.GRP in ('1','5') and
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')=:cmbExpert"
.head 6 +  Else
.head 7 -  Set sSqlI = "
    INSERT
    INTO    operw (ref,tag,value) 
    SELECT  o.ref,'L_POS',:zLom.dPos
    FROM    oper o, lom_w w
    WHERE   o.tt in ('LO2','LO3') and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and o.ref=w.ref and
            w.L_POS is null and w.GRP in ('1','5')"
.head 5 +  Else If rb3
.head 6 +  If SalIsWindowEnabled(cmbExpert)
.head 7 -  Set sSqlI = "
    INSERT
    INTO    operw (ref,tag,value) 
    SELECT  o.ref,'L_POS',:zLom.dPos
    FROM    oper o, lom_w w
    WHERE   o.tt='LO2' and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and o.ref=w.ref and
            w.L_POS is null and w.GRP in ('2','3') and
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')=:cmbExpert"
.head 6 +  Else
.head 7 -  Set sSqlI = "
    INSERT
    INTO    operw (ref,tag,value) 
    SELECT  o.ref,'L_POS',:zLom.dPos
    FROM    oper o, lom_w w
    WHERE   o.tt='LO2' and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and o.ref=w.ref and
            w.L_POS is null and w.GRP in ('2','3')"
.head 5 +  Else !! rb9
.head 6 +  If SalIsWindowEnabled(cmbExpert)
.head 7 -  Set sSqlI = "
    INSERT
    INTO    operw (ref,tag,value) 
    SELECT  o.ref,'L_POS',:zLom.dPos
    FROM    oper o, lom_w w
    WHERE   o.tt='LO9' and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and o.ref=w.ref and
            w.L_POS is null and
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')=:cmbExpert"
.head 6 +  Else
.head 7 -  Set sSqlI = "
    INSERT
    INTO    operw (ref,tag,value) 
    SELECT  o.ref,'L_POS',:zLom.dPos
    FROM    oper o, lom_w w
    WHERE   o.tt='LO9' and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and o.ref=w.ref and
            w.L_POS is null"
.head 5 -  !
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If SqlPrepareAndExecute(hSql(), sSqlI)
.head 6 +  If rb2
.head 7 -  ! Set sSqlU = "
    UPDATE lom_w
    set    l_pos=:zLom.dPos
    where  ref in (select ref
                   from   oper
                   WHERE  tt in ('LO2','LO3') and sos=5 and vdat>=:zLom.DAT1 and vdat<=:zLom.DAT2 and
                          ref not in (select ref from operw where tag='L_POS') and
                          ref in (select ref from operw where tag='GRP' and value in ('1','5')))"
.head 7 +  If SalIsWindowEnabled(cmbExpert)
.head 8 -  Set sSqlU = "
    UPDATE lom_w
    set    l_pos=:zLom.dPos
    where  ref in (select o.ref
                   from   oper o, lom_w w
                   WHERE  o.tt in ('LO2','LO3') and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and
                          o.ref=w.ref and w.L_POS is null and w.GRP in ('1','5') and
                          substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')=:cmbExpert)"
.head 7 +  Else
.head 8 -  Set sSqlU = "
    UPDATE lom_w
    set    l_pos=:zLom.dPos
    where  ref in (select o.ref
                   from   oper o, lom_w w
                   WHERE  o.tt in ('LO2','LO3') and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and
                          o.ref=w.ref and w.L_POS is null and w.GRP in ('1','5'))"
.head 6 +  Else If rb3
.head 7 +  If SalIsWindowEnabled(cmbExpert)
.head 8 -  Set sSqlU = "
    UPDATE lom_w
    set    l_pos=:zLom.dPos
    where  ref in (select o.ref
                   from   oper o, lom_w w
                   WHERE  o.tt='LO2' and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and o.ref=w.ref and
                   w.L_POS is null and w.GRP in ('2','3') and
                   substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')=:cmbExpert)"
.head 7 +  Else
.head 8 -  Set sSqlU = "
    UPDATE lom_w
    set    l_pos=:zLom.dPos
    where  ref in (select o.ref
                   from   oper o, lom_w w
                   WHERE  o.tt='LO2' and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and o.ref=w.ref and
                   w.L_POS is null and w.GRP in ('2','3'))"
.head 6 +  Else !! rb9
.head 7 +  If SalIsWindowEnabled(cmbExpert)
.head 8 -  Set sSqlU = "
   UPDATE lom_w
   set    l_pos=:zLom.dPos
   where  ref in (select o.ref
                  from   oper o, lom_w w
                  WHERE  o.tt='LO9' and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and o.ref=w.ref and
                         w.L_POS is null and
                         substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')=:cmbExpert)"
.head 7 +  Else
.head 8 -  Set sSqlU = "
   UPDATE lom_w
   set    l_pos=:zLom.dPos
   where  ref in (select o.ref
                  from   oper o, lom_w w
                  WHERE  o.tt='LO9' and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and o.ref=w.ref and
                         w.L_POS is null)"
.head 6 -  !
.head 6 -  ! If SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   operw (ref, tag,value) 
          SELECT ref,'L_POS',:zLom.dPos
          FROM   oper 
          WHERE tt in " || IifS(rb2 or rb3, "('LO2','LO3')", "'LO9'") || " and sos=5 and vdat>=:zLom.DAT1 and
                vdat<=:zLom.DAT2 and ref not in (select ref from operw where tag='L_POS')")
.head 6 -  !
.head 6 +  If SqlPrepareAndExecute(hSql(), sSqlU)
.head 7 +  ! If rb2 
.head 8 +  If SalModalDialog(dlg_Nazn, zLom, Nazn)
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 -  !
.head 9 -  ! Здесь вопрос по нижним SELECTам
.head 9 -  !
.head 9 -  ! If SqlPrepareAndExecute(hSqlAux2(), "
   SELECT m.nls_xp,substr(a.nms,1,38),SUM(o.S)
   INTO   :sNls,:sNms,:nSum
   FROM   operw p, operw w, lom_met m, accounts a,
          (select l.ref,(l.s+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s
           from   oper l, oper o,operw w                    
           where  l.tt in ('LO2','LO3') and l.sos=5 and l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                  o.tt='LO5' and o.sos=5 and o.ref=w.ref and w.tag='R_LO2' and l.ref=w.value
           UNION ALL
           select l.ref, l.s
           from   oper l  
           where  l.tt in ('LO2','LO3') and l.sos=5 and l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                  not exists (select 1 from operw w where w.tag='R_LO2' and w.value=l.ref)) o
   where  o.ref=p.ref and p.tag='L_POS' and p.value=:zLom.dPos and o.ref=w.ref and w.tag='L_MET' and
          w.value=m.name and a.kv=:zLom.n980 and a.nls=m.nls_xp
   GROUP BY m.nls_xp,substr(a.nms,1,38)")
.head 9 +  If SqlPrepareAndExecute(hSqlAux2(), sSqlS)
.head 10 +  While SqlFetchNext(hSqlAux2(), nFetchRes)
.head 11 -  ! Set nRef = NUMBER_Null
.head 11 -  Call cDoc.SetDoc(0, LOV, 0, 6, Subs(zLom.dPos,1,4), DAT_V_POS, BankDate, DAT_V_POS, DAT_V_POS,
                 sNls,  sNms,  BankMfo, '', n980, nSum, GetBankOkpoS(),
                 sNlsB, sNmsB, BankMfo, '', n980, nSum, GetBankOkpoS(),
                 Nazn, '', GetIdOper(), '', NUMBER_Null, 0)
.head 11 +  If not cDoc.oDoc()
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Return FALSE
.head 11 -  Set ref = cDoc.m_nRef
.head 11 +  If not SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   operw (ref,tag,value)
         values (:ref,'L_POS',:zLom.dPos)") or not SqlPrepareAndExecute(hSql(), "
   UPDATE lom_w
   set    L_POS=:zLom.dPos
   where  ref=:ref")
.head 12 -  Call SqlRollback(  hSql() )
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Return FALSE
.head 10 +  If ref = NUMBER_Null
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Return FALSE
.head 9 +  Else 
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Return FALSE
.head 7 +  If not rb9
.head 8 -  ! ОПЛАТА курсор по скупленим металам (конверты сведенные)
.head 8 +  If rb2
.head 9 -  ! Set sSqlS = "
    SELECT m.nls_xp,substr(a.nms,1,38),SUM(o.S)
    INTO   :sNls,:sNms,:nSum
    FROM   lom_w w, lom_met m, accounts a,
           (select l.ref,(l.s+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s
            from   oper l, oper o, operw w, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('1','5') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and o.tt='LO5' and o.sos=5 and o.ref=w.ref and
                   w.tag='R_LO2' and to_char(l.ref)=w.value
            UNION ALL
            select l.ref,l.s
            from   oper l, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('1','5') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                   not exists (select 1 from operw w where w.tag='R_LO2' and w.value=to_char(l.ref))) o
    where  a.kv=:zLom.n980 and a.nls=m.nls_xp and o.ref=w.ref and w.L_POS=:zLom.dPos and w.L_MET=m.name and
           w.GRP=to_char(m.grp)
    GROUP BY m.nls_xp,substr(a.nms,1,38)"
.head 9 -  ! Set sSqlS = "
    SELECT m.nls_xp,substr(a.nms,1,38),SUM(o.S)
    INTO   :sNls,:sNms,:nSum
    FROM   lom_w w, lom_met m, accounts a,
           (select l.ref,(l.s+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s
            from   oper l, oper o, lom_kor k, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('1','5') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and
                   l.ref=k.reflom and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select l.ref,l.s
            from   oper l, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('1','5') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref) and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) o
    where  a.kv=:zLom.n980 and a.nls=m.nls_xp and o.ref=w.ref and w.L_POS=:zLom.dPos and
           nvl(substr(w.L_MET,1,greatest(instr(w.L_MET,'-'),instr(w.L_MET,' '))-1),w.L_MET)=
           nvl(substr(m.name,1,greatest(instr(m.name,'-'),instr(m.name,' '))-1),m.name) and w.proba=m.proba and
           w.GRP=to_char(m.grp)
    GROUP BY m.nls_xp,substr(a.nms,1,38)"
.head 9 -  ! Set sSqlS = "
    SELECT m.nls_xp,substr(a.nms,1,38),SUM(o.S2)
    INTO   :sNls,:sNms,:nSum
    FROM   lom_w w, lom_met m, accounts a,
           (select l.ref,(l.s+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s
            from   oper l, oper o, lom_kor k, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('1','5') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and
                   l.ref=k.reflom and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select l.ref,l.s
            from   oper l, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('1','5') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref) and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) o
    where  a.kv=:zLom.n980 and a.nls=m.nls_xp and o.ref=w.ref and w.L_POS=:zLom.dPos and
           nvl(substr(w.L_MET,1,greatest(instr(w.L_MET,'-'),instr(w.L_MET,' '))-1),w.L_MET)=
           nvl(substr(m.name,1,greatest(instr(m.name,'-'),instr(m.name,' '))-1),m.name) and w.proba=m.proba and
           w.GRP=to_char(m.grp)
    GROUP BY m.nls_xp,substr(a.nms,1,38)"
.head 9 +  If SalIsWindowEnabled(cmbExpert)
.head 10 -  Set sSqlS = "
    SELECT m.nls_xp,substr(a.nms,1,38),SUM(o.S2)
    INTO   :sNls,:sNms,:nSum
    FROM   lom_w w, lom_met m, accounts a,
           (select l.ref,(l.s2+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s2
            from   oper l, oper o, lom_kor k, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('1','5') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and
                   l.ref=k.reflom and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select l.ref,l.s2
            from   oper l, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('1','5') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref) and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) o
    where  a.kv=:zLom.n980 and a.nls=m.nls_xp and o.ref=w.ref and w.L_POS=:zLom.dPos and
           nvl(substr(w.L_MET,1,greatest(instr(w.L_MET,'-'),instr(w.L_MET,' '))-1),w.L_MET)=
           nvl(substr(m.name,1,greatest(instr(m.name,'-'),instr(m.name,' '))-1),m.name) and
           w.proba=m.proba and w.GRP=to_char(m.grp)
    GROUP BY m.nls_xp,substr(a.nms,1,38)"
.head 9 +  Else
.head 10 -  Set sSqlS = "
    SELECT m.nls_xp,substr(a.nms,1,38),SUM(o.S2)
    INTO   :sNls,:sNms,:nSum
    FROM   lom_w w, lom_met m, accounts a,
           (select l.ref,(l.s2+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s2
            from   oper l, oper o, lom_kor k, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('1','5') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and
                   l.ref=k.reflom
            UNION ALL
            select l.ref,l.s2
            from   oper l, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('1','5') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref)) o
    where  a.kv=:zLom.n980 and a.nls=m.nls_xp and o.ref=w.ref and w.L_POS=:zLom.dPos and
           nvl(substr(w.L_MET,1,greatest(instr(w.L_MET,'-'),instr(w.L_MET,' '))-1),w.L_MET)=
           nvl(substr(m.name,1,greatest(instr(m.name,'-'),instr(m.name,' '))-1),m.name) and
           w.proba=m.proba and w.GRP=to_char(m.grp)
    GROUP BY m.nls_xp,substr(a.nms,1,38)"
.head 8 +  Else !! rb3
.head 9 -  ! Set sSqlS = "
    SELECT m.nls_xp,substr(a.nms,1,38),SUM(o.S)
    INTO   :sNls,:sNms,:nSum
    FROM   lom_w w, lom_met m, accounts a,
           (select l.ref,(l.s+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s
            from   oper l, oper o, operw w, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('2','3') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and o.tt='LO5' and o.sos=5 and o.ref=w.ref and
                   w.tag='R_LO2' and to_char(l.ref)=w.value
            UNION ALL
            select l.ref,l.s
            from   oper l, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('2','3') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                   not exists (select 1 from operw w where w.tag='R_LO2' and w.value=to_char(l.ref))) o
    where  a.kv=:zLom.n980 and a.nls=m.nls_xp and o.ref=w.ref and w.L_POS=:zLom.dPos and w.L_MET=m.name and
           w.GRP=to_char(m.grp)
    GROUP BY m.nls_xp,substr(a.nms,1,38)"
.head 9 -  ! Set sSqlS = "
    SELECT m.nls_xp,substr(a.nms,1,38),SUM(o.S)
    INTO   :sNls,:sNms,:nSum
    FROM   lom_w w, lom_met m, accounts a,
           (select l.ref,(l.s+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s
            from   oper l, oper o, lom_kor k, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('2','3') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and
                   l.ref=k.reflom and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select l.ref,l.s
            from   oper l, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('2','3') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref) and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) o
    where  a.kv=:zLom.n980 and a.nls=m.nls_xp and o.ref=w.ref and w.L_POS=:zLom.dPos and
           nvl(substr(w.L_MET,1,greatest(instr(w.L_MET,'-'),instr(w.L_MET,' '))-1),w.L_MET)=
           nvl(substr(m.name,1,greatest(instr(m.name,'-'),instr(m.name,' '))-1),m.name) and w.proba=m.proba and
           w.GRP=to_char(m.grp)
    GROUP BY m.nls_xp,substr(a.nms,1,38)"
.head 9 -  ! Set sSqlS = "
    SELECT m.nls_xp,substr(a.nms,1,38),SUM(o.S2)
    INTO   :sNls,:sNms,:nSum
    FROM   lom_w w, lom_met m, accounts a,
           (select l.ref,(l.s+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s
            from   oper l, oper o, lom_kor k, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('2','3') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and
                   l.ref=k.reflom and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select l.ref,l.s
            from   oper l, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('2','3') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref) and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) o
    where  a.kv=:zLom.n980 and a.nls=m.nls_xp and o.ref=w.ref and w.L_POS=:zLom.dPos and
           nvl(substr(w.L_MET,1,greatest(instr(w.L_MET,'-'),instr(w.L_MET,' '))-1),w.L_MET)=
           nvl(substr(m.name,1,greatest(instr(m.name,'-'),instr(m.name,' '))-1),m.name) and w.proba=m.proba and
           w.GRP=to_char(m.grp)
    GROUP BY m.nls_xp,substr(a.nms,1,38)"
.head 9 +  If SalIsWindowEnabled(cmbExpert)
.head 10 -  Set sSqlS = "
    SELECT m.nls_xp,substr(a.nms,1,38),SUM(o.S2)
    INTO   :sNls,:sNms,:nSum
    FROM   lom_w w, lom_met m, accounts a,
           (select l.ref,(l.s2+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s2
            from   oper l, oper o, lom_kor k, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('2','3') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and
                   l.ref=k.reflom and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
            UNION ALL
            select l.ref,l.s2
            from   oper l, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('2','3') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref) and
                   substr(w2.l_exp,1,6)||replace(replace(substr(w2.l_exp,7),'  ',' '),'. ','.')=:cmbExpert) o
    where  a.kv=:zLom.n980 and a.nls=m.nls_xp and o.ref=w.ref and w.L_POS=:zLom.dPos and
           nvl(substr(w.L_MET,1,greatest(instr(w.L_MET,'-'),instr(w.L_MET,' '))-1),w.L_MET)=
           nvl(substr(m.name,1,greatest(instr(m.name,'-'),instr(m.name,' '))-1),m.name) and
           w.proba=m.proba and w.GRP=to_char(m.grp)
    GROUP BY m.nls_xp,substr(a.nms,1,38)"
.head 9 +  Else
.head 10 -  Set sSqlS = "
    SELECT m.nls_xp,substr(a.nms,1,38),SUM(o.S2)
    INTO   :sNls,:sNms,:nSum
    FROM   lom_w w, lom_met m, accounts a,
           (select l.ref,(l.s2+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s2
            from   oper l, oper o, lom_kor k, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('2','3') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and o.tt='LO5' and o.sos=5 and o.ref=k.refkor and
                   l.ref=k.reflom
            UNION ALL
            select l.ref,l.s2
            from   oper l, lom_w w2
            where  l.tt in ('LO2','LO3') and l.sos=5 and w2.ref=l.ref and w2.GRP in ('2','3') and
                   l.vdat>=:zLom.DAT1 and l.vdat<=:zLom.DAT2 and
                   not exists (select 1 from lom_kor k where k.reflom=l.ref)) o
    where  a.kv=:zLom.n980 and a.nls=m.nls_xp and o.ref=w.ref and w.L_POS=:zLom.dPos and
           nvl(substr(w.L_MET,1,greatest(instr(w.L_MET,'-'),instr(w.L_MET,' '))-1),w.L_MET)=
           nvl(substr(m.name,1,greatest(instr(m.name,'-'),instr(m.name,' '))-1),m.name) and
           w.proba=m.proba and w.GRP=to_char(m.grp)
    GROUP BY m.nls_xp,substr(a.nms,1,38)"
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 +  If SalModalDialog(dlg_Nazn, zLom, Nazn)
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 -  !
.head 9 -  ! Здесь вопрос по нижним SELECTам
.head 9 -  !
.head 9 -  ! If SqlPrepareAndExecute(hSqlAux2(),
"SELECT m.nls_xp, substr(a.nms,1,38), SUM(o.S) 
   INTO :sNls, :sNms, :nSum
   FROM operw p, operw w, lom_met m, accounts a,                   
        ( select l.ref, (l.s+o.S*decode(o.DK,0,-1,1,1,0)*decode(substr(o.NLSA,1,4),'2210',1,-1)) s
            from oper l, oper o,operw w                    
           where l.tt in ('LO2','LO3')
             and l.sos = 5
             and l.vdat >= :zLom.DAT1 and l.vdat <= :zLom.DAT2
             and o.tt = 'LO5' and o.sos = 5 and o.ref = w.ref and w.tag = 'R_LO2'
             and l.ref = w.value
           UNION ALL
          select l.ref, l.s
            from oper l  
           where l.tt in ('LO2','LO3')
             and l.sos = 5 
             and l.vdat >= :zLom.DAT1 and l.vdat <= :zLom.DAT2
             and not exists (select 1 from operw w where w.tag = 'R_LO2' and w.value = l.ref) ) o
  where o.ref = p.ref and p.tag = 'L_POS' and p.value = :zLom.dPos
    and o.ref = w.ref and w.tag = 'L_MET' and w.value = m.name
    and a.kv = :zLom.n980 and a.nls = m.nls_xp
  GROUP BY m.nls_xp, substr(a.nms,1,38)")
.head 9 -  Set bPos = FALSE
.head 9 +  If SqlPrepareAndExecute(hSqlAux2(), sSqlS)
.head 10 +  While SqlFetchNext(hSqlAux2(), nFetchRes)
.head 11 -  ! Set nRef = NUMBER_Null
.head 11 -  Call cDoc.SetDoc(0, LOV, 0, 6, Subs(zLom.dPos,1,4), DAT_V_POS, BankDate, DAT_V_POS, DAT_V_POS,
                 sNls,  sNms,  BankMfo, '', n980, nSum, GetBankOkpoS(), 
                 sNlsB, sNmsB, BankMfo, '', n980, nSum, GetBankOkpoS(), Nazn, '', GetIdOper(), '',
                 NUMBER_Null, 0)
.head 11 +  If not cDoc.oDoc()
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Return FALSE
.head 11 -  Set ref = cDoc.m_nRef
.head 11 -  ! If not SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) values (:ref,'L_POS',:zLom.dPos)") or
   not SqlPrepareAndExecute(hSql(), "UPDATE lom_w set L_POS=:zLom.dPos where ref=:ref")
.head 11 +  If not SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) values (:ref,'L_POS',:zLom.dPos)")
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Return FALSE
.head 11 +  If not SqlPrepareAndExecute(hSql(), "INSERT INTO lom_w (ref,L_POS) values (:ref,:zLom.dPos)")
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Return FALSE
.head 11 +  Else
.head 12 -  Set bPos = TRUE
.head 10 +  If ref = NUMBER_Null
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Return FALSE
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Return FALSE
.head 8 -  !
.head 8 +  If bPos
.head 9 -  Set sTmp = 'Зформовано посилку № ' || zLom.dPos
.head 9 -  Call SqlCommitEx(hSql(), sTmp)
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call MessageNoWait(sTmp || '. Роздрукуйте її опис !', 'Повідомлення', 3, 0)
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Set sTmp = 'НЕ зформовано посилку № ' || zLom.dPos ||
    ', можливо не описані потрібні реквізити в довіднику металів!'
.head 9 -  ! Set zLom.dPos = STRING_Null
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call MessageNoWait(sTmp, 'УВАГА!', 7, 1)
.head 7 +  Else !! rb9
.head 8 -  ! ОПЛАТА курсор по оцінкам металам (конверты сведенные)
.head 8 -  ! Call SalWaitCursor(TRUE)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 +  If SalModalDialog(dlg_Nazn, zLom, Nazn9)
.head 9 -  ! If SqlPrepareAndExecute(hSqlAux2(), "
   SELECT m.nls9,substr(a.nms,1,38),SUM(o.S)
   INTO   :sNls,:sNms,:nSum
   FROM   oper o, lom_met m, lom_w w, accounts a
   WHERE  o.ref=w.ref and w.L_POS=:zLom.dPos and
          nvl(substr(w.L_MET,1,greatest(instr(w.L_MET,'-'),instr(w.L_MET,' '))-1),w.L_MET)=
          nvl(substr(m.name,1,greatest(instr(m.name,'-'),instr(m.name,' '))-1),m.name) and w.proba=m.proba and
          w.GRP=to_char(m.grp) and o.tt='LO9' and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and
          a.kv=:n980 and a.nls=m.nls9 and
          substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
   GROUP BY m.nls9,substr(a.nms,1,38)")
.head 9 +  If SalIsWindowEnabled(cmbExpert)
.head 10 +  If SqlPrepareAndExecute(hSqlAux2(), "
   SELECT m.nls9,substr(a.nms,1,38),SUM(o.S2)
   INTO   :sNls,:sNms,:nSum
   FROM   oper o, lom_met m, lom_w w, accounts a
   WHERE  o.ref=w.ref and w.L_POS=:zLom.dPos and
          nvl(substr(w.L_MET,1,greatest(instr(w.L_MET,'-'),instr(w.L_MET,' '))-1),w.L_MET)=
          nvl(substr(m.name,1,greatest(instr(m.name,'-'),instr(m.name,' '))-1),m.name) and w.proba=m.proba and
          w.GRP=to_char(m.grp) and o.tt='LO9' and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and
          a.kv=:n980 and a.nls=m.nls9 and
          substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')=:cmbExpert
   GROUP BY m.nls9,substr(a.nms,1,38)")
.head 11 -  Set bPos = FALSE
.head 11 +  While SqlFetchNext(hSqlAux2(), nFetchRes)
.head 12 -  Set nRef = NUMBER_Null
.head 12 -  ! Call cDoc.SetDoc(nRef, LOW, 0, 6, Subs(zLom.dPos,1,4), DAT_V_POS, BankDate, DAT_V_POS, DAT_V_POS,
                 sNls,   sNms,   BankMfo, '', n980, nSum, GetBankOkpoS(),
                 sNlsB9, sNmsB9, BankMfo, '', n980, nSum, GetBankOkpoS(),
                 'Передача посилки № ' || zLom.dPos ||
                 ' із дорогоцінними металами для оцінки до Державної скарбниці', '', GetIdOper(), '',
                 NUMBER_Null, 0)
.head 12 -  ! Call cDoc.SetDoc(nRef, LOW, 0, 981, Subs(zLom.dPos,1,4), DAT_V_POS, BankDate, DAT_V_POS, DAT_V_POS,
                 sNls,   sNms,   BankMfo, '', n980, nSum, GetBankOkpoS(),
                 sNlsB9, sNmsB9, BankMfo, '', n980, nSum, GetBankOkpoS(),
                 'Передача посилки № ' || zLom.dPos ||
                 ' із дорогоцінними металами для оцінки до Державної скарбниці', '', GetIdOper(), '',
                 NUMBER_Null, 0)
.head 12 -  ! Call Debug('before SetDoc nRef, LOW, 0, 981...')
.head 12 -  Call cDoc.SetDoc(nRef, LOW, 0, 981, Subs(zLom.dPos,1,4), DAT_V_POS, BankDate, DAT_V_POS, DAT_V_POS,
                 sNls,   sNms,   BankMfo, '', n980, nSum, GetBankOkpoS(),
                 sNlsB9, sNmsB9, BankMfo, '', n980, nSum, GetBankOkpoS(), Nazn9, '', GetIdOper(), '',
                 NUMBER_Null, 0)
.head 12 +  If not cDoc.oDoc()
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Return FALSE
.head 12 -  Set ref = cDoc.m_nRef
.head 12 +  If not SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) values (:ref,'L_POS',:zLom.dPos)")
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Return FALSE
.head 12 +  If not SqlPrepareAndExecute(hSql(), "INSERT INTO lom_w (ref,L_POS) values (:ref,:zLom.dPos)")
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Return FALSE
.head 12 +  Else
.head 13 -  Set bPos = TRUE
.head 9 +  Else
.head 10 +  If SqlPrepareAndExecute(hSqlAux2(), "
   SELECT m.nls9,substr(a.nms,1,38),SUM(o.S2)
   INTO   :sNls,:sNms,:nSum
   FROM   oper o, lom_met m, lom_w w, accounts a
   WHERE  o.ref=w.ref and w.L_POS=:zLom.dPos and
          nvl(substr(w.L_MET,1,greatest(instr(w.L_MET,'-'),instr(w.L_MET,' '))-1),w.L_MET)=
          nvl(substr(m.name,1,greatest(instr(m.name,'-'),instr(m.name,' '))-1),m.name) and w.proba=m.proba and
          w.GRP=to_char(m.grp) and o.tt='LO9' and o.sos=5 and o.vdat>=:zLom.DAT1 and o.vdat<=:zLom.DAT2 and
          a.kv=:n980 and a.nls=m.nls9
   GROUP BY m.nls9,substr(a.nms,1,38)")
.head 11 -  Set bPos = FALSE
.head 11 +  While SqlFetchNext(hSqlAux2(), nFetchRes)
.head 12 -  Set nRef = NUMBER_Null
.head 12 -  ! Call cDoc.SetDoc(nRef, LOW, 0, 6, Subs(zLom.dPos,1,4), DAT_V_POS, BankDate, DAT_V_POS, DAT_V_POS,
                 sNls,   sNms,   BankMfo, '', n980, nSum, GetBankOkpoS(),
                 sNlsB9, sNmsB9, BankMfo, '', n980, nSum, GetBankOkpoS(),
                 'Передача посилки № ' || zLom.dPos ||
                 ' із дорогоцінними металами для оцінки до Державної скарбниці', '', GetIdOper(), '',
                 NUMBER_Null, 0)
.head 12 -  ! Call cDoc.SetDoc(nRef, LOW, 0, 981, Subs(zLom.dPos,1,4), DAT_V_POS, BankDate, DAT_V_POS, DAT_V_POS,
                 sNls,   sNms,   BankMfo, '', n980, nSum, GetBankOkpoS(),
                 sNlsB9, sNmsB9, BankMfo, '', n980, nSum, GetBankOkpoS(),
                 'Передача посилки № ' || zLom.dPos ||
                 ' із дорогоцінними металами для оцінки до Державної скарбниці', '', GetIdOper(), '',
                 NUMBER_Null, 0)
.head 12 -  ! Call Debug('before SetDoc nRef, LOW, 0, 981...')
.head 12 -  Call cDoc.SetDoc(nRef, LOW, 0, 981, Subs(zLom.dPos,1,4), DAT_V_POS, BankDate, DAT_V_POS, DAT_V_POS,
                 sNls,   sNms,   BankMfo, '', n980, nSum, GetBankOkpoS(),
                 sNlsB9, sNmsB9, BankMfo, '', n980, nSum, GetBankOkpoS(), Nazn9, '', GetIdOper(), '',
                 NUMBER_Null, 0)
.head 12 +  If not cDoc.oDoc()
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Return FALSE
.head 12 -  Set ref = cDoc.m_nRef
.head 12 +  If not SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) values (:ref,'L_POS',:zLom.dPos)")
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Return FALSE
.head 12 +  If not SqlPrepareAndExecute(hSql(), "INSERT INTO lom_w (ref,L_POS) values (:ref,:zLom.dPos)")
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Return FALSE
.head 12 +  Else
.head 13 -  Set bPos = TRUE
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Return FALSE
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 +  If bPos
.head 9 -  ! Call SqlCommit(hSql())
.head 9 -  Set sTmp = 'Зформовано посилку № ' || zLom.dPos
.head 9 -  Call SqlCommitEx(hSql(), sTmp)
.head 9 -  Call MessageNoWait(sTmp || '. Роздрукуйте її опис !', 'Повідомлення', 3, 0)
.head 8 +  Else
.head 9 -  Set sTmp = 'НЕ зформовано посилку № ' || zLom.dPos ||
    ', можливо не описані потрібні реквізити в довіднику металів чи довіднику монет!'
.head 9 -  Call SqlRollback(hSql())
.head 9 -  ! Set zLom.dPos = STRING_Null
.head 9 -  Call MessageNoWait(sTmp, 'УВАГА!', 7, 1)
.head 7 -  ! Call SalEnableWindow(pb_Doc)
.head 7 -  ! Call SalSendMsg(pb_Doc, SAM_Click, 0, 0)
.head 7 -  Call NASELENIE()
.head 7 -  Return TRUE
.head 5 -  Call SqlRollback(hSql())
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return FALSE
.head 3 +  Function: f_Exp
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalListClear(cmbExpert)
.head 5 +  If rb2
.head 6 -  ! Call SalListPopulate(cmbExpert, hSql(), T("
     select distinct
            w.l_exp
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt in ('LO2','LO3') and w.grp in ('1','5') and
            o.vdat between :DAT1 and :DAT2 and o.sos=5
     order by 1"))
.head 6 -  Call SalListPopulate(cmbExpert, hSql(), T("
     select distinct
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt in ('LO2','LO3') and w.grp in ('1','5') and
            o.vdat between :DAT1 and :DAT2
     order by 1"))
.head 5 +  Else If rb3
.head 6 -  ! Call SalListPopulate(cmbExpert, hSql(), T("
     select distinct
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt='LO2' and w.grp in ('2','3') and
            o.vdat between :DAT1 and :DAT2 and o.sos=5
     order by 1"))
.head 6 -  Call SalListPopulate(cmbExpert, hSql(), T("
     select distinct
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt='LO2' and w.grp in ('2','3') and
            o.vdat between :DAT1 and :DAT2
     order by 1"))
.head 5 +  Else !! If rb9
.head 6 -  ! Call SalListPopulate(cmbExpert, hSql(), T("
     select distinct
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt='LO9' and o.vdat between :DAT1 and :DAT2 and o.sos=5
     order by 1"))
.head 6 -  Call SalListPopulate(cmbExpert, hSql(), T("
     select distinct
            substr(w.l_exp,1,6)||replace(replace(substr(w.l_exp,7),'  ',' '),'. ','.')
     from   lom_w w, oper o
     where  w.ref=o.ref and w.l_pos is null and o.tt='LO9' and o.vdat between :DAT1 and :DAT2
     order by 1"))
.head 5 -  Set nEntries = SalListQueryCount(cmbExpert) 
.head 5 -  Set nI = 0
.head 5 +  While nI < nEntries
.head 6 -  Call SalListSetSelect(cmbExpert, nI)
.head 6 +  If Val(Left(cmbExpert, 6)) = GetUserId()
.head 7 -  Break
.head 6 -  Set nI = nI + 1
.head 5 +  If nI = nEntries
.head 6 -  Call SalListSetSelect(cmbExpert, 0)
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: LOV
.head 3 -  String: LOW
.head 2 +  Window Variables
.head 3 -  String: sNls
.head 3 -  String: sNms
.head 3 -  String: sNlsB
.head 3 -  String: sNmsB
.head 3 -  Number: nSum
.head 3 -  String: sNlsB9
.head 3 -  String: sNmsB9
.head 3 -  Number: nPos
.head 3 -  Number: nRef
.head 3 -  Number: n980
.head 3 -  Number: nKol
.head 3 -  Date/Time: BankDate
.head 3 -  String: BankMfo
.head 3 -  String: sBankDay
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  ! для печати 
.head 3 -  String: sSqlPrint
.head 3 -  String: strREP
.head 3 -  String: strCEN
.head 3 -  String: strFa
.head 3 -  Number: nInd
.head 3 -  !
.head 3 -  Date/Time: dDat
.head 3 -  String: POS
.head 3 -  Number: REF
.head 3 -  Date/Time: VDAT
.head 3 -  String: IZD
.head 3 -  String: MET
.head 3 -  Number: EDN
.head 3 -  Number: ZAG
.head 3 -  Number: ZNJ
.head 3 -  Number: LIG
.head 3 -  String: CEN
.head 3 -  Date/Time: DAT_V_POS
.head 3 -  String: NAME1
.head 3 -  Number: S
.head 3 -  String: PR
.head 3 -  !
.head 3 -  String: sDeviceDef                !! Параметры для печати отчета (*.rtf)
.head 3 -  String: sDriverDef                !!  - -//- -
.head 3 -  String: sPortDef                  !!  - -//- -
.head 3 -  ! String: sDriverDefo             !!  - -//- -
.head 3 -  !
.head 3 -  String: EXP1 !! ФИО эксперта
.head 3 -  String: MVO1 !! Мат ответственное лицо №1
.head 3 -  String: MVO2 !! Мат ответственное лицо №2
.head 3 -  String: MVO3 !! Мат ответственное лицо №3
.head 3 -  String: DAT_VID
.head 3 -  String: Nazn
.head 3 -  String: Nazn9
.head 3 -  Number: nEntries
.head 3 -  Number: nI
.head 3 -  !
.head 3 -  Boolean: bL
.head 3 -  Boolean: bMULTI
.head 3 -  !
.head 3 -  Boolean: bPos
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  ! Set rb2 = TRUE
.head 4 -  Set rb9 = TRUE
.head 4 -  Call f_Exp()
.head 4 -  Call SalDisableWindow(pb_Pos)
.head 4 -  Call SalDisableWindow(pb_Doc)
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 1)
.head 4 -  Set zLom.nTabInstance = 1
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set zLom.strFilterTblName = 'OPER'
.head 4 -  Set zLom.strPrintFileName = 'RB_MFO'
.head 4 -  Set zLom.BankDate = GetBankDate()
.head 4 -  Set zLom.sBankDay = SalFmtFormatDateTime(zLom.BankDate, 'dd/MM/yyyy')
.head 4 -  Set zLom.DAT1 = BankDate - 11
.head 4 -  Set zLom.DAT2 = BankDate - 1
.head 4 -  Set zLom.n980 = GetBaseVal()
.head 4 -  Set zLom.BankMfo = GetBankMfo()
.head 4 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT a2.nls,substr(a2.nms,1,38),a9.nls,substr(a9.nms,1,38)
   INTO   :sNlsB,:sNmsB,:sNlsB9,:sNmsB9
   FROM   tts t2, accounts a2, tts t9, accounts a9
   WHERE  t2.tt=:LOV and a2.kv=:n980 and a2.nls=sb_acc(t2.nlsk,'') and t9.tt=:LOW and a9.kv=:n980 and
          a9.nls=sb_acc(t9.nlsk,'')") and not SqlFetchNext(hSql(), nFetchRes)
.head 5 -  ! Call Debug("Не описані операції " || LOV || ' ' || LOW)
.head 5 -  Call MessageNoWait('Не описані операції ' || LOV || ', ' || LOW || ' або не існують рахунки з опису операцій!', 'УВАГА!',
     0, 1)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  !
.head 4 -  Set bL = GetGlobalOption('LOMEXP')='1'
.head 4 -  ! Set bMULTI = GetGlobalOption('HAVETOBO')>='2'
.head 4 -  Set bMULTI = FALSE
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_CreateComplete
.head 4 +  If not bL
.head 5 -  Call SalDisableWindow(cmbExpert)
.head 5 -  Call SalHideWindow(cmbExpert)
.head 5 -  Call SalHideWindow(df31)
.head 3 -  On UM_Populate
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set zLom.nKol = zLom.nKol + 1
.head 3 -  !
.head 3 +  On SAM_ReportStart
.head 4 -  Call SqlPrepare(hSql(), sSqlPrint)
.head 3 +  On SAM_ReportFetchInit
.head 4 -  Return SqlExecute(hSql())
.head 3 +  On SAM_ReportFetchNext
.head 4 -  Return SqlFetchNext(hSql(), nFetchRes)
.head 3 +  On SAM_ReportNotify
.head 4 +  If lParam = RPT_BeforeBreakHeader1 ! загол посылки
.head 5 -  Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'OUR_MFO', zLom.BankMfo)
.head 5 -  Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'OUR_BANK_NAME', GetBankName())
.head 3 +  On SAM_ReportFinish
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  Call DosDirectPrint(strFa)
.head 1 +  Form Window: SyncLom
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Обновление справочника цен драг металлов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.883"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.476"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Обновление справочника цен драг металлов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: OK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Синхронизировать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.767"
.head 5 -  Top:    1.94"
.head 5 -  Width:  1.783"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.488"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: Cancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.467"
.head 5 -  Top:    1.94"
.head 5 -  Width:  1.783"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Custom Control: Progress
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.567"
.head 6 -  Top:    1.524"
.head 6 -  Width:  6.283"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Data Field: df1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.55"
.head 6 -  Top:    0.738"
.head 6 -  Width:  5.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Файл *.dbf обновления справочника цен:
.head 4 -  Resource Id: 59126
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.55"
.head 5 -  Top:    0.536"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Выбран файл обновления за:
.head 4 -  Resource Id: 59127
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.85"
.head 5 -  Top:    1.202"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: df2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.45"
.head 6 -  Top:    1.155"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.274"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.35"
.head 5 -  Top:    0.762"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDlgOpenFile ( SyncLom, "Открытие файла", strFilters, 2, int, FileName, FilePath )
.head 5 +  On SAM_Create
.head 6 -  Set strFilters[0] = 'Executable Files'
.head 6 -  Set strFilters[1] = 'exe'
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: strFilters[0:1]
.head 3 -  Number: int
.head 3 -  String: FileName
.head 3 -  String: FilePath
.head 3 -  Number: nFetchRes
.head 2 -  Message Actions
.head 1 +  Dialog Box: Unform
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Розформування посилок
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.571"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Etched
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.44"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: PosDel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\UNFORM.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Розформувати посилку'
.head 6 +  On SAM_Click
.head 7 +  If SalStrToNumber(tbl1.SOS) < 0
.head 8 -  Call SalMessageBox('Посилка розформована раніше!', 'Увага!', MB_Ok)
.head 7 +  If SalStrToNumber(tbl1.SOS) = 5
.head 8 -  Call SalMessageBox('Не можна розформувати посилку, яка вже відправлена!', 'Увага!', MB_Ok)
.head 7 +  If SalStrToNumber(tbl1.SOS) < 5 and SalStrToNumber(tbl1.SOS) > -1
.head 8 +  If SalMessageBox('Ви дійсно хочете розформувати посилку №' || tbl1.POS, 'Увага!', 1) = 1
.head 9 +  If zLom.rb2
.head 10 -  Set sSqlD = "
    delete
    from   operw
    where  tag='L_POS' and ref in (select ref from oper where tt in ('LO2','LO3') and value=:tbl1.POS)"
.head 9 +  Else If zLom.rb3
.head 10 -  Set sSqlD = "
    delete
    from   operw
    where  tag='L_POS' and ref in (select ref from oper where tt='LO2' and value=:tbl1.POS)"
.head 9 +  Else !! zLom.rb9
.head 10 -  Set sSqlD = "
    delete
    from   operw
    where  tag='L_POS' and ref in (select ref from oper where tt='LO9' and value=:tbl1.POS)"
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 +  If SqlPrepareAndExecute(hSql(), sSqlD) and
   SqlPrepareAndExecute(hSql(), "
   update lom_w
   set    l_pos=null
   where  l_pos=:tbl1.POS") and
   SqlPrepareAndExecute(hSqlAux(), "
   select ref
   into   :Reff
   from   oper
   where  tt='" || IifS(zLom.rb2 or zLom.rb3, 'LOV', 'LOW') || "' and
          ref in (select ref from operw where tag='L_POS' and value=:tbl1.POS)")
.head 10 +  While SqlFetchNext(hSqlAux(), err) or err=0
.head 11 +  ! If not SqlPLSQLCommand(hSql(), "bars.P_BACK_DOK(Reff,nTmp1,NUMBER_Null,nTmp2,sTmp,1)")
.head 12 -  Call SalMessageBox('Виникла помилка №01 при розформуванні посилки!', 'ПОМИЛКА!', MB_Ok)
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Return 0
.head 11 +  If not SqlPLSQLCommand(hSql(), "bars.ful_bak(Reff)")
.head 12 -  Call SalMessageBox('Виникла помилка №01 при розформуванні посилки!', 'ПОМИЛКА!', MB_Ok)
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Return 0
.head 10 +  If SqlCommit(hSql())
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox('Посилка №' || tbl1.POS || ' вдало розформована', 'Повідомлення', MB_Ok)
.head 10 -  Call SalWaitCursor(TRUE)
.head 10 -  Call SalSendMsg(tbl1, UM_Populate, 0, 0)
.head 10 -  Call SalWaitCursor(FALSE)
.head 9 +  Else
.head 10 -  Call SalMessageBox('Виникла помилка №02 при розформуванні посилки!', 'ПОМИЛКА!', MB_Ok)
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Call SalWaitCursor(FALSE)
.head 4 +  Pushbutton: Exit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.9"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Закрити'
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(Unform)
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.036"
.head 6 -  Width:  6.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: SOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: POS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Посилка
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SUM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strPopulate
.head 5 -  Number: nFetchRes
.head 5 -  String: strText
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If zLom.rb2 or zLom.rb3
.head 7 -  ! Set strPopulate = "
    select max(o.sos),ss.value,ss.SUM
    INTO   :tbl1.SOS,:tbl1.POS,:tbl1.SUM
    from   oper o, operw w,
           (SELECT SUM(o.s)/100 SUM,w.value VALUE
            FROM   oper o, operw w
            where  W.tag='L_POS' and o.ref=w.ref and o.tt='LOV'
            group by W.value) ss
    where  o.ref=w.ref and o.tt='LOV' and w.value=ss.value and W.tag='L_POS'
    group by SS.value,ss.sum"
.head 7 -  Set strPopulate = "
    select max(o.sos),ss.value,ss.SUM
    INTO   :tbl1.SOS,:tbl1.POS,:tbl1.SUM
    from   oper o, lom_w w,
           (SELECT SUM(o.s)/100 SUM,w.l_pos VALUE
            FROM   oper o, lom_w w
            where  W.L_POS is not null and o.ref=w.ref and o.tt='LOV'
            group by W.L_POS) ss
    where  o.ref=w.ref and o.tt='LOV' and w.l_pos=ss.value
    group by SS.value,ss.sum"
.head 6 +  Else
.head 7 -  ! Set strPopulate = "
    select max(o.sos),ss.value,ss.SUM
    INTO   :tbl1.SOS,:tbl1.POS,:tbl1.SUM
    from   oper o, operw w,
           (SELECT SUM(o.s)/100 SUM,w.value VALUE
            FROM   oper o, operw w
            where  W.tag='L_POS' and o.ref=w.ref and o.tt='LOW'
            group by W.value) ss
    where  o.ref=w.ref and o.tt='LOW' and w.value=ss.value and W.tag='L_POS'
    group by SS.value,ss.sum"
.head 7 -  Set strPopulate = "
    select max(o.sos),ss.value,ss.SUM
    INTO   :tbl1.SOS,:tbl1.POS,:tbl1.SUM
    from   oper o, lom_w w,
           (SELECT SUM(o.s)/100 SUM,w.l_pos VALUE
            FROM   oper o, lom_w w
            where  W.L_POS is not null and o.ref=w.ref and o.tt='LOW'
            group by W.L_POS) ss
    where  o.ref=w.ref and o.tt='LOW' and w.l_pos=ss.value
    group by SS.value,ss.sum"
.head 6 -  Set strPopulate = strPopulate || " 
    ORDER BY to_date(substr(ss.value,-10),'dd/MM/yyyy') desc,substr(ss.value,1,4) desc"
.head 6 -  Call SalTblPopulate(hWndItem, hSql(), strPopulate, TBL_FillAll)
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, 1)
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, 1)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If SalStrToNumber(tbl1.SOS) = 5
.head 7 -  Call SalTblSetCellTextColor(tbl1.POS, COLOR_Black, FALSE)
.head 6 +  Else If SalStrToNumber(tbl1.SOS) = 3
.head 7 -  Call SalTblSetCellTextColor(tbl1.POS, COLOR_DarkBlue, FALSE)
.head 6 +  Else If SalStrToNumber(tbl1.SOS) <= -1
.head 7 -  Call SalTblSetCellTextColor(tbl1.POS, COLOR_DarkRed, FALSE)
.head 6 +  Else
.head 7 -  Call SalTblSetCellTextColor(tbl1.POS, COLOR_DarkGreen, FALSE)
.head 5 +  On SAM_CreateComplete
.head 6 -  ! Call SalTblSortRows(tbl1, 2, TBL_SortDecreasing)
.head 6 -  Call SalTblClearSelection(tbl1)
.head 5 +  On SAM_Click
.head 6 -  Call SalTblClearSelection(tbl1)
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblPopulate(hWndItem, hSql(), strPopulate, TBL_FillAll)
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, 1)
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, 1)
.head 6 -  ! Call SalTblSortRows(tbl1, 2, TBL_SortDecreasing)
.head 6 -  Call SalWaitCursor(FALSE)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nSrch
.head 3 -  String: strSrch
.head 3 -  Number: SOS
.head 3 -  String: POS
.head 3 -  Number: SUM
.head 3 -  Number: Reff
.head 3 -  Number: err
.head 3 -  !
.head 3 -  ! Number: nTmp1
.head 3 -  ! Number: nTmp2
.head 3 -  ! String: sTmp
.head 3 -  !
.head 3 -  String: sSqlD
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText (Unform, 'Розформування посилок по ' || IifS(zLom.rb2, 'скупленим', 'прийнятим для оцінки') ||
     ' цінностям')
.head 1 +  Dialog Box: VDAT_POS
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ввод дати відправки посилки
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.35"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.5"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.183"
.head 6 -  Top:    0.155"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата відправки посилки:
.head 4 -  Resource Id: 34938
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.179"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 34939
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.071"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.8"
.head 5 -  Top:    0.583"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If dfDat = DATETIME_Null
.head 7 -  Call SalMessageBox('Не заповнено дату!', 'Увага!', MB_Ok)
.head 6 +  Else If dfDat < dBankDate
.head 7 -  Call SalMessageBox('Дата валютування не може бути меньша за банківську!', 'Увага!', MB_Ok)
.head 6 +  Else
.head 7 -  Set dDat = dfDat
.head 7 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.0"
.head 5 -  Top:    0.583"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Date/Time: dBankDate
.head 3 -  Receive Date/Time: dDat
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set dfDat = dBankDate
.head 4 -  Set dDat = DATETIME_Null
.head 1 +  Dialog Box: dlgTagBrowse1  ! TAG бровзер
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Код-Текст Бровзер
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.7"
.head 4 -  Top:    0.49"
.head 4 -  Width:  7.517"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.631"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Поиск(F7):
.head 4 -  Resource Id: 30364
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    0.238"
.head 5 -  Width:  1.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: df1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.833"
.head 6 -  Top:    0.238"
.head 6 -  Width:  5.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nRow=-1
.head 6 -  Call SalSendMsg( pbSearch, SAM_Click, 0, 0 )
.head 6 -  Return VALIDATE_OkClearFlag
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.333"
.head 6 -  Top:    0.595"
.head 6 -  Width:  6.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.857"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 30000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  ! cColumnLabeled: colKod
.winattr class Column:
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -                                                                                                                            List Values 
.head 6 -                                                                                                                            Message Actions 
.head 5 +  ! cColumnLabeled: colTxt
.winattr class Column:
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Текст
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -                                                                                                                            List Values 
.head 6 -                                                                                                                            Message Actions 
.head 5 +  Column: colKod
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTxt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Текст
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.817"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If not SalIsNull( colKod )
.head 7 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call SalTblQueryFocus ( hWndForm, nRow, hWndCol )
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalMapEnterToTab(TRUE)
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab(FALSE)
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    4.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetContext( tbl, nRow )
.head 6 -  Set strKod=tbl.colKod
.head 6 -  Call SalEndDialog( hWndForm, TRUE )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.883"
.head 5 -  Top:    4.702"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 -  Frame
.head 4 -  Resource Id: 30365
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.095"
.head 5 -  Width:  7.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSearch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.333"
.head 5 -  Top:    4.821"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F7
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = VisTblFindString (tbl, nRow+1, hWndNULL, df1)
.head 6 +  If nRow != -1
.head 7 -  Call SalTblSetFocusRow( tbl, nRow )
.head 7 -  ! Call SalTblSetContext( tbl, nRow )
.head 7 -  ! Call SalTblSetRowFlags( tbl, nRow, ROW_Selected, TRUE )
.head 6 -  ! Call DebugN(nRow)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: strSelect
.head 3 -  Receive String: strKod
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: N1
.head 3 -  Number: L1
.head 3 -  String: sSql
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sSql = SalStrTrimX( SalStrUpperX( strSelect ) )
.head 4 -  Set L1 =  SalStrLength( sSql ) -1
.head 4 -  Set sSql = SalStrTrimX( Subs(sSql,1, L1 ) )
.head 4 -  Set L1 = SalStrLength( sSql ) -1
.head 4 -  Set sSql = SalStrTrimX( Subs(sSql,1, L1 ) )
.head 4 -  Set N1 = SalStrScan ( sSql, 'SELECT' ) 		
.head 4 -  Set sSql = Subs(sSql ,N1+1 , L1 )  || " INTO :tbl.colKod, :tbl.colTxt"
.head 4 -  Call SalTblPopulate( tbl, hSql(), sSql , TBL_FillAll)
.head 4 -  Call SalSetFocus( df1 )
.head 1 +  Form Window: Vkv
.head 2 -  Class: cDocW
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.65"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.31"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.417"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPayDoc
.head 5 -  Class Child Ref Key: 27
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrtDoc
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 11860
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text:
.head 5 -  Resource Id: 11861
.head 5 -  Class Child Ref Key: 75
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 11862
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 11863
.head 5 -  Class Child Ref Key: 59
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfZn
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfOst
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewDoc
.head 5 -  Class Child Ref Key: 53
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewTTs
.head 5 -  Class Child Ref Key: 60
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDocBal
.head 5 -  Class Child Ref Key: 72
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 62
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSaveKor
.head 5 -  Class Child Ref Key: 64
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbLocalD
.head 5 -  Class Child Ref Key: 148
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 11864
.head 5 -  Class Child Ref Key: 77
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbHotVytyag
.head 5 -  Class Child Ref Key: 138
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotFio
.head 5 -  Class Child Ref Key: 141
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotName
.head 5 -  Class Child Ref Key: 137
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotOstat
.head 5 -  Class Child Ref Key: 150
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Data Field: dfValD1
.head 4 -  Class Child Ref Key: 25
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set Vkv.dfValD1 = Vkv.DatVal
.head 3 +  Combo Box: cmbVob
.head 4 -  Class Child Ref Key: 39
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text:
.head 4 -  Resource Id: 11855
.head 4 -  Class Child Ref Key: 36
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfNd
.head 4 -  Class Child Ref Key: 23
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDocD
.head 4 -  Class Child Ref Key: 22
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set Vkv.dfDocD = SalDateCurrent(  )
.head 3 +  Data Field: dfBankA
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 50
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlat
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamA
.head 4 -  Class Child Ref Key: 7
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoA
.head 4 -  Class Child Ref Key: 139
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlatB
.head 4 -  Class Child Ref Key: 9
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbA
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.head 4 -  Class Child Ref Key: 13
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPoluB
.head 4 -  Class Child Ref Key: 18
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbB
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 51
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsB
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPolu
.head 4 -  Class Child Ref Key: 17
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamB
.head 4 -  Class Child Ref Key: 16
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoB
.head 4 -  Class Child Ref Key: 140
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNA
.head 4 -  Class Child Ref Key: 135
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumA
.head 4 -  Class Child Ref Key: 20
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNB
.head 4 -  Class Child Ref Key: 122
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumB
.head 4 -  Class Child Ref Key: 21
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalShowWindow( hWndItem )
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  ! Call UnHideIt( hWndItem )
.head 3 +  Data Field: dfRatNomN
.head 4 -  Class Child Ref Key: 123
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNom
.head 4 -  Class Child Ref Key: 57
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalShowWindow( hWndItem )
.head 6 -  Call SalDisableWindow( hWndItem )
.head 3 +  Data Field: dfSumNC
.head 4 -  Class Child Ref Key: 125
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumC
.head 4 -  Class Child Ref Key: 44
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquivN
.head 4 -  Class Child Ref Key: 144
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquiv
.head 4 -  Class Child Ref Key: 145
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  List Box: lb1
.head 4 -  Class Child Ref Key: 85
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Set Vkv.i=0
.head 6 -  Call SalArrayGetUpperBound( Vkv.aTag, 1, Vkv.nTmp )
.head 6 +  While Vkv.i < Vkv.nTmp
.head 7 -  Set Vkv.i = Vkv.i + 1
.head 7 +  If SalStrTrimX( Vkv.aTag [ Vkv.i ] )='FIO'
.head 8 -  Set Vkv.aVal[Vkv.i] = FIO
.head 8 -  Set Vkv.iFIO = Vkv.i
.head 6 -  Call SalListSetSelect( lb1, 0 )
.head 6 -  Call SalSendMsg( hWndItem, SAM_Click, 0, 0 )
.head 3 +  Multiline Field: dfNazn
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalSendClassMessage( SAM_SetFocus, 0, 0 )
.head 6 +  If SalListQuerySelection( Vkv.lb1 )=0 
and Vkv.dfNazn = STRING_Null and Vkv.dfKvA != STRING_Null 
and Vkv.dfSumA !=NUMBER_Null
.head 7 -  Set Vkv.dfNazn  = 
IifS(Vkv.KP_='K_','Купівля ','Продаж ') || 
SalNumberToStrX( Vkv.dfSumA,2) ||' '|| Vkv.dfKvA || 
' по курсу '|| SalNumberToStrX( Vkv.dfRatNom,4)
.head 7 -  Set Vkv.aVal[ 0 ] = dfNazn 
.head 3 +  Data Field: dfSkN
.head 4 -  Class Child Ref Key: 115
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSk
.head 4 -  Class Child Ref Key: 48
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2N
.head 4 -  Class Child Ref Key: 131
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2
.head 4 -  Class Child Ref Key: 66
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfD
.head 4 -  Class Child Ref Key: 132
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK
.head 4 -  Class Child Ref Key: 133
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLocDat
.head 4 -  Class Child Ref Key: 149
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUgrnt
.head 4 -  Class Child Ref Key: 130
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVytyagN
.head 4 -  Class Child Ref Key: 142
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateFrom
.head 4 -  Class Child Ref Key: 155
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1N
.head 4 -  Class Child Ref Key: 160
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1f
.head 4 -  Class Child Ref Key: 156
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic2f
.head 4 -  Class Child Ref Key: 157
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic3f
.head 4 -  Class Child Ref Key: 158
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSub
.head 4 -  Class Child Ref Key: 167
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSubN
.head 4 -  Class Child Ref Key: 166
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: oDoc
.head 4 -  Description: Оплатить  документ с прибамбасами
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nKurs
.head 4 +  Actions
.head 5 -  Set nKurs = dfRatNom
.head 5 -  Return cDocW.oDoc() 
.head 2 +  Window Parameters
.head 3 -  String: TOBO !! Код безБал отд
.head 3 -  String: KP_ !! Купiвля = K_
            !! Продаж  = P_
.head 3 -  String: sAccA !! Счет кассы
.head 3 -  String: TTT !! код операции
.head 3 -  String: FIO
.head 3 -  Date/Time: DatVal !! дата валютирования
.head 3 -  Window Handle: pb_
.head 3 -  !
.head 3 -  Number: b840
.head 3 -  Number: b978
.head 3 -  Number: b643
.head 2 +  Window Variables
.head 3 -  String: colFlags
.head 3 -  Number: iFIO
.head 2 +  Message Actions
.head 3 +  On UM_Choose
.head 4 -  Set Vkv.sGetXRate='BARS.GetXRate'
.head 4 +  If not Vkv.bDocStart
.head 5 -  Set Vkv.bDocStart=TRUE
.head 5 -  Set Vkv.bFixAll  =FALSE
.head 5 -  Set Vkv.bFixNlsA =FALSE
.head 5 -  Set Vkv.bFixKvA  =FALSE
.head 5 -  Set Vkv.bFixKvB  =FALSE
.head 5 -  Set Vkv.bFixNlsB =FALSE
.head 5 -  Set Vkv.bFixMfoB =FALSE
.head 5 -  Set Vkv.bFixDocD =FALSE
.head 5 -  Set Vkv.bFixValD1=FALSE
.head 5 -  Set Vkv.sFixKvA  =STRING_Null
.head 5 -  Set Vkv.sFixNlsA =STRING_Null
.head 5 -  Set Vkv.sFixKvB  =STRING_Null
.head 5 -  Set Vkv.sFixNlsB =STRING_Null
.head 5 -  Set Vkv.sFixMfoB          =STRING_Null
.head 5 -  Set Vkv.dFixDocD =DATETIME_Null
.head 5 -  Set Vkv.dFixValD1=DATETIME_Null
.head 5 -  Set Vkv.nFixVob  =NUMBER_Null
.head 5 -  Set Vkv.sTT = TTT
.head 5 +  If not SqlPrepareAndExecute(hSql(),
  "SELECT name, fli, flv, nvl(dk,1),  sk, flags
   INTO :Vkv.sTTN,  :Vkv.nFli, :Vkv.nFlv, :Vkv.nDk, :Vkv.nSk_TT,:Vkv.colFlags
   FROM tts WHERE tt=:Vkv.sTT " )
or not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalMessageBox("Не описана операція " || TTT, "Помилка", MB_IconExclamation)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  !
.head 5 -  Set Vkv.sNlsA_TT  = Vkv.sAccA
.head 5 -  Set Vkv.sNlsB_TT  = Vkv.sAccA
.head 5 -  Set Vkv.nKvB_TT = GetBaseVal()
.head 5 -  Call Flgs2aFlg(Vkv.colFlags)
.head 5 -  ! Set Vkv.nFpy =SalStrToNumber(SalStrMidX(Vkv.colFlags,37,1))
.head 5 -  ! Set Vkv.nFvD1=SalStrToNumber(SalStrMidX(Vkv.colFlags,3,1))
.head 5 -  ! Set Vkv.nFvD2=SalStrToNumber(SalStrMidX(Vkv.colFlags,49,1))
.head 5 -  ! Set Vkv.nFtr =SalStrToNumber(SalStrMidX(Vkv.colFlags,59,1))
.head 5 -  ! Set Vkv.nFbk =SalStrToNumber(SalStrMidX(Vkv.colFlags,60,1))
.head 5 -  ! Set Vkv.nFcb =SalStrToNumber(SalStrMidX(Vkv.colFlags,58,1))
.head 5 -  ! Set Vkv.nFpr =SalStrToNumber(SalStrMidX(Vkv.colFlags,46,1))
.head 5 -  ! Set Vkv.nFdp =SalStrToNumber(SalStrMidX(Vkv.colFlags,35,1))
.head 5 -  ! Set Vkv.nFug =SalStrToNumber(SalStrMidX(Vkv.colFlags,12,1))
.head 5 -  ! Set Vkv.nFeq =SalStrToNumber(SalStrMidX(Vkv.colFlags,14,1))
.head 5 +  ! If SalStrToNumber(SalStrMidX(Vkv.colFlags,9,1)) = 0
.head 6 -                                                                                                             Set Vkv.nSk_TT = NUMBER_Null
.head 5 +  ! Else
.head 6 +                                                                                                             If Vkv.nSk_TT=NUMBER_Null
.head 7 -                                                                                                             Set Vkv.nSk_TT =0
.head 4 -  Call SalSetWindowText(hWndForm, 'НЕТОРГОВІ валютообмінні операції - [ ' || Vkv.sTT ||' '|| Vkv.sTTN || ' ]')
.head 4 -  Call SalSendClassMessage(UM_Clear, 0, 0)
.head 3 +  On SAM_Destroy
.head 4 -  Set KP.dFIO = Vkv.aVal[Vkv.iFIO]
.head 4 -  Call SalEnableWindow( pb_ )
.head 4 -  Call SalSetFocus(pb_)
.head 1 +  Table Window: KPK
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Установка курсів КУПІВЛІ та продажу ВАЛЮТИ по безбалансовим відділенням банку
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.2"
.head 4 -  Top:    0.104"
.head 4 -  Width:  17.05"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.167"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.333"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 6684
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.433"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set sFilter = ''
.head 7 -  Set strPar01 = ''
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 6685
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.217"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 6686
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pb_Blank
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.5"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\COPY.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: White
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Розмітити курси відділен' || IifS(nPar=3, 'ня', 'ь') || ' ПУСТИМИ значеннями'
.head 6 +  On SAM_Click
.head 7 +  If DAT1 != DATETIME_Null
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Set pTmp = 'Курси відділен' || IifS(nPar=3, 'ня', 'ь') || ' за ' || SalFmtFormatDateTime(DAT1, 'dd/MM/yyyy') ||
    ' розмічені ПУСТИМИ значеннями.'
.head 8 +  If nHaveTOBO = 2
.head 9 -  ! А размечені ли курсы на нужный нам день ?
.head 9 -  ! If SqlPrepareAndExecute(hSql(), "
   select max(vdate)
   into   :PDAT
   from   cur_rates$base
   where  vdate<=:DAT1") and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If SqlPrepareAndExecute(hSql(), "
   select max(trunc(vdate))
   into   :PDAT
   from   cur_rates$base
   where  vdate<:DAT1") and SqlFetchNext(hSql(), nFetchRes)
.head 10 +  If PDAT < DAT1
.head 11 -  ! Нет, делаем INSERT только офф.курсов
.head 11 +  ! If SqlPrepareAndExecute(hSql(), "
   INSERT
   into   CUR_RATES$BASE(KV,VDATE,BSUM,RATE_O,BRANCH,OTM)
                  select KV,:DAT1,BSUM,RATE_O,BRANCH,OTM
                  from   CUR_RATES$BASE
                  where  VDATE=:PDAT")
.head 12 -  Call SqlCommit(hSql())
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Call MessageNoWait(pTmp, 'ПОВІДОМЛЕННЯ !!!', 7, 0)
.head 12 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 11 +  If SqlPrepareAndExecute(hSql(), "
   INSERT
   into   CUR_RATES$BASE(KV,VDATE,BSUM,RATE_O,BRANCH)
                  select KV,:DAT1,BSUM,RATE_O,BRANCH
                  from   CUR_RATES$BASE
                  where  trunc(VDATE)=:PDAT")
.head 12 -  Call SqlCommit(hSql())
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Call MessageNoWait(pTmp, 'ПОВІДОМЛЕННЯ !!!', 7, 0)
.head 12 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 11 +  Else
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Call MessageNoWait('Курси відділен' || IifS(nPar=3, 'ня', 'ь') || ' за ' ||
    SalFmtFormatDateTime(DAT1, 'dd/MM/yyyy') || ' ВЖЕ були розмічені ПУСТИМИ значеннями.',
    'ПОПЕРЕДЖЕННЯ !!!', 7, 1)
.head 10 +  Else
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call MessageNoWait('Курси відділен' || IifS(nPar=3, 'ня', 'ь') || ' за ' ||
    SalFmtFormatDateTime(DAT1, 'dd/MM/yyyy') ||
    ' НЕ можуть бути розмічені (відсутні курси за будь-яку попередню дату).', 'ПОПЕРЕДЖЕННЯ !!!', 7, 1)
.head 8 +  Else
.head 9 -  ! Выбор курсов для размеченных отделений
  union all
  Выбор курсов для новых отделений по всем валютам
.head 9 +  If DAT1 != DATETIME_Null and SqlPrepareAndExecute(hSql(), "
   insert
   into   cur_rates_tobo (tobo,kv,bsum,vdate)
   select t.tobo,c.kv,c.bsum,:DAT1
   from   cur_rates_tobo c, v_tobo_open t
   where  t.tobo<>'0' and c.tobo=t.tobo and (c.tobo,c.kv,c.vdate)=(select r.tobo,r.kv,max(r.vdate)
                                                                   from   cur_rates_tobo r
                                                                   where  trunc(r.vdate)<=:DAT1 and
                                                                          r.tobo=c.tobo and r.kv=c.kv
                                                                   group by r.tobo,r.kv) and
          (c.tobo,c.kv,:DAT1) not in (select tobo,kv,trunc(vdate)
                                      from   cur_rates_tobo)" || IifS(nPar=3, " and t.tobo=:sTOBO", "") || "
   union all
   select t.tobo,r.kv,c.bsum,:DAT1
   from   v_tobo_open t, (select unique kv from cur_rates_tobo) r, cur_rates c
   where  t.tobo<>'0' and t.tobo not in (select tobo from cur_rates_tobo) and
          (c.kv,c.vdate)=(select kv,max(vdate)
                          from   cur_rates
                          where  trunc(vdate)<=:DAT1 and kv=r.kv
                          group by kv)" || IifS(nPar=3, " and t.tobo=:sTOBO", ""))
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait(pTmp , 'ПОВІДОМЛЕННЯ !!!', 7, 0)
.head 10 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 8 -  Call SalWaitCursor(FALSE)
.head 4 +  Pushbutton: pb_Pred
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\COPY.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Розмітити курси відділен' || IifS(nPar=3, 'ня', 'ь') || ' значеннями ПОПЕРЕДНЬОГО дня'
.head 6 +  On SAM_Click
.head 7 +  If DAT1 != DATETIME_Null
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 +  If nHaveTOBO = 2
.head 9 -  Set sSql = "p_layout_exchange_rates(DAT1,sTOBO)"
.head 9 +  If SqlPLSQLCommand(hSql(), sSql)
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait('Курси відділен' || IifS(nPar=3, 'ня', 'ь') || ' за ' ||
     SalFmtFormatDateTime(DAT1, 'dd/MM/yyyy') || ' розмічені курсами ПОПЕРЕДНЬОГО дня.',
     'ПОВІДОМЛЕННЯ !!!', 7, 0)
.head 10 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 8 +  Else
.head 9 -  Set sSql = "
    insert
    into   cur_rates_tobo (tobo,kv,bsum,vdate,rate_b,rate_s)
    select t.tobo,c.kv,c.bsum,:DAT1,c.rate_b,c.rate_s
    from   cur_rates_tobo c, v_tobo_open t
    where  t.tobo<>'0' and c.tobo=t.tobo and (c.tobo,c.kv,c.vdate)=(select r.tobo,r.kv,max(r.vdate)
                                                                    from   cur_rates_tobo r
                                                                    where  trunc(r.vdate)<=:DAT1 and
                                                                           r.tobo=c.tobo and r.kv=c.kv
                                                                    group by r.tobo,r.kv) and
           (c.tobo,c.kv,:DAT1) not in (select tobo,kv,trunc(vdate)
                                       from   cur_rates_tobo)" || IifS(nPar=3, " and t.tobo=:sTOBO", "") || "
    union all
    select t.tobo,r.kv,g.bsum,:DAT1,g.rate_b,g.rate_s
    from   v_tobo_open t, (select unique kv from cur_rates_tobo) r, cur_rates g
    where  t.tobo<>'0' and t.tobo not in (select tobo from cur_rates_tobo) and
           (g.kv,g.vdate)=(select kv,max(vdate)
                           from   cur_rates
                           where  trunc(vdate)<=:DAT1 and kv=r.kv
                           group by kv)" || IifS(nPar=3, " and t.tobo=:sTOBO", "")
.head 9 +  If SqlPrepareAndExecute(hSql(), sSql)
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait('Курси відділен' || IifS(nPar=3, 'ня', 'ь') || ' за ' ||
     SalFmtFormatDateTime(DAT1, 'dd/MM/yyyy') || ' розмічені курсами ПОПЕРЕДНЬОГО дня.',
     'ПОВІДОМЛЕННЯ !!!', 7, 0)
.head 10 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 8 -  Call SalWaitCursor(FALSE)
.head 4 +  Pushbutton: pb_Golov
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.467"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\COPY.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Orchid
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Розмітити курси відділен' || IifS(nPar=3, 'ня', 'ь') || ' значеннями ГОЛОВНОГО банку'
.head 6 +  On SAM_Click
.head 7 +  If DAT1 != DATETIME_Null
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 +  If nHaveTOBO = 2
.head 9 -  Set sSql1 = "
    from   cur_rates_tobo 
    where  kv=C.kv and tobo=substr(C.branch,1,8) and length (tobo)=8 and trunc(vdate)=:DAT1"
.head 9 -  Set sSql =
"UPDATE cur_rates$base C
 SET    C.rate_b=(select rate_b " || sSql1|| "),
        C.rate_s=(select rate_s " || sSql1|| ")
 WHERE  C.braNch like :sTOBO ||'%' and length(C.branch)>8 and trunc(C.vdate)=:DAT1" ||
        IifS(nPar=3, " and C.branch=:sTOBO", "")
.head 9 -  ! Set sSql = "
  UPDATE cur_rates_tobo C
  SET    C.rate_b=(select rate_b " || sSql1|| "),
         C.rate_s=(select rate_s " || sSql1|| ")
  WHERE  length(C.tobo)>8 and C.vdate=:DAT1" || IifS(nPar=3, " and C.tobo=:sTOBO", "")
.head 8 +  Else
.head 9 -  Set sSql = "
    insert
    into   cur_rates_tobo (tobo,kv,bsum,vdate,rate_b,rate_s)
    select t.tobo,c.kv,c.bsum,:DAT1,g.rate_b,g.rate_s
    from   cur_rates_tobo c, v_tobo_open t, cur_rates g
    where t.tobo<>'0' and c.tobo=t.tobo and (c.tobo,c.kv,c.vdate)=(select r.tobo,r.kv,max(r.vdate)
                                                                   from   cur_rates_tobo r
                                                                   where  trunc(r.vdate)<=:DAT1 and
                                                                          r.tobo=c.tobo and r.kv=c.kv
                                                                   group by r.tobo, r.kv) and
          (c.tobo,c.kv,:DAT1) not in (select tobo,kv,trunc(vdate)
                                      from   cur_rates_tobo) and c.kv=g.kv and
          (g.kv,g.vdate)=(select kv, max(vdate)
                          from   cur_rates
                          where  trunc(vdate)<=:DAT1 and kv=c.kv
                          group by kv)" || IifS(nPar=3, " and t.tobo=:sTOBO", "") || "
    union all
    select t.tobo,r.kv,g.bsum,:DAT1,g.rate_b,g.rate_s
    from   v_tobo_open t, (select unique kv from cur_rates_tobo) r, cur_rates g
    where  t.tobo<>'0' and t.tobo not in (select tobo from cur_rates_tobo) and
           (g.kv,g.vdate)=(select kv, max(vdate)
                           from   cur_rates
                           where  trunc(vdate)<=:DAT1 and kv=r.kv
                           group by kv)" || IifS(nPar=3, " and t.tobo=:sTOBO", "")
.head 8 -  !
.head 8 +  If SqlPrepareAndExecute(hSql(), sSql)
.head 9 -  Call SqlGetModifiedRows(hSql(), nCount)
.head 9 -  Call SqlCommit(hSql())
.head 9 +  If nCount > 0
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait('Курси відділен' || IifS(nPar=3, 'ня', 'ь') || ' за ' ||
     SalFmtFormatDateTime(DAT1, 'dd/MM/yyyy') || ' розмічені курсами ГОЛОВНОГО банку.', 'ПОВІДОМЛЕННЯ !!!', 7,
     0)
.head 10 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 9 +  Else
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait('Курси ГОЛОВНОГО банку за ' || SalFmtFormatDateTime(DAT1, 'dd/MM/yyyy') || ' відсутні.',
     'ПОПЕРЕДЖЕННЯ !!!', 7, 1)
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SalWaitCursor(FALSE)
.head 4 +  Data Field: DAT1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.917"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.533"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Дата для розмітки курсів')
.head 6 +  On SAM_Validate
.head 7 -  Set sDAT1 = F_DAT(DAT1, nTmp)
.head 7 -  Call SalColorSet(sDAT1, 8, nTmp)
.head 7 -  Call SalColorSet(DAT1, 8, nTmp)
.head 4 +  Data Field: sDAT1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.65"
.head 7 -  Top:    0.071"
.head 7 -  Width:  3.267"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Дата для розмітки курсів')
.head 4 +  Data Field: sDATT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.25"
.head 7 -  Top:    0.071"
.head 7 -  Width:  2.933"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Поточна дата')
.head 4 +  Check Box: cb_Arch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: З Архіву
.head 5 -  Window Location and Size
.head 6 -  Left:   13.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   15.65"
.head 7 -  Top:    0.071"
.head 7 -  Width:  0.883"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'К-ть зап.')
.head 2 +  Contents
.head 3 +  Column: TOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ТОБО
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 +  If not SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 7 -  Call MessageNoWait('Корректировка поля запрещена!', 'ОШИБКА', 0.1, 1)
.head 5 +  On SAM_Click
.head 6 -  ! Set nContext = SalTblQueryContext(hWndForm)
.head 6 +  If not SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 7 -  Set sTOBO = TOBO
.head 5 +  On SAM_Validate
.head 6 +  If SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 7 -  If SqlPrepareAndExecute(hSql(), "
   SELECT PARAM_VALUE
   INTO :NAMT
   FROM BRANCH_PARAMS_VALUES
   WHERE mfo=:TOBO and name='BANKNAME'") and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  Else
.head 7 -  Set TOBO = sTOBO
.head 6 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, FALSE)
.head 6 -  Return VALIDATE_Ok
.head 5 +  ! On SAM_KillFocus
.head 6 +  If not SalTblQueryRowFlags(hWndForm, nContext, ROW_New)
.head 7 -  ! Set TOBO = sTOBO
.head 7 -  Call SalTblSetRowFlags(hWndForm, nContext, ROW_Edited, FALSE)
.head 3 +  Column: NAMT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва 
ТОБО
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.25"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If nPar = 0 and SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 7 -  Set sTmp = STRING_Null
.head 7 +  If FunNSIGet('TOBO','NAME', sTmp, NAMT) = 1
.head 8 -  Set TOBO = sTmp
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Числ
код
вал
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 +  If not SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 7 -  Call MessageNoWait('Корректировка поля запрещена!', 'ОШИБКА', 0.1, 1)
.head 5 +  On SAM_Click
.head 6 -  ! Set nContext = SalTblQueryContext(hWndForm)
.head 6 +  If not SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 7 -  Set nKV = KV
.head 5 +  On SAM_Validate
.head 6 +  If SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 7 -  ! If SqlPrepareAndExecute(hSql(), "
   SELECT t.name,t.lcv,c.bsum,null,null,c.rate_o,c.vdate
   INTO :NAMV,:LCV,:BSUM,:KUP,:PROD,:RATE_O,:VDATEO
   FROM tabval t, cur_rates c
   WHERE t.kv=:KV and t.kv=c.kv and (c.KV,c.VDATE)=(SELECT kv,max(vdate)
                                                    FROM cur_rates
                                                    WHERE kv=t.kv and vdate<=:DAT1
                                                    GROUP BY kv)") and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  If SqlPrepareAndExecute(hSql(), "
   SELECT t.name,t.lcv,c.bsum,null,null,c.rate_o,c.vdate
   INTO :NAMV,:LCV,:BSUM,:KUP,:PROD,:RATE_O,:VDATEO
   FROM tabval t, cur_rates c
   WHERE t.kv=:KV and t.kv=c.kv and (c.KV,c.VDATE)=(SELECT kv,max(vdate)
                                                    FROM   cur_rates
                                                    WHERE  kv=t.kv and trunc(vdate)<=:DAT1 and official='Y'
                                                    GROUP BY kv)") and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  Else
.head 7 -  Set KV = nKV
.head 6 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, FALSE)
.head 6 -  Return VALIDATE_Ok
.head 5 +  ! On SAM_KillFocus
.head 6 +  If not SalTblQueryRowFlags(hWndForm, nContext, ROW_New)
.head 7 -  ! Set KV = nKV
.head 7 -  Call SalTblSetRowFlags(hWndForm, nContext, ROW_Edited, FALSE)
.head 3 +  Column: LCV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Симв
код
вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAMV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва
валюти
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.033"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If nPar = 0 and SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 7 -  Set sTmp = STRING_Null
.head 7 -  Set nKV = KV
.head 7 +  If FunNSIGet('TABVAL','NAME', sTmp, NAMV) = 1
.head 8 -  Set KV = Val(sTmp)
.head 8 +  If KV != nKV
.head 9 -  ! If SqlPrepareAndExecute(hSql(), "
   SELECT t.name,t.lcv,c.bsum,null,null,c.rate_o,c.vdate
   INTO :NAMV,:LCV,:BSUM,:KUP,:PROD,:RATE_O,:VDATEO
   FROM tabval t, cur_rates c
   WHERE t.kv=:KV and t.kv=c.kv and (c.KV,c.VDATE)=(SELECT kv,max(vdate)
                                                    FROM cur_rates
                                                    WHERE kv=t.kv and vdate<=:DAT1
                                                    GROUP BY kv)") and SqlFetchNext(hSql(), nFetchRes)
.head 9 -  If SqlPrepareAndExecute(hSql(), "
   SELECT t.name,t.lcv,c.bsum,null,null,c.rate_o,c.vdate
   INTO :NAMV,:LCV,:BSUM,:KUP,:PROD,:RATE_O,:VDATEO
   FROM tabval t, cur_rates c
   WHERE t.kv=:KV and t.kv=c.kv and (c.KV,c.VDATE)=(SELECT kv,max(vdate)
                                                    FROM cur_rates
                                                    WHERE kv=t.kv and trunc(vdate)<=:DAT1 and official='Y'
                                                    GROUP BY kv)") and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set KV = nKV
.head 10 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, FALSE)
.head 3 +  Column: VDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
курсу
комерц.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: DateTime
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 +  If not SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 7 -  Call MessageNoWait('Корректировка поля запрещена!', 'ОШИБКА', 0.1, 1)
.head 5 +  On SAM_Click
.head 6 -  ! Set nContext = SalTblQueryContext(hWndForm)
.head 6 +  If not SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 7 -  Set dVDATE = VDATE
.head 5 +  On SAM_Validate
.head 6 +  If not SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 7 -  Set VDATE = dVDATE
.head 6 -  Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, FALSE)
.head 6 -  Return VALIDATE_Ok
.head 5 +  ! On SAM_KillFocus
.head 6 +  If not SalTblQueryRowFlags(hWndForm, nContext, ROW_New)
.head 7 -  ! Set VDATE = dVDATE
.head 7 -  Call SalTblSetRowFlags(hWndForm, nContext, ROW_Edited, FALSE)
.head 3 +  Column: BSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Базова 
сума
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.033"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KUP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс 
купівлі
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #00000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PROD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс 
продажу
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #00000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RATE_O
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс 
офіційний
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #00000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VDATEO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
курсу
офіц.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_DAT
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Date/Time: DAT
.head 5 -  Receive Number: nCol
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDAT
.head 5 -  Number: nMONT
.head 5 -  String: sMONT
.head 5 -  Date/Time: dTmp
.head 4 +  Actions
.head 5 +  Select Case SalDateWeekday(DAT)
.head 6 +  Case 0
.head 7 -  Set sDAT = 'Субота'
.head 7 -  Break
.head 6 +  Case 1
.head 7 -  Set sDAT = 'Неділя'
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set sDAT = 'Понеділок'
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Set sDAT = 'Вівторок'
.head 7 -  Break
.head 6 +  Case 4
.head 7 -  Set sDAT = 'Середа'
.head 7 -  Break
.head 6 +  Case 5
.head 7 -  Set sDAT = 'Четвер'
.head 7 -  Break
.head 6 +  Case 6
.head 7 -  Set sDAT = 'П`ятниця'
.head 7 -  Break
.head 5 -  Set nMONT = SalDateMonth(DAT)
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT NAME_FROM
   INTO   :sMONT
   FROM   META_MONTH
   WHERE  n=:nMONT") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set sDAT = sDAT || ', ' || Str(SalDateDay(DAT)) || ' ' || sMONT || ' ' || Str(SalDateYear(DAT))
.head 5 -  !
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT HOLIDAY
   INTO   :dTmp
   FROM   HOLIDAY
   WHERE  kv=:n980 and HOLIDAY=:DAT") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set nCol = COLOR_Red
.head 5 +  Else
.head 6 -  Set nCol = COLOR_Blue
.head 5 -  Return sDAT
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPar     !! =0 установка в головном для ТОБО
                    =1 просмотр в ТОБО
                    =2 просмотр в ТОБО 2
.head 3 -  String: strPar01 !! можно фильтр "влеплять" (но только разумно) или пустое значение
.head 3 -  String: strPar02 !! =  '0' - Текущий банковский день (как в ОБ),
                       иначе - Следующий банковский день (как в ДЕМАРКЕ),
.head 2 +  Window Variables
.head 3 -  Number: n980
.head 3 -  Number: nTmp
.head 3 -  String: sTmp
.head 3 -  String: sTOBO
.head 3 -  String: sFilter
.head 3 -  String: sSql1
.head 3 -  String: sSql
.head 3 -  String: sSqlH
.head 3 -  Number: nKV
.head 3 -  Number: nDem
.head 3 -  Date/Time: PDAT
.head 3 -  Date/Time: bDat
.head 3 -  String: pTmp
.head 3 -  Date/Time: dVDATE
.head 3 -  !
.head 3 -  Number: nCount
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 5)
.head 4 -  Set n980 = GetBaseVal()
.head 4 -  Set bDat = GetBankDate()
.head 4 -  Set sDATT = F_DAT(SalDateCurrent(), nTmp)
.head 4 -  Call SalColorSet(sDATT, 8, nTmp)
.head 4 -  Set KPK.nTabInstance = 1
.head 4 -  Set KPK.fFilterAtStart = TRUE
.head 4 -  Set KPK.strPrintFileName = 'TOBO_RAT'
.head 4 -  Set KPK.strFilterTblName = 'CUR_RATES_TOBO'
.head 4 +  If SalStrTrimX(strPar02) = ''
.head 5 -  Set nDem = 1
.head 4 +  Else
.head 5 -  Set nDem = Val(SalStrTrimX(strPar02))
.head 4 +  If nHaveTOBO = 2
.head 5 -  Set sSqlH = "SYS_CONTEXT('bars_context','user_branch')"
.head 4 +  Else
.head 5 -  Set sSqlH = "pul.Get_Mas_Ini_Val('KOD_TOBO')"
.head 4 -  If SqlPrepareAndExecute(hSql(), "
   SELECT Substr(" || sSqlH || " ,1,30)
   INTO :sTOBO
   FROM dual") and SqlFetchNext(hSql(), nFetchRes)
.head 4 +  If nPar = 1 or nPar = 2 !! только просмотр 
.head 5 -  Call SalDisableWindow(TOBO)
.head 5 -  Call SalDisableWindow(KV)
.head 5 -  Call SalDisableWindow(VDATE)
.head 5 -  Call SalDisableWindow(BSUM)
.head 5 -  Call SalDisableWindow(KUP)
.head 5 -  Call SalDisableWindow(PROD)
.head 5 -  !
.head 5 -  Call SalHideWindow(pbIns)
.head 5 -  Call SalHideWindow(pbDel)
.head 5 -  Call SalHideWindow(pbUpdate)
.head 5 -  Call SalHideWindow(pbFilter)
.head 5 -  Call SalHideWindow(pb_Blank)
.head 5 -  Call SalHideWindow(pb_Pred)
.head 5 -  Call SalHideWindow(pb_Golov)
.head 5 -  Call SalHideWindow(DAT1)
.head 5 -  Call SalHideWindow(sDAT1)
.head 5 -  Call SalSetWindowText(hWndForm, "Поточні курси купівлі-продажу валют для відділення, що встановлені Головним Банком")
.head 4 +  Else !! установка
.head 5 -  !
.head 5 -  Set KPK.strSqlInsert = "
    INSERT
    INTO   CUR_RATES_TOBO (kv,tobo,vdate,BSUM,RATE_B,RATE_S)
                   VALUES (:KPK.KV,:KPK.TOBO,:KPK.VDATE,:KPK.BSUM,:KPK.KUP,:KPK.PROD)"
.head 5 -  !
.head 5 -  Set KPK.strSqlDelete = "
    DELETE
    FROM   CUR_RATES_TOBO
    WHERE  kv=:KPK.KV and tobo=:KPK.TOBO and VDATE=:KPK.VDATE and VDATE+3>=BANKDATE"
.head 5 +  If nHaveTOBO = 2
.head 6 -  Set KPK.strSqlUpdate = "
    UPDATE cur_rates$base
    SET    RATE_B=:KPK.KUP,RATE_S=:KPK.PROD
    WHERE  kv=:KPK.KV and branch=:KPK.TOBO and VDATE=:KPK.VDATE and VDATE+3>=BANKDATE"
.head 5 +  Else
.head 6 -  Set KPK.strSqlUpdate = "
    UPDATE CUR_RATES_TOBO
    SET    RATE_B=:KPK.KUP,RATE_S=:KPK.PROD
    WHERE  kv=:KPK.KV and tobo=:KPK.TOBO and VDATE=:KPK.VDATE and VDATE+3>=BANKDATE"
.head 5 +  If nPar = 3
.head 6 -  Call SalSetWindowText(hWndForm, "Установка курсів КУПІВЛІ та продажу ВАЛЮТИ в відділенні банку")
.head 6 -  Call SalHideWindow(TOBO)
.head 6 -  Call SalHideWindow(NAMT)
.head 6 +  If sTOBO = STRING_Null or sTOBO = '0'
.head 7 -  Call SalWaitCursor(FALSE)						
.head 7 -  Call MessageNoWait('Функція може бути використана ТІЛЬКИ в відділенні банку', 'УВАГА!', 17, 1)
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 +  If nHaveTOBO = 2
.head 5 -  ! Call SalHideWindow(pb_Blank)
.head 5 -  Call SalDisableWindow(TOBO)
.head 5 -  Call SalDisableWindow(KV)
.head 5 -  Call SalDisableWindow(VDATE)
.head 5 -  Call SalDisableWindow(TOBO)
.head 5 -  Call SalDisableWindow(BSUM)
.head 5 -  Call SalDisableWindow(pbIns)
.head 5 -  Call SalDisableWindow(pbDel)
.head 4 -  Set cb_Arch = 0
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set dfCount = 0
.head 4 +  If nPar = 0 or nPar = 3
.head 5 +  If Len(SalStrTrimX(strPar01)) = 0
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 +  If fFilterAtStart
.head 7 -  Set fFilterAtStart = NOT fFilterAtStart
.head 7 -  Call SetQueryFilter(cF)
.head 6 -  Set sFilter = ""
.head 6 -  Set sFilter = cF.GetFilterWhereClause(FALSE)
.head 6 -  Call SalWaitCursor(TRUE)
.head 5 +  Else
.head 6 -  Set sFilter = SalStrTrimX(strPar01)
.head 4 +  If nPar = 1 !! только просмотр
.head 5 +  If sTOBO != STRING_Null
.head 6 -  ! Set KPK.strSqlPopulate = "
    SELECT t.KV,t.LCV,t.name,b.TOBO,b.NAME,CUR_RATES_TOBO.VDATE,CUR_RATES_TOBO.BSUM,CUR_RATES_TOBO.RATE_B,
           CUR_RATES_TOBO.RATE_S
    INTO   :KPK.KV,:KPK.LCV,:KPK.NAMV,:KPK.TOBO,:KPK.NAMT,:KPK.VDATE,:KPK.BSUM,:KPK.KUP,:KPK.PROD
    FROM   tabval t, TOBO b, CUR_RATES_TOBO
    WHERE  " || IifS(sFilter = "","", sFilter || " and ") ||
           "(CUR_RATES_TOBO.VDATE=trunc(sysdate) or
             CUR_RATES_TOBO.VDATE=trunc(sysdate+1) or
             CUR_RATES_TOBO.VDATE=trunc(sysdate+2) or
             CUR_RATES_TOBO.VDATE=trunc(sysdate+3) or
             CUR_RATES_TOBO.VDATE=trunc(sysdate+4)) and t.kv=CUR_RATES_TOBO.kv and
            CUR_RATES_TOBO.tobo=b.TOBO and b.TOBO='"|| sTOBO || "'
    ORDER by 6,1"
.head 6 -  Set KPK.strSqlPopulate = "
    SELECT t.KV,t.LCV,t.name,b.TOBO,b.NAME,greatest(CUR_RATES_TOBO.VDATE,trunc(sysdate)),CUR_RATES_TOBO.BSUM,
           CUR_RATES_TOBO.RATE_B,CUR_RATES_TOBO.RATE_S
    INTO   :KPK.KV,:KPK.LCV,:KPK.NAMV,:KPK.TOBO,:KPK.NAMT,:KPK.VDATE,:KPK.BSUM,:KPK.KUP,:KPK.PROD
    FROM   tabval t, TOBO b, CUR_RATES_TOBO
    WHERE  " || IifS(sFilter = "","", sFilter || " and ") ||
           "(trunc(CUR_RATES_TOBO.VDATE)=(select trunc(max(vdate))
                                          from   CUR_RATES_TOBO
                                          where  kv=t.kv and tobo=b.tobo and trunc(vdate)<=trunc(sysdate)) or
             trunc(CUR_RATES_TOBO.VDATE)=trunc(sysdate+1) or trunc(CUR_RATES_TOBO.VDATE)=trunc(sysdate+2) or
             trunc(CUR_RATES_TOBO.VDATE)=trunc(sysdate+3) or trunc(CUR_RATES_TOBO.VDATE)=trunc(sysdate+4)) and
            t.kv=CUR_RATES_TOBO.kv and CUR_RATES_TOBO.tobo=b.TOBO and b.TOBO='"|| sTOBO || "'
    ORDER by 6,1"
.head 4 +  Else If nPar = 2 !! только просмотр 2
.head 5 +  If sTOBO != STRING_Null
.head 6 -  Set KPK.strSqlPopulate = "
    SELECT t.KV,t.LCV,t.name,b.TOBO,b.NAME,CUR_RATES_TOBO.VDATE,CUR_RATES_TOBO.BSUM,CUR_RATES_TOBO.RATE_B,
           CUR_RATES_TOBO.RATE_S
    INTO   :KPK.KV,:KPK.LCV,:KPK.NAMV,:KPK.TOBO,:KPK.NAMT,:KPK.VDATE,:KPK.BSUM,:KPK.KUP,:KPK.PROD
    FROM   tabval t, TOBO b, CUR_RATES_TOBO
    WHERE  " || IifS(sFilter = "","", sFilter || " and ") || "trunc(CUR_RATES_TOBO.VDATE)=bankdate and
           t.kv=CUR_RATES_TOBO.kv and CUR_RATES_TOBO.tobo=b.TOBO and b.TOBO='"|| sTOBO || "'
    ORDER by 6,1"
.head 4 +  Else If nPar = 3 !! установка в отделении
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT NVL(max(trunc(VDATe))+:nDem,trunc(sysdate))
   INTO   :DAT1
   FROM   CUR_RATES_TOBO
   WHERE  tobo=:sTOBO") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalSendMsg(DAT1, SAM_Validate, 0, 0)
.head 5 -  Set KPK.strSqlPopulate = "
    SELECT t.KV,t.LCV,t.name name1,b.TOBO,b.NAME name2,CUR_RATES_TOBO.VDATE,CUR_RATES_TOBO.BSUM,CUR_RATES_TOBO.RATE_B,
           CUR_RATES_TOBO.RATE_S
    INTO   :KPK.KV,:KPK.LCV,:KPK.NAMV,:KPK.TOBO,:KPK.NAMT,:KPK.VDATE,:KPK.BSUM,:KPK.KUP,:KPK.PROD
    FROM   tabval t, TOBO b, CUR_RATES_TOBO
    WHERE  " || IifS(sFilter="", "", sFilter || " and ") || "t.kv=CUR_RATES_TOBO.kv and
           CUR_RATES_TOBO.tobo=b.TOBO and b.tobo=:sTOBO
    ORDER BY 6 desc,4,1"
.head 4 +  Else !! установка
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT NVL(max(trunc(VDATe))+:nDem,trunc(sysdate))
   INTO   :DAT1
   FROM   CUR_RATES_TOBO") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalSendMsg(DAT1, SAM_Validate, 0, 0)
.head 5 -  ! Set KPK.strSqlPopulate = "
    SELECT t.KV,t.LCV,t.name name1,b.TOBO,b.NAME name2,CUR_RATES_TOBO.VDATE,CUR_RATES_TOBO.BSUM,CUR_RATES_TOBO.RATE_B,
           CUR_RATES_TOBO.RATE_S
    INTO   :KPK.KV,:KPK.LCV,:KPK.NAMV,:KPK.TOBO,:KPK.NAMT,:KPK.VDATE,:KPK.BSUM,:KPK.KUP,:KPK.PROD
    FROM   tabval t,TOBO b,CUR_RATES_TOBO
    WHERE  " || IifS(sFilter="", "", sFilter || " and ") || "t.kv=CUR_RATES_TOBO.kv and CUR_RATES_TOBO.tobo=b.TOBO" ||
           IifS(cb_Arch=0, " and CUR_RATES_TOBO.VDATE+3>=:bDat", "") || "
    ORDER BY 6 desc,4,1"
.head 5 -  Set KPK.strSqlPopulate = "
    SELECT t.KV,t.LCV,t.name name1,b.TOBO,b.NAME name2,greatest(CUR_RATES_TOBO.VDATE,trunc(sysdate)),CUR_RATES_TOBO.BSUM,
           CUR_RATES_TOBO.RATE_B,CUR_RATES_TOBO.RATE_S
    INTO   :KPK.KV,:KPK.LCV,:KPK.NAMV,:KPK.TOBO,:KPK.NAMT,:KPK.VDATE,:KPK.BSUM,:KPK.KUP,:KPK.PROD
    FROM   tabval t,TOBO b,CUR_RATES_TOBO
    WHERE  " || IifS(sFilter="", "", sFilter || " and ") || "t.kv=CUR_RATES_TOBO.kv and
           CUR_RATES_TOBO.VDATE=(select max(vdate)
                                 from   CUR_RATES_TOBO
                                 where  kv=t.kv and tobo=b.tobo and trunc(vdate)<=trunc(sysdate)) and
           CUR_RATES_TOBO.tobo=b.TOBO " || IifS(cb_Arch=0, " and CUR_RATES_TOBO.VDATE+3>=:bDat", "") || "
    ORDER BY 6 desc,4,1"
.head 5 -  ! 1111
.head 4 -  ! Call Debug('KPK.strSqlPopulate='||KPK.strSqlPopulate)
.head 4 -  ! Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 4 -  ! Call Debug('KPK.strSqlPopulate = ' || KPK.strSqlPopulate)
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), KPK.strSqlPopulate, TBL_FillAll)
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Call XSalTblSetCellBackColor(KUP, SalColorFromRGB(230, 255, 230))
.head 4 -  Call XSalTblSetCellBackColor(PROD, COLOR_Sky)
.head 4 -  Call XSalTblSetCellBackColor(RATE_O, COLOR_LightGray)
.head 4 +  If SqlPrepareAndExecute(hSqlAux2(), "
   SELECT c.RATE_O,trunc(C.VDATE)
   INTO   :KPK.RATE_O,:KPK.VDATEO
   FROM   cur_rates c
   WHERE  c.kv=:KPK.KV and c.VDATE=(SELECT max(VDATE)
                                    FROM (SELECT min(vdate) VDATE
                                          FROM   cur_rates
                                          WHERE  kv=:KPK.KV and trunc(vdate)>=:KPK.VDATE and official='Y'
                                          UNION ALL
                                          SELECT max(vdate)
                                          FROM   cur_rates
                                          WHERE  kv=:KPK.KV and trunc(vdate)<:KPK.VDATE and official='Y'))") and
   SqlFetchNext(hSqlAux2(), nFetchRes)
.head 5 -  ! Set KPK.RATE_O = KPK.RATE_O * KPK.BSUM
.head 4 -  Set dfCount = dfCount + 1
.head 1 +  ! Form Window: KP 
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    0.438"
.head 4 -  Width:  13.783"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.643"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -  Description: Комунальные платежи
.head 2 -  Named Menus 
.head 2 -  Menu 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Contents 
.head 4 -  ! ! ПЕЧАТЬ тикетов:
1.Нахальная перчать :
  Тикеты на комисии и
  Тикеты на основные платежи ГОЛУБОЙ таблицы
  печатаются автоматически в момент оплаты (на лист)
2 F5 - печать всех тикетов (осн, ком) на лист
3.Двойным щелчком ЛЕВОЙ мышки на оплаченной строке (ЗЕЛЕНОЙ и ГОЛУБОЙ)
                  печатается тикет на осн.платеж  (оттиск)
4.Щелчком ПРАВОЙ мышки на оплаченной строке с комис (ЗЕЛЕНОЙ и ГОЛУБОЙ)
                  печатается тикет на ком.платеж (на случай замятия)
.head 4 +  Option Button: pbRef
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\TUDASUDA.BMP
.head 5 -  Picture Transparent Color: White
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Light Green
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Відкрити/Закрити колонки Референсів' )
.head 6 +  On SAM_Click
.head 7 -  Call F_Ref( not pbRef)
.head 4 +  Pushbutton: pb_F10
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Maize
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F10. Ввести '
.head 6 +  On SAM_Click
.head 7 +  If STOTAL > 0 and F_Opl
.head 8 -  Set F_Opl = FALSE
.head 8 -  Call SqlCommit( hSql() )
.head 8 -  Call SalDisableWindow( pb_F1 )
.head 8 -  Call SalDisableWindow( pb_F2 )
.head 8 -  Call SalDisableWindow( pb_F3 )
.head 8 -  Call SalDisableWindow( pb_F4 )
.head 8 -  Call SalDisableWindow( pb_F8 )
.head 8 -  Call SalDisableWindow( pb_F9)
.head 8 +  If f_Opl(rS)
.head 9 -  Call F_Ref (1)
.head 9 -  Call SqlCommit( hSql() )
.head 9 -  Call SalEnableWindow( pbRef )
.head 9 -  If SalStrUpperX( Subs(strPar02,1,1) )='N' ! нахальная печать NO
.head 9 +  Else ! YES
.head 10 -  Call F_Print(1)
.head 9 -  Call SalDisableWindow( T1.S )
.head 9 -  Call SalDisableWindow( T1.P )
.head 9 -  Call SalDisableWindow( T2.S )
.head 9 -  Call SalDisableWindow( T2.P )
.head 9 -  Call SalDisableWindow( T2.NAMK )
.head 9 -  Call SalDisableWindow( T2.MFOK )
.head 9 -  Call SalDisableWindow( T2.OKPOK )
.head 9 -  Call SalDisableWindow( T2.NLSK )
.head 9 -  Call SalDisableWindow( pb_F10 )
.head 9 -  Call SalDisableWindow( D1 )
.head 9 -  Call SalTblReset( D1 )
.head 9 -  !
.head 9 -  Call MessageNoWait('Введено пачку документів ','Повідомлення',3,0)
.head 9 -  Call SalEnableWindow( pb_F5 )
.head 9 -  !
.head 8 +  Else 
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SalDisableWindow( pbRef )
.head 9 -  Set F_Opl = TRUE
.head 9 -  Call SalEnableWindow( pb_F1 )
.head 9 -  Call SalEnableWindow( pb_F2 )
.head 9 -  Call SalEnableWindow( pb_F3 )
.head 9 -  Call SalEnableWindow( pb_F4 )
.head 9 -  Call SalEnableWindow( pb_F8 )
.head 9 -  Call SalEnableWindow( pb_F9)
.head 9 -  Call MessageNoWait( IifS( rS !=NUMBER_Null, 'Сума док='||Str(rS), '' )|| sErr, 'Помилка !', 0, 1)
.head 4 +  Pushbutton: pb_F5
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Maize
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F5. Надрукувати ПАЧКУ оплачених документів'
.head 6 +  On SAM_Click
.head 7 -  Call F_Print(2)
.head 4 +  Pushbutton: pb_Print1
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.067"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\DOC.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 
'Page
Down - Надрукувати квитанцію на поточний введений документ'
.head 6 +  On SAM_Click
.head 7 +  If nTAB = 1 and T1.S != NUMBER_Null 
.head 8 +  If f_Prov1()
.head 9 -  Call F_Ottisk(T1.NAMK, dFIO, T1.S, T1.S2)
.head 9 -  ! Number: nSUMB
.head 9 -  ! Number: nSUMBK
.head 8 +  ! Else
.head 9 -                                                                            Call MessageNoWait( 'Сума док='|| Str(T1.S ) || sErr, 'Помилка !', 0, 1)
.head 7 +  Else If nTAB = 2 and T2.S != NUMBER_Null 
.head 8 +  If f_Prov2()
.head 9 -  Call F_Ottisk(T2.NAMK, dFIO, T2.S, T2.S2)
.head 8 +  ! Else
.head 9 -                                                                            Call MessageNoWait( 'Сума док='|| Str(T2.S )|| sErr, 'Помилка !', 0, 1)
.head 4 +  Pushbutton: pb_New
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Maize
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Новий '
.head 6 +  On SAM_Click
.head 7 -  Set F_Opl = FALSE
.head 7 -  Call F_tts()
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.9"
.head 6 -  Begin Y:  -0.06"
.head 6 -  End X:  1.9"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.end
.head 4 +  Pushbutton: pbK_Val
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Periwinkle
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Купівля ВАЛЮТИ. Оп.'||AA1
.head 6 +  On SAM_Click
.head 7 -  Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'K_', NLS_CASH, AA1,dFIO, DatVal, pb_Exit, b840, b978, b643 )
.head 4 +  Pushbutton: pbP_Val
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.433"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Salmon
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Продаж ВАЛЮТИ. Оп.'|| AA2
.head 6 +  On SAM_Click
.head 7 -  Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'P_', NLS_CASH, AA2,dFIO, DatVal, pb_Exit, b840, b978, b643 )
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.95"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  2.95"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.end
.head 4 +  Pushbutton: pb_Exit
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.05"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'ESC. Завершити  '
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  ! !
.head 4 +  Pushbutton: pb_Null
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.405"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Data Field: BankName
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.183"
.head 7 -  Top:    0.048"
.head 7 -  Width:  2.967"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 4 +  Data Field: BankOkpo
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.617"
.head 7 -  Top:    0.048"
.head 7 -  Width:  2.067"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 4 +  Data Field: BankMfo
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.15"
.head 7 -  Top:    0.048"
.head 7 -  Width:  1.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 4 -  ! !
.head 4 +  Data Field: DatVal
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.8"
.head 7 -  Top:    0.095"
.head 7 -  Width:  1.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 4 +  Data Field: NLS_CASH
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.1"
.head 7 -  Top:    0.095"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Рахунок каси')
.head 4 +  Data Field: NMS_CASH
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.5"
.head 7 -  Top:    0.095"
.head 7 -  Width:  3.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 4 -  !
.head 4 +  Pushbutton: pb_F11
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.65"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F11
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Red
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F11.Установити фокус на "ПРИЙНЯТО" '
.head 6 +  On SAM_Click
.head 7 -  Call SalSetFocus( SNAL )
.head 4 +  Pushbutton: pbHelp
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.133"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F12
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Help.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Maize
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow( hWndItem )
.head 7 -  Set strTip = 'F12.Вибрати доп.реквізит з базового довідника'
.head 6 +  On SAM_Click
.head 7 +  If nBROWSER = 1
.head 8 -  Set sTmp = D1.VALUE
.head 7 +  Else 
.head 8 -  Set sTmp = D2.VALUE
.head 7 -  Call SalModalDialog( dlgTagBrowse1, KP , gBROWSER, sTmp )
.head 7 +  If nBROWSER = 1
.head 8 -  Set D1.VALUE = sTmp
.head 8 -  Call SalSendMsg( D1.VALUE, SAM_Validate, 0, 0 )
.head 7 +  Else 
.head 8 -  Set D2.VALUE = sTmp
.head 8 -  Call SalSendMsg( D2.VALUE, SAM_Validate, 0, 0 )
.head 4 +  Pushbutton: pb_F6
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F6
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BF6_.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Maize
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F6.Наслідувати доп.реквізити (*) з поперед.операції'
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute( hSql(),
  "UPDATE tmp_operw t
   SET value = (select MAX(value) from tmp_operw where tag=t.tag and value is not null) 
WHERE value is null and 
      tt=decode(:nTAB,1,:T1.TT, :T2.TT) and nom=decode(:nTAB,1,:T1.NOM,:T2.NOM) and
 tag in (select tag from OP_FIELD where substr(name,1,1)='*') ")
.head 8 -  Set nNOM = -1
.head 8 +  If nTAB = 2
.head 9 -  Call SalSetFocus( T2 )
.head 9 -  Call SalTblSetFocusRow( T2, nRow2 )
.head 9 -  Call SalSendMsg( T2, SAM_RowSetContext, 0, 0 )
.head 8 +  Else 
.head 9 -  Call SalSetFocus( T1 )
.head 9 -  Call SalTblSetFocusRow( T1, nRow1 )
.head 9 -  Call SalSendMsg( T1, SAM_RowSetContext, 0, 0 )
.head 2 +  Contents 
.head 3 +  Pushbutton: pb_F1
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    0.012"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F1
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF1_.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Green
.head 4 -  Background Color: Light Green
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F1.Розмножити БЛАНК ОТРИМУВАЧА '
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (1)
.head 6 -  Call SalSetFocus(pb_F2)
.head 6 -  Call SalSetFocus(T1)
.head 6 -  Call SalTblSetFocusRow(T1, nRow )
.head 6 -  Call SalTblSetFocusCell(T1, nRow, T1.S, 0, -1)
.head 3 +  Pushbutton: pb_F4
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.567"
.head 5 -  Top:    0.0"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F4
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF4_.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Green
.head 4 -  Background Color: Green
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F4. Розмножити з реквізитами ПЛАТНИКА '
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (4)
.head 6 -  Call SalSetFocus(pb_F2)
.head 6 -  Call SalSetFocus(T1)
.head 6 -  Call SalTblSetFocusRow(T1, nRow )
.head 6 -  Call SalTblSetFocusCell(T1, nRow, T1.S, 0, -1)
.head 3 -  !
.head 3 +  Pushbutton: pb_F2
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    2.143"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F2
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF2_.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Green
.head 4 -  Background Color: Sky
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F2.Розмножити БЛАНК'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (2)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 +  Pushbutton: pb_F3
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    2.143"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F3
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF3_.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Green
.head 4 -  Background Color: Light Aqua
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F3.Розмножити з реквізитами ОТРИМУВАЧА'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (3)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 +  Pushbutton: pb_F8
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.033"
.head 5 -  Top:    2.143"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F8
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF8_.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Light Periwinkle
.head 4 -  Background Color: Cyan
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F8.Розмножити з реквізитами ПЛАТНИКА'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (8)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 +  Pushbutton: pb_F9
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.483"
.head 5 -  Top:    2.143"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F9
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF9_.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Light Periwinkle
.head 4 -  Background Color: Dark Aqua
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F9.Розмножити з реквізитами ОТРИМУВАЧА та ПЛАТНИКА'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (9)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 -  !
.head 3 +  Child Table: T1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    0.321"
.head 6 -  Width:  8.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: NOM
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: TT
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Оп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: SKP
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СК
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: NAMK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отримувач по ГЕН.Угоді
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: NLSK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: OKPOK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОКПО-Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: S
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Платіж
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_AnyEdit
.head 8 +  If T1.S != NUMBER_Null
.head 9 -  Call SalMapEnterToTab( FALSE )
.head 8 +  Else 
.head 9 -  Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 -  Call KP.f_Tochka ( 1, T1.S, NLS_CASH, BankMfo, NLSK, T1.S, T1.fS2 )
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_Enter and T1.S != NUMBER_Null
.head 9 -  Call SalSetFocus(NAZN1)
.head 9 -  ! Call SalSetFocus(D1)
.head 9 -  ! Call SalTblSetFocusRow(D1,0)
.head 9 -  ! Call SalTblSetFocusCell(D1, 0, D1.VALUE, 0, -1)
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( pb_Print1, COLOR_IndexWindow, COLOR_LightGreen )
.head 7 -  !
.head 5 +  Column: S2
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ком
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: REF1
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-1
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: REF2
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-2
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: VOB
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VOB
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: NAM_TT
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: NAZ_TT
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: TT2
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Доч оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: fS2
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Форм ком
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: P
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пеня
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: NAM_FIO
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: NFILE
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 +  Functions 
.head 5 +  Function: f1
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nTAB = 1
.head 7 -  Set NAZN1 = IifS( T1.NAZ_TT = STRING_Null, T1.NAM_TT, T1.NAZ_TT )
.head 7 -  Set NAM_TT1 = T1.NAM_TT
.head 7 +  If T1.TT = sTT and T1.NOM = nNOM 
.head 8 -  Return TRUE
.head 7 -  !
.head 7 -  Set sTT = T1.TT
.head 7 -  Set nNOM = T1.NOM
.head 7 -  Set sNAMK= T1.NAMK
.head 7 -  Set nRow = SalTblQueryContext( T1 )
.head 7 -  Set nRow1  = nRow
.head 7 +  If nRow > 13
.head 8 -  Set nRow = 13
.head 7 -  !
.head 7 -  Call SalTblPopulate(D1, hSql(),
 "SELECT o.tag, o.value, f.name, f.CHKR,  f.BROWSER, o.DVAL, o.OPT 
  INTO :D1.TAG, :D1.VALUE, :D1.NAM_TAG, :D1.CHKR, :D1.BROWSER, :D1.DVAL, :D1.OPT 
  FROM tmp_operw o, OP_FIELD f
  WHERE o.tag=f.tag and o.tt=:T1.TT and o.nom = :T1.NOM 
  ORDER BY ord " , TBL_FillAll)
.head 7 -  Call SalTblSetContext( D1, 0 )
.head 7 -  Call SalTblSetRowFlags( D1, 0, ROW_Selected, TRUE )
.head 7 -  Call SalSendMsg( D1, SAM_RowSetContext, 0,0)
.head 7 -  Call SalEnableWindow (D1)
.head 7 -  Call SalDisableWindow (D2)
.head 7 -  Call SalDisableWindow (NAZN2)
.head 7 -  Return TRUE
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 -  ! Подвести доп.табл
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags( KP.T1, TBL_Flag_SelectableCols, TRUE )
.head 5 +  On SAM_SetFocus
.head 6 -  Call T1.f1( )
.head 5 +  On SAM_RowSetContext
.head 6 -  Call T1.f1( )
.head 5 -  ! Печатать тикет
.head 5 +  On SAM_DoubleClick
.head 6 +  If T1.REF1 != NUMBER_Null 
.head 7 -  Call DocsPrint ( T1.REF1, 'OPER', FALSE )
.head 5 +  On WM_RbuttonUp
.head 6 +  If T1.REF2 != NUMBER_Null 
.head 7 -  Call DocsPrint ( T1.REF2, 'OPER', FALSE )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd1 = not bSortOrd1
.head 6 -  Call SalTblSortRows( KP.T1 , SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd1 )
.head 3 +  Data Field: NAM_TT1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Назва операції')
.head 3 -  Background Text: Признач.пл.-1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.2"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: NAZN1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    0.071"
.head 6 -  Width:  5.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Призначення платежу-1')
.head 5 +  On SAM_Validate
.head 6 -  Set T1.NAZ_TT = NAZN1
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_SetFocus
.head 6 +  If NAZN1 = STRING_Null
.head 7 -  Set NAZN1 = T1.NAM_TT
.head 6 -  Call SalMapEnterToTab( FALSE )
.head 5 -  !
.head 5 +  On VTM_KeyUp
.head 6 +  If wParam = VK_Enter
.head 7 -  Call SalSetFocus(D1)
.head 7 -  Call SalTblSetFocusRow(D1,0)
.head 7 -  Call SalTblSetFocusCell(D1, 0, D1.VALUE, 0, -1)
.head 3 +  Child Table: D1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.9"
.head 6 -  Top:    0.31"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.762"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: TAG
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: TAG
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: NAM_TAG
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вопрос
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: VALUE
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Деталі
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalMapEnterToTab( TRUE )
.head 8 -  Set nBROWSER = 1
.head 8 +  If Subs(D1.TAG,1,3)='FIO' and  dFIO !=STRING_Null
.head 9 -  Set D1.VALUE = dFIO
.head 9 -  Set T1.NAM_FIO = dFIO
.head 9 -  If SqlPrepareAndExecute( hSql(), 
  "update tmp_operw set VALUE =:D1.VALUE where tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM ")
.head 8 +  ! If Subs(D1.TAG,1,3)='FIO' and D1.VALUE = STRING_Null and dFIO !=STRING_Null
.head 9 -                                            Set D1.VALUE = dFIO
.head 9 -                                            Set T1.NAM_FIO = dFIO
.head 9 -                                            If SqlPrepareAndExecute( hSql(), 
  "update tmp_operw set VALUE =:D1.VALUE where tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM ")
.head 8 -  Call F_Focus (D1.DVAL, D1.BROWSER)
.head 7 +  On SAM_Validate
.head 8 -  Set D1.VALUE = SalStrTrimX( D1.VALUE )
.head 8 -  If not F_Tag( D1.CHKR, SalStrTrimX(D1.TAG), SalStrTrimX(D1.VALUE), D1.OPT  )
.head 8 -  If SqlPrepareAndExecute( hSql(), 
  "update tmp_operw set VALUE =:D1.VALUE where tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM ")
.head 8 +  If Subs(D1.TAG,1,3)='?LC' 
.head 9 +  If SalIsValidNumber( D1.VALUE )
.head 10 -  Set nLC = Val(D1.VALUE)
.head 10 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT S, fio, Nvl(TAG,0)  
   INTO :T1.S, :dFIO , :nTag
   FROM KP_FILE
   WHERE tt=:T1.TT and lc=:nLC ")
and not SqlFetchNext( hSql(), nFetchRes ) 
.head 11 -  Call SalMessageBox(" LC="|| D1.VALUE ||" не знайдено в БД (KP_FILE), tt=" ||T1.TT ,
 "УВАГА !", MB_IconStop )
.head 10 +  Else 
.head 11 -  Set T1.NAM_FIO = dFIO
.head 11 -  Call SalSendMsg( T1.S, SAM_Validate, 0, 0 )
.head 11 +  If nTag = 1
.head 12 -  Set nRowD1 = TBL_MinRow
.head 12 +  While SalTblFindNextRow( D1, nRowD1, 0, 0 )
.head 13 -  Call SalTblSetContext( D1, nRowD1 )
.head 13 -  If SqlPrepareAndExecute( hSql(),
"SELECT value INTO :D1.VALUE 
 FROM KP_TAG where TT=:T1.TT and LC=:nLC and TAG=:D1.TAG")
and SqlFetchNext( hSql(), nFetchRes )
and SqlPrepareAndExecute( hSql(), 
"UPDATE tmp_operw
 SET VALUE =:D1.VALUE
 WHERE tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM")
.head 9 +  Else 
.head 10 -  Call SalMessageBox(" LC="|| D1.VALUE ||" НЕ число ! ", "УВАГА !", MB_IconStop )
.head 8 +  If Subs(D1.TAG,1,3)='FIO' 
.head 9 -  Set T1.NAM_FIO = dFIO
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_PageDown and T1.S != NUMBER_Null
.head 9 -  Call SalSendMsg( pb_Print1, SAM_Click, 0, 0 )
.head 5 +  Column: CHKR
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: BROWSER
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: DVAL
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: OPT
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 +  Window Variables 
.head 5 -  Number: nTag
.head 5 -  Number: nRowD1
.head 4 +  Message Actions 
.head 5 +  On SAM_FetchRowDone
.head 6 +  If OPT !='O'
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Green ) 
.head 6 +  Else 
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, nCol1 ) 
.head 5 +  On SAM_RowSetContext
.head 6 -  Call SalTblSetColumnTitle( D1.VALUE, D1.NAM_TAG )
.head 6 -  Call SalSendMsg( D1.VALUE, SAM_SetFocus, 0, 0 )
.head 5 -  On SAM_SetFocus
.head 3 -  !
.head 3 -  !
.head 3 +  Child Table: T2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    2.548"
.head 6 -  Width:  8.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.393"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: NOM
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: TT
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Оп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: SKP
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СК
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  ! On SAM_SetFocus
.head 8 +  ! If SKP =NUMBER_Null
.head 9 -                                                                                                         Set T2.SKP = 5
.head 8 -                                                                                             Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 -  Set dTmp ='Помилка СКП'
.head 8 +  If SqlPrepareAndExecute( hSql(), "SELECT name INTO :dTmp from sk where sk=:T2.SKP and sk <40 " ) 
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Return VALIDATE_Ok
.head 8 -  Return VALIDATE_Cancel
.head 5 +  Column: NAMK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: безпосередній Отримувач
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.617"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  ! On SAM_SetFocus
.head 8 -  ! Call T2.f1()
.head 8 -                                                                                             Call SalMapEnterToTab( TRUE )
.head 5 +  Column: MFOK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_SetFocus
.head 8 +  If FLI = 0 and MFOK = STRING_Null and KP_SIGN =1
.head 9 -  Set MFOK = BankMfo 
.head 9 -  Set dTmp = BankName
.head 8 -  ! Call T2.f1()
.head 8 -  ! Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 +  If T2.MFOK = STRING_Null
.head 9 -  Set S =0 
.head 9 -  Call SalSendMsg( T2.S, SAM_AnyEdit, 0, 0 )
.head 9 -  Call SalSendMsg( T2.S, SAM_Validate, 0, 0 )
.head 9 -  Return VALIDATE_Ok
.head 8 +  If T2.MFOK = BankMfo
.head 9 -  Set dTmp = BankName
.head 8 +  If FLI = 0 and MFOK !=BankMfo 
or T2.MFOK != STRING_Null and 
   SqlPrepareAndExecute( hSql(),"SELECT nb INTO :dTmp from banks where mfo=:T2.MFOK" )
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Return VALIDATE_Ok
.head 8 -  !
.head 8 -  Set dTmp ='Помилка МФО-Б'
.head 8 -  Return VALIDATE_Cancel
.head 5 +  Column: NLSK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  ! On SAM_SetFocus
.head 8 -  ! Call T2.f1()
.head 8 -                                                                                             Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 +  If T2.NLSK != STRING_Null and T2.NLSK != KeyAccount(T2.MFOK,T2.NLSK) 
or T2.MFOK = BankMfo and 
SqlPrepareAndExecute( hSql(),"SELECT a.nms, c.okpo INTO :T2.NAMK,:T2.OKPOK 
 FROM accounts a, cust_acc u, customer c
 WHERE a.kv=:n980 and a.nls=:T2.NLSK and a.acc=u.acc and u.rnk=c.rnk " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Set dTmp ='Помилка Рах-Б'
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set dTmp = STRING_Null
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: OKPOK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ід.код-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  ! On SAM_SetFocus
.head 8 -  ! Call T2.f1()
.head 8 -                                                                                             Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 +  If T2.OKPOK != STRING_Null and T2.OKPOK != V_Okpo(T2.OKPOK)
.head 9 -  Set dTmp ='Помилка Ід.код-Б'
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set dTmp = STRING_Null
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: S
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Платіж
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_AnyEdit
.head 8 +  If T2.S != NUMBER_Null
.head 9 -  Call SalMapEnterToTab( FALSE )
.head 8 +  Else 
.head 9 -  Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 -  Call KP.f_Tochka ( 2, T2.S, NLS_CASH, MFOK, NLSK, T2.S, T2.fS2 )
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_Enter and T2.S != NUMBER_Null
.head 9 -  Call SalSetFocus(NAZN2)
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( pb_Print1, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  Column: S2
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ком
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: VOB
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VOB
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: REF1
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-1
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: REF2
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-2
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: NAM_TT
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: NAZ_TT
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: TT2
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Доч оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: fS2
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Форм ком
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: P
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пеня
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: FLI
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Флаг МБ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: NAM_FIO
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 -  !
.head 4 +  Functions 
.head 5 +  Function: f1
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nTAB = 2
.head 7 -  Set NAZN2 = T2.NAZ_TT
.head 7 -  Set NAM_TT2 =T2.NAM_TT
.head 7 +  If T2.TT = sTT and T2.NOM = nNOM 
.head 8 -  Return TRUE
.head 7 -  !
.head 7 -  Set sTT = T2.TT
.head 7 -  Set nNOM = T2.NOM
.head 7 -  Set sNAMK= T2.NAMK
.head 7 -  Set nRow = SalTblQueryContext( T2 )
.head 7 -  Set nRow2  = nRow
.head 7 +  If nRow > 2
.head 8 -  Set nRow =2
.head 7 -  !
.head 7 -  Call SalTblPopulate(D2, hSql(),
 "SELECT o.tag, o.value, f.name, f.CHKR, f.BROWSER, o.DVAL, o.OPT
  INTO :D2.TAG, :D2.VALUE, :D2.NAM_TAG, :D2.CHKR, :D2.BROWSER, :D2.DVAL, :D2.OPT 
  FROM tmp_operw o, OP_FIELD f
  WHERE o.tag=f.tag and o.tt=:T2.TT and o.nom = :T2.NOM 
  ORDER BY ord " , TBL_FillAll)
.head 7 -  Call SalSetFocus( NAZN2 )
.head 7 -  Call SalDisableWindow (D1)
.head 7 -  Call SalEnableWindow (D2)
.head 7 -  Call SalEnableWindow (NAZN2)
.head 7 -  Return TRUE
.head 5 +  Function: f_ALIEN
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: FLI       ! флаг межбанк
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sTmp
.head 7 -  String: sNSI
.head 6 +  Actions 
.head 7 -  Set dTmp = STRING_Null
.head 7 -  Set sNSI = " kv=" || Str(n980) || " and NLSALT is not null "
.head 7 +  If KP_SIGN =1 
.head 8 -  Set sNSI = sNSI || " and  mfo " || IifS( FLI=1, "<>", "=" ) || BankMfo
.head 7 -  Set sNSI = sNSI || " order by nlsalt "
.head 7 -  Call FunNSIGetFiltered('ALIEN','NLSALT', sNSI, sTmp, sNlsAlt )
.head 7 +  If sTmp =  STRING_Null
.head 8 -  Return FALSE
.head 7 -  Return 
SqlPrepareAndExecute( hSql(), 
   "SELECT MFO, NLS, OKPO, substr(ltrim(rtrim(NAME)),1,38)
    INTO :MFOK, :NLSK, :OKPOK, :NAMK FROM alien WHERE nlsalt=:sNlsAlt " )
and 
SqlFetchNext( hSql(), nFetchRes )
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 -  ! Подвести доп.табл
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags( KP.T2, TBL_Flag_SelectableCols, TRUE )
.head 5 +  On SAM_SetFocus
.head 6 -  Call T2.f1()
.head 5 +  On SAM_RowSetContext
.head 6 -  Call T2.f1()
.head 5 -  ! Печатать тикет
.head 5 +  On SAM_DoubleClick
.head 6 +  If T2.REF1 != NUMBER_Null 
.head 7 -  Call DocsPrint ( T2.REF1, 'OPER', FALSE )
.head 6 +  Else 
.head 7 -  Call T2.f_ALIEN (T2.FLI)
.head 5 +  On WM_RbuttonUp
.head 6 +  If T2.REF2 != NUMBER_Null 
.head 7 -  Call DocsPrint ( T2.REF2, 'OPER', FALSE )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd2 = not bSortOrd2
.head 6 -  Call SalTblSortRows( KP.T2 , SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd2 )
.head 3 +  Data Field: NAM_TT2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    2.155"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Назва операції')
.head 3 +  Data Field: dfTextNAZN2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: NAZN2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    4.024"
.head 6 -  Width:  6.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Cyan
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Призначення платежу-2')
.head 5 +  On SAM_Validate
.head 6 +  If NAZN2 = STRING_Null or SalStrLength( NAZN2 ) < 3
.head 7 -  Call SalMessageBox("Не заповнено Призначення платежу", "Увага !", MB_IconStop)
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set T2.NAZ_TT = NAZN2
.head 6 -  Return VALIDATE_Ok
.head 6 -  !
.head 5 +  On VTM_LeftDoubleClick
.head 6 -  Set sTipNazn = SalStrLeftX( SalStrRightX( '000000'||sNlsAlt, 6 ), 3 )
.head 6 -  ! Set sTipNazn = STRING_Null
.head 6 -  Call FunNSIGetFiltered('ALIEN_NAZN','NAZN', 
    ' IDT= '|| sTipNazn ||' or IDT is null  order by IDN', sTipNazn, NAZN2 )
.head 6 -  Call SalSendMsg( NAZN2, SAM_Validate, 0, 0 )
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( FALSE )
.head 5 +  On VTM_KeyUp
.head 6 +  If wParam = VK_Enter
.head 7 -  Call SalSetFocus(D2)
.head 7 -  Call SalTblSetFocusRow(D2,0)
.head 7 -  Call SalTblSetFocusCell(D2, 0, D2.VALUE, 0, -1)
.head 3 +  Child Table: D2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    2.393"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.524"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: TAG ! 1
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: TAG
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: NAM_TAG ! 2
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вопрос
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: VALUE ! 3
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Деталі
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_SetFocus
.head 8 -  Set nBROWSER = 2
.head 8 +  If Subs(D2.TAG,1,3) ='FIO' and D2.VALUE = STRING_Null and dFIO != STRING_Null
.head 9 -  Set D2.VALUE = dFIO
.head 9 -  Set T2.NAM_FIO = dFIO
.head 9 -  If SqlPrepareAndExecute( hSql(),
  "update tmp_operw set VALUE =:D2.VALUE where tt=:T2.TT and tag=:D2.TAG and nom=:T2.NOM ")
.head 8 -  Call F_Focus (D2.DVAL, D2.BROWSER)
.head 7 +  On SAM_Validate
.head 8 -  If not F_Tag( D2.CHKR, SalStrTrimX(D2.TAG), SalStrTrimX(D2.VALUE), D2.OPT )
.head 8 +  If Subs(D2.TAG,1,3)='FIO' 
.head 9 -  Set T2.NAM_FIO = dFIO
.head 8 -  If SqlPrepareAndExecute( hSql(),
  "update tmp_operw set VALUE =:D2.VALUE where tt=:T2.TT and tag=:D2.TAG and nom=:T2.NOM ")
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_PageDown and T2.S != NUMBER_Null
.head 9 -  Call SalSendMsg( pb_Print1, SAM_Click, 0, 0 )
.head 7 -  !
.head 5 +  Column: CHKR  ! 4
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: BROWSER ! 6
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: DVAL ! 7
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: OPT ! 8
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_FetchRowDone
.head 6 +  If OPT !='O'
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightAqua )
.head 6 +  Else 
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 220,255,255 ) ) ! голубой
.head 5 +  On SAM_RowSetContext
.head 6 -  Call SalTblSetColumnTitle( D2.VALUE, D2.NAM_TAG )
.head 6 -  ! Call SalSendMsg( D2.VALUE, SAM_SetFocus, 0, 0 )
.head 3 +  Data Field: SNAL
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    4.714"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Прийнято у клієнта')
.head 5 +  On SAM_SetFocus
.head 6 +  If SNAL = 0
.head 7 -  Set SNAL = NUMBER_Null
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_KillFocus
.head 6 -  Call KP.f_Tochka ( 0, NUMBER_Null, STRING_Null,STRING_Null,STRING_Null, SNAL,  STRING_Null )
.head 6 +  If STOTAL > 0
.head 7 +  If SNAL < STOTAL or SNAL=NUMBER_Null
.head 8 -  Call SalMessageBox(" НЕДОСТАТЧА коштів, чи помилка суми ! ", "УВАГА !", MB_IconStop)
.head 8 -  Set SNAL = NUMBER_Null
.head 8 -  Set SDEL = 0
.head 7 +  Else 
.head 8 -  Set SDEL = SNAL - STOTAL
.head 8 -  Set ml1 = SumPr(  STOTAL *100, 'F', 'Грн' , "коп" )
.head 8 -  Set ml2 = SumPr(  SDEL *100, 'F', 'Грн' , "коп" )
.head 8 -  Set ml3 = NumberPr( SKOL, "M" )
.head 8 -  Call SalEnableWindow( pb_F10 )
.head 8 -  Set F_Opl = TRUE
.head 5 -  !
.head 3 -  !
.head 3 +  Data Field: NLS_NLK
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.012"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Рахунок-транзит (без ген.угоди)')
.head 3 -  !
.head 3 -  Background Text: Платник
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    4.524"
.head 5 -  Width:  0.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dTmp
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    5.167"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Salmon
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Підказки')
.head 3 +  Data Field: dFIO
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.762"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Cyan
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'ПІБ')
.head 3 +  Data Field: STOTAL
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    4.321"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Сума платежів')
.head 3 +  Data Field: ml1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.167"
.head 6 -  Top:    4.369"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Сума платежів прописом')
.head 3 +  Data Field: SDEL
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    5.119"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Повернути клієнту')
.head 3 +  Data Field: ml2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.15"
.head 6 -  Top:    5.167"
.head 6 -  Width:  4.617"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Повернути клієнту прописом')
.head 3 +  Data Field: ml3
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.45"
.head 6 -  Top:    4.762"
.head 6 -  Width:  3.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Кількість платежів прописом')
.head 3 +  Data Field: SKOL
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.15"
.head 6 -  Top:    4.714"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Кількість платежів')
.head 3 +  Data Field: KKOL
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    4.714"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Кількість комісій')
.head 3 +  Data Field: sTOBO
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.369"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: TOBO
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.25"
.head 6 -  Top:    4.0"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfTextSTOTAL
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfTextSNAL
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfTextSDEL
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 2 +  Functions 
.head 3 +  Function: F_tts
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Подготовить таблиці
.head 5 -  Set F_Opl = FALSE
.head 5 -  Call SalDisableWindow( pb_F10 )
.head 5 -  Call SalDisableWindow( pb_F5 )
.head 5 -  Call SalEnableWindow( SNAL )
.head 5 -  Set dTmp = STRING_Null
.head 5 -  Set dFIO = STRING_Null
.head 5 -  Set STOTAL = 0
.head 5 -  Set ml1 = ""
.head 5 -  Set SDEL = 0
.head 5 -  Set ml2 = ""
.head 5 -  Set ml3 = ""
.head 5 -  Set SNAL = 0
.head 5 -  Set SKOL = 0
.head 5 -  Set KKOL = 0
.head 5 -  !
.head 5 -  Set sTT= '   '
.head 5 -  Set nNOM = 0
.head 5 -  Set g_NOM = 0
.head 5 -  If SqlPrepareAndExecute( hSql(), "delete from tmp_operw ") and
  SqlPrepareAndExecute( hSql(),  
  "insert into tmp_operw (tt,tag,NOM, ord, VALUE,  DVAL, OPT ) 
   select tt, tag, 0, ord, val,  VAL, OPT 
   from OP_RULES WHERE USED4INPUT=1 and TT IN (SELECT TT FROM FOLDERS_tts WHERE IDFO=:nPap) ") 
.head 5 -  !
.head 5 -  Call SalDisableWindow (D1)
.head 5 -  Call SalTblReset( T1 )
.head 5 -  Call SalTblReset( D1 )
.head 5 -  Set NAZN1 = STRING_Null
.head 5 -  Call SalEnableWindow( T1.P )
.head 5 -  Call SalEnableWindow( T1.S )
.head 5 -  Call SalEnableWindow( pb_F1 )
.head 5 -  Call SalEnableWindow( pb_F4 )
.head 5 -  Call SalEnableWindow( pb_F2 )
.head 5 -  Call SalEnableWindow( pb_F3 )
.head 5 -  Call SalEnableWindow( pb_F8 )
.head 5 -  Call SalEnableWindow( pb_F9 )
.head 5 -  ! зеленіе операции
.head 5 -  Call SalTblPopulate(T1, hSql(),
 "SELECT T.tt, a.NLS, substr(a.nms,1,38), NVL(t.NAZN, t.name), 
         C.OKPO, v.VOB, 0, d.tt, d.s, nvl(t.sk,5)      
  into :T1.TT,:T1.NLSK,:T1.NAMK,:T1.NAM_TT,
       :T1.OKPOK,:T1.VOB,:T1.NOM,:T1.TT2,:T1.fS2,:T1.SKP
  FROM tts T, ACCOUNTS A, CUST_ACC U, CUSTOMER C, tts_vob v, tts d, ttsap ap
  WHERE v.tt=t.tt and A.KV=:n980 AND A.NLS=T.NLSA AND A.ACC=U.ACC AND U.RNK=C.RNK AND 
        t.nlsa is not null and t.nlsa<>:NLS_NLK and 
        t.nlsb is null and 
        T.TT IN (SELECT TT FROM FOLDERS_tts WHERE IDFO=:nPap) and 
        t.tt = ap.tt (+) and d.tt (+) = ap.ttap 
   ORDER BY a.nms " , TBL_FillAll)
.head 5 -  !
.head 5 -  Set bSortOrd1 = FALSE
.head 5 -  Call SalTblReset( T2 )
.head 5 -  Call SalTblReset( D2 )
.head 5 -  Call SalEnableWindow( T2.P )
.head 5 -  Call SalEnableWindow( T2.S )
.head 5 -  Call SalEnableWindow( T2.NAMK )
.head 5 -  Call SalEnableWindow( T2.MFOK )
.head 5 -  Call SalEnableWindow( T2.OKPOK )
.head 5 -  Call SalEnableWindow( T2.NLSK )
.head 5 -  Call SalEnableWindow (D2)
.head 5 -  Set NAZN2 = STRING_Null
.head 5 -  Call SalTblPopulate(T2, hSql(),
 "SELECT T.tt, t.name,  v.VOB, 0, d.tt, d.s, t.FLI,  t.sk           
  into :T2.TT, :T2.NAM_TT, :T2.VOB,:T2.NOM, :T2.TT2, :T2.fS2, :T2.FLI, :T2.SKP
  FROM tts T, tts_vob v, tts d, ttsap ap
  WHERE v.tt=t.tt  AND t.fli<=:KP_SIGN and 
        (t.nlsa=:NLS_NLK or t.nlsa is null ) and t.nlsb is null  and 
        T.TT IN (SELECT TT FROM FOLDERS_tts WHERE IDFO=:nPap) and 
        t.tt = ap.tt (+) and d.tt (+) = ap.ttap 
ORDER BY t.name " , TBL_FillAll)
.head 5 -  Set bSortOrd2 = FALSE
.head 5 -  Call SalDisableWindow( pbRef )
.head 5 -  Call F_Ref (0)
.head 5 -  Call SalSetFocus( T1 )
.head 5 -  Call SalTblSetRow( T1, TBL_MinRow )
.head 5 -  Call SalSetFocus( T1.S )
.head 3 +  Function: Fb_FK
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: nFK
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: TT_
.head 5 -  String: NAM_TT_
.head 5 -  String: NFILE_
.head 5 -  Number: VOB_
.head 5 -  Number: SKP_
.head 5 -  Number: NOM_
.head 5 -  Number: FLI_
.head 5 -  String: TT2_
.head 5 -  String: fS2_
.head 5 -  !
.head 5 -  String: NAMK_
.head 5 -  String: MFOK_
.head 5 -  String: OKPOK_
.head 5 -  String: NLSK_
.head 5 -  String: NAM_FIO_ 
.head 4 +  Actions 
.head 5 -  Set g_NOM  = g_NOM + 1
.head 5 -  ! Голубая
.head 5 +  If (nFK = 2 or nFK = 8) or (nFK = 3 or nFK = 9)
.head 6 -  Set NAM_FIO_ = T2.NAM_FIO
.head 6 -  Set TT_  = T2.TT
.head 6 -  Set SKP_  = T2.SKP
.head 6 -  Set FLI_ = T2.FLI
.head 6 -  Set NAM_TT_=T2.NAM_TT
.head 6 -  Set TT2_ = T2.TT2
.head 6 -  Set fS2_ = T2.fS2
.head 6 -  Set VOB_ = T2.VOB
.head 6 -  Set NOM_ = T2.NOM
.head 6 +  If nFK = 3 or nFK = 9
.head 7 -  Set NAMK_= T2.NAMK
.head 7 -  Set MFOK_= T2.MFOK
.head 7 -  Set OKPOK_=T2.OKPOK
.head 7 -  Set NLSK_= T2.NLSK
.head 6 -  !
.head 6 -  Set nRow = SalTblQueryContext ( T2 )
.head 6 -  Set nRow = SalTblInsertRow( T2, nRow + 1)
.head 6 -  Call SalTblSetContext(T2, nRow )                               
.head 6 -  Call SalTblSetRowFlags( T2, nRow, ROW_New, FALSE )
.head 6 -  !
.head 6 -  Set T2.NAM_FIO = NAM_FIO_
.head 6 -  Set T2.TT  = TT_
.head 6 -  Set T2.SKP = SKP_
.head 6 -  Set T2.FLI = FLI_
.head 6 -  Set T2.NAM_TT=NAM_TT_
.head 6 -  Set T2.TT2 = TT2_
.head 6 -  Set T2.fS2 = fS2_
.head 6 -  Set T2.VOB = VOB_
.head 6 -  Set T2.NOM = g_NOM 
.head 6 +  If nFK = 3 or nFK = 9
.head 7 -  Set T2.NAMK = NAMK_
.head 7 -  Set T2.MFOK = MFOK_
.head 7 -  Set T2.OKPOK= OKPOK_
.head 7 -  Set T2.NLSK = NLSK_
.head 7 -  Set T2.NAZ_TT = NAZN2
.head 5 -  ! Зеленая
.head 5 +  Else If nFK = 1 or nFK = 4 
.head 6 -  Set NAM_FIO_ = T1.NAM_FIO
.head 6 -  Set TT_  = T1.TT
.head 6 -  Set SKP_ = T1.SKP
.head 6 -  Set NAM_TT_=T1.NAM_TT
.head 6 -  Set TT2_ = T1.TT2
.head 6 -  Set fS2_ = T1.fS2
.head 6 -  Set VOB_ = T1.VOB
.head 6 -  Set NOM_ = T1.NOM
.head 6 -  Set NAMK_= T1.NAMK
.head 6 -  Set OKPOK_=T1.OKPOK
.head 6 -  Set NLSK_= T1.NLSK
.head 6 -  Set NFILE_=T1.NFILE 
.head 6 -  !
.head 6 -  Set nRow = SalTblQueryContext ( T1 )
.head 6 -  Set nRow = SalTblInsertRow( T1, nRow + 1)
.head 6 -  Call SalTblSetContext(T1, nRow )                               
.head 6 -  Call SalTblSetRowFlags( T1, nRow, ROW_New, FALSE )
.head 6 -  !
.head 6 -  Set T1.NAM_FIO = NAM_FIO_
.head 6 -  Set T1.TT  = TT_
.head 6 -  Set T1.NFILE=NFILE_ 
.head 6 -  Set T1.SKP = SKP_
.head 6 -  Set T1.NAM_TT=NAM_TT_
.head 6 -  Set T1.NAZ_TT=NAM_TT_
.head 6 -  Set T1.TT2 = TT2_
.head 6 -  Set T1.fS2 = fS2_
.head 6 -  Set T1.VOB = VOB_
.head 6 -  Set T1.NAMK= NAMK_
.head 6 -  Set T1.OKPOK=OKPOK_
.head 6 -  Set T1.NLSK= NLSK_
.head 6 -  Set T1.NOM = g_NOM 
.head 6 +  If nFK = 1
.head 7 -  Set T1.NAZ_TT = NAZN1
.head 5 -  !
.head 5 -  If SqlPrepareAndExecute( hSql(),
 "INSERT INTO tmp_operw ( tt, tag, NOM, VALUE, ord,  BROWSER, DVAL, OPT ) 
  SELECT tt, tag, :g_NOM, 
        Decode( :nFK, 1,DVAL, 2,DVAL,3,DVAL, VALUE ),
        ord,  BROWSER, DVAL, OPT
   from tmp_operw where TT=:TT_ and nom=:NOM_ ") 
.head 5 -  Return TRUE
.head 3 +  Function: f_Tochka
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: nMod
.head 5 -  Number: S
.head 5 -  String: NLSA
.head 5 -  String: MFOB
.head 5 -  String: NLSB
.head 5 -  Window Handle: hWnd
.head 5 -  String: sS2
.head 4 +  Static Variables 
.head 5 -  String: sTmp
.head 4 +  Local variables 
.head 5 -  String: aS
.head 5 -  String: sSQL
.head 5 -  Number: nS2
.head 4 +  Actions 
.head 5 -  Set nROW1 = SalTblQueryContext ( T1 )
.head 5 -  Set nROW2 = SalTblQueryContext ( T2 )
.head 5 -  Set sTmp=SalStrRepeatX( ' ', 20 )
.head 5 -  Call SalGetWindowText ( hWnd, sTmp, 20 )
.head 5 +  While SalStrScan(sTmp, sDecimal2) > 0
.head 6 -  Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
.head 5 -  Call SalFmtStrToField ( hWnd, sTmp, TRUE)
.head 5 +  If nMod >0
.head 6 -  !
.head 6 -  ! Формула суммы комиссии #(S), #(KVA), #(KVB), #(NLSA), #(NLSB), #(MFOA), #(MFOB)
.head 6 +  If sS2 != STRING_Null and S > 0
.head 7 -  Set sSQL = SalStrUpperX(' ' || sS2 )
.head 7 -  Set sSQL = ' ' || sS2
.head 7 -  Set aS  = SalNumberToStrX(S * 100, 0)     ! Сумма платежа
.head 7 +  While SalStrScan( sSQL, '#(S)' ) > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL, '#(S)' ), 4, aS )
.head 7 +  While SalStrScan( sSQL, '#(KVA)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(KVA)'), 6, Str(n980))
.head 7 +  While SalStrScan( sSQL, '#(KVB)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(KVB)'), 6, Str(n980))
.head 7 +  While SalStrScan( sSQL, '#(NLSA)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(NLSA)'), 7, NLSA)
.head 7 +  While SalStrScan( sSQL, '#(NLSB)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(NLSB)'), 7, NLSB)
.head 7 +  While SalStrScan( sSQL, '#(MFOA)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(MFOA)'), 7, BankMfo )
.head 7 +  While SalStrScan( sSQL, '#(MFOB)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(MFOB)'), 7, MFOB )
.head 7 -  Set sSQL = "SELECT ROUND(" || sSQL || ",0) INTO :nS2 FROM dual"
.head 7 +  If SqlPrepareAndExecute( hSql(), sSQL ) and SqlFetchNext(hSql(),nFetchRes)
.head 8 -  Set nS2 = nS2 /100
.head 7 +  Else 
.head 8 -  Set nS2 =0
.head 6 +  Else 
.head 7 -  Set nS2 = NUMBER_Null
.head 6 +  If nMod = 1
.head 7 -  Call SalSetFocus( NAZN1 )
.head 7 -  ! Call SalTblSetFocusCell( D1, 0, D1.VALUE, 0, 1 )
.head 7 -  ! Call SalSendMsg( D1, SAM_RowSetContext, 0, 0 )
.head 7 -  Set T1.S2 = nS2
.head 6 +  Else 
.head 7 -  Call SalSetFocus( NAZN2 )
.head 7 -  Set T2.S2 = nS2
.head 6 -  Set STOTAL = 
SalTblColumnSum( T1, SalTblQueryColumnID( T1.S ), 0, 0 ) + 
SalTblColumnSum( T1, SalTblQueryColumnID( T1.S2), 0, 0 ) +
SalTblColumnSum( T2, SalTblQueryColumnID( T2.S ), 0, 0 ) +
SalTblColumnSum( T2, SalTblQueryColumnID( T2.S2), 0, 0 )
.head 6 -  Call F_Kol()
.head 5 -  Call SalTblSetContext(T1, nROW1)
.head 5 -  Call SalTblSetContext(T2, nROW2)
.head 5 -  ! Call SalMapEnterToTab( TRUE )
.head 5 -  Return TRUE
.head 3 +  Function: F_Print
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: nMod
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T1, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T1, nRow)
.head 6 +  If T1.REF1 != NUMBER_Null and nMod= 2
.head 7 -  Call DocsPrint ( T1.REF1, 'OPER', FALSE )
.head 6 +  If T1.REF2 != NUMBER_Null 
.head 7 -  Call DocsPrint ( T1.REF2, 'OPER', FALSE )
.head 5 -  !
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T2, nRow)
.head 6 +  If T2.REF1 != NUMBER_Null 
.head 7 -  Call DocsPrint ( T2.REF1, 'OPER', FALSE )
.head 6 +  If T2.REF2 != NUMBER_Null 
.head 7 -  Call DocsPrint ( T2.REF2, 'OPER', FALSE )
.head 3 +  Function: F_Kol
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set SKOL = 0
.head 5 -  Set KKOL = 0
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T1, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T1, nRow)
.head 6 +  If T1.S > 0
.head 7 -  Set SKOL = SKOL +1
.head 6 +  If T1.S2 > 0
.head 7 -  Set KKOL = KKOL +1
.head 5 -  !
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T2, nRow)
.head 6 +  If T2.S > 0
.head 7 -  Set SKOL = SKOL +1
.head 6 +  If T2.S2 > 0
.head 7 -  Set KKOL = KKOL +1
.head 3 +  Function: F_Tag
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  String: sCHKR
.head 5 -  String: sTag
.head 5 -  String: sValue
.head 5 -  String: sOpt
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bFL
.head 4 +  Actions 
.head 5 +  If Subs(sTag,1,3)='FIO' and sValue != STRING_Null 
.head 6 -  Set dFIO = sValue
.head 5 -  ! Если sValue = STRING_Null 
.head 5 -  ! и не обяз  != M не проверять
.head 5 -  Set bFL = TRUE
.head 5 -  ! Обязательный, но пустой
.head 5 +  If sOpt ='M' and sValue = STRING_Null
.head 6 -  Set bFL = FALSE
.head 5 -  ! не пустой, но есть проверка и он ее не проходит 
.head 5 +  If sValue != STRING_Null and sCHKR != STRING_Null 
.head 6 +  If SqlPrepareAndExecute( hSql(), "SELECT C_TAG (:sTag,:sValue) INTO :nC_TAG from dual ") 
and SqlFetchNext( hSql(), nFetchRes ) 
and nC_TAG = 0
.head 7 -  Set bFL = FALSE
.head 5 -  ! Плохо дело
.head 5 +  If not bFL
.head 6 +  If nBROWSER = 1
.head 7 -  Set D1.VALUE = sNOT
.head 7 -  Call XSalTblSetCellBackColor( D1.VALUE , nCol )
.head 6 +  Else 
.head 7 -  Set D2.VALUE = sNOT
.head 7 -  Call XSalTblSetCellBackColor( D2.VALUE , nCol )
.head 6 -  Set sErr = " Помилка доп.реквізиту "|| sTag
.head 6 -  Call SalMessageBox( sErr, "Увага !", MB_IconStop)
.head 5 -  Return bFL
.head 3 +  Function: F_Focus
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  String: sVALUE
.head 5 -  String: sBROWSER
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set sNOT = sVALUE
.head 5 -  ! Call SalMapEnterToTab( TRUE )
.head 5 +  If sBROWSER != STRING_Null
.head 6 -  Call SalEnableWindow( pbHelp )
.head 6 -  Set gBROWSER = sBROWSER
.head 5 +  Else 
.head 6 -  Call SalDisableWindow( pbHelp )
.head 3 +  Function: F_Komis
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Number: nSum !! Сумма комис в коп
.head 5 -  String: TT1  !! Код Осн.оп
.head 5 -  Number: NOM   !! Ном осн.оп
.head 5 -  String: TT2  !! Код ком=доч оп
.head 5 -  String: sFIO !! 
.head 5 -  Date/Time: sDate !! дата ввода
.head 5 -  Receive Number: REF2 !!Реф после оплдаты ком
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sNazn
.head 5 -  Number: nVob
.head 5 -  Number: nRef
.head 5 -  !
.head 5 -  String: NLS6
.head 5 -  String: NMS6
.head 5 -  String: FORMULA6
.head 4 +  Actions 
.head 5 -  ! Комиссия
.head 5 +  If SqlPrepareAndExecute( hSql(),
"SELECT t.name, v.vob, translate ( NLSA, '#', ' ' )
 INTO :sNazn,  :nVob, :FORMULA6
 FROM tts  t,  tts_vob v 
 WHERE t.tt=:TT2 and v.tt=t.tt" ) 
  and SqlFetchNext( hSql(), nFetchRes ) 
.head 6 +  If SqlPrepareAndExecute( hSql(),
"SELECT substr("|| FORMULA6 || ",1,14) into :NLS6 from dual")
  and SqlFetchNext( hSql(), nFetchRes ) 
.head 7 +  If SqlPrepareAndExecute( hSql(),
"SELECT substr(nms,1,38) INTO :NMS6 FROM accounts 
 WHERE kv=:n980 and nls = :NLS6 " ) 
  and SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set nRef = NUMBER_Null
.head 8 -  Set sNazn= Subs(sNazn ||IifS(sFIO=STRING_Null,'', '. Платник '|| sFIO),1, 160)
.head 8 -  Call cDoc_KP_SIGN.SetDoc( nRef, TT2, 0, nVob, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     NLS6, NMS6, BankMfo, '', n980, nSum, BankOkpo, 
     NLS_CASH, NMS_CASH, BankMfo, '', n980, nSum, BankOkpo, 
     sNazn, '',GetIdOper(),'', 5 ,0)
.head 8 +  If not cDoc_KP_SIGN.oDoc()
.head 9 -  Return FALSE
.head 8 -  Set nRef = cDoc_KP_SIGN.m_nRef
.head 8 +  If not SqlPrepareAndExecute( hSql(),
 "INSERT INTO operw (ref, tag,value) 
  SELECT :nRef, tag, value 
  FROM tmp_operw  WHERE tt=:TT1 and value is not null and nom=:NOM " )
.head 9 -  Return FALSE
.head 8 -  Set REF2 = nRef
.head 7 +  Else 
.head 8 -  Call Debug("Не отк счет из формулы счета доходов операции " || TT2 )
.head 8 -  Return FALSE
.head 6 +  Else 
.head 7 -  Call Debug("Формула счета доходов операции " || TT2 )
.head 7 -  Return FALSE
.head 5 +  Else 
.head 6 -  Call Debug("Не описана операция " || TT2 )
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: f_Opl
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Receive Number: rS
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nSum
.head 5 -  Number: nRef
.head 5 -  Date/Time: sDate
.head 5 -  Number: nRowT
.head 5 -  ! Number: nRowD
.head 5 -  String: sNazn
.head 5 -  !
.head 4 +  Actions 
.head 5 -  ! последняя проверка доп реквизитов
.head 5 -  Set rS = NUMBER_Null
.head 5 +  If STOTAL > 0 and (SNAL < STOTAL or SNAL=NUMBER_Null) 
.head 6 -  Set sErr = " НЕДОСТАТЧА коштів, чи помилка суми !"
.head 6 -  Set SNAL = NUMBER_Null
.head 6 -  Set SDEL = 0
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set nBROWSER = 1
.head 5 -  Set nRowT = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T1, nRowT, 0, 0 )
.head 6 -  Call SalTblSetContext( T1, nRowT )
.head 6 +  If T1.S >0 
.head 7 +  If not f_Prov1()
.head 8 -  Return FALSE
.head 5 -  !
.head 5 -  Set nBROWSER = 2
.head 5 -  Set nRowT = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRowT, 0, 0 )
.head 6 -  Call SalTblSetContext( T2, nRowT )
.head 6 +  If T2.S >0 
.head 7 +  If not f_Prov2()
.head 8 -  Return FALSE
.head 6 -  !
.head 5 -  ! ----------------------------- 
.head 5 -  ! Собственно оплата
.head 5 -  If SqlPrepareAndExecute( hSql(),"SELECT sysdate INTO :sDate FROM dual") and SqlFetchNext( hSql(), nFetchRes )
.head 5 -  ! По T1
.head 5 -  Set nRow = TBL_MinRow
.head 5 -  Set sErr=' Полилка в оплаті'
.head 5 +  While SalTblFindNextRow( T1, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( T1, nRow )
.head 6 +  If T1.S >0 
.head 7 -  Set nRef = NUMBER_Null
.head 7 -  Set nSum = T1.S * 100
.head 7 -  Set sNazn= Subs(IifS( T1.NAZ_TT = STRING_Null or SalStrLength( T1.NAZ_TT  ) < 3,
                      T1.NAM_TT,
                      T1.NAZ_TT ) || 
                IifS(T1.NAM_FIO=STRING_Null,'', '. Платник '|| T1.NAM_FIO) , 1, 160)
.head 7 -  Set rS=T1.S 
.head 7 -  Call cDoc_KP_SIGN.SetDoc( nRef, T1.TT, 0, T1.VOB, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     T1.NLSK, T1.NAMK, BankMfo, '', n980, nSum, T1.OKPOK , 
     NLS_CASH, NMS_CASH, BankMfo, '', n980, nSum, BankOkpo, 
     sNazn, '', GetIdOper(),'', T1.SKP ,0)
.head 7 -  Set cDoc_KP_SIGN.m_nFli = 0
.head 7 +  If not cDoc_KP_SIGN.oDoc()
.head 8 -  Return FALSE
.head 7 -  Set nRef = cDoc_KP_SIGN.m_nRef
.head 7 +  If not SqlPrepareAndExecute( hSql(),
 "INSERT INTO operw (ref, tag,value) SELECT :nRef, tag, value 
  FROM tmp_operw  WHERE tt=:T1.TT and value is not null and nom=:T1.NOM " )
.head 8 -  Return FALSE
.head 7 -  Set T1.REF1 = nRef
.head 7 -  ! Комиссия
.head 7 +  If T1.S2 > 0
.head 8 +  If not F_Komis( T1.S2*100,  T1.TT, T1.NOM, T1.TT2, T1.NAM_FIO, sDate, T1.REF2 )
.head 9 -  Return FALSE
.head 5 -  ! По T2
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( T2, nRow )
.head 6 +  If T2.S >0 
.head 7 -  Set nRef = NUMBER_Null
.head 7 -  Set nSum = T2.S * 100
.head 7 -  Set rS   =T2.S 
.head 7 -  Set sNazn= Subs(T2.NAZ_TT ||IifS(T2.NAM_FIO=STRING_Null,'', '. Платник '|| T2.NAM_FIO) , 1,160)
.head 7 -  ! !!
.head 7 +  If KP_SIGN = 0 and BankMfo != T2.MFOK 
.head 8 -  ! МБ, временно внутренний с дальнейшей перекредитовкой)
.head 8 -  Call cDoc_KP_nSIGN.SetDoc( nRef, T2.TT, 1, T2.VOB, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     NLS_CASH, BankName, BankMfo, '', n980, nSum, BankOkpo,
     NLS_NLK, T2.NAMK,  T2.MFOK, '', n980, nSum,  T2.OKPOK, 
     sNazn, '', GetIdOper(),'', T2.SKP ,0)
.head 8 +  If not cDoc_KP_nSIGN.oDoc()
.head 9 -  Return FALSE
.head 8 -  Set nRef = cDoc_KP_nSIGN.m_nRef
.head 8 -  If SqlPrepareAndExecute( hSql(),"update oper set nlsb=:T2.NLSK where ref=:nRef")
.head 7 +  Else 
.head 8 -  ! Натуральный МБ или натуральные внутренние 
.head 8 -  Set cDoc_KP_SIGN.FLI = 1
.head 8 -  Set cDoc_KP_SIGN.NLS_CASH = NLS_CASH
.head 8 -  Set cDoc_KP_SIGN.NLS_NLK = NLS_NLK
.head 8 -  Call cDoc_KP_SIGN.SetDoc( nRef, T2.TT, 1, T2.VOB, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     NLS_NLK, BankName, BankMfo, '', n980, nSum, BankOkpo,
     T2.NLSK, T2.NAMK,  T2.MFOK, '', n980, nSum,  T2.OKPOK, 
     sNazn, '', GetIdOper(),'', T2.SKP ,0)
.head 8 +  If not cDoc_KP_SIGN.oDoc()
.head 9 -  Return FALSE
.head 8 -  Set nRef = cDoc_KP_SIGN.m_nRef
.head 7 +  If not SqlPrepareAndExecute( hSql(),
 "INSERT INTO operw (ref, tag,value) 
  SELECT :nRef, tag, value 
  FROM tmp_operw  WHERE tt=:T2.TT and value is not null and nom=:T2.NOM" )
.head 8 -  Return FALSE
.head 7 +  If KP_SIGN = 0 and BankMfo =T2.MFOK
.head 8 -  If SqlPrepareAndExecute( hSql(),"DELETE from nlk_ref where ref1=:nRef")
.head 7 -  Set T2.REF1 = nRef
.head 7 -  ! Комиссия
.head 7 +  If T2.S2 > 0
.head 8 -  Set cDoc_KP_SIGN.FLI = 0
.head 8 +  If not F_Komis( T2.S2*100,  T2.TT, T2.NOM, T2.TT2, T2.NAM_FIO, sDate,  T2.REF2 )
.head 9 -  Return FALSE
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: f_Prov1
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nRowD
.head 5 -  !
.head 4 +  Actions 
.head 5 -  Call T1.f1()
.head 5 -  Set nRowD = TBL_MinRow
.head 5 -  Set rS = T1.S 
.head 5 +  While SalTblFindNextRow( D1, nRowD, 0, 0 )
.head 6 -  Call SalTblSetContext( D1, nRowD )
.head 6 +  If D1.BROWSER != STRING_Null
.head 7 -  Call SalEnableWindow( pbHelp )
.head 7 -  Set gBROWSER = D1.BROWSER
.head 6 +  Else 
.head 7 -  Call SalDisableWindow( pbHelp )
.head 6 +  If not F_Tag( D1.CHKR, SalStrTrimX(D1.TAG), SalStrTrimX(D1.VALUE ), D1.OPT )
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: f_Prov2
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nRowD
.head 4 +  Actions 
.head 5 -  Call T2.f1()
.head 5 -  Set nRowD = TBL_MinRow
.head 5 -  Set rS=T2.S 
.head 5 +  While SalTblFindNextRow( D2, nRowD, 0, 0 )
.head 6 -  Call SalTblSetContext( D2, nRowD )
.head 6 +  If T2.NAZ_TT = STRING_Null or SalStrLength( T2.NAZ_TT ) < 3
.head 7 -  Call SalSendMsg( NAZN2, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено призначення платежу ! "
.head 7 -  Return FALSE
.head 6 +  If T2.MFOK = STRING_Null 
.head 7 -  Call SalSendMsg( T2.MFOK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено МФО отримувача! "
.head 7 -  Return FALSE
.head 6 +  If T2.NLSK = STRING_Null 
.head 7 -  Call SalSendMsg( T2.NLSK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено рахунок отримувача! "
.head 7 -  Return FALSE
.head 6 +  If T2.NAMK = STRING_Null 
.head 7 -  Call SalSendMsg( T2.NAMK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено назва отримувача! "
.head 7 -  Return FALSE
.head 6 +  If T2.OKPOK = STRING_Null 
.head 7 -  Call SalSendMsg( T2.OKPOK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено ід.код отримувача! "
.head 7 -  Return FALSE
.head 6 +  ! If T2.MFOK = STRING_Null or T2.NLSK = STRING_Null or 
   T2.NAMK = STRING_Null or T2.OKPOK=STRING_Null 
.head 7 -                                                                            Set sErr=" НЕ заповнено реквізити отримувача ! "
.head 7 -                                                                            Return FALSE
.head 6 +  If T2.SKP = NUMBER_Null
.head 7 -  Call SalSendMsg( T2.SKP, SAM_Validate, 0, 0 )
.head 7 -  Set sErr ='Помилка СКП'
.head 7 -  Return FALSE
.head 6 +  If D2.BROWSER != STRING_Null
.head 7 -  Call SalEnableWindow( pbHelp )
.head 7 -  Set gBROWSER = D2.BROWSER
.head 6 +  Else 
.head 7 -  Call SalDisableWindow( pbHelp )
.head 6 +  If not F_Tag( D2.CHKR, SalStrTrimX(D2.TAG), SalStrTrimX(D2.VALUE ), D2.OPT )
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: F_Ref
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: nMode
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If nMode= 1
.head 6 -  Call SalShowWindow (T1.REF1)
.head 6 -  Call SalShowWindow (T1.REF2)
.head 6 -  Call SalShowWindow (T2.REF1)
.head 6 -  Call SalShowWindow (T2.REF2)
.head 5 +  Else 
.head 6 -  Call SalHideWindow (T1.REF1)
.head 6 -  Call SalHideWindow (T1.REF2)
.head 6 -  Call SalHideWindow (T2.REF1)
.head 6 -  Call SalHideWindow (T2.REF2)
.head 3 +  Function: F_Ottisk
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  String: NMK
.head 5 -  String: FIO1
.head 5 -  Number: nSUMB
.head 5 -  Number: nSUMBK
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: TIME
.head 5 -  String: SUMB
.head 5 -  String: SUMBK
.head 5 -  !
.head 5 -  String: sTmp
.head 5 -  String: strReport
.head 5 -  String: strTempl
.head 5 -  !
.head 4 +  Actions 
.head 5 -  If SqlPrepareAndExecute( hSqlAux2(),
  "SELECT  to_char(sysdate,'DD/MM/yyyy HH24:MM:SS') INTO :TIME FROM dual " )
and  SqlFetchNext(  hSqlAux2(),  nFetchRes)
.head 5 +  If nSUMB >0 
.head 6 -  Set SUMB = SalNumberToStrX( nSUMB, 2 )|| ' грн'
.head 5 +  Else 
.head 6 -  Set SUMB = STRING_Null
.head 5 +  If nSUMBK >0 
.head 6 -  Set SUMBK = ', ком. '|| SalNumberToStrX( nSUMBK, 2 )|| ' грн'
.head 5 +  Else 
.head 6 -  Set SUMBK = STRING_Null
.head 5 -  !
.head 5 -  Set strTempl = GetTemplateDir()||'\\OTTISK.qrd'
.head 5 -  Set sTmp = 
GetBankMfo()||'~'|| GetBankName() ||'~'|| ADR ||'~'|| TIME || '~' || FIO1 || '~' ||
NMK ||'~'|| SUMB||'~'||SUMBK||'~'|| GetUserRealName()
.head 5 -  ! ---------------     Печатаем тикет            ------------
[REM        MFOA      - MFO--А                   
[REM        NBA       - Наш Банк  
[REM        ADR
[REM        TIME     - Сист Дата  
[REM        FIO1     - Кто платит
[REM        NMK   - Наименование Контрагента  
[REM        SUMB     - Сумма сделки
[REM        SUMBK    - Сумма комиссии
[REM        FIO     - Кто ввел
-----
.head 5 -  !
.head 5 -  Set strReport = GetPrnDir()||'\\_'||SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss') ||
    '.D' || SalStrRightX('0' || Str(SalDateDay(SalDateCurrent())), 2)
.head 5 -  !
.head 5 -  Call DosReport (strTempl,  strReport,'MFOA~NBA~ADR~TIME~FIO1~NMK~SUMB~SUMBK~FIO', sTmp, 0)
.head 5 -  Call DosDirectPrint(strReport)
.head 2 +  Window Parameters 
.head 3 -  Number: nMode
.head 3 -  Number: nPap
.head 3 -  String: pNLS_NLK
.head 3 -  String: strPar02 ! ='' нахальная печать есть , ='N' нах печати нет
.head 2 +  Window Variables 
.head 3 -  : cDoc_KP_SIGN
.winattr class
.head 4 -  Class: cDoc_KP_SIGN
.end
.head 3 -  : cDoc_KP_nSIGN
.winattr class
.head 4 -  Class: cDoc_KP_nSIGN
.end
.head 3 -  : cDoc
.winattr class
.head 4 -  Class: cDoc
.end
.head 3 -  ! String: sNLS_NLK
.head 3 -  !
.head 3 -  Boolean: bSortOrd1
.head 3 -  Boolean: bSortOrd2
.head 3 -  Window Handle: hDocWdog
.head 3 -  Boolean: F_Opl
.head 3 -  Number: KP_SIGN
.head 3 -  !
.head 3 -  Number: nTAB
.head 3 -  Number: g_NOM
.head 3 -  !
.head 3 -  String: sErr
.head 3 -  String: sPap
.head 3 -  Number: nLC
.head 3 -  Number: nRow
.head 3 -  Number: nRow1
.head 3 -  Number: nRow2
.head 3 -  Number: n980
.head 3 -  String: sTT
.head 3 -  Number: nNOM
.head 3 -  String: sNAMK
.head 3 -  String: sNlsAlt 
.head 3 -  String: sTipNazn
.head 3 -  String: sDecimal2  ! симв десятичной точки alt
.head 3 -  String: sDecimal   ! симв десятичной точки
.head 3 -  Number: nCol1
.head 3 -  Number: nTmp
.head 3 -  Number: nC_TAG
.head 3 -  String: sNOT
.head 3 -  Number: nCol
.head 3 -  String: gBROWSER
.head 3 -  Number: nBROWSER
.head 3 -  String: sTmp
.head 3 -  String: AA1
.head 3 -  String: AA2
.head 3 -  !
.head 3 -  Number: nUser
.head 3 -  Number: nROW1
.head 3 -  Number: nROW2
.head 3 -  Number: rS
.head 3 -  Number: nLT1
.head 3 -  Number: nHT1
.head 3 -  Number: nLT2
.head 3 -  Number: nHT2
.head 3 -  Date/Time: bDat
.head 3 -  Number: b840
.head 3 -  Number: b978
.head 3 -  Number: b643
.head 3 -  ! !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 3 -  Number: nW
.head 3 -  Number: nH
.head 3 -  Number: nCW
.head 3 -  Number: nCH
.head 3 -  String: ADR
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  !
.head 4 -  Set dfTextNAZN2  = 'Признач.пл.-2'
.head 4 -  Set dfTextSTOTAL = 'Сума платежів'
.head 4 -  Set dfTextSNAL = 'Прийнято у клієнта'
.head 4 -  Set dfTextSDEL = 'Повернути клієнту'
.head 4 -  !
.head 4 -  If SqlPrepareAndExecute( hSql(),"SELECT kv, NOMINAL INTO :nRow, :nTmp FROM tabval where kv in (840,978,643) ")
.head 4 +  While SqlFetchNext( hSql(), nFetchRes )
.head 5 +  If nRow = 840
.head 6 -  Set b840 = nTmp
.head 5 +  Else If nRow = 978
.head 6 -  Set b978 = nTmp
.head 5 +  Else If nRow = 643
.head 6 -  Set b643 = nTmp
.head 4 -  Set F_Opl = FALSE
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT substr(pul.Get_Mas_Ini_Val('NLS_2902'),1,14)
   INTO :NLS_NLK FROM dual  " ) 
and not SqlFetchNext( hSql(), nFetchRes ) 
or NLS_NLK = STRING_Null
.head 5 -  Set NLS_NLK = pNLS_NLK
.head 4 -  Call SalGetWindowSize( T1, nLT1, nHT1 )
.head 4 -  Call SalGetWindowSize( T2, nLT2, nHT2 )
.head 4 -  Set nCol = SalColorFromRGB( 255,200,255 )  ! розовій
.head 4 -  Set sDecimal =SalStrMidX(SalNumberToStrX(1.1,1),1,1)
.head 4 -  Set nCol1 = SalColorFromRGB( 230,255,230 )
.head 4 -  Set sDecimal2 = IifS ( sDecimal = '.', ',', '.' )
.head 4 -  ! Call SalGetWindowSize( dFIO, nW3, nH3 )
.head 4 -  Set BankName = GetBankName()
.head 4 -  Set BankMfo =  GetBankMfo()
.head 4 -  Set DatVal = GetBankDate()
.head 4 -  Set n980 = GetBaseVal()
.head 4 +  If nMode >100
.head 5 -  ! найти по календатю
.head 5 -  Set bDat = DatVal
.head 5 +  If SqlPrepareAndExecute( hSql(),
   "SELECT min( to_date(:bDat) + num) 
    INTO :DatVal 
    FROM conductor WHERE num<7 and to_date(:bDat) + num not in 
        (select holiday from holiday where kv=:n980 and holiday> :bDat ) " ) and
not SqlFetchNext( hSql(), nFetchRes ) 
.head 6 -  Set DatVal = GetBankDate() +1
.head 4 -  Set BankOkpo = GetBankOkpoS()
.head 4 -  Set nUser = GetUserId()
.head 4 -  ! Код ТОБО, 
  Счет кассы из ini-файла  (или головной банк )
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,20), 
          substr(pul.Get_Mas_Ini_Val('CASH'),1,14)
   INTO :TOBO, :NLS_CASH FROM dual  " ) 
and SqlFetchNext( hSql(), nFetchRes ) 
.head 4 +  If TOBO  = STRING_Null or TOBO = BankMfo
.head 5 -  Set TOBO  = BankMfo
.head 5 -  Set sTOBO = BankName
.head 4 +  If NLS_CASH = STRING_Null 
.head 5 -  If SqlPrepareAndExecute( hSql(), 
  "SELECT param_value INTO :sTOBO FROM BRANCH_PARAMS_VALUES WHERE mfo=:TOBO and name='BANKNAME' " ) 
and SqlFetchNext( hSql(), nFetchRes ) 
.head 4 -  ! Наименование счета кассы и наименование папки 
ИЛИ ВЫХОД - если не найдено
.head 4 +  If NLS_CASH != STRING_Null 
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT substr(c.nms,1,38), f.name 
   INTO :NMS_CASH, :sPap
   FROM CASH_ISP c,  folders f
   WHERE c.nls=:NLS_CASH and f.idfo=:nPap " ) 
and not SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Call SalMessageBox("НЕ УСТАНОВЛЕНО рахунок каси каристувачеві ",
Str(nUser)||' '||GetUserLoginName()||' '||GetUserRealName(), MB_IconStop)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 4 -  ! -------------------------------
.head 4 -  ! Операции обмена ВАЛ
.head 4 -  Set AA1 = STRING_Null
.head 4 -  Set AA2 = STRING_Null
.head 4 -  ! сначала в INI- файле
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT substr(pul.Get_Mas_Ini_Val('AA1'),1,3), substr(pul.Get_Mas_Ini_Val('AA2'),1,3)
   INTO :AA1, :AA2 FROM dual " ) 
and SqlFetchNext( hSql(), nFetchRes ) 
.head 4 +  If AA1 = STRING_Null or AA2 = STRING_Null 
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT v1.param_value, v2.param_value  INTO :AA1, :AA2 
   FROM BRANCH_PARAMS_VALUES v1, BRANCH_PARAMS_VALUES v2
   WHERE v1.mfo=:TOBO and v2.mfo=:TOBO and v1.name='AA1' and v2.name='AA2' " ) 
and not SqlFetchNext( hSql(), nFetchRes ) 
.head 6 -  Set AA1 = 'AA1'
.head 6 -  Set AA2 = 'AA2'
.head 4 -  ! С ЭЦП (1-Маршавина)  или без(0 -АЖИО) - по умолчанию =1
.head 4 -  Set KP_SIGN = 1 
.head 4 -  ! сначала в общем PARAMS
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT val INTO :KP_SIGN FROM PARAMS WHERE par='KP_SIGN' " ) 
and not SqlFetchNext( hSql(), nFetchRes ) 
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT param_value INTO :KP_SIGN FROM BRANCH_PARAMS_VALUES 
   WHERE mfo=:TOBO and name='KP_SIGN' and param_value = '0' " ) 
and not SqlFetchNext( hSql(), nFetchRes ) 
.head 6 -  Set KP_SIGN = 1 
.head 4 -  If SqlPrepareAndExecute( hSql(),
  "SELECT val INTO :ADR FROM PARAMS WHERE par='ADDRESS' " ) 
and not SqlFetchNext( hSql(), nFetchRes ) 
.head 4 -  !
.head 4 -  Call SalSetWindowText( KP, "Комплексне обслуговування ФО, папка операцій № "||Str(nPap)|| "-"||sPap )
.head 4 -  !
.head 4 -  Call F_tts()
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize( hWndForm, nWW, nWH )
.head 4 +  If nWW >= 12
.head 5 +  If nWH < 6
.head 6 -  Call SalSetWindowSize( hWndForm, nWW, 6 )
.head 4 +  Else 
.head 5 +  If nWH < 6
.head 6 -  Call SalSetWindowSize( hWndForm, 12, 6 )
.head 5 +  Else 
.head 6 -  Call SalSetWindowSize( hWndForm, 12, nWH )
.head 4 -  Call GetClientRect( hWndForm, nX, nY, nW, nH )
.head 4 -  ! F1
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F1, 0.05, 0)
.head 4 -  ! F4
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F4, 0.5, 0)
.head 4 -  ! NAZN1
.head 4 -  Call SalGetWindowSize(hWndForm.KP.NAZN1, nCW, nCH)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.NAZN1, 
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35-0.05-3.2, nCH)
.head 4 -  ! NAM_TT1
.head 4 -  Call SalGetWindowLoc( hWndForm.KP.NAM_TT1, nCW, nCH )
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.NAM_TT1, 
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35, nCH)
.head 4 -  ! T1
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.T1, 0, 0.35)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.T1, 
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35-0.05,
	SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.5)
.head 4 -  ! D1
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.D1, 
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35, 0.35)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.D1, nCW, nCH)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.D1, nCW,
	SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.5)
.head 4 -  ! F2
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F2, 0.05, 
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 4 -  ! F3
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F3, 0.5, 
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 4 -  ! F8
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F8, 0.95, 
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 4 -  ! F9
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F9, 1.4, 
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 4 -  ! NAM_TT2
.head 4 -  Call SalGetWindowLoc( hWndForm.KP.NAM_TT2, nCW, nCH )
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.NAM_TT2, 
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35, 
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.05)
.head 4 -  ! T2
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.T2, 0, 
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-2.75)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.T2, 
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35-0.05, 1.5)
.head 4 -  ! D2
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.D2, 
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35, 
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-2.75)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.D2, nCW, nCH)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.D2, nCW, 1.5)
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextNAZN2, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-1.2+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.NAZN2, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-1.2)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.NAZN2, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.NAZN2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-0.1-2.2, nCH)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextSTOTAL, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.95+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.STOTAL, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.95)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.ml1, 0.1+2.2+1.55,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.9)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.ml1, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.ml1,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-2.2-0.1-1.55, nCH)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextSNAL, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.SNAL, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.SKOL, 0.1+2.2+1.55,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.KKOL, 0.1+2.2+2.15,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.ml3, 0.1+2.2+2.75,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.6)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.ml3, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.ml3,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-2.75-0.1-2.2, nCH)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextSDEL, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.35+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.SDEL, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.35)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.ml2, 0.1+2.2+1.55,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.3)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.ml2, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.ml2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-0.1-2.2-1.55, nCH)
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.NLS_NLK,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -1.2)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.TOBO,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-1.95,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -1.2)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.sTOBO,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -0.9)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dFIO,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -0.6)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dTmp,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -0.3)
.head 4 -  !
.head 4 -  Call SalInvalidateWindow( hWndForm )
.head 1 +  Form Window: KP !! от 09-09-2005 Последние из по ком.пл
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    0.438"
.head 4 -  Width:  13.783"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.643"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Комунальные платежи
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 -  ! ! ПЕЧАТЬ тикетов:
1.Нахальная перчать :
  Тикеты на комисии и
  Тикеты на основные платежи ГОЛУБОЙ таблицы
  печатаются автоматически в момент оплаты (на лист)
2 F5 - печать всех тикетов (осн, ком) на лист
3.Двойным щелчком ЛЕВОЙ мышки на оплаченной строке (ЗЕЛЕНОЙ и ГОЛУБОЙ)
                  печатается тикет на осн.платеж  (оттиск)
4.Щелчком ПРАВОЙ мышки на оплаченной строке с комис (ЗЕЛЕНОЙ и ГОЛУБОЙ)
                  печатается тикет на ком.платеж (на случай замятия)
.head 4 +  Option Button: pbRef
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\TUDASUDA.BMP
.head 5 -  Picture Transparent Color: White
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Відкрити/Закрити колонки Референсів' )
.head 6 +  On SAM_Click
.head 7 -  Call F_Ref( not pbRef)
.head 4 +  Pushbutton: pb_F10
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F10. Ввести '
.head 6 +  On SAM_Click
.head 7 +  If STOTAL > 0 and F_Opl
.head 8 -  Set F_Opl = FALSE
.head 8 -  Call SqlCommit( hSql() )
.head 8 -  Call SalDisableWindow( pb_F1 )
.head 8 -  Call SalDisableWindow( pb_F2 )
.head 8 -  Call SalDisableWindow( pb_F3 )
.head 8 -  Call SalDisableWindow( pb_F4 )
.head 8 -  Call SalDisableWindow( pb_F8 )
.head 8 -  Call SalDisableWindow( pb_F9)
.head 8 +  If f_Opl(rS)
.head 9 -  Call F_Ref (1)
.head 9 -  Call SqlCommit( hSql() )
.head 9 -  Set yRef = 1
.head 9 -  Call SalEnableWindow( pbRef )
.head 9 -  If SalStrUpperX( Subs(strPar02,1,1) )='N' ! нахальная печать NO
.head 9 +  Else ! YES
.head 10 -  Call F_Print(1)
.head 9 -  Call SalDisableWindow( T1.S )
.head 9 -  Call SalDisableWindow( T1.P )
.head 9 -  Call SalDisableWindow( T2.S )
.head 9 -  Call SalDisableWindow( T2.P )
.head 9 -  Call SalDisableWindow( T2.NAMK )
.head 9 -  Call SalDisableWindow( T2.MFOK )
.head 9 -  Call SalDisableWindow( T2.OKPOK )
.head 9 -  Call SalDisableWindow( T2.NLSK )
.head 9 -  Call SalDisableWindow( pb_F10 )
.head 9 -  Call SalDisableWindow( D1 )
.head 9 -  Call SalTblReset( D1 )
.head 9 -  !
.head 9 -  Call MessageNoWait('Введено пачку документів ','Повідомлення',3,0)
.head 9 -  Call SalEnableWindow( pb_F5 )
.head 9 -  !
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SalDisableWindow( pbRef )
.head 9 -  Set F_Opl = TRUE
.head 9 -  Call SalEnableWindow( pb_F1 )
.head 9 -  Call SalEnableWindow( pb_F2 )
.head 9 -  Call SalEnableWindow( pb_F3 )
.head 9 -  Call SalEnableWindow( pb_F4 )
.head 9 -  Call SalEnableWindow( pb_F8 )
.head 9 -  Call SalEnableWindow( pb_F9)
.head 9 -  Call MessageNoWait( IifS( rS !=NUMBER_Null, 'Сума док='||Str(rS), '' )|| sErr, 'Помилка !', 0, 1)
.head 4 +  Pushbutton: pb_F5
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F5. Надрукувати ПАЧКУ оплачених документів'
.head 6 +  On SAM_Click
.head 7 -  Call F_Print(2)
.head 4 +  Pushbutton: pb_Print1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.067"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\DOC.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip =
'Page
Down - Надрукувати квитанцію на поточний введений документ'
.head 6 +  On SAM_Click
.head 7 +  If nTAB = 1 and T1.S != NUMBER_Null
.head 8 +  If f_Prov1()
.head 9 -  Call F_Ottisk(T1.NAMK, dFIO, T1.S, T1.S2)
.head 9 -  ! Number: nSUMB
.head 9 -  ! Number: nSUMBK
.head 8 +  ! Else
.head 9 -                                                                      Call MessageNoWait( 'Сума док='|| Str(T1.S ) || sErr, 'Помилка !', 0, 1)
.head 7 +  Else If nTAB = 2 and T2.S != NUMBER_Null
.head 8 +  If f_Prov2()
.head 9 -  Call F_Ottisk(T2.NAMK, dFIO, T2.S, T2.S2)
.head 8 +  ! Else
.head 9 -                                                                      Call MessageNoWait( 'Сума док='|| Str(T2.S )|| sErr, 'Помилка !', 0, 1)
.head 4 +  Pushbutton: pb_New
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Новий '
.head 6 +  On SAM_Click
.head 7 -  Set F_Opl = FALSE
.head 7 -  Call F_tts()
.head 4 -  Line
.head 5 -  Resource Id: 10572
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.9"
.head 6 -  Begin Y:  -0.06"
.head 6 -  End X:  1.9"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbK_Val
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Periwinkle
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Купівля ВАЛЮТИ. Оп.'||AA1
.head 6 +  On SAM_Click
.head 7 -  Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'K_', NLS_CASH, AA1,dFIO, DatVal, pb_Exit, b840, b978, b643 )
.head 4 +  Pushbutton: pbP_Val
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.433"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Salmon
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Продаж ВАЛЮТИ. Оп.'|| AA2
.head 6 +  On SAM_Click
.head 7 -  Set hDocWdog = SalCreateWindow( Vkv, hWndForm, TOBO, 'P_', NLS_CASH, AA2,dFIO, DatVal, pb_Exit, b840, b978, b643 )
.head 4 -  Line
.head 5 -  Resource Id: 10573
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.95"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  2.95"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pb_Exit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.05"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'ESC. Завершити  '
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  ! !
.head 4 +  Pushbutton: pb_Null
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: BankName
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.183"
.head 7 -  Top:    0.048"
.head 7 -  Width:  2.967"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: BankOkpo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.617"
.head 7 -  Top:    0.048"
.head 7 -  Width:  2.067"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: BankMfo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.15"
.head 7 -  Top:    0.048"
.head 7 -  Width:  1.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  ! !
.head 4 +  Data Field: DatVal
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.8"
.head 7 -  Top:    0.095"
.head 7 -  Width:  1.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NLS_CASH
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.1"
.head 7 -  Top:    0.095"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Рахунок каси')
.head 4 +  Data Field: NMS_CASH
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.5"
.head 7 -  Top:    0.095"
.head 7 -  Width:  3.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pb_F11
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.65"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F11
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F11.Установити фокус на "ПРИЙНЯТО" '
.head 6 +  On SAM_Click
.head 7 -  Call SalSetFocus( SNAL )
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.133"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F12
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow( hWndItem )
.head 7 -  Set strTip = 'F12.Вибрати доп.реквізит з базового довідника'
.head 6 +  On SAM_Click
.head 7 +  If nBROWSER = 1
.head 8 -  Set sTmp = D1.VALUE
.head 7 +  Else
.head 8 -  Set sTmp = D2.VALUE
.head 7 -  Call SalModalDialog( dlgTagBrowse1, KP , gBROWSER, sTmp )
.head 7 +  If nBROWSER = 1
.head 8 -  Set D1.VALUE = sTmp
.head 8 -  Call SalSendMsg( D1.VALUE, SAM_Validate, 0, 0 )
.head 7 +  Else
.head 8 -  Set D2.VALUE = sTmp
.head 8 -  Call SalSendMsg( D2.VALUE, SAM_Validate, 0, 0 )
.head 4 +  Pushbutton: pb_F6
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F6
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BF6_.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'F6.Наслідувати доп.реквізити (*) з поперед.операції'
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute( hSql(),
  "UPDATE tmp_operw t
   SET value = (select MAX(value) from tmp_operw where tag=t.tag and value is not null)
WHERE value is null and
      tt=decode(:nTAB,1,:T1.TT, :T2.TT) and nom=decode(:nTAB,1,:T1.NOM,:T2.NOM) and
 tag in (select tag from OP_FIELD where substr(name,1,1)='*') ")
.head 8 -  Set nNOM = -1
.head 8 +  If nTAB = 2
.head 9 -  Call SalSetFocus( T2 )
.head 9 -  Call SalTblSetFocusRow( T2, nRow2 )
.head 9 -  Call SalSendMsg( T2, SAM_RowSetContext, 0, 0 )
.head 8 +  Else
.head 9 -  Call SalSetFocus( T1 )
.head 9 -  Call SalTblSetFocusRow( T1, nRow1 )
.head 9 -  Call SalSendMsg( T1, SAM_RowSetContext, 0, 0 )
.head 2 +  Contents
.head 3 +  Pushbutton: pb_F1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    0.012"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F1
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF1_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Green
.head 4 -  Background Color: Light Green
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F1.Розмножити БЛАНК ОТРИМУВАЧА '
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (1)
.head 6 -  Call SalSetFocus(pb_F2)
.head 6 -  Call SalSetFocus(T1)
.head 6 -  Call SalTblSetFocusRow(T1, nRow )
.head 6 -  Call SalTblSetFocusCell(T1, nRow, T1.S, 0, -1)
.head 3 +  Pushbutton: pb_F4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.567"
.head 5 -  Top:    0.0"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F4
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF4_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Green
.head 4 -  Background Color: Green
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F4. Розмножити з реквізитами ПЛАТНИКА '
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (4)
.head 6 -  Call SalSetFocus(pb_F2)
.head 6 -  Call SalSetFocus(T1)
.head 6 -  Call SalTblSetFocusRow(T1, nRow )
.head 6 -  Call SalTblSetFocusCell(T1, nRow, T1.S, 0, -1)
.head 3 -  !
.head 3 +  Pushbutton: pb_F2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    2.143"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F2
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF2_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Green
.head 4 -  Background Color: Sky
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F2.Розмножити БЛАНК'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (2)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 +  Pushbutton: pb_F3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    2.143"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F3
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF3_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Green
.head 4 -  Background Color: Light Aqua
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F3.Розмножити з реквізитами ОТРИМУВАЧА'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (3)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 +  Pushbutton: pb_F8
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.033"
.head 5 -  Top:    2.143"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F8
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF8_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Light Periwinkle
.head 4 -  Background Color: Cyan
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F8.Розмножити з реквізитами ПЛАТНИКА'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (8)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 +  Pushbutton: pb_F9
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.483"
.head 5 -  Top:    2.143"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F9
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\BF9_.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Light Periwinkle
.head 4 -  Background Color: Dark Aqua
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'F9.Розмножити з реквізитами ОТРИМУВАЧА та ПЛАТНИКА'
.head 5 +  On SAM_Click
.head 6 -  Call Fb_FK (9)
.head 6 -  Call SalSetFocus(pb_F1)
.head 6 -  Call SalSetFocus(T2)
.head 6 -  Call SalTblSetFocusRow(T2, nRow )
.head 6 -  Call SalTblSetFocusCell(T2, nRow, T2.S, 0, -1)
.head 3 -  !
.head 3 +  Child Table: T1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    0.321"
.head 6 -  Width:  8.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: NOM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Оп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SKP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СК
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отримувач по ГЕН.Угоді
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPOK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОКПО-Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Платіж
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If T1.S != NUMBER_Null
.head 9 -  Call SalMapEnterToTab( FALSE )
.head 8 +  Else
.head 9 -  Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 -  Call KP.f_Tochka ( 1, T1.S, NLS_CASH, BankMfo, NLSK, T1.S, T1.fS2 )
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_Enter and T1.S != NUMBER_Null
.head 9 -  Call SalSetFocus(NAZN1)
.head 9 -  ! Call SalSetFocus(D1)
.head 9 -  ! Call SalTblSetFocusRow(D1,0)
.head 9 -  ! Call SalTblSetFocusCell(D1, 0, D1.VALUE, 0, -1)
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( pb_Print1, COLOR_IndexWindow, COLOR_LightGreen )
.head 7 -  !
.head 5 +  Column: S2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ком
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-1
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-2
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VOB
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAZ_TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Доч оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: fS2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Форм ком
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: P
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пеня
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_FIO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NFILE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: f1
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nTAB = 1
.head 7 -  Set NAZN1 = IifS( T1.NAZ_TT = STRING_Null, T1.NAM_TT, T1.NAZ_TT )
.head 7 -  Set NAM_TT1 = T1.NAM_TT
.head 7 +  If T1.TT = sTT and T1.NOM = nNOM
.head 8 -  Return TRUE
.head 7 -  !
.head 7 -  Set sTT = T1.TT
.head 7 -  Set nNOM = T1.NOM
.head 7 -  Set sNAMK= T1.NAMK
.head 7 -  Set nRow = SalTblQueryContext( T1 )
.head 7 -  Set nRow1  = nRow
.head 7 +  If nRow > 13
.head 8 -  Set nRow = 13
.head 7 -  !
.head 7 -  Call SalTblPopulate(D1, hSql(),
 "SELECT o.tag, o.value, f.name, f.CHKR,  f.BROWSER, o.DVAL, o.OPT
  INTO :D1.TAG, :D1.VALUE, :D1.NAM_TAG, :D1.CHKR, :D1.BROWSER, :D1.DVAL, :D1.OPT
  FROM tmp_operw o, OP_FIELD f
  WHERE o.tag=f.tag and o.tt=:T1.TT and o.nom = :T1.NOM
  ORDER BY ord " , TBL_FillAll)
.head 7 -  Call SalTblSetContext( D1, 0 )
.head 7 -  Call SalTblSetRowFlags( D1, 0, ROW_Selected, TRUE )
.head 7 -  Call SalSendMsg( D1, SAM_RowSetContext, 0,0)
.head 7 -  Call SalEnableWindow (D1)
.head 7 -  Call SalDisableWindow (D2)
.head 7 -  Call SalDisableWindow (NAZN2)
.head 7 -  Return TRUE
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 -  ! Подвести доп.табл
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags( KP.T1, TBL_Flag_SelectableCols, TRUE )
.head 5 +  On SAM_SetFocus
.head 6 -  Call T1.f1( )
.head 5 +  On SAM_RowSetContext
.head 6 -  Call T1.f1( )
.head 5 -  ! Печатать тикет
.head 5 +  On SAM_DoubleClick
.head 6 +  If T1.REF1 != NUMBER_Null
.head 7 -  Call DocsPrint ( T1.REF1, 'OPER', FALSE )
.head 5 +  On WM_RbuttonUp
.head 6 +  If T1.REF2 != NUMBER_Null
.head 7 -  Call DocsPrint ( T1.REF2, 'OPER', FALSE )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd1 = not bSortOrd1
.head 6 -  Call SalTblSortRows( KP.T1 , SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd1 )
.head 3 +  Data Field: NAM_TT1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Назва операції')
.head 3 -  Background Text: Признач.пл.-1
.head 4 -  Resource Id: 10570
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.2"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: NAZN1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    0.071"
.head 6 -  Width:  5.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Призначення платежу-1')
.head 5 +  On SAM_Validate
.head 6 -  Set T1.NAZ_TT = NAZN1
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_SetFocus
.head 6 +  If NAZN1 = STRING_Null
.head 7 -  Set NAZN1 = T1.NAM_TT
.head 6 -  Call SalMapEnterToTab( FALSE )
.head 5 -  !
.head 5 +  On VTM_KeyUp
.head 6 +  If wParam = VK_Enter
.head 7 -  Call SalSetFocus(D1)
.head 7 -  Call SalTblSetFocusRow(D1,0)
.head 7 -  Call SalTblSetFocusCell(D1, 0, D1.VALUE, 0, -1)
.head 3 +  Child Table: D1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.9"
.head 6 -  Top:    0.31"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.762"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: TAG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: TAG
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_TAG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вопрос
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VALUE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Деталі
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalMapEnterToTab( TRUE )
.head 8 -  Set nBROWSER = 1
.head 8 +  If Subs(D1.TAG,1,3)='FIO' and  dFIO !=STRING_Null
.head 9 -  Set D1.VALUE = dFIO
.head 9 -  Set T1.NAM_FIO = dFIO
.head 9 -  If SqlPrepareAndExecute( hSql(),
  "update tmp_operw set VALUE =:D1.VALUE where tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM ")
.head 8 +  ! If Subs(D1.TAG,1,3)='FIO' and D1.VALUE = STRING_Null and dFIO !=STRING_Null
.head 9 -                                      Set D1.VALUE = dFIO
.head 9 -                                      Set T1.NAM_FIO = dFIO
.head 9 -                                      If SqlPrepareAndExecute( hSql(),
  "update tmp_operw set VALUE =:D1.VALUE where tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM ")
.head 8 -  Call F_Focus (D1.DVAL, D1.BROWSER)
.head 7 +  On SAM_Validate
.head 8 -  Set D1.VALUE = SalStrTrimX( D1.VALUE )
.head 8 -  If not F_Tag( D1.CHKR, SalStrTrimX(D1.TAG), SalStrTrimX(D1.VALUE), D1.OPT  )
.head 8 -  If SqlPrepareAndExecute( hSql(),
  "update tmp_operw set VALUE =:D1.VALUE where tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM ")
.head 8 +  If Subs(D1.TAG,1,3)='?LC'
.head 9 +  If D1.VALUE  != STRING_Null
.head 10 -  Set sLC = D1.VALUE
.head 10 +  If SqlPrepareAndExecute( hSql(),
  "SELECT S, fio, Nvl(TAG,0)
   INTO :T1.S, :dFIO , :nTag
   FROM KP_FILE
   WHERE tt=:T1.TT and lc=:sLC ")
and not SqlFetchNext( hSql(), nFetchRes )
.head 11 -  Call SalMessageBox(" LC="|| D1.VALUE ||" не знайдено в БД (KP_FILE), tt=" ||T1.TT ,
 "УВАГА !", MB_IconStop )
.head 10 +  Else
.head 11 -  Set T1.NAM_FIO = dFIO
.head 11 -  Call SalSendMsg( T1.S, SAM_Validate, 0, 0 )
.head 11 +  If nTag = 1
.head 12 -  Set nRowD1 = TBL_MinRow
.head 12 +  While SalTblFindNextRow( D1, nRowD1, 0, 0 )
.head 13 -  Call SalTblSetContext( D1, nRowD1 )
.head 13 -  If SqlPrepareAndExecute( hSql(),
"SELECT value INTO :D1.VALUE
 FROM KP_TAG where TT=:T1.TT and LC=:sLC and TAG=:D1.TAG")
and SqlFetchNext( hSql(), nFetchRes )
and SqlPrepareAndExecute( hSql(),
"UPDATE tmp_operw
 SET VALUE =:D1.VALUE
 WHERE tt=:T1.TT and tag=:D1.TAG and nom=:T1.NOM")
.head 9 +  Else
.head 10 -  Call SalMessageBox(" LC="|| D1.VALUE ||" НЕ заповнено ! ", "УВАГА !", MB_IconStop )
.head 8 +  If Subs(D1.TAG,1,3)='FIO'
.head 9 -  Set T1.NAM_FIO = dFIO
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_PageDown and T1.S != NUMBER_Null
.head 9 -  Call SalSendMsg( pb_Print1, SAM_Click, 0, 0 )
.head 5 +  Column: CHKR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BROWSER
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DVAL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OPT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nTag
.head 5 -  Number: nRowD1
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 +  If OPT !='O'
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Green )
.head 6 +  Else
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, nCol1 )
.head 5 +  On SAM_RowSetContext
.head 6 -  Call SalTblSetColumnTitle( D1.VALUE, D1.NAM_TAG )
.head 6 -  Call SalSendMsg( D1.VALUE, SAM_SetFocus, 0, 0 )
.head 5 -  On SAM_SetFocus
.head 3 -  !
.head 3 -  !
.head 3 +  Child Table: T2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    2.548"
.head 6 -  Width:  8.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.393"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: NOM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Оп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SKP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СК
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_SetFocus
.head 8 +  ! If SKP =NUMBER_Null
.head 9 -                                                                                                   Set T2.SKP = 5
.head 8 -                                                                                       Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 -  Set dTmp ='Помилка СКП'
.head 8 +  If SqlPrepareAndExecute( hSql(), "SELECT name INTO :dTmp from sk where sk=:T2.SKP and sk <40 " )
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Return VALIDATE_Ok
.head 8 -  Return VALIDATE_Cancel
.head 5 +  Column: NAMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: безпосередній Отримувач
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.617"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_SetFocus
.head 8 -  ! Call T2.f1()
.head 8 -                                                                                       Call SalMapEnterToTab( TRUE )
.head 5 +  Column: MFOK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 +  If FLI = 0 and MFOK = STRING_Null and KP_SIGN =1
.head 9 -  Set MFOK = BankMfo
.head 9 -  Set dTmp = BankName
.head 8 -  ! Call T2.f1()
.head 8 -  ! Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 +  If T2.MFOK = STRING_Null
.head 9 -  Set S =0
.head 9 -  Call SalSendMsg( T2.S, SAM_AnyEdit, 0, 0 )
.head 9 -  Call SalSendMsg( T2.S, SAM_Validate, 0, 0 )
.head 9 -  Return VALIDATE_Ok
.head 8 +  If T2.MFOK = BankMfo
.head 9 -  Set dTmp = BankName
.head 8 +  If FLI = 0 and MFOK !=BankMfo
or T2.MFOK != STRING_Null and
   SqlPrepareAndExecute( hSql(),"SELECT nb INTO :dTmp from banks where mfo=:T2.MFOK" )
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Return VALIDATE_Ok
.head 8 -  !
.head 8 -  Set dTmp ='Помилка МФО-Б'
.head 8 -  Return VALIDATE_Cancel
.head 5 +  Column: NLSK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_SetFocus
.head 8 -  ! Call T2.f1()
.head 8 -                                                                                       Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 +  If T2.NLSK != STRING_Null and T2.NLSK != KeyAccount(T2.MFOK,T2.NLSK)
or T2.MFOK = BankMfo and
SqlPrepareAndExecute( hSql(),"SELECT a.nms, c.okpo INTO :T2.NAMK,:T2.OKPOK
 FROM accounts a, cust_acc u, customer c
 WHERE a.kv=:n980 and a.nls=:T2.NLSK and a.acc=u.acc and u.rnk=c.rnk " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Set dTmp ='Помилка Рах-Б'
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set dTmp = STRING_Null
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: OKPOK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ід.код-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_SetFocus
.head 8 -  ! Call T2.f1()
.head 8 -                                                                                       Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 +  If T2.OKPOK != STRING_Null and T2.OKPOK != V_Okpo(T2.OKPOK)
.head 9 -  Set dTmp ='Помилка Ід.код-Б'
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set dTmp = STRING_Null
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Платіж
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If T2.S != NUMBER_Null
.head 9 -  Call SalMapEnterToTab( FALSE )
.head 8 +  Else
.head 9 -  Call SalMapEnterToTab( TRUE )
.head 7 +  On SAM_Validate
.head 8 -  Call KP.f_Tochka ( 2, T2.S, NLS_CASH, MFOK, NLSK, T2.S, T2.fS2 )
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_Enter and T2.S != NUMBER_Null
.head 9 -  Call SalSetFocus(NAZN2)
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalColorSet( pb_Print1, COLOR_IndexWindow, COLOR_Sky )
.head 5 +  Column: S2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ком
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VOB
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-1
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: REF-2
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAZ_TT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: TT2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Доч оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: fS2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Форм ком
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: P
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пеня
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FLI
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Флаг МБ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_FIO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.оп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  !
.head 4 +  Functions
.head 5 +  Function: f1
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nTAB = 2
.head 7 -  Set NAZN2 = T2.NAZ_TT
.head 7 -  Set NAM_TT2 =T2.NAM_TT
.head 7 +  If T2.TT = sTT and T2.NOM = nNOM
.head 8 -  Return TRUE
.head 7 -  !
.head 7 -  Set sTT = T2.TT
.head 7 -  Set nNOM = T2.NOM
.head 7 -  Set sNAMK= T2.NAMK
.head 7 -  Set nRow = SalTblQueryContext( T2 )
.head 7 -  Set nRow2  = nRow
.head 7 +  If nRow > 2
.head 8 -  Set nRow =2
.head 7 -  !
.head 7 -  Call SalTblPopulate(D2, hSql(),
 "SELECT o.tag, o.value, f.name, f.CHKR, f.BROWSER, o.DVAL, o.OPT
  INTO :D2.TAG, :D2.VALUE, :D2.NAM_TAG, :D2.CHKR, :D2.BROWSER, :D2.DVAL, :D2.OPT
  FROM tmp_operw o, OP_FIELD f
  WHERE o.tag=f.tag and o.tt=:T2.TT and o.nom = :T2.NOM
  ORDER BY ord " , TBL_FillAll)
.head 7 -  Call SalSetFocus( NAZN2 )
.head 7 -  Call SalDisableWindow (D1)
.head 7 -  Call SalEnableWindow (D2)
.head 7 -  Call SalEnableWindow (NAZN2)
.head 7 -  Return TRUE
.head 5 +  Function: f_ALIEN
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: FLI       ! флаг межбанк
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTmp
.head 7 -  String: sNSI
.head 6 +  Actions
.head 7 -  Set dTmp = STRING_Null
.head 7 -  Set sNSI = " kv=" || Str(n980) || " and NLSALT is not null "
.head 7 +  If KP_SIGN =1
.head 8 -  Set sNSI = sNSI || " and  mfo " || IifS( FLI=1, "<>", "=" ) || BankMfo
.head 7 -  Set sNSI = sNSI || " order by nlsalt "
.head 7 -  Call FunNSIGetFiltered('ALIEN','NLSALT', sNSI, sTmp, sNlsAlt )
.head 7 +  If sTmp =  STRING_Null
.head 8 -  Return FALSE
.head 7 -  Return 
SqlPrepareAndExecute( hSql(),
   "SELECT MFO, NLS, OKPO, substr(ltrim(rtrim(NAME)),1,38)
    INTO :MFOK, :NLSK, :OKPOK, :NAMK FROM alien WHERE nlsalt=:sNlsAlt " )
and
SqlFetchNext( hSql(), nFetchRes )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 -  ! Подвести доп.табл
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags( KP.T2, TBL_Flag_SelectableCols, TRUE )
.head 5 +  On SAM_SetFocus
.head 6 -  Call T2.f1()
.head 5 +  On SAM_RowSetContext
.head 6 -  Call T2.f1()
.head 5 -  ! Печатать тикет
.head 5 +  On SAM_DoubleClick
.head 6 +  If T2.REF1 != NUMBER_Null
.head 7 -  Call DocsPrint ( T2.REF1, 'OPER', FALSE )
.head 6 +  Else
.head 7 -  Call T2.f_ALIEN (T2.FLI)
.head 5 +  On WM_RbuttonUp
.head 6 +  If T2.REF2 != NUMBER_Null
.head 7 -  Call DocsPrint ( T2.REF2, 'OPER', FALSE )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd2 = not bSortOrd2
.head 6 -  Call SalTblSortRows( KP.T2 , SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd2 )
.head 3 +  Data Field: NAM_TT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    2.155"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Sky
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Назва операції')
.head 3 +  Data Field: dfTextNAZN2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NAZN2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    4.024"
.head 6 -  Width:  6.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Cyan
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Призначення платежу-2')
.head 5 +  On SAM_Validate
.head 6 +  If NAZN2 = STRING_Null or SalStrLength( NAZN2 ) < 3
.head 7 -  Call SalMessageBox("Не заповнено Призначення платежу", "Увага !", MB_IconStop)
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set T2.NAZ_TT = NAZN2
.head 6 -  Return VALIDATE_Ok
.head 6 -  !
.head 5 +  On VTM_LeftDoubleClick
.head 6 -  Set sTipNazn = SalStrLeftX( SalStrRightX( '000000'||sNlsAlt, 6 ), 3 )
.head 6 -  ! Set sTipNazn = STRING_Null
.head 6 -  Call FunNSIGetFiltered('ALIEN_NAZN','NAZN',
    ' IDT= '|| sTipNazn ||' or IDT is null  order by IDN', sTipNazn, NAZN2 )
.head 6 -  Call SalSendMsg( NAZN2, SAM_Validate, 0, 0 )
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( FALSE )
.head 5 +  On VTM_KeyUp
.head 6 +  If wParam = VK_Enter
.head 7 -  Call SalSetFocus(D2)
.head 7 -  Call SalTblSetFocusRow(D2,0)
.head 7 -  Call SalTblSetFocusCell(D2, 0, D2.VALUE, 0, -1)
.head 3 +  Child Table: D2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    2.393"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.524"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: TAG ! 1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: TAG
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_TAG ! 2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вопрос
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VALUE ! 3
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Деталі
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set nBROWSER = 2
.head 8 +  If Subs(D2.TAG,1,3) ='FIO' and D2.VALUE = STRING_Null and dFIO != STRING_Null
.head 9 -  Set D2.VALUE = dFIO
.head 9 -  Set T2.NAM_FIO = dFIO
.head 9 -  If SqlPrepareAndExecute( hSql(),
  "update tmp_operw set VALUE =:D2.VALUE where tt=:T2.TT and tag=:D2.TAG and nom=:T2.NOM ")
.head 8 -  Call F_Focus (D2.DVAL, D2.BROWSER)
.head 7 +  On SAM_Validate
.head 8 -  If not F_Tag( D2.CHKR, SalStrTrimX(D2.TAG), SalStrTrimX(D2.VALUE), D2.OPT )
.head 8 +  If Subs(D2.TAG,1,3)='FIO'
.head 9 -  Set T2.NAM_FIO = dFIO
.head 8 -  If SqlPrepareAndExecute( hSql(),
  "update tmp_operw set VALUE =:D2.VALUE where tt=:T2.TT and tag=:D2.TAG and nom=:T2.NOM ")
.head 8 -  Return VALIDATE_Ok
.head 7 +  On VTM_KeyUp
.head 8 +  If wParam = VK_PageDown and T2.S != NUMBER_Null
.head 9 -  Call SalSendMsg( pb_Print1, SAM_Click, 0, 0 )
.head 7 -  !
.head 5 +  Column: CHKR  ! 4
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BROWSER ! 6
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DVAL ! 7
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OPT ! 8
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CHKR
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_FetchRowDone
.head 6 +  If OPT !='O'
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightAqua )
.head 6 +  Else
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 220,255,255 ) ) ! голубой
.head 5 +  On SAM_RowSetContext
.head 6 -  Call SalTblSetColumnTitle( D2.VALUE, D2.NAM_TAG )
.head 6 -  ! Call SalSendMsg( D2.VALUE, SAM_SetFocus, 0, 0 )
.head 3 +  Data Field: SNAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    4.714"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Прийнято у клієнта')
.head 5 +  On SAM_SetFocus
.head 6 +  If SNAL = 0
.head 7 -  Set SNAL = NUMBER_Null
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_KillFocus
.head 6 -  Call KP.f_Tochka ( 0, NUMBER_Null, STRING_Null,STRING_Null,STRING_Null, SNAL,  STRING_Null )
.head 6 +  If STOTAL > 0
.head 7 +  If SNAL < STOTAL or SNAL=NUMBER_Null
.head 8 -  Call SalMessageBox(" НЕДОСТАТЧА коштів, чи помилка суми ! ", "УВАГА !", MB_IconStop)
.head 8 -  Set SNAL = NUMBER_Null
.head 8 -  Set SDEL = 0
.head 7 +  Else
.head 8 -  Set SDEL = SNAL - STOTAL
.head 8 -  Set ml1 = SumPr(  STOTAL *100, 'F', 'Грн' , "коп" )
.head 8 -  Set ml2 = SumPr(  SDEL *100, 'F', 'Грн' , "коп" )
.head 8 -  Set ml3 = NumberPr( SKOL, "M" )
.head 8 +  If yRef = 0
.head 9 -  Call SalEnableWindow( pb_F10 )
.head 9 -  Set F_Opl = TRUE
.head 5 -  !
.head 3 -  !
.head 3 +  Data Field: NLS_NLK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.012"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Рахунок-транзит (без ген.угоди)')
.head 3 -  !
.head 3 -  Background Text: Платник
.head 4 -  Resource Id: 10571
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    4.524"
.head 5 -  Width:  0.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dTmp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    5.167"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Salmon
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Підказки')
.head 3 +  Data Field: dFIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.762"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Cyan
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'ПІБ')
.head 3 +  Data Field: STOTAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    4.321"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Сума платежів')
.head 3 +  Data Field: ml1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.167"
.head 6 -  Top:    4.369"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Сума платежів прописом')
.head 3 +  Data Field: SDEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.5"
.head 6 -  Top:    5.119"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Повернути клієнту')
.head 3 +  Data Field: ml2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.15"
.head 6 -  Top:    5.167"
.head 6 -  Width:  4.617"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Повернути клієнту прописом')
.head 3 +  Data Field: ml3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.45"
.head 6 -  Top:    4.762"
.head 6 -  Width:  3.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Кількість платежів прописом')
.head 3 +  Data Field: SKOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.15"
.head 6 -  Top:    4.714"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Кількість платежів')
.head 3 +  Data Field: KKOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    4.714"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Кількість комісій')
.head 3 +  Data Field: sTOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    4.369"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: TOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.25"
.head 6 -  Top:    4.0"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTextSTOTAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTextSNAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTextSDEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    4.119"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_tts
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Подготовить таблиці
.head 5 -  Set F_Opl = FALSE
.head 5 -  Call SalDisableWindow( pb_F10 )
.head 5 -  Call SalDisableWindow( pb_F5 )
.head 5 -  Call SalEnableWindow( SNAL )
.head 5 -  Set dTmp = STRING_Null
.head 5 -  Set dFIO = STRING_Null
.head 5 -  Set STOTAL = 0
.head 5 -  Set ml1 = ""
.head 5 -  Set SDEL = 0
.head 5 -  Set ml2 = ""
.head 5 -  Set ml3 = ""
.head 5 -  Set SNAL = 0
.head 5 -  Set SKOL = 0
.head 5 -  Set KKOL = 0
.head 5 -  Set yRef = 0
.head 5 -  !
.head 5 -  Set sTT= '   '
.head 5 -  Set nNOM = 0
.head 5 -  Set g_NOM = 0
.head 5 -  If SqlPrepareAndExecute( hSql(), "delete from tmp_operw ") and
  SqlPrepareAndExecute( hSql(),
  "insert into tmp_operw (tt,tag,NOM, ord, VALUE,  DVAL, OPT )
   select tt, tag, 0, ord, val,  VAL, OPT
   from OP_RULES WHERE USED4INPUT=1 and TT IN (SELECT TT FROM FOLDERS_tts WHERE IDFO=:nPap) ")
.head 5 -  !
.head 5 -  Call SalDisableWindow (D1)
.head 5 -  Call SalTblReset( T1 )
.head 5 -  Call SalTblReset( D1 )
.head 5 -  Set NAZN1 = STRING_Null
.head 5 -  Call SalEnableWindow( T1.P )
.head 5 -  Call SalEnableWindow( T1.S )
.head 5 -  Call SalEnableWindow( pb_F1 )
.head 5 -  Call SalEnableWindow( pb_F4 )
.head 5 -  Call SalEnableWindow( pb_F2 )
.head 5 -  Call SalEnableWindow( pb_F3 )
.head 5 -  Call SalEnableWindow( pb_F8 )
.head 5 -  Call SalEnableWindow( pb_F9 )
.head 5 -  ! зеленіе операции
.head 5 -  Call SalTblPopulate(T1, hSql(),
 "SELECT T.tt, a.NLS, substr(a.nms,1,38), NVL(t.NAZN, t.name),
         C.OKPO, v.VOB, 0, d.tt, d.s, nvl(t.sk,5)
  into :T1.TT,:T1.NLSK,:T1.NAMK,:T1.NAM_TT,
       :T1.OKPOK,:T1.VOB,:T1.NOM,:T1.TT2,:T1.fS2,:T1.SKP
  FROM tts T, ACCOUNTS A, CUST_ACC U, CUSTOMER C, tts_vob v, tts d, ttsap ap
  WHERE v.tt=t.tt and A.KV=:n980 AND A.NLS=T.NLSA AND A.ACC=U.ACC AND U.RNK=C.RNK AND
        t.nlsa is not null and t.nlsa<>:NLS_NLK and
        t.nlsb is null and
        T.TT IN (SELECT TT FROM FOLDERS_tts WHERE IDFO=:nPap) and
        t.tt = ap.tt (+) and d.tt (+) = ap.ttap
   ORDER BY a.nms " , TBL_FillAll)
.head 5 -  !
.head 5 -  Set bSortOrd1 = FALSE
.head 5 -  Call SalTblReset( T2 )
.head 5 -  Call SalTblReset( D2 )
.head 5 -  Call SalEnableWindow( T2.P )
.head 5 -  Call SalEnableWindow( T2.S )
.head 5 -  Call SalEnableWindow( T2.NAMK )
.head 5 -  Call SalEnableWindow( T2.MFOK )
.head 5 -  Call SalEnableWindow( T2.OKPOK )
.head 5 -  Call SalEnableWindow( T2.NLSK )
.head 5 -  Call SalEnableWindow (D2)
.head 5 -  Set NAZN2 = STRING_Null
.head 5 -  Call SalTblPopulate(T2, hSql(),
 "SELECT T.tt, t.name,  v.VOB, 0, d.tt, d.s, t.FLI,  t.sk
  into :T2.TT, :T2.NAM_TT, :T2.VOB,:T2.NOM, :T2.TT2, :T2.fS2, :T2.FLI, :T2.SKP
  FROM tts T, tts_vob v, tts d, ttsap ap
  WHERE v.tt=t.tt  AND t.fli<=:KP_SIGN and
        (t.nlsa=:NLS_NLK or t.nlsa is null ) and t.nlsb is null  and
        T.TT IN (SELECT TT FROM FOLDERS_tts WHERE IDFO=:nPap) and
        t.tt = ap.tt (+) and d.tt (+) = ap.ttap
ORDER BY t.name " , TBL_FillAll)
.head 5 -  Set bSortOrd2 = FALSE
.head 5 -  Call SalDisableWindow( pbRef )
.head 5 -  Call F_Ref (0)
.head 5 -  Call SalSetFocus( T1 )
.head 5 -  Call SalTblSetRow( T1, TBL_MinRow )
.head 5 -  Call SalSetFocus( T1.S )
.head 3 +  Function: Fb_FK
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nFK
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: TT_
.head 5 -  String: NAM_TT_
.head 5 -  String: NFILE_
.head 5 -  Number: VOB_
.head 5 -  Number: SKP_
.head 5 -  Number: NOM_
.head 5 -  Number: FLI_
.head 5 -  String: TT2_
.head 5 -  String: fS2_
.head 5 -  !
.head 5 -  String: NAMK_
.head 5 -  String: MFOK_
.head 5 -  String: OKPOK_
.head 5 -  String: NLSK_
.head 5 -  String: NAM_FIO_
.head 4 +  Actions
.head 5 -  Set g_NOM  = g_NOM + 1
.head 5 -  ! Голубая
.head 5 +  If (nFK = 2 or nFK = 8) or (nFK = 3 or nFK = 9)
.head 6 -  Set NAM_FIO_ = T2.NAM_FIO
.head 6 -  Set TT_  = T2.TT
.head 6 -  Set SKP_  = T2.SKP
.head 6 -  Set FLI_ = T2.FLI
.head 6 -  Set NAM_TT_=T2.NAM_TT
.head 6 -  Set TT2_ = T2.TT2
.head 6 -  Set fS2_ = T2.fS2
.head 6 -  Set VOB_ = T2.VOB
.head 6 -  Set NOM_ = T2.NOM
.head 6 +  If nFK = 3 or nFK = 9
.head 7 -  Set NAMK_= T2.NAMK
.head 7 -  Set MFOK_= T2.MFOK
.head 7 -  Set OKPOK_=T2.OKPOK
.head 7 -  Set NLSK_= T2.NLSK
.head 6 -  !
.head 6 -  Set nRow = SalTblQueryContext ( T2 )
.head 6 -  Set nRow = SalTblInsertRow( T2, nRow + 1)
.head 6 -  Call SalTblSetContext(T2, nRow )
.head 6 -  Call SalTblSetRowFlags( T2, nRow, ROW_New, FALSE )
.head 6 -  !
.head 6 -  Set T2.NAM_FIO = NAM_FIO_
.head 6 -  Set T2.TT  = TT_
.head 6 -  Set T2.SKP = SKP_
.head 6 -  Set T2.FLI = FLI_
.head 6 -  Set T2.NAM_TT=NAM_TT_
.head 6 -  Set T2.TT2 = TT2_
.head 6 -  Set T2.fS2 = fS2_
.head 6 -  Set T2.VOB = VOB_
.head 6 -  Set T2.NOM = g_NOM
.head 6 +  If nFK = 3 or nFK = 9
.head 7 -  Set T2.NAMK = NAMK_
.head 7 -  Set T2.MFOK = MFOK_
.head 7 -  Set T2.OKPOK= OKPOK_
.head 7 -  Set T2.NLSK = NLSK_
.head 7 -  Set T2.NAZ_TT = NAZN2
.head 5 -  ! Зеленая
.head 5 +  Else If nFK = 1 or nFK = 4
.head 6 -  Set NAM_FIO_ = T1.NAM_FIO
.head 6 -  Set TT_  = T1.TT
.head 6 -  Set SKP_ = T1.SKP
.head 6 -  Set NAM_TT_=T1.NAM_TT
.head 6 -  Set TT2_ = T1.TT2
.head 6 -  Set fS2_ = T1.fS2
.head 6 -  Set VOB_ = T1.VOB
.head 6 -  Set NOM_ = T1.NOM
.head 6 -  Set NAMK_= T1.NAMK
.head 6 -  Set OKPOK_=T1.OKPOK
.head 6 -  Set NLSK_= T1.NLSK
.head 6 -  Set NFILE_=T1.NFILE
.head 6 -  !
.head 6 -  Set nRow = SalTblQueryContext ( T1 )
.head 6 -  Set nRow = SalTblInsertRow( T1, nRow + 1)
.head 6 -  Call SalTblSetContext(T1, nRow )
.head 6 -  Call SalTblSetRowFlags( T1, nRow, ROW_New, FALSE )
.head 6 -  !
.head 6 -  Set T1.NAM_FIO = NAM_FIO_
.head 6 -  Set T1.TT  = TT_
.head 6 -  Set T1.NFILE=NFILE_
.head 6 -  Set T1.SKP = SKP_
.head 6 -  Set T1.NAM_TT=NAM_TT_
.head 6 -  Set T1.NAZ_TT=NAM_TT_
.head 6 -  Set T1.TT2 = TT2_
.head 6 -  Set T1.fS2 = fS2_
.head 6 -  Set T1.VOB = VOB_
.head 6 -  Set T1.NAMK= NAMK_
.head 6 -  Set T1.OKPOK=OKPOK_
.head 6 -  Set T1.NLSK= NLSK_
.head 6 -  Set T1.NOM = g_NOM
.head 6 +  If nFK = 1
.head 7 -  Set T1.NAZ_TT = NAZN1
.head 5 -  !
.head 5 -  If SqlPrepareAndExecute( hSql(),
 "INSERT INTO tmp_operw ( tt, tag, NOM, VALUE, ord,  BROWSER, DVAL, OPT )
  SELECT tt, tag, :g_NOM,
        Decode( :nFK, 1,DVAL, 2,DVAL,3,DVAL, VALUE ),
        ord,  BROWSER, DVAL, OPT
   from tmp_operw where TT=:TT_ and nom=:NOM_ ")
.head 5 -  Return TRUE
.head 3 +  Function: f_Tochka
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMod
.head 5 -  Number: S
.head 5 -  String: NLSA
.head 5 -  String: MFOB
.head 5 -  String: NLSB
.head 5 -  Window Handle: hWnd
.head 5 -  String: sS2
.head 4 +  Static Variables
.head 5 -  String: sTmp
.head 4 +  Local variables
.head 5 -  String: aS
.head 5 -  String: sSQL
.head 5 -  Number: nS2
.head 4 +  Actions
.head 5 -  Set nROW1 = SalTblQueryContext ( T1 )
.head 5 -  Set nROW2 = SalTblQueryContext ( T2 )
.head 5 -  Set sTmp=SalStrRepeatX( ' ', 20 )
.head 5 -  Call SalGetWindowText ( hWnd, sTmp, 20 )
.head 5 +  While SalStrScan(sTmp, sDecimal2) > 0
.head 6 -  Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
.head 5 -  Call SalFmtStrToField ( hWnd, sTmp, TRUE)
.head 5 +  If nMod >0
.head 6 -  !
.head 6 -  ! Формула суммы комиссии #(S), #(KVA), #(KVB), #(NLSA), #(NLSB), #(MFOA), #(MFOB)
.head 6 +  If sS2 != STRING_Null and S > 0
.head 7 -  Set sSQL = SalStrUpperX(' ' || sS2 )
.head 7 -  Set sSQL = ' ' || sS2
.head 7 -  Set aS  = SalNumberToStrX(S * 100, 0)     ! Сумма платежа
.head 7 +  While SalStrScan( sSQL, '#(S)' ) > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL, '#(S)' ), 4, aS )
.head 7 +  While SalStrScan( sSQL, '#(KVA)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(KVA)'), 6, Str(n980))
.head 7 +  While SalStrScan( sSQL, '#(KVB)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(KVB)'), 6, Str(n980))
.head 7 +  While SalStrScan( sSQL, '#(NLSA)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(NLSA)'), 7, NLSA)
.head 7 +  While SalStrScan( sSQL, '#(NLSB)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(NLSB)'), 7, NLSB)
.head 7 +  While SalStrScan( sSQL, '#(MFOA)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(MFOA)'), 7, BankMfo )
.head 7 +  While SalStrScan( sSQL, '#(MFOB)') > 0
.head 8 -  Set sSQL = SalStrReplaceX( sSQL, SalStrScan( sSQL,'#(MFOB)'), 7, MFOB )
.head 7 -  Set sSQL = "SELECT ROUND(" || sSQL || ",0) INTO :nS2 FROM dual"
.head 7 +  If SqlPrepareAndExecute( hSql(), sSQL ) and SqlFetchNext(hSql(),nFetchRes)
.head 8 -  Set nS2 = nS2 /100
.head 7 +  Else
.head 8 -  Set nS2 =0
.head 6 +  Else
.head 7 -  Set nS2 = NUMBER_Null
.head 6 +  If nMod = 1
.head 7 -  Call SalSetFocus( NAZN1 )
.head 7 -  ! Call SalTblSetFocusCell( D1, 0, D1.VALUE, 0, 1 )
.head 7 -  ! Call SalSendMsg( D1, SAM_RowSetContext, 0, 0 )
.head 7 -  Set T1.S2 = nS2
.head 6 +  Else
.head 7 -  Call SalSetFocus( NAZN2 )
.head 7 -  Set T2.S2 = nS2
.head 6 -  Set STOTAL =
SalTblColumnSum( T1, SalTblQueryColumnID( T1.S ), 0, 0 ) +
SalTblColumnSum( T1, SalTblQueryColumnID( T1.S2), 0, 0 ) +
SalTblColumnSum( T2, SalTblQueryColumnID( T2.S ), 0, 0 ) +
SalTblColumnSum( T2, SalTblQueryColumnID( T2.S2), 0, 0 )
.head 6 -  Call F_Kol()
.head 5 -  Call SalTblSetContext(T1, nROW1)
.head 5 -  Call SalTblSetContext(T2, nROW2)
.head 5 -  ! Call SalMapEnterToTab( TRUE )
.head 5 -  Return TRUE
.head 3 +  Function: F_Print
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMod
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T1, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T1, nRow)
.head 6 +  If T1.REF1 != NUMBER_Null and nMod= 2
.head 7 -  Call DocsPrint ( T1.REF1, 'OPER', FALSE )
.head 6 +  If T1.REF2 != NUMBER_Null
.head 7 -  Call DocsPrint ( T1.REF2, 'OPER', FALSE )
.head 5 -  !
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T2, nRow)
.head 6 +  If T2.REF1 != NUMBER_Null
.head 7 -  Call DocsPrint ( T2.REF1, 'OPER', FALSE )
.head 6 +  If T2.REF2 != NUMBER_Null
.head 7 -  Call DocsPrint ( T2.REF2, 'OPER', FALSE )
.head 3 +  Function: F_Kol
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set SKOL = 0
.head 5 -  Set KKOL = 0
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T1, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T1, nRow)
.head 6 +  If T1.S > 0
.head 7 -  Set SKOL = SKOL +1
.head 6 +  If T1.S2 > 0
.head 7 -  Set KKOL = KKOL +1
.head 5 -  !
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(T2, nRow)
.head 6 +  If T2.S > 0
.head 7 -  Set SKOL = SKOL +1
.head 6 +  If T2.S2 > 0
.head 7 -  Set KKOL = KKOL +1
.head 3 +  Function: F_Tag
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sCHKR
.head 5 -  String: sTag
.head 5 -  String: sValue
.head 5 -  String: sOpt
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bFL
.head 4 +  Actions
.head 5 +  If Subs(sTag,1,3)='FIO' and sValue != STRING_Null
.head 6 -  Set dFIO = sValue
.head 5 -  ! Если sValue = STRING_Null
.head 5 -  ! и не обяз  != M не проверять
.head 5 -  Set bFL = TRUE
.head 5 -  ! Обязательный, но пустой
.head 5 +  If sOpt ='M' and sValue = STRING_Null
.head 6 -  Set bFL = FALSE
.head 5 -  ! не пустой, но есть проверка и он ее не проходит
.head 5 +  If sValue != STRING_Null and sCHKR != STRING_Null
.head 6 +  If SqlPrepareAndExecute( hSql(), "SELECT C_TAG (:sTag,:sValue) INTO :nC_TAG from dual ")
and SqlFetchNext( hSql(), nFetchRes )
and nC_TAG = 0
.head 7 -  Set bFL = FALSE
.head 5 -  ! Плохо дело
.head 5 +  If not bFL
.head 6 +  If nBROWSER = 1
.head 7 -  Set D1.VALUE = sNOT
.head 7 -  Call XSalTblSetCellBackColor( D1.VALUE , nCol )
.head 6 +  Else
.head 7 -  Set D2.VALUE = sNOT
.head 7 -  Call XSalTblSetCellBackColor( D2.VALUE , nCol )
.head 6 -  Set sErr = " Помилка доп.реквізиту "|| sTag
.head 6 -  Call SalMessageBox( sErr, "Увага !", MB_IconStop)
.head 5 -  Return bFL
.head 3 +  Function: F_Focus
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sVALUE
.head 5 -  String: sBROWSER
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sNOT = sVALUE
.head 5 -  ! Call SalMapEnterToTab( TRUE )
.head 5 +  If sBROWSER != STRING_Null
.head 6 -  Call SalEnableWindow( pbHelp )
.head 6 -  Set gBROWSER = sBROWSER
.head 5 +  Else
.head 6 -  Call SalDisableWindow( pbHelp )
.head 3 +  Function: F_Komis
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nSum !! Сумма комис в коп
.head 5 -  String: TT1  !! Код Осн.оп
.head 5 -  Number: NOM   !! Ном осн.оп
.head 5 -  String: TT2  !! Код ком=доч оп
.head 5 -  String: sFIO !!
.head 5 -  Date/Time: sDate !! дата ввода
.head 5 -  Receive Number: REF2 !!Реф после оплдаты ком
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNazn
.head 5 -  Number: nVob
.head 5 -  Number: nRef
.head 5 -  !
.head 5 -  String: NLS6
.head 5 -  String: NMS6
.head 5 -  String: FORMULA6
.head 4 +  Actions
.head 5 -  ! Комиссия
.head 5 +  If SqlPrepareAndExecute( hSql(),
"SELECT t.name, v.vob, translate ( NLSA, '#', ' ' )
 INTO :sNazn,  :nVob, :FORMULA6
 FROM tts  t,  tts_vob v
 WHERE t.tt=:TT2 and v.tt=t.tt" )
  and SqlFetchNext( hSql(), nFetchRes )
.head 6 +  If SqlPrepareAndExecute( hSql(),
"SELECT substr("|| FORMULA6 || ",1,14) into :NLS6 from dual")
  and SqlFetchNext( hSql(), nFetchRes )
.head 7 +  If SqlPrepareAndExecute( hSql(),
"SELECT substr(nms,1,38) INTO :NMS6 FROM accounts
 WHERE kv=:n980 and nls = :NLS6 " )
  and SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set nRef = NUMBER_Null
.head 8 -  Set sNazn= Subs(sNazn ||IifS(sFIO=STRING_Null,'', '. Платник '|| sFIO),1, 160)
.head 8 -  Call cDoc_KP_SIGN.SetDoc( nRef, TT2, 0, nVob, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     NLS6, NMS6, BankMfo, '', n980, nSum, BankOkpo,
     NLS_CASH, NMS_CASH, BankMfo, '', n980, nSum, BankOkpo,
     sNazn, '',GetIdOper(),'', 5 ,0)
.head 8 +  If not cDoc_KP_SIGN.oDoc()
.head 9 -  Return FALSE
.head 8 -  Set nRef = cDoc_KP_SIGN.m_nRef
.head 8 +  If not SqlPrepareAndExecute( hSql(),
 "INSERT INTO operw (ref, tag,value)
  SELECT :nRef, tag, value
  FROM tmp_operw  WHERE tt=:TT1 and value is not null and nom=:NOM " )
.head 9 -  Return FALSE
.head 8 -  Set REF2 = nRef
.head 7 +  Else
.head 8 -  Call Debug("Не отк счет из формулы счета доходов операции " || TT2 )
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 -  Call Debug("Формула счета доходов операции " || TT2 )
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Call Debug("Не описана операция " || TT2 )
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: f_Opl
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive Number: rS
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSum
.head 5 -  Number: nRef
.head 5 -  Date/Time: sDate
.head 5 -  Number: nRowT
.head 5 -  ! Number: nRowD
.head 5 -  String: sNazn
.head 5 -  !
.head 4 +  Actions
.head 5 -  ! последняя проверка доп реквизитов
.head 5 -  Set rS = NUMBER_Null
.head 5 +  If STOTAL > 0 and (SNAL < STOTAL or SNAL=NUMBER_Null)
.head 6 -  Set sErr = " НЕДОСТАТЧА коштів, чи помилка суми !"
.head 6 -  Set SNAL = NUMBER_Null
.head 6 -  Set SDEL = 0
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set nBROWSER = 1
.head 5 -  Set nRowT = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T1, nRowT, 0, 0 )
.head 6 -  Call SalTblSetContext( T1, nRowT )
.head 6 +  If T1.S >0
.head 7 +  If not f_Prov1()
.head 8 -  Return FALSE
.head 5 -  !
.head 5 -  Set nBROWSER = 2
.head 5 -  Set nRowT = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRowT, 0, 0 )
.head 6 -  Call SalTblSetContext( T2, nRowT )
.head 6 +  If T2.S >0
.head 7 +  If not f_Prov2()
.head 8 -  Return FALSE
.head 6 -  !
.head 5 -  ! -----------------------------
.head 5 -  ! Собственно оплата
.head 5 -  If SqlPrepareAndExecute( hSql(),"SELECT sysdate INTO :sDate FROM dual") and SqlFetchNext( hSql(), nFetchRes )
.head 5 -  ! По T1
.head 5 -  Set nRow = TBL_MinRow
.head 5 -  Set sErr=' Полилка в оплаті'
.head 5 +  While SalTblFindNextRow( T1, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( T1, nRow )
.head 6 +  If T1.S >0
.head 7 -  Set nRef = NUMBER_Null
.head 7 -  Set nSum = T1.S * 100
.head 7 -  Set sNazn= Subs(IifS( T1.NAZ_TT = STRING_Null or SalStrLength( T1.NAZ_TT  ) < 3,
                      T1.NAM_TT,
                      T1.NAZ_TT ) ||
                IifS(T1.NAM_FIO=STRING_Null,'', '. Платник '|| T1.NAM_FIO) , 1, 160)
.head 7 -  Set rS=T1.S
.head 7 -  Call cDoc_KP_SIGN.SetDoc( nRef, T1.TT, 0, T1.VOB, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     T1.NLSK, T1.NAMK, BankMfo, '', n980, nSum, T1.OKPOK ,
     NLS_CASH, NMS_CASH, BankMfo, '', n980, nSum, BankOkpo,
     sNazn, '', GetIdOper(),'', T1.SKP ,0)
.head 7 -  Set cDoc_KP_SIGN.m_nFli = 0
.head 7 +  If not cDoc_KP_SIGN.oDoc()
.head 8 -  Return FALSE
.head 7 -  Set nRef = cDoc_KP_SIGN.m_nRef
.head 7 +  If not SqlPrepareAndExecute( hSql(),
 "INSERT INTO operw (ref, tag,value) SELECT :nRef, tag, value
  FROM tmp_operw  WHERE tt=:T1.TT and value is not null and nom=:T1.NOM " )
.head 8 -  Return FALSE
.head 7 -  Set T1.REF1 = nRef
.head 7 -  ! Комиссия
.head 7 +  If T1.S2 > 0
.head 8 +  If not F_Komis( T1.S2*100,  T1.TT, T1.NOM, T1.TT2, T1.NAM_FIO, sDate, T1.REF2 )
.head 9 -  Return FALSE
.head 5 -  ! По T2
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T2, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( T2, nRow )
.head 6 +  If T2.S >0
.head 7 -  Set nRef = NUMBER_Null
.head 7 -  Set nSum = T2.S * 100
.head 7 -  Set rS   =T2.S
.head 7 -  Set sNazn= Subs(T2.NAZ_TT ||IifS(T2.NAM_FIO=STRING_Null,'', '. Платник '|| T2.NAM_FIO) , 1,160)
.head 7 -  ! !!
.head 7 +  If KP_SIGN = 0 and BankMfo != T2.MFOK
.head 8 -  ! МБ, временно внутренний с дальнейшей перекредитовкой)
.head 8 -  Call cDoc_KP_nSIGN.SetDoc( nRef, T2.TT, 1, T2.VOB, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     NLS_CASH, BankName, BankMfo, '', n980, nSum, BankOkpo,
     NLS_NLK, T2.NAMK,  T2.MFOK, '', n980, nSum,  T2.OKPOK,
     sNazn, '', GetIdOper(),'', T2.SKP ,0)
.head 8 +  If not cDoc_KP_nSIGN.oDoc()
.head 9 -  Return FALSE
.head 8 -  Set nRef = cDoc_KP_nSIGN.m_nRef
.head 8 -  If SqlPrepareAndExecute( hSql(),"update oper set nlsb=:T2.NLSK where ref=:nRef")
.head 7 +  Else
.head 8 -  ! Натуральный МБ или натуральные внутренние
.head 8 -  Set cDoc_KP_SIGN.FLI = 1
.head 8 -  Set cDoc_KP_SIGN.NLS_CASH = NLS_CASH
.head 8 -  Set cDoc_KP_SIGN.NLS_NLK = NLS_NLK
.head 8 -  Call cDoc_KP_SIGN.SetDoc( nRef, T2.TT, 1, T2.VOB, STRING_Null,
     sDate, sDate, DatVal, DatVal,
     NLS_NLK, BankName, BankMfo, '', n980, nSum, BankOkpo,
     T2.NLSK, T2.NAMK,  T2.MFOK, '', n980, nSum,  T2.OKPOK,
     sNazn, '', GetIdOper(),'', T2.SKP ,0)
.head 8 +  If not cDoc_KP_SIGN.oDoc()
.head 9 -  Return FALSE
.head 8 -  Set nRef = cDoc_KP_SIGN.m_nRef
.head 7 +  If not SqlPrepareAndExecute( hSql(),
 "INSERT INTO operw (ref, tag,value)
  SELECT :nRef, tag, value
  FROM tmp_operw  WHERE tt=:T2.TT and value is not null and nom=:T2.NOM" )
.head 8 -  Return FALSE
.head 7 +  If KP_SIGN = 0 and BankMfo =T2.MFOK
.head 8 -  If SqlPrepareAndExecute( hSql(),"DELETE from nlk_ref where ref1=:nRef")
.head 7 -  Set T2.REF1 = nRef
.head 7 -  ! Комиссия
.head 7 +  If T2.S2 > 0
.head 8 -  Set cDoc_KP_SIGN.FLI = 0
.head 8 +  If not F_Komis( T2.S2*100,  T2.TT, T2.NOM, T2.TT2, T2.NAM_FIO, sDate,  T2.REF2 )
.head 9 -  Return FALSE
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: f_Prov1
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRowD
.head 5 -  !
.head 4 +  Actions
.head 5 -  Call T1.f1()
.head 5 -  Set nRowD = TBL_MinRow
.head 5 -  Set rS = T1.S
.head 5 +  While SalTblFindNextRow( D1, nRowD, 0, 0 )
.head 6 -  Call SalTblSetContext( D1, nRowD )
.head 6 +  If D1.BROWSER != STRING_Null
.head 7 -  Call SalEnableWindow( pbHelp )
.head 7 -  Set gBROWSER = D1.BROWSER
.head 6 +  Else
.head 7 -  Call SalDisableWindow( pbHelp )
.head 6 +  If not F_Tag( D1.CHKR, SalStrTrimX(D1.TAG), SalStrTrimX(D1.VALUE ), D1.OPT )
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: f_Prov2
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRowD
.head 4 +  Actions
.head 5 -  Call T2.f1()
.head 5 -  Set nRowD = TBL_MinRow
.head 5 -  Set rS=T2.S
.head 5 +  While SalTblFindNextRow( D2, nRowD, 0, 0 )
.head 6 -  Call SalTblSetContext( D2, nRowD )
.head 6 +  If T2.NAZ_TT = STRING_Null or SalStrLength( T2.NAZ_TT ) < 3
.head 7 -  Call SalSendMsg( NAZN2, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено призначення платежу ! "
.head 7 -  Return FALSE
.head 6 +  If T2.MFOK = STRING_Null
.head 7 -  Call SalSendMsg( T2.MFOK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено МФО отримувача! "
.head 7 -  Return FALSE
.head 6 +  If T2.NLSK = STRING_Null
.head 7 -  Call SalSendMsg( T2.NLSK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено рахунок отримувача! "
.head 7 -  Return FALSE
.head 6 +  If T2.NAMK = STRING_Null
.head 7 -  Call SalSendMsg( T2.NAMK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено назва отримувача! "
.head 7 -  Return FALSE
.head 6 +  If T2.OKPOK = STRING_Null
.head 7 -  Call SalSendMsg( T2.OKPOK, SAM_Validate, 0, 0 )
.head 7 -  Set sErr=" НЕ заповнено ід.код отримувача! "
.head 7 -  Return FALSE
.head 6 +  ! If T2.MFOK = STRING_Null or T2.NLSK = STRING_Null or
   T2.NAMK = STRING_Null or T2.OKPOK=STRING_Null
.head 7 -                                                                      Set sErr=" НЕ заповнено реквізити отримувача ! "
.head 7 -                                                                      Return FALSE
.head 6 +  If T2.SKP = NUMBER_Null
.head 7 -  Call SalSendMsg( T2.SKP, SAM_Validate, 0, 0 )
.head 7 -  Set sErr ='Помилка СКП'
.head 7 -  Return FALSE
.head 6 +  If D2.BROWSER != STRING_Null
.head 7 -  Call SalEnableWindow( pbHelp )
.head 7 -  Set gBROWSER = D2.BROWSER
.head 6 +  Else
.head 7 -  Call SalDisableWindow( pbHelp )
.head 6 +  If not F_Tag( D2.CHKR, SalStrTrimX(D2.TAG), SalStrTrimX(D2.VALUE ), D2.OPT )
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: F_Ref
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMode
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nMode= 1
.head 6 -  Call SalShowWindow (T1.REF1)
.head 6 -  Call SalShowWindow (T1.REF2)
.head 6 -  Call SalShowWindow (T2.REF1)
.head 6 -  Call SalShowWindow (T2.REF2)
.head 5 +  Else
.head 6 -  Call SalHideWindow (T1.REF1)
.head 6 -  Call SalHideWindow (T1.REF2)
.head 6 -  Call SalHideWindow (T2.REF1)
.head 6 -  Call SalHideWindow (T2.REF2)
.head 3 +  Function: F_Ottisk
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: NMK
.head 5 -  String: FIO1
.head 5 -  Number: nSUMB
.head 5 -  Number: nSUMBK
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: TIME
.head 5 -  String: SUMB
.head 5 -  String: SUMBK
.head 5 -  !
.head 5 -  String: sTmp
.head 5 -  String: strReport
.head 5 -  String: strTempl
.head 5 -  !
.head 4 +  Actions
.head 5 -  If SqlPrepareAndExecute( hSqlAux2(),
  "SELECT  to_char(sysdate,'DD/MM/yyyy HH24:MM:SS') INTO :TIME FROM dual " )
and  SqlFetchNext(  hSqlAux2(),  nFetchRes)
.head 5 +  If nSUMB >0
.head 6 -  Set SUMB = SalNumberToStrX( nSUMB, 2 )|| ' грн'
.head 5 +  Else
.head 6 -  Set SUMB = STRING_Null
.head 5 +  If nSUMBK >0
.head 6 -  Set SUMBK = ', ком. '|| SalNumberToStrX( nSUMBK, 2 )|| ' грн'
.head 5 +  Else
.head 6 -  Set SUMBK = STRING_Null
.head 5 -  !
.head 5 -  Set strTempl = GetTemplateDir()||'\\OTTISK.qrd'
.head 5 -  Set sTmp =
GetBankMfo()||'~'|| GetBankName() ||'~'|| ADR ||'~'|| TIME || '~' || FIO1 || '~' ||
NMK ||'~'|| SUMB||'~'||SUMBK||'~'|| GetUserRealName()
.head 5 -  ! ---------------     Печатаем тикет            ------------
[REM        MFOA      - MFO--А
[REM        NBA       - Наш Банк
[REM        ADR
[REM        TIME     - Сист Дата
[REM        FIO1     - Кто платит
[REM        NMK   - Наименование Контрагента
[REM        SUMB     - Сумма сделки
[REM        SUMBK    - Сумма комиссии
[REM        FIO     - Кто ввел
-----
.head 5 -  !
.head 5 -  Set strReport = GetPrnDir()||'\\_'||SalFmtFormatDateTime(SalDateCurrent() ,'hhhmmss') ||
    '.D' || SalStrRightX('0' || Str(SalDateDay(SalDateCurrent())), 2)
.head 5 -  !
.head 5 -  Call DosReport (strTempl,  strReport,'MFOA~NBA~ADR~TIME~FIO1~NMK~SUMB~SUMBK~FIO', sTmp, 0)
.head 5 -  Call DosDirectPrint(strReport)
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPap
.head 3 -  String: pNLS_NLK
.head 3 -  String: strPar02 ! ='' нахальная печать есть , ='N' нах печати нет
.head 2 +  Window Variables
.head 3 -  : cDoc_KP_SIGN
.head 4 -  Class: cDoc_KP_SIGN
.head 3 -  : cDoc_KP_nSIGN
.head 4 -  Class: cDoc_KP_nSIGN
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  ! String: sNLS_NLK
.head 3 -  !
.head 3 -  Boolean: bSortOrd1
.head 3 -  Boolean: bSortOrd2
.head 3 -  Window Handle: hDocWdog
.head 3 -  Boolean: F_Opl
.head 3 -  Number: KP_SIGN
.head 3 -  Number: yRef
.head 3 -  !
.head 3 -  Number: nTAB
.head 3 -  Number: g_NOM
.head 3 -  !
.head 3 -  String: sErr
.head 3 -  String: sPap
.head 3 -  String: sLC
.head 3 -  Number: nRow
.head 3 -  Number: nRow1
.head 3 -  Number: nRow2
.head 3 -  Number: n980
.head 3 -  String: sTT
.head 3 -  Number: nNOM
.head 3 -  String: sNAMK
.head 3 -  String: sNlsAlt
.head 3 -  String: sTipNazn
.head 3 -  String: sDecimal2  ! симв десятичной точки alt
.head 3 -  String: sDecimal   ! симв десятичной точки
.head 3 -  Number: nCol1
.head 3 -  Number: nTmp
.head 3 -  Number: nC_TAG
.head 3 -  String: sNOT
.head 3 -  Number: nCol
.head 3 -  String: gBROWSER
.head 3 -  Number: nBROWSER
.head 3 -  String: sTmp
.head 3 -  String: AA1
.head 3 -  String: AA2
.head 3 -  !
.head 3 -  Number: nUser
.head 3 -  Number: nROW1
.head 3 -  Number: nROW2
.head 3 -  Number: rS
.head 3 -  Number: nLT1
.head 3 -  Number: nHT1
.head 3 -  Number: nLT2
.head 3 -  Number: nHT2
.head 3 -  Date/Time: bDat
.head 3 -  Number: b840
.head 3 -  Number: b978
.head 3 -  Number: b643
.head 3 -  ! !
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 3 -  Number: nW
.head 3 -  Number: nH
.head 3 -  Number: nCW
.head 3 -  Number: nCH
.head 3 -  String: ADR
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  !
.head 4 -  Set dfTextNAZN2  = 'Признач.пл.-2'
.head 4 -  Set dfTextSTOTAL = 'Сума платежів'
.head 4 -  Set dfTextSNAL = 'Прийнято у клієнта'
.head 4 -  Set dfTextSDEL = 'Повернути клієнту'
.head 4 -  !
.head 4 -  If SqlPrepareAndExecute( hSql(),"SELECT kv, NOMINAL INTO :nRow, :nTmp FROM tabval where kv in (840,978,643) ")
.head 4 +  While SqlFetchNext( hSql(), nFetchRes )
.head 5 +  If nRow = 840
.head 6 -  Set b840 = nTmp
.head 5 +  Else If nRow = 978
.head 6 -  Set b978 = nTmp
.head 5 +  Else If nRow = 643
.head 6 -  Set b643 = nTmp
.head 4 -  Set F_Opl = FALSE
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT substr(pul.Get_Mas_Ini_Val('NLS_2902'),1,14)
   INTO :NLS_NLK FROM dual  " )
and not SqlFetchNext( hSql(), nFetchRes )
or NLS_NLK = STRING_Null
.head 5 -  Set NLS_NLK = pNLS_NLK
.head 4 -  Call SalGetWindowSize( T1, nLT1, nHT1 )
.head 4 -  Call SalGetWindowSize( T2, nLT2, nHT2 )
.head 4 -  Set nCol = SalColorFromRGB( 255,200,255 )  ! розовій
.head 4 -  Set sDecimal =SalStrMidX(SalNumberToStrX(1.1,1),1,1)
.head 4 -  Set nCol1 = SalColorFromRGB( 230,255,230 )
.head 4 -  Set sDecimal2 = IifS ( sDecimal = '.', ',', '.' )
.head 4 -  ! Call SalGetWindowSize( dFIO, nW3, nH3 )
.head 4 -  Set BankName = GetBankName()
.head 4 -  Set BankMfo =  GetBankMfo()
.head 4 -  Set DatVal = GetBankDate()
.head 4 -  Set n980 = GetBaseVal()
.head 4 +  If nMode >100
.head 5 -  ! найти по календатю
.head 5 -  Set bDat = DatVal
.head 5 +  If SqlPrepareAndExecute( hSql(),
   "SELECT min( to_date(:bDat) + num)
    INTO :DatVal
    FROM conductor WHERE num<7 and to_date(:bDat) + num not in
        (select holiday from holiday where kv=:n980 and holiday> :bDat ) " ) and
not SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set DatVal = GetBankDate() +1
.head 4 -  Set BankOkpo = GetBankOkpoS()
.head 4 -  Set nUser = GetUserId()
.head 4 -  ! Код ТОБО, Счет кассы,  Наименование счета кассы
.head 4 +  If SqlPrepareAndExecute( hSql(),
" SELECT a.nls, substr(a.nms, 1, 38), substr(SYS_CONTEXT('bars_context','user_branch'),1,22)
         INTO :NLS_CASH, :NMS_CASH, :TOBO
       FROM accounts a
   WHERE a.NLS = BRANCH_USR.GET_BRANCH_PARAM2 ('CASH', 0)
          AND a.kv  = 980
          AND a.tip = 'KAS'
          AND a.dazs IS NULL
" ) and NOT SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Call SalMessageBox( "Користувачеві не присвоєно рахунок каси ",
                                             Str(nUser)||' '||GetUserLoginName()||' '||GetUserRealName(),
                                             MB_IconStop )
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  ! Головний банк
.head 4 +  If TOBO = BankMfo
.head 5 -  Set TOBO  = BankMfo
.head 5 -  Set sTOBO = BankName
.head 4 -  ! Наименование папки
.head 4 -  If SqlPrepareAndExecute( hSql(), "SELECT  name  INTO  :sPap  FROM  folders WHERE  idfo = :nPap " )
and SqlFetchNext( hSql(), nFetchRes )
.head 4 -  ! -------------------------------
.head 4 -  ! Операции обмена ВАЛ
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT  v1.param_value, v2.param_value  
          INTO  :AA1, :AA2
       FROM  BRANCH_PARAMS_VALUES v1, BRANCH_PARAMS_VALUES v2
   WHERE  v1.mfo=:TOBO and v2.mfo=:TOBO and v1.name='AA1' and v2.name='AA2' " )
and NOT SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set AA1 = 'A21'
.head 5 -  Set AA2 = 'A23'
.head 4 -  ! С ЭЦП (1-Маршавина)  или без(0 -АЖИО) - по умолчанию =1
.head 4 -  Set KP_SIGN = 1
.head 4 -  ! сначала в общем PARAMS
.head 4 +  If SqlPrepareAndExecute( hSql(), "SELECT val INTO :KP_SIGN FROM PARAMS WHERE par='KP_SIGN' " )
and NOT SqlFetchNext( hSql(), nFetchRes )
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT param_value INTO :KP_SIGN FROM BRANCH_PARAMS_VALUES
   WHERE mfo=:TOBO and name='KP_SIGN' and param_value = '0' " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set KP_SIGN = 1
.head 4 -  If SqlPrepareAndExecute( hSql(), "SELECT val INTO :ADR FROM PARAMS WHERE par='ADDRESS' " )
and NOT SqlFetchNext( hSql(), nFetchRes )
.head 4 -  !
.head 4 -  Call SalSetWindowText( KP, "Комплексне обслуговування ФО, папка операцій № "||Str(nPap)|| "-"||sPap )
.head 4 -  !
.head 4 -  Call F_tts()
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize( hWndForm, nWW, nWH )
.head 4 +  If nWW >= 12
.head 5 +  If nWH < 6
.head 6 -  Call SalSetWindowSize( hWndForm, nWW, 6 )
.head 4 +  Else
.head 5 +  If nWH < 6
.head 6 -  Call SalSetWindowSize( hWndForm, 12, 6 )
.head 5 +  Else
.head 6 -  Call SalSetWindowSize( hWndForm, 12, nWH )
.head 4 -  Call GetClientRect( hWndForm, nX, nY, nW, nH )
.head 4 -  ! F1
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F1, 0.05, 0)
.head 4 -  ! F4
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F4, 0.5, 0)
.head 4 -  ! NAZN1
.head 4 -  Call SalGetWindowSize(hWndForm.KP.NAZN1, nCW, nCH)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.NAZN1,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35-0.05-3.2, nCH)
.head 4 -  ! NAM_TT1
.head 4 -  Call SalGetWindowLoc( hWndForm.KP.NAM_TT1, nCW, nCH )
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.NAM_TT1,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35, nCH)
.head 4 -  ! T1
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.T1, 0, 0.35)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.T1,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35-0.05,
	SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.5)
.head 4 -  ! D1
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.D1,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35, 0.35)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.D1, nCW, nCH)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.D1, nCW,
	SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.5)
.head 4 -  ! F2
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F2, 0.05,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 4 -  ! F3
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F3, 0.5,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 4 -  ! F8
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F8, 0.95,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 4 -  ! F9
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.pb_F9, 1.4,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.08)
.head 4 -  ! NAM_TT2
.head 4 -  Call SalGetWindowLoc( hWndForm.KP.NAM_TT2, nCW, nCH )
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.NAM_TT2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-3.05)
.head 4 -  ! T2
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.T2, 0,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-2.75)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.T2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35-0.05, 1.5)
.head 4 -  ! D2
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.D2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-2.75)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.D2, nCW, nCH)
.head 4 -  Call SalSetWindowSize( hWndForm.KP.D2, nCW, 1.5)
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextNAZN2, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-1.2+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.NAZN2, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-1.2)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.NAZN2, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.NAZN2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-0.1-2.2, nCH)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextSTOTAL, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.95+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.STOTAL, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.95)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.ml1, 0.1+2.2+1.55,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.9)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.ml1, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.ml1,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-2.2-0.1-1.55, nCH)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextSNAL, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.SNAL, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.SKOL, 0.1+2.2+1.55,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.KKOL, 0.1+2.2+2.15,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.65)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.ml3, 0.1+2.2+2.75,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.6)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.ml3, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.ml3,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-2.75-0.1-2.2, nCH)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dfTextSDEL, 0.1,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.35+0.07)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.SDEL, 0.1+2.2,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.35)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.ml2, 0.1+2.2+1.55,
        SalPixelsToFormUnits( hWndForm, nH, TRUE)-0.3)
.head 4 -  Call SalGetWindowSize(hWndForm.KP.ml2, nCW, nCH)
.head 4 -  Call SalSetWindowSize(hWndForm.KP.ml2,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.4-0.1-2.2-1.55, nCH)
.head 4 -  !
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.NLS_NLK,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -1.2)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.TOBO,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-1.95,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -1.2)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.sTOBO,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -0.9)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dFIO,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -0.6)
.head 4 -  Call SalSetWindowLoc(hWndForm.KP.dTmp,
        SalPixelsToFormUnits( hWndForm, nW, FALSE)-4.35,
        SalPixelsToFormUnits( hWndForm, nH, TRUE) -0.3)
.head 4 -  !
.head 4 -  Call SalInvalidateWindow( hWndForm )
.head 1 +  Table Window: kp_MAJAR
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт коммунальные платежи (MAJAR)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.138"
.head 4 -  Top:    0.979"
.head 4 -  Width:  9.917"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.774"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.024"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 63712
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 63713
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 63714
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfKat
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.119"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Каталог импорта
.head 5 -  Resource Id: 63715
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.7"
.head 6 -  Top:    0.119"
.head 6 -  Width:  2.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Charcoal
.head 5 -  Background Color: Default
.head 4 +  Custom Control: cc1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cMeter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  DLL Name:
.head 6 -  MS Windows Class Name:
.head 6 -  Style:  Class Default
.head 6 -  ExStyle:  Class Default
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left:   0.05"
.head 7 -  Top:    0.643"
.head 7 -  Width:  9.7"
.head 7 -  Width Editable? Class Default
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Etched Border? Class Default
.head 6 -  Hollow? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Horizontal Scroll? Class Default
.head 6 -  Tab Stop? Class Default
.head 6 -  Tile To Parent? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  DLL Settings
.head 5 -  Message Actions
.head 4 -  ! ! Background Text: Файл импорта
.head 4 +  Data Field: dfFile
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.381"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfRec
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.233"
.head 7 -  Top:    0.381"
.head 7 -  Width:  2.517"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDone
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.0"
.head 7 -  Top:    0.679"
.head 7 -  Width:  3.65"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 12
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Blue
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfFIFI
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.7"
.head 7 -  Top:    0.381"
.head 7 -  Width:  2.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Charcoal
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set dfFIFI = 'Файл импорта'
.head 2 +  Contents
.head 3 +  Column: colFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Файл импорта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRecc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: К-во зап.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colProgressDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Действие
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nFiles
.head 3 -  String: sCurrentDir
.head 3 -  Number: nI
.head 3 -  Boolean: bU
.head 3 -  String: sFile
.head 3 -  Sql Handle: hSqlA
.head 3 -  String: sFIO
.head 3 -  String: sNDOM
.head 3 -  String: sNKV
.head 3 -  Number: nKODA
.head 3 -  Number: nLC
.head 3 -  Number: nKUL
.head 3 -  Number: nRNP
.head 3 -  Number: nNA
.head 3 -  Number: nSALN
.head 3 -  Number: nMES
.head 3 -  String: smFiles[*]
.head 3 -  Number: nDelta
.head 3 -  Number: nPos
.head 3 -  Number: nCount
.head 3 -  Number: nCountUpd
.head 3 -  Number: nK_USL
.head 3 -  Number: nK
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SalHideWindow(dfFIFI)
.head 4 -  ! Call SetWindowFullSize(hWndForm)
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Call SalDisableWindow(pbRefresh)
.head 4 -  Call SalDisableWindow(pbUpdate)
.head 4 -  Call SalDisableWindow(pbSearch)
.head 4 -  Call SalDisableWindow(pbFilter)
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 -  Call SalDisableWindow(pbPrint)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'KP_MAJAR', 'C:\\KP_MAJAR', dfKat, GetIniFileName())
.head 4 -  Set dfKat = IifS(Right(dfKat, 1)='\\', Left(dfKat, Len(dfKat)-1), dfKat)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalHideWindow(cc1)
.head 4 -  Call SalHideWindow(dfDone)
.head 4 -  Set nFiles = VisDosEnumFiles(dfKat || '\\OS???_??.DBF', FA_Standard, smFiles)
.head 4 -  ! вычитываем каталог и обрабатываем файлы OS???_??.DBF
.head 4 +  If nFiles > 0
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set nI = 0
.head 5 +  While nI < nFiles
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set colFileName = smFiles[nI]
.head 6 -  Set nI = nI + 1
.head 5 -  Call SalShowWindow(dfDone)
.head 5 +  If SalMessageBox('Информация за предыдущий период будет удалена. Продолжать ?',
   'ВНИМАНИЕ !', MB_IconHand | MB_YesNo) = IDYES
.head 6 -  Set dfDone = 'Очистка KP_MAJAR'
.head 6 -  ! If SqlPrepareAndExecute(hSql(), '
   TRUNCATE TABLE
   kp_majar')
.head 6 -  ! If SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_majar')
.head 6 +  If SqlPrepareAndExecute(hSql(), 'truncate table bars.kp_majar drop storage')
.head 7 -  Call SalShowWindow(dfFIFI)
.head 7 -  Call SalHideWindow(dfDone)
.head 7 -  Set dfDone = ''
.head 7 -  Call SalFileGetCurrentDirectory(sCurrentDir)
.head 7 -  Set nI = 0
.head 7 -  Set bU = TRUE
.head 7 +  While nI < nFiles and bU
.head 8 -  Set sFile = smFiles[nI]
.head 8 -  ! Set nRow = TBL_MinRow
.head 8 -  Call SalFileSetCurrentDirectory(dfKat)
.head 8 -  Set SqlDatabase = 'dBase_Files'
.head 8 +  If SqlConnect(hSqlA)
.head 9 -  Set nK_USL = Val(Subs(sFile,3,3))
.head 9 -  Call SalShowWindow(cc1)
.head 9 -  Call cc1.SetProgress(0)
.head 9 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     INTO :nCount
     FROM " || sFile)
.head 9 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 9 -  Call SalTblSetContext(hWndForm, nI)
.head 9 -  Set colProgressDone = 'Импорт ...'
.head 9 -  Set nDelta = 100 / nCount
.head 9 -  Set dfFile = sFile || ' (' || Str(nI+1) || ' из ' || Str(nFiles) || ')'
.head 9 -  Set dfRec = Str(nCount) || ' зап.'
.head 9 -  Set nPos = 0
.head 9 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT KODA,LC,FIO,KUL,NDOM,NKV,RNP,NA,SALN,MES
     INTO :nKODA,:nLC,:sFIO,:nKUL,:sNDOM,:sNKV,:nRNP,:nNA,:nSALN,:nMES
     FROM " || sFile)
.head 9 -  Set nK = 1
.head 9 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 10 -  Set colRecc = nK
.head 10 -  Set sFIO = SalStrTrimX(StrDosToWinX(sFIO))
.head 10 -  Set sNDOM = SalStrTrimX(sNDOM)
.head 10 -  Set sNKV = SalStrTrimX(sNKV)
.head 10 +  If SqlPrepareAndExecute(hSql(), '
   UPDATE kp_majar
   SET KODA=:nKODA,FIO=:sFIO,KUL=:nKUL,NDOM=:sNDOM,NKV=:sNKV,RNP=:nRNP,NA=:nNA,
       SALN=:nSALN,MES=:nMES
   WHERE LC=:nLC and K_USL=:nK_USL')
.head 11 -  Set nCountUpd = 0
.head 11 -  Call SqlGetModifiedRows(hSql(), nCountUpd)
.head 11 +  If nCountUpd = 0
.head 12 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO kp_majar (KODA,LC,FIO,KUL,NDOM,NKV,RNP,NA,SALN,MES,K_USL)
   VALUES (:nKODA,:nLC,:sFIO,:nKUL,:sNDOM,:sNKV,:nRNP,:nNA,:nSALN,:nMES,
           :nK_USL)')
.head 13 -  Call MessageNoWait('Импорт MAJAR. Невозможно вставить строку в KP_MAJAR.' ||
     'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 7, 1)
.head 13 -  Set bU = FALSE
.head 13 -  Break
.head 11 -  ! Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 11 -  ! Call SalTblSetContext(hWndForm, nRow)
.head 11 -  ! Set colKODA = nKODA
.head 11 -  ! Set colLC = nLC
.head 11 -  ! Set colFIO = sFIO
.head 11 -  ! Set colKUL = nKUL
.head 11 -  ! Set colNDOM = sNDOM
.head 11 -  ! Set colNKV = sNKV
.head 11 -  ! Set colRNP = nRNP
.head 11 -  ! Set colNA = nNA
.head 11 -  ! Set colSALN = nSALN
.head 11 -  ! Set colMES = nMES
.head 11 -  Set nPos = nPos + nDelta
.head 11 -  Call cc1.SetProgress(nPos)
.head 11 -  Call SalUpdateWindow(hWndForm)
.head 11 -  Set nK = nK + 1
.head 10 +  Else
.head 11 -  Call MessageNoWait('Импорт MAJAR. Невозможно вставить строку в KP_MAJAR. ' ||
     'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 7, 1)
.head 11 -  Set bU = FALSE
.head 11 -  ! Call SqlDisconnect(hSqlA)
.head 11 -  Break
.head 9 -  Call SqlDisconnect(hSqlA)
.head 9 -  Call SalHideWindow(cc1)
.head 9 -  Set dfFile = ''
.head 9 -  Set dfRec = ''
.head 9 -  Set colProgressDone = 'Готово !!!'
.head 9 -  Call SalTblSetRowFlags(hWndForm, nI, ROW_Edited | ROW_New, FALSE)
.head 9 -  Call SalFileCreateDirectory(dfKat || '\\Archiv')
.head 9 -  Call VisFileCopy(dfKat || '\\' || smFiles[nI], dfKat || '\\Archiv\\' ||
     smFiles[nI])
.head 9 +  If File(dfKat || '\\Archiv\\' || smFiles[nI])
.head 10 -  Call VisFileDelete(dfKat || '\\' || smFiles[nI])
.head 9 -  Set nI = nI + 1
.head 7 +  If bU
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SalHideWindow(cc1)
.head 8 -  Call SalShowWindow(dfDone)
.head 8 -  Set dfDone = 'Готово'
.head 8 -  Call SalHideWindow(dfFIFI)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  ! Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalDestroyWindow(hWndForm)
.head 6 +  Else
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call MessageNoWait('Импорт MAJAR. Невозможно удалить старую информацию из KP_MAJAR. '
     || 'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 7, 1)
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 5 +  Else
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Else
.head 5 -  Call MessageNoWait('Импорт MAJAR. Отсутствуют файлы для импорта (' || dfKat ||
     '\\OS???_??.DBF)', 'ВНИМАНИЕ !!!', 7, 1)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 1 +  Table Window: kp_UTEL
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт коммунальные платежи (UTEL)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.138"
.head 4 -  Top:    0.979"
.head 4 -  Width:  9.917"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.774"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.024"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 63716
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 63717
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 63718
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfKat
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.119"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Каталог импорта
.head 5 -  Resource Id: 63719
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.7"
.head 6 -  Top:    0.119"
.head 6 -  Width:  2.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Charcoal
.head 5 -  Background Color: Default
.head 4 +  Custom Control: cc1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cMeter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  DLL Name:
.head 6 -  MS Windows Class Name:
.head 6 -  Style:  Class Default
.head 6 -  ExStyle:  Class Default
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left:   0.05"
.head 7 -  Top:    0.643"
.head 7 -  Width:  9.7"
.head 7 -  Width Editable? Class Default
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Etched Border? Class Default
.head 6 -  Hollow? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Horizontal Scroll? Class Default
.head 6 -  Tab Stop? Class Default
.head 6 -  Tile To Parent? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  DLL Settings
.head 5 -  Message Actions
.head 4 -  ! ! Background Text: Файл импорта
.head 4 +  Data Field: dfFile
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.381"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDone
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.0"
.head 7 -  Top:    0.679"
.head 7 -  Width:  3.65"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 12
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Blue
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfFIFI
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.7"
.head 7 -  Top:    0.381"
.head 7 -  Width:  2.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Charcoal
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: colFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Файл импорта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRecc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: К-во зап.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colProgressDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Действие
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  ! Function: FileGetStr
.head 4 -                                      Description: 
.head 4 +                                      Returns 
.head 5 -                                      String: 
.head 4 +                                      Parameters 
.head 5 -                                      File Handle: hF
.head 4 -                                      Static Variables 
.head 4 +                                      Local variables 
.head 5 -                                      String: sTemp
.head 5 -                                      Number: n0A
.head 4 +                                      Actions 
.head 5 +                                      While TRUE
.head 6 +                                      If Len(sBigBuffer) > 0
.head 7 -                                      Set n0A = At(Chr(10), sBigBuffer)
.head 7 +                                      If n0A > 0
.head 8 -                                      Set sTemp = Left(sBigBuffer, n0A-1)
.head 8 -                                      Set sBigBuffer = Right(sBigBuffer, Len(sBigBuffer)-n0A)
.head 8 -                                      Return sTemp
.head 7 +                                      Else 
.head 8 -                                      Set sFirst = sBigBuffer
.head 8 -                                      Call ReadString(hF)
.head 6 +                                      Else 
.head 7 -                                      Call ReadString(hF)
.head 6 +                                      If nBytes = 0
.head 7 -                                      Return ''
.head 6 +                                      Else 
.head 7 -                                      Set sBigBuffer = sFirst || sBigBuffer
.head 3 +  ! Function: ReadString
.head 4 -                                      Description: 
.head 4 -                                      Returns 
.head 4 +                                      Parameters 
.head 5 -                                      File Handle: hF
.head 4 -                                      Static Variables 
.head 4 -                                      Local variables 
.head 4 +                                      Actions 
.head 5 -                                      Set sBigBuffer = Spac(65536)
.head 5 -                                      Set nBytes = SalFileRead(hF, sBigBuffer, 65536)
.head 5 -                                      Set sBigBuffer = VisStrRightTrim(sBigBuffer)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nFiles
.head 3 -  Number: nI
.head 3 -  Boolean: bU
.head 3 -  String: sFile
.head 3 -  String: sFIO
.head 3 -  String: smFiles[*]
.head 3 -  Number: nCountUpd
.head 3 -  Number: nK
.head 3 -  String: sGRUPPA
.head 3 -  String: sSALDO
.head 3 -  String: sSUM_NACH
.head 3 -  String: sSUM_AVANS
.head 3 -  String: sSUM_OPLAT
.head 3 -  String: sPENJA
.head 3 -  String: sPHONE
.head 3 -  String: sLSCHET
.head 3 -  String: sABON_ID
.head 3 -  !
.head 3 -  String: sPUNKT
.head 3 -  String: sSTREET
.head 3 -  String: sNDOM
.head 3 -  String: sKVARTIRA
.head 3 -  ! String: smFIO[*]
.head 3 -  ! String: smLSCHET[*]
.head 3 -  ! String: smABON_ID[*]
.head 3 -  ! String: smPHONE[*]
.head 3 -  ! String: smGRUPPA[*]
.head 3 -  ! String: smSALDO[*]
.head 3 -  ! String: smSUM_NACH[*]
.head 3 -  ! String: smSUM_AVANS[*]
.head 3 -  ! String: smSUM_OPLAT[*]
.head 3 -  ! String: smPENJA[*]
.head 3 -  Number: nT
.head 3 -  Number: nJ
.head 3 -  Number: nInd
.head 3 -  File Handle: hF
.head 3 -  String: sBuffer
.head 3 -  String: smTemp[*]
.head 3 -  Number: nTek
.head 3 -  Number: nFileSize
.head 3 -  String: sType
.head 3 -  String: sSqlUpdate
.head 3 -  String: sSqlInsert
.head 3 -  !
.head 3 -  ! String: sFirst
.head 3 -  ! String: sBigBuffer
.head 3 -  ! Number: nBytes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  ! Call SetWindowFullSize(hWndForm)
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Call SalDisableWindow(pbRefresh)
.head 4 -  Call SalDisableWindow(pbUpdate)
.head 4 -  Call SalDisableWindow(pbSearch)
.head 4 -  Call SalDisableWindow(pbFilter)
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 -  Call SalDisableWindow(pbPrint)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'KP_UTEL', 'C:\\KP_UTEL', dfKat, GetIniFileName())
.head 4 -  Set dfKat = IifS(Right(dfKat, 1)='\\', Left(dfKat, Len(dfKat)-1), dfKat)
.head 4 -  Set dfFIFI = 'Файл импорта'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalHideWindow(dfFIFI)
.head 4 -  Call SalHideWindow(cc1)
.head 4 -  Call SalHideWindow(dfDone)
.head 4 -  Set nFiles = VisDosEnumFiles(dfKat || '\\S??????.UNL', FA_Standard, smFiles)
.head 4 -  ! вычитываем каталог и обрабатываем файлы A??????.UNL
.head 4 +  If nFiles > 0
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set nI = 0
.head 5 +  While nI < 3
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set colFileName = IifS(nI=0, 'A', IifS(nI=1, 'R', 'S')) ||
    Right(smFiles[0], Len(smFiles[0])-1)
.head 6 -  Set nI = nI + 1
.head 5 -  Call SalShowWindow(dfDone)
.head 5 -  ! If SalMessageBox('Информация за предыдущий период будет удалена. Продолжать ?',
   'ВНИМАНИЕ !', MB_IconExclamation | MB_YesNo | MB_SystemModal) = IDYES
.head 5 +  If SalMessageBox('Информация за предыдущий период будет удалена. Продолжать ?',
   'ВНИМАНИЕ !', MB_IconHand | MB_YesNo) = IDYES
.head 6 -  Set dfDone = 'Очистка KP_UTEL'
.head 6 -  ! If SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel_A') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel_R') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel_S')
.head 6 -  ! If SqlPLSQLCommand(hSql(), 'kp_utel_trunc')
.head 6 +  If SqlPrepareAndExecute(hSql(), 'truncate table bars.kp_utel drop storage') and
   SqlPrepareAndExecute(hSql(), 'truncate table bars.kp_utel_A drop storage') and
   SqlPrepareAndExecute(hSql(), 'truncate table bars.kp_utel_R drop storage') and
   SqlPrepareAndExecute(hSql(), 'truncate table bars.kp_utel_S drop storage')
.head 7 -  Set dfDone = ''
.head 7 -  Call SalHideWindow(dfDone)
.head 7 -  Set bU = TRUE
.head 7 -  Call SalUpdateWindow(hWndForm)
.head 7 -  !
.head 7 -  Set sFile = 'A' || Right(smFiles[0], Len(smFiles[0])-1)
.head 7 -  Call SalShowWindow(cc1)
.head 7 -  Call cc1.SetProgress(0)
.head 7 -  Call SalShowWindow(dfFIFI)
.head 7 -  Set dfFile = sFile || ' (1 из 3)'
.head 7 -  Call SalUpdateWindow(hWndForm)
.head 7 -  !
.head 7 -  Set nTek = 0
.head 7 -  Call SalTblSetContext(hWndForm, 0)
.head 7 -  Set colProgressDone = 'Импорт ...'
.head 7 -  ! Call Debug(sFile)
.head 7 -  Set nFileSize = VisFileGetSize(dfKat || '\\' || sFile)
.head 7 -  Call SalFileOpen(hF, dfKat || '\\' || sFile, OF_Read)
.head 7 -  Set nJ = 0
.head 7 -  ! Set sFirst = ''
.head 7 -  ! Set sBigBuffer = ''
.head 7 -  ! Set nBytes = 0
.head 7 +  Loop
.head 8 -  Set sBuffer = Spac(512)
.head 8 +  If not SalFileGetStr(hF, sBuffer, 512)
.head 9 -  Break
.head 8 -  ! Set sBuffer = FileGetStr(hF)
.head 8 +  ! If Len(sBuffer) = 0
.head 9 -                                   Break
.head 8 -  Set nTek = nTek + Len(sBuffer) + 1
.head 8 -  Call cc1.SetProgress(nTek/nFileSize*100)
.head 8 -  Call SalTblSetContext(hWndForm, 0)
.head 8 -  Set colRecc = nJ
.head 8 -  Call SalUpdateWindow(hWndForm)
.head 8 -  Set nInd = SalStrTokenize(sBuffer, '', '|', smTemp)
.head 8 +  If nInd > 3
.head 9 -  Set sLSCHET = smTemp[0]
.head 9 -  Set sABON_ID = smTemp[1]
.head 9 -  Set sPHONE = smTemp[2]
.head 9 -  Set sFIO = smTemp[3]
.head 9 -  Call SqlPrepareAndExecute(hSql(), '
     INSERT
     INTO kp_utel_A (LSCHET,ABON_ID,PHONE,FIO)
     VALUES (:sLSCHET,:sABON_ID,:sPHONE,:sFIO)')
.head 8 -  Set nJ = nJ + 1
.head 7 -  Set colProgressDone = 'Готово !!!'
.head 7 -  Call SalFileClose(hF)
.head 7 -  !
.head 7 -  Set nTek = 0
.head 7 -  Set sFile = 'R' || Right(smFiles[0], Len(smFiles[0])-1)
.head 7 -  ! Call Debug(sFile)
.head 7 -  Call SalTblSetContext(hWndForm, 1)
.head 7 +  If File(dfKat || '\\' || sFile)
.head 8 -  Set colProgressDone = 'Импорт ...'
.head 8 -  Set nFileSize = VisFileGetSize(dfKat || '\\' || sFile)
.head 8 -  Call SalFileOpen(hF, dfKat || '\\' || sFile, OF_Read)
.head 8 -  Set dfFile = sFile || ' (2 из 3)'
.head 8 -  Set nJ = 0
.head 8 -  Set nTek = 0
.head 8 -  ! Set sFirst = ''
.head 8 -  ! Set sBigBuffer = ''
.head 8 -  ! Set nBytes = 0
.head 8 +  Loop
.head 9 -  Set sBuffer = Spac(512)
.head 9 +  If not SalFileGetStr(hF, sBuffer, 512)
.head 10 -  Break
.head 9 -  ! Set sBuffer = FileGetStr(hF)
.head 9 +  ! If Len(sBuffer) = 0
.head 10 -                                   Break
.head 9 -  Set nTek = nTek + Len(sBuffer) + 1
.head 9 -  Call cc1.SetProgress(nTek/nFileSize*100)
.head 9 -  ! Call SalTblSetContext(hWndForm, 1)
.head 9 -  Set colRecc = nJ
.head 9 -  Call SalUpdateWindow(hWndForm)
.head 9 -  Set nInd = SalStrTokenize(sBuffer, '', '|', smTemp)
.head 9 +  If nInd > 6
.head 10 -  Set sLSCHET = smTemp[0]
.head 10 -  Set sABON_ID = smTemp[1]
.head 10 -  Set sFIO = smTemp[2]
.head 10 -  Set sPUNKT = smTemp[3]
.head 10 -  Set sSTREET = smTemp[4]
.head 10 -  Set sNDOM = smTemp[5]
.head 10 -  Set sKVARTIRA = smTemp[6]
.head 10 -  Call SqlPrepareAndExecute(hSql(), '
     INSERT
     INTO kp_utel_R (LSCHET,ABON_ID,FIO,PUNKT,STREET,NDOM,KVARTIRA)
     VALUES (:sLSCHET,:sABON_ID,:sFIO,:sPUNKT,:sSTREET,:sNDOM,:sKVARTIRA)')
.head 9 -  Set nJ = nJ + 1
.head 8 -  Set colProgressDone = 'Готово !!!'
.head 8 -  Call SalFileClose(hF)
.head 7 +  Else
.head 8 -  Set colProgressDone = 'Нет ' || sFile
.head 7 -  !
.head 7 -  Set nTek = 0
.head 7 -  Set sFile = 'S' || Right(smFiles[0], Len(smFiles[0])-1)
.head 7 -  Call SalTblSetContext(hWndForm, 2)
.head 7 +  If File(dfKat || '\\' || sFile)
.head 8 -  Set colProgressDone = 'Импорт ...'
.head 8 -  Set nFileSize = VisFileGetSize(dfKat || '\\' || sFile)
.head 8 -  Call SalFileOpen(hF, dfKat || '\\' || sFile, OF_Read)
.head 8 -  Set dfFile = sFile || ' (3 из 3)'
.head 8 -  Set nJ = 0
.head 8 -  Set nTek = 0
.head 8 -  ! Set sFirst = ''
.head 8 -  ! Set sBigBuffer = ''
.head 8 -  ! Set nBytes = 0
.head 8 +  Loop
.head 9 -  Set sBuffer = Spac(512)
.head 9 +  If not SalFileGetStr(hF, sBuffer, 512)
.head 10 -  Break
.head 9 -  ! Set sBuffer = FileGetStr(hF)
.head 9 +  ! If Len(sBuffer) = 0
.head 10 -                                   Break
.head 9 -  Set nTek = nTek + Len(sBuffer) + 1
.head 9 -  Call cc1.SetProgress(nTek/nFileSize*100)
.head 9 -  ! Call SalTblSetContext(hWndForm, 2)
.head 9 -  Set colRecc = nJ
.head 9 -  Call SalUpdateWindow(hWndForm)
.head 9 -  Set nInd = SalStrTokenize(sBuffer, '', '|', smTemp)
.head 9 +  If nInd > 7
.head 10 -  Set sLSCHET = smTemp[0]
.head 10 -  Set sABON_ID = smTemp[1]
.head 10 -  Set sGRUPPA = smTemp[2]
.head 10 -  Set sSALDO = smTemp[3]
.head 10 -  Set sSUM_NACH = smTemp[4]
.head 10 -  Set sSUM_AVANS = smTemp[5]
.head 10 -  Set sSUM_OPLAT = smTemp[6]
.head 10 -  Set sPENJA = smTemp[7]
.head 10 -  Call SqlPrepareAndExecute(hSql(), '
     INSERT
     INTO kp_utel_S (LSCHET,ABON_ID,GRUPPA,SALDO,SUM_NACH,SUM_AVANS,SUM_OPLAT,
                     PENJA)
     VALUES (:sLSCHET,:sABON_ID,:sGRUPPA,:sSALDO,:sSUM_NACH,:sSUM_AVANS,
             :sSUM_OPLAT,:sPENJA)')
.head 9 -  Set nJ = nJ + 1
.head 8 -  Set colProgressDone = 'Готово !!!'
.head 8 -  Call SalFileClose(hF)
.head 7 +  Else
.head 8 -  Set colProgressDone = 'Нет ' || sFile
.head 7 -  !
.head 7 -  Call SalHideWindow(cc1)
.head 7 -  Set dfFile = ''
.head 7 -  Call SalHideWindow(dfFIFI)
.head 7 -  Call SalShowWindow(dfDone)
.head 7 -  Set dfDone = 'Наполнение KP_UTEL'
.head 7 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Set colFileName = 'таблица KP_UTEL'
.head 7 -  Set colProgressDone = 'Наполнение ...'
.head 7 -  Call SalUpdateWindow(hWndForm)
.head 7 -  ! вставить в kp_utel
.head 7 -  ! and a.PHONE=
     (SELECT a.PHONE
      FROM kp_utel_s s, kp_utel_a a
      WHERE s.LSCHET=a.LSCHET and s.ABON_ID=a.ABON_ID and rownum=1) ???
.head 7 -  Set bU = SqlPrepareAndExecute(hSql(), "
    INSERT
    INTO kp_utel (LSCHET,ABON_ID,FIO,GRUPPA,SALDO,SUM_NACH,SUM_AVANS,SUM_OPLAT,
                  PENJA,PHONE)
   (SELECT s.LSCHET,s.ABON_ID,a.FIO,s.GRUPPA,to_number(s.SALDO),
           to_number(s.SUM_NACH),to_number(s.SUM_AVANS),to_number(s.SUM_OPLAT),
           to_number(s.PENJA),max(a.PHONE)
    FROM kp_utel_s s, kp_utel_a a
    WHERE s.LSCHET=a.LSCHET and s.ABON_ID=a.ABON_ID and s.LSCHET<>'-1'
    GROUP BY s.LSCHET,s.ABON_ID,a.FIO,s.GRUPPA,to_number(s.SALDO),
             to_number(s.SUM_NACH),to_number(s.SUM_AVANS),to_number(s.SUM_OPLAT),
             to_number(s.PENJA))") and
    SqlPrepareAndExecute(hSql(), "
    INSERT
    INTO kp_utel (LSCHET,ABON_ID,FIO,GRUPPA,SALDO,SUM_NACH,SUM_AVANS,SUM_OPLAT,
                  PENJA,PUNKT,STREET,NDOM,KVARTIRA)
   (SELECT r.LSCHET,r.ABON_ID,r.FIO,s.GRUPPA,s.SALDO,to_number(s.SUM_NACH),
           to_number(s.SUM_AVANS),to_number(s.SUM_OPLAT),to_number(s.PENJA),r.PUNKT,
           r.STREET,r.NDOM,r.KVARTIRA
    FROM kp_utel_s s, kp_utel_r r
    WHERE s.LSCHET=r.LSCHET and s.ABON_ID=r.ABON_ID and s.LSCHET<>'-1')")
.head 7 +  If bU
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SalFileCreateDirectory(dfKat || '\\Archiv')
.head 8 -  Call VisFileCopy(dfKat || '\\A' || Right(sFile, 10), dfKat || '\\Archiv\\A' ||
     Right(sFile, 10))
.head 8 +  If File(dfKat || '\\Archiv\\A' || Right(sFile, 10))
.head 9 -  Call VisFileDelete(dfKat || '\\A' || Right(sFile, 10))
.head 8 -  Call VisFileCopy(dfKat || '\\S' || Right(sFile, 10), dfKat || '\\Archiv\\S' ||
     Right(sFile, 10))
.head 8 +  If File(dfKat || '\\Archiv\\S' || Right(sFile, 10))
.head 9 -  Call VisFileDelete(dfKat || '\\S' || Right(sFile, 10))
.head 8 -  Call VisFileCopy(dfKat || '\\R' || Right(sFile, 10), dfKat || '\\Archiv\\R' ||
     Right(sFile, 10))
.head 8 +  If File(dfKat || '\\Archiv\\R' || Right(sFile, 10))
.head 9 -  Call VisFileDelete(dfKat || '\\R' || Right(sFile, 10))
.head 8 -  Set colRecc = Val(GetValueStr('
    SELECT to_char(count(*))
    FROM kp_utel'))
.head 8 -  ! Call SalHideWindow(cc1)
.head 8 -  ! Call SalShowWindow(dfDone)
.head 8 -  ! Call SalHideWindow(dfFIFI)
.head 8 -  Set colProgressDone = 'Готово !!!'
.head 8 -  Set dfDone = 'Готово'
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Edited | ROW_New, FALSE)
.head 8 -  Call SalTblSetRowFlags(hWndForm, 1, ROW_Edited | ROW_New, FALSE)
.head 8 -  Call SalTblSetRowFlags(hWndForm, 2, ROW_Edited | ROW_New, FALSE)
.head 8 -  Call SalTblSetRowFlags(hWndForm, 3, ROW_Edited | ROW_New, FALSE)
.head 8 -  ! Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call MessageNoWait('Импорт UTEL. Невозможно наполнить правильными данными KP_UTEL. '
     || 'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 37, 1)
.head 8 -  Call SalDestroyWindow(hWndForm)
.head 6 +  Else
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call MessageNoWait('Импорт UTEL. Невозможно удалить старую информацию из KP_UTEL. '
     || 'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 37, 1)
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 5 +  Else
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Else
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call MessageNoWait('Импорт UTEL. Отсутствуют файлы для импорта (' || dfKat ||
     '\\A??????.UNL)', 'ВНИМАНИЕ !!!', 37, 1)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 1 +  Dialog Box: dlg_LoadDbf    ! 01 Импорт с DBF приехал с OTCN.apd,  с прибамбасом
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Загрузка файла
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.738"
.head 4 -  Top:    1.188"
.head 4 -  Width:  7.2"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.452"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Загрузка файлов dbf в таблицы б.д. (MIK+IVAN)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  !
.head 3 +  Custom Control: ccProgressBar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.143"
.head 6 -  Top:    1.107"
.head 6 -  Width:  6.829"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.281"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 3041
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    -0.012"
.head 5 -  Width:  7.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.171"
.head 6 -  Top:    0.156"
.head 6 -  Width:  5.186"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSetFocus(hWndItem)
.head 3 +  Pushbutton: pbChoose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать...
.head 4 -  Window Location and Size
.head 5 -  Left:   5.486"
.head 5 -  Top:    0.135"
.head 5 -  Width:  1.429"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
.head 3 +  Check Box: cbTransCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Перекодировать из кодировки OEM (DOS) в ANSI (WIN)
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.595"
.head 5 -  Width:  5.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 3042
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    0.988"
.head 5 -  Width:  7.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.531"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 3043
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    1.5"
.head 5 -  Width:  7.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbRun
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   1.533"
.head 5 -  Top:    1.571"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\EXECUTE.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set fOpen=TRUE
.head 6 +  If dfPath = STRING_Null or dfPath = ''
.head 7 -  Set fOpen = SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
.head 6 +  Else
.head 7 -  Call VisDosSplitPath(dfPath, tmp01, tmp02, tmp03, tmp04)
.head 7 -  Set strFile=tmp03 || tmp04
.head 7 +  If not strFile
.head 8 -  Set fOpen = SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
.head 6 +  If fOpen
.head 7 +  If SalFileSetCurrentDirectory(SalStrLeftX(dfPath, SalStrScan(dfPath,strFile)-1))
.head 8 -  Call SalSetWindowText(hWndForm, 'Загрузка файла ' || dfPath)
.head 8 -  Call CreTabSqlFromDbf(strFile, strTabName, strPrcName, cbTransCode)
.head 7 +  Else
.head 8 -  Call SalMessageBox('Не удалось переити в каталог
' || dfPath, '', MB_OK)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.167"
.head 5 -  Top:    1.571"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 +  Data Field: dfRecN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.483"
.head 6 -  Top:    0.595"
.head 6 -  Width:  1.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: CreTabSqlFromDbf
.head 4 -  Description: Создание таблиы из DFB-файла
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sDbf
.head 5 -  String: sTabName     ! Имя таблицы куда импортить
.head 5 -  String: sProcName    ! Имя процедуры после импорта
.head 5 -  Boolean: bTrans
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlOdbc
.head 5 -  File Handle: hFile
.head 5 -  String: sBuf
.head 5 -  String: sItem
.head 5 -  String: sTyp
.head 5 -  String: sLen1
.head 5 -  String: sLen2
.head 5 -  Number: i
.head 5 -  Number: j
.head 5 -  Number: nLen1
.head 5 -  Number: nLen2
.head 5 -  String: sSqlItm
.head 5 -  String: sSqlSel
.head 5 -  String: sSqlBin
.head 5 -  String: sTabI  ! имя входной таблицы (dbf)
.head 5 -  String: sTabO  ! имя выходной таблицы ОРАКЛЕ
.head 5 -  String: sRealTab
.head 5 -  Number: NTmp[*]
.head 5 -  Number: LTmp[*]
.head 5 -  String: CTmp[*]
.head 5 -  Date/Time: DTmp[*]
.head 5 -  ! Number: nRec
.head 5 -  Number: nDelta
.head 5 -  Number: nFetchRes
.head 5 -  Number: nBound
.head 5 -  Boolean: fRecreate
.head 5 -  Boolean: fExists
.head 5 -  ! Boolean: fInsertRow
.head 5 -  Number: nRowsCount
.head 5 -  Number: nRow
.head 5 -  Number: nChoose
.head 5 -  !
.head 5 -  String: sSqlDel
.head 5 -  Number: nKp
.head 5 -  Number: nKv
.head 5 -  Number: nI
.head 5 -  String: smPer[*]
.head 5 -  String: smVal[*]
.head 5 -  Boolean: bDel
.head 5 -  Boolean: bDelZ
.head 4 +  Actions
.head 5 +  If SalFileOpen(hFile, sDbf, OF_Read)
.head 6 -  Call SalFileRead(hFile, sBuf, 32)
.head 6 -  Set sSqlItm = ''
.head 6 -  Set j = 0
.head 6 +  While SalFileRead(hFile, sBuf, 32) > 0
.head 7 -  Set sItem = SalStrTrimX(sBuf)
.head 7 +  If SalStrLop(sBuf) = 13
.head 8 -  Set sSqlItm = sSqlItm || ')'
.head 8 -  Break
.head 7 +  Else
.head 8 +  If SalStrLength(sSqlItm) = 0
.head 9 -  Set i = SalStrLength(sDbf)
.head 9 +  While i > 0
.head 10 -  ! Call SalMessageBox(SalStrMidX(sDbf, i-1, 1), 'MMM', MB_OK)
.head 10 +  If SalStrMidX(sDbf, i-1, 1) = '\\' or SalStrMidX(sDbf, i-1, 1) = ':'
.head 11 -  Break
.head 10 -  Set i = i - 1
.head 9 -  Set sTabI = SalStrMidX(sDbf, i, SalStrLength(sDbf) - i)
.head 9 -  Set i = SalStrScan(sTabI, '.')
.head 9 +  If i >= 0
.head 10 -  Set sTabI = SalStrLeftX(sTabI, SalStrScan(sTabI, '.'))
.head 9 -  Set sSqlItm = '('
.head 9 -  Set sSqlSel = ''
.head 9 -  Set sSqlBin = ''
.head 9 -  ! Call SalMessageBox(sSql, 'SSS', MB_OK)
.head 9 -  ! Return FALSE
.head 8 +  Else
.head 9 -  Set sSqlItm = sSqlItm || ',' || SalNumberToChar(10)
.head 9 -  Set sSqlSel = sSqlSel || ','
.head 9 -  Set sSqlBin = sSqlBin || ','
.head 7 -  Set i = 0
.head 7 -  ! Call Debug(sItem)
.head 7 -  ! Call Debug(sSqlItm)
.head 7 +  While i < 10
.head 8 -  Call SalStrLop(sBuf)
.head 8 -  Set i = i + 1
.head 7 -  Set sTyp = SalNumberToChar(SalStrLop(sBuf))
.head 7 +  If not (sTyp = 'C' OR sTyp = 'N' OR sTyp = 'D' OR sTyp = 'L')
.head 8 -  Set sSqlItm = SalStrMidX(sSqlItm, 0, SalStrLength(sSqlItm)-2)
.head 8 -  Set sSqlSel = SalStrMidX(sSqlSel, 0, SalStrLength(sSqlSel)-1)
.head 8 -  Set sSqlBin = SalStrMidX(sSqlBin, 0, SalStrLength(sSqlBin)-1)
.head 7 -  Set i = 0
.head 7 +  While i < 4
.head 8 -  Call SalStrLop(sBuf)
.head 8 -  Set i = i + 1
.head 7 -  Set nLen1 = SalStrLop(sBuf)
.head 7 -  Set sLen1 = SalNumberToStrX(nLen1, 0)
.head 7 -  Set nLen2 = SalStrLop(sBuf)
.head 7 -  Set sLen2 = SalNumberToStrX(nLen2, 0)
.head 7 +  If sTyp = 'C' OR sTyp = 'N' OR sTyp = 'D' OR sTyp = 'L'
.head 8 -  Set sSqlBin = sSqlBin || ':' || sTyp || 'Tmp[' || SalNumberToStrX(j, 0) || ']'
.head 8 -  ! Call Debug(sSqlBin)
.head 8 -  Set j = j + 1
.head 8 +  If sTyp = 'C'
.head 9 +  If nLen1 < 11
.head 10 -  Set sTyp = 'CHAR'
.head 9 +  Else
.head 10 -  Set sTyp = 'VARCHAR'
.head 8 +  Else If sTyp = 'N'
.head 9 +  If nLen1 < 5 and nLen2 = 0
.head 10 -  Set sTyp = 'SMALLINT'
.head 10 -  Set sLen1 = ''
.head 9 +  Else If nLen1 < 10 and nLen2 = 0
.head 10 -  Set sTyp = 'INTEGER'
.head 10 -  Set sLen1 = ''
.head 9 +  Else
.head 10 -  Set sTyp = 'DECIMAL'
.head 10 -  Set sLen1 = sLen1 || ',' || sLen2
.head 8 +  Else If sTyp = 'D'
.head 9 -  Set sTyp = 'DATE'
.head 9 -  Set sLen1 = ''
.head 8 +  Else If sTyp = 'L'
.head 9 -  Set sTyp = 'CHAR'
.head 9 -  Set sLen1 = '1'
.head 8 +  If sLen1 = ''
.head 9 -  Set sSqlItm = sSqlItm || sItem || ' ' || sTyp
.head 8 +  Else
.head 9 -  Set sSqlItm = sSqlItm || sItem || ' ' || sTyp || '(' || sLen1 || ')'
.head 8 -  Set sSqlSel = sSqlSel || sItem
.head 6 +  If hFile
.head 7 -  Call SalFileClose(hFile)
.head 6 -  ! =====================================
.head 6 -  Set SqlDatabase = 'dBase_Files'
.head 6 +  If SqlConnect(hSqlOdbc)
.head 7 +  If sTabName
.head 8 -  Set sTabO = sTabName   ! Внешнее имя создаваемой таблицы
.head 7 +  Else
.head 8 -  Set sTabO = sTabI      ! Имя таблицы совпадает с именем DBF
.head 7 -  Set sRealTab=sTabO
.head 7 +  If TableExists(sRealTab)
.head 8 -  Set fExists = TRUE
.head 8 -  ! смотрим есть ли записи в таблице
.head 8 +  If SqlPrepareAndExecute(hSqlAux(), 'SELECT count(*) INTO :nRowsCount FROM ' || sRealTab)
.head 9 -  Call SqlFetchNext(hSqlAux(), nRow)
.head 8 -  ! если нету строк - drop-нуть или оставить
.head 8 +  If nRowsCount = 0
.head 9 -  ! If SalMessageBox('Таблица ' || sRealTab || ' уже существует (пустая) !' ||
   PutCrLf() || 'Удалить таблицу ' || sRealTab || ' и создать НОВУЮ ?',
   'Подтверждение', MB_YesNo | MB_IconExclamation) = IDYES
.head 9 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgTable') || ' ' || sRealTab || ' ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg11') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg12') || ' ' || sRealTab || ' ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg13'),
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTConfirm'), MB_YesNo | MB_IconExclamation) = IDYES
.head 10 -  Set fRecreate = TRUE
.head 10 -  Set bDel = FALSE
.head 10 -  Set bDelZ = FALSE
.head 9 +  Else
.head 10 -  Return FALSE
.head 8 -  ! если есть строки - drop-нуть или просто удалить записи?
.head 8 +  Else
.head 9 -  Call VisMessageSetBkgdColor(COLOR_Salmon)
.head 9 -  Set hBtns[0] = hBtnDelNew
.head 9 -  Set hBtns[1] = hBtnNoDelNew
.head 9 -  Set hBtns[2] = hBtnNo | MBF_DefButton
.head 9 -  Set hBtns[3] = hBtnNoDelPlusNew1
.head 9 -  Set hBtns[4] = hBtnNoDelPlusNew2
.head 9 -  ! Set nChoose = VisMessageBox(
'Таблица ' || sRealTab || ' уже существует c данными !' || PutCrLf() || PutCrLf() ||
'                 НОВАЯ - Удалить таблицу и создать НОВУЮ' || PutCrLf() ||
'               ЗАМЕНА - НЕ удалять таблицу, УДАЛИТЬ старые данные' || PutCrLf() ||
'НОВЫЕ ДАННЫЕ - НЕ удалять таблицу, добавить ТОЛЬКО НОВЫЕ данные' || PutCrLf() ||
'          ДОБАВИТЬ - НЕ удалять таблицу, добавить ВСЕ данные', 'ЗАПРОС', MBF_IconQuestion, hBtns, 5)
.head 9 -  Set nChoose = VisMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgTable') || ' ' || sRealTab || ' ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg21') || PutCrLf() || PutCrLf() ||
    '                 ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnDelNew') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg22') || PutCrLf() ||
    '               ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelNew') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg23') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew1') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg24') || PutCrLf() ||
    '          ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew2') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg25'),
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTQuery'), MBF_IconQuestion, hBtns, 5)
.head 9 -  ! Call DebugN(nChoose)
.head 9 +  If nChoose = 0
.head 10 -  Set fRecreate = TRUE
.head 10 -  Set bDel = FALSE
.head 9 +  If nChoose = 1
.head 10 -  Set fRecreate = FALSE
.head 10 -  Set bDel = TRUE
.head 10 -  Set bDelZ = TRUE
.head 9 +  If nChoose = 2
.head 10 -  Return FALSE
.head 9 +  If nChoose = 3
.head 10 -  Set fRecreate = FALSE
.head 10 -  Set bDel = FALSE
.head 10 -  Set bDelZ = TRUE
.head 9 +  If nChoose = 4
.head 10 -  Set fRecreate = FALSE
.head 10 -  Set bDel = FALSE
.head 10 -  Set bDelZ = FALSE
.head 9 +  ! Set nChoose = SalMessageBox('Таблица ' || sRealTab ||
    ' уже существует c данными, удалить ?!
    ' || '
Удалить таблицу и создать новую ' || sRealTab || '(Yes/Да).
Не удалять таблицу, только импортировать новые данные(No/Нет) ?',
    'Подтверждение', MB_YesNoCancel | MB_IconExclamation)
.head 10 -                                  Set fRecreate = TRUE
.head 9 +  ! If nChoose = IDCANCEL
.head 10 -                                  Return FALSE
.head 9 +  ! If nChoose = IDNO
.head 10 -                                  Set fRecreate = FALSE
.head 9 +  ! If nChoose = IDYES
.head 10 -                                  Set fRecreate = TRUE
.head 7 +  Else
.head 8 -  Set fRecreate = TRUE
.head 8 -  Set fExists = FALSE
.head 7 -  ! Синоним существует - убиваем нафиг
.head 7 +  If TRUE
.head 8 +  When SqlError
.head 9 -  Return FALSE
.head 8 -  ! Дропаем его нафиг
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'DROP PUBLIC SYNONYM ' || sTabO)
.head 7 +  If fRecreate
.head 8 +  If fExists
.head 9 +  If SqlPrepareAndExecute(hSql(), 'DROP TABLE ' || sRealTab)
.head 10 +  When SqlError
.head 11 -  Return FALSE
.head 10 -  Call SqlPrepareAndExecute(hSql(), 'DROP PUBLIC SYNONYM ' || sTabO)
.head 10 -  Call SqlPrepareAndExecute(hSql(), 'DROP ROLE ' || sTabO)
.head 9 +  Else
.head 10 -  Return FALSE
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'CREATE TABLE ' || sTabO || ' ' || sSqlItm)
.head 7 +  Else
.head 8 -  ! есть строки - просто удалить записи
.head 8 +  If bDel
.head 9 +  If SqlPrepareAndExecute(hSqlAux(), 'DELETE FROM ' || sRealTab)
.head 10 -  Call SqlCommit(hSqlAux())
.head 9 +  Else
.head 10 -  ! Call SalMessageBox('Невозможно удалить записи из таблицы ' || sRealTab, 'Внимание', 0)
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgDel') || ' ' || sRealTab,
  CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 10 -  Return FALSE
.head 7 -  Set dfRecN=0
.head 7 -  Call SqlPrepareAndExecute(hSqlOdbc, 'SELECT count(*) FROM ' || sTabI || ' INTO :dfRecN')
.head 7 -  Call SqlFetchNext(hSqlOdbc, nFetchRes)
.head 7 +  If dfRecN > 0
.head 8 -  Set i = 0
.head 8 -  Set nDelta = 100/dfRecN
.head 8 -  Call SqlPrepareAndExecute(hSqlOdbc, 'SELECT ' || sSqlSel || ' INTO ' || sSqlBin || ' FROM ' || sTabI)
.head 8 +  While SqlFetchNext(hSqlOdbc, nFetchRes)
.head 9 -  Set j = 0
.head 9 -  Call SalArrayGetUpperBound(CTmp, 1, nBound)
.head 9 +  While j <= nBound
.head 10 +  If SalStrLength(CTmp[j]) > 0
.head 11 -  Set CTmp[j] = SalStrTrimX(IifS(bTrans, StrDosToWinX(CTmp[j]), CTmp[j]))
.head 10 -  Set j = j + 1
.head 9 -  Set nKp = SalStrTokenize(sSqlSel, '', ',', smPer)
.head 9 -  Set nKv = SalStrTokenize(sSqlBin, '', ',', smVal)
.head 9 +  If nKp = nKv
.head 10 -  Set nI = 0
.head 10 -  Set sSqlDel = ''
.head 10 +  While nI < nKp
.head 11 -  Set sSqlDel = sSqlDel || smPer[nI] || '=' || smVal[nI] || ' and '
.head 11 -  Set nI = nI + 1
.head 10 -  Set sSqlDel = Left(sSqlDel, Len(sSqlDel)-5)
.head 9 +  If bDelZ
.head 10 -  Call SqlPrepareAndExecute(hSql(), 'DELETE FROM ' || sTabO || ' WHERE ' || sSqlDel)
.head 9 -  Call SqlPrepareAndExecute(hSql(), 'INSERT INTO ' || sTabO || ' (' || sSqlSel || ') VALUES(' || sSqlBin || ')')
.head 9 -  Set i = i + nDelta
.head 9 -  Set dfRecN=dfRecN-1
.head 9 -  Call ccProgressBar.SetProgress(i)
.head 9 -  Call SalUpdateWindow (SalParentWindow (hWndForm))
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call ccProgressBar.SetProgress(100)
.head 7 -  Call SqlDisconnect(hSqlOdbc)
.head 7 +  If sProcName
.head 8 -  Call Debug('Процедура'||sProcName)
.head 8 +  If not SqlPLSQLCommand(hSql(),sProcName)
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SalMessageBox('Не удалось выполнить процедуру: ' || sProcName, 'Ошибка', MB_OK)
.head 9 -  Return FALSE
.head 7 -  ! Make some additional settings for using new table in ABS
.head 7 +  If TRUE
.head 8 +  When SqlError
.head 9 -  Return FALSE
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'CREATE PUBLIC SYNONYM ' || sTabO || ' FOR ' || GetUserLoginName() || '.' || sTabO)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'GRANT SELECT ON ' || sTabO || ' TO START1')
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'CREATE ROLE ' || sTabO)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'GRANT SELECT ON ' || sTabO || ' TO ' || sTabO)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'GRANT INSERT ON ' || sTabO || ' TO ' || sTabO)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'GRANT UPDATE ON ' || sTabO || ' TO ' || sTabO)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'GRANT DELETE ON ' || sTabO || ' TO ' || sTabO)
.head 7 -  !
.head 7 -  Call SalMessageBeep(MB_IconAsterisk)
.head 7 -  ! Call SalMessageBox('Обработка файла завершена!', 'Загрузка', MB_IconAsterisk | MB_Ok)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgFileOk'),
 CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTLoad'), MB_IconAsterisk | MB_Ok)
.head 6 +  Else
.head 7 -  ! Call SalMessageBox('Нет доступа к базе данных: ' || SqlDatabase, 'Ошибка', MB_OK)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTErrDB') || ': ' || SqlDatabase,
  CurrentLangTable.GetAtomTitle('cTErr'), MB_OK)
.head 7 -  Return FALSE
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  ! Call SalMessageBox('Не удалось открыть файл: ' || sDbf, 'Ошибка', MB_OK)
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTerrFileOpen') || ': ' || sDbf,
  CurrentLangTable.GetAtomTitle('cTErr'), MB_OK)
.head 6 -  Return FALSE
.head 3 +  Function: TableExists
.head 4 -  Description: Находит таблицу по синониму или в схеме текущего ползователя
Возвращает True если таблица есть
Параметр sTabName возвращает полностью квалифицированное имя таблицы
OWNER.TABLE
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive String: sTabName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetchRes
.head 5 -  String: sOwner
.head 5 -  String: sTable
.head 4 +  Actions
.head 5 -  !
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_OWNER, TABLE_NAME
   INTO :sOwner,:sTable
   FROM ALL_SYNONYMS
   WHERE UPPER(SYNONYM_NAME)=UPPER('" || SalStrTrimX(sTabName) || "')")
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Синоним есть
.head 7 -  Set sOwner = SalStrTrimX(sOwner)
.head 7 -  Set sTable = SalStrTrimX(sTable)
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_NAME
   FROM DBA_TABLES
   WHERE UPPER(OWNER)=UPPER('" || SalStrTrimX(sOwner) || "') and
         UPPER(TABLE_NAME)=UPPER('" || SalStrTrimX(sTable) || "')")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! И указывает на таблицу
.head 9 -  Set sTabName = sOwner || '.' || sTable
.head 9 -  Return nFetchRes = FETCH_Ok
.head 8 +  Else
.head 9 -  ! И указывает в никуда
.head 9 +  If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_NAME
   FROM USER_TABLES
   WHERE UPPER(TABLE_NAME)=UPPER('" || SalStrTrimX(sTabName) || "')")
.head 10 +  If SqlFetchNext(hSql(), nFetchRes)
.head 11 -  ! Но, таблица есть
.head 11 -  Set sTabName = GetUserLoginName() || '.' || sTable
.head 11 -  Return nFetchRes = FETCH_Ok
.head 6 +  Else
.head 7 -  ! Синонима нет
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_NAME
   FROM USER_TABLES
   WHERE UPPER(TABLE_NAME)=UPPER('" || SalStrTrimX(sTabName) || "')")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! Таблица есть
.head 9 -  Set sTabName = GetUserLoginName() || '.' || sTabName
.head 9 -  Return nFetchRes = FETCH_Ok
.head 5 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  String: strFn
.head 3 -  String: strPar
.head 2 +  Window Variables
.head 3 -  Number: nIndex
.head 3 -  String: strFilters[2]
.head 3 -  String: strFile
.head 3 -  Boolean: fOpen
.head 3 -  String: tmp01
.head 3 -  String: tmp02
.head 3 -  String: tmp03
.head 3 -  String: tmp04
.head 3 -  !
.head 3 -  Number: hBtnDelNew
.head 3 -  Number: hBtnNoDelNew
.head 3 -  Number: hBtnNoDelPlusNew1
.head 3 -  Number: hBtnNoDelPlusNew2
.head 3 -  Number: hBtnNo
.head 3 -  Number: hBtns[*]
.head 3 -  String: strTabName
.head 3 -  String: strPrcName
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTWndTitle') )
.head 4 -  Call ShowApdVersion('01')
.head 4 -  Set dfPath = strFn
.head 4 -  Set strFilters[0] = 'Data Base Files (*.dbf)'
.head 4 -  Set strFilters[1] = '*.dbf'
.head 4 -  ! Call SalSetWindowText(hWndForm, 'Загрузка файла ' || sFn)
.head 4 -  Set strTabName=SalStrTrimX(SalStrLeftX(strPar,SalStrScan(strPar||',',',')))
.head 4 -  Set strPrcName=SalStrTrimX(SalStrRightX(strPar,SalStrLength(strPar)-SalStrScan(strPar||',',',')-1))
.head 4 -  Call WaitCursorOn()
.head 3 +  On SAM_CreateComplete
.head 4 -  Set hBtnDelNew = VisMessageLoadButton('&0.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnDelNew'), 0)
.head 4 -  Set hBtnNoDelNew = VisMessageLoadButton('&1.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelNew'), 1)
.head 4 -  Set hBtnNo = VisMessageLoadButton('&2.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNo'), 2)
.head 4 -  Set hBtnNoDelPlusNew1 = VisMessageLoadButton('&3.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew1'), 3)
.head 4 -  Set hBtnNoDelPlusNew2 = VisMessageLoadButton('&4.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew2'), 4)
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_Destroy
.head 4 -  Call VisMessageFreeButton(hBtnDelNew)
.head 4 -  Call VisMessageFreeButton(hBtnNoDelNew)
.head 4 -  Call VisMessageFreeButton(hBtnNoDelPlusNew1)
.head 4 -  Call VisMessageFreeButton(hBtnNoDelPlusNew2)
.head 4 -  Call VisMessageFreeButton(hBtnNo)
.head 4 -  ! Disactivation of function's role, which activated for calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(), 'Imp_KL_NBU(hWndMDI)')
.head 4 -  Call WaitCursorOff()
.head 1 +  ! Form Window: frm_LoadDbf   ! 01 Импорт с DBF приехал с OTCN.apd,  с прибамбасом
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   1.1"
.head 4 -  Top:    1.375"
.head 4 -  Width:  7.633"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.881"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -                                Description: 
.head 2 -                                Named Menus 
.head 2 -                                Menu 
.head 2 +                                Tool Bar 
.head 3 -                                Contents 
.head 2 +                                Contents 
.head 3 -  !
.head 3 +  ! cMeter: ccProgressBar
.head 4 -                                Message Actions 
.head 3 -  !
.head 3 -                                Frame 
.head 3 +                                Data Field: dfPath
.head 4 +                                Message Actions 
.head 5 +                                On SAM_Create
.head 6 -                                Call SalSetFocus(hWndItem)
.head 3 +                                Pushbutton: pbChoose
.head 4 +                                Message Actions 
.head 5 +                                On SAM_Click
.head 6 -                                Call SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
.head 3 +                                Check Box: cbTransCode
.head 4 -                                Message Actions 
.head 3 -                                Frame 
.head 3 -                                Frame 
.head 3 +                                Pushbutton: pbRun
.head 4 +                                Message Actions 
.head 5 +                                On SAM_Click
.head 6 -                                Set fOpen=TRUE
.head 6 +                                If dfPath = STRING_Null or dfPath = ''
.head 7 -                                Set fOpen = SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
.head 6 +                                Else 
.head 7 -                                Call VisDosSplitPath(dfPath, tmp01, tmp02, tmp03, tmp04)
.head 7 -                                Set strFile=tmp03 || tmp04
.head 7 +                                If not strFile
.head 8 -                                Set fOpen = SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
.head 6 +                                If fOpen
.head 7 +                                If SalFileSetCurrentDirectory(SalStrLeftX(dfPath, SalStrScan(dfPath,strFile)-1))
.head 8 -                                Call SalSetWindowText(hWndForm, 'Загрузка файла ' || dfPath)
.head 8 -                                Call CreTabSqlFromDbf(strFile, strTabName, cbTransCode)
.head 7 +                                Else 
.head 8 -                                Call SalMessageBox('Не удалось переити в каталог
' || dfPath, '', MB_OK)
.head 3 +                                Pushbutton: pbExit
.head 4 +                                Message Actions 
.head 5 +                                On SAM_Click
.head 6 -                                Call SalDestroyWindow(hWndForm)
.head 3 +                                Data Field: dfRecN
.head 4 -                                Message Actions 
.head 2 +                                Functions 
.head 3 +                                Function: CreTabSqlFromDbf
.head 4 -                                Description: Создание таблиы из DFB-файла
.head 4 +                                Returns 
.head 5 -                                Boolean: 
.head 4 +                                Parameters 
.head 5 -                                String: sDbf
.head 5 -                                String: sTabName     ! Имя таблицы куда импортить
.head 5 -                                Boolean: bTrans
.head 4 -                                Static Variables 
.head 4 +                                Local variables 
.head 5 -                                Sql Handle: hSqlOdbc
.head 5 -                                File Handle: hFile
.head 5 -                                String: sBuf
.head 5 -                                String: sItem
.head 5 -                                String: sTyp
.head 5 -                                String: sLen1
.head 5 -                                String: sLen2
.head 5 -                                Number: i
.head 5 -                                Number: j
.head 5 -                                Number: nLen1
.head 5 -                                Number: nLen2
.head 5 -                                String: sSqlItm
.head 5 -                                String: sSqlSel
.head 5 -                                String: sSqlBin
.head 5 -                                String: sTabI  ! имя входной таблицы (dbf)
.head 5 -                                String: sTabO  ! имя выходной таблицы ОРАКЛЕ
.head 5 -                                String: sRealTab
.head 5 -                                Number: NTmp[*]
.head 5 -                                Number: LTmp[*]
.head 5 -                                String: CTmp[*]
.head 5 -                                Date/Time: DTmp[*]
.head 5 -  ! Number: nRec
.head 5 -                                Number: nDelta
.head 5 -                                Number: nFetchRes
.head 5 -                                Number: nBound
.head 5 -                                Boolean: fRecreate
.head 5 -                                Boolean: fExists
.head 5 -  ! Boolean: fInsertRow
.head 5 -                                Number: nRowsCount
.head 5 -                                Number: nRow
.head 5 -                                Number: nChoose
.head 5 -  !
.head 5 -                                String: sSqlDel
.head 5 -                                Number: nKp
.head 5 -                                Number: nKv
.head 5 -                                Number: nI
.head 5 -                                String: smPer[*]
.head 5 -                                String: smVal[*]
.head 5 -                                Boolean: bDel
.head 5 -                                Boolean: bDelZ
.head 4 +                                Actions 
.head 5 +                                If SalFileOpen(hFile, sDbf, OF_Read)
.head 6 -                                Call SalFileRead(hFile, sBuf, 32)
.head 6 -                                Set sSqlItm = ''
.head 6 -                                Set j = 0
.head 6 +                                While SalFileRead(hFile, sBuf, 32) > 0
.head 7 -                                Set sItem = SalStrTrimX(sBuf)
.head 7 +                                If SalStrLop(sBuf) = 13
.head 8 -                                Set sSqlItm = sSqlItm || ')'
.head 8 -                                Break 
.head 7 +                                Else 
.head 8 +                                If SalStrLength(sSqlItm) = 0
.head 9 -                                Set i = SalStrLength(sDbf)
.head 9 +                                While i > 0
.head 10 -  ! Call SalMessageBox(SalStrMidX(sDbf, i-1, 1), 'MMM', MB_OK)
.head 10 +                                If SalStrMidX(sDbf, i-1, 1) = '\\' or SalStrMidX(sDbf, i-1, 1) = ':'
.head 11 -                                Break 
.head 10 -                                Set i = i - 1
.head 9 -                                Set sTabI = SalStrMidX(sDbf, i, SalStrLength(sDbf) - i)
.head 9 -                                Set i = SalStrScan(sTabI, '.')
.head 9 +                                If i >= 0
.head 10 -                                Set sTabI = SalStrLeftX(sTabI, SalStrScan(sTabI, '.'))
.head 9 -                                Set sSqlItm = '('
.head 9 -                                Set sSqlSel = ''
.head 9 -                                Set sSqlBin = ''
.head 9 -  ! Call SalMessageBox(sSql, 'SSS', MB_OK)
.head 9 -  ! Return FALSE
.head 8 +                                Else 
.head 9 -                                Set sSqlItm = sSqlItm || ',' || SalNumberToChar(10)
.head 9 -                                Set sSqlSel = sSqlSel || ','
.head 9 -                                Set sSqlBin = sSqlBin || ','
.head 7 -                                Set i = 0
.head 7 -  ! Call Debug(sItem)
.head 7 -  ! Call Debug(sSqlItm)
.head 7 +                                While i < 10
.head 8 -                                Call SalStrLop(sBuf)
.head 8 -                                Set i = i + 1
.head 7 -                                Set sTyp = SalNumberToChar(SalStrLop(sBuf))
.head 7 +                                If not (sTyp = 'C' OR sTyp = 'N' OR sTyp = 'D' OR sTyp = 'L')
.head 8 -                                Set sSqlItm = SalStrMidX(sSqlItm, 0, SalStrLength(sSqlItm)-2)
.head 8 -                                Set sSqlSel = SalStrMidX(sSqlSel, 0, SalStrLength(sSqlSel)-1)
.head 8 -                                Set sSqlBin = SalStrMidX(sSqlBin, 0, SalStrLength(sSqlBin)-1)
.head 7 -                                Set i = 0
.head 7 +                                While i < 4
.head 8 -                                Call SalStrLop(sBuf)
.head 8 -                                Set i = i + 1
.head 7 -                                Set nLen1 = SalStrLop(sBuf)
.head 7 -                                Set sLen1 = SalNumberToStrX(nLen1, 0)
.head 7 -                                Set nLen2 = SalStrLop(sBuf)
.head 7 -                                Set sLen2 = SalNumberToStrX(nLen2, 0)
.head 7 +                                If sTyp = 'C' OR sTyp = 'N' OR sTyp = 'D' OR sTyp = 'L'
.head 8 -                                Set sSqlBin = sSqlBin || ':' || sTyp || 'Tmp[' || SalNumberToStrX(j, 0) || ']'
.head 8 -  ! Call Debug(sSqlBin)
.head 8 -                                Set j = j + 1
.head 8 +                                If sTyp = 'C'
.head 9 +                                If nLen1 < 11
.head 10 -                                Set sTyp = 'CHAR'
.head 9 +                                Else 
.head 10 -                                Set sTyp = 'VARCHAR'
.head 8 +                                Else If sTyp = 'N'
.head 9 +                                If nLen1 < 5 and nLen2 = 0
.head 10 -                                Set sTyp = 'SMALLINT'
.head 10 -                                Set sLen1 = ''
.head 9 +                                Else If nLen1 < 10 and nLen2 = 0
.head 10 -                                Set sTyp = 'INTEGER'
.head 10 -                                Set sLen1 = ''
.head 9 +                                Else 
.head 10 -                                Set sTyp = 'DECIMAL'
.head 10 -                                Set sLen1 = sLen1 || ',' || sLen2
.head 8 +                                Else If sTyp = 'D'
.head 9 -                                Set sTyp = 'DATE'
.head 9 -                                Set sLen1 = ''
.head 8 +                                Else If sTyp = 'L'
.head 9 -                                Set sTyp = 'CHAR'
.head 9 -                                Set sLen1 = '1'
.head 8 +                                If sLen1 = ''
.head 9 -                                Set sSqlItm = sSqlItm || sItem || ' ' || sTyp
.head 8 +                                Else 
.head 9 -                                Set sSqlItm = sSqlItm || sItem || ' ' || sTyp || '(' || sLen1 || ')'
.head 8 -                                Set sSqlSel = sSqlSel || sItem
.head 6 +                                If hFile
.head 7 -                                Call SalFileClose(hFile)
.head 6 -  ! =====================================
.head 6 -                                Set SqlDatabase = 'dBase_Files'
.head 6 +                                If SqlConnect(hSqlOdbc)
.head 7 +                                If sTabName
.head 8 -                                Set sTabO = sTabName   ! Внешнее имя создаваемой таблицы
.head 7 +                                Else 
.head 8 -                                Set sTabO = sTabI      ! Имя таблицы совпадает с именем DBF
.head 7 -                                Set sRealTab=sTabO
.head 7 +                                If TableExists(sRealTab)
.head 8 -                                Set fExists = TRUE
.head 8 -  ! смотрим есть ли записи в таблице
.head 8 +                                If SqlPrepareAndExecute(hSqlAux(), 'SELECT count(*) INTO :nRowsCount FROM ' || sRealTab)
.head 9 -                                Call SqlFetchNext(hSqlAux(), nRow)
.head 8 -  ! если нету строк - drop-нуть или оставить
.head 8 +                                If nRowsCount = 0
.head 9 -  ! If SalMessageBox('Таблица ' || sRealTab || ' уже существует (пустая) !' ||
   PutCrLf() || 'Удалить таблицу ' || sRealTab || ' и создать НОВУЮ ?',
   'Подтверждение', MB_YesNo | MB_IconExclamation) = IDYES
.head 9 +                                If SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgTable') || ' ' || sRealTab || ' ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg11') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg12') || ' ' || sRealTab || ' ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg13'),
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTConfirm'), MB_YesNo | MB_IconExclamation) = IDYES
.head 10 -                                Set fRecreate = TRUE
.head 10 -                                Set bDel = FALSE
.head 10 -                                Set bDelZ = FALSE
.head 9 +                                Else 
.head 10 -                                Return FALSE
.head 8 -  ! если есть строки - drop-нуть или просто удалить записи?
.head 8 +                                Else 
.head 9 -                                Call VisMessageSetBkgdColor(COLOR_Salmon)
.head 9 -                                Set hBtns[0] = hBtnDelNew
.head 9 -                                Set hBtns[1] = hBtnNoDelNew
.head 9 -                                Set hBtns[2] = hBtnNo | MBF_DefButton
.head 9 -                                Set hBtns[3] = hBtnNoDelPlusNew1
.head 9 -                                Set hBtns[4] = hBtnNoDelPlusNew2
.head 9 -  ! Set nChoose = VisMessageBox(
'Таблица ' || sRealTab || ' уже существует c данными !' || PutCrLf() || PutCrLf() ||
'                 НОВАЯ - Удалить таблицу и создать НОВУЮ' || PutCrLf() ||
'               ЗАМЕНА - НЕ удалять таблицу, УДАЛИТЬ старые данные' || PutCrLf() ||
'НОВЫЕ ДАННЫЕ - НЕ удалять таблицу, добавить ТОЛЬКО НОВЫЕ данные' || PutCrLf() ||
'          ДОБАВИТЬ - НЕ удалять таблицу, добавить ВСЕ данные', 'ЗАПРОС', MBF_IconQuestion, hBtns, 5)
.head 9 -                                Set nChoose = VisMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgTable') || ' ' || sRealTab || ' ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg21') || PutCrLf() || PutCrLf() ||
    '                 ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnDelNew') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg22') || PutCrLf() ||
    '               ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelNew') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg23') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew1') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg24') || PutCrLf() ||
    '          ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew2') || ' - ' ||
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsg25'),
  CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTQuery'), MBF_IconQuestion, hBtns, 5)
.head 9 -  ! Call DebugN(nChoose)
.head 9 +                                If nChoose = 0
.head 10 -                                Set fRecreate = TRUE
.head 10 -                                Set bDel = FALSE
.head 9 +                                If nChoose = 1
.head 10 -                                Set fRecreate = FALSE
.head 10 -                                Set bDel = TRUE
.head 10 -                                Set bDelZ = TRUE
.head 9 +                                If nChoose = 2
.head 10 -                                Return FALSE
.head 9 +                                If nChoose = 3
.head 10 -                                Set fRecreate = FALSE
.head 10 -                                Set bDel = FALSE
.head 10 -                                Set bDelZ = TRUE
.head 9 +                                If nChoose = 4
.head 10 -                                Set fRecreate = FALSE
.head 10 -                                Set bDel = FALSE
.head 10 -                                Set bDelZ = FALSE
.head 9 +  ! Set nChoose = SalMessageBox('Таблица ' || sRealTab ||
    ' уже существует c данными, удалить ?!
    ' || '
Удалить таблицу и создать новую ' || sRealTab || '(Yes/Да).
Не удалять таблицу, только импортировать новые данные(No/Нет) ?',
    'Подтверждение', MB_YesNoCancel | MB_IconExclamation)
.head 10 -                                  Set fRecreate = TRUE
.head 9 +  ! If nChoose = IDCANCEL
.head 10 -                                  Return FALSE
.head 9 +  ! If nChoose = IDNO
.head 10 -                                  Set fRecreate = FALSE
.head 9 +  ! If nChoose = IDYES
.head 10 -                                  Set fRecreate = TRUE
.head 7 +                                Else 
.head 8 -                                Set fRecreate = TRUE
.head 8 -                                Set fExists = FALSE
.head 7 -  ! Синоним существует - убиваем нафиг
.head 7 +                                If TRUE
.head 8 +                                When SqlError
.head 9 -                                Return FALSE
.head 8 -  ! Дропаем его нафиг
.head 8 -                                Call SqlPrepareAndExecute(hSql(), 'DROP PUBLIC SYNONYM ' || sTabO)
.head 7 +                                If fRecreate
.head 8 +                                If fExists
.head 9 +                                If SqlPrepareAndExecute(hSql(), 'DROP TABLE ' || sRealTab)
.head 10 +                                When SqlError
.head 11 -                                Return FALSE
.head 10 -                                Call SqlPrepareAndExecute(hSql(), 'DROP PUBLIC SYNONYM ' || sTabO)
.head 10 -                                Call SqlPrepareAndExecute(hSql(), 'DROP ROLE ' || sTabO)
.head 9 +                                Else 
.head 10 -                                Return FALSE
.head 8 -                                Call SqlPrepareAndExecute(hSql(), 'CREATE TABLE ' || sTabO || ' ' || sSqlItm)
.head 7 +                                Else 
.head 8 -  ! есть строки - просто удалить записи
.head 8 +                                If bDel
.head 9 +                                If SqlPrepareAndExecute(hSqlAux(), 'DELETE FROM ' || sRealTab)
.head 10 -                                Call SqlCommit(hSqlAux())
.head 9 +                                Else 
.head 10 -  ! Call SalMessageBox('Невозможно удалить записи из таблицы ' || sRealTab, 'Внимание', 0)
.head 10 -                                Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgDel') || ' ' || sRealTab,
  CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 10 -                                Return FALSE
.head 7 -                                Set dfRecN=0
.head 7 -                                Call SqlPrepareAndExecute(hSqlOdbc, 'SELECT count(*) FROM ' || sTabI || ' INTO :dfRecN')
.head 7 -                                Call SqlFetchNext(hSqlOdbc, nFetchRes)
.head 7 +                                If dfRecN > 0
.head 8 -                                Set i = 0
.head 8 -                                Set nDelta = 100/dfRecN
.head 8 -                                Call SqlPrepareAndExecute(hSqlOdbc, 'SELECT ' || sSqlSel || ' INTO ' || sSqlBin || ' FROM ' || sTabI)
.head 8 +                                While SqlFetchNext(hSqlOdbc, nFetchRes)
.head 9 -                                Set j = 0
.head 9 -                                Call SalArrayGetUpperBound(CTmp, 1, nBound)
.head 9 +                                While j <= nBound
.head 10 +                                If SalStrLength(CTmp[j]) > 0
.head 11 -                                Set CTmp[j] = SalStrTrimX(IifS(bTrans, StrDosToWinX(CTmp[j]), CTmp[j]))
.head 10 -                                Set j = j + 1
.head 9 -                                Set nKp = SalStrTokenize(sSqlSel, '', ',', smPer)
.head 9 -                                Set nKv = SalStrTokenize(sSqlBin, '', ',', smVal)
.head 9 +                                If nKp = nKv
.head 10 -                                Set nI = 0
.head 10 -                                Set sSqlDel = ''
.head 10 +                                While nI < nKp
.head 11 -                                Set sSqlDel = sSqlDel || smPer[nI] || '=' || smVal[nI] || ' and '
.head 11 -                                Set nI = nI + 1
.head 10 -                                Set sSqlDel = Left(sSqlDel, Len(sSqlDel)-5)
.head 9 +                                If bDelZ
.head 10 -                                Call SqlPrepareAndExecute(hSql(), 'DELETE FROM ' || sTabO || ' WHERE ' || sSqlDel)
.head 9 -                                Call SqlPrepareAndExecute(hSql(), 'INSERT INTO ' || sTabO || ' (' || sSqlSel || ') VALUES(' || sSqlBin || ')')
.head 9 -                                Set i = i + nDelta
.head 9 -                                Set dfRecN=dfRecN-1
.head 9 -  ! Call ccProgressBar.SetProgress(i)
.head 9 -  ! Call SalSetFocus(ccProgressBar)
.head 9 -                                Call SalUpdateWindow (hWndForm)
.head 7 -                                Call SqlCommit(hSql())
.head 7 -  ! Call ccProgressBar.SetProgress(100)
.head 7 -                                Call SqlDisconnect(hSqlOdbc)
.head 7 -  ! Make some additional settings for using new table in ABS
.head 7 +                                If TRUE
.head 8 +                                When SqlError
.head 9 -                                Return FALSE
.head 8 -                                Call SqlPrepareAndExecute(hSql(), 'CREATE PUBLIC SYNONYM ' || sTabO || ' FOR ' || GetUserLoginName() || '.' || sTabO)
.head 8 -                                Call SqlPrepareAndExecute(hSql(), 'GRANT SELECT ON ' || sTabO || ' TO START1')
.head 8 -                                Call SqlPrepareAndExecute(hSql(), 'CREATE ROLE ' || sTabO)
.head 8 -                                Call SqlPrepareAndExecute(hSql(), 'GRANT SELECT ON ' || sTabO || ' TO ' || sTabO)
.head 8 -                                Call SqlPrepareAndExecute(hSql(), 'GRANT INSERT ON ' || sTabO || ' TO ' || sTabO)
.head 8 -                                Call SqlPrepareAndExecute(hSql(), 'GRANT UPDATE ON ' || sTabO || ' TO ' || sTabO)
.head 8 -                                Call SqlPrepareAndExecute(hSql(), 'GRANT DELETE ON ' || sTabO || ' TO ' || sTabO)
.head 7 -  !
.head 7 -                                Call SalMessageBeep(MB_IconAsterisk)
.head 7 -  ! Call SalMessageBox('Обработка файла завершена!', 'Загрузка', MB_IconAsterisk | MB_Ok)
.head 7 -                                Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTMsgFileOk'),
 CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTLoad'), MB_IconAsterisk | MB_Ok)
.head 6 +                                Else 
.head 7 -  ! Call SalMessageBox('Нет доступа к базе данных: ' || SqlDatabase, 'Ошибка', MB_OK)
.head 7 -                                Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTErrDB') || ': ' || SqlDatabase,
  CurrentLangTable.GetAtomTitle('cTErr'), MB_OK)
.head 7 -                                Return FALSE
.head 6 -                                Return TRUE
.head 5 +                                Else 
.head 6 -  ! Call SalMessageBox('Не удалось открыть файл: ' || sDbf, 'Ошибка', MB_OK)
.head 6 -                                Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTerrFileOpen') || ': ' || sDbf,
  CurrentLangTable.GetAtomTitle('cTErr'), MB_OK)
.head 6 -                                Return FALSE
.head 3 +                                Function: TableExists
.head 4 -                                Description: Находит таблицу по синониму или в схеме текущего ползователя
Возвращает True если таблица есть
Параметр sTabName возвращает полностью квалифицированное имя таблицы
OWNER.TABLE
.head 4 +                                Returns 
.head 5 -                                Boolean: 
.head 4 +                                Parameters 
.head 5 -                                Receive String: sTabName
.head 4 -                                Static Variables 
.head 4 +                                Local variables 
.head 5 -                                Number: nFetchRes
.head 5 -                                String: sOwner
.head 5 -                                String: sTable
.head 4 +                                Actions 
.head 5 -  !
.head 5 +                                If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_OWNER, TABLE_NAME
   INTO :sOwner,:sTable
   FROM ALL_SYNONYMS
   WHERE UPPER(SYNONYM_NAME)=UPPER('" || SalStrTrimX(sTabName) || "')")
.head 6 +                                If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Синоним есть
.head 7 -                                Set sOwner = SalStrTrimX(sOwner)
.head 7 -                                Set sTable = SalStrTrimX(sTable)
.head 7 +                                If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_NAME
   FROM DBA_TABLES
   WHERE UPPER(OWNER)=UPPER('" || SalStrTrimX(sOwner) || "') and
         UPPER(TABLE_NAME)=UPPER('" || SalStrTrimX(sTable) || "')")
.head 8 +                                If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! И указывает на таблицу
.head 9 -                                Set sTabName = sOwner || '.' || sTable
.head 9 -                                Return nFetchRes = FETCH_Ok
.head 8 +                                Else 
.head 9 -  ! И указывает в никуда
.head 9 +                                If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_NAME
   FROM USER_TABLES
   WHERE UPPER(TABLE_NAME)=UPPER('" || SalStrTrimX(sTabName) || "')")
.head 10 +                                If SqlFetchNext(hSql(), nFetchRes)
.head 11 -  ! Но, таблица есть
.head 11 -                                Set sTabName = GetUserLoginName() || '.' || sTable
.head 11 -                                Return nFetchRes = FETCH_Ok
.head 6 +                                Else 
.head 7 -  ! Синонима нет
.head 7 +                                If SqlPrepareAndExecute(hSql(), "
   SELECT TABLE_NAME
   FROM USER_TABLES
   WHERE UPPER(TABLE_NAME)=UPPER('" || SalStrTrimX(sTabName) || "')")
.head 8 +                                If SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! Таблица есть
.head 9 -                                Set sTabName = GetUserLoginName() || '.' || sTabName
.head 9 -                                Return nFetchRes = FETCH_Ok
.head 5 -                                Return FALSE
.head 2 +                                Window Parameters 
.head 3 -                                String: strFn
.head 3 -                                String: strTabName
.head 2 +                                Window Variables 
.head 3 -                                Number: nIndex
.head 3 -                                String: strFilters[2]
.head 3 -                                String: strFile
.head 3 -                                Boolean: fOpen
.head 3 -                                String: tmp01
.head 3 -                                String: tmp02
.head 3 -                                String: tmp03
.head 3 -                                String: tmp04
.head 3 -  !
.head 3 -                                Number: hBtnDelNew
.head 3 -                                Number: hBtnNoDelNew
.head 3 -                                Number: hBtnNoDelPlusNew1
.head 3 -                                Number: hBtnNoDelPlusNew2
.head 3 -                                Number: hBtnNo
.head 3 -                                Number: hBtns[*]
.head 2 +                                Message Actions 
.head 3 +                                On SAM_Create
.head 4 -                                Call PrepareWindowEx(hWndForm)
.head 4 -                                Call SetWindowFont( hWndForm )
.head 4 -                                Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -                                Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTWndTitle') )
.head 4 -                                Call ShowApdVersion('01')
.head 4 -                                Set dfPath = strFn
.head 4 -                                Set strFilters[0] = 'Data Base Files (*.dbf)'
.head 4 -                                Set strFilters[1] = '*.dbf'
.head 4 -  ! Call SalSetWindowText(hWndForm, 'Загрузка файла ' || sFn)
.head 4 -                                Call WaitCursorOn()
.head 3 +                                On SAM_CreateComplete
.head 4 -                                Set hBtnDelNew = VisMessageLoadButton('&0.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnDelNew'), 0)
.head 4 -                                Set hBtnNoDelNew = VisMessageLoadButton('&1.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelNew'), 1)
.head 4 -                                Set hBtnNo = VisMessageLoadButton('&2.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNo'), 2)
.head 4 -                                Set hBtnNoDelPlusNew1 = VisMessageLoadButton('&3.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew1'), 3)
.head 4 -                                Set hBtnNoDelPlusNew2 = VisMessageLoadButton('&4.' || CurrentLangTable.GetAtomTitle('dlg_LoadDbf.cTBtnNoDelPlusNew2'), 4)
.head 4 -                                Call WaitCursorOff()
.head 3 +                                On SAM_Destroy
.head 4 -                                Call VisMessageFreeButton(hBtnDelNew)
.head 4 -                                Call VisMessageFreeButton(hBtnNoDelNew)
.head 4 -                                Call VisMessageFreeButton(hBtnNoDelPlusNew1)
.head 4 -                                Call VisMessageFreeButton(hBtnNoDelPlusNew2)
.head 4 -                                Call VisMessageFreeButton(hBtnNo)
.head 4 -                                Call WaitCursorOff()
.head 1 +  Dialog Box: dlg_Nazn
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Призначення платежу
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.75"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.619"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: OK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Підтвердити
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.655"
.head 5 -  Width:  2.633"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set TXT = NAZN
.head 6 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: CANCEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Відмінити
.head 4 -  Window Location and Size
.head 5 -  Left:   2.933"
.head 5 -  Top:    1.655"
.head 5 -  Width:  2.583"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 +  Multiline Field: NAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    0.036"
.head 6 -  Width:  5.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.56"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive String: TXT
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set NAZN = TXT
.head 1 +  Form Window: ImpCostMet
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Прием файлов цен металлов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? No
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   1.65"
.head 4 -  Top:    1.375"
.head 4 -  Width:  9.833"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.048"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  3.0"
.head 4 -  Height: 3.0"
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: T1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.583"
.head 6 -  Width:  9.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.726"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NameMet
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Найменування металу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VidMet
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Група цінностей
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KodMet
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код металу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Probe
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Проба
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Cost
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ціна
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Child Table: T2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    2.56"
.head 6 -  Width:  9.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: NameMet
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Найменування металу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VidMet
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Група цінностей
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KodMet
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код металу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Probe
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Проба
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Cost
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ціна
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call XSalTblSetCellBackColor(T2.Cost, COLOR_LightAqua)
.head 5 +  Column: Met
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: MET_
.head 5 -  Number: KOD_
.head 5 -  String: NAME_
.head 5 -  ! String: PROBE_
.head 5 -  Number: COST_
.head 5 -  Number: VID_
.head 5 -  Number: nProba
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(T2)
.head 6 -  ! Call SqlPrepareAndExecute(hSql(), "
     SELECT MET1,MET,GRP,trim(substr(LOM.MET_PROB(NAME,'MET'),1,50)),
            decode(MET1,27,'0',substr(LOM.MET_PROB(NAME,'PROB'),1,10)),CENA
     INTO   :KOD_,:MET_,:VID_,:NAME_,:PROBE_,:COST_
     FROM   LOM_MET 
     order  by 1,3,5")
.head 6 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT MET1,MET,GRP,nvl(nullif(trim(substr(LOM.MET_PROB(NAME,'MET'),1,50)),'0'),NAME),CENA,nvl(proba,0)
     INTO   :KOD_,:MET_,:VID_,:NAME_,:COST_,:nProba
     FROM   LOM_MET 
     order  by 3,1,6")
.head 6 -  Set nQ = 0
.head 6 +  While SqlFetchNext(hSql(), NFeechRez)
.head 7 -  Call SalTblInsertRow(T2, nQ)
.head 7 -  Set T2.Met     = MET_
.head 7 -  Set T2.KodMet  = KOD_
.head 7 -  Set T2.VidMet  = VID_
.head 7 -  Set T2.NameMet = NAME_
.head 7 -  Set T2.Probe   = nProba !! Pr(PROBE_)
.head 7 -  Set T2.Cost    = COST_
.head 7 -  Call SalTblSetRowFlags(T2, nQ, ROW_New, FALSE)
.head 7 -  Set nQ = nQ + 1
.head 3 +  Custom Control: Cal
.data CLASSPROPSSIZE
0000: 4400
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010000
0020: 0200000001010101 0101010000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCalendarDropDown
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.433"
.head 6 -  Top:    0.048"
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strBankDate = SalFmtFormatDateTime(GetBankDate(), 'dd/MM/yyyy')
.head 6 -  Call GetMonthArray(strMonth)
.head 6 -  Call GetWeekDayArray(strWeekDays)
.head 6 -  Call Cal.SetMonthText(strMonth)
.head 6 -  Call Cal.SetWeekDayText(strWeekDays)
.head 6 -  ! Инициализация дат календаря cCalendarFrom
.head 6 -  Call Cal.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Sunday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call Cal.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Monday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call Cal.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Tuesday,   SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call Cal.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Wednesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call Cal.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Thursday,  SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call Cal.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Friday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call Cal.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Saturday,  SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 6 -  Call Cal.SpecialDate(SPECIAL_OneTime, GetBankDate(), DAY_Unset,     SEQ_Unset, COLOR_Blue,  COLOR_Cyan, TRUE)
.head 6 -  Call SqlPrepareAndExecute( hSql(), T("
     SELECT fdat
     INTO   :dSelect
     FROM   fdat"))
.head 6 -  Set i = 0
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call Cal.SpecialDate(SPECIAL_OneTime, dSelect, DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
.head 7 -  Set i = i + 1
.head 6 +  If i = 0
.head 7 -  ! Call SalMessageBox('Нет доступных дат для выбора', 'Внимание', 0)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Out.cTMsgDat'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 6 -  Call SalSetWindowText(Cal,  strBankDate)
.head 6 -  Set DatStr = strBankDate
.head 5 +  On SAM_Validate
.head 6 -  Call SalGetWindowText(Cal, DatStr, 20)
.head 6 -  Call SalTblReset(T1)
.head 6 -  Set RASP = STRING_Null
.head 3 +  Pushbutton: Refresh
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledRefresh
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обновити
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.036"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalGetWindowText(Cal, DatStr, 20)
.head 6 -  Call SalTblReset(T1)
.head 6 -  Set RASP = STRING_Null
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   select RASP
   into   :RASP
   from   LOM_MET_CEN
   where  dat=to_date('" || DatStr || "','dd/MM/yyyy') and rownum=1")
.head 7 +  If SqlFetchNext(hSql(), NFeechRez)
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   SELECT VID_MET,KOD_MET,to_number(replace(PROBA,',','.')),PRICE,NAME
   INTO   :T1.VidMet,:T1.KodMet,:T1.Probe,:T1.Cost,:T1.NameMet
   FROM   LOM_MET_CEN c, lom_met1 l
   WHERE  dat=to_date('" || DatStr || "','dd/MM/yyyy') and c.KOD_MET=l.MET1")
.head 9 -  Set nQ = 0
.head 9 +  Loop
.head 10 -  Call SalTblInsertRow(T1, nQ)
.head 10 +  If SqlFetchNext(hSql(), NFeechRez)
.head 11 -  Set nQ = nQ + 1
.head 10 +  Else
.head 11 -  Break
.head 7 -  Call SalTblSetFlagsAnyRows(T1, ROW_UnusedFlag1, TRUE, ROW_New, 0)
.head 7 -  Call SalTblSetFlagsAnyRows(T1, ROW_New, FALSE, ROW_New, 0)
.head 6 -  Call SalSendMsg(T2, UM_Populate, 0, 0)
.head 3 +  Pushbutton: Exec
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вгрузити
.head 4 -  Window Location and Size
.head 5 -  Left:   1.383"
.head 5 -  Top:    0.036"
.head 5 -  Width:  1.183"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(Refresh, SAM_Click, 0, 0)
.head 6 -  Call LoadSpr(STRING_Null)
.head 3 +  Pushbutton: Save
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Зберегти
.head 4 -  Window Location and Size
.head 5 -  Left:   3.967"
.head 5 -  Top:    0.036"
.head 5 -  Width:  1.233"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\SAVE.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call FSave()
.head 6 -  Call SalSendMsg(Refresh, SAM_Click, 0, 0)
.head 3 +  Pushbutton: CalcPb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Розрахувати
.head 4 -  Window Location and Size
.head 5 -  Left:   2.65"
.head 5 -  Top:    0.036"
.head 5 -  Width:  1.233"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\FORMULA.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call Calc()
.head 3 +  Pushbutton: Exit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вихід
.head 4 -  Window Location and Size
.head 5 -  Left:   7.417"
.head 5 -  Top:    0.048"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(ImpCostMet)
.head 3 -  Background Text: Розрахункові дані для заповнення довідника цін металів
.head 4 -  Resource Id: 49361
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    2.357"
.head 5 -  Width:  5.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: RASP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.383"
.head 6 -  Top:    0.31"
.head 6 -  Width:  1.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: LoadSpr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: FileName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: nDate
.head 5 -  Number: nKod_met
.head 5 -  Number: nVid_met
.head 5 -  String: nProbaS
.head 5 -  Number: nPrice
.head 5 -  Date/Time: nmDate[*]
.head 5 -  Number: nmKod_met[*]
.head 5 -  Number: nmVid_met[*]
.head 5 -  String: nmProba[*]
.head 5 -  Number: nmPrice[*]
.head 5 -  String: sFA
.head 5 -  String: ss
.head 5 -  String: sFileSimv[*]
.head 5 -  Number: nNumFiles
.head 5 -  Number: nI
.head 5 -  Boolean: bF
.head 5 -  String: sCurDir
.head 5 -  Sql Handle: hSqlA
.head 5 -  Boolean: byn
.head 5 -  Boolean: bPovtor
.head 5 -  Number: nPri
.head 5 -  Boolean: bK
.head 5 -  String: NameMet
.head 5 -  File Handle: FH
.head 5 -  !
.head 5 -  Number: nPovtor
.head 5 -  Number: nCount
.head 4 +  Actions
.head 5 +  If SalTblAnyRows(T1, ROW_UnusedFlag1, 0)
.head 6 -  Set nPovtor = SalMessageBox('Довідник за дане число був вже завантажений раніше!
Прийняти повторно довідник?', 'Увага!', MB_YesNo)
.head 5 +  Else
.head 6 -  Set nPovtor = 0
.head 5 -  !
.head 5 -  ! Set nPovtor = IifN(SalTblAnyRows(T1, ROW_UnusedFlag1, 0) = 0, 0,
    SalMessageBox('Довідник за дане число був вже завантажений раніше!
Прийняти повторно довідник?', 'Увага!', MB_YesNo | MB_IconQuestion))
.head 5 -  !
.head 5 -  ! If not SalTblAnyRows(T1, ROW_UnusedFlag1, 0)
.head 5 +  If nPovtor = IDYES or nPovtor = 0
.head 6 +  If nPovtor = IDYES
.head 7 -  Call SalTblReset(T1)
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalArraySetUpperBound(sFileSimv, 1, -1)
.head 6 -  Call SalUseRegistry(FALSE, '')
.head 6 -  Call SalGetProfileString('common parameters', 'curratesdir', '\\BARS98\\RATES', ss, GetIniFileName())
.head 6 -  Set sFA = ss || '\\LOM_' || SalStrLeftX(DatStr, 2) || SalStrMidX(DatStr, 3, 2) || '.???'
.head 6 -  Set nNumFiles = VisDosEnumFiles(sFA, FA_Standard, sFileSimv)
.head 6 -  Call SalFileGetCurrentDirectory(sCurDir)
.head 6 +  If nNumFiles > 0
.head 7 -  Set SqlDatabase = 'dBase_Files'
.head 7 -  Call SalFileSetCurrentDirectory(ss)
.head 7 +  If SqlConnect(hSqlA)
.head 8 -  Call SqlDisconnect(hSqlA)
.head 8 -  Set nI = 0
.head 8 -  Set bK = FALSE
.head 8 -  Call SqlConnect(hSqlA)
.head 8 -  Set bF = TRUE
.head 8 -  Set bPovtor = TRUE
.head 8 -  Set byn = FALSE
.head 8 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT date,vid_met,kod_met,proba,price
     FROM   " || Right(sFileSimv[nI], 12) || "
     INTO   :nDate,:nVid_met,:nKod_met,:nProbaS,:nPrice")
.head 8 -  Set nPri = 0
.head 8 -  Set nDbf = 0
.head 8 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 9 -  Set nmDate[nDbf] = nDate
.head 9 -  Set nmVid_met[nDbf] = nVid_met
.head 9 -  Set nmKod_met[nDbf] = nKod_met
.head 9 -  Set nmProba[nDbf] = nProbaS
.head 9 -  Set nmPrice[nDbf] = nPrice
.head 9 -  Set nDbf = nDbf + 1
.head 8 -  Call SqlDisconnect(hSqlA)
.head 8 -  Set nQ = 0
.head 8 +  If SalFmtFormatDateTime(nmDate[0], 'dd/MM/yyyy') != DatStr
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  ! Call MessageNoWait('Несоответствие дат в заголовке и имени файла', 'ВНИМАНИЕ !', 0, 1)
.head 9 -  Call MessageNoWait('Невідповідність дат в заголовку та найменуванні файлу', 'УВАГА !', 0, 1)
.head 9 -  Return FALSE
.head 8 +  While nQ < nDbf
.head 9 +  If nQ > 0
.head 10 -  Call SalTblInsertRow(T1, nQ)
.head 10 -  Set T1.VidMet = nmVid_met[nQ]
.head 10 -  Set T1.KodMet = nmKod_met[nQ]
.head 10 -  Set T1.Probe = Val(nmProba[nQ]) !! nmProba[nQ]
.head 10 -  Set T1.Cost = nmPrice[nQ]
.head 10 +  If SqlPrepareAndExecute(hSql(), '
   select name
   into   :NameMet
   from   lom_met1
   where  met1=:nmKod_met[nQ]')
.head 11 +  If SqlFetchNext(hSql(), nFetchRes)
.head 12 -  Set T1.NameMet = NameMet
.head 9 +  If nQ = 0
.head 10 -  Set RASP = nmProba[nQ]
.head 9 -  Set nQ = nQ + 1
.head 8 -  Set nQ = 1
.head 8 +  While nQ < nDbf
.head 9 +  If nPovtor = IDYES
.head 10 +  If SqlPrepareAndExecute(hSql(), '
   UPDATE LOM_MET_CEN
   SET    price=:nmPrice[nQ], rasp=:nmProba[0]
   where  DAT=:nmDate[0] and vid_met=:nmVid_met[nQ] and kod_met=:nmKod_met[nQ] and proba=:nmProba[nQ]')
.head 11 +  If not SqlGetModifiedRows(hSql(), nCount)
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalMessageBox('Не вдалося виконати запис в БД (вставка в довідник цін металів, таблиця LOM_MET_CEN).',
     'Помилка (3) !', MB_Ok | MB_IconStop)
.head 12 -  Return FALSE
.head 10 +  Else
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Call SalMessageBox('Не вдалося виконати запис в БД (вставка в довідник цін металів, таблиця LOM_MET_CEN).',
     'Помилка (1) !', MB_Ok | MB_IconStop)
.head 11 -  Return FALSE
.head 9 +  Else
.head 10 -  Set nCount = 0
.head 9 +  If nCount = 0
.head 10 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   into   LOM_MET_CEN (DAT,vid_met,kod_met,proba,PRICE,RASP)
               values (:nmDate[0],:nmVid_met[nQ],:nmKod_met[nQ],:nmProba[nQ],:nmPrice[nQ],:nmProba[0])')
.head 11 -  Call SqlRollback(hSql())
.head 11 -  ! Call SalMessageBox('Не удалось произвести запись в БД', 'Ошибка!', MB_Ok)
.head 11 -  Call SalMessageBox('Не вдалося виконати запис в БД (вставка в довідник цін металів, таблиця LOM_MET_CEN).',
     'Помилка (2) !', MB_Ok | MB_IconStop)
.head 11 -  Return FALSE
.head 9 -  Set nQ = nQ + 1
.head 8 -  ! Call SalStatusSetText(hWndForm, 'Цены металлов вычитаны')
.head 8 -  Call SalStatusSetText(hWndForm, 'Ціни металів вичитані...')
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SalTblSetFlagsAnyRows(T1, ROW_UnusedFlag1, TRUE, ROW_New, 0)
.head 8 -  Call SalTblSetFlagsAnyRows(T1, ROW_New, FALSE, ROW_New, 0)
.head 8 -  Call SalFileOpen(FH, Right(sFileSimv[0], 12), OF_Delete)
.head 8 -  ! Call SaveInfoToLog('Загружен справочник цен металлов за ' || DatStr)
.head 8 -  Call SaveInfoToLog('Завантажений довідник цін металів за ' || DatStr)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 +  If nPovtor = IDYES
.head 9 -  Call SalMessageBox('Необхідно "Розрахувати" та "Зберегти" ціни для усіх проб, які занесені в довідник металів!',
     'Увага!', MB_Ok | MB_IconAsterisk)
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  ! Call MessageNoWait('Невозможно принять файл цен LOM_' || SalStrLeftX(DatStr, 2) || SalStrMidX(DatStr, 3, 2) ||
     '.??? (ошибка ODBC).', 'ВНИМАНИЕ !', 0, 1)
.head 8 -  Call MessageNoWait('Неможливо прийняти файл цін LOM_' || SalStrLeftX(DatStr, 2) || SalStrMidX(DatStr, 3, 2) ||
     '.??? (помилка ODBC).', 'УВАГА !', 0, 1)
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  ! Call MessageNoWait('Файл цен металлов не найден!', 'ВНИМАНИЕ !', 0, 1)
.head 7 -  Call MessageNoWait('Файл цін металів не знайдений!', 'УВАГА !', 0, 1)
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  ! Call SalMessageBox('Справочник за данное число был загружен ранее!', 'Внимание!', MB_Ok)
.head 6 -  Call SalMessageBox('Довідник за дане число був вже завантажений раніше!', 'Увага!', MB_Ok)
.head 6 -  Return FALSE
.head 3 +  Function: Calc
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: T1MinRow
.head 5 -  Number: T1MaxRow
.head 5 -  Number: N
.head 5 -  ! String: Probe_
.head 5 -  Number: nProba
.head 5 -  Number: KodMet_
.head 5 -  Number: VidMet_
.head 5 -  Number: Cost_
.head 5 -  Sql Handle: SqlH
.head 5 -  String: StrSql
.head 4 +  Actions
.head 5 -  Set N = TBL_MinRow
.head 5 +  While SalTblFindNextRow(T1, N, 0, 0)
.head 6 -  Call SalTblSetContext(T1, N)
.head 6 -  ! Set Probe_  = T1.Probe
.head 6 -  Set nProba  = T1.Probe
.head 6 -  Set VidMet_ = T1.VidMet !! same as T1.Grp
.head 6 -  Set KodMet_ = T1.KodMet
.head 6 -  Set Cost_   = T1.Cost
.head 6 -  ! Call T2Update(VidMet_, KodMet_, Probe_, Cost_)
.head 6 -  Call T2Update(VidMet_, KodMet_, nProba, Cost_)
.head 3 +  Function: T2Update
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: Vid
.head 5 -  Number: Kod
.head 5 -  ! String: Prb
.head 5 -  Number: Proba
.head 5 -  Number: Cst
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: T2MinRow
.head 5 -  Number: T2MaxRow
.head 5 -  Number: N
.head 5 -  Number: NContext
.head 4 +  Actions
.head 5 -  Set NContext = SalTblQueryContext(T2)
.head 5 -  Set N = TBL_MinRow
.head 5 +  While SalTblFindNextRow(T2, N, 0, 0)
.head 6 -  Call SalTblSetContext(T2, N)
.head 6 +  ! If Val(Pr(T2.Probe)) = Val(Pr(Prb)) and T2.KodMet = Kod and T2.VidMet = Vid
.head 7 -  Set T2.Cost = Cst
.head 7 -  Call XSalTblSetCellBackColor(T2.Cost, COLOR_LightAqua)
.head 7 -  Call SalTblSetRowFlags(T2, N, ROW_Edited, TRUE)
.head 6 +  ! Else If Pr(Prb) = '1000' and T2.KodMet = Kod and T2.VidMet = Vid
.head 7 -  Set T2.Cost = Cst * SalStrToNumber(T2.Probe) / 1000
.head 7 -  Call XSalTblSetCellBackColor(T2.Cost, COLOR_LightAqua)
.head 7 -  Call SalTblSetRowFlags(T2, N, ROW_Edited, TRUE)
.head 6 -  ! Else If T2.Probe = 999 and T2.KodMet = Kod and T2.VidMet = 5 and Proba = 1000 and Vid = 1
.head 6 +  If T2.VidMet = 3 and T2.KodMet = Kod and T2.VidMet = Vid
.head 7 -  Set T2.Cost = Cst
.head 7 -  Call XSalTblSetCellBackColor(T2.Cost, COLOR_LightAqua)
.head 7 -  Call SalTblSetRowFlags(T2, N, ROW_Edited, TRUE)
.head 6 +  Else If T2.KodMet = Kod and T2.VidMet = 5 and Proba = 1000 and Vid = 1
.head 7 -  Set T2.Cost = Cst * T2.Probe / 1000
.head 7 -  Call XSalTblSetCellBackColor(T2.Cost, COLOR_LightAqua)
.head 7 -  Call SalTblSetRowFlags(T2, N, ROW_Edited, TRUE)
.head 6 +  Else If T2.Probe = Proba and T2.KodMet = Kod and T2.VidMet = Vid and T2.VidMet != 3
.head 7 -  Set T2.Cost = Cst
.head 7 -  Call XSalTblSetCellBackColor(T2.Cost, COLOR_LightAqua)
.head 7 -  Call SalTblSetRowFlags(T2, N, ROW_Edited, TRUE)
.head 6 +  Else If Proba = 1000 and T2.KodMet = Kod and T2.VidMet = Vid and T2.Probe != 900750 and T2.VidMet != 3
.head 7 -  Set T2.Cost = Cst * T2.Probe / 1000
.head 7 -  Call XSalTblSetCellBackColor(T2.Cost, COLOR_LightAqua)
.head 7 -  Call SalTblSetRowFlags(T2, N, ROW_Edited, TRUE)
.head 5 -  Call SalTblSetContext(T2, NContext)
.head 3 +  ! Function: Pr
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  ! Pr
.head 5 -  String: P 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: P_
.head 4 +  Actions 
.head 5 -  Set P_ = P
.head 5 +  While SalStrScan(P_, ' ') >= 0
.head 6 -  Set P_ = SalStrReplaceX(P_, SalStrScan(P_, ' '), 1, STRING_Null)
.head 5 +  While SalStrScan(P_, '/') >= 0
.head 6 -  Set P_ = SalStrReplaceX(P_, SalStrScan(P_, '/'), 1, STRING_Null)
.head 5 -  Return P_
.head 3 +  Function: FSave
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: N
.head 4 +  Actions
.head 5 -  Set N = TBL_MinRow
.head 5 +  While SalTblFindNextRow(T2, N, ROW_Edited, 0)
.head 6 -  Call SalTblSetContext(T2, N)
.head 6 +  If not SqlPrepareAndExecute(hSql(), '
   update LOM_MET
   set    CENA=:T2.Cost
   where  MET1=:T2.KodMet and grp=:T2.VidMet and nvl(proba,0)=:T2.Probe')
.head 7 -  Call SqlRollback(hSql())
.head 7 -  ! Call SalMessageBox('Ошибка при попытке записи в базу данных', 'Внимание!', MB_Ok)
.head 7 -  Call SalMessageBox('Помилка при спробі запису в БД (довідник маталів, таблиця LOM_MET)', 'Увага!', MB_Ok)
.head 6 +  ! If T2.KodMet = 27 and T2.VidMet = 1
.head 7 +  If not SqlPrepareAndExecute(hSql(), '
   update LOM_MET
   set    CENA=:T2.Cost
   where  MET1=27 and grp=1')
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalMessageBox('Ошибка при попытке записи в базу данных', 'Внимание!', MB_Ok)
.head 6 +  ! Else If T2.KodMet = 1 and T2.VidMet = 1 and T2.Probe = 900750 !! T2.Probe = '900750'
.head 7 +  If not SqlPrepareAndExecute(hSql(), '
   update LOM_MET
   set    CENA=:T2.Cost
   where  MET1=1 and grp=1 and PROBA=900750')
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalMessageBox('Ошибка при попытке записи в базу данных', 'Внимание!', MB_Ok)
.head 6 +  ! Else If T2.VidMet = 2 or T2.VidMet = 5
.head 7 +  If not SqlPrepareAndExecute(hSql(), '
   update LOM_MET
   set    CENA=:T2.Cost
   where  grp=:T2.VidMet and MET1=:T2.KodMet')
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalMessageBox('Ошибка при попытке записи в базу данных', 'Внимание!', MB_Ok)
.head 6 +  ! Else
.head 7 -  ! Call Debug('N=' || Str(N) || '
T2.Cost=' || Str(T2.Cost) || '
T2.KodMet=' || Str(T2.KodMet) || '
T2.VidMet=' || Str(T2.VidMet) || '
T2.Probe=' || T2.Probe)
.head 7 -  ! If not SqlPrepareAndExecute(hSql(), "
   update LOM_MET
   set    CENA=:T2.Cost
   where  MET1=:T2.KodMet and grp=:T2.VidMet and to_char(MET)=to_char(:T2.KodMet)||:T2.Probe")
.head 7 +  If not SqlPrepareAndExecute(hSql(), "
   update LOM_MET
   set    CENA=:T2.Cost
   where  MET1=:T2.KodMet and grp=:T2.VidMet and proba=:T2.Probe")
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalMessageBox('Ошибка при попытке записи в базу данных', 'Внимание!', MB_Ok)
.head 6 -  Call SqlCommit(hSql())
.head 6 -  ! Call SaveInfoToLog('Изменены текущие цены покупки драг. металлов')
.head 6 -  Call SaveInfoToLog('Змінені поточні ціни покупки дорогоцінних металів...')
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  String: strMonth[12]    !! Наименов. месяце для календаря
.head 3 -  String: strWeekDays[7]  !! Дни недели для календаря
.head 3 -  Number: i
.head 3 -  Date/Time: dSelect
.head 3 -  Number: nDay
.head 3 -  Number: nMonth
.head 3 -  Number: nYear
.head 3 -  String: strDateFrom     !! Дата (DD-MM-YYYY)
.head 3 -  String: strBankDate
.head 3 -  String: DatStr
.head 3 -  Number: nQ
.head 3 -  Number: nDbf
.head 3 -  Number: NFeechRez
.head 3 -  Number: NTmp
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 +  If GetValueStr("
   select
   nvl(substr(sys_context('bars_context','user_branch'),1,30),'/')
   from dual") != '/'
.head 5 -  Call SalDisableWindow(Exec)
.head 4 -  Call SalSendMsg(T2, UM_Populate, 0, 0)
.head 1 +  Table Window: rb_debet
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Стан учасників дебету
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  16.433"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.5"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 26239
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 26240
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 26241
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: fdat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата періоду
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy hhhh:mm:ss
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: idc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № РЦ
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: idu
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № Уч.
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва участника
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  3.133"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума дб.
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.033"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: mfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва банку
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.433"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ksplan
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кор.Рах 
плановий
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ksreal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кор.Рах
фактичний
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: rfplan
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: РФ
плановий
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: rfreal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: РФ
фактичний
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: delta
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума 
погашення
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: otm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Відм.
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 -  On QOM_Create
.head 1 +  Dialog Box: rb_choose_step
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Увага!
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  4.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.286"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Radio Button: rbNotUseRF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Виконати без використання РФ
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.405"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbUseRF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Виконати з використанням  РФ
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.655"
.head 5 -  Width:  3.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Припинити НЕТТО-кредит
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.905"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 26242
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.0"
.head 5 -  Top:    1.321"
.head 5 -  Width:  4.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 26243
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.0"
.head 5 -  Top:    0.012"
.head 5 -  Width:  4.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОК
.head 4 -  Window Location and Size
.head 5 -  Left:   1.583"
.head 5 -  Top:    1.405"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If rbNotUseRF
.head 7 -  Set nChoose = RB_NOTUSE_RF
.head 6 +  If rbUseRF
.head 7 -  Set nChoose = RB_USE_RF
.head 6 +  If rbCancel
.head 7 -  Set nChoose = RB_CANCEL_NETTO_KR
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 -  Background Text: Існують учасники, що мають від'ємний кор.рах.
.head 4 -  Resource Id: 26244
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Number: nChoose ! = 1 - без РФ, =2 - С РФ, =3 - прекратить выполннеия
.head 2 +  Window Variables
.head 3 -  Number: nIsUseRF  ! использовать ли резервный фонд
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set nIsUseRF = GetGlobalOptionEx('RBUSERF')
.head 4 +  If nIsUseRF=0
.head 5 -  Call SalDisableWindow(rbUseRF)
.head 1 +  Table Window: rbDbDoc
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Документи нетто-дебету
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  16.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.929"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.44"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 20289
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.183"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  5.183"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 20290
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.483"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  4.483"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.617"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNextStep
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.07"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Arr2tor.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Наступний крок...')
.head 4 -  Line
.head 5 -  Resource Id: 20291
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 20292
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.867"
.head 6 -  Begin Y:  -0.071"
.head 6 -  End X:  3.867"
.head 6 -  End Y:  0.393"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 2 +  Contents
.head 3 +  Column: ref
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф. док.
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: mfoa
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО А
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nlsa
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рах. А
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nama
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва А
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: mfob
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО Б
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.25"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nlsb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок Б
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: namb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва Б
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: tt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Опреація
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДК
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: fn_a
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Файл СЕП
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Стан
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.983"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sos_desc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Стан док-ту
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.85"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sosall
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Date/Time: dtClearingDate
.head 2 +  Window Variables
.head 3 -  Number: nDocsResult
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! предполагаем, что документ считается оплаченным, когда его состояение, rbDbDoc.sos = 7
.head 4 -  ! Для межбанка arc_rrp.sos = 7 - это сквитованный файл $A. Искусственно для внутренних перекодируем  значение 5 в 7
.head 4 -  Set strSqlPopulate =
"select ref, 
        mfoa, nlsa, nam_a, 
        mfob, nlsb, nam_b, 
        s, tt, dk, fn_a,  
        decode(mfoa, mfob, decode(o.sos, 5, 7, o.sos), a.sos),
        decode(mfoa, mfob, decode(o.sos, 1, 'Не завізовано', 'Сплачено'),
                           decode(nvl(a.sos,0)), 0, 'Не сформовано файл', 7, 'Сплачено', 'Не сквитовано' )
               ),
   into :rbKrDoc.ref,
        :rbKrDoc.mfoa, :rbKrDoc.nlsa, :rbKrDoc.nam_a, 
        :rbKrDoc.mfob, :rbKrDoc.nlsb, :rbKrDoc.nam_b, 
        :rbKrDoc.s,    :rbKrDoc.tt,   :rbKrDoc.dk,   :rbKrDoc.fn_a,
        :rbKrDoc.sos,  :rbKrDoc.sos_desc
   from oper o, arc_rrp a, rb_net n 
  where n.fdat = :dtClearingDate 
    and n.ref = o.ref
    and o.ref = a.ref(+)
    and s > 0 
  order by o.ref"
.head 4 -  Call SalSendClassMessage(UM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  ! Отследить, что все документы имеют статус оплаченного.
.head 4 -  !
.head 4 -  ! Если не было сторно документа
.head 1 +  Table Window: rbKS
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Стан коррахунків
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.917"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.905"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.44"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  If SqlPrepareAndExecute(hSql(), "select val into :dfLastUpdate from params where par = 'RBNL$' ") AND 
SqlFetchNext(hSql(), nRow)
.head 7 -  Call SalSendClassMessage(SAM_Click,wParam,lParam)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 20296
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  ! On SAM_Click
.head 7 -  Set nReportCode = REPORT_RB_KS
.head 7 -  Set sBind='R_MFO,R_NB,R_KS,R_FORWKS,R_BADKS'
.head 7 -  Set sOutFileName=GetPrnDir()||'\\rb_ks.txt'
.head 7 -  Set sTemplateFileName = 'nbu_rbks.qrp'
.head 7 -  !
.head 7 -  Call SalWaitCursor( TRUE )
.head 7 -  Call SalStatusSetText ( hWndForm, sOutFileName )
.head 7 -  Set nErrCode=0
.head 7 -  Call SalReportPrintToFile( hWndForm,
     GetTemplateDir() || '\\' || sTemplateFileName,
     sOutFileName, sBind, sBind, 1, RPT_PrintAll, 1, 1, FALSE, nErrCode )
.head 7 +  If nErrCode > 4
.head 8 -  Call SalMessageBox( 'Ошибка '||SalNumberToStrX( nErrCode, 0 )||' при формировании отчета', 'Внимание', MB_IconExclamation )
.head 7 -  Call SalWaitCursor( FALSE)
.head 7 -  Call SalStatusSetText ( hWndForm, 'Готово' )
.head 6 +  On SAM_Click
.head 7 -  Set nReportCode = REPORT_RB_KS
.head 7 -  Set sBind='R_MFO,R_NB,R_KS,R_FORWKS,R_BADKS'
.head 7 -  Set sOutFileName=GetPrnDir()||'\\rb_ks.txt'
.head 7 -  Set sTemplateFileName = 'nbu_rbks.qrp'
.head 7 -  !
.head 7 -  Call SalWaitCursor( TRUE )
.head 7 -  Call SalStatusSetText ( hWndForm, sOutFileName )
.head 7 -  Set nErrCode=0
.head 7 -  Call SalReportPrintToFile( hWndForm,
     GetTemplateDir() || '\\' || sTemplateFileName,
     sOutFileName, sBind, sBind, 1, RPT_PrintAll, 1, 1, FALSE, nErrCode )
.head 7 +  If nErrCode > 4
.head 8 -  Call SalMessageBox( 'Ошибка '||SalNumberToStrX( nErrCode, 0 )||' при формировании отчета', 'Внимание', MB_IconExclamation )
.head 7 +  Else
.head 8 -  Call SalMessageBox( 'Виконано! Дані звіту у файлі '||sOutFileName, 'Внимание', MB_IconExclamation )
.head 7 -  Call SalWaitCursor( FALSE)
.head 7 -  Call SalStatusSetText ( hWndForm, 'Готово' )
.head 4 -  Line
.head 5 -  Resource Id: 20297
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 20298
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text: Станом на:
.head 5 -  Resource Id: 20299
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfLastUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.983"
.head 7 -  Top:    0.071"
.head 7 -  Width:  2.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: mfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва банку
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  3.317"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ks
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Значення технічного
корр. рахунку
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.583"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ksbad
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Найгірше прогнозоване 
значення корр.рах.
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.517"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ks_plan
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Прогнозоване значення
корр. рахунку
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.4"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  String: sReportSQL
.head 3 -  Number: nFetchRes
.head 3 -  Number: nReportCode
.head 3 -  !
.head 3 -  ! Переменные для отчета
.head 3 -  String: r_ksfile_date  ! дата последнего файла коррсчетов для задачи РБ
.head 3 -  String: R_MFO          ! мфо банка-участника
.head 3 -  String: R_NB           ! наименование банка-участника
.head 3 -  Number: R_KS           ! Поточний стан коррахунку
.head 3 -  Number: R_FORWKS       ! Прогнозоване значення коррахунку
.head 3 -  Number: R_BADKS        ! Найгірше прогнозоване значення коррахунку 
.head 3 -  String: sTemplateFileName
.head 3 -  String: sOutFileName
.head 3 -  String: sBind
.head 3 -  Number: nErrCode
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! Set fFilterAtStart  = TRUE
.head 4 -  Set strFilterTblName = 'BANKS'
.head 4 -  Set strPrintFileName = 'BANKS'
.head 4 -  Set rbKS.nTabInstance = 1
.head 4 -  !
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalDisableWindow(pbUpdate)
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 -  !
.head 4 -  Set strSqlPopulate =
"select b.mfo, nb, ks, forwks,badks
   into :rbKS.mfo, :rbKS.nb, :rbKS.ks_plan, :rbKS.ks, :rbKS.ksbad
   from banks b, rb_ks k
  where b.mfo = k.mfo
  order by b.mfo"
.head 4 -  Call SalSendClassMessage(UM_Create, 0, 0)
.head 4 -  If SqlPrepareAndExecute(hSql(), "select val into :dfLastUpdate from params where par = 'RBNL$' ") AND 
SqlFetchNext(hSql(), nRow)
.head 3 +  On SAM_ReportStart
.head 4 -  ! ! Список коррсчетов для задачи рачсчетного банка
.head 4 -  If SqlPrepareAndExecute(hSql(), "select val into :r_ksfile_date from params where par = 'RBNL$'") and 
   SqlFetchNext(hSql(), nFetchRes)
.head 4 +  If nReportCode = REPORT_RB_KS
.head 5 -  Set sReportSQL =
  "select b.mfo,     nb, ks/100 ks,badks/100 badks, forwks/100 forwks
     into :R_MFO, :R_NB, :R_KS,    :R_BADKS, :R_FORWKS
     from rb_ks r, banks b
    where r.mfo = b.mfo
    order by b.mfo"
.head 4 -  Call SqlPrepare( hSql(),sReportSQL )
.head 4 -  Call SalReportSetStringVar(SalNumberToWindowHandle( wParam ),'KSFILEDATE',  r_ksfile_date)
.head 4 -  Call SalReportSetStringVar(SalNumberToWindowHandle( wParam ),'OUR_BANK_NAME', GetBankName() )
.head 3 +  On SAM_ReportFetchInit
.head 4 -  Return SqlExecute( hSql() )
.head 3 +  On SAM_ReportFetchNext
.head 4 +  If SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Return TRUE
.head 1 +  Dialog Box: dlgFormSkupka
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Формирование файла Skupka (dbf)
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.425"
.head 4 -  Top:    0.99"
.head 4 -  Width:  8.15"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.393"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Формирование файла Skupka (dbf)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Multiline Field: mlText
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1024
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? No
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   3.083"
.head 6 -  Top:    1.0"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.988"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbRun
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.483"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F5
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalMessageBox('Выполнять формирование файла SKUPKA за ' || SalFmtFormatDateTime(dYes, 'dd/MM/yyyy') || ' ?',
   'ВНИМАНИЕ !!!', MB_YesNo | MB_IconQuestion) = IDNO
.head 7 -  Return 0
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set mlText = 'Формирование файла Skupka'
.head 6 -  Call SalFileGetCurrentDirectory(sOdir)
.head 6 -  Call SalFileSetCurrentDirectory(Left(sDbfPath, Len(sDbfPath)-1))
.head 6 -  !
.head 6 -  ! If SqlPrepareAndExecute(hSql(), "
   SELECT nvl(max(w.l_skupk)+1,1)
   INTO   :nSkupk
   FROM   lom_w w, oper o
   WHERE  o.vdat=:dYes and o.sos=5 and o.tt='LO3' and w.ref=o.ref and w.grp='4' and nvl(w.l_skupk,0)>0") and
   SqlFetchNext(hSql(), nFetchRes)
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT nvl(max(w.l_skupk)+1,1)
   INTO   :nSkupk
   FROM   lom_w w, oper o
   WHERE  o.vdat=:dYes and o.sos=5 and o.tt in ('LO3','LOA') and w.ref=o.ref and w.grp='4' and
          nvl(w.l_skupk,0)>0") and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  Else
.head 7 -  Set nSkupk = 1
.head 6 -  !
.head 6 -  Set sFile1 = 'SKUPKA.' || Right(Str(1000+nSkupk), 3)
.head 6 -  Set sFile1temp = 'SKUPKA.DBF'
.head 6 -  Call VisFileDelete(sDbfPath || sFile1temp)
.head 6 -  Set sFile = sDbfPath || sFile1
.head 6 -  ! удалить файл
.head 6 -  Set bNoFile = TRUE
.head 6 +  If File(sFile)
.head 7 -  Set nI = 0
.head 7 +  While not SalFileOpen(hF, sFile, OF_Delete)
.head 8 -  Set nI = nI + 1
.head 8 +  If nI > 96
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call MessageNoWait('Невозможно сформировать файл ' || sFile || ', возможно он занят другим приложением. Выход.',
     'ВНИМАНИЕ !!!', 0, 1)
.head 9 -  Set mlText = ''
.head 9 -  Set bNoFile = FALSE
.head 9 -  Break
.head 6 -  ! создать файл
.head 6 +  If not bNoFile ! остался файл
.head 7 -  Call SalSendMsg(pbExit, SAM_Click, 0, 0)
.head 6 -  Set SqlDatabase = 'dBase_Files'
.head 6 +  If SqlConnect(hSqlA)
.head 7 -  Call SqlPrepareAndExecute(hSqlA, "
     CREATE
     TABLE " || sFile1temp || " (NM      NUMBER(2),
                                 NP      NUMBER(3),
                                 DK      NUMBER(1),
                                 REF     NUMBER(9),
                                 TP      CHAR(2),
                                 MFO     NUMBER(9),
                                 ND      CHAR(10),
                                 VOB     NUMBER(3),
                                 NLS     CHAR(14),
                                 NLSK    CHAR(14),
                                 SK      NUMBER(2),
                                 S       NUMBER(16),
                                 VDATE   DATE,
                                 VTIME   NUMBER(6),
                                 DA      DATE,
                                 PFA     NUMBER(1),
                                 NA      NUMBER(5),
                                 SPO     CHAR(3),
                                 NS      NUMBER(5),
                                 PZO     NUMBER(1),
                                 KW      NUMBER(1),
                                 SR      NUMBER(5),
                                 BLK     NUMBER(1),
                                 KISP    CHAR(6),
                                 SIGN    CHAR(88),
                                 POND    CHAR(8),
                                 KOD     CHAR(14),
                                 KODB    CHAR(14),
                                 DATD    DATE,
                                 PLAT    CHAR(38),
                                 POLU    CHAR(38),
                                 NAZ1    CHAR(160),
                                 VSPO    CHAR(80),
                                 NLS1    CHAR(14),
                                 TT      NUMBER(2),
                                 PTIME   NUMBER(4),
                                 WTIME   NUMBER(4),
                                 KTIME   NUMBER(4),
                                 TV      CHAR(2),
                                 TK      CHAR(2),
                                 R3      NUMBER(1),
                                 NDR3    CHAR(12),
                                 SOS     NUMBER(2),
                                 REF99BM NUMBER(16))")
.head 7 -  !
.head 7 -  ! Set sSql = "
    SELECT rownum,l_edn,s,l_monid,ref,vdat,fio,okpo,citiz,pasp,bday,adres,atrt
    INTO   :nNM,:nNP,:nS,:sMON_ID,:nREF,:dVDAT,:sFIO,:sOKPO,:sCITIZ,:sPASP,:sBDAY,:sADRES,:sATRT
    FROM   (select w.l_edn,o.s,w.l_monid,o.ref,o.vdat,w.fio,w.okpo,w.citiz,w.pasp,w.bday,w.adres,w.atrt
            from   oper o, lom_w w
            where  o.sos=5 and w.ref=o.ref and o.tt='LO3' and w.grp='4' and o.vdat=:dYes and nvl(w.l_skupk,0)=0
            order by o.vdat)"
.head 7 -  ! Set sSql = "
    SELECT rownum,l_edn,s,l_monid,ref,vdat,fio,okpo,citiz,pasp,bday,adres,atrt,l_met,id
    INTO   :nNM,:nNP,:nS,:sMON_ID,:nREF,:dVDAT,:sFIO,:sOKPO,:sCITIZ,:sPASP,:sBDAY,:sADRES,:sATRT,:sMET,:nID
    FROM   (select w.l_edn,o.s,w.l_monid,o.ref,o.vdat,w.fio,w.okpo,w.citiz,w.pasp,w.bday,w.adres,w.atrt,
                   lom.met_prob(w.l_met,'MET') l_met,i.id
            from   oper o, lom_w w, (select rownum id,l_met
                                     from   (select distinct lom.met_prob(w.l_met,'MET') l_met
                                             from   oper o, lom_w w
                                             where  o.sos=5 and w.ref=o.ref and o.tt='LO3' and w.grp='4' and
                                                    o.vdat=:dYes)) i
            where  w.l_met=i.l_met and o.sos=5 and w.ref=o.ref and o.tt='LO3' and w.grp='4' and o.vdat=:dYes and
                   nvl(w.l_skupk,0)=0
            order by o.vdat)" !! и nID надо засунуть в nREF
.head 7 -  ! Set sSql = "
    SELECT rownum,l_edn,s,l_monid,ref,vdat,fio,okpo,citiz,pasp,bday,adres,atrt,id
    INTO   :nNM,:nNP,:nS,:sMON_ID,:nREF,:dVDAT,:sFIO,:sOKPO,:sCITIZ,:sPASP,:sBDAY,:sADRES,:sATRT,:nID
    FROM   (select w.l_edn,o.s,w.l_monid,o.ref,o.vdat,w.fio,w.okpo,w.citiz,w.pasp,w.bday,w.adres,w.atrt,
                   lom.met_prob(w.l_met,'MET') l_met,i.id
            from   oper o, lom_w w, (select rownum id,l_met
                                     from   (select distinct lom.met_prob(w.l_met,'MET') l_met
                                             from   oper o, lom_w w
                                             where  o.sos=5 and w.ref=o.ref and o.tt='LO3' and w.grp='4' and
                                                    o.vdat=:dYes)) i
            where  lom.met_prob(w.l_met,'MET')=i.l_met and o.sos=5 and w.ref=o.ref and o.tt='LO3' and w.grp='4' and
                   o.vdat=:dYes
            order by o.vdat)" !! и nID надо засунуть в nREF
.head 7 -  ! Set sSql = "
    SELECT rownum,l_edn,s2,l_monid,ref,vdat,fio,okpo,citiz,pasp,bday,adres,atrt,id
    INTO   :nNM,:nNP,:nS,:sMON_ID,:nREF,:dVDAT,:sFIO,:sOKPO,:sCITIZ,:sPASP,:sBDAY,:sADRES,:sATRT,:nID
    FROM   (select w.l_edn,o.s2,w.l_monid,o.ref,o.vdat,w.fio,w.okpo,w.citiz,w.pasp,w.bday,w.adres,w.atrt,
                   lom.met_prob(w.l_met,'MET') l_met,i.id
            from   oper o, lom_w w, (select rownum id,l_met
                                     from   (select distinct lom.met_prob(w.l_met,'MET') l_met
                                             from   oper o, lom_w w
                                             where  o.sos=5 and w.ref=o.ref and o.tt='LO3' and w.grp='4' and
                                                    o.vdat=:dYes)) i
            where  lom.met_prob(w.l_met,'MET')=i.l_met and o.sos=5 and w.ref=o.ref and o.tt='LO3' and w.grp='4' and
                   o.vdat=:dYes
            order by o.vdat)" !! и nID надо засунуть в nREF
.head 7 -  Set sSql = "
    SELECT rownum,l_edn,s2,l_monid,ref,vdat,fio,okpo,citiz,pasp,bday,adres,atrt,id
    INTO   :nNM,:nNP,:nS,:sMON_ID,:nREF,:dVDAT,:sFIO,:sOKPO,:sCITIZ,:sPASP,:sBDAY,:sADRES,:sATRT,:nID
    FROM   (select w.l_edn,o.s2,w.l_monid,o.ref,o.vdat,w.fio,w.okpo,w.citiz,w.pasp,w.bday,w.adres,w.atrt,
                   lom.met_prob(w.l_met,'MET') l_met,i.id
            from   oper o, lom_w w, (select rownum id,l_met
                                     from   (select distinct lom.met_prob(w.l_met,'MET') l_met
                                             from   oper o, lom_w w
                                             where  o.sos=5 and w.ref=o.ref and o.tt in ('LO3','LOA') and
                                                    w.grp='4' and o.vdat=:dYes)) i
            where  lom.met_prob(w.l_met,'MET')=i.l_met and o.sos=5 and w.ref=o.ref and o.tt in ('LO3','LOA') and
                   w.grp='4' and o.vdat=:dYes
            order by o.vdat)" !! и nID надо засунуть в nREF
.head 7 -  Set bFL = SqlPrepareAndExecute(hSql(), sSql)
.head 7 +  If bFL
.head 8 -  Set bFL = FALSE
.head 8 -  Set bEct = FALSE
.head 8 -  Set nN = 0
.head 8 +  While SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If not bEct
.head 10 -  ! Set dDATD = DATETIME_Null
.head 10 -  ! Set dVDATE = DATETIME_Null
.head 10 -  ! Set bFL = SqlPrepareAndExecute(hSqlA, "
    INSERT
    INTO   " || sFile1temp || "
    VALUES (0,0,0,0,'',0,'',0,'','',0,0,:dVDATE,0,:dVDAT,0,0,'',0,0,0,0,0,0,'','','','','',:dDATD,'','','','',
            '',0,0,0,0,'','',0,'',0)")
.head 10 -  Set bFL = SqlPrepareAndExecute(hSqlA, "
    INSERT
    INTO " || sFile1temp || " (DA)
    VALUES (:dVDAT)")
.head 10 -  Set bEct = TRUE
.head 9 -  Set dVDATE = SalStrToDate(sBDAY)
.head 9 -  Set dDATD = SalStrToDate(Right(sATRT, 10))
.head 9 -  Set sSIGN = ''
.head 9 -  ! Set bFL = SqlPrepareAndExecute(hSqlA, "
    INSERT
    INTO   " || sFile1temp || "
    VALUES (:nNM,:nNP,0,:nREF,'',0,'',0,'','',0,:nS,:dVDATE,0,:dVDAT,0,0,:sMON_ID,0,0,0,0,0,0,'',:sSIGN,'',
            :sOKPO,'',:dDATD,:sPASP,:sCITIZ,:sADRES,:sFIO,'',0,0,0,0,'','',0,'',0)")
.head 9 -  Set sMON_ID = StrWinToDosX(sMON_ID)
.head 9 -  Set sOKPO   = StrWinToDosX(sOKPO)
.head 9 -  Set sPASP   = StrWinToDosX(sPASP)
.head 9 -  Set sCITIZ  = StrWinToDosX(sCITIZ)
.head 9 -  Set sADRES  = StrWinToDosX(sADRES)
.head 9 -  Set sFIO    = StrWinToDosX(sFIO)
.head 9 -  Set nREF    = nID
.head 9 -  !
.head 9 -  Set bFL = SqlPrepareAndExecute(hSqlA, "
    INSERT
    INTO   " || sFile1temp || " (NM,NP,REF,S,VDATE,DA,SPO,SIGN,KOD,DATD,PLAT,POLU,NAZ1,VSPO)
    VALUES                      (:nNM,:nNP,:nREF,:nS,:dVDATE,:dVDAT,:sMON_ID,:sSIGN,:sOKPO,:dDATD,:sPASP,
                                 :sCITIZ,:sADRES,:sFIO)")
.head 9 -  Set nN = nN + 1
.head 9 +  If bFL
.head 10 -  ! Call Debug('UPDATE - ref=' || Str(nREF))
.head 10 -  Set bFL = SqlPrepareAndExecute(hSqlAux(), "
    UPDATE lom_w
    SET    l_skupk=:nSkupk
    WHERE  ref=:nREF")
.head 10 +  If not bFL
.head 11 -  Break
.head 9 +  Else
.head 10 -  Break
.head 8 +  If bEct
.head 9 +  If bFL
.head 10 -  Call SqlCommit(hSqlA)
.head 10 -  Call SqlDisconnect(hSqlA)
.head 10 -  ! подписать файл sDbfPath || sFile1temp
.head 10 +  If SignFileSkupka(sDbfPath || sFile1temp, 647, nN, 1441+647)
.head 11 -  Set mlText = 'Файл ' || sFile1 || ' сформирован.'
.head 11 -  Call SqlCommit(hSqlAux())
.head 11 -  Call VisFileCopy(sDbfPath || sFile1temp, sFile)
.head 11 -  Call VisFileDelete(sDbfPath || sFile1temp)
.head 11 -  ! Call Debug(sDbfPath || 'QEDBF.INI')
.head 11 -  Call VisFileDelete(sDbfPath || 'QEDBF.INI')
.head 10 +  Else
.head 11 -  Call VisFileDelete(sDbfPath || sFile1temp)
.head 11 -  Call SqlRollback(hSqlAux())
.head 11 -  Set mlText = 'Ошибка (4) подписи файла ' || sFile1
.head 9 +  Else
.head 10 -  Call SqlCommit(hSqlA)
.head 10 -  Call SqlDisconnect(hSqlA)
.head 10 -  Call SqlRollback(hSqlAux())
.head 10 -  Call VisFileDelete(sDbfPath || sFile1temp)
.head 10 -  Set mlText = 'Ошибка (3) формирования файла ' || sFile1
.head 8 +  Else
.head 9 -  Call SqlDisconnect(hSqlA)
.head 9 -  Call VisFileDelete(sDbfPath || sFile1temp)
.head 9 -  Set mlText = 'Нет информации за ' || SalFmtFormatDateTime(dYes, 'dd/MM/yyyy')
.head 7 +  Else
.head 8 -  Call SqlDisconnect(hSqlA)
.head 8 -  Set mlText = 'Ошибка (2) формирования файла SKUPKA.DBF'
.head 6 +  Else
.head 7 -  Set mlText = 'Ошибка (1) формирования файла SKUPKA.DBF'
.head 6 -  Call SalFileSetCurrentDirectory(sOdir)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход (Esc)
.head 4 -  Window Location and Size
.head 5 -  Left:   6.283"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 +  Custom Control: cc1
.data CLASSPROPSSIZE
0000: 3600
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 6461720025000100 0000000100010000 0200000001000001
0020: 0101010000000A31 352F30362F313935 360000000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCalendar
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.917"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 +  Message Actions
.head 5 +  On SAM_CustControlCmd
.head 6 -  Call cc1.GetFocusDate(dDada)
.head 6 +  If cc1.IsSpecialDate(SPECIAL_OneTime, dDada, DAY_Unset, SEQ_Unset)
.head 7 -  Call cc1.SpecialDate(SPECIAL_OneTime, dYes, DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
.head 7 -  Set dYes = dDada
.head 7 -  Call cc1.SpecialDate(SPECIAL_OneTime, dYes, DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Yellow, TRUE)
.head 5 +  On SAM_Create
.head 6 -  Call cc1.WeekStartSet(2)
.head 3 +  Data Field: dfPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.083"
.head 6 -  Top:    0.643"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.19"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Gray
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: SignFileSkupka
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sFile
.head 5 -  Number: nLength
.head 5 -  Number: nN
.head 5 -  Number: nFirstOffset
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Long String: lsSignF
.head 5 -  Number: nSignLen
.head 5 -  Number: nErrorSign
.head 5 -  String: strErrorSign
.head 5 -  Number: nFile
.head 4 +  Actions
.head 5 +  If not GetSignOn() ! ЭЦП отключена - вернуть Пусто
.head 6 -  Return TRUE
.head 5 -  !
.head 5 -  Call SignFile.SetVariables(sSignType, sOpenKey, sSecretKeyDrv, sDebugIdOper, sDebugKeyDate, 5)
.head 5 +  If not SignFile._bInited
.head 6 -  ! Call Debug('
sSignType = '     || sSignType     || '
sOpenKey = '      || sOpenKey      || '
sSecretKeyDrv = ' || sSecretKeyDrv || '
sDebugIdOper = '  || sDebugIdOper  || '
sDebugKeyDate = ' || sDebugKeyDate)
.head 6 +  If not SignFile.Init()
.head 7 -  ! Call Debug('SignFile.StrErrorSign = ' || SignFile.strErrorSign)
.head 7 -  Call SalMessageBox('Ошибка формирования файла SKUPKA.
Невозможно инициализировать эл. подпись', 'Внимание!', MB_Ok)
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Set nFile = _sopen(sFile, 0x8000 | 0x0100 | 0x0002, 0x20, 0x00000180)
.head 5 -  Set lsSignF = Spac(88)
.head 5 -  Set nSignLen = 88
.head 5 -  ! посмотреть, куда записать ЕЦП
.head 5 +  If nN > 0 ! Подписываем файл со строками
.head 6 -  ! Call Debug('nFile = ' || Str(nFile))
.head 6 -  ! Set nErrorSign = SignFile.UniSignFile(nFile, nN, nFirstOffset, nLength, nLength, nSignLen, lsSignF)
.head 6 -  ! Set nErrorSign = SignFile.UniSignFile(nFile, nN, nFirstOffset, nLength-18, nLength, nSignLen, lsSignF)
.head 6 -  Set nErrorSign = SignFile.UniSignFile2(nFile, nN, nFirstOffset, nLength-18, nLength, nSignLen, lsSignF,
    nN*(nLength-18)+1)
.head 6 -  ! Call Debug( 'nSignLen='||SalNumberToStrX( nSignLen, 0 ) )
.head 6 +  If nErrorSign = 0 ! 0=ok, ЕЦП файла
.head 7 -  ! Call lllseek(nFile, 1579, FILE_SeekBegin)
.head 7 -  ! Call llwrite(nFile, lsSignF, nSignLen)
.head 7 -  ! Call lllseek(nFile, 1573, FILE_SeekBegin)
.head 7 -  ! Call llwrite(nFile, GetIdOper(), 6)
.head 7 -  ! Call _lseek(nFile, 1579, FILE_SeekBegin)
.head 7 -  Call _lseek(nFile, 1577, FILE_SeekBegin)
.head 7 -  Call _write(nFile, lsSignF, nSignLen)
.head 7 -  ! Call _lseek(nFile, 1573, FILE_SeekBegin)
.head 7 -  Call _lseek(nFile, 1571, FILE_SeekBegin)
.head 7 -  Call _write(nFile, GetIdOper(), 6)
.head 7 -  Call _commit(nFile)
.head 5 -  Call _close(nFile)
.head 5 +  If nErrorSign = 0
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Set strErrorSign = 'Ошибка наложения ЭЦП: ' || NumberToStr(nErrorSign)
.head 6 -  Call MessageAttention(strErrorSign)
.head 6 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  String: smWeek[7]
.head 3 -  String: smMonth[12]
.head 3 -  Date/Time: dDada
.head 3 -  Date/Time: dYes
.head 3 -  Date/Time: dSelect
.head 3 -  ! String: sdat
.head 3 -  Number: nI
.head 3 -  ! Number: nUid
.head 3 -  ! Number: nFetchRes
.head 3 -  ! Number: nKwo
.head 3 -  ! Boolean: bOk
.head 3 -  Boolean: bFL
.head 3 -  String: sDbfPath
.head 3 -  String: sOdir
.head 3 -  ! String: sSAB
.head 3 -  ! String: sNLS
.head 3 -  ! String: sNLSK
.head 3 -  ! String: sNAMS
.head 3 -  ! String: sNMK
.head 3 -  ! String: sMFO
.head 3 -  ! Number: nMFO
.head 3 -  ! String: sND
.head 3 -  ! Number: nISP
.head 3 -  ! Number: nEL
.head 3 -  Number: nNM
.head 3 -  Number: nNP
.head 3 -  ! Number: nVOB
.head 3 -  ! Number: nDK
.head 3 -  Number: nS
.head 3 -  ! Date/Time: dDAOPL
.head 3 -  ! Number: nISM
.head 3 -  ! Date/Time: dDAPP
.head 3 -  ! String: sNAZ
.head 3 -  ! String: sPOND
.head 3 -  ! String: sFN_A
.head 3 -  ! String: sD_REC
.head 3 -  ! Number: nRNK
.head 3 -  ! String: sKOKK
.head 3 -  ! String: sTD
.head 3 -  ! Number: nISPZ
.head 3 -  Number: nREF
.head 3 -  ! String: sPOLU
.head 3 -  String: sFile
.head 3 -  String: sFile1
.head 3 -  File Handle: hSqlA
.head 3 -  File Handle: hF
.head 3 -  !
.head 3 -  ! String: sGR
.head 3 -  ! String: sS230
.head 3 -  ! String: sKOD
.head 3 -  ! Number: nT020
.head 3 -  ! Number: nT060
.head 3 -  ! Boolean: bMakeFile
.head 3 -  ! Number: nNewTek
.head 3 -  ! Number: nNew
.head 3 -  Boolean: bEct
.head 3 -  ! Number: nDPI
.head 3 -  Boolean: bNoFile
.head 3 -  ! String: sRaj
.head 3 -  ! String: sKO
.head 3 -  !
.head 3 -  ! Date/Time: dDATP
.head 3 -  ! String: sNAZN
.head 3 -  ! String: sNAMK
.head 3 -  ! String: sNB
.head 3 -  ! String: sAMFO
.head 3 -  String: sSql
.head 3 -  ! String: sFdat
.head 3 -  ! Number: nAMFO
.head 3 -  ! String: sTemp
.head 3 -  ! Number: nTemp
.head 3 -  !
.head 3 -  ! String: sNlsLike
.head 3 -  ! String: sNlsLikeAll
.head 3 -  ! String: smNlsLike[*]
.head 3 -  ! Number: nK
.head 3 -  ! Number: nZ
.head 3 -  !
.head 3 -  Date/Time: dVDATE
.head 3 -  Date/Time: dDATD
.head 3 -  String: sSIGN
.head 3 -  String: sBDAY
.head 3 -  Number: nSkupk
.head 3 -  String: sMON_ID
.head 3 -  Date/Time: dVDAT
.head 3 -  String: sFIO
.head 3 -  String: sOKPO
.head 3 -  String: sCITIZ
.head 3 -  String: sPASP
.head 3 -  String: sADRES
.head 3 -  String: sATRT
.head 3 -  !
.head 3 -  String: sFile1temp
.head 3 -  Number: nN
.head 3 -  : SignFile
.head 4 -  Class: cSignFile
.head 3 -  !
.head 3 -  String: sSignType
.head 3 -  String: sOpenKey
.head 3 -  String: sSecretKeyDrv
.head 3 -  String: sDebugIdOper
.head 3 -  String: sDebugKeyDate
.head 3 -  !
.head 3 -  Number: nID
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! Set nUid = GetUserId()
.head 4 -  Set dYes = GetBankDate()
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('SKUPKA', 'DbfPath', GetPrnDir(), sDbfPath, GetIniFileName())
.head 4 -  Set sDbfPath = sDbfPath || IifS(Right(sDbfPath, 1)='\\', '', '\\')
.head 4 -  Set dfPath = sDbfPath
.head 4 -  !
.head 4 -  Call SalGetProfileString(INI_DigitalSignature, 'SignType',     'UNI',       sSignType,     GetIniFileName())
.head 4 -  Call SalGetProfileString(INI_DigitalSignature, 'OpenKey',      '.',         sOpenKey,      GetIniFileName())
.head 4 -  Call SalGetProfileString(INI_DigitalSignature, 'SecretKeyDrv',    'a:',     sSecretKeyDrv, GetIniFileName())
.head 4 -  Call SalGetProfileString(INI_DigitalSignature, 'DebugIdOper',  STRING_Null, sDebugIdOper,  GetIniFileName())
.head 4 -  Call SalGetProfileString(INI_DigitalSignature, 'DebugKeyDate', STRING_Null, sDebugKeyDate, GetIniFileName())
.head 4 -  !
.head 4 +  If sDebugIdOper = STRING_Null
.head 5 -  Set sDebugIdOper = GetIdOper()
.head 4 +  If sDebugKeyDate = STRING_Null
.head 5 -  Set sDebugKeyDate = GetKeyDate()
.head 4 -  !
.head 4 -  Set nI = 0
.head 4 -  Call cc1.ClearSpecials()
.head 4 -  Set mlText = 'Определение дат возможного выбора информации ...'
.head 4 -  Call SalSetFocus(cc1)
.head 4 -  Call GetMonthArrayRus(smMonth)
.head 4 -  Call GetWeekDayArray(smWeek)
.head 4 -  Call cc1.SetMonthText(smMonth)
.head 4 -  Call cc1.SetWeekDayText(smWeek)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Sunday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Monday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Tuesday,   SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Wednesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Thursday,  SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Friday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Saturday,  SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call SqlPrepareAndExecute(hSql(), T("
     SELECT DISTINCT o.vdat
     INTO   :dSelect
     FROM   oper o, lom_w w
     WHERE  o.sos=5 and o.tt in ('LO3','LOA') and w.ref=o.ref and w.grp='4' and nvl(w.l_skupk,0)=0
     ORDER BY 1"))
.head 4 -  Set nI = 0
.head 4 +  While SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call cc1.SpecialDate(SPECIAL_OneTime, dSelect, DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
.head 5 -  Set nI = nI + 1
.head 4 +  If nI = 0
.head 5 -  Set mlText = 'Нет информации для отбора файла SKUPKA'
.head 5 -  Call SalHideWindow(cc1)
.head 5 -  Call SalHideWindow(pbRun)
.head 5 -  Call SalSetFocus(pbExit)
.head 4 +  Else
.head 5 -  Set mlText = ''
.head 5 -  Call cc1.SetFocusDate(dSelect)
.head 4 -  Set SignFile._bInited = FALSE
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Close
.head 4 -  Call SignFile.Deinit()
