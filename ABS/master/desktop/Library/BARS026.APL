.head 0 +  Application Description: "МОДУЛЬ КАССИРОВ" - Чупахина Н.
"Корпус Мира" (Ощадбанк) - Сухова
"Покрытие чеков" - Сухова 

.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000390100 002C000000020000 0003000000000000 0077020000F7FFFF
0040: FFDCFFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 02000000001D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0020: 6578651D513A5C42 41525339385C4C49 42524152595C4241 52533031352E646C
0040: 6C1D513A5C424152 5339385C4C494252 4152595C42415253 3031352E61706300
0060: 000101011D513A5C 4241525339385C4C 4942524152595C42 4152533031352E72
0080: 756E1D513A5C4241 525339385C4C4942 524152595C424152 533031352E646C6C
00A0: 1D513A5C42415253 39385C4C49425241 52595C4241525330 31352E6170630000
00C0: 010101175C424152 5339385C42494E5C 424152533032362E 617064175C424152
00E0: 5339385C42494E5C 424152533031352E 646C6C175C424152 5339385C42494E5C
0100: 424152533031352E 6170630000010101 1D513A5C42415253 39385C4C49425241
0120: 52595C4241525330 31352E61706C1D51 3A5C424152533938 5C4C494252415259
0140: 5C42415253303135 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42
0160: 4152533031352E61 70630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: GENTBLS.APL
.head 2 -  File Include: GENTBL.APL
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: GENTBLD.APL
.head 2 -  File Include: GENTBLF.APL
.head 2 -  File Include: XSALIMG.APL
.head 2 -  File Include: Docwis6.apl
.head 2 -  File Include: Gentimer.apl
.head 2 -  File Include: XSALSPL.APL
.head 2 -  Dynalib: DOCVIEW.APD
.head 2 -  Dynalib: custacnt.apd
.head 2 -  Dynalib: nsiapi.apd
.head 2 -  Dynalib: Otcn.apd
.head 2 -  Dynalib: CHCKINNR.APD
.head 2 -  Dynalib: Bars010.apd
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  ! String: DocWMesNomerPachki = 'Пачка №'
.head 4 -  ! 14.01.2013
.head 4 -  String: sApdVersion = '02. '
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  Boolean: bApdInited
.head 3 -  Number: nFetchRes
.head 3 -  String: SX_BRN
.head 3 -  String: SX_NBS
.head 3 -  !
.head 3 -  Window Handle: h_23
.head 3 -  Window Handle: h_33
.head 3 -  Window Handle: h_34
.head 3 -  Window Handle: hWin1
.head 3 -  Window Handle: hWin2_0
.head 3 -  Window Handle: hWin2_1
.head 3 -  Window Handle: hWin3
.head 3 -  Window Handle: hWin10
.head 3 -  Window Handle: hWin13
.head 3 -  Window Handle: hWin_113
.head 3 -  Window Handle: hWin21
.head 3 -  ! Window Handle: hWin20
.head 2 +  Internal Functions
.head 3 +  Function: Ini026
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not bApdInited
.head 6 -  Call DocWisInit('frmDoc.')
.head 6 -  ! Set strPathToLangResources = GetLangPath()
.head 6 -  ! Set strLangId = GetLang()
.head 6 -  ! Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars013.lng"
.head 6 -  ! If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile(strFileName, strLangId))
.head 6 -  ! Call CurrentLangTable.Init()
.head 6 -  Set bApdInited = TRUE
.head 5 -  Return bApdInited
.head 3 +  Function: Sel026	! __exported
.head 4 -  Description: Bars026_Selector
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp
.head 4 +  Actions
.head 5 -  Call Ini026()
.head 5 +  ! If nMode= 113
.head 6 +  If not IsWindow(hWin_113)
.head 7 -  Set hWin_113 = SalCreateWindow(HLP, hWndParent, nPar)
.head 6 +  Else 
.head 7 -  Call SalBringWindowToTop(HLP)
.head 6 -  Return TRUE
.head 5 +  If nMode=10 OR nMode=11 OR nMode=12 ! ВВод чеков и формирование посылок
.head 6 +  If not IsWindow(hWin10)
.head 7 -  Set hWin10 = SalCreateWindow( CH1, hWndParent, nMode, nPar, strPar01, strPar02 )
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop( hWin10 )
.head 6 -  Return TRUE
.head 5 +  Else If nMode=13 OR nMode=14 OR nMode=15 ! Покритие посылок и архив
.head 6 +  If not IsWindow(hWin13)
.head 7 -  Set hWin13 = SalCreateWindow( CH3, hWndParent, nMode, nPar, strPar01, strPar02 )
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop( hWin13 )
.head 6 -  Return TRUE
.head 5 -  !
.head 5 +  Else If nMode = 21 ! Peace Corps: только в ОщадБанке
.head 6 +  If not IsWindow(hWin21)
.head 7 -  Set hWin21 = SalCreateWindow( PCorps, hWndParent, nMode, nPar, strPar01, strPar02 )
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop( hWin21 )
.head 6 -  Return TRUE
.head 5 +  Else If nMode = 20 ! Синхронизация справочника АЛЕГРО: только в ОщадБанке
.head 6 -  ! Особенности обработки табл в БД : NUMBER_Null или 0 - по-старому
.head 6 -  Set sTmp = "
Синхронизация системного в ОщадБанке файла AlegrOB.dbf
 -> 
с АБС БАРС (таблица в БД ALEGRO)"
.head 6 -  Call Imp_KL_NBU(hWndMDI)
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If SqlPrepareAndExecute( hSql(),"alter PROCEDURE ALEGRO_P compile" )
AND SqlPLSQLCommand(hSql(), "ALEGRO_P(nPar) " )
AND SqlPrepareAndExecute( hSql(),"drop table AlegrOB " )
.head 7 -  Set sTmp = sTmp || "
Выполнена успешно ! "
.head 7 -  Call SqlCommitEx( hSql(),sTmp )
.head 7 -  Call MessageNoWait(sTmp ,'Сообщение',0.5,0)
.head 6 +  Else
.head 7 -  Set sTmp = sTmp || "
НЕ выполнена ! "
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Call MessageNoWait(sTmp , 'Ошибка', 0, 1)
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Return TRUE
.head 5 -  !
.head 5 -  Set SX_BRN = GetGlobalOption  ('SX_BRN')
.head 5 -  Set SX_NBS = GetGlobalOption  ('SX_NBS')
.head 5 +  If SX_BRN = STRING_Null
.head 6 -  Set SX_BRN = '/' || GetBankMfo() || '/000000/'
.head 5 +  If SX_NBS = STRING_Null
.head 6 -  Set SX_NBS= '1001'
.head 5 +  Select Case nMode
.head 6 +  Case 1  ! Подбор кассира
.head 7 +  If not IsWindow(hWin1)
.head 8 -  Set hWin1 = SalCreateWindow(Frm_CasP, hWndParent, nMode, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin1)
.head 7 -  Break
.head 6 +  Case 2  ! Распределение/списание 
.head 7 -  ! Распределение
.head 7 +  If nPar = 0
.head 8 +  If not IsWindow(hWin2_0)
.head 9 -  Set hWin2_0 = SalCreateWindow(Frm_CasR, hWndParent, nPar, strPar01, strPar02)
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop(hWin2_0)
.head 7 -  ! Просмотр
.head 7 +  Else
.head 8 +  If not IsWindow(hWin2_1)
.head 9 -  Set hWin2_1 = SalCreateWindow(Frm_CasAcc, hWndParent, nPar, strPar01, strPar02)
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop(hWin2_1)
.head 7 -  Break
.head 6 +  Case 3  ! Справочник
.head 7 +  If not IsWindow(hWin3)
.head 8 -  Set hWin3 = SalCreateWindow( Frm_CasKC, hWndParent, nPar, strPar01, strPar02 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( hWin3 )
.head 7 -  Break
.head 6 +  Case 4  ! Подбор кассира (мат. відп. особа)
.head 7 +  If not IsWindow(hWin1)
.head 8 -  Set hWin1 = SalCreateWindow(Frm_CasP, hWndParent, nMode, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin1)
.head 7 -  Break
.head 6 -  !
.head 6 +  Case 23 !! Ввод кассовых заявок на подкрепление касс
.head 7 +  If IsWindow( h_23 )
.head 8 -  Call SalDestroyWindow( h_23 )
.head 7 -  Set h_23 = SalCreateWindow( KASZ, hWndMDI, nMode, nPar, strPar01, strPar02 )
.head 7 -  Break
.head 6 +  Case 33 !! Разбор кассовых заявок на подкрепление касс
.head 7 +  If IsWindow( h_33 )
.head 8 -  Call SalDestroyWindow( h_33 )
.head 7 -  Set h_33 = SalCreateWindow( KASS, hWndMDI, nMode, nPar, strPar01, strPar02 )
.head 7 -  Break
.head 6 +  Case 34 !! Мониторинг доставки на подкреплений касс
.head 7 +  If IsWindow( h_34 )
.head 8 -  Call SalDestroyWindow( h_33 )
.head 7 -  Set h_34 = SalCreateWindow( KASM, hWndMDI, nMode, nPar, strPar01, strPar02 )
.head 7 -  Break
.head 6 -  !
.head 6 +  Default
.head 7 -  Break
.head 3 +  Function: F_MFO_NLS
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: sMfo
.head 5 -  Number: nKv
.head 5 -  String: sNls
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: FL
.head 4 +  Actions
.head 5 +  If sMfo != STRING_Null AND sNls != STRING_Null AND nKv != NUMBER_Null
.head 6 +  If sMfo = GetBankMfo()
.head 7 +  If SqlPrepareAndExecute( hSql(), 
"SELECT acc from accounts where kv=:nKv and nls=:sNls and dazs is null" ) 
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox( "Не открыт счет в балансе нашего МФО !" , "Внимание, ОШИБКА !",
 MB_IconStop)
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else If sNls != KeyAccount( sMfo, sNls)
.head 7 -  Call SalMessageBox( "Ош.контрольный разряд счета в другом МФО !" , "Внимание, ОШИБКА !",
 MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 5 -  Return VALIDATE_Ok
.head 3 +  Function: F_VOB_NB
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sTT9
.head 5 -  Receive Number: nVOB_prixod
.head 5 -  Receive Number: nVOB_rasxod
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: FL
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), 
"select vob into :nVOB_prixod from tts_vob where tt=:sTT9 and ord=1" ) 
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set nVOB_prixod = 6
.head 5 +  If SqlPrepareAndExecute( hSql(), 
"select vob into :nVOB_rasxod from tts_vob where tt=:sTT9 and ord=2" ) 
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set nVOB_rasxod = 6
.head 6 -  Return TRUE
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbUpdate
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 -  Application Actions
.head 1 -  !
.head 1 +  Form Window: Frm_CasKC
.head 2 -  Class: cGenericTableFrm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 8.405"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Справочник соответствий счетов кассы и внесист. счетов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 37538
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( tblKas, ROW_Selected, 0 )
.head 8 -  Call OperWithAccount( AVIEW_ALL, tblKas.colKasAcc, 0, ACCESS_READONLY )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 37539
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  ! ctb_pbDetail: pbTurnForAccount
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.033"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DOC_TURN.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Показать выписку за день'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(tblCas, ROW_Selected, 0)
.head 8 -  Call SalSendMsg(tblCas.colCNls, WM_RbuttonDblClick, 0, 0)
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.033"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Найти счет'
.head 6 +  On SAM_Click
.head 7 +  If nKasKv != NUMBER_Null
.head 8 -  ! wParam: 0 - счета кассиров  ( pap=1, tip='CAS', nbs is null )
          1 - счета кассы     ( pap=1, tip='KAS', nbs is not null )
          2 - контрсчет кассы ( pap=2, tip='CAS', nbs is null )
          3 - резервный счет  ( pap=1, tip='CAS', nbs is null )
          4 - счет завкассой  ( pap=1, tip='CAS', nbs is null )
          5 - счет МОЛ        ( pap=1, tip='CAS', nbs is null )
         10 - группа контроля завкассы
.head 8 +  If wParam = 10
.head 9 -  Set sHelpSelect = 
"SELECT idchk, name FROM chklist ORDER BY idchk"
.head 8 +  Else
.head 9 -  Set sSqlKas = "select acc_kas from cas_acckas"
.head 9 -  Set sSqlK   = "select acc_k   from cas_acckas"
.head 9 -  Set sSqlR   = "select acc_r   from cas_acckas"
.head 9 -  Set sSqlM   = "select acc_m   from cas_acckas"
.head 9 -  Set sSqlZ   = "select acc_z   from cas_accz"
.head 9 -  Set sSqlC   = "select acc_c   from cas_acccas"
.head 9 -  Set sHelpSelect = 
"SELECT nls, nms FROM v_caskc_accounts 
  WHERE nbs is " || IifS(wParam=1, "not", "") || " null 
    AND tip = "  || IifS(wParam=1, "'KAS'", "'CAS'") || " 
    AND pap = "  || IifS(wParam=2, "2", "1") || " 
    AND kv  = "  || Str(nKasKv) || "
    AND acc not in (" || 
IifS(wParam=0, sSqlK || " union all " || sSqlR || " union all " || sSqlM || " union all " || sSqlC, 
IifS(wParam=1, sSqlKas, 
IifS(wParam=2, sSqlK || " union all " || sSqlR || " union all " || sSqlM || " union all " || sSqlZ || " union all " || sSqlC,
IifS(wParam=3, sSqlK || " union all " || sSqlR || " union all " || sSqlM || " union all " || sSqlZ || " union all " || sSqlC, 
IifS(wParam=4, sSqlK || " union all " || sSqlR || " union all " || sSqlM || " where acc_m <> :nMAcc" || " union all " || sSqlZ,
IifS(wParam=5, sSqlK || " union all " || sSqlR || " union all " || sSqlZ || " union all " || sSqlC, "")))))) || ")
  ORDER BY nls"
.head 8 +  If not SalModalDialog(dlgTagBrowse, hWndForm, sHelpSelect, sRetValue)
.head 9 -  Return FALSE
.head 8 +  Else
.head 9 +  If wParam = 0
.head 10 -  Call SalTblSetRowFlags(tblCas, SalTblQueryContext(tblCas), ROW_Edited, TRUE)
.head 10 -  Set tblCas.colCNls = sRetValue
.head 10 -  Call SalSendMsg(tblCas.colCNls, SAM_Validate, 0, 0)
.head 9 +  Else If wParam = 1
.head 10 -  Call SalTblSetRowFlags(tblKas, SalTblQueryContext(tblKas), ROW_Edited, TRUE)
.head 10 -  Set tblKas.colKasNls = sRetValue
.head 10 -  Call SalSendMsg(tblKas.colKasNls, SAM_Validate, 0, 0)
.head 9 +  Else If wParam = 2
.head 10 -  Call SalTblSetRowFlags(tblKas, SalTblQueryContext(tblKas), ROW_Edited, TRUE)
.head 10 -  Set tblKas.colKNls = sRetValue
.head 10 -  Call SalSendMsg(tblKas.colKNls, SAM_Validate, 0, 0)
.head 9 +  Else If wParam = 3
.head 10 -  Call SalTblSetRowFlags(tblKas, SalTblQueryContext(tblKas), ROW_Edited, TRUE)
.head 10 -  Set tblKas.colRNls = sRetValue
.head 10 -  Call SalSendMsg(tblKas.colRNls, SAM_Validate, 0, 0)
.head 9 +  Else If wParam = 4
.head 10 -  Call SalTblSetRowFlags(tblZ, SalTblQueryContext(tblZ), ROW_Edited, TRUE)
.head 10 -  Set tblZ.colZNls = sRetValue
.head 10 -  Call SalSendMsg(tblZ.colZNls, SAM_Validate, 0, 0)
.head 9 +  Else If wParam = 5
.head 10 -  Call SalTblSetRowFlags(tblKas, SalTblQueryContext(tblKas), ROW_Edited, TRUE)
.head 10 -  Set tblKas.colMNls = sRetValue
.head 10 -  Call SalSendMsg(tblKas.colMNls, SAM_Validate, 0, 0)
.head 9 +  Else If wParam = 10
.head 10 -  Call SalTblSetRowFlags(tblZ, SalTblQueryContext(tblZ), ROW_Edited, TRUE)
.head 10 -  Set tblZ.colChkId = Val(sRetValue)
.head 10 -  Call SalSendMsg(tblZ.colChkId, SAM_Validate, 0, 0)
.head 7 +  Else
.head 8 -  Call SalMessageBox('Не определена валюта!', 'Внимание!', MB_Ok|MB_IconAsterisk)
.head 4 -  ! Line
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.567"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  4.567"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 24
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.033"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 37540
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  4.55"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  4.55"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tblKas
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableFrm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.095"
.head 6 -  Width:  11.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.048"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colKasAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKasKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set nKasKv = NUMBER_Null
.head 8 +  If SalIsNull(colKasKv)
.head 9 -  Return VALIDATE_Ok
.head 8 +  If NOT SqlPrepareAndExecute(hSql(),
"SELECT lcv INTO :colKasLcv FROM tabval WHERE kv=:colKasKv") 
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SalMessageBox( 'Невозможно определить валюту ' || Str(colKasKv), 
     'Внимание!', MB_Ok|MB_IconAsterisk )
.head 9 -  Set colKasKv  = NUMBER_Null
.head 9 -  Set colKasLcv = ''
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set nKasKv = colKasKv
.head 8 +  If NOT SalIsNull(colKasNls)
.head 9 +  If NOT SqlPrepareAndExecute(hSql(),
"SELECT acc, nms INTO :colKasAcc, :colKasNms 
 FROM accounts
 WHERE nls=:colKasNls AND kv=:colKasKv 
   AND tip='KAS' AND pap=1")
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Call SalMessageBox( 'Не найден счет ' || colKasNls || '(' || colKasLcv || ')!', 
     'Внимание!', MB_Ok|MB_IconAsterisk )
.head 10 -  Return VALIDATE_Ok
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colKasLcv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKasNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If wParam = SalWindowHandleToNumber(pbHelp)
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  If SalIsNull(colKasNls)
.head 9 -  Return VALIDATE_Ok
.head 8 +  If NOT SalIsNull(colKasKv)
.head 9 +  If NOT SqlPrepareAndExecute(hSql(),
"SELECT acc, nms INTO :colKasAcc, :colKasNms 
   FROM accounts 
  WHERE nls=:colKasNls AND kv=:colKasKv
    AND " || sFilterKas || " 
    AND acc not in (select acc_kas FROM cas_acckas)")
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Call SalMessageBox('Не найден счет ' || colKasNls || '(' || colKasLcv || ')!', 
     'Внимание!', MB_Ok|MB_IconAsterisk )
.head 10 -  Set colKasAcc = NUMBER_Null
.head 10 -  Set colKasNls = ''
.head 10 -  Set colKasNms = ''
.head 10 -  Return VALIDATE_Ok
.head 8 -  Return VALIDATE_Ok
.head 7 -  ! Показать карточку счета
.head 7 +  On SAM_DoubleClick
.head 8 +  If colKasAcc
.head 9 -  Call OperWithAccount(AVIEW_ALL, colKasAcc, 0, ACCESS_READONLY)
.head 7 -  ! Показать выписку за день
.head 7 +  On WM_RbuttonDblClick
.head 8 +  If nPar = 0 and colKasAcc
.head 9 -  Call ShowTurnForAccount(colKasAcc, GetBankDateEx())
.head 7 -  ! F4 - показать справочник счетов
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(pbHelp, SAM_Click, 1, 0)
.head 7 -  ! StatusBar
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText(hWndForm, 'F4 - вызов справочника счетов')
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colKasNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKasOstc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
фактический
счета кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKasOstb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
плановый
счета кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Внесистемный
контрсчет
кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If wParam = SalWindowHandleToNumber(pbHelp)
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  If SalIsNull(colKNls)
.head 9 -  Return VALIDATE_Ok
.head 8 +  If SalIsNull(colKasKv)
.head 9 -  Call SalMessageBox('Не определена валюта!', 'Внимание!', MB_Ok|MB_IconAsterisk )
.head 9 -  Set colKNls = ''
.head 9 -  Return VALIDATE_Ok
.head 8 +  If NOT SqlPrepareAndExecute(hSql(),
"SELECT acc, nms INTO :colKAcc, :colKNms 
   FROM accounts
  WHERE nls=:colKNls AND kv=:colKasKv 
    AND " || sFilterK || " 
    AND acc not in (SELECT acc_k FROM cas_acckas)")
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SalMessageBox( 'Не найден счет ' || colKNls || '(' || colKasLcv || ')!', 
     'Внимание!', MB_Ok|MB_IconAsterisk )
.head 9 -  Set colKAcc = NUMBER_Null
.head 9 -  Set colKNls = ''
.head 9 -  Set colKNms = ''
.head 9 -  Return VALIDATE_Ok
.head 8 -  Return VALIDATE_Ok
.head 7 -  ! Показать карточку счета
.head 7 +  On SAM_DoubleClick
.head 8 +  If colKAcc
.head 9 -  Call OperWithAccount(AVIEW_ALL, colKAcc, 0, ACCESS_READONLY)
.head 7 -  ! Показать выписку за день
.head 7 +  On WM_RbuttonDblClick
.head 8 +  If nPar = 0 and colKAcc
.head 9 -  Call ShowTurnForAccount(colKAcc, GetBankDateEx())
.head 7 -  ! F4 - показать справочник счетов
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(pbHelp, SAM_Click, 2, 0)
.head 7 -  ! StatusBar
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText(hWndForm, 'F4 - вызов справочника счетов')
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colKNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
контрсчета кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKOstc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
фактический
контрсчета кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKOstb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
плановый
контрсчета кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: "Резервный"
счет
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If wParam = SalWindowHandleToNumber(pbHelp)
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  If SalIsNull(colRNls)
.head 9 -  Return VALIDATE_Ok
.head 8 +  If SalIsNull(tblKas.colKasKv)
.head 9 -  Call SalMessageBox('Не определена валюта!', 'Внимание!', MB_Ok|MB_IconAsterisk)
.head 9 -  Set tblKas.colRNls = ''
.head 9 -  Return VALIDATE_Ok
.head 8 +  If NOT SqlPrepareAndExecute(hSql(),
"SELECT acc, nms INTO :colRAcc, :colRNms
   FROM accounts
  WHERE nls=:colRNls AND kv=:colKasKv 
    AND " || sFilterCas || "
    AND acc not in (SELECT acc_r FROM cas_acckas)")
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SalMessageBox( 'Не найден счет ' || colRNls || '(' || colKasLcv || ')!',
     'Внимание!', MB_Ok|MB_IconAsterisk )
.head 9 -  Set colRAcc = NUMBER_Null
.head 9 -  Set colRNls = ''
.head 9 -  Set colRNms = ''
.head 9 -  Return VALIDATE_Ok
.head 8 -  Return VALIDATE_Ok
.head 7 -  ! Показать карточку счета
.head 7 +  On SAM_DoubleClick
.head 8 +  If colRAcc
.head 9 -  Call OperWithAccount(AVIEW_ALL, colRAcc, 0, ACCESS_READONLY)
.head 7 -  ! Показать выписку за день
.head 7 +  On WM_RbuttonDblClick
.head 8 +  If nPar = 0 and colRAcc
.head 9 -  Call ShowTurnForAccount(colRAcc, GetBankDateEx())
.head 7 -  ! F4 - показать справочник счетов
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(pbHelp, SAM_Click, 3, 0)
.head 7 -  ! StatusBar
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText(hWndForm, 'F4 - вызов справочника счетов')
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colRNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
"резервного"
счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colROstc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
фактический
"резервного" счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colROstb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
плановый
"резервного" счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Внесистемный
счет МОЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If wParam = SalWindowHandleToNumber(pbHelp)
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  If SalIsNull(colMNls)
.head 9 -  Return VALIDATE_Ok
.head 8 +  If SalIsNull(colKasKv)
.head 9 -  Call SalMessageBox('Не определена валюта!', 'Внимание!', MB_Ok|MB_IconAsterisk )
.head 9 -  Set colMNls = ''
.head 9 -  Return VALIDATE_Ok
.head 8 +  If NOT SqlPrepareAndExecute(hSql(),
"SELECT acc, nms INTO :colMAcc, :colMNms 
   FROM accounts
  WHERE nls=:colMNls AND kv=:colKasKv 
    AND " || sFilterCas || " 
    AND acc not in (SELECT acc_z FROM cas_accz)")
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SalMessageBox( 'Не найден счет ' || colMNls || '(' || colKasLcv || ')!', 
     'Внимание!', MB_Ok|MB_IconAsterisk )
.head 9 -  Set colMAcc = NUMBER_Null
.head 9 -  Set colMNls = ''
.head 9 -  Set colMNms = ''
.head 9 -  Return VALIDATE_Ok
.head 8 -  Return VALIDATE_Ok
.head 7 -  ! Показать карточку счета
.head 7 +  On SAM_DoubleClick
.head 8 +  If colMAcc
.head 9 -  Call OperWithAccount(AVIEW_ALL, colMAcc, 0, ACCESS_READONLY)
.head 7 -  ! Показать выписку за день
.head 7 +  On WM_RbuttonDblClick
.head 8 +  If nPar = 0 and colMAcc
.head 9 -  Call ShowTurnForAccount(colMAcc, GetBankDateEx())
.head 7 -  ! F4 - показать справочник счетов
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(pbHelp, SAM_Click, 5, 0)
.head 7 -  ! StatusBar
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText(hWndForm, 'F4 - вызов справочника счетов')
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colMNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета МОЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMOstc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
фактический
счета МОЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMOstb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
плановый
счета МОЛ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: sTmpKv
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SetRowColor(hWndForm, colKasOstc)
.head 6 -  Call SetRowColor(hWndForm, colKasOstb)
.head 6 -  Call SetRowColor(hWndForm, colKOstc)
.head 6 -  Call SetRowColor(hWndForm, colKOstb)
.head 6 -  Call SetRowColor(hWndForm, colROstc)
.head 6 -  Call SetRowColor(hWndForm, colROstb)
.head 6 -  Call SetRowColor(hWndForm, colMOstc)
.head 6 -  Call SetRowColor(hWndForm, colMOstb)
.head 6 -  ! Call SetRowColor(hWndForm, colZOstc)
.head 6 -  ! Call SetRowColor(hWndForm, colZOstb)
.head 6 +  If colKasOstc != colKOstc
or colKOstc   != colROstc
.head 7 -  Call XSalTblSetCellBackColor(colKasOstc, SalColorFromRGB(255, 230, 230))
.head 7 -  Call XSalTblSetCellBackColor(colKOstc, SalColorFromRGB(255, 230, 230))
.head 7 -  Call XSalTblSetCellBackColor(colROstc, SalColorFromRGB(255, 230, 230))
.head 5 +  On SAM_TblDoDetails
.head 6 +  If SalTblAnyRows(hWndForm, 0, 0)
.head 7 +  If SalTblQueryRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_New | ROW_Edited | ROW_MarkDeleted)
.head 8 -  Call SalDisableWindow(pbZIns)
.head 8 -  Call SalDisableWindow(pbZDel)
.head 8 -  Call SalDisableWindow(pbZUpdate)
.head 8 -  Call SalDisableWindow(pbCasIns)
.head 8 -  Call SalDisableWindow(pbCasDel)
.head 8 -  Call SalDisableWindow(pbCasUpdate)
.head 7 +  Else
.head 8 +  If nPar = 1
.head 9 -  Call SalEnableWindow(pbZIns)
.head 9 -  Call SalEnableWindow(pbZDel)
.head 9 -  Call SalEnableWindow(pbZUpdate)
.head 8 -  Set nKasAcc = colKasAcc
.head 8 -  Set nKasKv  = colKasKv
.head 8 -  Set sKasLcv = colKasLcv
.head 8 -  Set nMAcc   = colMAcc
.head 8 -  Call SalSendMsg(tblZ, UM_Populate, 0, 0)
.head 6 +  ! Else
.head 7 -  Call SalTblReset(tblZ)
.head 7 -  Call SalTblReset(tblCas)
.head 7 -  Call SalDisableWindow(pbCasIns)
.head 7 -  Call SalDisableWindow(pbCasDel)
.head 7 -  Call SalDisableWindow(pbCasUpdate)
.head 3 +  Child Table: tblZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    3.917"
.head 6 -  Width:  8.633"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.512"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colZAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
завкассой
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If wParam = SalWindowHandleToNumber(pbHelp)
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  If SalIsNull(colZNls)
.head 9 -  Return VALIDATE_Ok
.head 8 +  If nKasKv = NUMBER_Null
.head 9 -  Call SalMessageBox('Не определена валюта!', 'Внимание!', MB_Ok|MB_IconAsterisk)
.head 9 -  Set colZNls = ''
.head 9 -  Return VALIDATE_Ok
.head 8 +  If NOT SqlPrepareAndExecute(hSql(),
"SELECT acc, nms INTO :colZAcc, :colZNms
   FROM accounts
  WHERE nls=:colZNls AND kv=:nKasKv 
    AND " || sFilterCas || " 
    AND acc not in (SELECT acc_z FROM cas_accz)") 
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SalMessageBox( 'Не найден счет ' || colZNls || '(' || sKasLcv || ')!',
     'Внимание!', MB_Ok|MB_IconAsterisk )
.head 9 -  Set colZAcc = NUMBER_Null
.head 9 -  Set colZNls = ''
.head 9 -  Set colZNms = ''
.head 9 -  Return VALIDATE_Ok
.head 8 -  Return VALIDATE_Ok
.head 7 -  ! Показать карточку счета
.head 7 +  On SAM_DoubleClick
.head 8 +  If colZAcc
.head 9 -  Call OperWithAccount(AVIEW_ALL, colZAcc, 0, ACCESS_READONLY)
.head 7 -  ! Показать выписку за день
.head 7 +  On WM_RbuttonDblClick
.head 8 +  If nPar = 0 and colZAcc
.head 9 -  Call ShowTurnForAccount(colZAcc, GetBankDateEx())
.head 7 -  ! F4 - показать справочник счетов
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(pbHelp, SAM_Click, 4, 0)
.head 7 -  ! StatusBar
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText(hWndForm, 'F4 - вызов справочника счетов')
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colZNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета завкассой
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZOstc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
фактический
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZOstb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
плановый
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colChkId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код группы
контроля
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If wParam = SalWindowHandleToNumber(pbHelp)
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  If SalIsNull(colChkId)
.head 9 -  Set colChkName = ''
.head 9 -  Return VALIDATE_Ok
.head 8 +  If NOT SqlPrepareAndExecute(hSql(),
"SELECT name INTO :colChkName
   FROM chklist
  WHERE idchk=:colChkId") 
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SalMessageBox( 'Не найдена группа контроля ' || Str(colChkId) || '!',
     'Внимание!', MB_Ok|MB_IconAsterisk )
.head 9 -  Set colChkId   = NUMBER_Null
.head 9 -  Set colChkName = ''
.head 9 -  Return VALIDATE_Ok
.head 8 -  Return VALIDATE_Ok
.head 7 -  ! F4 - показать справочник счетов
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(pbHelp, SAM_Click, 10, 0)
.head 7 -  ! StatusBar
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText(hWndForm, 'F4 - вызов справочника групп контроля')
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colChkName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование группы
контроля
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strZPopulate
.head 5 -  String: strZInsert
.head 5 -  String: strZUpdate
.head 5 -  String: strZDelete
.head 5 -  Window Handle: hCol
.head 5 -  Number: nCount
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strZPopulate =
"select z_acc, z_nls, z_nms, z_ostc, z_ostb, chk_id, chk_name
   into :hWndForm.tblZ.colZAcc,  :hWndForm.tblZ.colZNls, :hWndForm.tblZ.colZNms, 
        :hWndForm.tblZ.colZOstc, :hWndForm.tblZ.colZOstb, 
        :hWndForm.tblZ.colChkId, :hWndForm.tblZ.colChkName
   from v_caskc_z
  where kas_acc = :nKasAcc and kv = :nKasKv"
.head 6 -  Set strZInsert =
"INSERT INTO cas_accz(acc_kas, acc_z, chk_id)
 VALUES (:nKasAcc, :hWndForm.tblZ.colZAcc, :hWndForm.tblZ.colChkId)"
.head 6 -  Set strZUpdate =
"UPDATE cas_accz SET chk_id = :hWndForm.tblZ.colChkId
 WHERE acc_z = :hWndForm.tblZ.colZAcc"
.head 6 -  Set strZDelete =
"DELETE FROM cas_accz WHERE acc_z=:hWndForm.tblZ.colZAcc"
.head 5 +  On UM_Populate
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), strZPopulate, TBL_FillAll)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  On SAM_TblDoDetails
.head 6 +  If SalTblAnyRows(hWndForm, 0, 0)
.head 7 +  If SalTblQueryRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_New | ROW_Edited | ROW_MarkDeleted)
.head 8 -  Call SalDisableWindow(pbCasIns)
.head 8 -  Call SalDisableWindow(pbCasDel)
.head 8 -  Call SalDisableWindow(pbCasUpdate)
.head 7 +  Else
.head 8 +  If nPar = 1
.head 9 -  Call SalEnableWindow(pbCasIns)
.head 9 -  Call SalEnableWindow(pbCasDel)
.head 9 -  Call SalEnableWindow(pbCasUpdate)
.head 9 -  ! Call SalEnableWindow(pbCasDetails)
.head 9 -  ! Call SalEnableWindow(pbCasTurnForAccount)
.head 8 -  Set nZAcc = colZAcc
.head 8 -  Call SalSendMsg(tblCas, UM_Populate, 0, 0)
.head 6 +  Else
.head 7 -  Call SalTblReset(tblCas)
.head 7 -  Call SalDisableWindow(pbCasIns)
.head 7 -  Call SalDisableWindow(pbCasDel)
.head 7 -  Call SalDisableWindow(pbCasUpdate)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SetRowColor(hWndForm, colZOstc)
.head 6 -  Call SetRowColor(hWndForm, colZOstb)
.head 5 +  On UM_Update
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If strZDelete != ''
.head 7 -  ! Call SqlPrepare( hSql(), T(strZDelete) )
.head 7 -  ! Call SalTblDoDeletes( hWndForm, hSql(), ROW_MarkDeleted )
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, ROW_MarkDeleted, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 +  If SqlPrepareAndExecute(hSql(), "select count(*) into :nCount from v_caskc_c where z_acc = :colZAcc and kv = :nKasKv")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If nCount > 0
.head 9 -  Call SalMessageBox("До завкаси прив'язані касири, видалення неможливе.", "Повідомлення", MB_IconAsterisk | MB_Ok)
.head 8 +  Else
.head 9 +  If not SqlPrepareAndExecute( hSql(), "DELETE FROM cas_accz WHERE acc_z=:hWndForm.tblZ.colZAcc")
.head 10 -  Call SqlRollback(hSql())
.head 6 +  If strZInsert != ''
.head 7 -  Call SqlPrepare( hSql(), T(strZInsert) )
.head 7 -  Call SalTblDoInserts( hWndForm, hSql(), TRUE )
.head 6 +  If strZUpdate != ''
.head 7 -  Call SqlPrepare( hSql(), T(strZUpdate) )
.head 7 -  Call SalTblDoUpdates( hWndForm, hSql(), TRUE )
.head 6 -  Call SqlCommit( hSql() )
.head 6 -  Call SalTblDefineSplitWindow( hWndForm, 0, FALSE )
.head 6 -  Call SalPostMsg( hWndForm, UM_Populate, 0, 0 )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On UM_Insert
.head 6 +  If NOT SalTblAnyRows( hWndForm, ROW_New, 0 )
.head 7 -  Call SalTblDefineSplitWindow( hWndForm, 3, TBL_Split_Adjustable )
.head 6 -  Set nRow = SalTblInsertRow( hWndForm, TBL_MinRow )
.head 6 -  Set hCol = tblKas.GetFirstEditableColumn( hWndForm )
.head 6 -  Call SalTblSetContext( hWndForm, nRow )
.head 6 -  Call SalTblSetFocusCell( hWndForm, nRow, hCol, 0, 1 )
.head 5 +  On UM_Delete
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0 )
.head 7 +  If NOT SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
.head 8 -  Call SalTblSetRowFlags(  hWndForm, nRow, ROW_MarkDeleted,
not SalTblQueryRowFlags(  hWndForm, nRow, ROW_MarkDeleted ) )
.head 7 +  Else
.head 8 -  Call SalTblDeleteRow( hWndForm, nRow, TBL_NoAdjust )
.head 3 +  Child Table: tblCas
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.45"
.head 6 -  Top:    5.762"
.head 6 -  Width:  8.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colCAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
кассира
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If wParam = SalWindowHandleToNumber(pbHelp)
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  If SalIsNull(colCNls)
.head 9 -  Return VALIDATE_Ok
.head 8 +  If nKasKv = NUMBER_Null
.head 9 -  Call SalMessageBox('Не определена валюта!', 'Внимание!', MB_Ok|MB_IconAsterisk)
.head 9 -  Set colCNls = ''
.head 9 -  Return VALIDATE_Ok
.head 8 +  If NOT SqlPrepareAndExecute(hSql(),
"SELECT acc, nms INTO :colCAcc, :colCNms 
   FROM accounts
  WHERE nls=:colCNls AND kv=:nKasKv 
    AND " || sFilterCas || " 
    AND acc not in (SELECT acc_c FROM cas_acccas)")
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set colCAcc = NUMBER_Null
.head 9 -  Set colCNls = ''
.head 9 -  Set colCNms = ''
.head 9 -  Return VALIDATE_Ok
.head 8 -  Return VALIDATE_Ok
.head 7 -  ! Показать карточку счета
.head 7 +  On SAM_DoubleClick
.head 8 +  If colCAcc
.head 9 -  Call OperWithAccount(AVIEW_ALL, colCAcc, 0, ACCESS_READONLY)
.head 7 -  ! Показать выписку за день
.head 7 +  On WM_RbuttonDblClick
.head 8 +  If nPar = 0 and colCAcc
.head 9 -  Call ShowTurnForAccount(colCAcc, GetBankDateEx())
.head 7 -  ! F4 - показать справочник счетов
.head 7 +  On VTM_KeyDown
.head 8 +  If wParam = VK_F4
.head 9 -  Call SalSendMsg(pbHelp, SAM_Click, 0, 0)
.head 7 -  ! StatusBar
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalStatusSetText(hWndForm, 'F4 - вызов справочника счетов')
.head 7 +  On SAM_KillFocus
.head 8 -  Call SalStatusSetText(hWndForm, '')
.head 5 +  Column: colCNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета кассира
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCOstc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
фактический
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCOstb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
плановый
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCasPopulate
.head 5 -  String: strCasInsert
.head 5 -  String: strCasDelete
.head 5 -  Window Handle: hCol
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strCasPopulate =
"select c_acc, c_nls, c_nms, c_ostc, c_ostb
   into :hWndForm.tblCas.colCAcc, :hWndForm.tblCas.colCNls, :hWndForm.tblCas.colCNms,
        :hWndForm.tblCas.colCOstc, :hWndForm.tblCas.colCOstb
   from v_caskc_c
  where z_acc = :nZAcc and kv = :nKasKv"
.head 6 -  ! Set strCasPopulate =
"SELECT a.acc, a.nls, a.nms, a.ostc/power(10,t.dig), a.ostb/power(10,t.dig)
   INTO :hWndForm.tblCas.colCAcc, :hWndForm.tblCas.colCNls, :hWndForm.tblCas.colCNms,
        :hWndForm.tblCas.colCOstc, :hWndForm.tblCas.colCOstb
   FROM cas_acccas c, accounts a, tabval t
  WHERE c.acc_z=:nZAcc AND c.acc_c=a.acc 
    AND a.kv=:nKasKv AND a.pap=1 AND a.tip='CAS' AND a.nbs is null AND a.dazs is null 
    AND a.kv=t.kv"
.head 6 -  Set strCasInsert =
"INSERT INTO cas_acccas(acc_z, acc_c)
 VALUES (:nZAcc, :hWndForm.tblCas.colCAcc)"
.head 6 -  Set strCasDelete =
"DELETE FROM cas_acccas WHERE acc_c=:hWndForm.tblCas.colCAcc"
.head 5 +  On UM_Populate
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 6 -  Call SalTblPopulate( hWndForm, hSql(), strCasPopulate, TBL_FillAll)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SetRowColor(hWndForm, colCOstc)
.head 6 -  Call SetRowColor(hWndForm, colCOstb)
.head 5 +  On UM_Update
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If strCasDelete != ''
.head 7 -  Call SqlPrepare( hSql(), T(strCasDelete) )
.head 7 -  Call SalTblDoDeletes( hWndForm, hSql(), ROW_MarkDeleted )
.head 6 +  If strCasInsert != ''
.head 7 -  Call SqlPrepare( hSql(), T(strCasInsert) )
.head 7 -  Call SalTblDoInserts( hWndForm, hSql(), TRUE )
.head 6 -  Call SqlCommit( hSql() )
.head 6 -  Call SalTblDefineSplitWindow( hWndForm, 0, FALSE )
.head 6 -  Call SalPostMsg( hWndForm, UM_Populate, 0, 0 )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On UM_Insert
.head 6 +  If NOT SalTblAnyRows( hWndForm, ROW_New, 0 )
.head 7 -  Call SalTblDefineSplitWindow( hWndForm, 3, TBL_Split_Adjustable )
.head 6 -  Set nRow = SalTblInsertRow( hWndForm, TBL_MinRow )
.head 6 -  Set hCol = tblKas.GetFirstEditableColumn( hWndForm )
.head 6 -  Call SalTblSetContext( hWndForm, nRow )
.head 6 -  Call SalTblSetFocusCell( hWndForm, nRow, hCol, 0, 1 )
.head 5 +  On UM_Delete
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0 )
.head 7 +  If NOT SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
.head 8 -  Call SalTblSetRowFlags(  hWndForm, nRow, ROW_MarkDeleted,
not SalTblQueryRowFlags(  hWndForm, nRow, ROW_MarkDeleted ) )
.head 7 +  Else
.head 8 -  Call SalTblDeleteRow( hWndForm, nRow, TBL_NoAdjust )
.head 3 +  Custom Control: cSplMain
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.783"
.head 6 -  Top:    1.679"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSplMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    3.81"
.head 6 -  Width:  12.183"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.607"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSplMB1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.217"
.head 6 -  Top:    4.488"
.head 6 -  Width:  2.867"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSplMB2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    6.298"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSplMB11
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    3.929"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSplMB12
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.25"
.head 6 -  Top:    3.929"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSplMB13
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    3.929"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSplMB21
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.317"
.head 6 -  Top:    5.738"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSplMB22
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.3"
.head 6 -  Top:    5.738"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSplMB23
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.233"
.head 6 -  Top:    5.738"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbZIns
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.45"
.head 5 -  Top:    4.583"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Добавить запись'
.head 5 +  On SAM_Click
.head 6 +  If nKasKv = NUMBER_Null
.head 7 -  Call SalMessageBox('Не определена валюта!', 'Внимание!', MB_Ok|MB_IconAsterisk)
.head 6 +  Else
.head 7 -  Call SalSendMsg(tblZ, UM_Insert, 0, 0)
.head 3 +  Pushbutton: pbZDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.9"
.head 5 -  Top:    4.583"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Удалить запись'
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblZ, UM_Delete, 0, 0)
.head 3 +  Pushbutton: pbZUpdate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.367"
.head 5 -  Top:    4.583"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Сохранить данные'
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblZ, UM_Update, 0, 0)
.head 3 +  Pushbutton: pbCasIns
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.533"
.head 5 -  Top:    6.381"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Добавить запись'
.head 5 +  On SAM_Click
.head 6 +  If nKasKv = NUMBER_Null
.head 7 -  Call SalMessageBox('Не определена валюта!', 'Внимание!', MB_Ok|MB_IconAsterisk)
.head 6 +  Else
.head 7 -  Call SalSendMsg(tblCas, UM_Insert, 0, 0)
.head 3 +  Pushbutton: pbCasDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.983"
.head 5 -  Top:    6.381"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Удалить запись'
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblCas, UM_Delete, 0, 0)
.head 3 +  Pushbutton: pbCasUpdate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.433"
.head 5 -  Top:    6.369"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Сохранить данные'
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(tblCas, UM_Update, 0, 0)
.head 3 +  ! ctb_pbDetail: pbCasDetails
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.133"
.head 5 -  Top:    2.274"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Показать карточку счета'
.head 5 +  On SAM_Click
.head 6 +  If SalTblAnyRows(tblCas, ROW_Selected, 0)
.head 7 -  Call SalSendMsg(tblCas.colCNls, SAM_DoubleClick, 0, 0)
.head 3 +  ! ctb_pbDetail: pbCasTurnForAccount
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.617"
.head 5 -  Top:    2.274"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DOC_TURN.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Показать выписку за день'
.head 5 +  On SAM_Click
.head 6 +  If nPar = 0
.head 7 -  Call ShowTurnForAccount(tblCas.colCAcc, GetBankDateEx())
.head 2 +  Functions
.head 3 +  Function: SetRowColor
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hTblWnd
.head 5 -  Window Handle: hColumnWnd
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nID
.head 5 -  String: sTxt
.head 5 -  Number: nS
.head 5 -  Number: nColor
.head 4 +  Actions
.head 5 -  Set nID = SalTblQueryColumnID(hColumnWnd)
.head 5 -  Call SalTblGetColumnText(hTblWnd, nID, sTxt)
.head 5 -  Set nS = Val(sTxt)
.head 5 +  If nS < 0
.head 6 -  Set nColor = COLOR_Red
.head 5 +  Else If nS > 0
.head 6 -  Set nColor = COLOR_DarkBlue
.head 5 +  Else
.head 6 -  Set nColor = COLOR_Black
.head 5 -  Call SalTblSetCellTextColor(hColumnWnd, nColor, FALSE)
.head 5 -  Call SalTblSetColumnText(hTblWnd, nID, Str(Abs(nS)))
.head 2 +  Window Parameters
.head 3 -  Number: nPar	! 0-ReadOnly, 1-Edit
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  String: sHelpSelect
.head 3 -  String: sRetValue
.head 3 -  !
.head 3 -  String: sFilterKas
.head 3 -  String: sFilterK
.head 3 -  String: sFilterCas
.head 3 -  !
.head 3 -  Number: nKasAcc
.head 3 -  Number: nKasKv
.head 3 -  String: sKasLcv
.head 3 -  Number: nMAcc
.head 3 -  Number: nZAcc
.head 3 -  String: sSqlKas
.head 3 -  String: sSqlK
.head 3 -  String: sSqlR
.head 3 -  String: sSqlM
.head 3 -  String: sSqlZ
.head 3 -  String: sSqlC
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText(hWndForm, sApdVersion || 'Справочник соответствий счетов кассы')
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  ! nPar=1 - редактирование справочника
  не показывать остатки, только nls,kv,nms
.head 4 +  If nPar = 1
.head 5 -  Call SalHideWindow(tblKas.colKasOstc)
.head 5 -  Call SalHideWindow(tblKas.colKasOstb)
.head 5 -  Call SalHideWindow(tblKas.colKOstc)
.head 5 -  Call SalHideWindow(tblKas.colKOstb)
.head 5 -  Call SalHideWindow(tblKas.colROstc)
.head 5 -  Call SalHideWindow(tblKas.colROstb)
.head 5 -  Call SalHideWindow(tblKas.colMOstc)
.head 5 -  Call SalHideWindow(tblKas.colMOstb)
.head 5 -  Call SalHideWindow(tblZ.colZOstc)
.head 5 -  Call SalHideWindow(tblZ.colZOstb)
.head 5 -  Call SalHideWindow(tblCas.colCOstc)
.head 5 -  Call SalHideWindow(tblCas.colCOstb)
.head 4 -  ! nPar=0 - сверка остатков в конце дня
  показать остатки на счетах + возможность просмотреть выписку за день
.head 4 +  Else
.head 5 -  Set hWndForm.Frm_CasKC.nFlags = GT_ReadOnly
.head 5 -  Call SalShowWindow(tblKas.colKasOstc)
.head 5 -  Call SalShowWindow(tblKas.colKasOstb)
.head 5 -  Call SalShowWindow(tblKas.colKOstc)
.head 5 -  Call SalShowWindow(tblKas.colKOstb)
.head 5 -  Call SalShowWindow(tblKas.colROstc)
.head 5 -  Call SalShowWindow(tblKas.colROstb)
.head 5 -  Call SalShowWindow(tblKas.colMOstc)
.head 5 -  Call SalShowWindow(tblKas.colMOstb)
.head 5 -  Call SalShowWindow(tblZ.colZOstc)
.head 5 -  Call SalShowWindow(tblZ.colZOstb)
.head 5 -  Call SalShowWindow(tblCas.colCOstc)
.head 5 -  Call SalShowWindow(tblCas.colCOstb)
.head 5 -  Call SalDisableWindow(tblKas.colKasKv)
.head 5 -  Call SalDisableWindow(tblKas.colKasNls)
.head 5 -  Call SalDisableWindow(tblKas.colKNls)
.head 5 -  Call SalDisableWindow(tblKas.colRNls)
.head 5 -  Call SalDisableWindow(tblKas.colMNls)
.head 5 -  Call SalDisableWindow(tblZ.colZNls)
.head 5 -  Call SalDisableWindow(tblZ.colChkId)
.head 5 -  Call SalDisableWindow(tblCas.colCNls)
.head 4 -  Call SalDisableWindow(pbZIns)
.head 4 -  Call SalDisableWindow(pbZDel)
.head 4 -  Call SalDisableWindow(pbZUpdate)
.head 4 -  Call SalDisableWindow(pbCasIns)
.head 4 -  Call SalDisableWindow(pbCasDel)
.head 4 -  Call SalDisableWindow(pbCasUpdate)
.head 4 -  !
.head 4 -  Set sFilterKas = " ( pap=1 and tip='KAS' and nbs is not null and dazs is null ) "
.head 4 -  Set sFilterK   = " ( pap=2 and tip='CAS' and nbs is     null and dazs is null ) "
.head 4 -  Set sFilterCas = " ( pap=1 and tip='CAS' and nbs is     null and dazs is null ) "
.head 4 -  !
.head 4 -  Set hWndForm.Frm_CasKC.strSqlPopulate =
"SELECT kas_acc, kas_nls, kas_nms, kas_ostc, kas_ostb, kv, lcv, 
        k_acc, k_nls, k_nms, k_ostc, k_ostb, 
        r_acc, r_nls, r_nms, r_ostc, r_ostb,
        m_acc, m_nls, m_nms, m_ostc, m_ostb
   INTO :Frm_CasKC.tblKas.colKasAcc,  :Frm_CasKC.tblKas.colKasNls,  :Frm_CasKC.tblKas.colKasNms,
        :Frm_CasKC.tblKas.colKasOstc, :Frm_CasKC.tblKas.colKasOstb, :Frm_CasKC.tblKas.colKasKv, :Frm_CasKC.tblKas.colKasLcv, 
        :Frm_CasKC.tblKas.colKAcc,  :Frm_CasKC.tblKas.colKNls, :Frm_CasKC.tblKas.colKNms, 
        :Frm_CasKC.tblKas.colKOstc, :Frm_CasKC.tblKas.colKOstb,
        :Frm_CasKC.tblKas.colRAcc,  :Frm_CasKC.tblKas.colRNls, :Frm_CasKC.tblKas.colRNms, 
        :Frm_CasKC.tblKas.colROstc, :Frm_CasKC.tblKas.colROstb,
        :Frm_CasKC.tblKas.colMAcc,  :Frm_CasKC.tblKas.colMNls, :Frm_CasKC.tblKas.colMNms, 
        :Frm_CasKC.tblKas.colMOstc, :Frm_CasKC.tblKas.colMOstb
   FROM v_caskc_k"
.head 4 -  ! Set hWndForm.Frm_CasKC.strSqlPopulate =
"SELECT a.acc, a.nls, a.nms, a.ostc/power(10,t.dig), a.ostb/power(10,t.dig), a.kv, t.lcv, 
        k.acc, k.nls, k.nms, k.ostc/power(10,t.dig), k.ostb/power(10,t.dig), 
        r.acc, r.nls, r.nms, r.ostc/power(10,t.dig), r.ostb/power(10,t.dig)
   INTO :Frm_CasKC.tblKas.colKasAcc,  :Frm_CasKC.tblKas.colKasNls,  :Frm_CasKC.tblKas.colKasNms,
        :Frm_CasKC.tblKas.colKasOstc, :Frm_CasKC.tblKas.colKasOstb, :Frm_CasKC.tblKas.colKasKv, :Frm_CasKC.tblKas.colKasLcv, 
        :Frm_CasKC.tblKas.colKAcc,  :Frm_CasKC.tblKas.colKNls, :Frm_CasKC.tblKas.colKNms, 
        :Frm_CasKC.tblKas.colKOstc, :Frm_CasKC.tblKas.colKOstb,
        :Frm_CasKC.tblKas.colRAcc,  :Frm_CasKC.tblKas.colRNls, :Frm_CasKC.tblKas.colRNms, 
        :Frm_CasKC.tblKas.colROstc, :Frm_CasKC.tblKas.colROstb
   FROM accounts a, accounts k, accounts r, cas_acckas kas, tabval t
  WHERE kas.acc_kas=a.acc 
    AND a.pap=1 and a.tip='KAS' and a.nbs is not null and a.dazs is null
    AND kas.acc_k=k.acc 
    AND k.pap=2 and k.tip='CAS' and k.nbs is     null and k.dazs is null
    AND kas.acc_r=r.acc 
    AND r.pap=1 and r.tip='CAS' and r.nbs is     null and r.dazs is null
    AND a.kv=t.kv"
.head 4 -  Set hWndForm.Frm_CasKC.strSqlInsert =
"INSERT INTO cas_acckas(acc_kas, acc_k, acc_r, acc_m)
 VALUES (:Frm_CasKC.tblKas.colKasAcc, :Frm_CasKC.tblKas.colKAcc, :Frm_CasKC.tblKas.colRAcc, :Frm_CasKC.tblKas.colMAcc)"
.head 4 -  Set hWndForm.Frm_CasKC.strSqlDelete =
"DELETE FROM cas_acckas WHERE acc_kas=:Frm_CasKC.tblKas.colKasAcc"
.head 4 -  Set hWndForm.Frm_CasKC.strSqlUpdate =
"UPDATE cas_acckas 
    SET acc_k = :Frm_CasKC.tblKas.colKAcc, 
        acc_r = :Frm_CasKC.tblKas.colRAcc,
        acc_m = :Frm_CasKC.tblKas.colMAcc
  WHERE acc_kas = :Frm_CasKC.tblKas.colKasAcc"
.head 4 -  ! Set hWndForm.Frm_CasKC.nTabInstance = 1
.head 4 -  !
.head 4 -  ! главное горизонтальное окно
.head 4 -  ! Call SalSetWindowText(cSplMain, 'Счета кассы (KAS)')
.head 4 -  Call cSplMain.setBarSize(5)
.head 4 -  Call cSplMain.setTopFrame(tblKas)
.head 4 -  Call cSplMain.setBottomFrame(cSplMB)
.head 4 -  Call cSplMain.setBarPosition( 300 )
.head 4 -  !
.head 4 -  ! Call SalSetWindowText(cSplMB, 'Счета завкассой (CAS);Счета кассиров (CAS)')
.head 4 -  Call cSplMB.setBarSize(5)
.head 4 -  Call cSplMB.setTopFrame(cSplMB1)
.head 4 -  Call cSplMB.setBottomFrame(cSplMB2)
.head 4 -  Call cSplMB.setBarPosition( 400 )
.head 4 -  ! Call cSplMB.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  !
.head 4 -  Call cSplMB1.setBarSize(1)
.head 4 -  Call cSplMB1.setTopFrame(cSplMB11)
.head 4 -  Call cSplMB1.setBottomFrame(tblZ)
.head 4 -  Call cSplMB1.setBarPosition( 115 )
.head 4 -  Call cSplMB1.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  !
.head 4 -  Call cSplMB2.setBarSize(1)
.head 4 -  Call cSplMB2.setTopFrame(cSplMB21)
.head 4 -  Call cSplMB2.setBottomFrame(tblCas)
.head 4 -  Call cSplMB2.setBarPosition( 80 )
.head 4 -  Call cSplMB2.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  !
.head 4 -  Call cSplMB11.setBarSize(1)
.head 4 -  Call cSplMB11.setLeftFrame(pbZIns)
.head 4 -  Call cSplMB11.setRightFrame(cSplMB12)
.head 4 -  Call cSplMB11.setBarPosition( 22 )
.head 4 -  Call cSplMB11.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  !
.head 4 -  Call cSplMB12.setBarSize(1)
.head 4 -  Call cSplMB12.setLeftFrame(pbZDel)
.head 4 -  Call cSplMB12.setRightFrame(cSplMB13)
.head 4 -  Call cSplMB12.setBarPosition( 23 )
.head 4 -  Call cSplMB12.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  !
.head 4 -  Call cSplMB13.setBarSize(1)
.head 4 -  Call cSplMB13.setLeftFrame(pbZUpdate)
.head 4 -  ! Call cSplMB13.setRightFrame(cSplMB13)
.head 4 -  Call cSplMB13.setBarPosition( 24 )
.head 4 -  Call cSplMB13.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  !
.head 4 -  Call cSplMB21.setBarSize(1)
.head 4 -  Call cSplMB21.setLeftFrame(pbCasIns)
.head 4 -  Call cSplMB21.setRightFrame(cSplMB22)
.head 4 -  Call cSplMB21.setBarPosition( 22 )
.head 4 -  Call cSplMB21.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  !
.head 4 -  Call cSplMB22.setBarSize(1)
.head 4 -  Call cSplMB22.setLeftFrame(pbCasDel)
.head 4 -  Call cSplMB22.setRightFrame(cSplMB23)
.head 4 -  Call cSplMB22.setBarPosition( 23 )
.head 4 -  Call cSplMB22.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  !
.head 4 -  Call cSplMB23.setBarSize(1)
.head 4 -  Call cSplMB23.setLeftFrame(pbCasUpdate)
.head 4 -  ! Call cSplMB23.setRightFrame(cSplMB23)
.head 4 -  Call cSplMB23.setBarPosition( 24 )
.head 4 -  Call cSplMB23.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create,0,0)
.head 1 +  Form Window: Frm_CasR
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.head 2 -  Class: cGenericTableSpl
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Распределение между кассирами
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.31"
.head 4 -  Top:    0.625"
.head 4 -  Width:  10.4"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.893"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Распределение между кассирами
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\INSERT.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.567"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DELREC.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.3"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.414"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51143
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  1.133"
.head 6 -  Begin Y:  0.021"
.head 6 -  End X:  1.133"
.head 6 -  End Y:  0.438"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.729"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.157"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.586"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.014"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51144
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  3.571"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  3.571"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.714"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Распределить'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm.Frm_CasR.tblCCas, SAM_User, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 51145
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  4.243"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  4.243"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.357"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    2.571"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tblZCas
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colZAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Acc
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: kv
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZLcv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
завкассой
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета завкассой
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZOstc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток фактический
счета завкассой
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZOstb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток плановый
счета завкассой
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKasAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KasAcc
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKasNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKasNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKasOstc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток фактический
счета кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKasOstb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток плановый
счета кассы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colZDig
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Dig
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SetRowColor(hWndForm, colZOstc)
.head 6 -  Call SetRowColor(hWndForm, colZOstb)
.head 6 -  Call SetRowColor(hWndForm, colKasOstc)
.head 6 -  Call SetRowColor(hWndForm, colKasOstb)
.head 6 +  If colZOstc != colZOstb 
.head 7 -  Call XSalTblSetCellBackColor(colZOstc, SalColorFromRGB(255, 230, 230))
.head 7 -  Call XSalTblSetCellBackColor(colZOstb, SalColorFromRGB(255, 230, 230))
.head 5 +  On SAM_TblDoDetails
.head 6 -  Set nZAcc   = colZAcc
.head 6 -  Set nZKv    = colZKv
.head 6 -  Set sZNls   = colZNls
.head 6 -  Set sZNms   = colZNms
.head 6 -  Set nZDig   = colZDig
.head 6 -  Set nKasAcc = colKasAcc
.head 6 +  If nZKv
.head 7 -  Call SalSendMsg(tblCCas, UM_Populate, 0, 0)
.head 3 +  Child Table: tblCCas
.head 4 -  Class Child Ref Key: 27
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    2.571"
.head 6 -  Width:  12.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.679"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 500
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colCAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Acc
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCOstc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
фактический
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выдать
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If not SalIsNull(colS1)
.head 9 +  If NOT SalIsValidNumber(colS1)
.head 10 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colS2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Принять
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If not SalIsNull(colS2)
.head 9 +  If NOT SalIsValidNumber(colS2)
.head 10 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colCOstb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
плановый
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обороты
Дебет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обороты
Кредит
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDokD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Приход
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDokK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Расход
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Boolean: bErr
.head 5 -  Number: nRow
.head 5 -  Number: nS
.head 5 -  String: sNlsA
.head 5 -  String: sNmsA
.head 5 -  String: sNlsB
.head 5 -  String: sNmsB
.head 5 -  String: sNazn
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), 
"SELECT c_acc, c_nls, c_nms, c_ostc, c_ostb, c_dos, c_kos, c_doc_d, c_doc_k
   INTO :tblCCas.colCAcc, :tblCCas.colCNls,  :tblCCas.colCNms, 
        :tblCCas.colCOstc, :tblCCas.colCOstb, :colDOS, :colKOS, :colDokD, :colDokK
   FROM v_casr_c
  WHERE kas_acc = :nKasAcc
    AND z_acc   = :nZAcc
    AND c_acc  <> :nZAcc 
    AND kv      = :nZKv 
  ORDER BY c_nms", TBL_FillAll )
.head 6 -  ! Call SalTblPopulate(hWndForm, hSql(), 
"SELECT a.acc, a.nls, a.nms, 
        a.ostc/power(10,t.dig), a.ostb/power(10,t.dig), 
        nvl(o.dos,0)/power(10,t.dig), nvl(o.kos,0)/power(10,t.dig), 
        nvl(o2.dos,0)/power(10,t.dig), nvl(o2.kos,0)/power(10,t.dig)
   INTO :tblCCas.colCAcc, :tblCCas.colCNls,  :tblCCas.colCNms, 
        :tblCCas.colCOstc, :tblCCas.colCOstb, :colDOS, :colKOS, :colDokD, :colDokK
   FROM cas_acckas kas, cas_accz zcas, cas_acccas c, accounts a, tabval t,
        ( select o.acc, sum(decode(o.dk,0,o.s,0)) dos, sum(decode(o.dk,1,o.s,0)) kos 
            from opldok o, accounts a 
           where a.pap=1 and a.tip='CAS' and a.nbs is null and a.dazs is null 
             and a.acc=o.acc and o.fdat=bankdate and o.sos=5 
           group by o.acc ) o, 
        ( select o.acc, sum(decode(o.dk,0,o.s,0)) dos, sum(decode(o.dk,1,o.s,0)) kos 
            from opldok o, accounts a, operw w 
           where a.pap=1 and a.tip='CAS' and a.nbs is null and a.dazs is null 
             and a.acc=o.acc and o.fdat=bankdate and o.sos=5
             and o.ref=w.ref and w.tag='CAS_A' and trunc(w.value)<>'0' 
           group by o.acc ) o2
  WHERE c.acc_z = :nZAcc
    AND c.acc_z = zcas.acc_z AND zcas.acc_kas = kas.acc_kas 
    AND c.acc_c <> :nZAcc AND c.acc_c <> kas.acc_r 
    AND c.acc_c = a.acc 
    AND a.pap = 1 AND a.tip = 'CAS' AND a.nbs is null AND a.dazs is null AND a.kv = :nZKv 
    AND a.kv = t.kv 
    AND a.acc = o.acc(+) AND a.acc = o2.acc(+) 
  ORDER BY 3", TBL_FillAll )
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SetRowColor(hWndForm, colCOstc)
.head 6 -  Call SetRowColor(hWndForm, colCOstb)
.head 6 +  If colCOstc != colCOstb 
.head 7 -  Call XSalTblSetCellBackColor(colCOstc, SalColorFromRGB(255, 230, 230))
.head 7 -  Call XSalTblSetCellBackColor(colCOstb, SalColorFromRGB(255, 230, 230))
.head 5 +  On SAM_User	! Распределение
.head 6 +  If SalMessageBox('Распределить между кассирами?', 'Вопрос', MB_YesNo | MB_IconQuestion)=IDYES
.head 7 -  Set bErr = FALSE
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 +  If (colS1 != 0 OR colS2 != 0) AND 
   (colS1 != NUMBER_Null OR colS2 != NUMBER_Null)
.head 9 -  Set nS = Abs(IifN(colS1=NUMBER_Null, 0, colS1)) - 
         Abs(IifN(colS2=NUMBER_Null, 0, colS2))
.head 9 +  If nS != 0
.head 10 +  If nS > 0
.head 11 -  Set sNlsA = colCNls
.head 11 -  Set sNmsA = colCNms
.head 11 -  Set sNlsB = sZNls
.head 11 -  Set sNmsB = sZNms
.head 11 -  Set sNazn = 'Распред. между кассирами'
.head 11 -  Set nS    = nS*SalNumberPower(10, nZDig)
.head 11 -  ! Call cDoc.SetDoc( 0, sCasR, 1, nVob, '', dBD, dBD, dBD, dBD,
     colCNls, colCNms, sMFO, sNB, nZKv, nS*SalNumberPower(10, nZDig), sOKPO,
     sZNls,   sZNms,   sMFO, sNB, nZKv, nS*SalNumberPower(10, nZDig), sOKPO,
     'Распред. между кассирами', '', GetIdOper(), '', NUMBER_Null, 0)
.head 10 +  Else
.head 11 -  Set sNlsA = sZNls
.head 11 -  Set sNmsA = sZNms
.head 11 -  Set sNlsB = colCNls
.head 11 -  Set sNmsB = colCNms
.head 11 -  Set sNazn = 'Списание с кассиров'
.head 11 -  Set nS    = Abs(nS*SalNumberPower(10, nZDig))
.head 10 -  Call cDoc.SetDoc( 0, sCasR, 1, nVob, '', dBD, dBD, dBD, dBD,
     sNlsA, sNmsA, sMFO, sNB, nZKv, nS, sOKPO,
     sNlsB, sNmsB, sMFO, sNB, nZKv, nS, sOKPO,
     sNazn, '', GetIdOper(), '', NUMBER_Null, 0)
.head 10 +  If NOT cDoc.oDoc()
.head 11 -  Set bErr = TRUE
.head 11 -  Break
.head 10 -  Call SaveInfoToLog('CAS. ' || sNazn || ': Ref=>' || Str(cDoc.m_nRef) || ' CNls=>' || colCNls || ' S=>' || SalStrTrimX(Dig4((nS/100),nZDig,2)) || '(' || Str(nZKv) || ')')
.head 7 +  If bErr
.head 8 -  Call SqlRollback( hSql() )
.head 7 +  Else
.head 8 -  Call SalMessageBox('Распределение завершено.', '', 0)
.head 8 -  Call SqlCommit(hSql())
.head 6 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 2 +  Functions
.head 3 +  Function: SetRowColor
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hTblWnd
.head 5 -  Window Handle: hColumnWnd
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nID
.head 5 -  String: sTxt
.head 5 -  Number: nS
.head 5 -  Number: nColor
.head 4 +  Actions
.head 5 -  Set nID = SalTblQueryColumnID(hColumnWnd)
.head 5 -  Call SalTblGetColumnText(hTblWnd, nID, sTxt)
.head 5 -  Set nS = Val(sTxt)
.head 5 +  If nS < 0
.head 6 -  Set nColor = COLOR_Red
.head 5 +  Else If nS > 0
.head 6 -  Set nColor = COLOR_DarkBlue
.head 5 +  Else
.head 6 -  Set nColor = COLOR_Black
.head 5 -  Call SalTblSetCellTextColor(hColumnWnd, nColor, FALSE)
.head 5 -  Call SalTblSetColumnText(hTblWnd, nID, Str(Abs(nS)))
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  String: sCasR
.head 3 -  Number: nVob
.head 3 -  Number: nUId
.head 3 -  Date/Time: dBD
.head 3 -  String: sMFO
.head 3 -  String: sNB
.head 3 -  String: sOKPO
.head 3 -  ! Boolean: bErr
.head 3 -  ! Number: nRow
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  !
.head 3 -  Number: nZAcc
.head 3 -  Number: nZKv
.head 3 -  String: sZNls
.head 3 -  String: sZNms
.head 3 -  Number: nZDig
.head 3 -  Number: nKasAcc
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSetWindowText(hWndForm, sApdVersion || 'Распределение между кассирами')
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set sCasR = GetGlobalOption('CAS_R')
.head 4 +  If sCasR
.head 5 +  If NOT SqlPrepareAndExecute(hSql(), "SELECT vob INTO :nVob FROM tts_vob WHERE tt=:sCasR")
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set nVob = 6
.head 4 +  Else
.head 5 -  Call MessageErrorEx('Ошибка: не описана внутр. операция для распределения между кассирами.')
.head 5 -  Call SalSendMsg(pbExit, SAM_Click, 0, 0)
.head 5 -  Return TRUE
.head 4 -  !
.head 4 -  Set nUId  = GetUserId()
.head 4 -  Set dBD   = GetBankDate()
.head 4 -  Set sMFO  = GetBankMfo()
.head 4 -  Set sNB   = GetBankName()
.head 4 -  Set sOKPO = GetBankOkpoS()
.head 4 -  !
.head 4 -  Set hWndForm.Frm_CasR.nFlags = GT_ReadOnly
.head 4 -  Set hWndForm.Frm_CasR.strSqlPopulate = 
"SELECT unique z_acc, z_nls, z_nms, z_ostc, z_ostb, kv, lcv, dig, 
        kas_acc, kas_nls, kas_nms, kas_ostc, kas_ostb
   INTO :hWndForm.tblZCas.colZAcc,  :hWndForm.tblZCas.colZNls, :hWndForm.tblZCas.colZNms, 
        :hWndForm.tblZCas.colZOstc, :hWndForm.tblZCas.colZOstb, 
        :hWndForm.tblZCas.colZKv,   :hWndForm.tblZCas.colZLcv, :hWndForm.tblZCas.colZDig, 
        :hWndForm.tblZCas.colKasAcc, :hWndForm.tblZCas.colKasNls, :hWndForm.tblZCas.colKasNms,
        :hWndForm.tblZCas.colKasOstc, :hWndForm.tblZCas.colKasOstb
   FROM v_casr_z
  WHERE z_isp in (" || GetSubstListId(nUId,TRUE) || ")" || IifS(strPar02="", "", " AND (" || strPar02 || ")") || " 
  ORDER BY z_nms"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Form Window: Frm_CasP
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.head 2 -  Class: cGenericTableSpl
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Подбор кассира
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.31"
.head 4 -  Top:    0.625"
.head 4 -  Width:  10.4"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.893"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Подбор кассира
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbReject
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_out.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Вернуть отправителю'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( tbl, UM_HotDocuments, 0, 0 )
.head 4 +  Pushbutton: pbPDoc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.657"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Unform.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перераспределить документы'
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(Dlg_CasPDoc, hWndMDI, Grp, sCasTt)
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 -  !
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.557"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = ''
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.3"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.414"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = ''
.head 4 -  Line
.head 5 -  Resource Id: 27094
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  1.171"
.head 6 -  Begin Y:  0.021"
.head 6 -  End X:  1.171"
.head 6 -  End Y:  0.438"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.729"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.157"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.586"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.014"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 27095
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  3.571"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  3.571"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  ! ctb_pbGetValue: pb_Stop
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.071"
.head 6 -  Top:    0.063"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: Q:\BARS98\RESOURCE\BMP\Apply.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +                 Message Actions 
.head 6 +                 On SAM_Create
.head 7 -                 Set strTip='Без кассира'
.head 6 +                 On SAM_Click
.head 7 +                 If SalTblAnyRows(tbl, ROW_Selected, 0)
.head 8 +                 If SalMessageBox( 'Снять с подбора К/С ?', 'Вопрос', MB_YesNo | MB_IconQuestion )=IDYES
.head 9 +                 If SqlPrepareAndExecute( hSql(),
  "UPDATE operw SET value='-1' where tag='CAS_A'and ref=:tbl.colRef")
.head 10 -                 Call SqlCommit(hSql())
.head 9 +                 Else 
.head 10 -                 Call SqlRollback(hSql())
.head 9 -                 Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 4 -  ! Line
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.286"
.head 6 -  Begin Y:  0.438"
.head 6 -  End X:  5.286"
.head 6 -  End Y:  0.021"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pb_Run
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.714"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(tbl, ROW_Selected, 0)
.head 8 +  If SalTblAnyRows(tbl2, ROW_Selected, 0)
.head 9 -  Call SalSendMsg(tbl2, UM_DoubleClick, 0, 0)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Оплатить отмеченные документы'
.head 4 -  Line
.head 5 -  Resource Id: 27096
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  4.243"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  4.243"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.357"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Background Text: Отмечено:
.head 5 -  Resource Id: 27097
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.743"
.head 6 -  Top:    0.135"
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfSumSelect
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.3"
.head 7 -  Top:    0.115"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    2.571"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colRef
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
опер
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 15
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLCV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
документа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Д/К
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDateV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.217"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.533"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colIsp
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Исп.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № док
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СК
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNazn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение платежа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKasAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KasAcc
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDigA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.533"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! Column: colDigB
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.533"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colZAcc
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Acc завкассой
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colKAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Acc контрсчета
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nls контрсчета
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strFW
.head 5 -  String: strPopulate
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 6 -  Set strFW = cF.GetFilterWhereClause(TRUE)
.head 6 -  Set strFW = IifS(strFW='',""," AND " || strFW) || IifS(strPar02='',"", " AND " || strPar02)
.head 6 -  Set strPopulate = 
"select unique oper.ref, oper.tt, oper.nls, oper.kas_kv, t.lcv, oper.vdat,
        oper.kas_s/power(10,t.dig), oper.dk, oper.userid,
        oper.nd, oper.sk, oper.nazn, kas_acc, t.dig, k_acc, k_nls
   into :hWndForm.tbl.colRef, :hWndForm.tbl.colTt, :hWndForm.tbl.colNLS, 
        :hWndForm.tbl.colKV, :hWndForm.tbl.colLCV, :hWndForm.tbl.colDateV, 
        :hWndForm.tbl.colS, :hWndForm.tbl.colDk, :hWndForm.tbl.colIsp, 
        :hWndForm.tbl.colND, :hWndForm.tbl.colSK, :hWndForm.tbl.colNazn, 
        :hWndForm.tbl.colKasAcc, :hWndForm.tbl.colDigA, :hWndForm.tbl.colKAcc, :hWndForm.tbl.colKNls
   from v_casp_doc oper, tabval t
  where oper.kas_kv = t.kv
    and oper.nextvisagrp = :sNextVisaGrp 
    and oper.chk_id = :Grp
    and " || IifS(nPar=1, "oper.z_isp in (" || GetSubstListId(nUserId,TRUE) || ")", "oper.m_isp = :nUserId") || strFW || " 
  order by oper.ref"
.head 6 -  Call SalTblPopulate(hWndForm, cMain.hSql(), T(strPopulate), TBL_FillAll)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 6 -  Set dfSumSelect = NUMBER_Null
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_FetchRowDone
.head 6 -  ! Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If colDk = 0
.head 7 -  Call SalTblSetCellTextColor(colS, COLOR_Blue, TRUE)
.head 6 +  Else
.head 7 -  Call SalTblSetCellTextColor(colS, COLOR_Red, TRUE)
.head 5 +  On WM_LbuttonUp
.head 6 -  Set dfSumSelect = SalTblColumnSum(hWndForm, SalTblQueryColumnID(colS), ROW_Selected, 0)
.head 5 +  On SAM_TblDoDetails
.head 6 -  Set nKasAcc = colKasAcc
.head 6 -  Set nKasKv  = colKV
.head 6 -  Set sKNls   = colKNls
.head 6 -  ! Set nZAcc   = colZAcc
.head 6 -  Call SalSendMsg(tbl2, UM_Populate, 0, 0)
.head 5 +  ! On UM_HotDocuments
.head 6 +  If SalTblQueryRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Selected)
.head 7 +  If SalMessageBox('Вернуть ' || SalNumberToStrX(colS,2) || ' ' || colLCV || ' плательщику ?', 'Вопрос', MB_YesNo | MB_IconQuestion) = IDYES
.head 8 -  Call WaitCursorOn()
.head 8 -  Set bOk = FALSE
.head 8 -  Set sErrTxt = STRING_Null
.head 8 +  While TRUE       !! Средства - возвращаем, документ блокируем
.head 9 +  If not Pay_Bck(colRef, 5, '')
.head 10 -  Set sErrTxt = 'Ош. при вызове pay_bck'
.head 10 -  Break 
.head 9 -  ! -----
.head 9 +  If not SqlPrepareAndExecute(hSql(), 
"INSERT INTO operw(ref,tag,value) 
 VALUES (:colRef, 'BACKR', 'Повернено на подборi касира.')")
.head 10 -  Set sErrTxt = 'Невозможно изменить назначение платежа в OPERW'
.head 10 -  Break 
.head 9 -  ! -----
.head 9 +  If not SqlPrepareAndExecute(hSql(), "UPDATE operw SET value='-1' WHERE ref=:colRef AND tag='CAS_A'")
.head 10 -  Set sErrTxt = 'Невозможно обновить TAG CAS_A'
.head 10 -  Break 
.head 9 -  Set nTmp = 3
.head 9 -  Set Grp = GetGlobalOptionEx('BACKVISA')
.head 9 -  ! в OPER изменяем поле chk
.head 9 +  ! If not SqlPLSQLCommand(hSql(), "chk.PUT_NOS(colRef,Grp)")
.head 10 -  Set sErrTxt = 'Невозможно поставить визу'
.head 10 -  Break 
.head 9 -  ! -----
.head 9 -  ! подпись
.head 9 +  If GetGlobalOptionEx( 'VISASIGN' ) AND GetSignOn()!=0	! подпись 
.head 10 +  If cDoc.SetDocR(colRef, TRUE)
.head 11 -  ! Подписываем...
.head 11 -  Set strKeyId = GetIdOper( )
.head 11 +  If GetGlobalOptionEx('INTSIGN')=2
.head 12 +  If NOT cDoc.LockCheckSignStore(tbl.colRef,Grp,nTmp)
.head 13 -  Call SqlRollback( hSql() )
.head 13 -  Break 
.head 12 +  Else 
.head 13 -  Call SqlCommitEx( hSql(), 'Возврат с подбора кассира. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
.head 11 +  Else 
.head 12 +  If cDoc.sDocVisa(  )
.head 13 -  ! в OPER изменяем поле chk
.head 13 +  If not SqlPLSQLCommand(hSql(), "chk.PUT_NOS(colRef,Grp)")
.head 14 -  Set sErrTxt = 'Невозможно поставить визу'
.head 14 -  Break 
.head 13 -  Call SqlSetLongBindDatatype( 6, BLOB_BYTE )
.head 13 +  If SqlPrepareAndExecute(hSql(), "
 INSERT INTO oper_visa (ref, dat, userid, groupid, status, keyid, sign) 
 VALUES (:tbl.colRef,sysdate,:nUserId,:Grp,:nTmp,:strKeyId,:cDoc.m_lsSign)")
.head 14 -  ! Наконец-то commit
.head 14 -  Call SqlCommitEx( hSql(), 'Возврат с подбора кассира. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
.head 13 +  Else 
.head 14 -  Set sErrTxt = 'Невозможно выполнить INSERT INTO oper_visa'
.head 14 -  Break 
.head 12 +  Else 
.head 13 -  Call Debug('Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!')
.head 13 -  Call SaveErrorToLog( 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!' )
.head 13 -  Break 
.head 10 +  Else 
.head 11 -  Call Debug('Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!')
.head 11 -  Call SaveErrorToLog( 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!' )
.head 11 -  Break 
.head 9 +  Else 
.head 10 -  ! в OPER изменяем поле chk
.head 10 +  If not SqlPLSQLCommand(hSql(), "chk.PUT_NOS(colRef,Grp)")
.head 11 -  Set sErrTxt = 'Невозможно поставить визу'
.head 11 -  Break 
.head 10 +  If SqlPrepareAndExecute(hSql(), 
"INSERT INTO oper_visa (ref, dat, userid, groupid, status) 
 VALUES (:tbl.colRef,sysdate,:nUserId,:Grp,:nTmp)")
.head 11 -  ! Наконец-то commit
.head 11 -  Call SqlCommitEx( hSql(), 'Возврат с подбора кассира. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
.head 9 -  ! -----
.head 9 -  Set bOk = TRUE
.head 9 -  Break 
.head 8 +  If bOk
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SaveFInfoToLog('Док Реф:#' ||SalNumberToStrX(tbl.colRef,0)||' возвращен.')
.head 8 +  Else 
.head 9 -  Call SqlRollback(hSql())
.head 9 +  If sErrTxt
.head 10 -  Call MessageErrorEx(sErrTxt || '. Док #:' ||SalNumberToStrX(tbl.colRef,0))
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 8 -  Call SalWaitCursor(FALSE)
.head 6 -  Set dfSumSelect = NUMBER_Null
.head 5 +  On UM_HotDocuments
.head 6 +  If SalTblQueryRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Selected)
.head 7 +  If SalMessageBox('Вернуть ' || SalNumberToStrX(colS,2) || ' ' || colLCV || ' плательщику ?', 'Вопрос', MB_YesNo | MB_IconQuestion) = IDYES
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  ! Set bOk = FALSE
.head 8 -  ! Set sErrTxt = STRING_Null
.head 8 +  ! While TRUE       !! Средства - возвращаем, документ блокируем
.head 9 +  If not Pay_Bck(colRef, 5, '')
.head 10 -  Set sErrTxt = 'Ош. при вызове pay_bck'
.head 10 -  Break 
.head 9 -  ! -----
.head 9 +  If not SqlPrepareAndExecute(hSql(), 
"INSERT INTO operw(ref,tag,value) 
 VALUES (:colRef, 'BACKR', 'Повернено на подборi касира.')")
.head 10 -  Set sErrTxt = 'Невозможно изменить назначение платежа в OPERW'
.head 10 -  Break 
.head 9 -  ! -----
.head 9 +  If not SqlPrepareAndExecute(hSql(), "UPDATE operw SET value='-1' WHERE ref=:colRef AND tag='CAS_A'")
.head 10 -  Set sErrTxt = 'Невозможно обновить TAG CAS_A'
.head 10 -  Break 
.head 9 -  Set nTmp = 3
.head 9 -  Set Grp = GetGlobalOptionEx('BACKVISA')
.head 9 -  ! в OPER изменяем поле chk
.head 9 +  ! If not SqlPLSQLCommand(hSql(), "chk.PUT_NOS(colRef,Grp)")
.head 10 -  Set sErrTxt = 'Невозможно поставить визу'
.head 10 -  Break 
.head 9 -  ! -----
.head 9 -  ! подпись
.head 9 +  If GetGlobalOptionEx( 'VISASIGN' ) AND GetSignOn()!=0	! подпись 
.head 10 +  If cDoc.SetDocR(colRef, TRUE)
.head 11 -  ! Подписываем...
.head 11 -  Set strKeyId = GetIdOper( )
.head 11 +  If GetGlobalOptionEx('INTSIGN')=2
.head 12 +  If NOT cDoc.LockCheckSignStore(tbl.colRef,Grp,nTmp)
.head 13 -  Call SqlRollback( hSql() )
.head 13 -  Break 
.head 12 +  Else 
.head 13 -  Call SqlCommitEx( hSql(), 'Возврат с подбора кассира. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
.head 11 +  Else 
.head 12 +  If cDoc.sDocVisa(  )
.head 13 -  ! в OPER изменяем поле chk
.head 13 +  If not SqlPLSQLCommand(hSql(), "chk.PUT_NOS(colRef,Grp)")
.head 14 -  Set sErrTxt = 'Невозможно поставить визу'
.head 14 -  Break 
.head 13 -  Call SqlSetLongBindDatatype( 6, BLOB_BYTE )
.head 13 +  If SqlPrepareAndExecute(hSql(), "
 INSERT INTO oper_visa (ref, dat, userid, groupid, status, keyid, sign) 
 VALUES (:tbl.colRef,sysdate,:nUserId,:Grp,:nTmp,:strKeyId,:cDoc.m_lsSign)")
.head 14 -  ! Наконец-то commit
.head 14 -  Call SqlCommitEx( hSql(), 'Возврат с подбора кассира. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
.head 13 +  Else 
.head 14 -  Set sErrTxt = 'Невозможно выполнить INSERT INTO oper_visa'
.head 14 -  Break 
.head 12 +  Else 
.head 13 -  Call Debug('Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!')
.head 13 -  Call SaveErrorToLog( 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!' )
.head 13 -  Break 
.head 10 +  Else 
.head 11 -  Call Debug('Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!')
.head 11 -  Call SaveErrorToLog( 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!' )
.head 11 -  Break 
.head 9 +  Else 
.head 10 -  ! в OPER изменяем поле chk
.head 10 +  If not SqlPLSQLCommand(hSql(), "chk.PUT_NOS(colRef,Grp)")
.head 11 -  Set sErrTxt = 'Невозможно поставить визу'
.head 11 -  Break 
.head 10 +  If SqlPrepareAndExecute(hSql(), 
"INSERT INTO oper_visa (ref, dat, userid, groupid, status) 
 VALUES (:tbl.colRef,sysdate,:nUserId,:Grp,:nTmp)")
.head 11 -  ! Наконец-то commit
.head 11 -  Call SqlCommitEx( hSql(), 'Возврат с подбора кассира. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
.head 9 -  ! -----
.head 9 -  Set bOk = TRUE
.head 9 -  Break 
.head 8 +  If DocumentStorno(colRef, 5, NUMBER_Null, Grp, 0)
.head 9 -  Call SqlPrepareAndExecute(hSql(), "update operw set value = 'Повернено на подборi касира' where ref = :colRef and tag = 'BACKR'")
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SaveFInfoToLog('Док Реф:#' ||SalNumberToStrX(tbl.colRef,0)||' возвращен.')
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 +  ! If sErrTxt
.head 10 -  Call MessageErrorEx(sErrTxt || '. Док #:' ||SalNumberToStrX(tbl.colRef,0))
.head 8 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 8 -  Call SalWaitCursor(FALSE)
.head 6 -  Set dfSumSelect = NUMBER_Null
.head 5 -  On SAM_EndCellTab
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 27
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    2.571"
.head 6 -  Width:  12.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.679"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: System Window Color
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 500
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colCAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ID
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
кассира
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 15
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ID
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCOstc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
фактический
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCOstb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
плановый
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strDSql
.head 5 -  String: sFilt
.head 5 -  Number: nCheck
.head 5 -  Number: nS
.head 4 +  Message Actions
.head 5 +  On UM_Create
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 5 +  On UM_Populate
.head 6 -  Set strDSql = 
"SELECT c.c_acc, c.c_nls, c.c_nms, c.kv, c.c_ostc, c.c_ostb 
   INTO :colCAcc, :colCNls, :colCNms, :colCKv, :colCOstc, :colCOstb 
   FROM v_casp_c c, accounts a
  WHERE c.kas_acc = :nKasAcc and c.kv = :nKasKv
    and c.z_acc = a.acc and a.isp = :nUserId
  ORDER BY c.c_nms"
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), T(strDSql), TBL_FillAll)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If colCOstc != colCOstb
.head 7 -  Call SalTblSetCellTextColor(colCOstb, COLOR_DarkGreen, TRUE)
.head 6 +  Else
.head 7 -  Call SalTblSetCellTextColor(colCOstb, COLOR_Black, TRUE)
.head 5 +  On UM_DoubleClick
.head 6 +  If SalMessageBox('Через ' || colCNls || ' ' || colCNms||' ?', 'Вопрос', MB_YesNo | MB_IconQuestion) = IDYES
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(tbl, nRow)
.head 8 -  ! Проверим достоверность информации...
.head 8 +  If SqlPrepareAndExecute(hSql(), 
"SELECT count(*) INTO :nCheck FROM oper 
 WHERE ref=:tbl.colRef AND ref IN (SELECT ref FROM ref_que) AND sos BETWEEN 0 AND 3 AND nextvisagrp = :sNextVisaGrp" )
.head 9 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 9 +  If NOT nCheck
.head 10 -  Call SalMessageBeep(MB_IconStop)
.head 10 -  Call SalMessageBox('Информация в таблице устарела! (REF ' || Str(tbl.colRef) || ') 
Рекомнедуем регулярно обновлять ее.', 'Нарушение технологии', MB_IconStop | MB_Ok)
.head 10 -  Break
.head 8 +  Else
.head 9 -  Break
.head 8 -  !
.head 8 +  If nKasKv = colCKv
.head 9 -  Set bOk = FALSE
.head 9 -  Set sErrTxt = STRING_Null
.head 9 +  While TRUE
.head 10 +  If GetGlobalOptionEx( 'VISASIGN' ) AND GetSignOn() != 0	! Проверка подписи n-1
.head 11 -  ! Проверим подпись
.head 11 -  ! если не верна, то выдать сообщение и 
  вернуть документ на предыдущий уровень??
.head 11 -  Call cDoc.SetDocR( tbl.colRef, FALSE )
.head 11 +  If GetGlobalOptionEx('INTSIGN')!=2
.head 12 +  If NOT cDoc.CheckDocSign( 'CUR', 0 )
.head 13 +  Select Case cDoc.m_nSignErrType
.head 14 +  Case 1
.head 15 -  Call SaveErrorToLog( 'Виза группы ' || SalNumberToStrX(Grp,0) ||
': Неверная подпись на документе [Ref=' || SalNumberToStrX(tbl.colRef, 0) || ']!' )
.head 15 -  Break
.head 14 +  Case 2
.head 15 -  Call SaveErrorToLog( 'Виза группы ' || SalNumberToStrX(Grp,0) ||
': Неверная подпись предыдущей группы визирования [Ref=' || SalNumberToStrX(tbl.colRef, 0) || ']!' )
.head 15 -  Call SalMessageBeep( MB_IconStop )
.head 15 +  If SalMessageBox( 'Подпись предыдущей группы визирования неверна! ' || PutCrLf() ||
        ' Возвратить документ на повторное визирование?' ,
	'Ошибка!', MB_IconStop | MB_YesNo | MB_DefButton1 ) = IDYES
.head 16 +  If SqlPrepareAndExecute(hSql(), 'UPDATE oper SET chk=substr(chk, 1, length(rtrim(chk))-6) WHERE ref=:tbl.colRef') AND
   SqlPrepareAndExecute(hSql(), 'DELETE FROM oper_visa WHERE sqnc = (SELECT max(sqnc) FROM oper_visa WHERE ref=:tbl.colRef)')
.head 17 -  Call SqlCommitEx( hSql(), 'Возврат документа на повторное визирование. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
.head 16 +  Else
.head 17 -  Call SqlRollback( hSql() )
.head 15 -  Break
.head 14 +  Default
.head 15 -  Call Debug(SalNumberToStrX(cDoc.m_nSignErrType, 0) || 'Нерасчетный код возврата!')
.head 15 -  Break
.head 13 -  Break
.head 10 -  !
.head 10 -  Set nS = tbl.colS*SalNumberPower(10,tbl.colDigA)
.head 10 +  If not SqlPLSQLCommand(hSql(), 
"PAYTT(nFlg, tbl.colRef, GetBankDate(), sCasTt, tbl.colDk,
   nKasKv, sKNls,   nS,
   nKasKv, colCNls, nS)")
.head 11 -  Set sErrTxt = 'выполнить проводку ' || sCasTt
.head 11 -  Break
.head 10 +  If not SqlPrepareAndExecute(hSql(), "UPDATE operw SET value=:colCNls WHERE ref=:tbl.colRef AND tag='CAS_A'" )
.head 11 -  Set sErrTxt = 'вставить TAG CAS_A'
.head 11 -  Break
.head 10 +  If not SqlPrepareAndExecute(hSql(), 
"declare
   l_ref   number;
   l_tag   varchar2(5);
   l_value varchar2(200);
   l_val   varchar2(200);
 begin
   l_ref:= " || Str(tbl.colRef) || ";
   l_tag:= 'CAS_P';
   l_value:= '" || Str(nUserId) || "';
   select value into l_val from operw where ref = l_ref and tag = l_tag;
   update operw set value = l_value where ref = l_ref and tag = l_tag;
 exception when no_data_found then
   insert into operw(ref, tag, value)
   values (l_ref, l_tag, l_value);
 end;")
.head 11 -  Set sErrTxt = 'вставить TAG CAS_P'
.head 11 -  Break
.head 10 -  ! подпись
.head 10 -  ! Добавить в историю виз OPER_VISA, 
  nTmp=1-только визировал,  nTmp=2-оплатил по факту.
.head 10 -  Set nTmp = nFlg + 1
.head 10 +  ! If GetGlobalOptionEx( 'VISASIGN' ) AND GetSignOn()!=0	! подпись 
.head 11 +  If cDoc.SetDocR( tbl.colRef, TRUE )
.head 12 -  ! Подписываем...
.head 12 -  Set strKeyId = GetIdOper( )
.head 12 +  If cDoc.sDocVisa(  )
.head 13 -  Call SqlSetLongBindDatatype( 6, BLOB_BYTE )
.head 13 +  If SqlPrepareAndExecute(hSql(), "
 INSERT INTO oper_visa (ref, dat, userid, groupid, status, keyid, sign) 
 VALUES (:tbl.colRef,sysdate,:nUserId,:Grp,:nTmp,:strKeyId,:cDoc.m_lsSign)")
.head 14 -  ! Наконец-то commit
.head 14 -  Call SqlCommitEx( hSql(), 'Подбор кассира. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
.head 13 +  Else 
.head 14 -  Set sErrTxt = 'Невозможно выполнить INSERT INTO oper_visa'
.head 14 -  Break 
.head 12 +  Else 
.head 13 -  Call Debug('Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!')
.head 13 -  Call SaveErrorToLog( 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!' )
.head 13 -  Break 
.head 11 +  Else 
.head 12 -  Call Debug('Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!')
.head 12 -  Call SaveErrorToLog( 'Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!' )
.head 12 -  Break 
.head 10 +  ! Else
.head 11 +  If SqlPrepareAndExecute(hSql(), "
 INSERT INTO oper_visa (ref, dat, userid, groupid, status) 
 VALUES (:tbl.colRef,sysdate,:nUserId,:Grp,:nTmp)")
.head 12 -  ! Наконец-то commit
.head 12 -  Call SqlCommitEx( hSql(), 'Подбор кассира. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
.head 10 +  If GetGlobalOptionEx('VISASIGN') AND GetSignOn() != 0	! подпись
.head 11 +  If cDoc.SetDocR(tbl.colRef, TRUE)
.head 12 -  ! Подписываем...
.head 12 -  Set strKeyId = GetIdOper( )
.head 12 +  If GetGlobalOptionEx('INTSIGN') = 2
.head 13 +  If NOT cDoc.LockCheckSignStore(tbl.colRef,Grp,nTmp)
.head 14 -  Break
.head 12 +  Else
.head 13 -  ! Дописать в поле CHK след 6 байт о новой визе
.head 13 +  If NOT SqlPLSQLCommand(hSql(), "chk.PUT_NOS(tbl.colRef,Grp)")
.head 14 -  Set sErrTxt = 'Невозможно поставить визу'
.head 14 -  Break
.head 13 +  If NOT cDoc.sDocVisa(  )
.head 14 -  Call Debug('Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!')
.head 14 -  Call SaveErrorToLog('CAS. Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!' )
.head 14 -  Break
.head 13 -  Call SqlSetLongBindDatatype( 6, BLOB_BYTE )
.head 13 +  If NOT SqlPrepareAndExecute(hSql(),
"INSERT INTO oper_visa (ref, dat, userid, groupid, status, keyid, sign)
 VALUES (:tbl.colRef,sysdate,:nUserId,:Grp,:nTmp,:strKeyId,:cDoc.m_lsSign)")
.head 14 -  Set sErrTxt = 'Невозможно выполнить INSERT INTO oper_visa'
.head 14 -  Break
.head 11 +  Else
.head 12 -  Call Debug('Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!')
.head 12 -  Call SaveErrorToLog('CAS. Виза группы ' || SalNumberToStrX(Grp,0) || ': Не удалось подписать операцию!' )
.head 12 -  Break
.head 10 +  Else
.head 11 -  ! Дописать в поле CHK след 6 байт о новой визе
.head 11 +  If NOT SqlPLSQLCommand(hSql(), "chk.PUT_NOS(tbl.colRef,Grp)")
.head 12 -  Set sErrTxt = 'Невозможно поставить визу'
.head 12 -  Break
.head 11 +  If NOT SqlPrepareAndExecute(hSql(),
"INSERT INTO oper_visa (ref, dat, userid, groupid, status)
 VALUES (:tbl.colRef,sysdate,:nUserId,:Grp,:nTmp)")
.head 12 -  Set sErrTxt = 'Невозможно выполнить INSERT INTO oper_visa'
.head 12 -  Break
.head 10 -  Set bOk = TRUE
.head 10 -  Break
.head 9 +  If bOk
.head 10 -  Call SqlCommit( hSql() )
.head 9 +  Else
.head 10 -  Call SqlRollback( hSql() )
.head 10 +  If sErrTxt
.head 11 -  Call MessageErrorEx('Ошибка: Невозможно ' || sErrTxt || '.')
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 6 -  Set dfSumSelect = NUMBER_Null
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar		! 1-для завкассы, 4-для мат.відп.особи
.head 3 -  Number: Grp 		! № спец.группы визирования - ПОДБОР КС
.head 3 -  String: strPar01	! счет завкассой
.head 3 -  String: strPar02	! доп. условие
.head 2 +  Window Variables
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  !
.head 3 -  String: sCasTt
.head 3 -  Number: nFlg
.head 3 -  String: sNextVisaGrp
.head 3 -  Number: nUserId
.head 3 -  String: strKeyId
.head 3 -  Number: nRow
.head 3 -  String: sErrTxt
.head 3 -  Boolean: bOk
.head 3 -  String: sTmp
.head 3 -  Number: nTmp
.head 3 -  !
.head 3 -  Number: nKasAcc
.head 3 -  Number: nKasKv
.head 3 -  String: sKNls
.head 3 -  ! Number: nZAcc
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  ! Доч.операция(подбор кассира) для основной
.head 4 -  Set sCasTt = GetGlobalOption('CASTT')
.head 4 +  If NOT sCasTt
.head 5 -  Set sErrTxt = 'Не описана транзакция для подбора кассира'
.head 5 -  Call MessageErrorEx( 'Ошибка: ' || sErrTxt || '.' )
.head 5 -  Call SalSendMsg(hWndForm, UM_Close, 0, 0)
.head 5 -  Return TRUE
.head 4 +  If NOT SqlPrepareAndExecute(hSql(), "SELECT substr(flags,38,1) INTO :nFlg FROM tts WHERE tt=:sCasTt")
or NOT SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Set sErrTxt = 'Не известен счет для оплаты'
.head 5 -  Call MessageErrorEx( 'Ошибка: ' || sErrTxt || '.' )
.head 5 -  Call SalSendMsg(hWndForm, UM_Close, 0, 0)
.head 5 -  Return TRUE
.head 4 -  !
.head 4 -  Set sNextVisaGrp = NumberToHexSX(Grp)
.head 4 -  Set nUserId = GetUserId()
.head 4 -  !
.head 4 -  Set hWndForm.Frm_CasP.nFlags = GT_NoDel | GT_NoUpd
.head 4 -  Set hWndForm.Frm_CasP.strFilterTblName = 'OPER'
.head 4 -  Set hWndForm.Frm_CasP.strPrintFileName = 'CASDOC'
.head 4 -  Set hWndForm.Frm_CasP.nTabInstance1 = 1
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_DoubleClick
.head 4 +  If Not SalIsNull(tbl.colRef)
.head 5 -  Call DocViewContentsEx(hWndForm, tbl.colRef)
.head 1 +  Dialog Box: Dlg_CasPDoc
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Перераспределение документов
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.94"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Перераспределение документов
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 9113
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.357"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 9114
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  3.886"
.head 6 -  Begin Y:  0.427"
.head 6 -  End X:  3.886"
.head 6 -  End Y:  0.01"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.029"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(tbl, SAM_User, 0, 0)
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.467"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 9115
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  5.014"
.head 6 -  Begin Y:  0.427"
.head 6 -  End X:  5.014"
.head 6 -  End Y:  0.01"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.914"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Подробная информация для строки таблицы'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(tbl, UM_DoubleClick, 0, 0)
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colRef
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф. док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
опер.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
кассира
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNMS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
счета кассира
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Д/К
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLCV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNazn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СК
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colIsp
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Исп.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, colRef)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, colTt)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, colNLS)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, colNMS)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, colRef)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, colRef)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If colDk = 0
.head 7 -  Call SalTblSetCellTextColor(colS, COLOR_Blue, TRUE)
.head 6 +  Else
.head 7 -  Call SalTblSetCellTextColor(colS, COLOR_Red, TRUE)
.head 5 +  On UM_DoubleClick
.head 6 +  If Not SalIsNull(colRef)
.head 7 -  Call DocViewContentsEx(hWndForm, colRef)
.head 5 +  On SAM_User
.head 6 +  If SalMessageBox('Вы уверены, что хотите перераспределить
отмеченные документы?', 'Вопрос', MB_YesNo|MB_IconQuestion ) = IDYES
.head 7 -  Set sErrTxt = ''
.head 7 -  Set nNextRow = TBL_MinRow
.head 7 -  !
.head 7 +  While SalTblFindNextRow(hWndForm, nNextRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nNextRow)
.head 8 -  ! Проверим достоверность информации...
.head 8 +  If SqlPrepareAndExecute(hSql(), 
"SELECT count(*) INTO :nCheck FROM oper 
 WHERE ref=:tbl.colRef AND ref IN (SELECT ref FROM ref_que) AND sos BETWEEN 0 AND 3"  )
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If NOT nCheck
.head 10 -  Call SalMessageBeep(MB_IconStop)
.head 10 -  Call SalMessageBox('Информация в таблице устарела! (REF '|| Str(tbl.colRef) ||') 
Рекомнедуем регулярно обновлять ее.', 'Нарушение технологии', MB_IconStop | MB_Ok)
.head 10 -  Break
.head 8 +  Else
.head 9 -  Break
.head 8 -  !
.head 8 +  If NOT SqlPLSQLCommand(hSql(), 
"PAYTT(0,tbl.colRef,GetBankDate(),sCasTt,1-tbl.colDk,
   tbl.colKV,tbl.colNLSB,tbl.colS*100,
   tbl.colKV,tbl.colNLS, tbl.colS*100)" )
.head 9 -  Set sErrTxt = 'Не удалось выполнить обратную проводку ' || sCasTt
.head 9 -  Break
.head 8 +  If NOT SqlPrepareAndExecute(hSql(), 
"UPDATE operw SET value=0 WHERE ref=:tbl.colRef AND tag='CAS_A'" )
.head 9 -  Set sErrTxt = 'Не удалось обновить TAG CAS_A'
.head 9 -  Break
.head 8 -  !
.head 8 +  If NOT SqlPrepareAndExecute(hSql(), 
"UPDATE oper SET chk=rpad(substr(chk,1,instr(chk,:sUserChk)-1),70,' ')  
 WHERE ref=:tbl.colRef")
.head 9 -  Set sErrTxt = 'Не удалось выполнить UPDATE oper.chk'
.head 9 -  Break
.head 8 +  If NOT SqlPrepareAndExecute(hSql(), 
"DELETE FROM opldok WHERE ref=:tbl.colRef AND tt=:sCasTt")
.head 9 -  Set sErrTxt = 'Не удалось выполнить обратную проводку ' || sCasTt
.head 9 -  Break
.head 8 +  If NOT SqlPrepareAndExecute(hSql(), 
"DELETE FROM oper_visa 
  WHERE ref=:tbl.colRef 
    AND sqnc>=(SELECT max(sqnc) FROM oper_visa WHERE ref=:tbl.colRef AND passive IS NULL AND groupid=:Grp)")
.head 9 -  Set sErrTxt = 'Не удалось удалить визы из истории виз'
.head 9 -  Break
.head 8 -  !
.head 8 +  If SqlPrepareAndExecute(hSql(), 
'INSERT INTO oper_visa (ref, dat, userid, groupid, status, passive) 
 VALUES (:tbl.colRef, SYSDATE, :nUserId, :Grp, 0, 1)')
.head 9 -  Call SqlCommitEx(hSql(), 'CAS. Перераспределение документов. Ref = ' || SalNumberToStrX(tbl.colRef, 0))
.head 7 +  If sErrTxt != ''
.head 8 -  Call SqlRollback( hSql() )
.head 8 -  Call MessageErrorEx(sErrTxt || '. Ref' || SalNumberToStrX(tbl.colRef,0))
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: Grp
.head 3 -  String: sCasTt
.head 2 +  Window Variables
.head 3 -  Number: nUserId
.head 3 -  String: sCasVisa
.head 3 -  String: sUserChk
.head 3 -  Number: nCheck
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  String: strKeyId
.head 3 -  Number: nNextRow
.head 3 -  String: sErrTxt
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set nUserId  = GetUserId()
.head 4 -  Set sCasVisa = SalStrRightX('00' || NumberToHexSX(Grp), 2)
.head 4 -  Set sUserChk = sCasVisa || SalStrRightX('0000' || NumberToHexSX(nUserId), 4)
.head 4 -  Set hWndForm.Dlg_CasPDoc.nFlags = GT_ReadOnly
.head 4 -  Set hWndForm.Dlg_CasPDoc.strFilterTblName = "OPER"
.head 4 -  Set hWndForm.Dlg_CasPDoc.strPrintFileName = "PDOC"
.head 4 -  Set hWndForm.Dlg_CasPDoc.nTabInstance = 1
.head 4 -  Set hWndForm.Dlg_CasPDoc.strSqlPopulate = 
"SELECT OPER.ref, OPER.tt, a2.nls, a2.kv, t.lcv, a2.nms, 
        o2.dk, o1.s/100, OPER.nazn, OPER.nd, 
        OPER.userid, OPER.sk, a1.nls 
   INTO :Dlg_CasPDoc.tbl.colRef, :Dlg_CasPDoc.tbl.colTt, :Dlg_CasPDoc.tbl.colNLS, 
        :Dlg_CasPDoc.tbl.colKV,  :Dlg_CasPDoc.tbl.colLCV,:Dlg_CasPDoc.tbl.colNMS,
        :Dlg_CasPDoc.tbl.colDk,  :Dlg_CasPDoc.tbl.colS,  :Dlg_CasPDoc.tbl.colNazn, :Dlg_CasPDoc.tbl.colND, 
        :Dlg_CasPDoc.tbl.colIsp, :Dlg_CasPDoc.tbl.colSK, :Dlg_CasPDoc.tbl.colNLSB
   FROM OPER, tabval t, opldok o1, opldok o2, accounts a1, accounts a2 
  WHERE t.kv = OPER.kv
    AND OPER.sos > 0 AND OPER.sos < 5 
    AND OPER.vdat > bankdate - 3
    AND exists ( SELECT 1 FROM operw WHERE tag = 'CAS_A' AND value <> '0' and ref = OPER.ref )  
    AND exists ( SELECT 1 FROM operw WHERE tag = 'CAS_P' AND value in 
                          ( select to_char(id_whom) from staff_substitute where id_who=:Dlg_CasPDoc.nUserId and date_is_valid(date_start, date_finish, null, null)=1
                             union all
                            select to_char(:Dlg_CasPDoc.nUserId) from dual ) and ref = OPER.ref )
    AND OPER.currvisagrp = :sCasVisa 
    AND OPER.ref = o1.ref AND o1.ref = o2.ref AND o1.tt = o2.tt AND o2.tt = :Dlg_CasPDoc.sCasTt 
    AND o1.acc = a1.acc AND o2.acc = a2.acc AND a1.pap = 2 AND a2.pap = 1 
  ORDER BY OPER.ref"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 -  !
.head 1 +  Table Window: CH1
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Покрытие по обналиченным чекам
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.763"
.head 4 -  Top:    0.771"
.head 4 -  Width:  15.25"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.095"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    0.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.183"
.head 6 -  Top:    0.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.683"
.head 6 -  Top:    0.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.183"
.head 6 -  Top:    0.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 20165
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  7.25"
.head 6 -  Begin Y:  0.071"
.head 6 -  End X:  7.25"
.head 6 -  End Y:  0.536"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.683"
.head 6 -  Top:    0.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.183"
.head 6 -  Top:    0.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.183"
.head 6 -  Top:    0.738"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.683"
.head 6 -  Top:    0.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 20166
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  6.583"
.head 6 -  Begin Y:  0.071"
.head 6 -  End X:  6.583"
.head 6 -  End Y:  0.536"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.683"
.head 6 -  Top:    0.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 20167
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Combo Box: cmbKV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  3.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.345"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: 35
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmbKV.Init(hWndItem)
.head 7 -  Call cmbKV.Populate( hSql(), "KV", "LCV || ' ' || NAME", "TABVAL", " WHERE kv in (select kvc from CH_KV) ORDER BY skv " )
.head 7 -  Set nKV = 840
.head 7 -  Call cmbKV.SetSelectById(nKV)
.head 7 -  Call NAS1()
.head 6 +  On SAM_Click
.head 7 -  Set nKV = cmbKV.GetKey( SalListQuerySelection(hWndItem))
.head 7 -  Call NAS1()
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Валюта' )
.head 4 -  !
.head 4 +  Data Field: NLS_9830
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.183"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: OST_9830
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.083"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NMS_9830
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.483"
.head 7 -  Top:    0.071"
.head 7 -  Width:  3.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Data Field: NLS_9831
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.183"
.head 7 -  Top:    0.405"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: OST_9831
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.083"
.head 7 -  Top:    0.405"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NMS_9831
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.483"
.head 7 -  Top:    0.405"
.head 7 -  Width:  3.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Data Field: NLS_9910
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.183"
.head 7 -  Top:    0.738"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: OST_9910
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.083"
.head 7 -  Top:    0.738"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NMS_9910
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.483"
.head 7 -  Top:    0.738"
.head 7 -  Width:  3.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pb_R1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.183"
.head 6 -  Top:    0.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выполнить взятие на учет ( Деб.9830 - Крд.9910 ) '
.head 6 +  On SAM_Click
.head 7 -  Call F_OPL_1()
.head 4 +  Data Field: REF_POS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.683"
.head 7 -  Top:    0.738"
.head 7 -  Width:  3.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Идентификатор посылки' )
.head 4 +  Pushbutton: pb_R2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.183"
.head 6 -  Top:    0.738"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\TOMAIL.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выполнить Формирование посылки ( Деб.9831 - Крд.9830 ) '
.head 6 +  On SAM_Click
.head 7 +  If REF_POS != STRING_Null
.head 8 +  If F_OPL_2()
.head 9 -  Set REF_POS = STRING_Null
.head 7 +  Else
.head 8 -  Call SalMessageBox( 
"Не задан внешний Идентификатор посылки " ,"Внимание, ОШИБКА !",
 MB_IconStop)
.head 4 -  !
.head 4 +  Pushbutton: pb_F1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F1
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BF1.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'История счета'  
.head 6 +  On SAM_Click
.head 7 -  Call Show_Sal_Day_P(ACC1, NLS_9830, nKV, bDat-10, bDat)
.head 4 +  Pushbutton: pb_F2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.405"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F2
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BF2.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'История счета'  
.head 6 +  On SAM_Click
.head 7 -  Call Show_Sal_Day_P(ACC2, NLS_9831, nKV, bDat-10, bDat)
.head 4 +  Pushbutton: pb_F3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.738"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F3
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BF3.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'История счета'  
.head 6 +  On SAM_Click
.head 7 -  Call Show_Sal_Day_P(ACC3, NLS_9910, nKV, bDat-10, bDat)
.head 2 +  Contents
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № 
пп
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
поступ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № чека
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кіл
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call F_S()
.head 3 +  Column: NOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номінал
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call F_S()
.head 3 +  Column: S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
чеків
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 +  If REF1 != NUMBER_Null
.head 7 -  Set S = S100 /100
.head 6 +  Else
.head 7 -  Set S100 = S * 100
.head 3 +  Column: S100
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
чека
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BIC_E
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BIC
емітенту
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.033"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If BIC_E != STRING_Null 
.head 7 -  If SqlPrepareAndExecute( hSql(),
"SELECT substr(name,1,38) INTO :NB_E from CH_BIC WHERE BIC_E =:BIC_E " ) 
and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  !
.head 3 +  Column: NB_E
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Емітент
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Call FunNSIGet('CH_BIC','NAME', sTmp, sTmp1)
.head 6 +  If sTmp != STRING_Null
.head 7 -  Set BIC_E = sTmp
.head 7 -  Set NB_E = sTmp1
.head 7 -  Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(  hWndForm  ),
IifN( ID = NUMBER_Null, ROW_New, ROW_Edited ),  TRUE )
.head 3 +  Column: MFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО для
сплати
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If MFO != STRING_Null and MFO !=aMFO
.head 7 -  If SqlPrepareAndExecute( hSql(),"SELECT nb INTO :NB FROM banks WHERE mfo=:MFO " ) 
and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  !
.head 6 -  Return F_MFO_NLS( MFO, nKV, NLS )
.head 5 +  On SAM_KillFocus
.head 6 +  If MFO = STRING_Null
.head 7 -  Set MFO = aMFO
.head 3 +  Column: TOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
Відділення
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.033"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПІБ отримув.
/Банк-агент
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО 
Банка-
агента
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Set MFO = aMFO
.head 6 -  Call FunNSIGet('CH_1A','MFOA', sTmp, sTmp1)
.head 6 +  If sTmp != STRING_Null
.head 7 -  Set MFOA = sTmp
.head 7 -  Set NB = sTmp1
.head 7 -  Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(  hWndForm  ),
IifN( ID = NUMBER_Null, ROW_New, ROW_Edited ),  TRUE )
.head 5 +  On SAM_Validate
.head 6 +  If MFOA != STRING_Null
.head 7 +  If MFO != aMFO 
.head 8 -  Set MFO =aMFO
.head 8 -  Set MFOA = STRING_Null 
.head 7 +  Else
.head 8 +  If SqlPrepareAndExecute( hSql(),
"SELECT substr(b.nb,1,38) INTO :NB from CH_1a c, banks b 
 WHERE b.mfo=c.mfoa and c.mfoa =:MFOA " ) 
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set MFOA = STRING_Null 
.head 3 +  Column: NAME_TOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва
Відділення
або банку агента)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If MFO != STRING_Null
.head 7 -  Set sTmp = STRING_Null
.head 7 -  Call FunNSIGetFilteredEx
("ALEGRO","NUM","mfo='" ||MFO||"'",  sTmp, TOBO )
.head 7 +  If sTmp != STRING_Null
.head 8 -  Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(  hWndForm  ),
IifN( ID = NUMBER_Null, ROW_New, ROW_Edited ),  TRUE )
.head 8 -  If SqlPrepareAndExecute( hSql(), 
"SELECT decode(:nPap, 0,nls_chk0, 1,nls_chk1, nls_chk), ZKPO, NAMEUKRB 
 INTO :NLS, :OKPO, :NAME_TOBO 
 FROM alegro where num=:TOBO") 
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 3 +  Column: OKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЗКПО для
сплати
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рах для
сплати
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Return F_MFO_NLS( MFO, nKV, NLS )
.head 3 +  Column: REF1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.1
прийому
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.033"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If REF1 > 0
.head 7 -  Call DocViewContentsEx(hWndForm, REF1 )
.head 3 +  Column: NB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Надійшов від
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC_1500
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № пп
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NAS1 ! Разное спрятать - показать
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set REF_POS = STRING_Null
.head 5 +  If SqlPrepareAndExecute( hSql(), 
"SELECT a9910.acc,c.s9910, a9830.acc,c.s9830, a9831.acc,c.s9831, c.name ,
   a9910.ostb/100, a9830.ostb/100, a9831.ostb/100,
   Substr(a9910.nms,1,38), Substr(a9830.nms,1,38), Substr(a9831.nms,1,38)
 INTO :ACC3,:NLS_9910, :ACC1,:NLS_9830, :ACC2,:NLS_9831,:sTmp,
      :OST_9910, :OST_9830,:OST_9831,
      :NMS_9910, :NMS_9830,:NMS_9831
 FROM CH_1s c, accounts a9910, accounts a9830, accounts a9831 
 WHERE c.ids=:nPap 
   and a9910.kv =:nKV and a9910.kv=a9830.kv and a9910.kv=a9831.kv 
   and a9910.nls=c.s9910 and a9830.nls=c.s9830 and a9831.nls=c.s9831"  ) 
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalMessageBox( 
"Ош.параметры вызова для валюты "|| cmbKV ,"Внимание, ОШИБКА !",
 MB_IconStop)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  !
.head 5 -  Call NAS2()
.head 3 +  Function: NAS2 ! Населить таблицу
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sFilter
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sFilter = cF.GetFilterWhereClause( FALSE )
.head 5 -  Set sSql = 
"SELECT CH_1.id, CH_1.fdat, CH_1.nd, CH_1.S/100, CH_1.mfo, CH_1.nls, CH_1.okpo,
        CH_1.ref1,CH_1.kv, b.nb, CH_1.fio, CH_1.bic_e, Substr(s.name,1,38),
        CH_1.nom, ch_1.kol, CH_1.tobo, L.NAMEUKRB, CH_1.mfoA
 INTO :CH1.ID, :CH1.FDAT,:CH1.ND,:CH1.S, :CH1.MFO, :CH1.NLS,  :CH1.OKPO,
      :CH1.REF1,:CH1.KV,:CH1.NB,:CH1.FIO,:CH1.BIC_E,:CH1.NB_E,:CH1.NOM,:CH1.KOL,
      :CH1.TOBO,:CH1.NAME_TOBO, :CH1.MFOA 
 FROM CH_1, banks b, ch_bic s, alegro l 
 WHERE CH_1.ids=:CH1.nPap and ch_1.bic_e= s.bic_e (+)
   and CH_1.tobo = l.num (+) and CH_1.mfo = l.mfo (+)
   and NVL(CH_1.mfoA,CH_1.mfo)  = b.mfo (+)  and CH_1.kv=:nKV and ref2 is NULL " ||
IifS(sFilter=STRING_Null,''," and "||sFilter )|| "
 ORDER BY NVL(CH_1.ref1,0), Nvl(CH_1.mfoA,CH_1.mfo),  CH_1.id "
.head 5 -  Set nI_0 = 0
.head 5 -  Set nI_1 = 0
.head 5 -  Set nI_2 = 0
.head 5 -  Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll)
.head 5 -  ! Итог
.head 5 +  If nI_0 > 0
.head 6 -  Call SalTblDefineSplitWindow ( hWndForm, 1, TRUE)
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
.head 6 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 6 -  Call SalTblSetContext (hWndForm, nRow)
.head 6 -  Set ID  = nI_0
.head 6 -  Set KOL = nI_1
.head 6 -  Set S   = nI_2
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: F_OPL_1 !  оплатить Deb 9830
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 5 -  Number: nRef1
.head 5 -  Number: nS
.head 5 -  Number: nK
.head 5 -  String: sMfo
.head 5 -  String: sMfoA
.head 5 -  String: sNb
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sMfo = '*'
.head 5 -  Set sMfoA = '*'
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( hWndForm, nRow, 0, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 +  If REF1 = NUMBER_Null 
.head 7 +  If sMfo != MFO or sMfoA != MFOA 
.head 8 +  If sMfo !='*' and nS > 0 
.head 9 +  If NOT F_OPL_11(nRef1, nS,nK, sNb  )
.head 10 -  Return FALSE
.head 8 -  Set nS = 0
.head 8 -  Set nK = 0
.head 8 -  Call Ref( nRef1 )
.head 8 -  Set sNb = NB 
.head 8 -  Set sMfo = MFO
.head 8 -  Set sMfoA = MFOA
.head 7 +  If not SqlPrepareAndExecute( hSql(),"Update CH_1 set ref1=:nRef1 where id=:ID" )
.head 8 -  Call SqlRollback( hSql() )
.head 8 -  Return FALSE
.head 7 -  Set nS = nS + S100
.head 7 -  Set nK = nK + IifN( KOL=NUMBER_Null, 1, KOL) 
.head 5 +  If nS > 0 
.head 6 +  If NOT F_OPL_11(nRef1, nS, nK, sNb  )
.head 7 -  Return FALSE
.head 5 -  Call NAS2()
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  Function: F_OPL_11 
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRef1
.head 5 -  Number: nS
.head 5 -  Number: nK
.head 5 -  String: sNb
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNazn
.head 4 +  Actions
.head 5 +  If nS > 0 and nRef1 > 0
.head 6 -  Set sNazn = "Чеки, що отримані від "||sNb
.head 6 -  Call cDoc.SetDoc( nRef1, TT9, 1, nVOB_prixod, Str(nRef1), 
     bDat, bDat, bDat, bDat,
     NLS_9830, NMS_9830, GetBankMfo(),'', nKV, nS, GetBankOkpoS(),
     NLS_9910, NMS_9910, GetBankMfo(),'', nKV, nS, GetBankOkpoS(),
     sNazn,'',GetIdOper(),'',NUMBER_Null, 0)
.head 6 +  If NOT cDoc.iDoc() 
or NOT cDoc.PayV (0, nRef1, bDat, TT9, 1, nKV, NLS_9830, nS, nKV, NLS_9910, nS )
or NOT SqlPrepareAndExecute( hSql(),
  "INSERT into operw(ref,tag,value) values (:nRef1, 'GOLD','Чеки')" ) 
or NOT SqlPrepareAndExecute( hSql(),
  "INSERT into operw(ref,tag,value) values (:nRef1, 'SUMGD',:nK)" ) 
or NOT SqlPrepareAndExecute( hSql(),
  "INSERT into operw(ref,tag,value) values (:nRef1, 'VLASN',:sNb)" ) 
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  Return FALSE
.head 6 -  Call SqlCommitEx( hSql(),sNazn )
.head 5 -  Return TRUE
.head 3 +  Function: F_OPL_2 !  оплатить Deb 9831
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNazn
.head 5 -  Number: nRow
.head 5 -  Number: nS
.head 5 -  Number: nKol
.head 5 -  Number: nRef2
.head 5 -  String: sBic
.head 5 -  String: sName
.head 4 +  Actions
.head 5 -  Set sTmp = STRING_Null
.head 5 -  ! Call FunNSIGetFilteredEx("BIC_ACC","BIC","ACCOUNTS.kv=" || Str(nKV),  sTmp, sBic )
.head 5 -  Call FunNSIGetFilteredEx("BIC_ACC","BIC",
"ACCOUNTS.kv in (select kvp from ch_kv where kvc=" || Str(nKV)|| ")",  sTmp, sBic )
.head 5 +  If sTmp = STRING_Null
.head 6 -  Return FALSE
.head 5 +  If SqlPrepareAndExecute( hSql(), 
"SELECT name INTO :sName FROM sw_banks where bic=:sBic") 
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return FALSE
.head 5 -  Set sNazn = "Вiдправка чекiв в "|| sName || " на загальну суму "
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call Ref( nRef2 )
.head 5 +  If nRef2 > 0
.head 6 -  Set nS = 0
.head 6 -  Set nKol = 0
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow( hWndForm, nRow, 0, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 +  If REF1 >0
.head 8 +  If not SqlPrepareAndExecute( hSql(),"Update CH_1 set ref2 =:nRef2 where id=:ID" )
.head 9 -  Call SqlRollback( hSql() )
.head 9 -  Return FALSE
.head 8 -  Set nS = nS + S100
.head 8 -  Set nKol = nKol + IifN (KOL>0, KOL,1)
.head 6 +  If nS > 0 
.head 7 -  Set sNazn = Subs(
sNazn||
SalNumberToStrX(nS/100,2)||" "|| 
Subs(cmbKV,1,3)||" "||
Str(nKol)||" шт, № "||REF_POS,
1,160)
.head 7 -  Call cDoc.SetDoc( nRef2, TT9, 1, nVOB_rasxod,  Str(nRef2), 
     bDat, bDat, bDat, bDat,
     NLS_9831, NMS_9831, GetBankMfo(),'', nKV, nS, GetBankOkpoS(),
     NLS_9830, NMS_9830, GetBankMfo(),'', nKV, nS, GetBankOkpoS(),
     sNazn,'',GetIdOper(),'',NUMBER_Null, 0)
.head 7 +  If NOT cDoc.iDoc() 
or NOT cDoc.PayV (0, nRef2, bDat, TT9, 1, nKV, NLS_9831, nS, nKV, NLS_9830, nS )
.head 8 -  Call SqlRollback( hSql() )
.head 8 -  Return FALSE
.head 7 +  If NOT SqlPrepareAndExecute(hSql(),
"insert into OPERW (ref,tag,value) values (:nRef2,'NOS_A',:sTmp)" ) 
OR NOT SqlPrepareAndExecute(hSql(),
"insert into OPERW (ref,tag,value) values (:nRef2,'72',:REF_POS)" ) 
or NOT SqlPrepareAndExecute( hSql(),
  "INSERT into operw(ref,tag,value) values (:nRef2, 'GOLD','Чеки')" ) 
or NOT SqlPrepareAndExecute( hSql(),
  "INSERT into operw(ref,tag,value) values (:nRef2, 'SUMGD',:nKol)" ) 
or NOT SqlPrepareAndExecute( hSql(),
  "INSERT into operw(ref,tag,value) values (:nRef2, 'VLASN','Відправка чеків в інобанк')" ) 
.head 8 -  Call SqlRollback( hSql() )
.head 8 -  Return FALSE
.head 7 -  Call SqlCommitEx( hSql(),sNazn )
.head 7 -  Call NAS2()
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  Function: F_S
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If REF1 = NUMBER_Null and KOL > 0 and NOM > 0 and S = NUMBER_Null
.head 6 -  Set S = KOL * NOM 
.head 6 -  Set S100 = S * 100
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  !
.head 3 -  Number: nPap ! Номер папки
.head 3 -  String: sNLS ! Список счетов s9910, s9830, s9831, s3739, s2909 (Уже не надо)
.head 3 -  String: sTT
.head 2 +  Window Variables
.head 3 -  ! Для итогов
.head 3 -  Number: nI_0
.head 3 -  Number: nI_1
.head 3 -  Number: nI_2
.head 3 -  !
.head 3 -  Number: ACC1 
.head 3 -  Number: ACC2 
.head 3 -  Number: ACC3 
.head 3 -  String: TT9
.head 3 -  String: sTmp 
.head 3 -  String: sTmp1
.head 3 -  Number: nZ
.head 3 -  Number: nRef3
.head 3 -  !
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  Number: nUserId 
.head 3 -  Number: nKV
.head 3 -  String: sSql
.head 3 -  String: aMFO
.head 3 -  Date/Time: bDat
.head 3 -  String: sErr
.head 3 -  String: sFilter_Dop
.head 3 -  Number: nVOB_prixod
.head 3 -  Number: nVOB_rasxod
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 +  If SqlPrepareAndExecute( hSql(),"SELECT name INTO :sTmp FROM CH_1s WHERE ids=:nPap "  ) 
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call SalMessageBox( "Ош.код папки "|| Str(nPap),"Внимание, ОШИБКА !", MB_IconStop)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Call SalSetWindowText( hWndForm, 
'Ввод и коррекция реквизитов чеков. Папка № ' || Str(nPap)||' "'|| sTmp ||'"')
.head 4 -  Set nUserId = GetUserId()
.head 4 -  Set aMFO = GetBankMfo()
.head 4 -  Set bDat = GetBankDate()
.head 4 -  !
.head 4 -  ! Set nFlags = GT_NoDel | GT_NoUpd
.head 4 -  Set CH1.strFilterTblName = 'CH_1'
.head 4 -  Set CH1.strPrintFileName = 'CH_1'
.head 4 -  Set CH1.nTabInstance = 1
.head 4 -  Set sFilter_Dop = ''
.head 4 -  Set TT9 = Subs(sTT,1,3)
.head 4 -  Call F_VOB_NB(TT9, nVOB_prixod,nVOB_rasxod  )
.head 4 -  !
.head 4 -  Set CH1.strSqlInsert =
'INSERT into CH_1(ND,S,KV,MFO,NLS,okpo, ids, fio, bic_e, kol, nom,tobo, mfoa ) values 
(:CH1.ND, :CH1.S100, :CH1.nKV,:CH1.MFO,:CH1.NLS,:CH1.OKPO,:CH1.nPap,
 :CH1.FIO,:CH1.BIC_E,:CH1.KOL,:CH1.NOM,:CH1.TOBO, :CH1.MFOA )'
.head 4 -  Set CH1.strSqlUpdate =
'update CH_1 
 set nd=:CH1.ND, S=:CH1.S100, MFO=:CH1.MFO,NLS=:CH1.NLS, okpo=:CH1.OKPO,
    fio=:CH1.FIO,bic_e=:CH1.BIC_E, kol=:CH1.KOL,nom=:CH1.NOM, tobo=:CH1.TOBO, 
   mfoa=:CH1.MFOA 
 where id=:CH1.ID'
.head 4 -  Set CH1.strSqlDelete ="delete from CH_1 where id=:CH1.ID and ref1 is null "
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 3 )
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set S100 = S * 100
.head 4 +  If REF1 > 0
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray ) 
.head 4 -  Set nI_0 = nI_0 + 1 
.head 4 -  Set nI_1 = nI_1 + KOL 
.head 4 -  Set nI_2 = nI_2 + S
.head 4 +  If MFOA != STRING_Null and NAME_TOBO = STRING_Null
.head 5 -  Set NAME_TOBO = NB
.head 3 +  On UM_Populate
.head 4 -  Call NAS2()
.head 1 +  Form Window: CH3
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.head 2 -  Class: cGenericTableSpl
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Посылки чеков и Архив
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.344"
.head 4 -  Width:  17.267"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.964"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.607"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.233"
.head 6 -  Top:    0.726"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    0.738"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 59028
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.983"
.head 6 -  Top:    0.726"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 59029
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.283"
.head 6 -  Top:    1.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 59030
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call tbl.NAS1()
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\FILTER.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Фильтр по реквизитам Посылки'
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter(cF1)
.head 8 -  Call tbl.NAS1()
.head 4 +  Pushbutton: pbFilter2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\FILTER.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Фильтр по реквизитам Чеков с полным показом содержимого посылки'
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter( cF2 )
.head 8 -  Set nFilter = 2
.head 8 -  Call tbl.NAS1()
.head 4 +  Pushbutton: pbFilter22
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\FILTER.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Cyan
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Фильтр по реквизитам Чеков с показом искомых чеков'
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter( cF2 )
.head 8 -  Set nFilter = 22
.head 8 -  Call tbl.NAS1()
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сохранить реквизиты чека по возмещению средств'
.head 6 +  On SAM_Click
.head 7 +  If rb3 AND SalTblAnyRows( CH3.tbl, ROW_Selected, 0 ) 
.head 8 -  Call tbl2.F_EDIT()
.head 8 -  Call tbl2.NAS2()
.head 4 +  Pushbutton: pb_Pokr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\CHKMAIL.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Закрытие пути в целом по посылке'
.head 6 +  On SAM_Click
.head 7 +  If rb3 AND SalTblAnyRows( CH3.tbl, ROW_Selected, 0 ) 
.head 8 -  Set sTmpU = "ref in (select ref1 from nlk_ref where ref2 is null) 
 and nlsB = '" || s1919 || "' 
 and nlsA = '" || tbl.NLS_1500|| "' 
 and kv =  " ||Str(tbl.KV_1500)
.head 8 -  ! Set sTmpU = "ref in (select ref1 from nlk_ref where ref2 is null) 
 and nlsB = '" || s1919 || "' 
 and nlsA = '" || tbl.NLS_1500|| "' 
 and (
s="||Str(tbl.P100)||" and kv="||Str(nKV)||" OR "||Str(nKV)||"<>"||Str(tbl.KV_1500)||"
 ) and kv =  " ||Str(tbl.KV_1500)
.head 8 -  ! Set nRef3 = SalModalDialog(CHD, hWndForm, strTip, sTmpU, nSum3  )
.head 8 -  Set nRef3 = SalModalDialog(CHD, hWndForm, strTip, sTmpU, tbl.S,  nSum3  )
.head 8 +  If nRef3 > 0 and nSum3 > 0
.head 9 +  If tbl2.F_Pokr()
.head 10 -  Set CH3.tbl.REF3 = nRef3
.head 4 +  Pushbutton: pb_Bak
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.783"
.head 6 -  Top:    0.405"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Закрытие пути по 1 чеку (брак)'
.head 6 +  On SAM_Click
.head 7 +  If rb3 
AND SalTblAnyRows( tbl2, ROW_Selected, 0 ) 
AND (tbl2.REF4 =NUMBER_Null or tbl2.REF4 >0)
AND  tbl2.REF5 =NUMBER_Null
.head 8 -  Call tbl2.F_Bak( strTip )
.head 4 +  Pushbutton: pb_Vozm_All
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\SELECT.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Возмещение средств в целом по посылке'
.head 6 +  On SAM_Click
.head 7 +  If rb3 AND SalTblAnyRows( CH3.tbl, ROW_Selected, 0 ) 
.head 8 -  Call tbl2.F_Vozm( 0,strTip)
.head 4 +  Pushbutton: pb_Vozm
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.283"
.head 6 -  Top:    0.405"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\SELECT.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Оплатить (возместить) чек'
.head 6 +  On SAM_Click
.head 7 +  If rb3 AND SalTblAnyRows( tbl2, ROW_Selected, 0 ) and tbl2.REF5 =NUMBER_Null
.head 8 -  Call tbl2.F_Vozm( ROW_Selected,strTip)
.head 4 +  Pushbutton: pb_Poisk_All
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\QUERY.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотр всех необработанных поступлений по валюте'  
.head 6 +  On SAM_Click
.head 7 -  Set sTmpU = "ref in (select ref1 from nlk_ref where ref2 is null) 
 and nlsB = '" || s1919 || "' 
 and nlsA like '1500%' and kv in (select kvp from ch_kv where kvc=" || Str(nKV) || ")"
.head 7 -  Call SalModalDialog(CHD, hWndForm, strTip, sTmpU,0, nSum3  )
.head 4 +  Pushbutton: pb_Archiv
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.783"
.head 6 -  Top:    1.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\CANCEL.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Отправить посылку в архив'  
.head 6 +  On SAM_Click
.head 7 +  If rb3 AND SalTblAnyRows( CH3.tbl, ROW_Selected, 0 ) 
.head 8 +  If tbl.F_Arch(strTip )
.head 9 -  Call tbl.NAS1()
.head 4 -  !
.head 4 +  Pushbutton: pb_Rz_K
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.783"
.head 6 -  Top:    0.738"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\K.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Расчет комисии по чекам выбранной посылки'
.head 6 +  On SAM_Click
.head 7 +  If rb3 AND SalTblAnyRows( CH3.tbl, ROW_Selected, 0 ) 
.head 8 -  Call tbl2.F_Kom(0,0,strTip )
.head 4 +  Pushbutton: pb_Vz_K
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.283"
.head 6 -  Top:    0.738"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\CHILDS.BMP
.head 5 -  Picture Transparent Color: Cyan
.head 5 -  Image Style: Single
.head 5 -  Text Color: Sky
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Взыскание комисии по чекам выбранной посылки'
.head 6 +  On SAM_Click
.head 7 +  If rb3 AND SalTblAnyRows( CH3.tbl, ROW_Selected, 0 ) 
.head 8 -  Call tbl2.F_Kom(1,0,strTip )
.head 4 -  !
.head 4 -  Frame
.head 5 -  Resource Id: 59031
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    0.738"
.head 6 -  Width:  3.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Square
.head 5 -  Border Style: Drop-Shadow
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: Default
.head 5 -  Background Color: Default
.head 4 +  Radio Button: rb3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Отправленные
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.821"
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call tbl.NAS1()
.head 4 +  Radio Button: rb4
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Архив 
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    1.071"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call tbl.NAS1()
.head 4 +  Combo Box: cmbKV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    0.405"
.head 6 -  Width:  3.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.345"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmbKV.Init(hWndItem)
.head 7 -  Call cmbKV.Populate( hSql(), "KV", "LCV || ' ' || NAME", "TABVAL", " WHERE kv in (select kvc from CH_KV) ORDER BY skv " )
.head 7 -  Set nKV = 840
.head 7 -  Call cmbKV.SetSelectById(nKV)
.head 6 +  On SAM_Click
.head 7 -  Set nKV = cmbKV.GetKey( SalListQuerySelection(hWndItem))
.head 7 -  Call tbl.NAS1()
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Валюта' )
.head 4 -  !
.head 4 +  Data Field: NLS_9910
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If ACC_9910 > 0
.head 8 -  Call Show_Sal_Day_P(ACC_9910, s9910, nKV, bDat-10, bDat)
.head 6 +  On SAM_AnyEdit
.head 7 -  Set NLS_9910 = s9910
.head 4 +  Data Field: NMS_9910
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.283"
.head 7 -  Top:    0.071"
.head 7 -  Width:  2.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: OST_9910
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.683"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Data Field: NLS_9831
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    0.321"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If ACC_9831 > 0
.head 8 -  Call Show_Sal_Day_P(ACC_9831, s9831, nKV, bDat-10, bDat)
.head 6 +  On SAM_AnyEdit
.head 7 -  Set NLS_9831 = s9831
.head 4 +  Data Field: NMS_9831
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.283"
.head 7 -  Top:    0.321"
.head 7 -  Width:  2.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: OST_9831
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.683"
.head 7 -  Top:    0.321"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Data Field: NLS_1919
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    0.571"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If ACC_1919 > 0
.head 8 -  Call Show_Sal_Day_P(ACC_1919, s1919, nKV, bDat-10, bDat)
.head 6 +  On SAM_AnyEdit
.head 7 -  Set NLS_1919 = s1919
.head 4 +  Data Field: NMS_1919
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.283"
.head 7 -  Top:    0.571"
.head 7 -  Width:  2.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: OST_1919
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.683"
.head 7 -  Top:    0.571"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Data Field: NLS_2909
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    0.821"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If ACC_2909 > 0
.head 8 -  Call Show_Sal_Day_P(ACC_2909, s2909, nKV, bDat-10, bDat)
.head 6 +  On SAM_AnyEdit
.head 7 -  Set NLS_2909 = s2909
.head 4 +  Data Field: NMS_2909
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.283"
.head 7 -  Top:    0.821"
.head 7 -  Width:  2.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: OST_2909
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.683"
.head 7 -  Top:    0.821"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Data Field: NLS_1819
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    1.071"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If ACC_1819 > 0
.head 8 -  Call Show_Sal_Day_P(ACC_1819, s1819, nKV, bDat-10, bDat)
.head 6 +  On SAM_AnyEdit
.head 7 -  Set NLS_1819 = s1819
.head 4 +  Data Field: NMS_1819
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.283"
.head 7 -  Top:    1.071"
.head 7 -  Width:  2.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: OST_1819
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.683"
.head 7 -  Top:    1.071"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Data Field: NLS_2809
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    1.321"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If ACC_2809 > 0
.head 8 -  Call Show_Sal_Day_P(ACC_2809, s2809, nKV, bDat-10, bDat)
.head 6 +  On SAM_AnyEdit
.head 7 -  Set NLS_2809 = s2809
.head 4 +  Data Field: NMS_2809
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.283"
.head 7 -  Top:    1.321"
.head 7 -  Width:  2.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: OST_2809
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.683"
.head 7 -  Top:    1.321"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 -  Background Text: Реф-1 (Деб.9830) Прийому
.head 5 -  Resource Id: 2710
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.183"
.head 6 -  Top:    0.095"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dREF1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.383"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Sky
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Реф-1 (Деб.9830) Прийому ' )
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If dREF1 > 0
.head 8 -  Call DocViewContentsEx(hWndForm, dREF1 )
.head 6 +  On SAM_AnyEdit
.head 7 -  Set dREF1 = tbl2.REF1
.head 4 -  Background Text: Реф-2 (Деб.9831) Посилки
.head 5 -  Resource Id: 2711
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.183"
.head 6 -  Top:    0.345"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dREF2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.383"
.head 7 -  Top:    0.321"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Green
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Реф-2 (Деб.9831) Посилки ' )
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If dREF2 > 0
.head 8 -  Call DocViewContentsEx(hWndForm, dREF2 )
.head 6 +  On SAM_AnyEdit
.head 7 -  Set dREF2 = tbl.REF2
.head 4 -  Background Text: Реф-3 (Деб.1500) Покриття банком-корреспондентом
.head 5 -  Resource Id: 2706
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.183"
.head 6 -  Top:    0.595"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dREF3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.383"
.head 7 -  Top:    0.571"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Green
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Реф-3 (Деб.1500) Покриття банком-корреспондентом' )
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If dREF3 > 0
.head 8 -  Call DocViewContentsEx(hWndForm, dREF3 )
.head 6 +  On SAM_AnyEdit
.head 7 -  Set dREF3 = tbl.REF3
.head 4 -  Background Text: Реф-4 (Крд.9831) Закриття дороги 
.head 5 -  Resource Id: 2709
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.183"
.head 6 -  Top:    0.845"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dREF4
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.383"
.head 7 -  Top:    0.821"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Sky
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Реф-4 (Крд.9831) Закриття дороги ' )
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If dREF4 > 0
.head 8 -  Call DocViewContentsEx(hWndForm, dREF4 )
.head 6 +  On SAM_AnyEdit
.head 7 -  Set dREF4 = tbl2.REF4
.head 4 -  Background Text: Реф-5 (бал) Сплати коштів 
.head 5 -  Resource Id: 2708
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.183"
.head 6 -  Top:    1.095"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dREF5
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.383"
.head 7 -  Top:    1.071"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Sky
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Реф-5 (бал) Сплати коштів ' )
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If dREF5 > 0
.head 8 -  Call DocViewContentsEx(hWndForm, dREF5 )
.head 6 +  On SAM_AnyEdit
.head 7 -  Set dREF5 = tbl2.REF5
.head 4 -  Background Text: Реф-6 (бал) Стягнення комісії
.head 5 -  Resource Id: 2707
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.183"
.head 6 -  Top:    1.345"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dREF6
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.383"
.head 7 -  Top:    1.321"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Maize
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Реф-6 (бал) Стягнення комісії ' )
.head 6 +  On VTM_LeftDoubleClick
.head 7 +  If dREF6 > 0
.head 8 -  Call DocViewContentsEx(hWndForm, dREF6 )
.head 6 +  On SAM_AnyEdit
.head 7 -  Set dREF6 = tbl2.REF6
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    2.0"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  16.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.012"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: FDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата 
формування 
посилки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Кіл
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума 
посилки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S100
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
чека
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: REF2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.2 (внеб)
посилки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.283"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF2 > 0
.head 9 -  Call DocViewContentsEx(hWndForm, REF2 )
.head 5 +  Column: IDP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Идетнифікатор
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF2 > 0
.head 9 -  Call DocViewContentsEx(hWndForm, REF2 )
.head 5 +  Column: REF3
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.3 (бал)
покриття
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF3 > 0
.head 9 -  Call DocViewContentsEx(hWndForm, REF3 )
.head 5 +  Column: NMS_1500
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименування банку
по відправці посилки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.367"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLS_1500
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Коррах. 
банку
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV_1500
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
покр 
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ACC_1500
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № пп
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.767"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: P
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума 
покрытия
план(факт)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: P100
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
чека
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: NAS1
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSql1
.head 7 -  String: sFilter
.head 7 -  String: sFilter2
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 +  If rb4
.head 8 -  Call SalHideWindow( pbUpdate )
.head 8 -  Call SalHideWindow( pb_Poisk_All )
.head 8 -  Call SalHideWindow( pb_Pokr )
.head 8 -  Call SalHideWindow( pb_Bak )
.head 8 -  Call SalHideWindow( pb_Vozm_All )
.head 8 -  Call SalHideWindow( pb_Vozm )
.head 8 -  Call SalHideWindow( pb_Archiv )
.head 8 -  Call SalHideWindow( pb_Vz_K )
.head 8 -  Call SalHideWindow( pb_Rz_K )
.head 8 -  Set sRB = " ch_1.SOS = 5"
.head 7 +  Else
.head 8 -  Call SalShowWindow( pbUpdate )
.head 8 -  Call SalShowWindow( pb_Poisk_All )
.head 8 -  Call SalShowWindow( pb_Pokr )
.head 8 -  Call SalShowWindow( pb_Bak )
.head 8 -  Call SalShowWindow( pb_Vozm_All )
.head 8 -  Call SalShowWindow( pb_Vozm )
.head 8 -  Call SalShowWindow( pb_Archiv )
.head 8 -  Call SalShowWindow( pb_Vz_K )
.head 8 -  Call SalShowWindow( pb_Rz_K )
.head 8 -  Set sRB = " (ch_1.SOS is null or ch_1.SOS < 5)"
.head 7 -  Call SalTblReset( CH3.tbl )
.head 7 -  Call SalTblReset( CH3.tbl2 )
.head 7 -  Set sFilter = ''
.head 7 -  Set sFilter = cF1.GetFilterWhereClause( FALSE )
.head 7 -  Set sFilter2 = ''
.head 7 -  Set sFilter2 = cF2.GetFilterWhereClause( FALSE )
.head 7 -  Set sSql1 = 
"SELECT PDAT, ref2, IDP, ref3, nls, nms, KOL, S/100, ACC, KV 
 INTO  :FDAT, :REF2, :IDP, :REF3, :NLS_1500, :NMS_1500, :ND, :S, :ACC_1500, :KV_1500 
 FROM (select a.KV, o.PDAT, C.REF2,
              substr(F_DOP(o.ref,'72'),1,35) IDP, 
              C.REF3, a.NLS, a.NMS, c.KOL, c.S, a.ACC
       from  accounts A, oper o, 
           (select ref2, ref3, count(*) KOL, sum(S) S from CH_1 
            where ids=:nPap and kv =:nKV and ref2 is NOT null and "|| sRB || " 
            group by ref2,ref3 ) C
       where o.ref =C.ref2 and F_DOP(o.ref,'NOS_A')=a.acc  
       ) CH_P 
 WHERE ref2>0 "|| 
IifS ( sFilter = '',"", " and "|| sFilter ) ||
IifS ( sFilter2= '',"", " and ref2 in (select ref2 from CH_1 where "|| sFilter2 || ")" ) || 
" ORDER BY ref2 desc "
.head 7 -  Call SalTblDefineSplitWindow(tbl, 0, FALSE)
.head 7 -  Set nKol = 0
.head 7 -  Call SalTblPopulate( CH3.tbl, hSql(), sSql1, TBL_FillAll )
.head 7 -  Call SalTblSetContext( CH3.tbl, 0)
.head 7 -  Call SalTblSetFocusRow( tbl, 0 )
.head 7 +  If nKol >0 
.head 8 -  Call SalPostMsg( CH3.tbl, SAM_TblDoDetails, 0, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 5 +  Function: F_Arch ! Перемещение в АРХИВ
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: strTip 
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nId
.head 6 +  Actions
.head 7 -  ! Проверим готовность посылки для отправки в архив
.head 7 +  If SqlPrepareAndExecute( hSql(),
 "SELECT id into :nId from ch_1 where ref2=:tbl.REF2 and
 (ref4 is null OR ref5 is null and ref4 > 0 OR ref6 is null)" )
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If SalMessageBox(
'Внимание, Сумма посылки = ' || SalNumberToStrX(tbl.S100/100,2) ,
' Выполнять "Перемещение в АРХИВ" ?' , MB_IconQuestion | MB_YesNo) = IDYES
.head 9 +  If SqlPrepareAndExecute(hSql(), "UPDATE CH_1 set sos=5 where ref2=:tbl.REF2" ) 
and SqlPrepareAndExecute(hSql(),"delete from nlk_ref where ref1=:tbl.REF3" ) 
.head 10 -  Call SqlCommitEx( hSql(),strTip ||" Реф-2 = "||Str(tbl.REF2) )
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  Call SqlRollback( hSql() )
.head 10 -  Return FALSE
.head 7 +  Else
.head 8 -  Call SalMessageBox("Не обработан чек № "||Str(nId),
"Отправка в Архив пока невозможна !", MB_IconStop)
.head 8 -  Return FALSE
.head 4 +  Window Variables
.head 5 -  Number: nKol
.head 5 -  ! String: sSqlP
.head 4 +  Message Actions
.head 5 +  On SAM_TblDoDetails
.head 6 -  Set dREF2 = REF2
.head 6 -  Set dREF3 = REF3
.head 6 +  If nKol > 0
.head 7 -  Call tbl2.NAS2() 
.head 6 +  If REF3 = NUMBER_Null 
.head 7 -  Call SalEnableWindow( pb_Pokr )
.head 7 -  Call SalEnableWindow( pb_Bak )
.head 7 +  If nKV = KV_1500
and SqlPrepareAndExecute( hSqlAux2(), 
   "select Nvl(sum(S),0) into :tbl.P100 from ch_1 where ref2=:tbl.REF2 and nvl(REF4,0) >= 0 ")
and SqlFetchNext(hSqlAux2(), nFetchRes)
.head 8 -  Set tbl.P = tbl.P100/100
.head 8 -  ! Call XSalTblSetCellBackColor( P, COLOR_Green) 
.head 6 +  Else If REF3 > 0 
.head 7 -  Call SalDisableWindow( pb_Pokr )
.head 7 -  Call SalDisableWindow( pb_Bak )
.head 7 +  If SqlPrepareAndExecute( hSqlAux2(), 
  "select s into :tbl.P100 from oper where ref=:tbl.REF3")
and SqlFetchNext(hSqlAux2(), nFetchRes)
.head 8 -  Set tbl.P = tbl.P100/100
.head 8 -  Call XSalTblSetCellBackColor( P, COLOR_Green) 
.head 5 +  On SAM_KillFocus
.head 6 -  Set hWndLost=hWndForm
.head 5 +  On SAM_SetFocus
.head 6 -  Call tbl2.NAS2() 
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set S100 = S * 100
.head 6 -  Set P100 = P * 100
.head 6 -  Set nKol = nKol + 1
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 27
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -5.5"
.head 6 -  Top:    2.155"
.head 6 -  Width:  16.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.31"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Sky
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: ID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № пп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.65"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.533"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
поступл.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № чеку
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KOL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Кол
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.533"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NOM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номинал
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума
чеків
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Set S100 = S * 100
.head 5 +  Column: S100
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
чека
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BIC_E
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BIC
эмитента
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If BIC_E != STRING_Null 
.head 9 -  If SqlPrepareAndExecute( hSql(),
"SELECT substr(name,1,38) INTO :NB_E from sw_banks WHERE bic=:BIC_E " ) 
and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  !
.head 5 +  Column: NB_E
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Емітент
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: MFO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО для
сплати
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If MFO != STRING_Null and MFO !=aMFO
.head 9 -  If SqlPrepareAndExecute( hSql(),"SELECT nb INTO :NB FROM banks WHERE mfo=:MFO " ) 
and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  !
.head 8 -  Return F_MFO_NLS( MFO, nKV, NLS )
.head 5 +  Column: TOBO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
Відділення
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAME_TOBO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва
Відділення
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If MFO != STRING_Null
.head 9 -  Set sTmp = STRING_Null
.head 9 -  Call FunNSIGetFilteredEx
("ALEGRO","NUM","mfo='" ||MFO||"'",  sTmp, TOBO )
.head 9 +  If sTmp != STRING_Null
.head 10 -  Call SalTblSetRowFlags( tbl2, SalTblQueryContext(  tbl2  ),
IifN( ID = NUMBER_Null, ROW_New, ROW_Edited ),  TRUE )
.head 10 -  If SqlPrepareAndExecute( hSql(), 
"SELECT decode(:nPap, 0,nls_chk0, 1,nls_chk1, nls_chk), ZKPO, NAMEUKRB 
 INTO :NLS,:OKPO, :NAME_TOBO 
 FROM alegro where num=:TOBO") 
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Column: FIO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ПІБ отримув.
/Банк-агент
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.217"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: OKPO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ЗКПО для
сплати
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах. для
сплати
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Return F_MFO_NLS( MFO, nKV, NLS )
.head 5 +  Column: REF1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.1 (внеб)
прийому
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF1 > 0
.head 9 -  Call DocViewContentsEx(hWndForm, REF1 )
.head 5 +  Column: REF4
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.4 (внеб)
Закриття дороги
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.15"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF4 != NUMBER_Null
.head 9 -  Call DocViewContentsEx(hWndForm, Abs(REF4 ))
.head 5 +  Column: REF5
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.5 (бал)
сплати коштів
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF5 != NUMBER_Null
.head 9 -  Call DocViewContentsEx(hWndForm, REF5 )
.head 5 +  Column: S_Kom
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума
комісії
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLS_Kom
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах. для
комісії
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Return F_MFO_NLS( MFO, nKV, NLS_Kom )
.head 5 +  Column: REF6
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.6 (бал)
стяг.коміс
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF6 != NUMBER_Null
.head 9 -  Call DocViewContentsEx(hWndForm, REF6 )
.head 5 +  Column: NB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Надійшов з
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.933"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: F_Vozm ! Возмещение средств вcем по посылке или выбранным для rb3
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nTipRow
.head 7 -  String: sOp
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 7 -  String: sMfo
.head 7 -  String: sNls
.head 7 -  String: sNms
.head 7 -  String: sOkpo
.head 7 -  String: TT
.head 7 -  String: sNazn
.head 7 -  Number: nRef5
.head 7 -  Number: nS1
.head 7 -  Number: nP
.head 7 -  Number: nDel
.head 7 -  !
.head 6 +  Actions
.head 7 +  If SalMessageBox( "Вы действительно хотите выполнить "|| sOp || " ?", "Внимание ! ", 
MB_IconQuestion | MB_YesNo) = IDYES
.head 8 -  ! Бал проводка РЕФ 5 по одному
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Set nP = tbl.P * 100
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow(tbl2, nRow, nTipRow, 0)
.head 9 -  Call SalTblSetContext(tbl2, nRow)
.head 9 +  If tbl2.REF5 = NUMBER_Null and ( tbl2.REF4 = NUMBER_Null or tbl2.REF4 > 1) 
AND tbl2.FDAT != DATETIME_Null 
.head 10 -  Set sMfo = IifS( tbl2.MFO = STRING_Null, GetBankMfo(), tbl2.MFO )
.head 10 -  Set sNls = IifS( tbl2.NLS = STRING_Null and sMfo = GetBankMfo(), s2909, tbl2.NLS)
.head 10 -  Set sNms = IifS( tbl2.NLS = STRING_Null, NMSK3b, tbl2.NB )
.head 10 -  Set sOkpo= IifS( tbl2.OKPO= STRING_Null, GetBankOkpoS(), tbl2.OKPO )
.head 10 -  !
.head 10 +  If sMfo = GetBankMfo()
.head 11 -  Set TT = TT1
.head 10 +  Else
.head 11 -  Set TT = TT2k
.head 10 -  Set sNazn =Subs(
"Зарах.коштів по чекам " || tbl2.NB_E ||" № " || tbl2.ND || 
IifS( tbl2.KOL=NUMBER_Null, ""," кіл." || Str(tbl2.KOL) ||" " )||
IifS( tbl2.NOM=NUMBER_Null, ""," ном." || Str(tbl2.NOM)) || " "  || Subs(cmbKV,1,3) || 
" на заг.суму "|| SalNumberToStrX( tbl2.S, 2 )||
IifS( tbl2.NAME_TOBO =STRING_Null, "", " " || tbl2.NAME_TOBO) ||
IifS( tbl2.FIO=STRING_Null,""," для " || tbl2.FIO ), 1, 160)
.head 10 +  If nPap = 0
.head 11 -  Set sNazn =Subs(
"Зарах.коштів по чекам " || tbl2.NB_E ||" № " || tbl2.ND || 
IifS( tbl2.KOL=NUMBER_Null, ""," кіл." || Str(tbl2.KOL) ||" " )||
IifS( tbl2.NOM=NUMBER_Null, ""," ном." || Str(tbl2.NOM)) || " "  || Subs(cmbKV,1,3) || 
" на заг.суму "|| SalNumberToStrX( tbl2.S, 2 )||
IifS( tbl2.FIO=STRING_Null,""," для " || tbl2.FIO ), 1, 160)
.head 10 +  Else If nPap = 1
.head 11 -  Set sNazn =Subs("Зарах.коштів по чекам " || tbl2.NB_E ||" № " || tbl2.ND ||
IifS( tbl2.NOM=NUMBER_Null,""," ном." ||Str(tbl2.NOM))||" "||Subs(cmbKV,1,3)|| 
IifS( tbl2.FIO=STRING_Null,""," для " ||tbl2.FIO ), 1, 160)
.head 10 -  Set nRef5 = NUMBER_Null
.head 10 -  !
.head 10 +  If nKV = tbl.KV_1500
.head 11 -  Set nS1 = tbl2.S * 100 
.head 10 +  Else
.head 11 -  Set nS1 = SalNumberRound( tbl.P * 100 * tbl2.S/tbl.S )
.head 11 -  Set nDel = nP - nS1
.head 11 +  If nDel >0 and nDel < 100 
.head 12 -  Set nS1 = nP 
.head 11 -  Set nP = nP - nS1
.head 10 -  !
.head 10 -  Call cDoc.SetDoc( nRef5, TT, 1, 1, Str(nRef5), bDat, bDat, bDat, bDat,
     NLS_1919, NMS_1919, GetBankMfo(),'', tbl.KV_1500, nS1, GetBankOkpoS(),
     sNls, sNms, sMfo ,'', tbl.KV_1500, nS1, sOkpo ,
     sNazn ,'',GetIdOper(),'',NUMBER_Null, 0)
.head 10 +  If not cDoc.oDoc()
.head 11 -  Call SqlRollback( hSql() )
.head 11 -  Return FALSE
.head 10 -  Set nRef5 = cDoc.m_nRef
.head 10 +  If NOT SqlPrepareAndExecute( hSql(), "Update CH_1 set ref5=:nRef5 where id=:tbl2.ID" )
.head 11 -  Call SqlRollback( hSql() )
.head 11 -  Return FALSE
.head 10 -  Set tbl2.REF5 = nRef5
.head 10 -  Call XSalTblSetCellBackColor( tbl2.REF5, nColO ) 
.head 9 -  !
.head 8 -  Call SqlCommitEx( hSql(),sOp )
.head 8 -  Call SalWaitCursor(FALSE)
.head 7 -  Return TRUE
.head 5 +  Function: NAS2
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSql2
.head 7 -  String: sFilter2
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 +  If tbl.REF2 > 0 and nKV >0 
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Call SalHideWindow( S_Kom )
.head 8 -  Call SalHideWindow( NLS_Kom )
.head 8 -  Call SalHideWindow( REF6 )
.head 8 -  Set sFilter2 = ''
.head 8 -  Set sFilter2 = cF2.GetFilterWhereClause( FALSE )
.head 8 -  Set sSql2 = 
"SELECT CH_1.id,CH_1.fdat,CH_1.nd,CH_1.S/100,CH_1.mfo, CH_1.nls, CH_1.okpo,
   CH_1.ref1,CH_1.ref4, CH_1.ref5, CH_1.kv, b.nb,ch_1.fio, ch_1.bic_e, 
   substr(s.name,1,38), nvl(kol,1), nom, CH_1.TOBO, L.NAMEUKRB, CH_1.ref6
 INTO :ID, :FDAT, :ND, :S, :MFO, :NLS, :OKPO, :REF1,:REF4,:REF5,:KV, :NB, 
      :FIO,:BIC_E,:NB_E, :KOL, :NOM, :TOBO, :NAME_TOBO,:REF6
 FROM CH_1, banks B, ch_bic s, ALEGRO L
 WHERE CH_1.ids=:nPap and nvl(CH_1.mfoA,CH_1.mfo) = b.mfo (+)  and CH_1.kv=:nKV 
 AND CH_1.TOBO = l.num (+) and CH_1.mfo = l.mfo (+)
   and CH_1.ref2=:tbl.REF2 and ch_1.bic_e = s.bic_e (+) and "|| sRB || 
IifS( sFilter2 != '' and nFilter = 22, " and "|| sFilter2, "") ||
" ORDER BY nvl(CH_1.mfoA,CH_1.mfo), CH_1.id"
.head 8 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 8 -  Set nPay = 0
.head 8 -  Call SalDisableWindow( pb_Vozm_All )
.head 8 -  Set nI_0 = 0
.head 8 -  Set nI_1 = 0
.head 8 -  Set nI_2 = 0
.head 8 -  Call SalTblPopulate( tbl2, hSql(), sSql2,TBL_FillAll)
.head 8 +  If nPay = 1
.head 9 -  Call SalEnableWindow( pb_Vozm_All )
.head 8 -  ! Итог
.head 8 +  If nI_0 > 0
.head 9 -  Call SalTblDefineSplitWindow ( tbl2, 1, TRUE)
.head 9 -  Set nRow = SalTblInsertRow( tbl2, TBL_MinRow)
.head 9 -  Call SalTblSetRowFlags(tbl2, nRow, ROW_New, FALSE)
.head 9 -  Call SalTblSetContext (tbl2, nRow)
.head 9 -  Set tbl2.ID  = nI_0
.head 9 -  Set tbl2.KOL = nI_1
.head 9 -  Set tbl2.S   = nI_2
.head 8 -  ! Call SalTblSetLockedColumns( tbl2, 6 )
.head 8 -  Call SalTblSetContext( tbl2, 0)
.head 8 -  Call SalTblSetFocusRow( tbl2, 0 )
.head 8 -  Call SalPostMsg(tbl2, SAM_TblDoDetails, 0, 0)
.head 8 -  Call SalWaitCursor(FALSE)
.head 5 +  Function: F_Kom ! Расчет=0, Взыскание=1 комисии по чекам выбранной посылки
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nMod
.head 7 -  Number: nTipRow
.head 7 -  String: sOp
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 7 -  Number: nS
.head 7 -  Number: nQ
.head 7 -  !
.head 7 -  String: sMfo
.head 7 -  String: sNls
.head 7 -  String: sNms
.head 7 -  String: sOkpo
.head 7 -  String: TT
.head 7 -  String: sNazn
.head 7 -  String: NLS6_GOU_CH
.head 7 -  Number: nRef6
.head 7 -  !
.head 7 -  String: sND
.head 7 -  Date/Time: dND 
.head 7 -  Number: nVob
.head 7 -  Number: nKVP
.head 6 +  Actions
.head 7 -  !
.head 7 -  Call SalShowWindow( S_Kom )
.head 7 -  Call SalShowWindow( NLS_Kom )
.head 7 -  Call SalShowWindow( REF6 )
.head 7 +  If nMod = 1
.head 8 +  If SalMessageBox( "Вы действительно хотите выполнить "|| sOp || " ?", "Внимание ! ", 
MB_IconQuestion | MB_YesNo) != IDYES
.head 9 -  Return TRUE
.head 7 -  ! Бал проводка РЕФ 6 по одному
.head 7 -  Set nKVP = tbl.KV_1500
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tbl2, nRow, nTipRow, 0)
.head 8 -  Call SalTblSetContext(tbl2, nRow)
.head 8 -  Set nRef6 = NUMBER_Null
.head 8 -  ! Call Debug('b')
.head 8 +  If tbl2.REF6 = NUMBER_Null and tbl2.REF4 != NUMBER_Null 
AND tbl2.FDAT != DATETIME_Null 
.head 9 +  If nMod = 0 ! Расчет нормальной ком валюте покрытия
.head 10 -  !
.head 10 +  If BIC_E != STRING_Null and tbl.ACC_1500 != STRING_Null and REF4 > 0 
.head 11 +  If SqlPrepareAndExecute( hSql(),
 "select s into :nS from ch_kom where BIC_e=:BIC_E and kv=:nKV and acc=:tbl.ACC_1500 and ids=:nPap" )
and SqlFetchNext(hSql(), nFetchRes)
.head 12 -  ! If nS > 0 
.head 12 -  Set S_Kom = nS * KOL 
.head 10 -  !
.head 10 +  If TOBO != STRING_Null and NLS_Kom = STRING_Null
.head 11 -  If SqlPrepareAndExecute( hSql(),
 "select nls_chd into :NLS_Kom from alegro where num=:TOBO and mfo=:MFO" )
and SqlFetchNext(hSql(), nFetchRes)
.head 10 -  !
.head 9 +  Else If nMod = 1 ! взыскание  ком валюте покрытия
.head 10 -  ! Call Debug('c')
.head 10 +  If S_Kom >0 and NLS_Kom !=STRING_Null  ! Проводка на взыскание
.head 11 -  Set sMfo = IifS( MFO = STRING_Null, GetBankMfo(), MFO )
.head 11 -  Set sNls = IifS( NLS_Kom = STRING_Null and sMfo = GetBankMfo(), NLS_2809, NLS_Kom)
.head 11 -  Set sNms = Subs( NAME_TOBO || ' '|| NB,1,38) 
.head 11 -  Set sOkpo= IifS( OKPO= STRING_Null, GetBankOkpoS(), OKPO )
.head 11 +  If sMfo = GetBankMfo()
.head 12 -  Set TT = TT1
.head 11 +  Else
.head 12 -  Set TT = TT2d
.head 11 -  !
.head 11 -  ! Call Debug('d')
.head 11 -  Set nVob = 2
.head 11 -  Set nS = S_Kom*100
.head 11 -  Set nQ = 0
.head 11 -  If SqlPrepareAndExecute( hSql(), "select gl.p_icurval(:nKVP,:nS,:bDat) into :nQ from dual" )
and SqlFetchNext(hSql(), nFetchRes)
.head 11 +  If REF4 > 0
.head 12 -  If SqlPrepareAndExecute( hSql(),"select nd, datd into :sND, :dND from oper where ref=:REF5" )
and SqlFetchNext(hSql(), nFetchRes)
.head 12 -  Set sNazn =Subs(
"Списання комісії інобанку за обробку чеків згідно пл.дор.№ "|| 
sND ||" від "|| SalFmtFormatDateTime( dND, 'dd/MM/yyyy') || ", " || NAME_TOBO || FIO,
1,160)
.head 12 -  ! Call Debug('e')
.head 11 +  Else
.head 12 -  Set sNazn =Subs(
"Списання комісії інобанку за обробку несплаченого чеку "||NB_E|| 
" № " || ND || " за рахунок заставної сумми клієнта " || NAME_TOBO || FIO,
1,160)
.head 12 -  ! Set nVob = 6
.head 11 -  ! !!!!
.head 11 +  If nKVP = 840 and nS = 100
.head 12 -  ! При взятии комиссии по коммерческим чекам в валюте USD 
  необходимо взымать комиссию в гривневом еквиваленте по курсу НБУ на текущую дату, 
  только если сумма комиссии равна 1 USD  
.head 12 -  ! 29.11.2011  АТ "Ощадбанк" исп. Анохин А.Б.,тел. 247-8578
.head 12 -  ! См на D:\gou_chek 
.head 12 -  Call cDoc.SetDoc( nRef6, TT, 0, nVob, Str(nRef6), bDat, bDat, bDat, bDat,
     NLS_1819, NMS_1819, GetBankMfo(),'', n980, nQ, GetBankOkpoS(),
     sNls, sNms, sMfo ,'', n980, nQ, sOkpo ,
     sNazn ,'',GetIdOper(),'',NUMBER_Null, 0)
.head 11 +  Else
.head 12 -  Call cDoc.SetDoc( nRef6, TT, 0, nVob, Str(nRef6), bDat, bDat, bDat, bDat,
     NLS_1819, NMS_1819, GetBankMfo(),'', nKVP, nS, GetBankOkpoS(),
     sNls, sNms, sMfo ,'', nKVP, nS, sOkpo ,
     sNazn ,'',GetIdOper(),'',NUMBER_Null, 0)
.head 11 -  ! !!!!
.head 11 -  ! !!!!
.head 11 -  ! Call Debug('f')
.head 11 +  If not cDoc.oDoc()
.head 12 -  Call SqlRollback( hSql() )
.head 12 -  Return FALSE
.head 11 -  Set nRef6 = cDoc.m_nRef
.head 11 -  ! Перенос на дох
.head 11 -  ! Call Debug('g')
.head 11 +  If REF4 > 0
.head 12 -  Set NLS6_GOU_CH = NLS6
.head 12 -  ! 24.09.2007
.head 12 -  ! If SqlPrepareAndExecute( hSql(),
 "select NLS6_GOU_CH into :NLS6_GOU_CH from alegro 
  where num=:TOBO and mfo=:MFO and NLS6_GOU_CH is not null " )
and SqlFetchNext(hSql(), nFetchRes)
.head 12 -  If SqlPrepareAndExecute( hSql(),
 "select NLS6_GOU_CH into :NLS6_GOU_CH from alegro 
  where mfo=:MFO and NLS6_GOU_CH is not null " )
and SqlFetchNext(hSql(), nFetchRes)
.head 12 -  !
.head 12 -  ! 27-10-2010 Закоментировано По Заявке ГОУ
.head 12 +  ! If NOT cDoc.PayTT(0,nRef6,bDat,TT6,1,nKVP,NLS_1819,nS,GetBaseVal(),NLS6_GOU_CH,nQ )
.head 13 -  Call SqlRollback( hSql() )
.head 13 -  Return FALSE
.head 11 -  !
.head 10 +  Else If S_Kom <= 0 AND S_Kom != NUMBER_Null  ! НОЛЬ
.head 11 -  Set nRef6 = 0
.head 11 -  Set S_Kom =0
.head 10 +  If nRef6 != NUMBER_Null
.head 11 +  If NOT SqlPrepareAndExecute( hSql(), "Update CH_1 set ref6=:nRef6 where id=:ID" )
.head 12 -  Call SqlRollback( hSql() )
.head 12 -  Return FALSE
.head 11 -  Set REF6 = nRef6
.head 11 -  ! Call Debug('i')
.head 8 -  !
.head 7 +  If nMod = 1
.head 8 -  Call SqlCommitEx( hSql(),sOp )
.head 8 -  ! Call Debug('j')
.head 7 -  Call SalWaitCursor(FALSE)
.head 5 +  Function: F_EDIT
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( tbl2, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(tbl2, nRow)
.head 8 +  If tbl2.REF4 = NUMBER_Null AND tbl2.FDAT != DATETIME_Null 
.head 9 +  If not SqlPrepareAndExecute( hSql(), 
"Update CH_1 set MFO=:MFO, NLS=:NLS, okpo=:OKPO, fio=:FIO, TOBO=:TOBO where id=:ID " )
.head 10 -  Call SqlRollback( hSql() )
.head 10 -  Return FALSE
.head 9 -  Call SqlCommit( hSql())
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Return TRUE
.head 5 +  Function: F_Bak ! Закрытие пути по 1 чеку (брак) для rb3
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sOp
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sNazn
.head 7 -  Number: nRef4
.head 7 -  String: sMfo
.head 7 -  String: sNls
.head 7 -  String: sNms
.head 7 -  String: sOkpo
.head 7 -  String: TT
.head 7 -  Number: nRef5
.head 6 +  Actions
.head 7 +  If SalMessageBox( "Вы действительно хотите выполнить "|| sOp || " № " || ND || " на сумму=" || SalNumberToStrX(S,2) || " ?", 
"Внимание ! ", 
MB_IconQuestion | MB_YesNo) = IDYES
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 +  If REF4 > 0 
.head 9 -  Set nRef4 = - REF4
.head 8 +  Else
.head 9 -  Set sNazn = sOp || " № " || ND 
.head 9 -  Set nRef4= NUMBER_Null
.head 9 -  Call cDoc.SetDoc( nRef4, TT9, 1, 6, Str(nRef4), bDat, bDat, bDat, bDat,
     NLS_9910, NMS_9910, GetBankMfo(),'', nKV, S100, GetBankOkpoS(),
     NLS_9831, NMS_9831, GetBankMfo(),'', nKV, S100, GetBankOkpoS(),
     sNazn ,'',GetIdOper(),'',NUMBER_Null, 0)
.head 9 +  If not cDoc.oDoc()
.head 10 -  Call SqlRollback( hSql() )
.head 10 -  Return FALSE
.head 9 -  Set nRef4 = - cDoc.m_nRef
.head 8 +  If NOT SqlPrepareAndExecute( hSql(),
 "Update CH_1 set ref4=:nRef4 where id=:ID" )
.head 9 -  Call SqlRollback( hSql() )
.head 9 -  Return FALSE
.head 8 -  ! Инф сообщение
.head 8 -  Set sMfo = IifS( MFO = STRING_Null, GetBankMfo(), MFO )
.head 8 -  Set sNls = IifS( NLS = STRING_Null and sMfo = GetBankMfo(), s2909, NLS)
.head 8 -  Set sNms = IifS( NLS = STRING_Null, NMSK3b, NB )
.head 8 -  Set sOkpo= IifS( OKPO= STRING_Null, GetBankOkpoS(), OKPO )
.head 8 +  If sMfo = GetBankMfo()
.head 9 -  Set TT = TT1
.head 8 +  Else
.head 9 -  Set TT = TT2k
.head 8 -  !
.head 8 -  Set sNazn =Subs(
"Відмова в опл.чеку " || NB_E ||" № " || ND || 
IifS(KOL=NUMBER_Null, ""," кіл."||Str(KOL) ||" " )||
IifS(NOM=NUMBER_Null, ""," ном " ||Str(NOM)) ||
" на заг.суму "|| SalNumberToStrX( S, 2 )|| " "||
IifS(NAME_TOBO=STRING_Null,""," "||NAME_TOBO )||
IifS(FIO=STRING_Null,""," для "||FIO )||
". Про причини несплати буде повідомлено додатково." 
, 1, 160)
.head 8 -  Set nRef5 = NUMBER_Null
.head 8 -  Call cDoc.SetDoc( nRef5, TT, 3, 1, Str(nRef5), bDat, bDat, bDat, bDat,
     NLS_1919, NMS_1919, GetBankMfo(),'', nKV, S100, GetBankOkpoS(),
     sNls, sNms, sMfo ,'', nKV, S100, sOkpo ,
     sNazn ,'',GetIdOper(),'',NUMBER_Null, 0)
.head 8 +  If not cDoc.oDoc()
.head 9 -  Call SqlRollback( hSql() )
.head 9 -  Return FALSE
.head 8 -  Set nRef5 = cDoc.m_nRef
.head 8 +  If NOT SqlPrepareAndExecute( hSql(), "Update CH_1 set ref5=:nRef5 where id=:ID" )
.head 9 -  Call SqlRollback( hSql() )
.head 9 -  Return FALSE
.head 8 -  Set REF5 = nRef5
.head 8 -  ! Call XSalTblSetCellBackColor( tbl2.REF5, nColO ) 
.head 8 -  Call SqlCommitEx( hSql(),sNazn )
.head 8 -  Set tbl2.REF4 = nRef4
.head 8 -  Call XSalTblSetCellBackColor( tbl2.REF4, nColR ) 
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Return TRUE
.head 7 -  !
.head 7 -  Return FALSE
.head 5 +  Function: F_Pokr ! Закрытие пути в целом по посылке для rb3
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRef4
.head 7 -  Number: nS
.head 7 -  Number: nK
.head 7 -  String: sPos
.head 7 -  Date/Time: dPos
.head 7 -  String: sNazn
.head 6 +  Actions
.head 7 +  If SalMessageBox(
'Сумма документа по покрытию = ' || SalNumberToStrX( nSum3/100, 2 )|| ' вал='||Str(tbl.KV_1500)||', 
Сумма посылки = ' || SalNumberToStrX(tbl.S100/100,2)||' вал='||Str(nKV) ,
' Выполнять "Закрытие пути" ?' , MB_IconQuestion | MB_YesNo) = IDYES
.head 8 -  ! Уже НЕ только (Пока только) по совпадению
.head 8 -  ! Вне-Бал проводка РЕФ 4 
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Call Ref( nRef4 )
.head 8 +  If nRef4 > 0
.head 9 +  If SqlPrepareAndExecute( hSql(),"SELECT sum(s), sum(nvl(kol,1)) into :nS,:nK from ch_1 where ref2=:tbl.REF2 and ref4 is null")
and SqlFetchNext(hSql(), nFetchRes) 
and SqlPrepareAndExecute(hSql(),"SELECT nd,datd into :sPos,:dPos from oper where ref=:tbl.REF2") 
and SqlFetchNext(hSql(), nFetchRes) 
and SqlPrepareAndExecute(hSql(),"UPDATE CH_1 set ref3=:nRef3, ref4=Nvl(ref4,:nRef4) where ref2=:tbl.REF2" ) 
.head 10 -  If SqlPrepareAndExecute( hSql(),"SELECT substr(value,1,40) into :sPos from operw where ref=:tbl.REF2 and tag='72'")
and SqlFetchNext(hSql(), nFetchRes) 
.head 10 -  Set sNazn = Subs( 
"Закриття дороги по чекам на загальну суму "|| 
SalNumberToStrX( nS/100, 2 ) ||" " || Subs(cmbKV,1,3) ||
".Кількість "||Str(nK)||" шт. від "|| SalFmtFormatDateTime( dPos,'dd/MM/yyyy' ) ||
" № " ||sPos ,1,160)
.head 10 +  If nS > 0
.head 11 -  Call cDoc.SetDoc( nRef4, TT9, 1, 6, Str(nRef4), bDat, bDat, bDat, bDat,
     NLS_9910, NMS_9910, GetBankMfo(),'', nKV, nS, GetBankOkpoS(),
     NLS_9831, NMS_9831, GetBankMfo(),'', nKV, nS, GetBankOkpoS(),
     sNazn,'',GetIdOper(),'',NUMBER_Null, 0)
.head 11 +  If NOT cDoc.iDoc() 
or NOT cDoc.PayV (0, nRef4, bDat, TT9, 1, nKV, NLS_9910, nS, nKV, NLS_9831, nS )
or NOT SqlPrepareAndExecute(hSql(),
"update nlk_ref set ref2=:nRef4 where ref1=:nRef3" )
.head 12 -  Call SqlRollback( hSql() )
.head 12 -  Return FALSE
.head 10 -  Call SqlCommitEx( hSql(),sNazn  )
.head 9 +  Else
.head 10 -  Call SqlRollback( hSql() )
.head 10 -  Return FALSE
.head 9 -  Set tbl.REF3 = nRef3
.head 9 -  Call tbl2.NAS2()
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Return TRUE
.head 4 +  Window Variables
.head 5 -  Number: nPay
.head 4 +  Message Actions
.head 5 +  On SAM_TblDoDetails
.head 6 -  Set dREF1 = REF1
.head 6 -  Set dREF4 = REF4
.head 6 -  Set dREF5 = REF5
.head 6 -  Set dREF6 = REF6
.head 6 +  If REF4 != NUMBER_Null and REF4 <0 
OR REF4  = NUMBER_Null and REF5 != NUMBER_Null 
OR rb4 
.head 7 -  Call SalDisableWindow( pb_Bak )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( pb_Bak )
.head 6 -  !
.head 6 +  If REF5 != NUMBER_Null or ( REF4 != NUMBER_Null  AND REF4 < 0 )
.head 7 -  Call SalDisableWindow( pb_Vozm )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( pb_Vozm )
.head 5 +  On SAM_KillFocus
.head 6 -  Set hWndLost=hWndItem
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set S100 = S * 100
.head 6 +  If REF4 !=NUMBER_Null AND REF4 > 1 AND REF5 !=NUMBER_Null AND REF5 > 1
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_White )
.head 6 +  Else If REF4 != NUMBER_Null AND REF4 < 1 
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, nColR )
.head 6 +  Else If REF5 !=NUMBER_Null AND REF5 > 1 AND REF4 = NUMBER_Null
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, nColO ) 
.head 6 +  If REF5 =NUMBER_Null 
.head 7 -  Set nPay = 1
.head 6 -  Call XSalTblSetCellBackColor( S_Kom, nColG ) 
.head 6 -  Call XSalTblSetCellBackColor( NLS_Kom, nColG ) 
.head 6 -  Call XSalTblSetCellBackColor( REF6, nColG ) 
.head 6 -  Set nI_0 = nI_0 + 1 
.head 6 -  Set nI_1 = nI_1 + tbl2.KOL 
.head 6 -  Set nI_2 = nI_2 + tbl2.S
.head 2 +  Functions
.head 3 +  Function: NAS0 ! Счета 
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: FL
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sErr = "Ош.счета для проводок !"
.head 5 -  Set FL = 0
.head 5 -  ! 9910
.head 5 +  If SqlPrepareAndExecute( hSql(),  
"SELECT acc,nls,ostb/100,substr(nms,1,38) INTO :ACC_9910,:NLS_9910,:OST_9910,:NMS_9910
 FROM accounts WHERE dazs is null and kv=:nKV and nls=:s9910 " )
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalMessageBox( s9910 || sErr, "Внимание внебалансовый ДЕБЕТ !", MB_IconStop)
.head 6 -  Set NMS_9910 = sErr
.head 6 -  Set FL = 1
.head 5 -  ! 9831
.head 5 +  If SqlPrepareAndExecute( hSql(),  
"SELECT acc,nls,ostb/100,substr(nms,1,38) INTO :ACC_9831,:NLS_9831,:OST_9831,:NMS_9831
 FROM accounts WHERE dazs is null and kv=:nKV and nls=:s9831 " )
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalMessageBox( s9831 || sErr, "Внимание внебалансовый КРЕДИТ !", MB_IconStop)
.head 6 -  Set NMS_9831 = sErr
.head 6 -  Set FL = 1
.head 5 -  ! 1919 - K
.head 5 +  If SqlPrepareAndExecute( hSql(),  
"SELECT acc,nls,ostb/100,substr(nms,1,38) INTO :ACC_1919,:NLS_1919,:OST_1919,:NMS_1919
 FROM accounts WHERE dazs is null and kv=:nKV and nls=:s1919 " )
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalMessageBox( s1919 || sErr, "Внимание балансовый ДЕБЕТ !", MB_IconStop)
.head 6 -  Set NMS_1919 = sErr
.head 6 -  Set FL = 1
.head 5 -  ! 2909 - K
.head 5 +  If SqlPrepareAndExecute( hSql(),  
"SELECT acc,nls,ostb/100,substr(nms,1,38) INTO :ACC_2909,:NLS_2909,:OST_2909,:NMS_2909  
 FROM accounts WHERE dazs is null and kv=:nKV and nls=:s2909 " )
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalMessageBox( s2909 || sErr, "Внимание балансовый КРЕДИТ !", MB_IconStop)
.head 6 -  Set NMS_2909 = sErr
.head 6 -  Set FL = 1
.head 5 -  ! 1819 - D
.head 5 +  If SqlPrepareAndExecute( hSql(),  
"SELECT acc,nls,ostb/100,substr(nms,1,38) INTO :ACC_1819,:NLS_1819,:OST_1819,:NMS_1819  
 FROM accounts WHERE dazs is null and kv=:nKV and nls=:s1819 " )
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalMessageBox( s1819 || sErr, "Внимание балансовый КРЕДИТ !", MB_IconStop)
.head 6 -  Set NMS_1819 = sErr
.head 6 -  Set FL = 1
.head 5 -  ! 2809 - D
.head 5 +  If SqlPrepareAndExecute( hSql(),  
"SELECT acc,nls,ostb/100,substr(nms,1,38) INTO :ACC_2809,:NLS_2809,:OST_2809,:NMS_2809 
 FROM accounts WHERE dazs is null and kv=:nKV and nls=:s2809 " )
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalMessageBox( s2809 || sErr, "Внимание балансовый ДЕБЕТ !", MB_IconStop)
.head 6 -  Set NMS_2809 = sErr
.head 6 -  Set FL = 1
.head 5 -  ! !!!
.head 5 +  If FL = 1
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  !
.head 3 -  Number: nPap ! Номер папки
.head 3 -  String: sPar ! 
.head 3 -  String: sTT
.head 2 +  Window Variables
.head 3 -  ! Для итогов
.head 3 -  Number: nI_0
.head 3 -  Number: nI_1
.head 3 -  Number: nI_2
.head 3 -  !
.head 3 -  Number: ACC_9910 
.head 3 -  Number: ACC_9831 
.head 3 -  Number: ACC_1919 
.head 3 -  Number: ACC_2909 
.head 3 -  Number: ACC_1819
.head 3 -  Number: ACC_2809
.head 3 -  Number: n980
.head 3 -  String: sRB
.head 3 -  Number: nUserId 
.head 3 -  Number: nFilter
.head 3 -  : cF1
.head 4 -  Class: cGenFilter
.head 3 -  : cF2
.head 4 -  Class: cGenFilter
.head 3 -  String: aMFO
.head 3 -  Date/Time: bDat
.head 3 -  String: s9910
.head 3 -  String: s9831
.head 3 -  String: s1919
.head 3 -  String: s2909
.head 3 -  String: s1819
.head 3 -  String: s2809
.head 3 -  String: sTmp
.head 3 -  String: TT9
.head 3 -  String: TT1
.head 3 -  String: TT2k
.head 3 -  String: TT2d
.head 3 -  String: TT6
.head 3 -  String: NLS6
.head 3 -  String: NMSD3b
.head 3 -  String: NMSK3b
.head 3 -  String: sTmpU
.head 3 -  Number: nRef3
.head 3 -  Number: nSum3
.head 3 -  !
.head 3 -  Number: nTmp
.head 3 -  Number: nZ
.head 3 -  String: sNMS
.head 3 -  Number: nKV
.head 3 -  Number: nColR
.head 3 -  Number: nColO
.head 3 -  Number: nColG
.head 3 -  String: sSql
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  Window Handle: hWndLost
.head 3 -  String: sErr
.head 3 -  !
.head 3 -  ! String: strBind
.head 3 -  ! String: strInput
.head 3 -  ! Number: REF
.head 3 -  ! String: NPOS
.head 3 -  ! Date/Time: DPOS
.head 3 -  ! String: BIC
.head 3 -  ! String: NB
.head 3 -  ! String: KVC
.head 3 -  ! String: KVP
.head 3 -  ! String: LORO
.head 3 -  ! String: ND
.head 3 -  ! Number: KOL
.head 3 -  ! Number: NOM
.head 3 -  ! Number: S
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Set nUserId = GetUserId()
.head 4 -  Set aMFO = GetBankMfo()
.head 4 -  Set n980 = GetBaseVal()
.head 4 -  Set bDat = GetBankDate()
.head 4 -  Call cF1.Init('CH_P','CH_P')
.head 4 -  Call cF2.Init('CH_1','CH_1')
.head 4 -  ! Set strBind = 'REF,NPOS,DPOS,BIC,NB,KVC,KVP,LORO,ND,KOL,NOM,S'
.head 4 -  ! Set strInput = strBind
.head 4 +  If SqlPrepareAndExecute( hSql(), 
"SELECT s9910, s9831, s3739, S2909, name, k3739, k2909, tt6, nls6 
 INTO :s9910, :s9831,:s1919,:s2909,:sTmp,:s1819,:s2809,:TT6,:NLS6
 FROM CH_1s where ids=:nPap "  ) 
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call SalMessageBox( 
"Не найдена папка чеков № " || Str(nPap) || " в справочнике CH_1S " ,
"Внимание, ОШИБКА !", MB_IconStop)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Call SalSetWindowText( hWndForm, 
'Посылки чеков и Архив чеков. Папка № ' || Str(nPap)||' "'|| sTmp ||'"')
.head 4 -  Set TT9 = Subs(sTT,1,3)
.head 4 -  Set TT1 = Subs(sTT,5,3)
.head 4 -  Set TT2k = Subs(sTT,9,3)
.head 4 -  Set TT2d = Subs(sTT,13,3)
.head 4 -  Set rb3 = TRUE
.head 4 +  If nMode = 14 ! Только Покpыто (Архив)
.head 5 -  Set rb4 = TRUE
.head 5 -  Call SalDisableWindow( rb3 )
.head 4 +  Else If nMode = 13 ! Только Отправлено
.head 5 -  Call SalDisableWindow( rb4 )
.head 4 -  Set nColR = SalColorFromRGB( 255,240,255 ) 
.head 4 -  Set nColO = SalColorFromRGB( 230,255,230 )
.head 4 -  Set nColG = SalColorFromRGB( 255,255,220) 
.head 4 -  !
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  Call PrepareWindowEx( hWndForm )
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendClassMessage( SAM_CreateComplete, 0, 0 )
.head 4 -  Call NAS0()
.head 4 -  Call tbl.NAS1()
.head 3 +  On SAM_Close
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 2 -  !
.head 1 +  Table Window: PCorps
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Peace Corps - "Корпус Мира" 
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.375"
.head 4 -  Top:    1.719"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 5000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.81"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Data Field: dKv
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.783"
.head 7 -  Top:    0.071"
.head 7 -  Width:  0.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Код валюты' )
.head 4 +  Data Field: dNls_2909
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.483"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Счет Корпуса Мира в '||GetBankName() )
.head 4 +  Data Field: dNms_2909
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.783"
.head 7 -  Top:    0.071"
.head 7 -  Width:  3.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Наименование Корпуса Мира' )
.head 4 +  Data Field: dOst_2909
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.183"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Пл.Остаток на счете Корпуса Мира' )
.head 4 +  Data Field: dOkpo_2909
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.983"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'ОКПО Корпуса Мира' )
.head 4 +  Data Field: d980
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.783"
.head 7 -  Top:    0.405"
.head 7 -  Width:  0.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Код нац.валюты' )
.head 4 +  Data Field: dNls_6114
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.483"
.head 7 -  Top:    0.405"
.head 7 -  Width:  1.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Счет комис.доходов в '||GetBankName() )
.head 4 -  !
.head 4 +  Data Field: nKol
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.183"
.head 7 -  Top:    0.405"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Количество записей в реестре Корпуса Мира' )
.head 4 +  Data Field: nS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.783"
.head 7 -  Top:    0.405"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Общ.Сумма з/п + Комиссии в реестре Корпуса Мира' )
.head 4 +  Data Field: nZ
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.383"
.head 7 -  Top:    0.405"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Сумма з/п в реестре Корпуса Мира' )
.head 4 +  Data Field: nK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.983"
.head 7 -  Top:    0.405"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Сумма Комиссии в реестре Корпуса Мира' )
.head 4 +  Data Field: dRee
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    0.488"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Дата реестра Корпуса Мира' )
.head 4 -  !
.head 4 +  Pushbutton: pb_Dbf
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выполнить Импорт реестра ( PCorpsR.dbf -> таблица БД PCorpsR )'
.head 6 +  On SAM_Click
.head 7 -  Call Imp_Dbf_New(hWndForm,1, 0, 'PCorpsR', '' )
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 4 +  Pushbutton: pb_Run
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выполнить перечисления '
.head 6 +  On SAM_Click
.head 7 -  Call F_OPL( )
.head 4 -  !
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сохранить уточнения справочника платежных инструкций волонтеров'
.head 6 +  On SAM_Click
.head 7 -  Call F_SPRAV( ROW_Edited )
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 4 -  Line
.head 5 -  Resource Id: 9930
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 9931
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 9932
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  0.9"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  0.9"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Combo Box: cmbMES
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.488"
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.964"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? Yes
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? No
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call F_Mes()
.head 6 +  ! On SAM_Click
.head 7 -  Set sD = SalStrLeftX( cmbMES,4)||SalStrMidX( cmbMES, 5, 2)
.head 2 +  Contents
.head 3 +  Column: PR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наличие
в спр
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Фамилия
получателя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.583"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя
получателя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
перечис
з/п
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
перечис
з/п
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If REF > 0
.head 7 -  Call DocViewContentsEx(hWndForm, REF )
.head 3 +  Column: SK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
перечис
комис
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
перечис
комис
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If REFK > 0
.head 7 -  Call DocViewContentsEx(hWndForm, REFK )
.head 3 -  !
.head 3 +  Column: MFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО 
банка 
получателя
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Return F_MFO_NLS( MFO, nKv, NLS )
.head 3 +  Column: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет 
получателя 
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Return F_MFO_NLS( MFO, nKv, NLS )
.head 3 +  Column: OKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО 
получателя
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ADR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Адрес банка 
получателя
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование 
банка получателя
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_SPRAV
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nTipRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSql_I
.head 5 -  String: sSql_U
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sSql_I = 
"INSERT into PCorps (FIO,NAM,ADR,MFO,NLS,OKPO) values (:FIO,:NAM,:ADR,:MFO,:NLS,:OKPO)"
.head 5 -  Set sSql_U = 
"Update PCorps SET ADR=:ADR,MFO=:MFO,NLS=:NLS,OKPO=:OKPO where FIO=:FIO and NAM=:NAM"
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( hWndForm, nRow, nTipRow, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 +  If SqlPrepareAndExecute( hSql(), IifS( PR=1, sSql_I, sSql_U ) )
.head 7 -  Call SqlCommit( hSql() )
.head 6 +  Else
.head 7 -  Call SqlRollback( hSql() )
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  Function: F_OPL !  оплатить 
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNazn
.head 5 -  String: sNazn1
.head 5 -  Number: nRow
.head 5 -  Number: nRef
.head 5 -  Number: nRefK
.head 5 -  String: sNaznK
.head 5 -  String: sNaznK1
.head 5 -  String: TT
.head 5 -  String: NMSB
.head 5 -  Number: nSi
.head 5 -  Number: nSq
.head 5 -  Number: nVob
.head 4 +  Actions
.head 5 +  If dOst_2909 >= nS
.head 6 +  If SalMessageBox("Сумма на счете = " || SalNumberToStrX( dOst_2909, 2 )|| ", 
Сумма в реестре с учетом комиссии= " || SalNumberToStrX(nS,2) ,
" Выполнять перечисление ? ", MB_IconQuestion | MB_YesNo) = IDYES
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  !
.head 7 -  Set sNazn = 'Зарплата волонтеру '  
.head 7 -  Set sNaznK = 'Комісійна винагорода 2% ОУ за виплату з/п волонтеру '
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( hWndForm, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 +  If MFO != STRING_Null and NLS != STRING_Null and OKPO != STRING_Null 
and REF = NUMBER_Null and S>0 
.head 9 +  If MFO = aMFO
.head 10 -  Set TT = TT1
.head 9 +  Else
.head 10 -  Set TT = TT2
.head 9 -  !
.head 9 -  Set NMSB = Subs(FIO||' '||NAM,1,38)
.head 9 -  !
.head 9 -  Set nRef = NUMBER_Null
.head 9 -  Set sNazn1 = sNazn || FIO || ' ' ||NAM || ' за '|| cmbMES || 
' згідно реєстру КМ США від '|| SalFmtFormatDateTime( dRee, 'dd/MM/yyyy')||'.'||ADR ||
' Без комісії для отримувача.'
.head 9 -  Set sNazn1 = Subs(sNazn1,1,160)
.head 9 -  Call cDoc.SetDoc( nRef, TT, 1, 1, Str(nRef), bDat, bDat, bDat, bDat,
     dNls_2909, dNms_2909, aMFO,'', nKv, S*100, dOkpo_2909,
     NLS, NMSB, MFO ,'', nKv, S*100, OKPO ,
     sNazn1,'',GetIdOper(),'',NUMBER_Null, 0)
.head 9 +  If not cDoc.oDoc()
.head 10 -  Call SqlRollback( hSql() )
.head 10 -  Return FALSE
.head 9 -  Set nRef = cDoc.m_nRef
.head 9 -  !
.head 9 -  Set nRefK = NUMBER_Null
.head 9 -  Set sNaznK1 = sNaznK || FIO || ' ' ||NAM || ' за '|| cmbMES || 
' згідно листа КМ США від '|| SalFmtFormatDateTime( dRee, 'dd/MM/yyyy')||'.'
.head 9 -  Set sNaznK1 = Subs(sNaznK1,1,160)
.head 9 -  Set nSi = SK*100
.head 9 +  If MFO = aMFO
.head 10 -  Set nVob = 16
.head 10 +  If SqlPrepareAndExecute( hSql(),
  "SELECT gl.p_Icurval(:nKv,:nSi,:bDat) into :nSq from dual " )
and SqlFetchNext(hSql(), nFetchRes)
.head 11 -  Call cDoc.SetDoc( nRefK, TT6, 1, nVob, Str(nRefK), bDat, bDat, bDat, bDat,
     dNls_2909, dNms_2909,aMFO,'', nKv, nSi, dOkpo_2909,
     dNls_6114, sNms_6114, MFO ,'',d980,nSq, sOkpo_6114,
     sNaznK1,'',GetIdOper(),'',NUMBER_Null, 0)
.head 9 +  Else
.head 10 -  Call cDoc.SetDoc( nRefK, TT, 1, 1, Str(nRefK), bDat, bDat, bDat, bDat,
     dNls_2909, dNms_2909, aMFO,'', nKv, nSi, dOkpo_2909,
     NLS, NB, MFO ,'', nKv, nSi, OKPO ,
     sNaznK1,'',GetIdOper(),'',NUMBER_Null, 0)
.head 9 +  If not cDoc.oDoc()
.head 10 -  Call SqlRollback( hSql() )
.head 10 -  Return FALSE
.head 9 -  !
.head 9 -  Set nRefK = cDoc.m_nRef
.head 9 +  If NOT SqlPrepareAndExecute( hSql(), 
"DELETE from PCorpsR where UPPER(Last_Name)=:FIO and UPPER(First_Name)=:NAM " )
.head 10 -  Call SqlRollback( hSql() )
.head 10 -  Return FALSE
.head 9 -  !
.head 9 -  Set REF = nRef
.head 9 -  Set REFK = nRefK
.head 7 -  Call SqlCommitEx( hSql(),sNazn )
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Return TRUE
.head 5 +  Else
.head 6 -  Call SalMessageBox("Сумма на счете МЕНЬШЕ Суммы в реестре ! " ,
"Внимание ! Перечисление невозможно !", MB_IconStop)
.head 6 -  Return TRUE
.head 3 +  Function: F_Mes
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sD
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  If SqlPrepareAndExecute(hSql(), "
SELECT distinct  to_char(d.fdat,'YYYY-MM')||' ('||m.NAME_PLAIN ||')' 
INTO :sD FROM 
(select fdat from fdat where fdat between add_months(gl.bD,-2) and add_months(gl.bD,2) 
 union all select add_months(gl.bD,1) from dual
 union all select add_months(gl.bD,2) from dual 
 ) d, 
 META_MONTH m WHERE to_char(d.fdat,'MM')+0=m.n
ORDER by 1 desc " )
.head 5 +  While SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalListAdd(cmbMES, sD)
.head 5 -  Call SalListSetSelect(cmbMES, 1)
.head 5 -  Call SalPostMsg(cmbMES, SAM_Click, 0, 0)
.head 5 -  Call SalWaitCursor( FALSE )
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nKv
.head 3 -  String: Str_Nls
.head 3 -  String: sTT
.head 2 +  Window Variables
.head 3 -  String: sFilter
.head 3 -  String: aMFO
.head 3 -  Date/Time: bDat
.head 3 -  Number: nUserId
.head 3 -  Number: nRow
.head 3 -  String: TT1
.head 3 -  String: TT2
.head 3 -  String: TT6
.head 3 -  String: sOkpo_6114
.head 3 -  String: sNms_6114
.head 3 -  Number: nAcc_2909
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  !
.head 3 -  Number: nZap
.head 3 -  Number: nTmp
.head 3 -  String: sTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set nUserId = GetUserId()
.head 4 -  Set aMFO = GetBankMfo()
.head 4 -  Set bDat = GetBankDate()
.head 4 -  Set TT1 = Subs(sTT,1,3)
.head 4 -  Set TT2 = Subs(sTT,5,3)
.head 4 -  Set TT6 = Subs(sTT,9,3)
.head 4 -  Set dRee = bDat 
.head 4 -  !
.head 4 -  ! Расчленим Список счетов 2909,6114
.head 4 -  Set d980 = GetBaseVal()
.head 4 -  Set sTmp = SalStrTrimX( Str_Nls )
.head 4 +  If Len(sTmp) > 0
.head 5 -  Set nZap = At(',', sTmp)
.head 5 +  If nZap > 0
.head 6 -  Set dNls_2909 = SalStrTrimX( Left( sTmp, nZap - 1 ) )
.head 6 -  Set dKv = nKv
.head 6 -  Set dNls_6114 = SalStrTrimX(Right( sTmp, Len(sTmp) - nZap ) )
.head 4 -  !
.head 4 -  Set PCorps.strFilterTblName = 'PCORPS'
.head 4 -  Set PCorps.strPrintFileName = 'PCORPS'
.head 4 -  ! Set PCorps.nTabInstance = 1
.head 4 +  If SqlPrepareAndExecute( hSql(),
"SELECT Substr(a2.nms,1,38), a2.acc, c2.okpo, Substr(a6.nms,1,38), c6.okpo
 INTO :dNms_2909, :nAcc_2909, :dOkpo_2909, :sNms_6114, :sOkpo_6114
 FROM accounts a2, cust_acc u2, customer c2, accounts a6, cust_acc u6, customer c6 
 WHERE a2.kv=:dKv and a2.nls=:dNls_2909 and a2.acc=u2.acc and u2.rnk=c2.rnk and a2.dazs is null 
  and a6.kv=:d980 and a6.nls=:dNls_6114 and a6.acc=u6.acc and u6.rnk=c6.rnk and a6.dazs is null ")
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call SalMessageBox( 
"Не найден счет Корпуса Мира (или дох.банка) из параметров вызова" ,
"Внимание ОШИБКА !",  MB_IconStop )
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 3 )
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  If SqlPrepareAndExecute( hSql(),"SELECT ostB/100 INTO :dOst_2909 FROM accounts WHERE acc=:nAcc_2909 ") 
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 4 -  !
.head 4 -  Set sFilter = ""
.head 4 -  Set sFilter = cF.GetFilterWhereClause( FALSE )
.head 4 -  !
.head 4 -  Set PCorps.strSqlPopulate = "
SELECT PCorps.PR, PCorps.FIO, PCorps.NAM, PCorps.S, 
       PCorps.MFO,PCorps.NLS, PCorps.OKPO,PCorps.ADR, B.NB      
 INTO :PCorps.PR,:PCorps.FIO,:PCorps.NAM,:PCorps.S,
      :PCorps.MFO,:PCorps.NLS, :PCorps.OKPO, :PCorps.ADR, :PCorps.NB
FROM (SELECT 2 PR, S.fio, S.nam, r.TOTAL S, S.mfo, S.nls, S.okpo, S.adr 
      FROM PCorps S, PCorpsR R  WHERE s.FIO=UPPER(r.Last_Name) and s.NAM=UPPER(r.First_Name) 
     union all
      SELECT 1, r.Last_Name, r.First_Name, r.TOTAL, '', '', '', '' 
      FROM PCorpsR R WHERE ( UPPER(r.Last_Name),UPPER(r.First_Name) ) not in (select s.fio,s.nam from PCorps S ) 
     union all
      SELECT 3, s.fio, s.nam, to_number(null), s.mfo, s.nls, s.okpo, s.adr
      FROM PCorps S WHERE (s.FIO,s.NAM) not in (select UPPER(r.Last_Name),UPPER(r.First_Name) from PCorpsR R ) 
) PCorps , banks b WHERE PCorps.MFO = b.MFO (+) " || 
IifS( sFilter="", "", " and  " || sFilter ) || " 
ORDER BY 1, MFO, FIO, NAM " 
.head 4 -  Set nS = 0
.head 4 -  Set nZ = 0
.head 4 -  Set nK = 0
.head 4 -  Set nKol = 0
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), PCorps.strSqlPopulate , TBL_FillAll)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If PR = 1 ! Нет в справочнике - Розовій
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,240,255 )  )
.head 4 +  Else If PR = 2 ! Все хорошо - Зеленій 
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 ) )
.head 4 +  Else If PR = 3 ! Нет в реестре - Голубой
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 220,255,255 ) )
.head 4 +  If PR = 1 or PR = 2 
.head 5 -  Set nKol = nKol + 1
.head 5 -  Set SK = SalNumberRound( S*2) /100
.head 5 -  Set nZ = nZ + S
.head 5 -  Set nK = nK + SK 
.head 5 -  Set nS = nZ + nK
.head 1 +  Dialog Box: CHD
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.063"
.head 4 -  Top:    3.594"
.head 4 -  Width:  13.433"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.048"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 16863
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 16864
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выбрать документ, как покрытие посылки '
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( tbl, ROW_Selected, 0 )
.head 8 -  Set nSum3 = tbl.S100
.head 8 -  Call SalEndDialog( CHD, tbl.REF3 )
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nSum3 = NUMBER_Null
.head 7 -  Call SalEndDialog(hWndForm, 0)
.head 4 -  Line
.head 5 -  Resource Id: 16865
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pb_Doc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотреть документ подробно '
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( tbl, ROW_Selected, 0 )
.head 8 -  Call DocViewContentsEx(hWndForm, tbl.REF3 )
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  13.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: REF3
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата 
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: S100
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сч-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_A
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сч-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_B
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим-Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение пл
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  6.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set nSum3 = tbl.S100
.head 6 -  Call SalEndDialog( CHD, tbl.REF3 )
.head 5 +  On SAM_Create
.head 6 -  Call SalTblPopulate( tbl, hSql(), sSql, TBL_FillAll )
.head 5 +  On SAM_FetchRowDone
.head 6 +  If nS100 = tbl.S100  ! Все хорошо - Зеленій 
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 ) )
.head 6 +  Else ! Нет равенства сумм
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,240,255 )  )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sTitl 
.head 3 -  String: sTmpU 
.head 3 -  Number: nS100
.head 3 -  Receive Number: nSum3
.head 2 +  Window Variables
.head 3 -  String: sSql
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sSql = 
"select REF,PDAT,S/100,S, KV,NLSA, NAM_A,NLSB,NAM_B,NAZN 
 into :REF3,:PDAT,:S, :S100,:KV,:NLSA,:NAM_A,:NLSB,:NAM_B,:NAZN 
 from oper 
 where vdat > Dat_Next_U (gl.bd, -3) and  sos=5 and "|| sTmpU ||" ORDER BY ref desc "
.head 4 -  Call SalSetWindowText( CHD, sTitl )
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 1 +  ! Form Window: HLP
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Расчет процентов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   -0.013"
.head 4 -  Top:    0.052"
.head 4 -  Width:  10.767"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.762"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -  Description: 
.head 2 -  Named Menus 
.head 2 -  Menu 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 +  Pushbutton: pb_Poisk
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    0.238"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Выбрать Ссудный счет'
.head 5 +  On SAM_Click
.head 6 -  Call F_Nls()
.head 6 +  If ACC_SS != NUMBER_Null
.head 7 -  Call SalEnableWindow( pb_OK )
.head 7 -  Call SalSendMsg( pb_OK, SAM_Click, 0, 0 )
.head 3 +  Data Field: NMS_SS
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    0.238"
.head 6 -  Width:  3.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Наименование ссудного счета' )
.head 3 +  Data Field: IR
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.083"
.head 6 -  Top:    0.238"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, '% ставка на '|| SalFmtFormatDateTime( bDat, 'dd/MM/yyyy' ) )
.head 3 +  Data Field: NLS_SS
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.238"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Ссудный счет' )
.head 5 +  On SAM_AnyEdit
.head 6 -  Set ACC_SS = NUMBER_Null
.head 6 -  Call SalEnableWindow( pb_OK )
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp_SS = NLS_SS
.head 3 +  Data Field: KV_SS
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.483"
.head 6 -  Top:    0.238"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код валюты ссудного счета' )
.head 3 +  Data Field: nBasey
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.083"
.head 6 -  Top:    0.571"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код базового года' )
.head 3 +  Data Field: Basey_Name
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.571"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Наименование базового года' )
.head 3 +  Child Table: tbl1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.483"
.head 6 -  Top:    0.655"
.head 6 -  Width:  4.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 366
.head 5 -  Discardable? Yes
.end
.head 4 +  Contents 
.head 5 +  Column: FDAT
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: OST
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ост.на ссуд сч
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.833"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 -  Window Variables 
.head 4 -  Message Actions 
.head 3 +  Data Field: NLS_SN
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    2.905"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Счет начисленных %' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = NLS_SN
.head 5 +  On SAM_AnyEdit
.head 6 -  Set NLS_SN = sTmp
.head 3 +  Data Field: KV_SN
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.483"
.head 6 -  Top:    2.905"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код валюты начисленных %' )
.head 3 -  !
.head 3 +  Pushbutton: pb_OK
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.383"
.head 5 -  Top:    3.238"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Ok.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Расчитать План.Остатки на счете начисленных %'
.head 5 +  On SAM_Click
.head 6 +  If NOT F_Ok()
.head 7 -  Set NLS_SS = sTmp_SS
.head 3 +  Pushbutton: pb_Igr
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.883"
.head 5 -  Top:    3.238"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: C:\bars98\RESOURCE\BMP\A_PROC.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Light Gray
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Расчитать %% в "игровом" режиме'
.head 5 +  On SAM_Click
.head 6 +  If ACC_SS != NUMBER_Null
.head 7 -  Call Sel010( hWndMDI, 0, 1," and s.acc=" || Str(ACC_SS) ," " )
.head 3 +  Pushbutton: pb_Null
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.383"
.head 5 -  Top:    3.238"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: C:\bars98\RESOURCE\BMP\REFRESH.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Очистить'
.head 5 +  On SAM_Click
.head 6 -  Call F_Null()
.head 3 -  !
.head 3 +  Data Field: ACR_DAT
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    3.571"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Дата последнего начисления %' )
.head 3 +  Data Field: OST_SN1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    3.571"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Тек.Остаток на счете начисленных % ' )
.head 3 -  !
.head 3 +  Data Field: bDat
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    3.905"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Текущая банковская Дата ' )
.head 3 +  Data Field: S
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.583"
.head 6 -  Top:    3.905"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Погасить -, Выдать (+) ' )
.head 3 +  Data Field: DOS_SN2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    3.905"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.доначисления % по тек.день' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = DOS_SN2
.head 5 +  On SAM_AnyEdit
.head 6 -  Set DOS_SN2 = nTmp
.head 3 +  Data Field: OST_SN2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    3.905"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.Остаток на счете начисленных % за тек.день' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = OST_SN2
.head 5 +  On SAM_AnyEdit
.head 6 -  Set OST_SN2 = nTmp
.head 3 -  !
.head 3 +  Data Field: DAT3
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    4.238"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Последняя календарная Дата текущего месяца
(или др.контрольная дата) ' )
.head 5 +  On SAM_Validate
.head 6 +  If DAT3 <= bDat
.head 7 -  Set DAT3 = DAT_31
.head 3 +  Data Field: DOS_SN3
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    4.238"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.доначисления % по тек.месяц' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = DOS_SN3
.head 5 +  On SAM_AnyEdit
.head 6 -  Set DOS_SN3 = nTmp
.head 3 +  Data Field: OST_SN3
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    4.238"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'План.Остаток на счете начисленных % за тек.месяц' )
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmp = OST_SN3
.head 5 +  On SAM_AnyEdit
.head 6 -  Set OST_SN3 = nTmp
.head 3 -  !
.head 2 +  Functions 
.head 3 +  Function: F_Null
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set KV_SS = GetBaseVal()
.head 5 -  Set NLS_SS = STRING_Null
.head 5 -  Set NMS_SS = STRING_Null
.head 5 -  Set IR = NUMBER_Null
.head 5 -  !
.head 5 -  Set NLS_SN = STRING_Null
.head 5 -  Set KV_SN = NUMBER_Null
.head 5 -  Set ACR_DAT = DATETIME_Null
.head 5 -  Set OST_SN1 = NUMBER_Null
.head 5 -  Set S = 0
.head 5 -  Set DAT3 = DAT_31
.head 5 -  Set DOS_SN2 = NUMBER_Null
.head 5 -  Set DOS_SN3 = NUMBER_Null
.head 5 -  Set OST_SN2 = NUMBER_Null
.head 5 -  Set OST_SN3 = NUMBER_Null
.head 5 -  Call SalTblReset( tbl1 )
.head 5 -  Call SalDisableWindow( pb_OK )
.head 5 -  Call SalSetFocus( NLS_SS )
.head 3 +  Function: F_Nls
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sTmp1
.head 5 -  String: sTmp
.head 4 +  Actions 
.head 5 -  Set sTmp_SS = NLS_SS
.head 5 -  Set ACC_SS = NUMBER_Null
.head 5 -  Set sTmp = STRING_Null
.head 5 -  ! Выбрать значение из фильтрованого справочника
.head 5 -  Call FunNSIGetFiltered("SALDO","NLS",
" acc in (select acc from int_accn where id=0) and dazs is null ",
sTmp, sTmp1)
.head 5 +  If sTmp != STRING_Null
.head 6 -  Set ACC_SS = Val(sTmp)
.head 6 -  Set NLS_SS = sTmp1
.head 3 +  Function: F_Ok
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nInt
.head 5 -  Number: nInt1
.head 5 -  Number: nInt2
.head 5 -  Number: nInt3
.head 5 -  Number: nRemi
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set nInt3= 0 ! bDat - DAT3
.head 5 -  Set nInt2= 0 ! bDat - bDat
.head 5 -  Set nInt1= 0 ! (ACR_DAT+1) - (bDat-1)
.head 5 -  Set nInt = 0
.head 5 -  ! найти проц. карточку
.head 5 +  If SqlPrepareAndExecute( hSql(),
"SELECT a.ostc,a.acc, a.nms, acrn.FPROCN(a.acc,0,:bDat), a.kv, a.nls, 
       n.nls, n.kv, i.acr_dat, -(n.ostc)/100, i.S
 INTO :OST_SS, :ACC_SS, :NMS_SS, :IR, :KV_SS, :NLS_SS, 
      :NLS_SN, :KV_SN, :ACR_DAT, :OST_SN1, :nRemi
 FROM SALDO a , accounts n, int_accn i
 WHERE " || 
IifS( ACC_SS = NUMBER_Null, "a.nls=:NLS_SS and a.kv=:KV_SS", "a.acc=:ACC_SS") ||
" and i.acc=a.acc and n.acc=i.acra and i.id=0 " )
and NOT SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalMessageBox( "Рахунок не знайдено !", "УВАГА !", MB_IconStop)
.head 6 -  Return FALSE
.head 5 -  ! Населить таблицу остатков по осн.счету
.head 5 -  If SalTblPopulate(tbl1, hSql(),
"SELECT fdat, -ost/100
 INTO :tbl1.FDAT, :tbl1.OST
 FROM sal WHERE  acc=:ACC_SS and fdat>=:ACR_DAT
 ORDER BY fdat desc", TBL_FillAll )
.head 5 -  ! Плановый остаток на тек день с учетом предполагаемого гашения (-) или выдачи (+)
.head 5 -  Set OST_SS = OST_SS - (S * 100)
.head 5 -  ! на тек день уже начислено
.head 5 +  If ACR_DAT >= bDat
.head 6 -  Set OST_SN2 = OST_SN1
.head 6 -  Set DOS_SN2 = 0
.head 5 -  ! досчитать до тек.дня в игровои режиме
.head 5 +  Else 
.head 6 -  ! по факту nInt1: (ACR_DAT+1) - (bDat-1)
.head 6 +  If ACR_DAT < bDat-1
.head 7 -  Set nInt1 = p_intN ( ACC_SS, 0, ACR_DAT+1, bDat-1, NUMBER_Null, 1 ) 
.head 6 -  ! по плану  nInt2: bDat - bDat
.head 6 -  If SqlPrepareAndExecute( hSql(),
"update int_accn set s=0 where acc=:ACC_SS and id=0")
.head 6 -  Set nInt2= p_intN ( ACC_SS, 0, bDat, bDat, OST_SS, 1 )
.head 6 -  Set nInt = nInt1 + nInt2 
.head 6 -  !
.head 6 -  Set DOS_SN2 = - nInt /100
.head 6 -  Set OST_SN2 = OST_SN1 + DOS_SN2 
.head 5 -  !
.head 5 -  ! на конец мес. уже начислено
.head 5 +  If ACR_DAT >= DAT3
.head 6 -  Set OST_SN3 = OST_SN1
.head 6 -  Set DOS_SN3 = 0
.head 5 -  ! тек.день = конец мес.
.head 5 +  Else If bDat = DAT3
.head 6 -  Set OST_SN3 = OST_SN2
.head 6 -  Set DOS_SN3 = DOS_SN2
.head 5 -  ! досчитать до конца мес. в игровои режиме
.head 5 +  Else 
.head 6 -  ! по плану nInt3:  bDat - DAT3
.head 6 -  Set nInt3 = p_intN ( ACC_SS, 0, bDat, DAT3, OST_SS, 1 ) 
.head 6 -  Set nInt = nInt1 + nInt3
.head 6 -  Set DOS_SN3 = - nInt /100
.head 6 -  Set OST_SN3 = OST_SN1 + DOS_SN3
.head 5 -  Call SqlRollback( hSql() )
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 2 +  Window Parameters 
.head 3 -  Number: nPar
.head 2 +  Window Variables 
.head 3 -  Number: ACC_SS
.head 3 -  Date/Time: DAT_31
.head 3 -  Number: OST_SS
.head 3 -  Number: nFetchRes
.head 3 -  Number: nTmp
.head 3 -  String: sTmp
.head 3 -  String: sTmp_SS
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Set bDat = GetBankDate()
.head 4 -  If SqlPrepareAndExecute( hSql(),"select last_day(:bDat) into :DAT_31 from dual")
and SqlFetchNext( hSql(), nFetchRes )
.head 4 -  Call F_Null()
.head 4 -  Call SalSetFocus( NLS_SS )
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 1 +  ! Form Window: ALEGRO
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Синхронизация системного АЛЕГРО с  АБС БАРС
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.344"
.head 4 -  Width:  9.917"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.071"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -  Description: 
.head 2 -  Named Menus 
.head 2 -  Menu 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 +  Pushbutton: pb_Dbf
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.75"
.head 5 -  Top:    0.262"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: C:\bars98\RESOURCE\BMP\DOC_IN.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Light Green
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Выполнить Импорт оригилального АЛЕГРО ( Alegro_O.dbf -> таблица БД ALEGRO )'
.head 5 +  On SAM_Click
.head 6 -  ! Особенности обработки табл в БД : NUMBER_Null или 0 - по-старому
.head 6 +  If SqlPrepareAndExecute( hSql(),"DELETE from ALEGRO_O" ) 
.head 7 -  Call Imp_Dbf_New(hWndForm,NUMBER_Null, 0, 'Alegro_O', '' )
.head 7 +  If SqlPLSQLCommand(hSql(), "ALEGRO_P(hWndForm.cc_dog.ND) " )
.head 8 -  Call SqlCommitEx( hSql(),'Остатки на 89990'|| Str(hWndForm.cc_dog.ND) )
.head 8 -  Call MessageNoWait('Установилено остатки для '||Str(hWndForm.cc_dog.ND) ,'Сообщение',0.1,0)
.head 7 +  Else 
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call MessageNoWait('Неуспешное завершение для '||Str(hWndForm.cc_dog.ND), 'Ошибка', 0, 1)
.head 2 -  Functions 
.head 2 +  Window Parameters 
.head 3 -  Number: nMode
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 -  Window Variables 
.head 2 -  Message Actions 
.head 1 +  Table Window: KASI
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ввести заявки на підкріплення кас підпорядкованих бранчів
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.375"
.head 4 -  Top:    1.802"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.69"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 1000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.631"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.383"
.head 6 -  Top:    0.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.883"
.head 6 -  Top:    0.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.883"
.head 6 -  Top:    0.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    0.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbKasK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\DOCS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перегляд, коррекція, доввод заявок вибраного типу'
.head 6 +  On SAM_Click
.head 7 -  Set sTmpR ='KAS_ZV' || Str(nVid)
.head 7 -  Call FunNSIEditF(sTmpR, 0 | 0x0010)
.head 4 -  !
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.183"
.head 6 -  Top:    0.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.155"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14874
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 14875
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 14876
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Frame
.head 5 -  Resource Id: 14877
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Square
.head 5 -  Border Style: Drop-Shadow
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: Default
.head 5 -  Background Color: Default
.head 2 +  Contents
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KODV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
виробу
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва-1
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  6.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кількість
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.95"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата поставки
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nVid ! 1.Готiвка. 2.Вироби з БМ. 3.Монети та Футляри. 4. Iншi цiностi.
.head 3 -  String: strPar01 ! BRANCH
.head 3 -  String: strPar02 ! NAME_BRANCH
.head 2 +  Window Variables
.head 3 -  String: sTxtR[*]
.head 3 -  Number: nTmpR
.head 3 -  String: sTmpR
.head 3 -  String: sSql
.head 3 -  Window Handle: h_23d
.head 3 -  String: sFilter
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set sTxtR [1] = '1.Готiвка'
.head 4 -  Set sTxtR [2] = '2.Вироби з БМ.'
.head 4 -  Set sTxtR [3] = '3.Монети та Футляри.'
.head 4 -  Set sTxtR [4] = '4. Iншi цiностi.'
.head 4 -  Call SalSetWindowText(hWndForm, sTxtR[nVid] ||' '|| strPar01 ||" " || strPar02  )
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 4 )
.head 4 -  Set KASI.strPrintFileName = 'KAS_VV'||Str(nVid)
.head 4 -  Set KASI.strFilterTblName = 'KAS_VV'||Str(nVid)
.head 4 -  !
.head 4 -  Call SalHideWindow( KASI.S )
.head 4 +  If nVid = 1
.head 5 -  Call SalHideWindow( KASI.K )
.head 5 -  Call SalShowWindow( KASI.S )
.head 5 -  !
.head 5 -  Set KASI.strSqlPopulate =
"select kv,lcv,name,name1 into :KASI.KV,:KASI.KODV,:KASI.NAME,:KASI.NAME1
 from KAS_VV1 where branch ='"||strPar01||"' order by decode(kv,980,1,kv) "
.head 5 -  !
.head 5 -  Set KASI.strSqlUpdate =
"Insert into KAS_Zv1(KV,DAT2,S) values(:KASI.KV,:KASI.DAT2,:KASI.S) "
.head 5 -  !
.head 4 +  Else If nVid = 2
.head 5 -  Set KASI.strSqlPopulate =
"select kv,to_char(kodv),name,name1 into :KASI.KV,:KASI.KODV,:KASI.NAME,:KASI.NAME1
 from KAS_VV2 where branch = '"||strPar01||"'   order by name, kodv "
.head 5 -  !
.head 5 -  Set KASI.strSqlUpdate =
"Insert into KAS_Zv2(kodv,KV,DAT2,KOL) values (:KASI.KODV,:KASI.KV,:KASI.DAT2,:KASI.K) "
.head 4 +  Else If nVid = 3
.head 5 -  !
.head 5 -  Set KASI.strSqlPopulate =
"select to_char(kodv),name,name1,kv into :KASI.KODV,:KASI.NAME,:KASI.NAME1,:KASI.KV
 from KAS_VV3 where branch = '"||strPar01||"' order by KODV desc "
.head 5 -  !
.head 5 -  Set KASI.strSqlUpdate =
"Insert into KAS_Zv3(kodv,DAT2,KOL,kv) values (:KASI.KODV,:KASI.DAT2,:KASI.K,:KASI.KV) "
.head 4 +  Else If nVid = 4
.head 5 -  !
.head 5 -  Set KASI.strSqlPopulate =
"select  kodv,name, name1, kv into :KASI.KODV,:KASI.NAME,:KASI.NAME1,:KASI.KV
 from KAS_VV4 where branch ='" || strPar01||"'  order by kodv "
.head 5 -  !
.head 5 -  Set KASI.strSqlUpdate =
"Insert into KAS_Zv4(kodv,DAT2,KOL,kv) values (:KASI.KODV,:KASI.DAT2,:KASI.K,:KASI.KV) "
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  !
.head 3 +  ! On UM_Populate
.head 4 -                                                                                                        Call SalWaitCursor(TRUE)
.head 4 -                                                                                                        Set sFilter = ""
.head 4 -                                                                                                        Set sFilter = cF.GetFilterWhereClause( FALSE )
.head 4 +                                                                                                        If nVid = 1
.head 5 -                                                                                                        Set sSql =
"select distinct TABVAL.kv, TABVAL.lcv, TABVAL.name
 into :KASI.KV,  :KASI.NAME, :KASI.NAME1
 from TABVAL, KAS_VV1
 where TABVAL.kv = KAS_VV1.kv and KAS_VV1.branch ='"||strPar01||"'
  order by decode ( TABVAL.kv, 980, 1, TABVAL.kv) "
.head 4 +                                                                                                        Else If nVid = 2
.head 5 -                                                                                                        Set sSql =
"select BANK_METALS.kv, to_char(BANK_METALS.kod),
        decode(BANK_METALS.type_, 1, 'Зливок', 2,'Монета','Порошок'),
        BANK_METALS.NAME_COMMENT
   into :KASI.KV, :KASI.KODV, :KASI.NAME, :KASI.NAME1
   from BANK_METALS , KAS_VV2
   where BANK_METALS.kod = KAS_VV2.kodv and KAS_VV2.branch = '"||strPar01||"'
  order by BANK_METALS.type_, BANK_METALS.kod "
.head 4 +                                                                                                        Else If nVid = 3
.head 5 -                                                                                                        Set sSql =
"select distinct to_char(SPR_MON.KOD_MONEY), SPR_MON.NAMEMETAL,  SPR_MON. NAMEMONEY
   into :KASI.KODV, :KASI.NAME, :KASI.NAME1
   from SPR_MON, KAS_VV3
    where SPR_MON.KOD_MONEY  = KAS_VV3.kodv and KAS_VV3.branch = '"||strPar01||"'
   order by SPR_MON.KOD_MONEY desc "
.head 4 +                                                                                                        Else If nVid = 4
.head 5 -                                                                                                        Set sSql =
"select distinct VALUABLES.ob22, VALUABLES.name
 into :hWndForm.KASI.KODV, :hWndForm.KASI.NAME
 from VALUABLES, KAS_VV4
 where VALUABLES.ob22 = KAS_VV4.kodv and KAS_VV4.branch ='" || strPar01||"'
  order by VALUABLES.ob22 "
.head 4 -  !
.head 4 -                                                                                                        Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 4 -                                                                                                        Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll )
.head 4 -                                                                                                        Call SalTblSetContext(hWndForm, 0)
.head 4 -                                                                                                        Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -                                                                                                        Call SalWaitCursor(FALSE)
.head 3 +  On UM_Close
.head 4 -  If SqlPrepareAndExecute( hSql(),
"begin
  bc.set_context;
 end;")
.head 4 -  Call SalSendClassMessage(UM_Close, 0, 0)
.head 1 +  Table Window: KASM
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Моніторинг доставки  підкреплення кас
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.0"
.head 4 -  Top:    1.583"
.head 4 -  Width:  17.267"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.952"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.483"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip =
 'Перенести в Архів завершені (отримані) заявки
  та
  Вилучити (в Архів) відмічені Х НЕЗАВЕРШЕНІ '
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox( strTip || '?',
'Увага ! Необхідне Ваше підтвердження !',
 MB_IconQuestion | MB_YesNo) = IDYES
.head 8 -  Call F_ARX(strTip)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Відмітити для Вилучення (в Архів)'
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14878
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.883"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.483"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14879
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.083"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14880
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: REFA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.А
Відправки
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmpE = REFA
.head 5 +  On SAM_AnyEdit
.head 6 -  Set REFA = nTmpE
.head 5 +  On SAM_DoubleClick
.head 6 +  If REFA >0
.head 7 -  Call DocViewContentsEx(hWndForm, REFA )
.head 3 +  Column: DATA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Віза-А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: DateTime
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REFB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.Б
отримання
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmpE = REFB
.head 5 +  On SAM_AnyEdit
.head 6 -  Set REFB = nTmpE
.head 5 +  On SAM_DoubleClick
.head 6 +  If REFB >0
.head 7 -  Call DocViewContentsEx(hWndForm, REFB )
.head 3 +  Column: DATB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Віза-Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: DateTime
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: HH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Г
о
д
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set nTmpE = REFA
.head 5 +  On SAM_AnyEdit
.head 6 -  Set REFA = nTmpE
.head 5 +  On SAM_DoubleClick
.head 6 +  If REFA >0
.head 7 -  Call DocViewContentsEx(hWndForm, REFA )
.head 3 -  !
.head 3 +  Column: IDM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сист.№
маршруту
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.133"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAMEM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва Маршруту
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NSM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
змiни
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: IDS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сист.№
сумки
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NOMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
інкас.сумки
(мішка)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код Бранчу
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва Бранчу
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.25"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата поставки
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: IDZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сист.№
заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Т
З
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SVID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
Заявки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KODV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
виробу
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAMEV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва виробу
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: S1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
готівки
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: K2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кіл-ть
виробів
 з БМ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: K3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кіл-ть
Монет

.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: K4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кіл-ть
Цінн.
98*
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: SOSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sos-B
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_ARX
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sTxt1
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 5 -  Number: nIdz
.head 5 -  Number: nSos
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  !
.head 5 -  Set nSos = 5
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 +  If SOSB != NUMBER_Null and SOSB >= 4
.head 7 -  Set nIdz = IDZ
.head 7 +  If NOT SqlPLSQLCommand( hSql(), "KASZ.UPD_SOS ( nSos , nIdz )" )
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Return FALSE
.head 5 -  !
.head 5 -  Set nSos = -3
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( hWndForm, nRow, ROW_MarkDeleted, 0 )
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set nIdz = IDZ
.head 6 +  If NOT SqlPLSQLCommand( hSql(), "KASZ.UPD_SOS ( nSos , nIdz )" )
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Call SqlCommitEx( hSql(),sTxt1 )
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  !
.head 5 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  ! String: sSql1
.head 3 -  String: sSql
.head 3 -  Number: nTmpE
.head 3 -  String: sTmpE
.head 3 -  String: sFilter
.head 3 -  Number: nTmp
.head 3 -  Date/Time: dTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set KASM.strPrintFileName = 'KAS_ZM'
.head 4 -  Set KASM.strFilterTblName = 'KAS_ZV'
.head 4 -  Set KASM.fFilterAtStart = TRUE
.head 4 -  Set KASM.nTabInstance = 1
.head 4 -  !
.head 4 -  Set KASM.strSqlPopulate =
"select KAS_ZV.IDM, m.NAME, KAS_ZV.IDS, s.NOMS,  KAS_ZV.BRANCH, b.NAME,
        KAS_ZV.DAT2, KAS_ZV.IDZ, KAS_ZV.VID, KAS_ZV.SVID, KAS_ZV.KV,
        KAS_ZV.KODV, KAS_ZV.S1,  KAS_ZV.K2,  KAS_ZV.K3, KAS_ZV.K4,
        KAS_ZV.refa, KAS_ZV.refb , KAS_ZV.nsm
 into :KASM.IDM,:KASM.NAMEM,:KASM.IDS,:KASM.NOMS,:KASM.BRANCH,:KASM.NAME,
      :KASM.DAT2, :KASM.IDZ,  :KASM.VID, :KASM.SVID, :KASM.KV,
      :KASM.KODV, :KASM.S1, :KASM.K2, :KASM.K3, :KASM.K4 , :KASM.REFA, :KASM.REFB ,
      :KASM.NSM
 from   KAS_ZV , kas_m m, kas_u s, branch b
 where KAS_ZV.branch = b.branch
   and KAS_ZV.IDM    = m.idm
   and KAS_ZV.IDS    = s.IDS
   and KAS_ZV.sos   >= 2
   and KAS_ZV.sos   <  5
 order by KAS_ZV.sos, KAS_ZV.IDM, KAS_ZV.branch, KAS_ZV.DAT2, KAS_ZV.ids, KAS_ZV.idz "
.head 4 -  !
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 5 )
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If REFA != NUMBER_Null and REFA > 0
.head 5 +  If SqlPrepareAndExecute( hSqlAux2(),
"select sos, s/100 into :nTmp, :S1
 from oper where ref="||Str(REFA) )
and SqlFetchNext( hSqlAux2(), nFetchRes)
.head 6 +  If nTmp >= 4
.head 7 +  If SqlPrepareAndExecute( hSqlAux2(),
"select DAT, sysdate into :DATA, :DATB from oper_visa where status=2 and ref=" || Str(REFA) )
and  SqlFetchNext( hSqlAux2(), nFetchRes)
.head 8 +  If REFB != NUMBER_Null and REFB > 0
.head 9 +  If SqlPrepareAndExecute( hSqlAux2(),"select sos into :SOSB from oper where ref="||Str(REFB) )
and  SqlFetchNext( hSqlAux2(), nFetchRes)
.head 10 +  If SOSB >=4
.head 11 -  If SqlPrepareAndExecute( hSqlAux2(),
"select DAT into :DATB from oper_visa where status=2 and ref="||Str(REFB) )
and SqlFetchNext( hSqlAux2(), nFetchRes)
.head 8 -  !
.head 8 -  Set HH =  (DATB - DATA) * 24
.head 8 +  If SOSB = 1
.head 9 -  Call XSalTblSetRowBackColor( KASM, lParam, COLOR_LightGreen )
.head 8 +  Else If SOSB >=4
.head 9 -  Call XSalTblSetRowBackColor( KASM, lParam, COLOR_LightGray )
.head 8 +  Else
.head 9 +  If HH >= 24
.head 10 -  Call XSalTblSetRowBackColor( KASM, lParam, SalColorFromRGB( 255,210,250 ) )
.head 1 +  Form Window: KASS
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.head 2 -  Class: cGenericTableSpl
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Виконання заявок на підкріплення кас
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.1"
.head 4 -  Top:    1.375"
.head 4 -  Width:  13.75"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.262"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.476"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbMarshrut
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\CHILDS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Вибати Маршрут----------->'
.head 7 -  Set M_NAME = strTip
.head 7 -  Set M_KOD = 0
.head 6 +  On SAM_Click
.head 7 -  Set sTmp =STRING_Null
.head 7 -  Set sTmp2=STRING_Null
.head 7 -  Call FunNSIGet ("KAS_M_KOLZ0","NAME", sTmp, sTmp2 )
.head 7 +  If sTmp != STRING_Null
.head 8 -  Set M_NAME = sTmp2
.head 8 -  Set M_KOD = Val(sTmp)
.head 8 -  Call NASELENIE()
.head 4 +  Data Field: M_KOD
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.283"
.head 7 -  Top:    0.071"
.head 7 -  Width:  0.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Сист.№ маршруту ' )
.head 4 +  Data Field: M_NAME
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.083"
.head 7 -  Top:    0.071"
.head 7 -  Width:  3.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Назва маршруту ' )
.head 4 +  Data Field: dDATF
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.983"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.767"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Дата формування сумки' )
.head 6 +  On SAM_Validate
.head 7 +  If dDATF != dDAT2 and  dDATF != dDAT2 - 1 
.head 8 -  Call SalMessageBox(  
"Дата формування сумки 
має бути рівною (або на 1 день меншою) 
дати поставки !",
'Помилка ! ',
 MB_OkCancel) 
.head 8 -  Set dDATF = dDAT2
.head 4 -  Background Text: <=>
.head 5 -  Resource Id: 54433
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dDAT2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.183"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.767"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Дата поставки в заявках ' )
.head 6 +  On SAM_Validate
.head 7 -  Call NASELENIE()
.head 4 +  Pushbutton: pbLock
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip =
'Забрати заявки вибранного Маршруту
по указану дату Постаки'
.head 6 +  On SAM_Click
.head 7 -  Call F_LOCK( M_KOD, dDAT2)
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call NASELENIE()
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter(tbl.cF)
.head 8 -  Call NASELENIE()
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Зняти(відмовити) вибрану заявку'
.head 6 +  On SAM_Click
.head 7 +  If tbl.IDZ > 0
.head 8 -  Set sTxt1 = strTip || ' №' || Str(tbl.IDZ) || ', Бранч '|| tbl.BRANCH
.head 8 +  If tbl.F_DEL ( sTxt1, tbl.IDZ)
.head 9 -  Call NASELENIE()
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip =
'Зберегти уточнення заявок :
 1) Підібрані №№ сумок,
 2) Коругування Сум чи кількості в заявці'
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox( strTip || ' ?',
'Увага ! Необхідне Ваше підтвердження !',
 MB_IconQuestion | MB_YesNo) = IDYES
.head 8 -  Call tbl.F_UPD()
.head 8 -  Call NASELENIE()
.head 4 +  Pushbutton: pbRun
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\EXECUTE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Задовольнити відмічені заявки'
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox( strTip || '?',
'Увага ! Необхідне Ваше підтвердження !',
 MB_IconQuestion | MB_YesNo) = IDYES
.head 8 -  Call tbl.F_OPL()
.head 8 -  Call NASELENIE()
.head 4 -  !
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.933"
.head 6 -  Top:    0.143"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14881
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14882
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 14883
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pb_Persom
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\CUSTPERS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip =
 'Уточнити поточний склад 
інкасаторів вибраного маршруту'
.head 6 +  On SAM_Click
.head 7 -  Set sKodM = Str(M_KOD)
.head 7 +  If SqlPLSQLCommand( hSql(), 
"PUL.Set_Mas_Ini( 'KAS_IDM' , sKodM , 'Код марш.інкас' )" )
.head 8 -  Call FunNSIEditFFiltered ( "KAS_MF", 0, "KAS_MF.idm = " || sKodM )
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    5.167"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  20.95"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 5.179"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: NSM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
змiни
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BRANCH
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код Бранчу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва Бранчу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: DAT2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
поставки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.233"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: IDZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сист.№
заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: VID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Т
З
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.217"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SVID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
Заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.767"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KODV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
виробу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAMEV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва виробу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  !
.head 5 +  Column: OK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Т
а
к
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If SOS > 1 or IDS = NUMBER_Null
.head 9 -  Set OK = 0
.head 5 +  Column: S1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сума
готівки
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set nTmpE = S1
.head 7 +  On SAM_AnyEdit
.head 8 +  If VID != 1
.head 9 -  Set S1 = nTmpE
.head 5 +  Column: K2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Кіл-ть
виробів
 з БМ
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.667"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set nTmpE = K2
.head 7 +  On SAM_AnyEdit
.head 8 +  If VID != 2
.head 9 -  Set K2 = nTmpE
.head 8 +  Else
.head 9 -  Set S1 = K2 * CENA
.head 5 +  Column: K3
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Кіл-ть
Монет

.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set nTmpE = K3
.head 7 +  On SAM_AnyEdit
.head 8 +  If VID != 3
.head 9 -  Set K3 = nTmpE
.head 8 +  Else
.head 9 -  Set S1 = K3 * CENA
.head 5 +  Column: K4
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Кіл-ть
Цінн.
98*
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.617"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set nTmpE = K4
.head 7 +  On SAM_AnyEdit
.head 8 +  If VID != 4
.head 9 -  Set K4 = nTmpE
.head 8 +  Else
.head 9 -  Set S1 = K4 * CENA
.head 5 +  Column: NOMS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
інкас.сумки
(мішка)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.183"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmpE = NOMS
.head 8 -  Set nTmpE = IDS
.head 7 +  On SAM_AnyEdit
.head 8 -  Set NOMS = sTmpE
.head 8 -  Set IDS = nTmpE
.head 7 +  On SAM_DoubleClick
.head 8 +  If OK != 1
.head 9 -  Set nRow = SalTblQueryContext(tbl)
.head 9 -  Set sTmp = STRING_Null
.head 9 -  Set sTmp2 = STRING_Null
.head 9 -  Call FunNSIGetFiltered
 ("KAS_U","NOMS",
" KAS_U.D_CLOS is null and "||
" KAS_U.IDS in (select ids from kas_bu where BRANCH='"|| BRANCH ||"' )" ,
 sTmp, sTmp2 )
.head 9 +  If sTmp != STRING_Null
.head 10 -  Set NOMS = sTmp2
.head 10 -  Set IDS = Val(sTmp)
.head 10 -  Call SalTblSetRowFlags( tbl, nRow, ROW_Edited, TRUE )
.head 9 +  Else
.head 10 -  Set NOMS = sTmpE
.head 10 -  Set IDS = nTmpE
.head 5 +  Column: CENA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Облікова
Ціна
виробу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  !
.head 5 +  Column: REF1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.А
відправки
в дорогу
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.183"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set nTmpE = REF1
.head 7 +  On SAM_AnyEdit
.head 8 -  Set REF1 = nTmpE
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF1 >0
.head 9 -  Call DocViewContentsEx(hWndForm, REF1 )
.head 5 +  Column: REF2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.Б
отримання
з дороги
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set nTmpE = REF2
.head 7 +  On SAM_AnyEdit
.head 8 -  Set REF2 = nTmpE
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF2 >0
.head 9 -  Call DocViewContentsEx(hWndForm, REF2 )
.head 5 -  !
.head 5 +  Column: SOS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SOS
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set nTmpE = REF2
.head 7 +  On SAM_AnyEdit
.head 8 -  Set REF2 = nTmpE
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF2 >0
.head 9 -  Call DocViewContentsEx(hWndForm, REF2 )
.head 5 +  Column: IDS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код сумки
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set nTmpE = REF2
.head 7 +  On SAM_AnyEdit
.head 8 -  Set REF2 = nTmpE
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF2 >0
.head 9 -  Call DocViewContentsEx(hWndForm, REF2 )
.head 5 +  Column: IDI
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код інкасатора
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set nTmpE = REF2
.head 7 +  On SAM_AnyEdit
.head 8 -  Set REF2 = nTmpE
.head 7 +  On SAM_DoubleClick
.head 8 +  If REF2 >0
.head 9 -  Call DocViewContentsEx(hWndForm, REF2 )
.head 4 +  Functions
.head 5 +  Function: F_OPL
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 7 -  Number: nRef
.head 7 -  Number: nIdZ
.head 7 -  Number: nIdS
.head 7 -  Number: nS1
.head 7 -  Number: nK2
.head 7 -  Number: nK3
.head 7 -  Number: nK4
.head 7 -  Date/Time: dDatF
.head 6 +  Actions
.head 7 -  Set nRow = TBL_MinRow
.head 7 -  Set dDatF = dDATF
.head 7 +  While SalTblFindNextRow( tbl, nRow, 0, 0 )
.head 8 -  Call SalTblSetContext(tbl, nRow)
.head 8 +  If tbl.REF1 = NUMBER_Null and
   tbl.OK   = 1 and
   tbl.SOS  = 1 and
   (tbl.S1  > 0 or tbl.K2 >0 or tbl.K3 >0 or tbl.K4 >0 ) and
   tbl.IDS != NUMBER_Null
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 +  ! If F_OPL1 ()
.head 10 -                                                                                                           Call SqlCommitEx( hSql(),"Виконана кас.заявка № " || Str(tbl.IDZ) )
.head 9 -  Set nIdZ = tbl.IDZ
.head 9 -  Set nIdS = tbl.IDS
.head 9 -  Set nS1  = tbl.S1
.head 9 -  Set nK2  = tbl.K2
.head 9 -  Set nK3  = tbl.K3
.head 9 -  Set nK4  = tbl.K4
.head 9 +  If SqlPLSQLCommand( hSql(), "KASZ.OPL1( dDatF, nIdZ, nIdS, nS1, nK2, nK3, nK4, nRef )" )
.head 10 -  Call SqlCommitEx( hSql(),"Виконана кас.заявка № " || Str(tbl.IDZ) )
.head 10 -  Set tbl.REF1 = nRef
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 9 -  Call SalWaitCursor(FALSE)
.head 7 -  Return TRUE
.head 5 +  Function: F_UPD
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 7 -  Number: nIdZ
.head 7 -  Number: nIdS
.head 7 -  Number: nS1
.head 7 -  Number: nK
.head 6 +  Actions
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( tbl, nRow, ROW_Edited, 0 )
.head 8 -  Call SalTblSetContext(tbl, nRow)
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Set nIdZ = tbl.IDZ
.head 8 -  Set nIdS = tbl.IDS
.head 8 -  Set nS1  = tbl.S1
.head 8 +  If tbl.VID = 2
.head 9 -  Set nK   = tbl.K2
.head 8 +  Else If tbl.VID = 3
.head 9 -  Set nK   = tbl.K3
.head 8 +  Else If tbl.VID = 4
.head 9 -  Set nK   = tbl.K4
.head 8 -  !
.head 8 +  If SqlPLSQLCommand( hSql(), "KASZ.UPD_KASZ( nIdZ, nIdS, nS1, nK )" )
.head 9 -  Call SqlCommit( hSql() )
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 8 -  Call SalWaitCursor(FALSE)
.head 7 -  Return TRUE
.head 5 +  Function: F_DEL
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sTxt1
.head 7 -  Number: nIdz
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalMessageBox( sTxt1 || '?', 'Увага ! Необхідне Ваше підтвердження !',
 MB_IconQuestion | MB_YesNo) = IDYES
.head 8 +  If SqlPLSQLCommand( hSql(), "KASZ.UPD_SOS ( -2 , nIdz )" )
.head 9 -  Call SqlCommitEx( hSql(),sTxt1 )
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 7 -  !
.head 7 -  Return FALSE
.head 4 +  Window Variables
.head 5 -  Number: nTmpE
.head 5 -  Number: nRow
.head 5 -  String: sTmpE
.head 5 -  Number: nCol
.head 5 -  Window Handle: hCol1 ! Сумма/кол
.head 5 -  Window Handle: hCol2 ! Код ценности
.head 5 -  Window Handle: hCol3 ! назв ценности
.head 5 -  Window Handle: hCol4 ! тип заявки
.head 5 -  Window Handle: hCol5 ! ОК
.head 5 -  Boolean: bSortOrd
.head 4 +  Message Actions
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set hCol2 = tbl.KODV
.head 6 -  Set hCol3 = tbl.NAMEV
.head 6 -  Set hCol4 = tbl.SVID
.head 6 -  Set hCol5 = tbl.OK
.head 6 +  If tbl.IDS != NUMBER_Null
.head 7 -  If SqlPrepareAndExecute( hSqlAux2(),
"select noms into :tbl.NOMS from kas_u where ids=" || Str(tbl.IDS)  )
and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 6 -  !
.head 6 +  If VID = 1
.head 7 -  Set sSqlRow ="select name into :tbl.NAMEV from tabval where kv = :tbl.KV "
.head 7 -  Set hCol1 = tbl.S1
.head 7 -  Set hCol2 = tbl.KV
.head 7 +  If tbl.KV = n980
.head 8 -  Set nCol = SalColorFromRGB( 255,210,250 )
.head 7 +  Else
.head 8 -  Set nCol = COLOR_LightGreen
.head 6 +  Else If VID = 2
.head 7 -  Set sSqlRow =
"select Round(NVL (ves_un, ves / 31.1034807),2) * " ||Str(tbl.K2) ||",
        Round(NVL (ves_un, ves / 31.1034807),2), name
 into :tbl.S1, :tbl.CENA, :tbl.NAMEV
 from BANK_METALS where kod =" || tbl.KODV
.head 7 -  Set nCol = COLOR_Yellow
.head 7 -  Set hCol1 = tbl.K2
.head 7 -  Call XSalTblSetCellBackColor( KV , nCol )
.head 6 +  Else If VID = 3
.head 7 -  Set sSqlRow =
"select decode(PR_KUPON, null, NOMINAL, 0) * " ||Str(tbl.K3) ||",
        decode(PR_KUPON, null, NOMINAL, 0), NAMEMONEY
 into  :tbl.S1, :tbl.CENA, :tbl.NAMEV
 from spr_mon where KOD_MONEY=:tbl.KODV "
.head 7 -  Set nCol = COLOR_Sky
.head 7 -  Set hCol1 = tbl.K3
.head 6 +  Else If VID = 4
.head 7 -  Set sSqlRow ="select NAME into :tbl.NAMEV from valuables where ob22 = :tbl.KODV "
.head 7 -  Set tbl.CENA = 1
.head 7 -  Set tbl.S1 = tbl.K4
.head 7 -  Set hCol1 = tbl.K4
.head 7 -  Set nCol = COLOR_LightGray
.head 6 -  !
.head 6 -  Call XSalTblSetCellBackColor( hCol1 , nCol )
.head 6 -  Call XSalTblSetCellBackColor( hCol2 , nCol )
.head 6 -  Call XSalTblSetCellBackColor( hCol3 , nCol )
.head 6 -  Call XSalTblSetCellBackColor( hCol4 , nCol )
.head 6 -  Call XSalTblSetCellBackColor( hCol5 , nCol )
.head 6 +  If tbl.SOS > 1
.head 7 -  ! Call XSalTblSetCellBackColor( BRANCH , nCol )
.head 7 -  ! Call XSalTblSetCellBackColor( NAME , nCol )
.head 7 -  ! Call XSalTblSetCellBackColor( IDZ , nCol )
.head 7 -  ! Call XSalTblSetCellBackColor( DAT2 , nCol )
.head 7 -  Call XSalTblSetRowBackColor( tbl, lParam, nCol )
.head 6 -  ! название изделия
.head 6 -  If SqlPrepareAndExecute( hSqlAux2(), sSqlRow  )
and SqlFetchNext(  hSqlAux2(), nFetchRes )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd = not bSortOrd
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 27
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    3.405"
.head 6 -  Width:  20.95"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 6.643"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: BRN_2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код Бранчу
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAM_2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва Бранчу, від якого НЕ надійшло жодної заявки
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  9.217"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_LOCK
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nIdM
.head 5 -  Date/Time: pDat2
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTxt
.head 4 +  Actions
.head 5 +  If nIdM > 0 and pDat2 != DATETIME_Null
.head 6 -  Set sTxt =
"Забрали заявки марш.№ " || Str(nIdM) || ", даты " ||
SalFmtFormatDateTime( dDat, "dd/MM/yyyy" )|| " - " ||
SalFmtFormatDateTime( pDat2, "dd/MM/yyyy" )
.head 6 +  If SqlPLSQLCommand( hSql(), "KASZ.LOCK1 ( nIdM, pDat2 )" )
.head 7 +  If SqlCommitEx( hSql(), sTxt )
.head 8 -  Call NASELENIE()
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 6 -  Return TRUE
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSql
.head 5 -  String: sSql2
.head 5 -  String: sFilter
.head 5 -  Number: nM
.head 4 +  Actions
.head 5 -  Set nM = M_KOD
.head 5 +  If nM <= 0
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sFilter = ""
.head 5 -  Set sFilter = tbl.cF.GetFilterWhereClause( FALSE )
.head 5 -  ! Call Debug(sFilter)
.head 5 -  ! Первая верхняя табл
.head 5 -  !
.head 5 -  Set sSql =
"select KAS_ZV.BRANCH,   b.NAME, KAS_ZV.DAT2, KAS_ZV.IDZ,  KAS_ZV.VID,
        KAS_ZV.SOS,  KAS_ZV.IDS, KAS_ZV.refa, KAS_ZV.refb,
        KAS_ZV.SVID, KAS_ZV.KV,  KAS_ZV.KODV,
        KAS_ZV.S1,   KAS_ZV.K2,  KAS_ZV.K3,   KAS_ZV.K4, KAS_ZV.NSM
 into :tbl.BRANCH, :tbl.NAME, :tbl.DAT2, :tbl.IDZ, :tbl.VID,
      :tbl.SOS, :tbl.IDS, :tbl.REF1, :tbl.REF2, :tbl.SVID, :tbl.KV, :tbl.KODV,
      :tbl.S1,  :tbl.K2,  :tbl.K3,   :tbl.K4, :tbl.NSM
 from KAS_ZV , branch b
 where  KAS_ZV.SOS in (1) and KAS_ZV.BRANCH =b.branch and KAS_ZV.IDM = " || Str( nM ) ||
 IifS (sFilter = STRING_Null, "", " and " || sFilter  ) || sSql3 || "
 order by  KAS_ZV.SOS, KAS_ZV.BRANCH, KAS_ZV.DAT2, KAS_ZV.VID, KAS_ZV.IDZ "
.head 5 -  Call SalTblPopulate( tbl, hSql(), sSql, TBL_FillAll  )
.head 5 -  Call SalTblSetContext(tbl, 0)
.head 5 -  ! Вторая нижняя табл
.head 5 -  Set sSql2 = "
select b.branch, b.name into :tbl2.BRN_2, :tbl2.NAM_2
from branch b, kas_b m
where m.branch=b.branch and m.idm=:nM
 and not exists (select 1 from kas_z where branch=B.branch and sos in (1,2) ) "
.head 5 -  Call SalTblPopulate( tbl2, hSql(), sSql2, TBL_FillAll  )
.head 5 -  Call SalTblSetContext(tbl2, 0)
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  String: sTxt1
.head 3 -  String: sKodM
.head 3 -  String: sTmp
.head 3 -  String: sTmp2
.head 3 -  String: sSqlRow
.head 3 -  String: sSql3
.head 3 -  Date/Time: dDat1
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  !
.head 3 -  Number: n980
.head 3 -  String: aOkpo
.head 3 -  String: aMfo
.head 3 -  Date/Time: dDat
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Set n980 = GetBaseVal()
.head 4 -  Set aOkpo = GetBankOkpoS()
.head 4 -  Set aMfo = GetBankMfo()
.head 4 -  Set dDat = GetBankDate()
.head 4 -  !
.head 4 -  Set dDat1 = dDat + 1
.head 4 -  Set dDAT2 = dDat1
.head 4 -  Set dDATF = dDat1
.head 4 -  !
.head 4 -  Set KASS.strPrintFileName = 'KAS_ZS'
.head 4 -  Set KASS.strFilterTblName = 'KAS_ZV'
.head 4 -  Set sSql3 = ""
.head 4 +  If nPar = 0
.head 5 -  Set sSql3 = " and KAS_ZV.kv= " ||Str(n980)
.head 5 -  Call SalHideWindow(tbl.K2  )
.head 5 -  Call SalHideWindow(tbl.KV  )
.head 4 +  Else If nPar = 1
.head 5 -  Set sSql3 = " and KAS_ZV.kv <> " ||Str(n980)
.head 5 -  Call SalHideWindow(tbl.K3  )
.head 5 -  Call SalHideWindow(tbl.K4  )
.head 4 -  !
.head 4 -  Call SalTblSetLockedColumns( tbl, 10 )
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Table Window: KASZ
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ввести заявки на підкріплення кас підпорядкованих бранчів
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.375"
.head 4 -  Top:    1.802"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.69"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 1000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.774"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.483"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Переглянути рахунки кас вибраного бранчу'
.head 4 -  !
.head 4 -  Group Box: Тип заявки
.head 5 -  Resource Id: 14888
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  9.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Pushbutton: pbKasI
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.183"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\TABLER.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Введення заявок вибраного типу'
.head 6 +  On SAM_Click
.head 7 -  Set nTmpR = IifN( rb1, 1, IifN( rb2, 2, IifN(rb3,3,4) ) )
.head 7 -  Set sTmpR ='KAS_ZV' || Str( nTmpR )
.head 7 +  If hWndForm.KASZ.BRANCH != STRING_Null
.head 8 +  If IsWindow( h_23d )
.head 9 -  Call SalDestroyWindow( h_23d )
.head 8 +  If SqlPrepareAndExecute( hSql(),
"begin
  bc.subst_branch('" || hWndForm.KASZ.BRANCH || "');
 end;")
.head 9 -  Set h_23d =
SalCreateWindow( KASI, hWndMDI, nMode, nTmpR,
hWndForm.KASZ.BRANCH , hWndForm.KASZ.NAME )
.head 4 +  Radio Button: rb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: 1.Готiвка.
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    0.321"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Radio Button: rb2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: 2.Вироби з БМ.
.head 5 -  Window Location and Size
.head 6 -  Left:   6.183"
.head 6 -  Top:    0.321"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Radio Button: rb3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: 3.Монети та Футляри.
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.321"
.head 6 -  Width:  2.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Radio Button: rb4
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: 4. Iншi цiностi.
.head 5 -  Window Location and Size
.head 6 -  Left:   10.683"
.head 6 -  Top:    0.321"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbKasK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    0.238"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\DOCS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Maize
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перегляд, коррекція, доввод заявок вибраного типу'
.head 6 +  On SAM_Click
.head 7 -  Set sTmpR ='KAS_ZV' ||  IifS( rb1, '1', IifS( rb2, '2', IifS( rb3, '3','4') ) )
.head 7 +  If hWndForm.KASZ.BRANCH !=STRING_Null
.head 8 +  If SqlPrepareAndExecute( hSql(),
"begin
  bc.subst_branch('" || hWndForm.KASZ.BRANCH || "');
 end;")
.head 9 -  Call FunNSIEditF(sTmpR, 0 | 0x0010)
.head 4 -  !
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.283"
.head 6 -  Top:    0.321"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14889
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 14890
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 14891
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: BRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код Бранчу
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва Бранчу
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  7.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: IDM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сист.№
Маршруту
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAMEM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва
Маршруту
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кiльк
Сумок
в обігу
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOLZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кiльк
заявок
до розгляду
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.25"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  String: sTmpA
.head 3 -  String: sTmpR
.head 3 -  String: sTxtR
.head 3 -  Number: nTmpR
.head 3 -  Window Handle: h_23d
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  Set hWndForm.KASZ.strSqlPopulate =
"select BRANCH.branch, BRANCH.name, m.idm, m.name, count(*)
   into :hWndForm.KASZ.BRANCH,  :hWndForm.KASZ.NAME, :hWndForm.KASZ.IDM, :hWndForm.KASZ.NAMEM  ,
        :hWndForm.KASZ.KOLS
   from BRANCH , kas_m m , kas_b b, kas_bu s
  where BRANCH.branch like  sys_context('bars_context','user_branch') || '%'
    and length(BRANCH.branch) >= 15
    and B.branch <> :SX_BRN 
    and b.BRANCH = BRANCH.BRANCH
    and b.idm=m.idm and B.branch = s.branch
  group by BRANCH.branch, BRANCH.name, m.idm, m.name
  order by 5 desc, BRANCH.branch "
.head 4 -  Set rb1 = TRUE
.head 4 -  Set rb2 = FALSE
.head 4 -  Set rb3 = FALSE
.head 4 -  Set rb4 = FALSE
.head 4 -  !
.head 4 -  Set KASZ.strPrintFileName = 'BRANCH'
.head 4 -  Set KASZ.strFilterTblName = 'BRANCH'
.head 4 -  Set KASZ.fFilterAtStart = 1
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_DoubleClick
.head 4 +  If SX_NBS = '1001'
.head 5 -  Set sTmpA =
" a.branch ='" || hWndForm.KASZ.BRANCH || "' and a.nbs in ('1002','1102','9819','9820','9821') "
.head 4 +  Else
.head 5 -  Set sTmpA =
" a.branch ='" || hWndForm.KASZ.BRANCH || "' and a.nbs in ('1002','1102','9819','9820','9821','1001','1101') "
.head 4 -  Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmpA )
.head 3 +  On UM_Close
.head 4 -  If SqlPrepareAndExecute( hSql(),
"begin
  bc.set_context;
 end;")
.head 4 -  Call SalSendClassMessage(UM_Close, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  If SqlPrepareAndExecute( hSqlAux2(),
"select count(*) into :KOLZ from kas_z 
 where branch = :BRANCH and sos=0 and dat2 >= gl.bd "  )
and SqlFetchNext(  hSqlAux2(), nFetchRes )
.head 3 +  On UM_Populate
.head 4 -  If SqlPrepareAndExecute( hSql(),
"begin
  bc.set_context;
 end;")
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 1 +  Table Window: Frm_CasAcc
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Просмотр счетов кассиров
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 23311
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 23312
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 23313
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Acc
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNms
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Валюта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOstc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
фактический
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOstb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
плановый
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
Дебет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
Кредит
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDokD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Приход
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDokK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Расход
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSetWindowText(hWndForm, sApdVersion || 'Просмотр счетов кассира')
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set hWndForm.Frm_CasAcc.nFlags = GT_ReadOnly
.head 4 -  ! Set hWndForm.Frm_CasAcc.strFilterTblName = 'v_cas_casaccounts'
.head 4 -  Set hWndForm.Frm_CasAcc.strPrintFileName = 'cas_acc'
.head 4 -  Set hWndForm.Frm_CasAcc.strSqlPopulate = 
"SELECT acc, nls, nms, kv, ostc, ostb, dos, kos, doc_d, doc_k
   INTO :hWndForm.Frm_CasAcc.colAcc, :hWndForm.Frm_CasAcc.colNls,  :hWndForm.Frm_CasAcc.colNms,  :hWndForm.Frm_CasAcc.colKv, 
        :hWndForm.Frm_CasAcc.colOstc, :hWndForm.Frm_CasAcc.colOstb, :hWndForm.Frm_CasAcc.colDOS,
        :hWndForm.Frm_CasAcc.colKOS, :hWndForm.Frm_CasAcc.colDokD, :hWndForm.Frm_CasAcc.colDokK
   FROM v_cas_casaccounts
  WHERE isp in (" || GetSubstListId(GetUserId(),TRUE) || ") 
  ORDER BY nms"
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
