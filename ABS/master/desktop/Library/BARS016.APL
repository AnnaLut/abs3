.head 0 +  Application Description: Вкладные операции
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000005000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000F30000 002C000000020000 0003000000000000 003C020000F8FFFF
0040: FFE2FFFFFF450000 000A000000CE0200 007A010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D04000000075769 6E646F77730D646C
0080: 675F496D706F7274 4353560946756E63 74696F6E730B705F 496D6F72745F4353
00A0: 5600000180020002 0000000000000000 0000002C00000000 00000001000000FF
00C0: FFFFFFFFFFFFFFF8 FFFFFFE2FFFFFFAF 000000AF0000009C 0400001A03000000
00E0: 0000000000000005 0000000F4170706C 69636174696F6E49 74656D0757696E64
0100: 6F77730966726D5F 566B6C61640D4368 696C642057696E64 6F777305636D6254
0120: 5400000000018002 0002000000000000 00000000002C0000 0000000000010000
0140: 00FFFFFFFFFFFFFF FFF8FFFFFFE2FFFF FFC8000000C80000 00B5040000330300
0160: 0000000000000000 00050000000F4170 706C69636174696F 6E4974656D075769
0180: 6E646F7773096672 6D5F566B6C616409 46756E6374696F6E 7306465F56564F44
01A0: 0000000001800200 0100000000000000 000000002C000000 0000000001000000
01C0: FFFFFFFFFFFFFFFF F8FFFFFFE2FFFFFF E1000000E1000000 CE0400004C030000
01E0: 0000000000000000 030000000F417070 6C69636174696F6E 4974656D0757696E
0200: 646F77730843425F 56564F4431020000 0008546F6F6C2042 6172097062506179
0220: 446F6320
.enddata
.data DT_MAKERUNDLG
0000: 02000000001D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0020: 6578651D513A5C42 41525339385C4C49 42524152595C4241 52533031352E646C
0040: 6C1D513A5C424152 5339385C4C494252 4152595C42415253 3031352E61706300
0060: 000101011D513A5C 4241525339385C4C 4942524152595C42 4152533031352E72
0080: 756E1D513A5C4241 525339385C4C4942 524152595C424152 533031352E646C6C
00A0: 1D513A5C42415253 39385C4C49425241 52595C4241525330 31352E6170630000
00C0: 010101175C424152 5339385C42494E5C 424152533031362E 617064175C424152
00E0: 5339385C42494E5C 424152533031352E 646C6C175C424152 5339385C42494E5C
0100: 424152533031352E 6170630000010101 1D513A5C42415253 39385C4C49425241
0120: 52595C4241525330 31352E61706C1D51 3A5C424152533938 5C4C494252415259
0140: 5C42415253303135 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42
0160: 4152533031352E61 70630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: Winapi.apl
.head 2 -  File Include: Docwis6.apl
.head 2 -  File Include: vtcomm.apl
.head 2 -  ! File Include: cc_doc.apl
.head 2 -  File Include: XSALSPL.APL
.head 2 -  File Include: XSALIMG.APL
.head 2 -  File Include: VTFILE.APL
.head 2 -  File Include: VTDOS.APL
.head 2 -  File Include: GENRESIZ.APL
.head 2 -  File Include: GENTBLD.APL
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Custacnt.apd
.head 2 -  Dynalib: Bars002.apd
.head 2 -  Dynalib: Bars010.apd
.head 2 -  Dynalib: Bars016f.apd
.head 2 -  Dynalib: BARS039.apd
.head 2 -  Dynalib: CC_DOC.APD
.head 2 -  Dynalib: OTCN.APD
.head 2 -  Dynalib: nsiapi.apd
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: d
.head 3 -  Number: 00000
.head 3 -  Date/Time: dd/MM/yyyy hh:mm AMPM
.head 3 -  Date/Time: dd/MM/yyyy
.head 3 -  Number: ###0
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  Window Handle: hWinA
.head 3 -  Window Handle: hWin1
.head 3 -  Window Handle: hWin2
.head 3 -  Window Handle: hWin4
.head 3 -  Window Handle: hWin9
.head 3 -  Window Handle: hWin11
.head 3 -  Window Handle: hWin12
.head 3 -  Window Handle: hWinV
.head 3 -  Window Handle: hWinN
.head 3 -  Window Handle: hWinW 
.head 3 -  Window Handle: hWinP 
.head 3 -  Window Handle: hWinZS
.head 3 -  Window Handle: hWinSTUD
.head 3 -  !
.head 3 -  Number: nFetchRes
.head 3 -  Boolean: bApdInited
.head 3 -  String: sOKPO
.head 2 +  Internal Functions
.head 3 +  Function: IniBars016
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not bApdInited
.head 6 -  Set bStaticsAsWindows = TRUE
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars016.lng"
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile(strFileName, strLangId))
.head 7 -  Call CurrentLangTable.Init()
.head 7 -  ! ====================================================
.head 7 -  Call CurrentLangTable.AddAtom('cTAt','Внимание!')
.head 7 -  Call CurrentLangTable.AddAtom('cTErr','Ошибка!')
.head 7 -  Call CurrentLangTable.AddAtom('cTQuestion','Вопрос')
.head 7 -  Call CurrentLangTable.AddAtom('cTOt','от')
.head 7 -  Call CurrentLangTable.AddAtom('cTMessage','Сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('cTContinue','Продолжить?')
.head 7 -  ! ====================================================
.head 7 -  ! frm_Kontr
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cTWndTitle','Контролер - ОПЕРАЦИОНИСТ')
.head 7 -  ! columns
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.deposit_id','№ вклада~(системный)')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.tobo','Подразделение')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.kv','Вал')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.nd','№ договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.nls','Лицевой счет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.nmk','ФИО вкладчика')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.pasp','Документ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.paspn','Серия,№')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.vydan','Выдан')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.okpo','OKPO')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.vidd','Код~вида')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.type_name','Вид вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.ostcs','Тек остаток')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.dat_begin','Дата~начала')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.ShowTbl.dat_end','Дата~ окончания')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipPoisk','Поиск Клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipNewK','Регистрация нового клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipClear','Очистить поля поиска')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipVidd','Общие параметры видов вкладов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipPROC','Начисление процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipPortfel','Портфель исполнителя')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipPortfel_It','Итоги портфеля исполнителя')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipTab','Табличная форма счетов исполнителя')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipDelete','Закрытие вкладов в архив')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipCancel','Завершить')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipArch','Просмотр архива')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipAuto_P','Автопереоформление договоров')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipKapital','Выплата процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipFilter','Предустановить фильтр')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipAmort','Амортизация начисленных процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipEditK','Изменение/Просмотр реквизитов клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipNewV','Новый договор')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Kontr.cBTipEditV','Действующий договор')
.head 7 -  ! ====================================================
.head 7 -  ! frm_Client
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_Client.cBTipPoisk','Поиск Клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Client.cBTipNewK','Регистрация нового клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Client.cBTipClear','Очистить поля поиска')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('frm_Client.bgMan_nm','Вкладчик')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Client.bgDpt_id','Вклад №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Client.bgRegNk','РНК клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Client.bgDpt_nls','Лицевой счет №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Client.bgNd','№ договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Client.bgAusv','№ пасп/удост')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Client.bgId_cod','Идент. код')
.head 7 -  ! ====================================================
.head 7 -  ! frm_tblButtn
.head 7 -  Call CurrentLangTable.AddAtom('frm_tblButtn.cbShowCallDpt','Показывать вклады "На вимогу"')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_tblButtn.cBTipCreate','Работа с текстами договоров')
.head 7 -  Call CurrentLangTable.AddAtom('frm_tblButtn.cBTipEditK','Изменение/Просмотр реквизитов клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_tblButtn.cBTipNewV','Новый договор')
.head 7 -  Call CurrentLangTable.AddAtom('frm_tblButtn.cBTipEditV','Действующий договор')
.head 7 -  Call CurrentLangTable.AddAtom('frm_tblButtn.cBTipNewStud','Новый договор "Студенческий"')
.head 7 -  ! ====================================================
.head 7 -  ! frm_Vklad
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTWndTitle','Карточка вклада')
.head 7 -  ! TB1
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.TB1.DAT','Дата')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.TB1.PRIDs','Приход')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.TB1.RASDs','Расход')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.TB1.ISXDs','Остаток~по вкладу')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.TB1.PROC','%~ставка')
.head 7 -  ! TB2
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.TB2.DAT','Дата')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.TB2.PRIPs','Начис~%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.TB2.RASPs','Выплата~ %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.TB2.ISXPs','Остаток~по %')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipTabl','Табличная форма счетов вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipRefresh','Перечитать карточку вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipSberBook','Печать сбер.книжки')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipCancel','Выход из карточки')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipNAMEP','Сохранить изменения')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipDoc','Печать договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipFields','Заполнить доп.реквизиты вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipN1','Полное снятие вклада наличными')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipPrnLic','Печать выписки по основному счету')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipClose','Расчет и Взыскание штрафа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipPROC','Начислить проценты')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipN2','Полное снятие процентов наличными')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipPrnLicN','Печать выписки по счету начисленных процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cBTipFindAcc','Найти счет')
.head 7 -  ! Field strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipDATZ','Дата заключения договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipDAT_BEGIN','Дата начала договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipDAT_END','Дата окончания договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipID','Номер вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipVIDD','Вид вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipKV','Код валюты')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipProc','Текущая % ставка для вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipFIO','Вкладчик')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipPASP','Паспорт')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipPASPN','Серия, №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipVYDAN','Кем выдан паспорт')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipText','Комментарии')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipTT','Операции с основным счетом вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipNLS','Основной счет вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipOST_PL','Остаток на  основном счете вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipS_STOP','Сумма штрафа при досрочном закрытии вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipShtrafProc','Сумма начисленных % при штрафной % ставке')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipRealProc','Сумма начисленных % при реальной депозитной  % ставке')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipEarlyEnd','Дата досрочного расторжения вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipMFOP','МФО банка для перечисления %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipNLSP','Счет перечисления %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipOKPOP','Код ОКПО для перечисления %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipNAMEP','Наименование счета перечисления %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipNLSN','Счет начисленных %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipOSTN_PL','Остаток на счете начисленных %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipACR_DAT','Дата предыдущего начисления  %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipSTP_DAT','Дата предыдущего начисления  %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipTTN','Операции со счетом начисленных %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cFTipDeposComm','Комментарий')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.bgND','Депозитный вклад №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.bgDATZ','Заключение:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.bgDAT_BEGIN','Начало:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.bgDAT_END','Завершение:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.bgNLS','Основной счет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.bgPROC','Счет начисленных %%, выплата')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTmlText','Срок договора истек !')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTmlText1','Не забудьте доначислить проценты!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTmlText2','Не забудьте выплатить проценты!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTmltext3','Вклад является залогом по')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTmlText31','кредиту')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTmlText32','кредитам')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTNAZN', 'Повернення нарахованих %%.')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTNAZN_','Дострокове розірвання деп.договору №')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessTT','Не выбрана операция')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessProc','Для расчета штрафа нужно доначислить проценты')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessStop','Для данного договора не был проставлен вид штрафа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessDAT_END','Дата действия договора уже истекла')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessVyplProc','Еще не время выплачивать проценты!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessResProc','По данному вкладу недоначислены проценты!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessResYesProc','Для выплаты процентов нажмите Да')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessResNo','Для доначисления процентов нажмите Нет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessResCancel','Для отмены операции нажмите Отмена')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessResYesCapital','Для выплаты капитала нажмите Да')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessFlg1','Выполнить проводку на взыскание штрафа на сумму')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessFlg1_','Будет сформирован дополнительный платеж !')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessIdDrawing','Выполнить процедуру перерасчета %% при частичном снятии?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTMessACR_DAT','Необходимо доначислить %% до')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrKODZ_Full','Не указан код запроса для формирования сбер.книжки (полной)')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrKOZD_Brief','Не указан код запроса для формирования сбер.книжки (краткой)')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrOpRules','Невозможно выбрать значение из таблицы op_rules для операции')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrOstbDPS','Не могу вычислить плановый остаток после проводки штрафа DPS')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrIntAccn','Не могу удалить запись для id=3 в int_accn')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrIntRatn','Не могу удалить запись для id=3 в int_ratn')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrNotNLS67','Не описан счет расходов банка для счета №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrNLS67','Невозможно прочитать счет расходов банка')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrNMSA','Не найден счет начисленных %% для вклада №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrNazn','Ошибка формирования назначения платежа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrOplDPT','Невозможно оплатить операцию DPT на сумму')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Vklad.cTErrOplDPS','Невозможно оплатить операцию DPS')
.head 7 -  ! ====================================================
.head 7 -  ! frm_New
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTWndTitle','Открыть новый вклад')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cb_Kapital','На основной вклад')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cb_Fl2620','Открыть вклад "До востребования"')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cBTipClear','Очистить карточку открытия вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cBTipSave','Открыть новый вклад (F10)')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cBTipIndiVidd','Задать условия индивидуального вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cBTipField','Заполнить доп.реквизиты вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cBTipCancel','Завершить')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cBTipFindAcc','Найти счет')
.head 7 -  ! Field strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipRNK','Рег.№ клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipVIDD','Код вида вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipCmbVidd','Вид договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipNAME_KV','Валюта договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipMinSumm','Минимальная сумма вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipDurat_m','Срок договора в месяцах')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipDurat_d','Срок договора в днях')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipEarlyEnd','Дата досрочного расторжения договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipDatz','Дата заключения договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipOpen','Дата открытия договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipClose','Дата завершения договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipDAT_BRAT','Начало действия % ставки для вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipPROC','% ставка для вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipPROC_Real','% ставка для вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipProcPr','% ставка для вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipISP','Код исполнителя по открываемым счетам')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipCmbISP','Ф.И.О. исполнителя по открываемым счетам')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipMFO_P','МФО для перечисления %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipNb','Наименование банка для перечисления %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipNLS_P','Счет для перечисления %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipNAME_P','Наименование получателя')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cFTipOKPO_P','Код ОКПО получателя')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.gboxParams','Параметры вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.gboxDat','Даты договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.gboxProc','Выплата %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.gboxVklad','Возврат вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.gboxComment','Комментарий')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgID','Номер вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgNLS','Основной. счет: ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgNLSN','Счет начисл. %%: ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgNLSA','Счет амортизации: ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgVIDD','Вид вклада:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgKV','Валюта:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgMinSumm','Мин.сумма:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgDurat','Длит-ть:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgDatz','заключения')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgOpen','начала')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgClose','окончания')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgND','Договор №:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgSUM','Сумма:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgPROC','%:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgISP','Исп:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgMFO_P','МФО банка:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgNLS_P','Номер счета:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.bgNLS_Perecr','Номер счета:')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTName_early_end','Дата досрочного снятия')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTMessOpenVklad','Открытие вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTMessISP','Выберите ответ.исполнителя!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTMessVIDD','Задайте вид и срок вклада!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTMessRNK','Выберите клиента!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTMessGrn','грн')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTMessAccForRnk','Данный счет зарегистрирован за клиентом')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrOpenVklad','Ош.при Открытии вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrKV','Не выбрана валюта!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrVIDD','Не выбран вид вклада!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrISP','Не выбран исполнитель!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrSUM','Не указана сумма вклада!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrFilled','Не заполнены обязательные доп.реквизиты!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrDptOpen','Не указана дата открытия вклада!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrNotVIDD','Нет такого вида вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrEarlyEnd','Указанная дата досрочного расторжения меньше даты открытия вклада!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrSetSUM','Укажите сумму договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrSUMFormat','Недопустимый формат суммы!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrNotISP','Нет такого исполнителя')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrSetMFO_P','Введите правильный код МФО банка!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrNLS_KR','Ошибка в контрольном разряде номера счета!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrOKPO','Ошибка кода ОКПО!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrAccNotFound','Счет не существует!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_New.cTErrRekv','Ошибка заполнения реквизита.')
.head 7 -  ! ====================================================
.head 7 -  ! PORTF
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.cTWndTitle','Портфель исполнителя')
.head 7 -  ! columns
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.nISP','Исп')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.nID','№~вклада')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.sND','Номер~договора')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.sVID','Вид~вклада')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.sNMK','Имя~вкладчика')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.sKV','ВАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.sNLS','Лиц.счет')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.nPROC','%~ставка')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.nSs','Сумма~вклада')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.sNLSN','Лиц.счет~нач %')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.nSNs','Сумма~нач %')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.dDAT1','Дата~начала')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.dDAT2','Дата~конца')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.nStart','Срок~по дог~/мес')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.nEnd','Ост.~срока~/мес')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.cTItogo','Итого:')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.cBTipDetails','Действующий договор')
.head 7 -  Call CurrentLangTable.AddAtom('PORTF.cBTipPortfel_It','Итоги Портфеля исполнителя')
.head 7 -  ! ====================================================
.head 7 -  ! AS
.head 7 -  Call CurrentLangTable.AddAtom('AS.cTWndTitle','Закрытие вкладов в архив')
.head 7 -  Call CurrentLangTable.AddAtom('AS.rbDEP','Депозиты')
.head 7 -  Call CurrentLangTable.AddAtom('AS.rbPOT','До восстребования')
.head 7 -  Call CurrentLangTable.AddAtom('AS.rbFORE','Досрочное закрытие')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('AS.cbCheckAll', 'Отметить все вклады')
.head 7 -  ! columns
.head 7 -  Call CurrentLangTable.AddAtom('AS.ID','Вклад~№')
.head 7 -  Call CurrentLangTable.AddAtom('AS.ND','Номер~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('AS.RNK','Рег.~№~клиента')
.head 7 -  Call CurrentLangTable.AddAtom('AS.KV','Код~вал')
.head 7 -  Call CurrentLangTable.AddAtom('AS.NLS','Депозитный~счет')
.head 7 -  Call CurrentLangTable.AddAtom('AS.NMS','~Наименование счета')
.head 7 -  Call CurrentLangTable.AddAtom('AS.DAOS','Дата~открытия~вклада')
.head 7 -  Call CurrentLangTable.AddAtom('AS.DAPP','Дата~последнего~движения')
.head 7 -  Call CurrentLangTable.AddAtom('AS.ACRDAT','Дата~последнего~начисления %%')
.head 7 -  Call CurrentLangTable.AddAtom('AS.STPDAT','Стоп-дата~по~начислению %%')
.head 7 -  Call CurrentLangTable.AddAtom('AS.MDATE','Дата~погашения~ остатка')
.head 7 -  Call CurrentLangTable.AddAtom('AS.NLSI','Счет~начисленных~%%')
.head 7 -  Call CurrentLangTable.AddAtom('AS.DAPPI','Дата~последнего~движения')
.head 7 -  Call CurrentLangTable.AddAtom('AS.ISP','Ответ.~исп.')
.head 7 -  Call CurrentLangTable.AddAtom('AS.OTM','Отм')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('AS.TYPENAME', '~Вид вклада~')
.head 7 -  Call CurrentLangTable.AddAtom('AS.RATE',     'Проц.~ставка')
.head 7 -  Call CurrentLangTable.AddAtom('AS.COMMENTS', '~Комментарий по вкладу~')
.head 7 -  !
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('AS.cBTipDel','Закрыть отмеченные вклады')
.head 7 -  Call CurrentLangTable.AddAtom('AS.cBTipDetails','Карточка вклада')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('AS.cTVkladClose','Вклады: закрытие')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('AS.cTMessVkladClose','Закрыто вкладов')
.head 7 -  Call CurrentLangTable.AddAtom('AS.cTMessCloseOk','Выполнено успешно')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('AS.cTMessAcrClose','Возможно, по данному вкладу недоначислены проценты! Вы действительно хотите закрыть вклад')
.head 7 -  Call CurrentLangTable.AddAtom('AS.cTTitlAcrClose','Внимание!')
.head 7 -  ! ====================================================
.head 7 -  ! AR
.head 7 -  Call CurrentLangTable.AddAtom('AR.cTWndTitle','Просмотр архива закрытых вкладов')
.head 7 -  ! columns
.head 7 -  Call CurrentLangTable.AddAtom('AR.deposit_id','№~вклада')
.head 7 -  Call CurrentLangTable.AddAtom('AR.nd','Номер~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('AR.when_','Дата/время~изменения')
.head 7 -  Call CurrentLangTable.AddAtom('AR.action_name_','Наименование~изменения')
.head 7 -  Call CurrentLangTable.AddAtom('AR.nmk','ФИО вкладчика')
.head 7 -  Call CurrentLangTable.AddAtom('AR.kv','Вал')
.head 7 -  Call CurrentLangTable.AddAtom('AR.nls','Лиц/счет~вклада')
.head 7 -  Call CurrentLangTable.AddAtom('AR.type_name','Вид~вклада')
.head 7 -  Call CurrentLangTable.AddAtom('AR.pasp','Документ')
.head 7 -  Call CurrentLangTable.AddAtom('AR.paspn','Серия, №')
.head 7 -  Call CurrentLangTable.AddAtom('AR.vydan','Выдан')
.head 7 -  Call CurrentLangTable.AddAtom('AR.dat_begin','Дата~начала')
.head 7 -  Call CurrentLangTable.AddAtom('AR.dat_end','Дата~окончания')
.head 7 -  Call CurrentLangTable.AddAtom('AR.fio_','Автор~изменения')
.head 7 -  ! ====================================================
.head 7 -  ! AcrPay
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.cTWndTitle','Выплата  %%')
.head 7 -  ! columns
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.ID','№~вклада')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.ND','Номер~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.VOB','Вид~док.')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.TT','Код~оп.')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.NLS','Счет')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.KVA','ВАЛ~А')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.NMS','Отправитель')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.OKPO','ОКПО~отправителя')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.sSR','Сумма~документа')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.MFOB','МФО~получат.')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.NLSB','Счет получателя')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.KVB','ВАЛ~Б')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.NMKB','Получатель')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.OKPOB','ОКПО~получат.')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.NAZN','Назначение платежа')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.DK','Д/К')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.cBTipRun','Выполнить проводки')
.head 7 -  ! ====================================================
.head 7 -  ! CB_VVOD1
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cTWndTitle','Ввод документа')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cBTipHotFio','Печать доп.соглашения')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cTMessPayDocOpId0','Минимальная сумма вклада')
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cTMessPayDocOpId1','Минимальный дополнит.взнос')
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cTMessPayDocOpId33','Сумма платежа не может превышать')
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cTMessPayDocInsert','Невозможно вставить запись в таблицу OPERW!')
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cTMessFormDoc','Будет сформирован')
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cTMessTT','Не описана операция')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cTErrNazn','Ошибка формирования назначения платежа')
.head 7 -  ! ====================================================
.head 7 -  ! dlgBook
.head 7 -  Call CurrentLangTable.AddAtom('dlgBook.rbFull','целиком (с шапочкой)')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBook.rbBrief','только текст')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBook.pbRun','Просмотр')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('dlgBook.gboxPrint','Печатать')
.head 7 -  Call CurrentLangTable.AddAtom('dlgBook.gboxDAT','Укажите период')
.head 7 -  ! ====================================================
.head 7 -  ! dlgDrawing
.head 7 -  Call CurrentLangTable.AddAtom('dlgDrawing.cTWndTitle','Внимание')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlgDrawing.rbShtraf','досрочное расторжение договора')
.head 7 -  Call CurrentLangTable.AddAtom('dlgDrawing.rbDrawing','частичное снятие капитала')
.head 7 -  Call CurrentLangTable.AddAtom('dlgDrawing.rbFree','свободное снятие депозита')
.head 7 -  Call CurrentLangTable.AddAtom('dlgDrawing.pbOk','Выбрать')
.head 7 -  Call CurrentLangTable.AddAtom('dlgDrawing.gboxType','Выберите тип операции')
.head 7 -  ! ====================================================
.head 7 -  ! dlgFields
.head 7 -  Call CurrentLangTable.AddAtom('dlgFields.cTWndTitle','Дополнительные реквизиты вклада')
.head 7 -  Call CurrentLangTable.AddAtom('dlgFields.tbl.sTAG','Реквизит')
.head 7 -  Call CurrentLangTable.AddAtom('dlgFields.tbl.sNAME','Наименование')
.head 7 -  Call CurrentLangTable.AddAtom('dlgFields.tbl.nOBZ','ОБЗ')
.head 7 -  Call CurrentLangTable.AddAtom('dlgFields.tbl.sVALUE','Значение')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('dlgFields.cBTipOk','Сохранить данные и выйти')
.head 7 -  Call CurrentLangTable.AddAtom('dlgFields.cBTipExit1','Выйти без сохранения')
.head 7 -  Call CurrentLangTable.AddAtom('dlgFields.cBTipExit2','Завершить работу')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('dlgFields.cTUpdateDR','Изменен доп.реквизит для вклада №')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('dlgFields.cTMessDR','Не заполнен обязательный реквизит')
.head 7 -  Call CurrentLangTable.AddAtom('dlgFields.cTMessExit','Выйти без сохранения? Изменения будут утеряны!')
.head 7 -  ! ====================================================
.head 7 -  ! dlgSertificate
.head 7 -  Call CurrentLangTable.AddAtom('dlgSertificate.cTWndTitle','Задайте номер сертификата:')
.head 7 -  Call CurrentLangTable.AddAtom('dlgSertificate.pbOk','Утвердить')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('dlgSertificate.bgN','№ сертификата:')
.head 7 -  ! ====================================================
.head 7 -  ! dlgShtraf
.head 7 -  Call CurrentLangTable.AddAtom('dlgShtraf.cTWndTitle','Подробности расчета штрафа')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('dlgShtraf.bgDetails','Расчет штрафа')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('dlgShtraf.cTMessFileForm','Сформирован файл')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('dlgShtraf.cTErrFileWrite','Ошибка записи файла')
.head 7 -  Call CurrentLangTable.AddAtom('dlgShtraf.cTErrFileOpen','Невозможно открыть файл')
.head 7 -  ! ====================================================
.head 7 -  ! dlgStudents
.head 7 -  Call CurrentLangTable.AddAtom('dlgStudents.cTWndTitle','Выберите ВУЗ:')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlgStudents.pbOk','Утвердить')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('dlgStudents.bgINST','ВУЗ:')
.head 7 -  ! ====================================================
.head 7 -  ! frm_AcrPay
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.cTWndTitle','Параметры выплаты процентов по вкладу')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.gboxParams','Параметры выплаты процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.bgMFO','МФО')
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.bgNLS','Счет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.bgNAME','Наименование')
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.bgOKPO','Код ОКПО')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.cBTiprefresh','Перечитать')
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.cBTipSave','Сохранить')
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.cBTipExit','Завершить')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.cTErrRekv','Ошибка заполнения реквизита.')
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.cTErrMFO','Введите правильный код МФО банка!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.cTErrNLS','Ошибка в контрольном разряде номера счета!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_AcrPay.cTErrOKPO','Ошибка кода ОКПО!')
.head 7 -  ! ====================================================
.head 7 -  ! frm_IndiVidd
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cTWndTitle','Индивидуальный вклад')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cb_Amort','Выплата %% авансом')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cb_Kapital','Капитализация %%')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cBTipClear','Очистить')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cBTipSave','Открыть вклад с индивидуальными условиями')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cBTipCalc','Расчитать значение %-ной ставки')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cBTipCancel','Завершить')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.gboxParams','Параметры вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.gboxRate','Процентная ставка')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.gboxIndRate','Индивидуальные условия вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.gboxProc','Выплата процентов:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.gboxSn','Условия частичного снятия вклада:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.gboxSTOP','Штраф и довзнос')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.bgDURATION','Срок:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.bgKV','Валюта:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.bgMAX','MAX:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.bgRATE_REAL','Фактич.:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.bgFREQ','Периодичность:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.bgSUM','Сумма (в %):')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.bgCOUNT','Кол-во операций:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.bgSTOP','Штраф:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.bgADD','Пополнение:')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cTOpenVklad','Открытие вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cTIn','в течение')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cTInMonth','мес.')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cTInDay','дн.')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cTCount','без част.снятия')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cTCount_','раз в течении срока вклада')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cTErrOpenVklad','Ошибка при открытии вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_IndiVidd.cTErrProc','Не задан процент суммы част.снятия со вклада!')
.head 7 -  ! ====================================================
.head 7 -  ! frm_Student
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTWndTitle','Открытие вклада "Студенческий"')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.pbOpen','Открыть')
.head 7 -  ! Field strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipID_INST','Код ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipCmbINST','Наименование ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipNLS_D','Депозитный счет ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipNLS_P','Счет начисленных %% ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipACCC_D','Депозитный счет ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipACCC_P','Счет начисленных %% ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipNLS','Расчетный счет ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipOKPO','Код ОКПО ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipMFO','МФО банка, в котором обслуж.ВУЗ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipNB','Наименование банка, в котором обслуж.ВУЗ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipID_FK','Код факультета')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipCmbFK','Факультет выбранного ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipRATE','%-ная ставка по договору для данного факультета')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cFTipSUM','Сумма по договору для данного факультета')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.gboxINST','Выбор ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.gboxFK','Выбор факультета')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.bgINST','ВУЗ:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.bgNLSD','Счета ВУЗа:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.bgNLS','Расчетн.счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.bgMFO','в банке:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.bgFK','Факультет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.bgRATE','% ставка:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.bgSUM','Сумма:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.bgGRP','Код группы:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.bgND','№ договора:')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTNMS','Студент.вклад №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTNMSN','Нарах.%% по студент.вкладу №')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTMessOpenVklad','Открытие вклада')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrOpenVklad','Ошибка при открытии вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrINST','Не выбран ВУЗ!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrFK','Не выбран факультет!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrSUM','Не указана сумма договора!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrGRP','Не указана группа!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN1','Невозможно открыть договор')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN8','Невозможно открыть счет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN9','Невозможно вычитать счет расходов!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN10','Невозможно проставить дату закрытия')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN12','Нeуспешная запись в INT_ACCN')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN13','Нeуспешная запись в INT_RATN')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN14','Невозможно прочитать int_ratn для acc')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN19','Ошибка при выполнении процедуры dpt.p_rate_rise!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN20','Невозможно заполнить студ.карточку')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN21','Невозможно проставить счет консолидации (деп)')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN22','Невозможно проставить счет консолидации (%%)')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Student.cTErrF_OPEN23','Не описан вид вклада №')
.head 7 -  ! ====================================================
.head 7 -  ! PL_CARDS
.head 7 -  Call CurrentLangTable.AddAtom('PL_CARDS.cTWndTitle','Открытые счета клиента')
.head 7 -  Call CurrentLangTable.AddAtom('PL_CARDS.cNBS','Бал.~счет')
.head 7 -  Call CurrentLangTable.AddAtom('PL_CARDS.cTIP','Тип')
.head 7 -  Call CurrentLangTable.AddAtom('PL_CARDS.cNLS','Лицевой счет')
.head 7 -  Call CurrentLangTable.AddAtom('PL_CARDS.cKV','Вал')
.head 7 -  Call CurrentLangTable.AddAtom('PL_CARDS.cNMS','Наименование счета')
.head 7 -  Call CurrentLangTable.AddAtom('PL_CARDS.cDAOS','Дата~открытия')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('PL_CARDS.cBTipOk','Выбрать счет')
.head 7 -  ! ====================================================
.head 7 -  ! STUDENTS
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTWndTitle','Вклады студентов')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cID_INST','Код~ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cID_FK','Код~факульт.')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cUNICOD','Код вклада~UNIKOD')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cDPT_ID','Код вклада~Барс')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cNLS','Депозитный~счет')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cGROUP','№~группы')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cSUM_DOG','Сумма~договора')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cNAME_F_Win','Фамилия~студента')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cNAME_I_Win','Имя~студента')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cNAME_O_Win','Отчество~студента')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cNAME_GROUP_Win','№~группы')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cKOS','Кт~обороты')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cDOS','Дт~обороты')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cOSTC','Остаток~на вкладе')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cSUMMA','Сумма на~списание')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cSUM2PAY','Сумма к~оплате')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cOTM','Отм')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cBTipDetails','Карточка вклада')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cBTipIn','Принять файл от ВУЗа')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cBTipOut','Оплатить и отправить ВУЗу ведомость')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cBTipOutS1','Сформировать ВУЗу ведомость S1DDMMYY.INS')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTFileList','Список файлов от ВУЗов (SSDDMMYY.*)')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTFileSelect','Выбрать файл...')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTNAZN','Перерахування плати за навчання згідно відомості')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTMessOut','Произвести оплату и сформировать ведомость расхождений?')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTMessOutS1','Сформировать ведомость S1DDMMYY.INS?')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTMessFormFileOk','Успешно сформирован файл')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTMessDocRef','Документу присвоен РЕФ')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTMessF_PRINTOk','Ведомость расхождений успешно сформирована в файл')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTMessF_PRINTNotDelta','Расхождения отсутствуют!')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTMessPay','Сформировать повторно платежи по файлу')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTErrFileName','Неверное имя файла!')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTErrConnect','Ошибка подсоединения к Базе данных:')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTErrFilePay','Невозможно оплатить файл')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTErrFormVed','Невозможно сформировать ведомость расхождений!')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTErrFileSave','Невозможно обработать файл')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTErrFileSos','По файлу')
.head 7 -  Call CurrentLangTable.AddAtom('STUDENTS.cTErrFileSos_','были сформированы платежи!')
.head 7 -  ! ====================================================
.head 7 -  ! tblRatesReview 
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.cTWndTitle', 'Пересмотр процентных ставок по депозитным договорам физ.лиц')
.head 7 -  ! columns
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colDPT_ID',      '№~вклада~(числов.)')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colDPT_NUM',     '№~договора~(символ.)')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colDPT_DAT',     'Дата~заключения~договора')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colDAT_BEGIN',   'Дата~начала~договора')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colDAT_END',     'Дата~окончания~договора')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colTYPE_ID',     'Код~вида~вклада')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colTYPE_NAME',   'Наименование~вида~вклада')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colBR_ID',       'Код~базовой~ставки')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colBR_NAME',     'Наименование~базовой~ставки')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colCUST_ID',     ' ~РНК~ ')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colCUST_NAME',   'ФИО~вкладчика')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colACC_NUM',     'Номер~депозитного~счета')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colACC_ISO',     'Код~вал~ISO')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colACC_SALDO',   'Текущая~сумма~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colREVIEW_DATE', 'Дата~пересмотра~ставки')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colREVIEW_RATE', 'Новое~значение~ставки')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colCURR_RATE',   'Текущая~ставка')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.colMARKED',      ' ~Отм.~ ')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.cBTipUpdMarked', 'Установить новые ставки по ОТМЕЧЕННЫМ договорам')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.cBTipUpdAll',    'Установить новые ставки по ВСЕМ договорам')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.cTMessFixMarked','Вы действительно хотите установить новые ставки по ОТМЕЧЕННЫМ договорам?')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.cTMessFixAll',   'Вы действительно хотите установить новые ставки по ВСЕМ договорам (с учетом фильтра)?')
.head 7 -  Call CurrentLangTable.AddAtom('tblRatesReview.cTMessFixDone',  'Результат выполнения помещен в протокол!')
.head 7 -  !
.head 7 -  ! ====================================================
.head 6 -  Call DocWisInit( 'CB_VVOD1' )
.head 6 -  Set bApdInited = TRUE
.head 5 -  ! Call CurrentLangTable.SaveToFile('C:\\TEMP\\bars016.lng','RUS')
.head 5 -  Return bApdInited
.head 3 +  Function: Sel016	! __exported
.head 4 -  Description: Bars016_Selector
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nScan
.head 5 -  String: sPar1
.head 5 -  String: sPar2
.head 4 +  Actions
.head 5 -  ! надо вставить инициализацию apd
.head 5 -  Call IniBars016()
.head 5 +  Select Case nMode
.head 6 +  Case 1  !! контролер-операционист 
.head 7 +  If not IsWindow(hWin1)
.head 8 -  Set hWin1 = SalCreateWindow(frm_Kontr,hWndMDI,nPar,strPar01,strPar02,STRING_Null,1)
.head 7 -  Break
.head 6 +  Case 2  !! контролер-операционист с доступом по счетам
.head 7 +  If not IsWindow(hWin2)
.head 8 -  ! strPar01 - составной параметр TT1TT2|TT3TT4
.head 8 -  ! strPar02 - фильтр на закладки карточек клиента/счета
.head 8 -  Set nScan = SalStrScan(strPar01, '|')
.head 8 -  Set sPar1 = IifS(nScan=-1, strPar01, Subs(strPar01,1,nScan))
.head 8 -  Set sPar2 = IifS(nScan=-1, "", Subs(strPar01, nScan+2, Len(strPar01)-nScan-1))
.head 8 -  Set hWin2 = SalCreateWindow(frm_Kontr,hWndMDI,nPar,sPar1,sPar2,strPar02,1)
.head 7 -  Break
.head 6 +  Case 4  !! Закрытие вкладов
.head 7 +  If not IsWindow(hWin4)
.head 8 -  Set hWin4 = SalCreateWindow(AS, hWndMDI, nPar, strPar01, strPar02 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( AS )
.head 7 -  Break
.head 6 +  Case 9  !! Студенты
.head 7 +  If not IsWindow(hWin9)
.head 8 -  Set hWin9 = SalCreateWindow( STUDENTS, hWndMDI, nPar, strPar01, strPar02)
.head 7 -  Break
.head 6 +  Case 11 !! контролер-операционист без регистрации клиентов 
.head 7 +  If not IsWindow(hWin11)
.head 8 -  Set hWin11 = SalCreateWindow(frm_Kontr,hWndMDI,nPar,strPar01,strPar02,STRING_Null,0)
.head 7 -  Break
.head 6 +  Case 12 !! пересмотр процентных ставок
.head 7 +  If not IsWindow(hWin12)
.head 8 -  Set hWin12 = SalCreateWindow(tblRatesReview, hWndMDI, nPar, strPar01, strPar02)
.head 7 -  Break
.head 6 +  Case 20 !! Імпорт файлу CSV
.head 7 -  Return SalModalDialog( dlg_ImportCSV, hWndMDI, nPar )
.head 7 -  Break
.head 5 -  ! Переадресація на BARS039
.head 5 +  If (nMode > 100)
.head 6 -  Call Sel039(hWndParent, (nMode - 100), nPar, strPar01, strPar02 )
.head 3 +  ! Function: Ini016
.head 4 -    Description: инициализация библиотеки
.head 4 +    Returns 
.head 5 -    Boolean: 
.head 4 -    Parameters 
.head 4 -    Static Variables 
.head 4 +    Local variables 
.head 5 -    String: strPathToLangResources
.head 5 -    String: strLangId
.head 5 -    String: strFileName
.head 4 +    Actions 
.head 5 +    If not bApdInited
.head 6 -    Set strPathToLangResources = GetLangPath()
.head 6 -    Set strLangId = GetLang()
.head 6 -    Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars011.lng"
.head 6 +    If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -    Call CurrentLangTable.Init()
.head 6 -    Call DocWisInit( 'CB_VVOD1' )
.head 6 -    Set bApdInited = TRUE
.head 5 -    Return bApdInited
.head 3 +  Function: GetCardVklad	! __exported
.head 4 -  Description: Показати катрочку вкладу
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 5 -  Number: nDepId
.head 5 -  String: type_name
.head 5 -  String: nmk
.head 5 -  String: pasp
.head 5 -  String: paspn
.head 5 -  String: vydan
.head 5 -  String: TT1  !! код операции для полного снятия нал с депозитного счета
.head 5 -  String: TT2  !! код операции для полного снятия нал со счета начисл.%%
.head 5 -  String: CASH !! признак вечерней кассы и группы отделения 
                           !! или DPT_DEPOSIT_CLOS.IDUPD (для deposit_id < 0, т.е. из архива)
                           !! або для простого перегляду катки вкладу
.head 5 -  ! Доступ на закладки карточки счета
.head 5 -  String: sAccFilterOnTab
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call IniBars016()
.head 5 -  Call SalCreateWindow(frm_Vklad, hWnd, nDepId, type_name,nmk, pasp, paspn,
 vydan, TT1, TT2, CASH, sAccFilterOnTab)
.head 3 +  Function: ComparehWnd
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd1
.head 5 -  Window Handle: hWnd2
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If hWnd1 = hWnd2
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: getDecPoint
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SalStrMidX(SalNumberToStrX(1.1,1),1,1)
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
.head 3 +  ! Functional Class: cError
.winattr
.end
.head 4 -                                                                                                                              Description: Класс ошибки
.head 4 -                                                                                                                              Derived From 
.head 4 -                                                                                                                              Class Variables 
.head 4 +                                                                                                                              Instance Variables 
.head 5 -                                                                                                                              Number: nErr
.head 5 -                                                                                                                              Long String: sErrMsg
.head 4 -                                                                                                                              Functions 
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbExecute
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box: cCheckBoxLabeled
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box: cGenComboBox_NumId
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cXSalVSplitterInvisible
.head 2 -  Application Actions
.head 1 +  Table Window: PORTF
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Портфель исполнителя
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.27"
.head 4 -  Top:    0.642"
.head 4 -  Width:  13.533"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.393"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 55163
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.783"
.head 6 -  Begin Y:  -0.024"
.head 6 -  End X:  2.783"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.483"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.917"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Действующий договор
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('PORTF.cBTipDetails')
.head 6 +  On SAM_Click
.head 7 +  If nID != NUMBER_Null and not IsWindow(hWinV)
.head 8 +  If SqlPrepareAndExecute( hSql(),
"SELECT d.name,
 ltrim(rtrim(p.ser))  ||' '||ltrim(rtrim(p.numdoc)),
 ltrim(rtrim(p.ORGAN))||' '||to_char(p.PDATE,'dd-mm-yyyy')
 INTO :passp,:passpn,:vydan 
 FROM dpt_vidd v,  person p, passp d
WHERE p.rnk=:nRNK AND p.passp=d.passp(+) AND v.vidd=:nVID") 
and SqlFetchNext(hSql(),nFetchRes )
.head 9 -  Set hWinV = SalCreateWindow(frm_Vklad, hWndMDI, 
                            nID, sVID, sNMK, 
                            passp, passpn, vydan,
                            STRING_Null, STRING_Null, STRING_Null, sAccFilterOnTab)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.35"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 55164
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.933"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 55165
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbPortfel_It
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.217"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Summ.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Итоги Портфеля исполнителя
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('PORTF.cBTipPortfel_It')
.head 6 +  On SAM_Click
.head 7 -  Call Sel016f(hWndMDI, 0, GetUserId(), '', '')
.head 2 +  Contents
.head 3 +  Column: nISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исп
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.457"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
вклада
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.757"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.033"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nVID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sVID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
вклада
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.643"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nRNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sNMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя
вкладчика
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.214"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.514"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лиц.счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.514"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nPROC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
ставка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.843"
.head 4 -  Width Editable? Yes
.head 4 -  Format: 00000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
вклада
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.129"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nSs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
вклада
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nACCN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sNLSN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лиц.счет
нач %
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.614"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nSN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
нач %
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nSNs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
нач %
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dDAT1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
начала
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dDAT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
конца
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nStart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Срок
по дог
/мес
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.686"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ост.
срока
/мес
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.657"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nDig
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nGrp
.head 3 -  Number: nMod
.head 3 -  String: sAccFilterOnTab
.head 2 +  Window Variables
.head 3 -  Date/Time: BD
.head 3 -  Number: nFetchRes
.head 3 -  String: passp
.head 3 -  String: passpn
.head 3 -  String: vydan
.head 3 -  String: sF
.head 3 -  String: sFF
.head 3 -  !
.head 3 -  Number: nS1
.head 3 -  Number: nS2
.head 3 -  Number: nS3
.head 3 -  !
.head 3 -  Number: L
.head 3 -  Number: nOrderBy
.head 3 -  Window Handle: hColumn
.head 3 -  !
.head 3 -  Number: nMaxDig
.head 3 -  Number: nLastSortRow
.head 3 -  Number: nSortOrder
.head 3 -  Number: nNata
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('PORTF.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Set BD = GetBankDate()
.head 4 -  Set PORTF.fFilterAtStart = TRUE
.head 4 -  Set PORTF.nTabInstance = 1
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Set PORTF.strPrintFileName = 'DEP'
.head 4 -  Set PORTF.strFilterTblName = 'DPT_1'
.head 4 -  Set PORTF.strSqlPopulate =
"SELECT dpt_1.isp, dpt_1.id, dpt_1.nd, dpt_1.vidd, dpt_1.nam, dpt_1.kv, dpt_1.lcv, dpt_1.rnk,
        dpt_1.nmk, dpt_1.acc, dpt_1.nls, dpt_1.pr,
        dpt_1.s/100, dpt_1.datn, dpt_1.datk, dpt_1.accn, 
        decode(dpt_1.acc,dpt_1.accn,0,dpt_1.sn/100), dpt_1.srok, dpt_1.srok1, dpt_1.dig 
 INTO :PORTF.nISP, :PORTF.nID, :PORTF.sND, :PORTF.nVID, :PORTF.sVID,:PORTF.nKV,
      :PORTF.sKV,  :PORTF.nRNK, :PORTF.sNMK, :PORTF.nACC,:PORTF.sNLS,
      :PORTF.nPROC,:PORTF.nS,   :PORTF.dDAT1,:PORTF.dDAT2,:PORTF.nACCN,
      :PORTF.nSN, :PORTF.nStart,:PORTF.nEnd, :PORTF.nDig
 FROM dpt_1, saldo s
 WHERE dpt_1.acc=s.acc
 ORDER BY dpt_1.id"
.head 4 +  If DigInit() != -1
.head 5 -  Set nMaxDig=DigInit()
.head 4 +  Else
.head 5 -  ! ?
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set nNata = 1
.head 4 +  If fFilterAtStart
.head 5 -  Set fFilterAtStart = NOT fFilterAtStart
.head 5 +  If NOT SetQueryFilter( cF )
.head 6 -  Set nNata = 0
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 4 +  If nNata = 1
.head 5 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 5 -  Set sF = ""
.head 5 -  Set sFF = ""
.head 5 -  Set sF = cF.GetFilterWhereClause( FALSE )
.head 5 -  Set sFF = cF.GetFilterFromClause( FALSE )
.head 5 +  If sF != ""
.head 6 -  Set sF=" AND "|| sF
.head 5 +  If sFF != ""
.head 6 -  Set sFF = ","||sFF
.head 5 -  ! Итоговая строка
.head 5 -  Call SalTblDefineSplitWindow ( hWndForm, 1 , TRUE )
.head 5 -  Call SalTblSetContext ( hWndForm, SalTblInsertRow ( hWndForm, TBL_MinRow ) )
.head 5 +  If SqlPrepareAndExecute(hSqlAux(),T(
   "SELECT to_char(count(*)), 
           sum(gl.p_icurval(dpt_1.kv,dpt_1.s,:BD)),
           sum(gl.p_icurval(dpt_1.kv,dpt_1.sn,:BD)),
           sum(gl.p_icurval(dpt_1.kv,dpt_1.s,:BD)*dpt_1.srok),
           sum(gl.p_icurval(dpt_1.kv,dpt_1.s,:BD)*dpt_1.pr*dpt_1.srok),
           sum(gl.p_icurval(dpt_1.kv,dpt_1.s,:BD)*dpt_1.srok1)
    INTO :PORTF.sNLS,:PORTF.nS,:PORTF.nSN,:PORTF.nS1,:PORTF.nS2,:PORTF.nS3
    FROM dpt_1, saldo s"||sFF||" 
    WHERE dpt_1.acc=s.acc "|| sF))
and SqlFetchNext( hSqlAux(),nFetchRes )
.head 6 +  If PORTF.nS1 !=NUMBER_Null and PORTF.nS1>0 !! Средневзвешенная % ставка
.head 7 -  Set PORTF.nPROC = PORTF.nS2 / PORTF.nS1
.head 6 +  If PORTF.nS !=NUMBER_Null and PORTF.nS>0 !! Средневзвешенный срок размещения и остаток срока
.head 7 -  Set PORTF.nStart= PORTF.nS1 / PORTF.nS
.head 7 -  Set PORTF.nEnd  = PORTF.nS3 / PORTF.nS
.head 6 -  ! Итого:
.head 6 -  Set sVID = CurrentLangTable.GetAtomTitle('PORTF.cTItogo')
.head 6 -  Set PORTF.nS  = PORTF.nS /100
.head 6 -  Set PORTF.nSN = PORTF.nSN/100
.head 6 -  Set nSs  = Dig4( nS, 2, 2 )
.head 6 -  Set nSNs = Dig4( nSN, 2, 2 )
.head 6 -  !
.head 5 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_New, FALSE,0,0 )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_FetchRowDone
.head 4 +  If nS != NUMBER_Null
.head 5 -  Set nSs  = Dig4(nS, nDig, nMaxDig)
.head 4 +  If nSN != NUMBER_Null
.head 5 -  Set nSNs = Dig4(nSN, nDig, nMaxDig)
.head 4 +  If (PORTF.dDAT2=DATETIME_Null) OR (PORTF.dDAT2 > BD)
.head 5 -  Call SetTblRowColor( PORTF, COLOR_Black )
.head 4 +  Else If PORTF.dDAT2 = BD
.head 5 -  Call SalTblSetCellTextColor( nID, COLOR_Blue, FALSE )
.head 5 -  Call SalTblSetCellTextColor( sVID, COLOR_Blue, FALSE )
.head 5 -  Call SalTblSetCellTextColor( sNMK, COLOR_Blue, FALSE )
.head 5 -  Call SalTblSetCellTextColor( sND, COLOR_Blue, FALSE )
.head 4 +  Else
.head 5 -  Call SalTblSetCellTextColor( nID, COLOR_Red, FALSE )
.head 5 -  Call SalTblSetCellTextColor( sVID, COLOR_Red, FALSE )
.head 5 -  Call SalTblSetCellTextColor( sNMK, COLOR_Red, FALSE )
.head 5 -  Call SalTblSetCellTextColor( sND, COLOR_Red, FALSE )
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor ( TRUE )
.head 4 +  If wParam != nLastSortRow
.head 5 -  Set nLastSortRow = wParam
.head 5 -  Set nSortOrder = TBL_SortIncreasing
.head 4 +  Else
.head 5 -  Set nSortOrder = 1 - nSortOrder
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( PORTF, SalTblQueryColumnID( nSs ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( PORTF, SalTblQueryColumnPos( nS ), COL_GetID ))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( PORTF, SalTblQueryColumnID( nSNs ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( PORTF, SalTblQueryColumnPos( nSN ), COL_GetID ))
.head 4 -  !
.head 4 -  Set hColumn = SalNumberToWindowHandle( wParam )
.head 4 -  Call SalTblSetColumnFlags( hColumn, COL_Selected, FALSE )
.head 4 -  Call SalTblSortRows( hWndForm, SalTblQueryColumnID( hColumn ), nSortOrder )
.head 4 -  Call SalSendMsg (hWndForm, SAM_RowSetContext, 0, 0 )
.head 4 -  Call SalWaitCursor ( FALSE )
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg( pbDetails, SAM_Click, 0, 0 )
.head 1 +  Table Window: tblRatesReview
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Пересмотр процентных ставок по депозитным договорам физ.лиц
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  17.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.298"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.767"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Установить новые ставки по ОТМЕЧЕННЫМ договорам          
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tblRatesReview.cBTipUpdMarked')
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set nRow = TBL_MinRow
.head 7 -  ! Вы действительно хотите установить новые ставки по ОТМЕЧЕННЫМ договорам?
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('tblRatesReview.cTMessFixMarked'),
                 CurrentLangTable.GetAtomTitle('cTAt'), 
                 MB_YesNo) = IDYES
.head 8 +  Loop
.head 9 +  If SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 10 -  Call SalTblSetContext(hWndForm, nRow)
.head 10 +  If (nRow >= 0 AND tblRatesReview.colMARKED)
.head 11 +  If SqlPLSQLCommand(hSql(), "dpt.fix_rate_review (tblRatesReview.colDPT_ID,'')")
.head 12 -  Call SqlCommit(hSql())
.head 11 +  Else
.head 12 -  Call SqlRollback(hSql())
.head 9 +  Else
.head 10 -  Break
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbUpdateAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.4"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SAVE_M.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Установить новые ставки по ВСЕМ договорам
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('tblRatesReview.cBTipUpdAll')
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  ! Вы действительно хотите установить новые ставки по ВСЕМ договорам (c учетом фильтра)?
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('tblRatesReview.cTMessFixAll'),
                 CurrentLangTable.GetAtomTitle('cTAt'), 
                 MB_YesNo) = IDYES
.head 8 +  If SqlPLSQLCommand(hSql(), "dpt.fix_rate_review (0, sInnerFilter)")
.head 9 -  Call SqlCommit(hSql())
.head 9 -  ! Результат выполнения помещен в протокол
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('tblRatesReview.cTMessFixDone'),
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_IconInformation)
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWinV)
.head 8 -  Set hWinV = SalCreateWindow(frm_Vklad, 
                            hWndMDI, 
                            tblRatesReview.colDPT_ID, 
                            tblRatesReview.colTYPE_NAME, 
                            tblRatesReview.colCUST_NAME, 
                            STRING_Null,
                            STRING_Null,
                            STRING_Null,
                            STRING_Null, 
                            STRING_Null, 
                            STRING_Null,
                            STRING_Null)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 64811
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 64810
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 64809
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 34185
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  0.65"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  0.65"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 34184
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.3"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  1.3"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 2 +  Contents
.head 3 +  Column: colMARKED
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Отм.
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? No
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDPT_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
вклада
(числов.)
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDPT_NUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
договора
(символ.)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Left
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDPT_DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заключения
договора
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDAT_BEGIN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
начала
договора
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDAT_END
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
окончания
договора
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTYPE_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вида
вклада
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTYPE_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
вида 
вклада
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.117"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCUST_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
РНК

.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.983"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCUST_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ФИО 
вкладчика
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.183"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREVIEW_DATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
пересмотра
ставки
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREVIEW_RATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Новое 
значение 
ставки
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: 00000
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCURR_RATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Текущая
ставка
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: 00000
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colACC_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colACC_NUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
депозитного
счета
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.833"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colACC_CUR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colACC_ISO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал
ISO
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Center
.head 4 -  Width:  0.617"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colACC_SALDO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Текущая
сумма
депозита
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.583"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: ###000
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBR_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
базовой
ставки
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBR_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
базовой
ставки
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.05"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: sPar
.head 3 -  String: sOuterFilter
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  String: sInnerFilter
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  !
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tblRatesReview.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set tblRatesReview.strPrintFileName = 'dptratereview'
.head 4 -  Set tblRatesReview.strFilterTblName = 'v_dptreviewratedeals'
.head 4 -  Call cF.Init('v_dptreviewratedeals', 'v_dptreviewratedeals')
.head 4 -  Set tblRatesReview.nTabInstance     = 1
.head 4 -  Set tblRatesReview.fFilterAtStart   = TRUE
.head 4 -  Call SalDisableWindow( pbIns )
.head 4 -  Call SalDisableWindow( pbDel )
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  !
.head 4 -  Call SalWaitCursor(TRUE)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg(pbDetails, SAM_Click, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Set sInnerFilter = cF.GetFilterWhereClause(FALSE)
.head 4 -  Set tblRatesReview.strSqlPopulate =
"SELECT 0, dpt_id, dpt_num, dpt_dat, dat_begin, dat_end, 
        type_id, type_name, br_id, br_name, 
        cust_id, cust_name,  acc_id, acc_num, acc_cur, acc_iso, acc_saldo/100, 
        review_date, review_rate, curr_rate
  INTO  :tblRatesReview.colMARKED,
        :tblRatesReview.colDPT_ID,
        :tblRatesReview.colDPT_NUM, 
        :tblRatesReview.colDPT_DAT, 
        :tblRatesReview.colDAT_BEGIN, 
        :tblRatesReview.colDAT_END, 
        :tblRatesReview.colTYPE_ID, 
        :tblRatesReview.colTYPE_NAME, 
        :tblRatesReview.colBR_ID, 
        :tblRatesReview.colBR_NAME, 
        :tblRatesReview.colCUST_ID, 
        :tblRatesReview.colCUST_NAME,
        :tblRatesReview.colACC_ID,
        :tblRatesReview.colACC_NUM,
        :tblRatesReview.colACC_CUR,
        :tblRatesReview.colACC_ISO,
        :tblRatesReview.colACC_SALDO, 
        :tblRatesReview.colREVIEW_DATE, 
        :tblRatesReview.colREVIEW_RATE, 
        :tblRatesReview.colCURR_RATE
   FROM v_dptreviewratedeals 
  WHERE 1 = 1" ||
IifS(sInnerFilter = STRING_Null, " ", " AND "||sInnerFilter) ||
IifS(sOuterFilter = STRING_Null, " ", " AND "||sOuterFilter) ||
" ORDER BY dpt_id"
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), hWndForm.tblRatesReview.strSqlPopulate, TBL_FillAll)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Form Window: frm_Kontr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Контролер - ОПЕРАЦИОНИСТ
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.17"
.head 4 -  Top:    0.392"
.head 4 -  Width:  14.367"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.417"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Arial
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Контролер-ОПЕРАЦИОНИСТ
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.381"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: Poisk	! Поиск Клиента
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001800 42696C6C5F303109 42696C6C5F303209
0020: 42696C6C5F303300 000000
.enddata
.data CLASSPROPSSIZE
0000: 2B00
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.15"
.head 6 -  Top:    0.107"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Поиск Клиента
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipPoisk')
.head 6 +  On SAM_Click
.head 7 -  Set sWHERE=''   !! Ищем депозит
.head 7 -  Set sWHERE1=''  !! Ищем клиента 
.head 7 +  If frm_Client.man_nm !=''                !! по ФИО 
.head 8 -  Set nKol=1
.head 8 -  Set sModiFio=VisStrSubstitute( frm_Client.man_nm, '*', '%' )
.head 8 -  Set sModiFio=VisStrSubstitute( sModiFio,          '?', '_' )
.head 8 -  Set sWHERE1="upper(c.nmk) like upper('"|| sModiFio ||"%')" 
.head 7 +  Else If frm_Client.regNk !=NUMBER_Null   !! по RNK
.head 8 -  Set nKol=1
.head 8 -  Set sWHERE1="c.rnk="||Str(frm_Client.regNk)
.head 7 +  Else If frm_Client.Ausv !=''             !! по № пасп
.head 8 -  Set nKol=1
.head 8 +  If SqlPrepareAndExecute( hSql(),
"SELECT rnk INTO :frm_Client.regNk FROM person 
 WHERE upper(numdoc)=upper(:frm_Client.Ausv)" )
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Set sWHERE1="c.rnk="||Str(frm_Client.regNk)
.head 7 +  Else If frm_Client.id_cod !=''           !! по ОКПО
.head 8 -  Set nKol=1
.head 8 -  Set sWHERE1="c.okpo like upper('"|| frm_Client.id_cod ||"%')"
.head 7 +  Else If frm_Client.dpt_id != NUMBER_Null !! по № вкл
.head 8 -  Set nKol=1
.head 8 -  Set sWHERE="d.deposit_id="||Str(frm_Client.dpt_id)
.head 7 +  Else If frm_Client.dpt_nls !=NUMBER_Null !! по счету
.head 8 -  Set nKol=1
.head 8 -  Set sWHERE="a.nls="||Str(frm_Client.dpt_nls)
.head 7 +  Else If frm_Client.nd !=''               !! по номеру договора
.head 8 -  Set nKol=1
.head 8 -  Set sWHERE="UPPER(d.nd) like upper('"|| frm_Client.nd ||"%')"
.head 7 +  If sWHERE != ''  
.head 8 -  Set Sql_sent=
"SELECT a.kv, a.ostc/100, a.nls, c.nmk, v.type_name, 
        d.deposit_id, d.nd, a.acc, c.rnk, d.vidd, 
        d.dat_begin, d.dat_end, 
        ps.name, ltrim(rtrim(p.ser))||' '||ltrim(rtrim(p.numdoc)),
        c.adr, c.okpo, 
        ltrim(rtrim(p.ORGAN))||' '||to_char(p.PDATE,'dd-mm-yyyy'), 
        t.dig, c.codcagent, a.tobo
   FROM dpt_deposit d, saldo a, customer c, dpt_vidd v, 
        person p, tabval t, passp ps 
   INTO :ShowTbl.kv,        :ShowTbl.ostc,         :ShowTbl.nls,
        :ShowTbl.nmk,       :ShowTbl.type_name,    :ShowTbl.deposit_id, 
        :ShowTbl.nd,        :ShowTbl.acc,          :ShowTbl.rnk,      
        :ShowTbl.vidd,      :ShowTbl.dat_begin,    :ShowTbl.dat_end,  
        :ShowTbl.pasp,      :ShowTbl.paspn,    
        :ShowTbl.adr,       :ShowTbl.okpo,         :ShowTbl.vydan,        
        :ShowTbl.dig,       :ShowTbl.colKodcAgent, :ShowTbl.tobo
  WHERE c.date_off IS NULL 
    AND c.custtype = 3
    AND c.rnk = p.rnk
    AND c.rnk = d.rnk
    AND a.acc = d.acc
    AND v.vidd = d.vidd 
    AND a.kv = t.kv
    AND p.passp = ps.passp(+) " ||
 IifS(nShowCallDpt = 0, " AND v.vidd >= 0 AND ", " AND ")||          
 sWHERE ||
" ORDER BY 6, 4"
.head 8 -  Call SalWaitCursor ( TRUE )
.head 8 -  Call SalTblPopulate ( ShowTbl, hSql(), Sql_sent, TBL_FillAll )
.head 8 -  Call SalWaitCursor ( FALSE )
.head 8 -  Call SalTblSetContext( ShowTbl, 0 )
.head 8 -  Call SalTblSetRowFlags( ShowTbl, 0, ROW_Selected, TRUE )
.head 8 -  Call SalSendMsg( ShowTbl, SAM_RowSetContext, 0,0)
.head 7 +  Else
.head 8 +  If sWHERE1 != ''  
.head 9 -  Set Sql_sent=
"SELECT a.kv, a.ostc/100, a.nls, c.nmk, v.type_name, 
        d.deposit_id, d.nd, a.acc, c.rnk, d.vidd, 
        d.dat_begin, d.dat_end, 
        ps.name, ltrim(rtrim(p.ser))||' '||ltrim(rtrim(p.numdoc)),
        c.adr, c.okpo, 
        ltrim(rtrim(p.organ))||' '||to_char(p.pdate,'dd-mm-yyyy'), 
        t.dig, c.codcagent, a.tobo
   FROM dpt_deposit d, saldo a, customer c, dpt_vidd v, 
        person p, tabval t, passp ps 
   INTO :ShowTbl.kv,        :ShowTbl.ostc,         :ShowTbl.nls,
        :ShowTbl.nmk,       :ShowTbl.type_name,    :ShowTbl.deposit_id,
        :ShowTbl.nd,        :ShowTbl.acc,          :ShowTbl.rnk, 
        :ShowTbl.vidd,      :ShowTbl.dat_begin,    :ShowTbl.dat_end,  
        :ShowTbl.pasp,      :ShowTbl.paspn,    
        :ShowTbl.adr,       :ShowTbl.okpo,         :ShowTbl.vydan,    
        :ShowTbl.dig,       :ShowTbl.colKodcAgent, :ShowTbl.tobo
  WHERE c.date_off IS NULL 
    AND c.custtype = 3        
    AND c.rnk = p.rnk 
    AND c.rnk = d.rnk 
    AND a.acc = d.acc   
    AND v.vidd = d.vidd
    AND a.kv = t.kv     
    AND p.passp = ps.passp(+) " ||
IifS(nShowCallDpt = 0, " AND v.vidd >= 0 AND ", " AND ")||
sWHERE1||"
UNION ALL 
SELECT to_number(NULL), to_number(NULL), to_char(NULL), c.nmk, to_char(NULL), 
       to_number(NULL), to_char(NULL), to_number(NULL), c.rnk, to_number(NULL), 
       to_date(NULL), to_date(NULL), 
       ps.name, 
       ltrim(rtrim(p.ser))||' '||ltrim(rtrim(p.numdoc)), c.adr, c.okpo, 
       ltrim(rtrim(p.organ))||' '||to_char(p.pdate,'dd-mm-yyyy'), 
       to_number(NULL), c.codcagent, ''
  FROM customer c, person p, passp ps    
 WHERE c.date_off is null 
   AND c.custtype = 3 
   AND c.rnk = p.rnk 
   AND nvl(c.sed,0) != '91  ' 
   AND p.passp = ps.passp(+) 
   AND NOT EXISTS 
      (SELECT 1 FROM dpt_deposit d, saldo s 
        WHERE d.acc = s.acc AND d.rnk IS NOT NULL AND d.rnk = c.rnk)  
   AND "|| sWHERE1 ||"
ORDER BY 6,4 "
.head 9 -  ! - - - - - - - - - - - - - - - - - - - - - - - - -  -
.head 9 -  Call SalWaitCursor ( TRUE )
.head 9 -  Call SalTblPopulate ( ShowTbl, hSql(), Sql_sent, TBL_FillAll )
.head 9 -  Call SalWaitCursor ( FALSE )
.head 9 -  Call SalTblSetContext( ShowTbl, 0 )
.head 9 -  Call SalTblSetRowFlags( ShowTbl, 0, ROW_Selected, TRUE )
.head 9 -  Call SalSendMsg( ShowTbl, SAM_RowSetContext, 0,0)
.head 4 +  Pushbutton: pbNewK	! Регистрация нового клиента
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.717"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Newrec.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Регистрация нового клиента
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipNewK')
.head 6 +  On SAM_Click
.head 7 -  Call SalSetFocus(frm_Client.man_nm)
.head 7 -  Call EditCustPerson( 0, 0, hWndForm )
.head 7 -  Set frm_Client.man_nm = frm_Client.man_nm
.head 4 +  Pushbutton: pbClear	! Очистить поля поиска
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.633"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Очистить поля поиска
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipClear')
.head 6 +  On SAM_Click
.head 7 -  Set frm_Client.man_nm=STRING_Null
.head 7 -  Set frm_Client.dpt_nls=NUMBER_Null
.head 7 -  Set frm_Client.dpt_id=NUMBER_Null
.head 7 -  Set frm_Client.regNk=NUMBER_Null
.head 7 -  Set frm_Client.Ausv=STRING_Null
.head 7 -  Set frm_Client.id_cod=STRING_Null
.head 7 -  Set frm_Client.nd=STRING_Null
.head 7 -  Call SalSetFocus(frm_Client.man_nm)
.head 4 +  Pushbutton: pbVidd	! Общие параметры видов вкладов
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.183"
.head 6 -  Top:    0.024"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Общие параметры видов вкладов
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipVidd')
.head 6 +  On SAM_Click
.head 7 -  Call Sel016f(hWndMDI, 2, 0, "", " ")
.head 4 +  Pushbutton: pbPROC
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    0.024"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Начисление процентов
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipPROC')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(pbFilter,SAM_Click,wParam, lParam)
.head 7 -  Call Sel010(hWndForm,0,0,
" AND i.id IN (0,1) 
  AND (s.acc IN (SELECT d.acc FROM dpt_1 d WHERE 1=1 " ||sFilt|| "))","" )
.head 4 +  Pushbutton: pbPortfel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    0.024"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Портфель исполнителя
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipPortfel')
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWinP) 
.head 8 -  Set hWinP= SalCreateWindow( PORTF, hWndMDI, nGrp, 0, sAccFilterOnTab)
.head 4 +  Pushbutton: pbPortfel_It
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    0.024"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Summ.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Итоги портфеля исполнителя
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipPortfel_It')
.head 6 +  On SAM_Click
.head 7 -  Call Sel016f (hWndMDI, 0, GetUserId(), '','')
.head 4 +  Pushbutton: pb_Tab	! Табличная форма счетов исполнителя
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.517"
.head 6 -  Top:    0.024"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Табличная форма счетов исполнителя
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipTab')
.head 6 +  On SAM_Click
.head 7 -  Call ShowAccList(ID,AVIEW_USER,AVIEW_AllOptions|AVIEW_NoClose,
" a.acc in (select acc from dpt_deposit) " || "#" || sAccFilterOnTab) 
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.617"
.head 6 -  Top:    0.024"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delete.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Закрытие вкладов в архив
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipDelete')
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor( TRUE )
.head 7 +  If not IsWindow(hWinZS)
.head 8 -  Set hWinZS = SalCreateWindow( AS, hWndMDI,GetUserId(), '', '')
.head 7 -  Call SalWaitCursor( FALSE )
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.233"
.head 6 -  Top:    0.024"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Завершить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipCancel')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Pushbutton: pbArch	! Просмотр архива
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.05"
.head 6 -  Top:    0.024"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Просмотр архива
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipArch')
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWinA) 
.head 8 -  Set hWinA= SalCreateWindow( AR, hWndMDI, 0, sAccFilterOnTab)
.head 4 +  Pushbutton: pbAuto_P
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    0.024"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Tudasuda.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: 3D Face Color
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Автопереоформление договоров
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipAuto_P')
.head 6 +  On SAM_Click
.head 7 -  Call Sel016f (hWndMDI, 5, GetUserId(), '','')
.head 4 +  Pushbutton: pbKapital
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.024"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_fins.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выплата процентов
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipKapital')
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow(AcrPay,hWndMDI, 1, " ", "1", sTT_P )
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Предустановить фильтр
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipFilter')
.head 7 -  Call cF.Init('DPT_1', 'D')
.head 6 +  On SAM_Click
.head 7 -  Set sFilt = ''
.head 7 +  If SetQueryFilter( cF )
.head 8 -  Set sFilt=cF.GetFilterWhereClause( FALSE )
.head 8 +  If sFilt !=STRING_Null 
.head 9 -  Set sFilt = ' AND '|| sFilt
.head 4 +  Pushbutton: pbAmort
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.933"
.head 6 -  Top:    0.024"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Амортизация начисленных процентов
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipAmort')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(pbFilter,SAM_Click,wParam, lParam)
.head 7 -  Call Sel010(hWndForm,0,0,
" AND i.id IN (0,1) 
  AND s.acc IN (SELECT i.acrb FROM int_accn i, dpt_1 d WHERE i.acc=d.acc " ||sFilt|| ") " ," " )
.head 4 -  Line
.head 5 -  Resource Id: 35491
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.5"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  1.5"
.head 6 -  End Y:  0.381"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 35492
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.05"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  3.05"
.head 6 -  End Y:  0.369"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 35493
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.067"
.head 6 -  Begin Y:  -0.048"
.head 6 -  End X:  5.067"
.head 6 -  End Y:  0.357"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 2 +  Contents
.head 3 +  Child Table: ShowTbl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.25"
.head 6 -  Top:    3.429"
.head 6 -  Width:  12.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 30000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: deposit_id
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № вклада
(системный)
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.233"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: tobo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Подразделение
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: kv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.443"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: nd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № договора
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: nls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Лицевой счет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: nmk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ФИО вкладчика
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: pasp
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Документ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: paspn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Серия,№
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: vydan
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выдан
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: okpo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OKPO
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.614"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: adr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ADRES
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.614"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: vidd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
вида
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.733"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: type_name
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вид вклада
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: acc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.267"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: rnk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.267"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ostc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тек остаток
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.143"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ostcs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тек остаток
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: dat_begin
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
начала
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: dat_end
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
 окончания
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: dig
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKodcAgent
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: L
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 5 -  Boolean: fNoReposition   ! Не использовать настройку положения колонок 
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If ( deposit_id = NUMBER_Null )
.head 7 -  Call SalSendMsg( pbNewV, SAM_Click, 0, 0 )
.head 6 +  Else
.head 7 +  If deposit_id AND nls
.head 8 -  Call SalSendMsg( pbEditV, SAM_Click, 0, 0 )
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call cCstTab.Init(hWndForm, 1, GetUserLoginName(), NOT fNoReposition)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If dat_end <GetBankDate() and dat_end != DATETIME_Null
.head 7 -  Call SalTblSetCellTextColor( dat_end, COLOR_Red, FALSE )
.head 7 -  Call SalTblSetCellTextColor( nls, COLOR_Red, FALSE )
.head 6 +  If dat_end =GetBankDate() and dat_end != DATETIME_Null
.head 7 -  Call SalTblSetCellTextColor( dat_end, COLOR_Blue, FALSE )
.head 7 -  Call SalTblSetCellTextColor( nls, COLOR_Blue, FALSE )
.head 6 +  If NOT SalIsNull( ostc )
.head 7 -  Set ostcs = Dig4( ostc, dig, nMaxDig )
.head 6 +  Else
.head 7 -  Set ostcs = STRING_Null
.head 5 +  On SAM_RowSetContext
.head 6 +  If ShowTbl.rnk
.head 7 -  Call SalEnableWindow( frm_tblButtn.pbEditK )
.head 7 -  Call SalEnableWindow( frm_tblButtn.pbNewV )
.head 7 +  If GetGlobalOption( 'DPT_STUD' )
.head 8 -  Call SalEnableWindow( frm_tblButtn.pbNewStud )
.head 7 +  Else
.head 8 -  Call SalDisableWindow( frm_tblButtn.pbNewStud )
.head 7 +  If ShowTbl.deposit_id AND ShowTbl.nls
.head 8 -  Call SalEnableWindow( frm_tblButtn.pbCreate )
.head 8 -  Call SalEnableWindow( frm_tblButtn.pbEditV )
.head 7 +  Else
.head 8 -  Call SalDisableWindow( frm_tblButtn.pbCreate )
.head 8 -  Call SalDisableWindow( frm_tblButtn.pbEditV )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( frm_tblButtn.pbCreate )
.head 7 -  Call SalDisableWindow( frm_tblButtn.pbEditV )
.head 7 -  Call SalDisableWindow( frm_tblButtn.pbEditK )
.head 7 -  Call SalDisableWindow( frm_tblButtn.pbNewV )
.head 7 -  Call SalDisableWindow( frm_tblButtn.pbNewStud )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set hColumn = SalNumberToWindowHandle( wParam )
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 -  Call SalTblSortRows( hWndForm, SalTblQueryColumnID( hColumn ), nOrderBy )
.head 6 -  Call SalTblSetColumnFlags( hColumn, COL_Selected, FALSE )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On SAM_CornerClick
.head 6 -  Call SetTblColumnStatus( hWndForm, cCstTab )
.head 5 +  On WM_Paint
.head 6 -  Call cCstTab.MarkTableAsCustomisable(  )
.head 3 +  Pushbutton: pbCreate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbPrint
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    2.071"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call cdoc_ShowAllDocs( ShowTbl.deposit_id, frm_Kontr )
.head 3 +  Pushbutton: pbEditK 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbEdit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.7"
.head 5 -  Top:    -0.429"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Изменение/Просмотр реквизитов клиента
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipEditK')
.head 5 +  On SAM_Click
.head 6 -  Call EditCustPersonEx(ShowTbl.rnk, 0, hWndMDI, 0, sCustFilterOnTab || '##' || sAccFilterOnTab, FALSE)
.head 3 +  Pushbutton: pbNewV  
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    0.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Новый договор
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipNewV')
.head 5 +  On SAM_Click
.head 6 +  If not IsWindow(hWinN) and ShowTbl.rnk >0 
.head 7 -  Set hWinN= SalCreateWindow( frm_New, hWndMDI, nGrp,
ShowTbl.rnk, ShowTbl.nmk, NUMBER_Null,
ShowTbl.pasp,ShowTbl.okpo,ShowTbl.adr, ShowTbl.colKodcAgent,sTT_P)
.head 3 +  Pushbutton: pbEditV 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.129"
.head 5 -  Top:    1.188"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Действующий договор
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Kontr.cBTipEditV')
.head 5 +  On SAM_Click
.head 6 +  If ShowTbl.deposit_id != NUMBER_Null and not IsWindow(hWinV)
.head 7 -  Set hWinV= SalCreateWindow(frm_Vklad, hWndMDI, 
                           ShowTbl.deposit_id, ShowTbl.type_name, ShowTbl.nmk,  
                           ShowTbl.pasp,       ShowTbl.paspn,     ShowTbl.vydan, 
                           TT1,                TT2,               EVE_CASH, sAccFilterOnTab)
.head 6 +  If IsWindow(hWinV) 
.head 7 +  If frm_Vklad.deposit_id != ShowTbl.deposit_id
.head 8 -  Call SalSendMsg(frm_Vklad, SAM_Close,0,0)
.head 8 -  Set hWinV= SalCreateWindow(frm_Vklad, hWndMDI, 
                           ShowTbl.deposit_id, ShowTbl.type_name, ShowTbl.nmk,
                           ShowTbl.pasp,       ShowTbl.paspn,     ShowTbl.vydan, 
                           TT1,                TT2,               EVE_CASH, sAccFilterOnTab )
.head 3 +  Pushbutton: pbNewStud 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.129"
.head 5 -  Top:    1.188"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not IsWindow(hWinSTUD) and ShowTbl.rnk >0 
.head 7 -  Set hWinSTUD = SalCreateWindow(frm_Student,hWndForm,nGrp,ShowTbl.rnk,ShowTbl.nmk,ShowTbl.okpo,sTT_P)
.head 3 +  Custom Control: cSpltMain
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.267"
.head 6 -  Top:    0.167"
.head 6 -  Width:  6.983"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSpltMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    3.333"
.head 6 -  Width:  12.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.952"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Check Box: cbShowCallDpt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Default
.head 5 -  Top:    Default
.head 5 -  Width:  Default
.head 5 -  Width Editable? Yes
.head 5 -  Height: Default
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: DISA
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalDisableWindow( pbCreate )
.head 5 -  Call SalDisableWindow( pbEditK )
.head 5 -  Call SalDisableWindow( pbNewV )
.head 5 -  Call SalDisableWindow( pbEditV )
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  ! Группа доступа
.head 3 -  Number: nGrp
.head 3 -  ! TTS1TTS2,где TTS1\TTS2 - окончат.снятие с осн.счета\счета начисл.%%
.head 3 -  String: sTT
.head 3 -  ! TTS3TTS4,где TTS3\TTS4 - перечисление %% внутрибанк\межбанк
.head 3 -  String: sTT_P
.head 3 -  ! Доступ на закладки карточек клиента и счета
.head 3 -  String: sFilterOnTab
.head 3 -  ! право регистрировать клиента 
.head 3 -  Number: nRegClient
.head 2 +  Window Variables
.head 3 -  Number: Current_rnk
.head 3 -  Number: Current_nls
.head 3 -  Number: Current_acc
.head 3 -  Number: Current_dpt
.head 3 -  String: sWHERE
.head 3 -  String: sWHERE1
.head 3 -  String: Sql_sent
.head 3 -  Number: nFetchRes
.head 3 -  Number: nKol
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  String: sFilt
.head 3 -  Number: nMaxDig
.head 3 -  Number: ID
.head 3 -  String: sModiFio
.head 3 -  Number: nShowCallDpt
.head 3 -  String: EVE_CASH
.head 3 -  String: TT1  !! код операции для полного снятия нал с депозитного счета
.head 3 -  String: TT2  !! код операции для полного снятия нал со счета начисл.%%
.head 3 -  : cCstTab
.head 4 -  Class: cABSTab
.head 3 -  ! Доступ к закладкам карточки клиента
.head 3 -  String: sCustFilterOnTab
.head 3 -  ! Доступ к закладкам карточки счета
.head 3 -  String: sAccFilterOnTab
.head 3 -  Number: nScan
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Kontr.cTWndTitle'))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Set TT1=Subs(sTT,1,3)
.head 4 -  Set TT2=Subs(sTT,4,3)
.head 4 -  Set EVE_CASH=Subs(sTT_P,7,Len(sTT_P))
.head 4 -  !
.head 4 -  Set nScan = SalStrScan(sFilterOnTab, '#')
.head 4 -  Set sCustFilterOnTab = IifS(nScan<=0, SalStrRepeatX('2',8), Left(Subs(sFilterOnTab, 1, nScan) || SalStrRepeatX('0',8), 8))
.head 4 -  Set sAccFilterOnTab  = IifS(nScan=-1, SalStrRepeatX('2',7), Left(Subs(sFilterOnTab, nScan+2, Len(sFilterOnTab)-nScan-1) || SalStrRepeatX('0',7), 7))
.head 4 -  !
.head 4 -  Call cSpltMain.setStyle( XSalSplitter_NotResizable| XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  Call cSpltMain.setBarSize(7)
.head 4 -  Call cSpltMain.setBarPosition( 70 )
.head 4 -  Call cSpltMain.setBottomFrame(cSpltMB)
.head 4 -  Call cSpltMain.setTopFrame(SalCreateWindowEx( frm_Client, hWndForm, 0,0,0,0, CREATE_AsChild ) )
.head 4 -  !
.head 4 +  If nRegClient = 0
.head 5 -  Call SalDisableWindow(frm_Client.pbNewK)
.head 4 +  Else
.head 5 -  Call SalEnableWindow(frm_Client.pbNewK)
.head 4 -  !
.head 4 -  Call cSpltMB.setStyle(  XSalSplitter_NotResizable|XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  Call cSpltMB.setBarSize(1)
.head 4 -  Call cSpltMB.setBarPosition( 30 )
.head 4 -  Call cSpltMB.setBottomFrame(ShowTbl)
.head 4 -  Call cSpltMB.setTopFrame( SalCreateWindowEx( frm_tblButtn, hWndForm, 0,0,0,0, CREATE_AsChild ) )

.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Call SalTblSetTableFlags ( ShowTbl, TBL_Flag_SelectableCols, TRUE )
.head 4 -  Set sFilt = ''
.head 4 -  Call DISA()
.head 4 -  Call SalSetFocus(frm_Client.man_nm)
.head 4 -  Set ID = GetUserId()
.head 4 +  If DigInit() != -1
.head 5 -  Set nMaxDig = DigInit()
.head 4 +  Else
.head 5 -  ! ?
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  ! (не) показывать код подразделения, в котором открыт вклад
.head 4 +  If GetGlobalOptionEx('HAVETOBO') >= 1
.head 5 -  Call SalShowWindow(ShowTbl.tobo)
.head 4 +  Else
.head 5 -  Call SalHideWindow(ShowTbl.tobo)
.head 3 +  On UM_CreateDoc
.head 4 -  Call CreateDepDoc( ShowTbl.deposit_id, ShowTbl.vidd )
.head 3 +  On SAM_Destroy
.head 4 -  Call cCstTab.Destructor()
.head 1 +  Form Window: frm_Student
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Открытие вклада "Студенческий"
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.833"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.429"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Standard
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Выбор ВУЗа
.head 4 -  Resource Id: 41168
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.1"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: gboxINST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfID_INST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    0.4"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код ВУЗа
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipID_INST'))
.head 3 -  Background Text: ВУЗ:
.head 4 -  Resource Id: 54213
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.45"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgINST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmb_INST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.15"
.head 5 -  Top:    0.4"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmb_INST.Init( hWndItem )
.head 7 -  Call cmb_INST.Populate( hSql(), "di.id_inst", "c.nmk", "dpt_study_inst di, customer c", " WHERE di.rnk=c.rnk ORDER BY di.id_inst" )
.head 7 -  Call cmb_INST.SetSelectById( dfID_INST )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage ( SAM_Click, 0, 0 )
.head 6 -  Set dfID_INST  = cmb_INST.GetCurrentKey(  )
.head 6 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT c.okpo, d.mfo, b.nb, d.nls, a.acc, n.acc, a.nls, n.nls 
      INTO :dfOKPO, :dfMFO, :dfNB, :dfNLS, :dfACCC_D, :dfACCC_P, :dfNLS_D, :dfNLS_P
      FROM dpt_study_inst d, customer c, banks b, accounts a, accounts n
     WHERE d.rnk=c.rnk       AND d.mfo=b.mfo(+) AND
           d.accc_d=a.acc(+) AND d.accc_p=n.acc(+) AND 
           d.id_inst=:dfID_INST") 
.head 7 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 6 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT to_char(nvl(max(to_number(d.nd)),0)+1) 
      INTO :dfND
      FROM dpt_deposit d, dpt_study s 
     WHERE d.deposit_id=s.dpt_id AND s.inst=:dfID_INST") 
.head 7 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Call SalSendMsg( cmb_FK, SAM_Create, 0, 0 )
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Наименование ВУЗа
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipCmbINST'))
.head 3 -  Background Text: Счета ВУЗа:
.head 4 -  Resource Id: 54209
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.7"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLS_D
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    0.65"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Депозитный счет ВУЗа
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipNLS_D'))
.head 3 +  Data Field: dfNLS_P
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.15"
.head 6 -  Top:    0.65"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Счет начисленных %% ВУЗа
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipNLS_P'))
.head 3 +  Data Field: dfACCC_D
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.821"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Депозитный счет ВУЗа
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipACCC_D'))
.head 3 +  Data Field: dfACCC_P
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.583"
.head 6 -  Top:    0.821"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Счет начисленных %% ВУЗа
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipACCC_P'))
.head 3 -  Background Text: Расчетн.счет:
.head 4 -  Resource Id: 54211
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.95"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    0.9"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Расчетный счет ВУЗа
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipNLS'))
.head 3 +  Data Field: dfOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.15"
.head 6 -  Top:    0.9"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код ОКПО ВУЗа
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipOKPO'))
.head 3 -  Background Text: в банке:
.head 4 -  Resource Id: 54210
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.2"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    1.15"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! МФО банка, в котором обслуж.ВУЗ
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipMFO'))
.head 3 +  Data Field: dfNB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.15"
.head 6 -  Top:    1.15"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Наименование банка, в котором обслуж.ВУЗ
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipNB'))
.head 3 -  !
.head 3 -  Background Text: Выбор факультета
.head 4 -  Resource Id: 41169
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.6"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: gboxFK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfID_FK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    1.9"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код факультета
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipID_FK'))
.head 3 -  Background Text: Факультет:
.head 4 -  Resource Id: 54214
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.95"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmb_FK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.15"
.head 5 -  Top:    1.9"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmb_FK.Init( hWndItem )
.head 7 -  Call cmb_FK.Populate( hSql(), "id_fk", "name", "dpt_study_fk", " WHERE id_inst=:hWndForm.frm_Student.cmb_INST.nCurrentId ORDER BY id_fk" )
.head 7 -  Call cmb_FK.SetSelectById( dfID_FK )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 -  Set dfID_FK  = cmb_FK.GetCurrentKey(  )
.head 6 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT  rate, sum/100 
      INTO :dfRATE, :dfSUM
      FROM dpt_study_fk
     WHERE id_inst=:dfID_INST AND id_fk=:dfID_FK ") 
.head 7 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Факультет выбранного ВУЗа
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipCmbbFK'))
.head 3 -  Background Text: % ставка:
.head 4 -  Resource Id: 2622
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.2"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    2.15"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: 00000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! %-ная ставка по договору для данного факультета
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipRATE'))
.head 3 -  Background Text: Сумма:
.head 4 -  Resource Id: 2623
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.15"
.head 5 -  Top:    2.2"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.25"
.head 6 -  Top:    2.15"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Сумма по договору для данного факультета
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Student.cFTipSUM'))
.head 3 -  Frame
.head 4 -  Resource Id: 23590
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.6"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  !
.head 3 -  Background Text: Код группы:
.head 4 -  Resource Id: 23589
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.75"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgGRP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfGRP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    2.7"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: № договора:
.head 4 -  Resource Id: 2624
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.15"
.head 5 -  Top:    2.75"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.65"
.head 6 -  Top:    2.7"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbOpen
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Открыть
.head 4 -  Window Location and Size
.head 5 -  Left:   0.8"
.head 5 -  Top:    3.2"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\EXECUTE.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not (dfID_INST = NUMBER_Null OR
        dfID_FK   = NUMBER_Null OR 
        dfGRP     = NUMBER_Null OR
        dfSUM     = NUMBER_Null OR
        dfSUM     = 0)
.head 7 -  Set nID = F_OPEN(NUMBER_Null)
.head 7 +  If nID = 0
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalSendMsg(cmb_INST, SAM_Click, 0, 0)
.head 8 -  Call SalSendMsg(pbOpen, SAM_Click, 0, 0)
.head 7 +  Else If nID > 0
.head 8 -  Call SqlCommit(hSql())
.head 8 -  ! Открытие вклада = <...>
.head 8 -  Call MessageNoWait(CurrentLangTable.GetAtomTitle('frm_Student.cTMessOpenVklad') || ' =' ||Str(nID), 
     CurrentLangTable.GetAtomTitle('cTMessage'), 3, 0)
.head 8 -  Call SalDisableWindow( cmb_INST )
.head 8 -  Call SalDisableWindow( cmb_FK )
.head 8 -  Call SalDisableWindow( dfGRP )
.head 8 -  Call SalDisableWindow( dfSUM )
.head 8 -  Call SalDisableWindow( dfND )
.head 8 -  Call SalDisableWindow( pbOpen )
.head 8 -  Call SalSendMsg(frm_Kontr.Poisk, SAM_Click, wParam, lParam)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  ! Ошибка при открытии вклада <...>
.head 8 -  Call MessageNoWait(CurrentLangTable.GetAtomTitle('frm_Student.cTErrOpenVklad') || " "|| sEr, 
     CurrentLangTable.GetAtomTitle('cTErr'), 0, 1)
.head 7 -  ! Call SalSendMsg(frm_Kontr.Poisk, SAM_Click, wParam, lParam)
.head 6 +  Else
.head 7 +  If dfID_INST = NUMBER_Null
.head 8 -  ! Не выбран ВУЗ
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Student.cTErrINST'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 +  Else If dfID_FK = NUMBER_Null
.head 8 -  ! Не выбран факультет
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Student.cTErrFK'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 +  Else If dfSUM = NUMBER_Null OR dfSUM = 0 
.head 8 -  ! Не указана сумма договора
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Student.cTErrSUM'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 +  Else
.head 8 -  ! Не указана группа
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Student.cTErrGRP'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.0"
.head 5 -  Top:    3.2"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 +  Picture: picINST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.2"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.3"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: picFK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.7"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_OPEN
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nI
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nISP
.head 5 -  Number: nKV
.head 5 -  String: sTT
.head 5 -  Number: nBASEY
.head 5 -  Number: nBASEM
.head 5 -  Number: nFREQN
.head 5 -  Number: nFREQK
.head 5 -  Number: nBR_ID
.head 5 -  Number: nBR_ID_L
.head 5 -  String: sBSD
.head 5 -  String: sBSN
.head 5 -  Number: nSOUR
.head 5 -  Number: nMETR
.head 5 -  Number: nTIPOST
.head 5 -  Number: nCAPITAL
.head 5 -  Number: nIDG
.head 5 -  Number: nIDS
.head 5 -  Number: nRASX
.head 5 -  Date/Time: dOPEN
.head 5 -  Date/Time: dCLOSE
.head 5 -  Number: nTermM
.head 5 -  Number: nTermD
.head 5 -  Date/Time: dSTOP
.head 5 -  Number: nMASKA
.head 5 -  String: sNLS
.head 5 -  String: sNLSN
.head 5 -  String: sNMS
.head 5 -  String: sNMSN
.head 5 -  Number: nACC
.head 5 -  Number: nACCN
.head 5 -  Number: nTmp
.head 5 -  String: sTT3
.head 5 -  String: sTT4
.head 5 -  String: sTTB
.head 5 -  String: sNLS_P
.head 5 -  String: sMFO_P
.head 5 -  String: sOKPO_P
.head 5 -  String: sNAME_P 
.head 5 -  Number: nPROC
.head 5 -  String: sComment
.head 5 -  String: sTmp
.head 5 -  Number: nUNIKOD
.head 5 -  !
.head 5 -  String: strErrorText
.head 5 -  Number: nErrorNum
.head 5 -  Number: nPos
.head 5 -  Sql Handle: hSqlError
.head 4 +  Actions
.head 5 -  Set nACC = NUMBER_Null
.head 5 -  Set nACCN = NUMBER_Null
.head 5 -  Set nISP = GetUserId(  )
.head 5 -  Set nID = nI
.head 5 +  If nI = NUMBER_Null
.head 6 +  If SqlPrepareAndExecute(hSql(),
  "SELECT v.kv, '%%1', v.basey,  nvl(v.basem,0), v.freq_n, v.freq_k, v.br_id, v.br_id_l,        
          v.bsd, v.bsn, v.sour, v.metr, nvl(v.tip_ost,0),
          v.idg, v.ids, v.acc7, nvl(v.duration,0), nvl(v.duration_days,0), nvl(v.comproc,0) 
    INTO :nKV, :sTT,:nBASEY,:nBASEM,:nFREQN,:nFREQK,:nBR_ID,:nBR_ID_L,
         :sBSD,:sBSN,:nSOUR,:nMETR,:nTIPOST,:nIDG,:nIDS,:nRASX,:nTermM,:nTermD, :nCAPITAL
    FROM dpt_vidd v 
    WHERE v.vidd=:nVIDD")
AND SqlFetchNext(hSql(),nFetchRes)
.head 7 -  ! Даты вклада
.head 7 -  Set dOPEN = GetBankDate(  )
.head 7 -  Set dCLOSE = DptGetDateClose(dOPEN, nTermM, nTermD)
.head 7 +  If dCLOSE != DATETIME_Null AND (nBR_ID_L = 0 OR nBR_ID_L = NUMBER_Null)
.head 8 -  Set dSTOP = dCLOSE - 1
.head 7 +  Else
.head 8 -  Set dSTOP = DATETIME_Null
.head 7 -  ! Номер вклада
.head 7 +  If NOT (SqlPrepareAndExecute(hSql(),
  "SELECT s_cc_deal.nextval INTO :nID FROM dual")
and SqlFetchNext(hSql(),nFetchRes) )
.head 8 -  ! Невозможно открыть договор
.head 8 -  Set sEr = CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN1')
.head 8 -  Return -1
.head 7 -  ! Номера счетов
.head 7 -  Set sNLS = sBSD||'0'||
           SalStrRightX('00'||Str(dfID_INST),2)||
           SalStrRightX('0000000'||Str(nID),7)
.head 7 -  Set sNLSN = sBSN||'0'||
           SalStrRightX('00'||Str(dfID_INST),2)||
           SalStrRightX('0000000'||Str(nID),7)
.head 7 -  Set sNLS = Vkrz2(GetBankMfo(),sNLS)
.head 7 -  Set sNLSN = Vkrz2(GetBankMfo(),sNLSN)
.head 7 -  ! Студент.вклад № <...> (<...>)
.head 7 -  Set sNMS = CurrentLangTable.GetAtomTitle('frm_Student.cTNMS')||dfND||" ("||Str(nID)||")"
.head 7 -  ! Нарах.%% по студент.вкладу № <...> (<...>)
.head 7 -  Set sNMSN = CurrentLangTable.GetAtomTitle('frm_Student.cTNMSN')||dfND||" ("||Str(nID)||")"
.head 7 -  ! Открытие счетов 
.head 7 +  If not Op_Reg(99,0,0,nGRP,nTmp,nRNK,sNLS,nKV,sNMS,"ODB",nISP,nACC) 
or not Op_Reg(99,0,0,nGRP,nTmp,nRNK,sNLSN,nKV,sNMSN,"ODB",nISP,nACCN)
.head 8 -  Set sEr = CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN8') || " "||sNLS|| ' '||sNLSN
.head 8 -  Return -8
.head 7 -  ! Капитализация %%
.head 7 +  If nCAPITAL = 1
.head 8 -  Set sNLS_P = sNLS
.head 8 -  Set sMFO_P = GetBankMfo()
.head 8 -  Set sOKPO_P = sOKPO
.head 8 -  Set sNAME_P = sNMS
.head 7 -  Set sTT3=Subs(sTT_P,1,3)
.head 7 -  Set sTT4=Subs(sTT_P,4,3)
.head 7 +  If sTT3!=' ' AND sTT4!=''
.head 8 -  Set sTTB=IifS(sNLS_P =STRING_Null,'',IifS(sMFO_P=GetBankMfo(),sTT3,sTT4))
.head 7 +  Else
.head 8 -  Set sTTB=IifS(sNLS_P =STRING_Null,'',IifS(sMFO_P=GetBankMfo(),'PS1','PS2'))
.head 7 -  ! Спецпараметры
.head 7 +  If SqlPrepareAndExecute( hSql(),
  "SELECT r011 INTO :nTmp FROM bars.kl_r011 
   WHERE r020r011=:sBSD AND r020=:sBSN")
and SqlFetchNext(hSql(),nFetchRes)
.head 8 -  If SqlPrepareAndExecute( hSql(),
 "UPDATE specparam SET r011=:nTmp WHERE acc=:nACCN ")
.head 7 +  Else
.head 8 -  Call SqlPrepareAndExecute( hSql(),
 "INSERT INTO specparam (acc,r011) VALUES (:nACCN,:nTmp)")
.head 7 -  ! Перекрытие 
.head 7 +  If nIDG != NUMBER_Null AND nIDS != NUMBER_Null 
.head 8 +  If SqlPrepareAndExecute( hSql(),
 "SELECT acc FROM specparam WHERE acc=:nACCN ")
and SqlFetchNext(hSql(),nFetchRes)
.head 9 -  Call SqlPrepareAndExecute( hSql(),
 "UPDATE  specparam SET   idg=:nIDG , ids=:nIDS , sps=1  WHERE acc=:nACCN ")
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute( hSql(),
 "INSERT  into specparam(acc,idg,ids,sps) values (:nACCN,:nIDG,:nIDS ,1) ")
.head 7 -  ! Счет расходов
.head 7 -  If SqlPrepareAndExecute(hSql(),
  "SELECT bars.f_proc_dr(:nACC,4,:nVIDD,'DPT') INTO :nRASX FROM dual")
and SqlFetchNext(hSql(),nFetchRes)
.head 7 +  Else
.head 8 -  ! Невозможно вычитать счет расходов
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN9') || ' '|| SalNumberToStrX(nVIDD,0), 
    'Внимание',0)
.head 8 -  Return -9
.head 7 +  If not SqlPrepareAndExecute(hSql(), "UPDATE accounts SET mdate=:dCLOSE WHERE acc=:nACC")  
OR not SqlPrepareAndExecute( hSql(),"UPDATE accounts SET mdate=:dCLOSE WHERE acc=:nACCN")  
.head 8 -  ! Невозможно проставить дату закрытия
.head 8 -  Set sEr = CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN10')
.head 8 -  Return -10
.head 7 -  ! Процентная карточка
.head 7 +  If SqlPrepareAndExecute(hSql(),"SELECT acc FROM Int_accn WHERE acc=:nACC and id=1") 
and not SqlFetchNext(hSql(),nFetchRes)
.head 8 -  Call SqlPrepareAndExecute(hSql(),"INSERT INTO Int_accn (id,acc) VALUES (1,:nACC)")
.head 7 +  If not SqlPrepareAndExecute( hSql(),
"UPDATE Int_accn 
 SET tt=:sTT, metr=:nMETR, io=:nTIPOST, basey=:nBASEY, basem=:nBASEM, freq=:nFREQN,
     stp_dat=:dSTOP, acrb=:nRASX, acra=:nACCN, 
     kvb=:nKV, nlsb=:sNLS_P, mfob=:sMFO_P, namb=:sNAME_P, ttb=:sTTB     
WHERE acc=:nACC and id=1") 
.head 8 -  ! Нeуспешная запись в INT_ACCN
.head 8 -  Set sEr = CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN12')
.head 8 -  Return -12
.head 7 -  ! Процентная ставка
.head 7 +  If nBASEM = 1
.head 8 +  If SqlPrepareAndExecute(hSql(),
  "SELECT acc FROM Int_ratn WHERE acc=:nACC and id=1 and bdat=:dOPEN ")
.head 9 +  If SqlFetchNext(hSql(),nFetchRes)
.head 10 -  Set sTmp="UPDATE Int_ratN SET br=NULL, ir=:dfRATE WHERE acc=:nACC and id=1 and bdat=:dOPEN"
.head 9 +  Else
.head 10 -  Set sTmp="INSERT INTO Int_ratN(id,acc,bdat,ir) VALUES (1,:nACC,:dOPEN,:dfRATE )"
.head 9 +  If not SqlPrepareAndExecute( hSql(),sTmp) 
.head 10 -  ! Нeуспешная запись в INT_RATN
.head 10 -  Set sEr = CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN13')
.head 10 -  Return -13
.head 8 +  Else
.head 9 -  ! Невозможно прочитать int_ratn для acc = <...>
.head 9 -  Set sEr = CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN14') || "="|| SalNumberToStrX(nACC,0)
.head 9 -  Return -14
.head 7 -  ! Ставка пролонгации
.head 7 +  If nBR_ID_L > 0 AND dSTOP = DATETIME_Null
.head 8 +  If SqlPrepareAndExecute(hSql(),
  "SELECT acc FROM Int_ratn WHERE acc=:nACC and id=1 and bdat=:dCLOSE ")
.head 9 +  If SqlFetchNext(hSql(),nFetchRes)
.head 10 -  Set sTmp="UPDATE Int_ratN SET br=:nBR_ID_L WHERE acc=:nACC and id=1 and bdat=:dCLOSE "
.head 9 +  Else
.head 10 -  Set sTmp="INSERT INTO Int_ratN(id,acc,bdat,br) VALUES (1,:nACC,:dCLOSE,:nBR_ID_L )"
.head 9 +  If not SqlPrepareAndExecute( hSql(), sTmp) 
.head 10 -  ! Нeуспешная запись в INT_RATN
.head 10 -  Set sEr = CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN13')
.head 10 -  Return -17
.head 7 -  ! Открытие депозитного договора 
.head 7 -  If SqlPrepareAndExecute(hSql(),
  "INSERT INTO dpt_deposit 
    (deposit_id,nd,rnk,vidd,kv,datz,dat_begin,dat_end,acc,freq,mfo_p,nls_p,name_p,okpo_p) 
   VALUES (:nID,:dfND,:nRNK,:nVIDD,:nKV,:dOPEN,:dOPEN,:dCLOSE,:nACC,:nFREQK,:sMFO_P,:sNLS_P,:sNAME_P,:sOKPO_P )")
.head 7 +  Else
.head 8 -  ! Невозможно открыть договор
.head 8 -  Set sEr = CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN1')
.head 8 -  Return -18
.head 7 -  ! Прогрессивная ставка
.head 7 +  If NOT SqlPLSQLCommand(hSql(),"bars.dpt.p_rate_rise(nID)")
.head 8 -  ! Ошибка при выполнении процедуры dpt.p_rate_rise
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN19'),
     CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 8 -  Return -19
.head 7 -  ! Запись студ.карточки
.head 7 -  Set nTmp = dfSUM*100
.head 7 -  Set nUNIKOD = Val(dfND)
.head 7 -  Set sComment = cmb_INST||', '||cmb_FK||', гр.'||Str(dfGRP)
.head 7 +  When SqlError
.head 8 -  ! Получаем код ошибки
.head 8 -  Call SqlExtractArgs (wParam, lParam, hSqlError, nErrorNum, nPos)
.head 8 -  ! Получаем текст ошибки
.head 8 -  Call SqlGetErrorText ( nErrorNum, strErrorText)
.head 8 +  If SalStrScan(SalStrUpperX(strErrorText), 'UK_DPT_STUDY_UNIKOD') != -1
.head 9 -  Return 0
.head 7 -  If SqlPrepareAndExecute(hSql(),
"INSERT INTO dpt_study (dpt_id, unikod, inst, fk, grp, sum_dog) VALUES
 (:nID, :nUNIKOD, :dfID_INST, :dfID_FK, :dfGRP, :nTmp)")
.head 7 +  Else
.head 8 +  If SalStrScan(SalStrUpperX(strErrorText), 'UK_DPT_STUDY_UNIKOD') != -1
.head 9 -  Return 0
.head 8 -  ! Невозможно заполнить студ.карточку
.head 8 -  Set sEr = CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN20')
.head 8 -  Return -20
.head 7 -  If SqlPrepareAndExecute(hSql(),
"UPDATE dpt_deposit SET comments=:sComment WHERE deposit_id=:nID")
.head 7 -  ! Счета консолидации
.head 7 +  If dfACCC_D != NUMBER_Null AND dfACCC_P != NUMBER_Null
.head 8 -  If SqlPrepareAndExecute(hSql(),
"UPDATE accounts SET accc=:dfACCC_D, nbs='8'||substr(nbs,2,3) WHERE acc=:nACC")
.head 8 +  Else
.head 9 -  ! Невозможно проставить счет консолидации (деп)
.head 9 -  Set sEr = CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN21')
.head 9 -  Return -21
.head 8 -  If SqlPrepareAndExecute(hSql(),
"UPDATE accounts SET accc=:dfACCC_P, nbs='8'||substr(nbs,2,3) WHERE acc=:nACCN")
.head 8 +  Else
.head 9 -  ! Невозможно проставить счет консолидации (%%)
.head 9 -  Set sEr = CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN22')
.head 9 -  Return -22
.head 6 +  Else
.head 7 -  ! Не описан вид вклада № <...>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Student.cTErrF_OPEN23')|| SalNumberToStrX(nVIDD,0),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return -23
.head 5 -  Return nID
.head 2 +  Window Parameters
.head 3 -  Number: nGRP
.head 3 -  Number: nRNK
.head 3 -  String: sNMK
.head 3 -  String: sOKPO
.head 3 -  String: sTT_P 
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  Number: nID
.head 3 -  Number: nVIDD
.head 3 -  String: sEr
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Student.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  Set nVIDD = SalStrToNumber( GetGlobalOption('DPT_STUD') ) 
.head 1 +  Table Window: AR
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Просмотр архива закрытых вкладов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.81"
.head 4 -  Top:    0.675"
.head 4 -  Width:  13.533"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 25000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.405"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 65409
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.967"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.417"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWinV)
.head 8 -  Set hWinV = SalCreateWindow(frm_Vklad, hWndMDI, - AR.deposit_id, 
                            AR.type_name, AR.nmk, AR.pasp, AR.paspn, AR.vydan, 
                            STRING_Null, STRING_Null, Str(AR.idupd), sAccFilterOnTab)
.head 8 -  ! Set hWinV= SalCreateWindow(frm_Vklad, hWndMDI, 
                           - AR.deposit_id, AR.type_name, AR.nmk, 
                           AR.pasp, AR.paspn, AR.vydan, 
                           STRING_Null, STRING_Null, SalFmtFormatDateTime(AR.when_, 'dd/MM/yyyy hh:mm'))
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.867"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 65410
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.683"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 65411
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 48945
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.483"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  2.483"
.head 6 -  End Y:  0.381"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 2 +  Contents
.head 3 +  Column: deposit_id
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
вклада
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: when_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата/время
изменения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yyyy hh:mm AMPM
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: action_name_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
изменения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 100
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: rnk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: RNK
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ФИО вкладчика
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: kv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лиц/счет
вклада
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: type_name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
вклада
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: acc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ACC
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: vidd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: VIDD
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: pasp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Документ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: paspn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Серия, №
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: vydan
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выдан
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dat_begin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
начала
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dat_end
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
окончания
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: fio_
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Автор 
изменения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 100
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: idupd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nU
.head 3 -  ! Доступ на закладки карточки счета
.head 3 -  String: sAccFilterOnTab
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('AR.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set AR.strPrintFileName = 'AR'
.head 4 -  Set AR.strFilterTblName = 'DPT_DEPOSIT_CLOS'
.head 4 -  Set AR.nTabInstance=1
.head 4 -  Set AR.fFilterAtStart = TRUE
.head 4 -  Set AR.strSqlPopulate =
"SELECT dpt_deposit_clos.dat_begin, 
        dpt_deposit_clos.dat_end, 
        dpt_deposit_clos.nd,  
        c.nmk, 
        v.type_name, 
        dpt_deposit_clos.kv, 
        dpt_deposit_clos.deposit_id, 
        dpt_deposit_clos.acc, 
        dpt_deposit_clos.rnk, 
        dpt_deposit_clos.vidd,        
        a1.nls, 
        ps.name, 
        ltrim(rtrim(p.ser))||' '||ltrim(rtrim(p.numdoc)),
        ltrim(rtrim(p.ORGAN))||' '||to_char(p.PDATE,'dd-mm-yyyy'),
        dpt_deposit_clos.when, 
        da.name, 
        s.fio,
        dpt_deposit_clos.idupd     
  INTO  :AR.dat_begin,    :AR.dat_end,    :AR.nd,    
        :AR.nmk,          :AR.type_name,  :AR.kv,
        :AR.deposit_id,   :AR.acc,        :AR.rnk,
        :AR.vidd,         :AR.nls,        :AR.pasp,
        :AR.paspn,        :AR.vydan,      :AR.when_, 
        :AR.action_name_, :AR.fio_,       :AR.idupd   
   FROM saldo a1, dpt_deposit_clos, customer c, dpt_vidd v, 
        person p, dpt_deposit_action da, staff s, passp ps  
  WHERE dpt_deposit_clos.acc            = a1.acc   
    AND dpt_deposit_clos.rnk            = c.rnk
    AND p.passp                         = ps.passp(+) 
    AND dpt_deposit_clos.vidd           = v.vidd
    AND dpt_deposit_clos.rnk            = p.rnk
    AND dpt_deposit_clos.action_id      = da.id 
    AND dpt_deposit_clos.actiion_author = s.id 
  ORDER BY dpt_deposit_clos.when, dpt_deposit_clos.dat_end desc"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg( pbDetails, SAM_Click, 0, 0 )
.head 1 +  Table Window: AS
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Закрытие вкладов в архив
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.46"
.head 4 -  Top:    0.583"
.head 4 -  Width:  14.4"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 15000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.405"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.8"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Закрыть отмеченные вклады
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('AS.cBTipDel')
.head 6 +  On SAM_Click
.head 7 -  Call Close()
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 7 +  If nID>0
.head 8 -  Call SalSendMsg( frm_Kontr.Poisk, SAM_Click, 0, 0 )
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 3770
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.25"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.933"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Карточка вклада
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('AS.cBTipDetails')
.head 6 +  On SAM_Click
.head 7 -  If SqlPrepareAndExecute( hSqlAux(),
  "SELECT v.type_name, c.nmk, ps.name,  
          ltrim(rtrim(p.ser))||' '||ltrim(rtrim(p.numdoc)),
          ltrim(rtrim(p.organ))||' '||to_char(p.pdate,'dd-mm-yyyy')
   INTO :AS.sTYPE,:AS.sNMK,:AS.sPASP,:AS.sPASPN,:AS.sVYDAN
   FROM dpt_deposit d,customer c,dpt_vidd v,person p, passp ps 
   WHERE d.rnk=c.rnk   AND c.rnk=p.rnk AND p.passp=ps.passp(+) AND
         v.vidd=d.vidd AND d.deposit_id=:AS.ID")
and SqlFetchNext( hSqlAux(), nTmp )
.head 7 -  Set hWinV= SalCreateWindow(frm_Vklad, hWndMDI, 
                           AS.ID, AS.sTYPE, AS.sNMK, 
                           AS.sPASP, AS.sPASPN, AS.sVYDAN, 
                           STRING_Null, STRING_Null, STRING_Null, STRING_Null)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.367"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 3771
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.933"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 3772
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 48946
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.8"
.head 6 -  Begin Y:  0.036"
.head 6 -  End X:  2.8"
.head 6 -  End Y:  0.393"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Radio Button: rbDEP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cRadioButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Депозиты
.head 5 -  Window Location and Size
.head 6 -  Left:   3.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 4 +  Radio Button: rbPOT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cRadioButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: До восстребования
.head 5 -  Window Location and Size
.head 6 -  Left:   5.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Teal
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 4 +  Radio Button: rbFORE
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cRadioButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Досрочное закрытие
.head 5 -  Window Location and Size
.head 6 -  Left:   7.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Purple
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 4 +  Check Box: cbCheckAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cCheckBoxLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Отметить все вклады
.head 5 -  Window Location and Size
.head 6 -  Left:   11.75"
.head 6 -  Top:    0.071"
.head 6 -  Width:  2.517"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Charcoal
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call Check (IifN (cbCheckAll, 1, 0))
.head 4 -  Frame
.head 5 -  Resource Id: 54393
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.45"
.head 6 -  Top:    0.048"
.head 6 -  Width:  7.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Square
.head 5 -  Border Style: Etched
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 2 +  Contents
.head 3 +  Column: OTM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отм
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.657"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Set nOtm = nOtm + IifN(OTM = 1, 1, -1)
.head 6 +  If nOtm > 0
.head 7 -  Call SalEnableWindow(pbDel)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbDel)
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вклад
№
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.729"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.
№
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TYPENAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Вид вклада
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Проц.
ставка
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.717"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Депозитный 
счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Наименование счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
открытия
вклада
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.257"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAPP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
последнего
движения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.257"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACRDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
последнего
начисления %%
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Date
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: STPDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Стоп-дата
по
начислению %%
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Date
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
погашения
 остатка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
начисленных
%%
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACCI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACCA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAPPI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
последнего
движения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.257"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ответ.
исп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: COMMENTS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Комментарий по вкладу
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.35"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FLACR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: Close
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nKOL
.head 5 -  Number: nSTUD
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set nSTUD = Val(GetGlobalOption('DPT_STUD'))
.head 5 -  Set nTmp  = TBL_MinRow
.head 5 -  Set nKOL  = 0
.head 5 +  While SalTblFindNextRow (hWndForm, nTmp, 0, 0)
.head 6 -  Call SalTblSetContext(hWndForm,nTmp)
.head 6 +  If AS.OTM = 1
.head 7 -  ! предупреждение о том, что, возможно, по вкладу не доначислены проценты
.head 7 +  If FLACR = 0 
   OR 
  (FLACR = 1 AND 
   SalMessageBox(CurrentLangTable.GetAtomTitle('AS.cTMessAcrClose')||' №'||SalStrTrimX(ND)||'?',
                 CurrentLangTable.GetAtomTitle('AS.cTTitlAcrClose'), 
                 MB_IconQuestion|MB_YesNo) = IDYES)
.head 8 +  If SqlPrepareAndExecute(hSql(),
   "UPDATE accounts SET dazs=BANKDATE WHERE dazs IS NULL AND acc=:AS.ACC" ) 
and SqlPrepareAndExecute(hSql(),
   "UPDATE accounts SET dazs=BANKDATE WHERE  dazs IS NULL AND acc=:AS.ACCI") 
and 
   ( NOT nSTUD
     OR
     nSTUD AND SqlPrepareAndExecute(hSql(),"DELETE FROM dpt_study WHERE dpt_id=:AS.ID") 
   )
and SqlPrepareAndExecute(hSql(),
   "DELETE FROM dpt_deposit WHERE DEPOSIT_ID=:AS.ID") 
and SqlPrepareAndExecute(hSql(),
   "UPDATE accounts SET dazs=BANKDATE WHERE  dazs IS NULL AND acc=:AS.ACCA")
and SqlCommit(hSql())
.head 9 -  ! Вклады:закрытие <осн.счет>, <счет %%>
.head 9 -  Call SaveFInfoToLog(CurrentLangTable.GetAtomTitle('AS.cTVkladClose') || " "||AS.NLS||","||AS.NLSI)
.head 9 -  Set nKOL=nKOL+1
.head 5 +  If nKOL > 0
.head 6 -  ! Закрыто вкладов: <...>)! Выполнено успешно
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('AS.cTMessVkladClose') || ': '||Str(nKOL)||' !',
     CurrentLangTable.GetAtomTitle('AS.cTMessCloseOk'), MB_IconInformation)
.head 5 -  Set nOtm = 0
.head 5 -  Call SalDisableWindow(pbDel)
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: Check
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: pSetValue
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalTblSetFlagsAnyRows (hWndForm, ROW_Edited, FALSE, 0, 0)
.head 5 -  Set nTmp = TBL_MinRow
.head 5 +  While SalTblFindNextRow (hWndForm, nTmp, 0, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nTmp)
.head 6 -  Set OTM = pSetValue
.head 6 -  Call SalSendMsg(OTM, SAM_AnyEdit, 0, 0)
.head 2 +  Window Parameters
.head 3 -  Number: nID
.head 3 -  String: sPar1
.head 3 -  String: sOuterFilter
.head 2 +  Window Variables
.head 3 -  Number: nRnk
.head 3 -  Number: nTmp
.head 3 -  Number: nOtm
.head 3 -  Date/Time: dBD
.head 3 -  !
.head 3 -  String: sTYPE
.head 3 -  String: sNMK
.head 3 -  String: sPASP
.head 3 -  String: sPASPN
.head 3 -  String: sVYDAN
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('AS.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set AS.strPrintFileName = 'AS'
.head 4 -  Set AS.strFilterTblName = 'DPT_DEPOSIT'
.head 4 -  Set AS.nTabInstance = 1
.head 4 -  Set AS.fFilterAtStart = TRUE
.head 4 -  Set nOtm = 0
.head 4 -  Set dBD = GetBankDate()
.head 4 -  Set rbDEP = TRUE
.head 4 -  Set cbCheckAll = FALSE
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Set AS.strSqlPopulate =
   "SELECT dpt_deposit.deposit_id, dpt_deposit.nd, dpt_deposit.rnk, 
           a.acc, a.kv, a.nls, a.nms, a.isp,
           dpt_deposit.dat_begin, a.dapp, a.mdate, i.acr_dat, i.stp_dat,
           i.acra, c.nls, c.dapp, decode(b.nbs,'3500', b.acc, a.acc), 0,
           acrn.fproc(a.acc, bankdate), v.type_name, dpt_deposit.comments 
     INTO  :AS.ID,   :AS.ND,       :AS.RNK,
           :AS.ACC,  :AS.KV,       :AS.NLS,   :AS.NMS,    :AS.ISP,
           :AS.DAOS, :AS.DAPP,     :AS.MDATE, :AS.ACRDAT, :AS.STPDAT,
           :AS.ACCI, :AS.NLSI,     :AS.DAPPI, :AS.ACCA,   :AS.OTM,
           :AS.RATE, :AS.TYPENAME, :AS.COMMENTS
      FROM dpt_deposit, saldo a, int_accn i, accounts b, accounts c, dpt_vidd v
     WHERE dpt_deposit.vidd = v.vidd 
       AND dpt_deposit.acc  = a.acc 
       AND a.ostc = 0 
       AND a.ostb = 0 
       AND a.ostf = 0 
       AND nvl(a.dapp, bankdate - 1) < bankdate  
       AND a.acc = i.acc  
       AND i.id IN (0,1) 
       AND fost(i.acra,bankdate) = 0 
       AND b.acc = i.acrb 
       AND nvl(fost(decode(b.nbs,'3500',b.acc,a.acc),bankdate),0) = 0 
       AND c.acc = i.acra 
       AND nvl(c.dapp, bankdate - 1) < bankdate "
||IifS( nID = 0, " ", " AND a.isp = "||Str(nID))
||IifS(rbDEP,         " AND a.mdate <= bankdate ",
         IifS(rbFORE, " AND a.mdate > bankdate ", 
                      " AND a.mdate IS NULL "))
||sOuterFilter
||" ORDER BY 1"   
.head 4 -  Call cQ.Init(strSqlPopulate)
.head 4 +  If fFilterAtStart
.head 5 -  Set fFilterAtStart = NOT fFilterAtStart
.head 5 +  If NOT SetQueryFilter(cF)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Set cbCheckAll = FALSE
.head 4 -  Set nOtm = 0
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 4 -  Set strDSql = cQ.GetFullSQLString(cF)
.head 4 -  Call SalTblPopulate(hWndForm, cMain.hSql(), T(strDSql), TBL_FillAll)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg(pbDetails, SAM_Click, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  ! возможно, недоначислены проценты
.head 4 +  If dBD > DAOS + 1 
AND ((ACRDAT = DATETIME_Null AND DAPP != DATETIME_Null)
      OR 
     (ACRDAT != DATETIME_Null AND ACRDAT < dBD - 1 AND STPDAT = DATETIME_Null)
      OR 
     (ACRDAT != DATETIME_Null AND ACRDAT < STPDAT AND STPDAT != DATETIME_Null))
.head 5 -  Set FLACR = 1
.head 5 -  Call SalTblSetCellTextColor(ACRDAT, COLOR_Red, FALSE)
.head 5 -  Call SalTblSetCellTextColor(MDATE,  COLOR_Red, FALSE)
.head 4 +  Else
.head 5 -  Set FLACR = 0
.head 1 +  Dialog Box: dlgBook
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  4.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.8"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Печатать
.head 4 -  Resource Id: 19662
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.1"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: gboxPrint
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbFull
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: целиком (с шапочкой)
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.35"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbBrief
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: только текст
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.65"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Укажите период
.head 4 -  Resource Id: 19663
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.1"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: gboxDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDAT1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    1.35"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDAT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.9"
.head 6 -  Top:    1.369"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   3.4"
.head 5 -  Top:    1.845"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgBook, FALSE )
.head 3 +  Pushbutton: pbPrint
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledPrint
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.75"
.head 5 -  Top:    1.845"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sFileName = GetPrnDir() || '\\' || SalStrTrimX(Str(DPT_ID))|| '.TXT'
.head 6 -  Set nFMT=3
.head 6 -  Call ExportCatQuery( IifN(rbFull, KODZ_F, KODZ_B), sFileName, nFMT, 
                    ":DPT_ID='" || SalStrTrimX( Str(DPT_ID) ) || "',"||
                    ":sFdat1='" || SalFmtFormatDateTime( dfDAT1, 'dd/MM/yyyy')|| "',"||
                    ":sFdat2='" || SalFmtFormatDateTime( dfDAT2, 'dd/MM/yyyy')|| "'", TRUE )
.head 6 +  If sFileName != STRING_Null
.head 7 -  Call DosDirectPrint( sFileName )
.head 6 -  Call SalEndDialog( dlgBook, TRUE )
.head 3 +  Pushbutton: pbRun
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Просмотр
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.85"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\LOOK.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sFileName = GetPrnDir() || '\\' || SalStrTrimX(Str(DPT_ID))|| '.TXT'
.head 6 -  Set nFMT=3
.head 6 -  Call ExportCatQuery( IifN(rbFull, KODZ_F, KODZ_B), sFileName, nFMT, 
                    ":DPT_ID='" || SalStrTrimX( Str(DPT_ID) ) || "',"||
                    ":sFdat1='" || SalFmtFormatDateTime( dfDAT1, 'dd/MM/yyyy')|| "',"||
                    ":sFdat2='" || SalFmtFormatDateTime( dfDAT2, 'dd/MM/yyyy')|| "'", TRUE )
.head 6 +  If sFileName != STRING_Null
.head 7 -  Call DirectView( sFileName )
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.2"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pic2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.2"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: DPT_ID
.head 3 -  Number: KODZ_F
.head 3 -  Number: KODZ_B
.head 3 -  Date/Time: DAT1
.head 3 -  Date/Time: DAT2
.head 2 +  Window Variables
.head 3 -  String: sFileName
.head 3 -  Number: nFMT
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set dfDAT1 = DAT1
.head 4 -  Set dfDAT2 = DAT2
.head 4 +  If DAT1 = GetBankDate()
.head 5 -  Set rbFull=TRUE
.head 4 +  Else
.head 5 -  Set rbBrief=TRUE
.head 3 +  On SAM_Close
.head 4 -  Call SalEndDialog(dlgBook, FALSE)
.head 1 +  Dialog Box: dlgDrawing
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Внимание
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.7"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Выберите тип операции
.head 4 -  Resource Id: 41160
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.15"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: gboxType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbShtraf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: досрочное расторжение договора
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.4"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDrawing
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: частичное снятие капитала
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.8"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbFree
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: свободное снятие депозита
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.2"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.8"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If rbShtraf
.head 7 -  Set nDrawType=2
.head 6 +  Else If rbDrawing
.head 7 -  Set nDrawType=1
.head 6 +  Else If rbFree
.head 7 -  Set nDrawType=0
.head 6 +  Else
.head 7 -  Set nDrawType = -1
.head 6 -  Call SalEndDialog(dlgDrawing, nDrawType)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.0"
.head 5 -  Top:    1.8"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nDrawType = -1
.head 6 -  Call SalEndDialog(dlgDrawing, nDrawType)
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.25"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.4"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Number: nDrawType
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgDrawing.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set rbShtraf = TRUE
.head 3 +  On SAM_Close
.head 4 -  Set nDrawType = -1
.head 4 -  Call SalEndDialog(dlgDrawing, nDrawType)
.head 1 +  Form Window: frm_Vklad
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Карточка вклада
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? No
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   3.725"
.head 4 -  Top:    2.052"
.head 4 -  Width:  12.983"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.083"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: None
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb_Tabl
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Табличная форма счетов вклада
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipTabl')
.head 6 +  On SAM_Click
.head 7 -  Set sAcc = " a.acc in (select accid from dpt_accounts where dptid = " || Str(nID) || ")" || "#" || sAccFilterOnTab
.head 7 -  Call ShowAccList(GetUserId(),AVIEW_USER,AVIEW_AllOptions|AVIEW_NoClose,sAcc) 
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.467"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Перечитать карточку вклада
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipRefresh')
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor( TRUE )
.head 7 -  Call SalSendMsg( hWndForm, SAM_User, 0, 0 )
.head 7 -  Call SalWaitCursor( FALSE )
.head 4 +  Pushbutton: pbSberBook
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.77"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BOOKS1.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Печать сбер.книжки
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipSberBook')
.head 6 +  On SAM_Click
.head 7 +  If nKODZ_Full=NUMBER_Null 
.head 8 -  ! Не указан код запроса для формирования сбер.книжки (полной)
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTErrKODZ_Full'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop )
.head 7 +  If nKODZ_Brief=NUMBER_Null
.head 8 -  ! Не указан код запроса для формирования сбер.книжки (краткой)
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTErrKODZ_Brief'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop )
.head 7 +  Else
.head 8 -  Call SalModalDialog( dlgBook, frm_Vklad, deposit_id, nKODZ_Full, nKODZ_Brief, dDAT_BEGIN, dDAT_END)
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.417"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выход из карточки
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipCancel')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Pushbutton: pbNAMEP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.905"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сохранить изменения
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipNAMEP')
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor( TRUE )
.head 7 -  If SqlPrepareAndExecute( hSql(),
   "UPDATE dpt_deposit 
    SET MFO_P=:MFOP,NLS_P=:NLSP,NAME_P=:NAMEP,OKPO_P=:OKPOP,COMMENTS=:df_DeposComm
    WHERE deposit_id=:nID")
and SqlPrepareAndExecute( hSql(),  
   "UPDATE Int_accn               
    SET kvb=:nKV,nlsb=:NLSP,mfob=:MFOP,namb=:NAMEP
    WHERE acc=:ACC  AND id=1") 
and SqlCommit(hSql())
.head 7 -  Call SalWaitCursor( FALSE )
.head 4 +  Pushbutton: pbDoc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.34"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Печать договора
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipDoc')
.head 6 +  On SAM_Click
.head 7 +  If frm_Vklad.deposit_id > 0 
.head 8 -  Call cdoc_ShowAllDocs(frm_Vklad.nID, frm_Vklad)
.head 7 +  Else
.head 8 -  Call cdoc_ShowAllDocsReadOnly(frm_Vklad.nID, frm_Vklad)
.head 4 +  Pushbutton: pbFields
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.2"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SMTHING.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Заполнить доп.реквизиты вклада
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipFields')
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog( dlgFields, hWndMDI, nVidd, deposit_id, 0, sTagVal, bOk )
.head 4 -  Line
.head 5 -  Resource Id: 48944
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.317"
.head 6 -  Begin Y:  0.036"
.head 6 -  End X:  3.317"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 -  Background Text: Депозитный вклад №
.head 5 -  Resource Id: 40435
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.183"
.head 6 -  Top:    0.095"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgND
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: sND
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 35
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.933"
.head 7 -  Top:    0.095"
.head 7 -  Width:  5.35"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: MS Sans Serif
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Midnight Blue
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb_AUTO_ADD
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Параметри Авто-поповнення вкладу"
.head 6 +  On SAM_Click
.head 7 -  Call Sel002(hWndMDI,16, nID, "",""  )
.head 2 +  Contents
.head 3 -  Background Text: Заключение:
.head 4 -  Resource Id: 52766
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dDATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.35"
.head 6 -  Top:    0.06"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата заключения договора
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipDATZ'))
.head 3 -  Background Text: Начало:
.head 4 -  Resource Id: 52764
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.5"
.head 5 -  Top:    0.095"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDAT_BEGIN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dDAT_BEGIN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    0.06"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата начала договора
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipDAT_BEGIN'))
.head 3 -  Background Text: Завершение:
.head 4 -  Resource Id: 52765
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.5"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.25"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDAT_END
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dDAT_END
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.817"
.head 6 -  Top:    0.06"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата окончания договора
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipDAT_END'))
.head 3 +  Data Field: nID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.405"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Номер вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipID'))
.head 3 +  Data Field: sVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    0.405"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Вид вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipVIDD'))
.head 3 +  Data Field: nKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.47"
.head 6 -  Top:    0.405"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Black
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код валюты
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipKV'))
.head 3 +  Data Field: nProc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.955"
.head 6 -  Top:    0.405"
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Текущая % ставка для вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipProc'))
.head 3 +  Data Field: sFIO 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.655"
.head 6 -  Width:  6.866"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Вкладчик
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipFIO'))
.head 3 +  Data Field: sPASP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.917"
.head 6 -  Width:  1.533"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Паспорт
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipPASP'))
.head 3 +  Data Field: sPASPN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.917"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Серия, №
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipPASPN'))
.head 3 +  Data Field: sVYDAN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    0.905"
.head 6 -  Width:  3.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Кем выдан паспорт
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipVYDAN'))
.head 3 +  Multiline Field: mfText
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2000
.head 5 -  String Type: Long String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   7.083"
.head 6 -  Top:    0.06"
.head 6 -  Width:  5.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.11"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: 3D Highlight Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Комментарии
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipText'))
.head 3 -  !
.head 3 -  Background Text: Основной счет
.head 4 -  Resource Id: 48942
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.683"
.head 5 -  Top:    1.595"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    2.5"
.head 5 -  Width:  4.4"
.head 5 -  Width Editable? No
.head 5 -  Height: 2.094"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: 35
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name:
.head 4 -  Font Size: 0
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask:
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If (cmbTT !=STRING_Null)
.head 7 +  If F_VVOD(NLS, cmbTT.GetKey( SalListQuerySelection(hWndItem)),
 STRING_Null, STRING_Null, STRING_Null, 0, nID,sErrMsg )<0
.head 8 +  If sErrMsg != STRING_Null
.head 9 -  Call SalMessageBox(sErrMsg, CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 6 +  Else
.head 7 -  ! Не выбрана операция
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessTT'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 6 -  Call SalSendMsg(frm_Kontr.Poisk, SAM_Click, wParam, lParam)
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Операции с основным счетом вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipTT'))
.head 3 +  Data Field: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    1.845"
.head 6 -  Width:  2.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Основной счет вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipNLS'))
.head 3 +  Data Field: OST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: OST_PL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.233"
.head 6 -  Top:    1.845"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Остаток на  основном счете вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipOST_PL'))
.head 3 +  Pushbutton: pb_N1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.488"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Полное снятие вклада наличными
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipN1')
.head 5 +  On SAM_Click
.head 6 +  If TT1 != STRING_Null
.head 7 -  Call F_VVOD(NLS, TT1, STRING_Null, STRING_Null, STRING_Null, OST_PL, nID, sErrMsg )
.head 6 +  Else
.head 7 -  Call F_VVOD(NLS, 'DP1', STRING_Null, STRING_Null, STRING_Null, OST_PL, nID, sErrMsg )
.head 3 +  Pushbutton: pb_PrnLic
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.533"
.head 5 -  Top:    1.488"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Print.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Печать выписки по основному счету
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipPrnLic')
.head 5 +  On SAM_Click
.head 6 -  Call F_Prn_Lic(NLS, nKV, nKODZ, nFMT)
.head 3 +  Child Table: TB1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    2.774"
.head 6 -  Width:  6.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.143"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: DAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.043"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Приход
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.471"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRIDs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Приход
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RASD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Расход
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.371"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RASDs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Расход
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ISXD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
по вкладу
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ISXDs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
по вкладу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: %
ставка
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On SAM_DoubleClick
.head 6 -  Set sdat=SalFmtFormatDateTime(TB1.DAT,'MM/dd/yyyy') 
.head 6 -  Call ShowTurnForAccount( ACC, sdat)
.head 5 +  On SAM_FetchRowDone
.head 6 -  ! проверка на 3 знака
.head 6 -  Set PRIDs = Dig4( PRID, nDig, nDig )
.head 6 -  Set RASDs = Dig4( RASD, nDig, nDig )
.head 6 -  Set ISXDs = Dig4( ISXD, nDig, nDig )
.head 6 -  !
.head 3 -  !
.head 3 +  Pushbutton: pbClose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.983"
.head 5 -  Top:    1.488"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\A_bkld.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Расчет и Взыскание штрафа
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipClose')
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 6 -  ! расчитаем штраф, потом предложим породить документ
.head 6 +  If dDAT_END > dBankDate
.head 7 +  If (  (ACR_DAT = DATETIME_Null OR ACR_DAT < dBankDate - 1) 
    AND 
    dDAT_BEGIN + 1 < dBankDate 
   )
.head 8 -  ! Для расчета штрафа нужно доначислить проценты
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessProc'),
     CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 8 -  Call SalSendMsg( pbPROC, SAM_Click, 0, 0 )
.head 7 +  Else
.head 8 +  If nIdStop = 0
.head 9 -  ! Для данного договора не был проставлен вид штрафа
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessStop'),
     CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 8 +  Else
.head 9 +  If F_SHTRAF(1) < 0
.head 10 -  Call SalMessageBox('Ошибка при досрочном расторжении!', CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 6 +  Else
.head 7 -  ! Дата действия договора уже истекла
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessDAT_END'), 
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 3 +  Data Field: S_STOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.933"
.head 6 -  Top:    2.167"
.head 6 -  Width:  1.517"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Сумма штрафа при досрочном закрытии вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipS_STOP'))
.head 3 +  Data Field: dfShtrafProc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    2.167"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Сумма начисленных % при штрафной % ставке 
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipShtrafProc'))
.head 3 +  Data Field: dfRealProc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    2.167"
.head 6 -  Width:  1.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Сумма начисленных % при реальной депозитной  % ставке
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipRealProc'))
.head 3 +  Data Field: dfEarlyEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.44"
.head 6 -  Top:    1.845"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата досрочного расторжения вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipEarlyEnd'))
.head 3 -  !
.head 3 -  Background Text: Счет начисленных %%, выплата
.head 4 -  Resource Id: 48943
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.1"
.head 5 -  Top:    1.631"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.214"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPROC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbPROC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.133"
.head 5 -  Top:    1.22"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \Bars98\RESOURCE\BMP\A_proc.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Начислить проценты
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipPROC')
.head 5 +  On SAM_Click
.head 6 -  Set sTmp=" and (s.acc=" || Str(ACC) || ")"
.head 6 -  Call Sel010(hWndMDI,0,0,sTmp,'')
.head 6 -  Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 3 +  Pushbutton: pb_N2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.583"
.head 5 -  Top:    1.22"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\App1.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Полное снятие процентов наличными
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipN2')
.head 5 +  On SAM_Click
.head 6 +  If TT2 != STRING_Null
.head 7 -  Call F_VVOD(NLSN, TT2, STRING_Null, STRING_Null, STRING_Null, OSTN_PL , nID, sErrMsg)
.head 6 +  Else
.head 7 -  Call F_VVOD(NLSN, 'DP4', STRING_Null, STRING_Null, STRING_Null, OSTN_PL , nID, sErrMsg)
.head 3 +  Pushbutton: pb_PrnLicN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.033"
.head 5 -  Top:    1.22"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Print.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Печать выписки по счету начисленных процентов
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipPrnLicN')
.head 5 +  On SAM_Click
.head 6 -  Call F_Prn_Lic(NLSN, nKV, nKODZ, nFMT)
.head 3 +  Pushbutton: pbFindAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbSort
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.483"
.head 5 -  Top:    1.22"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\LOOK.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Найти счет
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Vklad.cBTipFindAcc')
.head 5 +  On SAM_Click
.head 6 +  If nRNK AND nKV
.head 7 -  Call SalCreateWindow( PL_CARDS, hWndMDI, 1, sNBSP, nRNK, nKV )
.head 3 -  !
.head 3 +  Data Field: MFOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.033"
.head 6 -  Top:    1.56"
.head 6 -  Width:  0.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! МФО банка для перечисления %
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipMFOP'))
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT nb INTO :sTmp 
     FROM banks 
    WHERE mfo = :MFOP AND nvl(blk, 0) != 4")
and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  ! Введите правильный код МФО банка
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrSetMFO_P'),
                   CurrentLangTable.GetAtomTitle('frm_New.cTErrRekv'),
                   MB_Ok|MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Data Field: NLSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.017"
.head 6 -  Top:    1.869"
.head 6 -  Width:  1.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Счет перечисления %
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipNLSP'))
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If MFOP != STRING_Null AND Vkrz2(MFOP, NLSP) != NLSP
.head 7 -  ! Ошибка в контрольном разряде номера счета!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrNLS_KR'),
                   CurrentLangTable.GetAtomTitle('frm_New.cTErrRekv'), 
                   MB_Ok|MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If MFOP = GetBankMfo() 
.head 7 +  If SqlPrepareAndExecute(hSql(),
  "SELECT c.okpo, substr(a.nms, 1, 38) 
     INTO :OKPOP, :NAMEP
     FROM customer c, accounts a
    WHERE c.rnk = a.rnk 
      AND a.nls = :NLSP 
      AND a.kv  = :nKV 
      AND a.dazs IS NULL")
  and NOT SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrAccNotFound'),
                   CurrentLangTable.GetAtomTitle('frm_New.cTErrRekv'), 
                   MB_Ok|MB_IconStop)
.head 8 -  Return VALIDATE_Cancel
.head 3 +  Data Field: OKPOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.933"
.head 6 -  Top:    1.56"
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код ОКПО для перечисления %
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipOKPOP'))
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If V_Okpo(OKPOP) != OKPOP
.head 7 -  ! Ошибка кода ОКПО
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrOKPO'),
                   CurrentLangTable.GetAtomTitle('frm_New.cTErrRekv'), 
                   MB_Ok|MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Data Field: NAMEP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    1.869"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Наименование счета перечисления %
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipNAMEP'))
.head 3 -  !
.head 3 +  Data Field: NLSN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.017"
.head 6 -  Top:    2.167"
.head 6 -  Width:  1.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Счет начисленных %
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipNLSN'))
.head 3 +  Data Field: OSTN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: OSTN_PL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.883"
.head 6 -  Top:    2.167"
.head 6 -  Width:  1.917"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Остаток на счете начисленных %
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipOSTN_PL'))
.head 3 +  Data Field: ACR_DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.783"
.head 6 -  Top:    2.167"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата предыдущего начисления  %
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipACR_DAT'))
.head 3 +  Data Field: STP_DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.783"
.head 6 -  Top:    2.167"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата предыдущего начисления  %
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipSTP_DAT'))
.head 3 +  Combo Box: cmbTTN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.017"
.head 5 -  Top:    2.488"
.head 5 -  Width:  4.4"
.head 5 -  Width Editable? No
.head 5 -  Height: 2.094"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: 35
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name:
.head 4 -  Font Size: 0
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask:
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If (cmbTTN !=STRING_Null )
.head 7 -  Set sTmp=cmbTTN.GetKey(SalListQuerySelection(hWndItem))
.head 7 +  If SqlPrepareAndExecute( hSql(), 
  " SELECT val INTO :nOP FROM op_rules 
    WHERE tag='DPTOP' AND tt=:sTmp" ) 
 AND SqlFetchNext( hSql(), nFetchRes )
.head 8 +  If nOP=3 
.head 9 -  Call F_VVOD(NLSN, sTmp, STRING_Null,STRING_Null, STRING_Null, 0, nID, sErrMsg )
.head 8 +  Else If nOP=33
.head 9 +  If dDAT_END<=dBankDate 
.head 10 -  Call F_VVOD(NLSN, sTmp, STRING_Null,STRING_Null, STRING_Null, OSTN_PL, nID, sErrMsg )
.head 9 +  Else If dDAT_END>dBankDate AND nFREQ=400 
.head 10 -  ! Еще не время выплачивать проценты
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessVyplProc'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 9 +  Else
.head 10 -  Call F_PAY33(NLSN,nKV,OST,OSTN_PL,ACR_DAT,sTmp,nID,nProc,nFREQ,nOP,STRING_Null,STRING_Null,STRING_Null,sErrMsg )
.head 8 +  Else If nOP=44
.head 9 +  If dDAT_END<=dBankDate 
.head 10 -  Call F_VVOD(NLSN,sTmp,MFOP,NLSP,NAMEP,OSTN_PL,nID,sErrMsg)
.head 9 +  Else If dDAT_END>dBankDate AND nFREQ=400 
.head 10 -  ! Еще не время выплачивать проценты
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessVyplProc'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 9 +  Else
.head 10 -  Call F_PAY33(NLSN,nKV,OST,OSTN_PL,ACR_DAT,sTmp,nID,nProc,nFREQ,nOP,MFOP,NLSP,NAMEP,sErrMsg)
.head 8 +  Else
.head 9 -  Call F_VVOD(NLSN,sTmp,MFOP,NLSP,NAMEP,0,nID,sErrMsg)
.head 6 +  Else
.head 7 -  ! Не выбрана операция
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessTT'),
     CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Операции со счетом начисленных %
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipTTN'))
.head 3 +  Child Table: TB2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.017"
.head 6 -  Top:    2.774"
.head 6 -  Width:  5.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.143"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: DAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRIP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Начис
%
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.057"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRIPs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Начис
%
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RASP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выплата
 %
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.014"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RASPs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выплата
 %
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.183"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ISXP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
по %
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ISXPs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
по %
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On SAM_DoubleClick
.head 6 -  Set sdat=SalFmtFormatDateTime(TB2.DAT,'MM/dd/yyyy') 
.head 6 -  Call ShowTurnForAccount( ACCN, sdat)
.head 5 +  On SAM_FetchRowDone
.head 6 -  ! проверка на 3 знака
.head 6 -  Set PRIPs = Dig4( PRIP, nDig, nDig )
.head 6 -  Set RASPs = Dig4( RASP, nDig, nDig )
.head 6 -  Set ISXPs = Dig4( ISXP, nDig, nDig )
.head 3 -  !
.head 3 -  !
.head 3 +  Data Field: df_DeposComm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 128
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    1.151"
.head 6 -  Width:  6.866"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Комментарий
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Vklad.cFTipDeposComm'))
.head 3 +  Data Field: DAT1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   12.4"
.head 6 -  Top:    0.762"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 52767
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.05"
.head 5 -  Begin Y:  0.33"
.head 5 -  End X:  6.883"
.head 5 -  End Y:  0.33"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 2 +  Functions
.head 3 +  Function: F_VVOD
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: nls
.head 5 -  String: tt
.head 5 -  String: s1 !! МФО получателя
.head 5 -  String: s2 !! Счет получателя
.head 5 -  String: s3 !! Наименование получателя
.head 5 -  Number: nSu
.head 5 -  Number: nDeposit_Id
.head 5 -  Receive Long String: sErrMsg
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! факт.сумма
.head 5 -  Number: nSu_
.head 5 -  ! гран.сумма
.head 5 -  Number: nSumMax
.head 5 -  !
.head 5 -  Number: nOpId
.head 5 -  Number: i
.head 5 -  String: sNlsk_
.head 5 -  String: sTmp_
.head 5 -  Number: nDk
.head 5 -  Number: nTip
.head 4 +  Actions
.head 5 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 5 +  If not IsWindow(hWinW)
.head 6 -  Set nRes=IDYES
.head 6 -  If (SqlPrepareAndExecute(hSql(),"SELECT val INTO :nOpId FROM op_rules WHERE tag='DPTOP' AND tt = :tt") 
AND SqlFetchNext(hSql(),i))
.head 6 +  Else
.head 7 -  ! Невозможно выбрать значение из таблицы op_rules для операции <tt>
.head 7 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_Vklad.cTErrOpRules') || ' ' || tt
.head 7 -  Return -1
.head 6 +  If SqlPrepareAndExecute(hSql(), "SELECT dk INTO :nDk FROM TTS WHERE tt=:tt")
.head 7 -  Call SqlFetchNext(hSql(),i)
.head 6 -  Set nSu_=0
.head 6 -  Set nSumMax = 0
.head 6 -  Set sNlsk_=STRING_Null
.head 6 -  ! первичный взнос (=0)
.head 6 +  If nOpId = 0 
.head 7 -  Set nSumMax = nSmin
.head 7 -  Set nSu_ = nSum0
.head 7 +  If nDk=1
.head 8 -  Set sTmp_=sNlsk_
.head 8 -  Set sNlsk_=nls
.head 8 -  Set nls=sTmp_
.head 6 -  ! перевод денег на другой вид вклада (=6)
.head 6 +  Else If nOpId = 6
.head 7 -  Set sNlsk_='26???'||Subs(nls,6,5)||'*'
.head 7 -  Set nSu_ = OST_PL
.head 6 -  ! пополнение осн.счета (=1)
.head 6 +  Else If nOpId = 1
.head 7 -  Set nSu_ = nLIMIT
.head 7 -  Set nSumMax = nLIMIT
.head 7 +  If nDk=1
.head 8 -  Set sTmp_=sNlsk_
.head 8 -  Set sNlsk_=nls
.head 8 -  Set nls=sTmp_
.head 6 -  ! снятие %% Нал/БезНал(=3,33,4,44)
.head 6 +  Else If nOpId = 3 OR nOpId = 33  OR nOpId = 4  OR nOpId = 44 
.head 7 -  ! снятие %% Нал/БезНал
.head 7 +  If nOpId = 3  OR nOpId = 4
.head 8 -  Set nSu_ = OSTN_PL
.head 8 -  Set sOKPO = OKPOP
.head 7 -  ! Индивид.выплата %%
.head 7 +  Else
.head 8 -  Set nSu_ = nSu
.head 8 -  Set nSumMax = nSu
.head 7 -  ! Предупреждение о недоначисленных %%
.head 7 +  If dDAT_END!=DATETIME_Null AND dDAT_END<=dBankDate AND 
  (ACR_DAT<dDAT_END-1 OR 
  (ACR_DAT<dBankDate-1 AND STP_DAT=DATETIME_Null))
.head 8 -  ! По данному вкладу недоначислены проценты! 
  Для выплаты процентов нажмите Да(Yes).
  Для доначисления процентов нажмите Нет(No).
  Для отмены операции нажмите Отмена(Cancel).
.head 8 -  Set nRes = SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessResProc') || PutCrLf() || PutCrLf() ||
    CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessresYesProc') || ' (Yes).' || PutCrLf() ||
    CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessResNo')      || '(No).'   || PutCrLf() ||
    CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessResCancel')  || '(Cancel).' , 
    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNoCancel| MB_IconQuestion)
.head 8 +  Select Case nRes
.head 9 +  Case IDYES
.head 10 -  Break
.head 9 +  Case IDNO 
.head 10 -  Call SalSendMsg( pbPROC, SAM_Click, 0, 0 )
.head 10 -  Return 0
.head 9 +  Case IDCANCEL	
.head 10 -  Return 0
.head 6 -  ! снятие со счета Нал/БезНал и срок истек (=2,22)
.head 6 +  Else
.head 7 +  If nOpId = 2
.head 8 +  If dDAT_END=DATETIME_Null
.head 9 -  Set nSu_ = OST_PL
.head 8 +  Else If dDAT_END<=dBankDate 
.head 9 -  ! Предупреждение о недоначисленных %%
.head 9 +  If ACR_DAT<dDAT_END-1 OR
 (ACR_DAT<dBankDate-1 AND STP_DAT=DATETIME_Null)
.head 10 -  ! По данному вкладу недоначислены проценты!
  Для выплаты капитала нажмите Да(Yes).
  Для доначисления процентов нажмите Нет(No).
  Для отмены операции нажмите Отмена(Cancel).
.head 10 -  Set nRes = SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessResProc') || PutCrLf() || PutCrLf() ||
    CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessResYesCapital') || '(Yes).' || PutCrLf() ||
    CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessNo')            || '(No).'  || PutCrLf() ||
    CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessResCancel')     || '(Cancel).' , 
    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNoCancel| MB_IconQuestion)
.head 10 +  Select Case nRes
.head 11 +  Case IDYES
.head 12 -  Break
.head 11 +  Case IDNO 
.head 12 -  Call SalSendMsg( pbPROC, SAM_Click, 0, 0 )
.head 12 -  Return 0
.head 11 +  Case IDCANCEL	
.head 12 -  Return 0
.head 9 -  Call SalSendMsg( frm_Vklad.pbRefresh, SAM_Click, 0, 0 )
.head 9 +  If OSTN_PL>0
.head 10 -  Call SalSendMsg( frm_Vklad.pb_N2, SAM_Click, 0, 0 )
.head 9 -  Set nSu_ = OST_PL
.head 8 +  Else
.head 9 -  ! вклад со штрафом 
.head 9 +  If deposit_id>0 AND nIdStop != 0 AND nRefDPS = 0
.head 10 -  Call SalModalDialog( dlgDrawing, hWndForm, nTip )
.head 10 -  ! Штраф
.head 10 +  If nTip=2
.head 11 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 11 -  Set nSu_ = OST_PL
.head 11 +  If ((ACR_DAT = DATETIME_Null OR ACR_DAT < dBankDate - 1) 
     AND 
     dDAT_BEGIN + 1 < dBankDate)
.head 12 -  ! Для расчета штрафа нужно доначислить %
.head 12 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessProc'), 
     CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 12 -  Call SalSendMsg( pbPROC, SAM_Click, 0, 0 )
.head 12 -  Return 0
.head 11 +  Else
.head 12 +  If F_SHTRAF(0) < 0
.head 13 -  Return -1
.head 12 -  ! вычисляем плановый остаток на основном счете
.head 12 +  If not SqlPrepareAndExecute( hSql(),
        "SELECT a.ostb INTO :nSu_ FROM accounts a WHERE acc=:ACC")
   and SqlFetchNext( hSql(), nFetchRes )
.head 13 -  ! Не могу вычислить плановый остаток после проводки штрафа DPS
.head 13 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_Vklad.cTErrOstbDPS')
.head 13 -  Return -1
.head 12 -  Set nSu_ = OST_PL
.head 10 -  ! Част. снятие
.head 10 +  Else If nTip=1
.head 11 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 11 +  If NOT F_DRAWING ()
.head 12 -  Return -1
.head 11 -  ! вычисляем плановый остаток на основном счете
.head 11 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 11 -  Set nSu_ = OST_PL
.head 10 -  ! Свободное снятие
.head 10 +  Else If nTip=0
.head 11 -  Set nSu_ = OST_PL
.head 10 -  ! Отмена
.head 10 +  Else
.head 11 -  Return -1
.head 9 +  Else
.head 10 -  Set nSu_ = OST_PL
.head 7 +  Else If nOpId = 22
.head 8 +  If (dDAT_END!=DATETIME_Null AND dDAT_END<=dBankDate)
.head 9 -  ! Предупреждение о недоначисленных %%
.head 9 +  If ACR_DAT<dDAT_END-1 OR
  (ACR_DAT<dBankDate-1 AND STP_DAT=DATETIME_Null)
.head 10 -  ! По данному вкладу недоначислены проценты! 
  Для выплаты капитала нажмите Да(Yes).
  Для доначисления процентов нажмите Нет(No).
  Для отмены операции нажмите Отмена(Cancel).
.head 10 -  Set nRes = SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessResProc') || PutCrLf() || PutCrLf() ||
    CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessResYesCapital') || '(Yes).' || PutCrLf() ||
    CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessResNo')         || '(No).'  || PutCrLf() ||
    CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessResCancel')     || '(Cancel).' , 
    CurrentLangTable.GetAtomTitle('cTat'), MB_YesNoCancel| MB_IconQuestion)
.head 10 +  Select Case nRes
.head 11 +  Case IDYES
.head 12 -  Break
.head 11 +  Case IDNO 
.head 12 -  Call SalSendMsg( pbPROC, SAM_Click, 0, 0 )
.head 12 -  Return 0
.head 11 +  Case IDCANCEL	
.head 12 -  Return 0
.head 9 -  Call SalSendMsg( frm_Vklad.pbRefresh, SAM_Click, 0, 0 )
.head 9 +  If OSTN_PL>0
.head 10 -  Call SalSendMsg( frm_Vklad.pb_N2, SAM_Click, 0, 0 )
.head 9 -  Set nSu_ = OST_PL
.head 6 +  If nSu > 0
.head 7 -  Set nSu_ = nSu
.head 6 +  If nRes=IDYES
.head 7 -  Set hWinW=SalCreateWindow(CB_VVOD1,hWndMDI, 
nDeposit_Id, tt, nOpId, nKV, STRING_Null, nSu_, nSumMax, 0, 
nls, sNlsk_, s1, s2, s3, 
'ATRT', sVYDAN, 'FIO', sFIO, 'PASP', sPASP, 'PASPN', sPASPN, 'POKPO', sPOKPO)
.head 6 -  Return 0
.head 3 +  Function: F_SHTRAF
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nFlg ! флаг, показывать ли подтверждение на совершение проводки (=0 - нет, =1-да)
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nS
.head 5 -  Number: i
.head 5 -  String: sNLS67
.head 5 -  String: sNAM67
.head 5 -  Boolean: FL
.head 4 +  Actions
.head 5 +  If SqlPLSQLCommand(hSql(),"bars.dpt.p_shtraf(nID, 
                                             dBankDate, 
                                             dfRealProc, 
                                             dfShtrafProc, 
                                             sShtrafComment)")
.head 6 +  If GetGlobalOption('DPT_DEB') = '1' 
.head 7 -  Call SalModalDialog(dlgShtraf, frm_Vklad, nID, sShtrafComment)
.head 6 -  !
.head 6 -  Set S_STOP = dfRealProc - dfShtrafProc
.head 6 -  Call SalShowWindow(S_STOP) 
.head 6 +  If S_STOP > 0
.head 7 +  If nFlg = 1
.head 8 -  ! Выполнить проводку на взыскание штрафа на сумму <...>? Будет сформирован дополнительный платеж
.head 8 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessFlg1')
                 ||" "
                 ||SalNumberToStrX(S_STOP, nDig)
                 ||" ?", 
                 CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessFlg1_'),
                 MB_YesNo | MB_IconQuestion) = IDYES  
.head 9 +  If NOT PayDPS (nID, S_STOP*SalNumberPower(10,nDig))
.head 10 -  Return -1
.head 8 +  Else
.head 9 -  Return 0
.head 7 +  Else
.head 8 +  If NOT PayDPS(nID, S_STOP*SalNumberPower(10,nDig))
.head 9 -  Return -1
.head 6 -  Call SalSendMsg(frm_Vklad.pbRefresh, SAM_Click, 0, 0)
.head 6 +  If OSTN_PL > 0
.head 7 -  Call SalSendMsg(frm_Vklad.pb_N2, SAM_Click, 0, 0)
.head 6 -  Return 0
.head 5 +  Else
.head 6 -  Return -1
.head 3 +  Function: F_DRAWING
.head 4 -  Description: Процедура перерасчета %% при част.снятии со вклада
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nIdDrawing != NUMBER_Null AND nIdDrawing > 0   
.head 6 -  ! Выполнить процедуру перерасчета %% при частичном снятии?
.head 6 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessIdDrawing'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion|MB_YesNo ) = IDYES
.head 7 +  If SqlPLSQLCommand(hSql(), "bars.dpt.p_write_down (nID, dBankDate)")
.head 8 -  Call SqlCommitEx( hSql(), 'Частичное снятие со вклада №'||Str(nID) )
.head 8 -  Call SalSendMsg( frm_Vklad.pbRefresh, SAM_Click, 0, 0 )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Return TRUE
.head 3 +  Function: F_PAY33
.head 4 -  Description: Снятие %% с учетом периодичности выплаты %%
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: NLS         ! Счет начисл.%%
.head 5 -  Number: KV          ! Валюта
.head 5 -  Number: OST         ! Остаток на осн.счете
.head 5 -  Number: OSTN_PL     ! Остаток на счете начисл.%%
.head 5 -  Date/Time: ACR_DAT  ! Дата последнего начисления %%
.head 5 -  String: TT          ! Код операции
.head 5 -  Number: nID         ! № депозита
.head 5 -  Number: PROC        ! текущая %% ставка
.head 5 -  Number: FREQ        ! период-ть выплаты %%
.head 5 -  Number: OP          ! =  33-Нал, 44 БезНал
.head 5 -  String: MFOp
.head 5 -  String: NLSp
.head 5 -  String: NAMEp
.head 5 -  String: sErrMsg     ! Типа ошибка
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetchRes
.head 5 -  Number: ACCN
.head 5 -  Date/Time: DAOS
.head 5 -  Number: nS
.head 5 -  Number: nM_OLD
.head 5 -  Number: nSV
.head 5 -  Number: nSX
.head 5 -  Number: nM
.head 5 -  Number: nMONTHS
.head 5 -  Date/Time: dX
.head 5 -  Date/Time: dY
.head 5 -  Date/Time: dDAT_FROM
.head 4 +  Actions
.head 5 +  If FREQ=3
.head 6 -  Set nMONTHS=7
.head 5 +  Else If FREQ=5
.head 6 -  Set nMONTHS=1
.head 5 +  Else If FREQ=7
.head 6 -  Set nMONTHS=3
.head 5 +  Else If FREQ=180
.head 6 -  Set nMONTHS=6
.head 5 +  Else If FREQ=360
.head 6 -  Set nMONTHS=12
.head 5 +  Else
.head 6 -  Call F_VVOD(NLS, TT, MFOp, NLSp, NAMEp, OSTN_PL, nID, sErrMsg)
.head 6 -  Return 1
.head 5 -  ! Счет начисл.%%
.head 5 -  If SqlPrepareAndExecute(hSql(),
    "SELECT acc, daos INTO :ACCN, :DAOS
     FROM accounts WHERE nls=:NLS AND kv=:KV")
AND SqlFetchNext(hSql(),nFetchRes)
.head 5 +  If ACR_DAT=DATETIME_Null
.head 6 -  Set ACR_DAT=DAOS
.head 5 -  ! Кол-во периодов с момента открытия вклада(nM)
.head 5 +  If FREQ!=3
.head 6 +  If SqlPrepareAndExecute( hSql(),
  "SELECT trunc(MONTHS_BETWEEN(:dBankDate,:DAOS),0) INTO :nM FROM dual")
.head 7 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Set nM=Int(nM/nMONTHS)
.head 5 +  Else
.head 6 -  Set nM=Int((dBankDate-DAOS)/nMONTHS)
.head 5 -  ! Контрольная дата текущего месяца dX
.head 5 -  Set nM_OLD=nM*nMONTHS
.head 5 +  If FREQ!=3
.head 6 +  If SqlPrepareAndExecute( hSql(),
   "SELECT ADD_MONTHS(:DAOS,:nM_OLD) INTO :dX FROM dual" )
.head 7 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 5 +  Else
.head 6 -  Set dX=DAOS+nM_OLD
.head 5 +  If dX <= DAOS
.head 6 -  ! Еще не время выплачивать проценты
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessVyplProc'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 6 -  Return 0
.head 5 +  Else
.head 6 -  ! Доначисляем %% по контрольную дату -1
.head 6 +  If ACR_DAT < dX - 1
.head 7 -  ! Необходимо доначислить %% до <...>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessACR_DAT') || " "||SalFmtFormatDateTime(dX-1, 'dd-MM-yyyy'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 7 -  Call Sel010( hWndMDI, 0, 0, " and (s.acc=" || Str(ACC) || ")", " "|| SalFmtFormatDateTime( dX-1,'dd/MM/yyyy') )
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 7 -  Return 1
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT nvl(sum(dos),0) INTO :nSV 
      FROM saldoa 
     WHERE acc=:ACCN AND fdat>=:DAOS" ) AND 
 NOT SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set nSV=0
.head 7 -  Set nSV = nSV / SalNumberPower(10, nDig)
.head 7 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT to_date(min(s.fdat)+1) INTO :dDAT_FROM 
   FROM saldoa s, accounts a 
   WHERE a.acc=s.acc AND s.acc=:ACC AND s.kos>0 AND
         a.daos>=to_date('01-01-2004','dd-MM-yyyy') " ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set dDAT_FROM=DAOS 
.head 7 +  If dDAT_FROM=DATETIME_Null
.head 8 -  Set dDAT_FROM=DAOS 
.head 7 -  !
.head 7 -  Set dY=dX-1
.head 7 -  Set nSX=SalNumberRound(p_intN(ACC,1,dDAT_FROM,dY,NUMBER_Null,0))/SalNumberPower(10, nDig)
.head 7 -  Set nS=nSX-nSV
.head 7 +  If nS>0
.head 8 -  Call F_VVOD(NLS, TT, MFOp, NLSp, NAMEp, nS, nID, sErrMsg )
.head 8 -  Return 1
.head 7 +  Else
.head 8 -  ! Еще не время выплачивать проценты
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Vklad.cTMessVyplProc'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 8 -  Return 0
.head 3 +  Function: PayDPS
.head 4 -  Description: Выполняет проводки штрафа
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nDptId    ! идентификатор вклада
.head 5 -  Number: nFineSum  ! cумма штрафа (коп)
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nDptRest
.head 5 -  Number: nIntRest
.head 4 +  Actions
.head 5 +  If NOT SqlPLSQLCommand(hSql(), 
   "dpt_web.penalty_payment (nDptId, nFineSum, nDptRest, nIntRest)")
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  Call SqlCommit(hSql())
.head 6 -  Return TRUE
.head 3 +  Function: F_Prn_Lic
.head 4 -  Description: Печать выписки по депозитному счету и по счету нач.%% 
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sNLS
.head 5 -  Number: nKV
.head 5 -  Number: nKODZ
.head 5 -  Number: nFMT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sFileName
.head 4 +  Actions
.head 5 -  Set sFileName = GetPrnDir()||'\\'||SalStrTrimX(sNLS)||SalStrLeftX(sIso,3)||'.TXT'
.head 5 -  Call ExportCatQuery(nKODZ, 
                    sFileName, 
                    nFMT, 
                    ":NLS_MASK='"||SalStrTrimX(sNLS)||"',:KV='"||Str(nKV)||"'", 
                    TRUE)
.head 5 +  If nFMT = 3 
.head 6 -  Call DosDirectPrint(sFileName)
.head 3 +  Function: sTranN ! Трансляция формул в назначении платежа
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive String: rsNazn
.head 5 -  String: sNazn     !! Исходная строка
.head 5 -  String: sTT       !! Тип операции
.head 5 -  String: sNls1     !! Счет-А
.head 5 -  String: sBank1    !! МФО-А
.head 5 -  Number: nKv1      !! Код вал-А 
.head 5 -  Number: nS1       !! Сумма-А
.head 5 -  String: sNls2     !! Счет-Б     
.head 5 -  String: sBank2    !! МФО-Б
.head 5 -  Number: nKv2      !! Код вал-Б 
.head 5 -  Number: nS2       !! Сумма-Б
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: S    !
.head 5 -  String: S2   ! для
.head 5 -  String: KvA  ! при вычислении суммы операции
.head 5 -  String: KvB  !
.head 5 -  !
.head 5 -  String: sS
.head 5 -  String: sFormula
.head 5 -  String: sNazD
.head 5 -  Number: i
.head 5 -  Number: j
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 -  Set sS=sNazn
.head 5 -  Set i=SalStrScan(sS,'?')
.head 5 +  While i>=0 and (SalStrMidX(sS,i+3,1) =' ' or SalStrMidX(sS,i+3,1) = STRING_Null)
           and SalStrMidX(sS,i+1,1)>='0' and SalStrMidX(sS,i+1,1) <='9'
           and SalStrMidX(sS,i+2,1)>='0' and SalStrMidX(sS,i+2,1) <='9'
.head 6 -  Call SqlPrepareAndExecute(hSql(), "SELECT TRIM(txt) INTO :sNazD FROM tnaznf WHERE n="||SalStrMidX(sS,i+1,2))
.head 6 +  If SqlFetchNext(hSql(),nFetchRes)
.head 7 -  Set sS=SalStrLeftX(sS,i)||'#{'||SalStrTrimX(sNazD)||'}'||SalStrRightX(sS,SalStrLength(sS)-i-3)
.head 6 +  Else
.head 7 -  Break
.head 6 -  Set i=SalStrScan(sS,'?')
.head 5 -  Set rsNazn=sS
.head 5 +  If SalStrScan(sS,'#{')<0 and SalStrScan(sS,'#(')<0
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Set S  = SalNumberToStrX(nS1, 0)   ! Сумма платежа
.head 6 -  Set S2 = SalNumberToStrX(nS2, 0)   ! Сумма платежа
.head 6 -  Set KvA = SalNumberToStrX(nKv1, 0) ! Код валюты А
.head 6 -  Set KvB = SalNumberToStrX(nKv2, 0) ! Код валюты B
.head 6 -  Set sS = ' ' || sS                 ! SalStrUpperX(' ' || sS)
.head 6 +  While SalStrScan(sS, '#(S)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(S)'),4,S)
.head 6 +  While SalStrScan(sS, '#(S2)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(S2)'),5,S2)
.head 6 +  While SalStrScan(sS,'#(NLSA)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(NLSA)'),7,sNls1)
.head 6 +  While SalStrScan(sS,'#(NLSB)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(NLSB)'),7,sNls2)
.head 6 +  While SalStrScan(sS,'#(MFOA)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(MFOA)'),7,sBank1)
.head 6 +  While SalStrScan(sS,'#(MFOB)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(MFOB)'),7,sBank2)
.head 6 +  While SalStrScan(sS,'#(KVA)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(KVA)'),6,KvA)
.head 6 +  While SalStrScan(sS,'#(KVB)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(KVB)'),6,KvB)
.head 6 +  While SalStrScan(sS,'#(TT)') > 0
.head 7 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(TT)'),5,"'"||sTT||"'")
.head 6 -  Set i=SalStrScan(sS,'#{')
.head 6 +  While i>=0
.head 7 -  Set sFormula=SalStrMidX(sS,i+2,SalStrLength(sS)-i-2)
.head 7 -  Set j=SalStrScan(sFormula,'}')
.head 7 +  If j>=0
.head 8 -  Set sFormula=SalStrLeftX(sFormula,j)
.head 8 +  If not SqlPrepareAndExecute(hSql(), "SELECT SUBSTR(" || sFormula || ",1,160) INTO :sNazD FROM dual")
.head 9 -  Return FALSE
.head 8 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 9 -  Return FALSE
.head 8 -  Set sS=SalStrLeftX(sS,i)||SalStrTrimX(sNazD)||SalStrRightX(sS,SalStrLength(sS)-j-i-3)
.head 7 -  Set i=SalStrScan(sS,'#{')
.head 6 -  Set rsNazn=sS
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: deposit_id
.head 3 -  String: type_name
.head 3 -  String: nmk
.head 3 -  String: pasp
.head 3 -  String: paspn
.head 3 -  String: vydan
.head 3 -  String: TT1  !! код операции для полного снятия нал с депозитного счета
.head 3 -  String: TT2  !! код операции для полного снятия нал со счета начисл.%%
.head 3 -  String: CASH !! признак вечерней кассы и группы отделения или DPT_DEPOSIT_CLOS.IDUPD (для deposit_id < 0, т.е. из архива)
.head 3 -  ! Доступ на закладки карточки счета
.head 3 -  String: sAccFilterOnTab
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  String: strWndName
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  Number: FL_AUTO_ADD
.head 3 -  Number: ACC
.head 3 -  Number: ACCN
.head 3 -  Number: ACCA
.head 3 -  Date/Time: DAT2
.head 3 -  Date/Time: dBankDate
.head 3 -  String: sTmp
.head 3 -  String: sTTB
.head 3 -  String: sAcc
.head 3 -  String: sdat
.head 3 -  String: sTT
.head 3 -  Number: nSmin
.head 3 -  Number: nSum0
.head 3 -  Number: nLIMIT
.head 3 -  String: sTable
.head 3 -  Number: nDig
.head 3 -  String: sIso
.head 3 -  Number: nVidd
.head 3 -  Number: nFREQ
.head 3 -  Number: nIdStop  
.head 3 -  Number: nIdDrawing 
.head 3 -  Number: nDptOp
.head 3 -  Number: nRes
.head 3 -  Number: nOP
.head 3 -  Number: nRNK
.head 3 -  Number: nKODZ
.head 3 -  Number: nFMT
.head 3 -  String: sPOKPO
.head 3 -  Long String: sShtrafComment
.head 3 -  Long String: sErrMsg
.head 3 -  String: EVE_CASH
.head 3 -  String: GRP_CASH
.head 3 -  !
.head 3 -  String: sKODZ
.head 3 -  Number: nKODZ_Full
.head 3 -  Number: nKODZ_Brief
.head 3 -  String: sNBSP
.head 3 -  !
.head 3 -  String: sTagVal[*,2]
.head 3 -  Boolean: bOk
.head 3 -  Number: nRefDPS
.head 3 -  !
.head 3 -  String: strLangId
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Vklad.cTWndTitle'))
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalGetWindowText(hWndForm, strWndName, 128)
.head 4 -  Call SaveInfoToLog(MSG_Invoke() || strWndName)
.head 4 -  !
.head 4 -  Call SalSetFocus( pbRefresh )
.head 4 -  Set dBankDate = GetBankDate(  )
.head 4 -  Set EVE_CASH=Subs(CASH,1,1)
.head 4 -  Set GRP_CASH=Subs(CASH,2,Len(CASH))
.head 4 -  ! Печать сберкнижки
.head 4 -  Set sKODZ=GetGlobalOption('DPT_BOOK')
.head 4 -  Set nKODZ_Full=SalStrToNumber(SalStrMidX( sKODZ, 0, SalStrScan( sKODZ, ';')))
.head 4 -  Set nKODZ_Brief=SalStrToNumber(SalStrMidX( sKODZ, SalStrScan( sKODZ, ';')+1,SalStrLength( sKODZ )))
.head 4 +  If sKODZ=STRING_Null
.head 5 -  Call SalDisableWindow( pbSberBook )
.head 4 +  Else
.head 5 -  Call SalEnableWindow( pbSberBook )
.head 4 -  ! Инф-ция о том, что вклад является залогом
.head 4 -  ! Set nDPT_PAWN = GetGlobalOptionEx('ZAL_DPT')
.head 4 -  Set nRefDPS = 0
.head 4 -  !
.head 4 -  Call SalSendMsg( hWndForm, SAM_User, 0, 0)
.head 3 +  On SAM_User
.head 4 +  If deposit_id < 0 
.head 5 -  Set sTable = 'dpt_deposit_clos'
.head 5 -  Set nID = - deposit_id
.head 5 +  If TT1= '@@@'
.head 6 -  Call SalHideWindow( pbDoc )
.head 6 -  Call SalHideWindow (pbFields)
.head 6 -  Call SalHideWindow( pb_PrnLic )
.head 6 -  Call SalHideWindow( pb_PrnLicN )
.head 6 -  Call SalHideWindow( pb_N1 )
.head 6 -  Call SalHideWindow( pb_N2 )
.head 6 -  Call SalHideWindow( cmbTT )
.head 6 -  Call SalHideWindow( cmbTTN )
.head 6 -  Call SalDisableWindow( MFOP )
.head 6 -  Call SalDisableWindow( OKPOP )
.head 6 -  Call SalDisableWindow( NLSP )
.head 6 -  Call SalDisableWindow( NAMEP )
.head 6 -  Call SalDisableWindow( df_DeposComm )
.head 5 -  ! ----------------------------
.head 5 -  Call SalDisableWindow( pbNAMEP )
.head 5 -  Call SalDisableWindow( pbRefresh )
.head 5 -  Call SalDisableWindow( pbClose )
.head 5 -  Call SalDisableWindow( pbPROC )
.head 4 +  Else
.head 5 -  Set sTable='dpt_deposit'
.head 5 -  Set nID=deposit_id
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Set sVIDD=type_name
.head 4 -  Set sFIO=nmk
.head 4 -  Set sPASP=pasp
.head 4 -  Set sPASPN=paspn
.head 4 -  Set sVYDAN=vydan
.head 4 -  Set mfText = STRING_Null
.head 4 +  If SqlPrepareAndExecute( hSql(),
"SELECT d.rnk, nvl(d.nd,to_char(d.deposit_id)), 
        v.vidd, a.kv, d.freq,
        a.acc,  a.nls,  a.ostc,  a.ostb,  
        an.acc, an.nls, an.ostc, an.ostb,
        nvl(d.limit,0)/power(10,t.dig), dpt.fproc(a.acc,bankdate), 
        nvl(v.min_summ,0), nvl(v.limit,0),
        d.datz, d.dat_begin, d.dat_end,  
        i.acr_dat, i.stp_dat, nvl(i.acr_dat+1,d.dat_begin),      
        d.mfo_p, d.nls_p, substr(d.name_p,1,38), d.okpo_p,
        nvl(v.id_stop,0), nvl(v.br_wd,0),
        d.comments, v.kodz, v.fmt, t.dig, t.lcv, c.okpo, d.dat_end_alt, 
        Nvl(AUTO_ADD,0) 
   INTO :nRNK,:sND,:nVidd,:nKV,:nFREQ,
        :ACC,:NLS,:OST,:OST_PL,
        :ACCN,:NLSN,:OSTN,:OSTN_PL,
        :nSum0,:nProc,:nSmin,:nLIMIT,
        :dDATZ,:dDAT_BEGIN,:dDAT_END,
        :ACR_DAT,:STP_DAT,:DAT1,
        :MFOP,:NLSP,:NAMEP,:OKPOP,
        :nIdStop,:nIdDrawing,
        :df_DeposComm,:nKODZ,:nFMT,:nDig, :sIso, :sPOKPO, :dfEarlyEnd,
        :FL_AUTO_ADD
   FROM "||sTable||" d,accounts a,accounts an,int_accn i,dpt_vidd v,tabval t, customer c 
  WHERE d.vidd=v.vidd     AND d.acc=a.acc   AND d.acc=i.acc AND 
        i.id=1            AND i.acra=an.acc AND a.kv=an.kv  AND 
        d.deposit_id=:nID AND a.kv=t.kv     AND d.rnk=c.rnk "||
        IifS(deposit_id < 0," AND to_char(d.idupd) = :frm_Vklad.CASH"," "))
and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set OST     = OST     * SalNumberPower(10, -nDig)
.head 5 -  ! Пишем код вида вклада
.head 5 -  Set sVIDD = Str(nVidd)||' - '||sVIDD
.head 5 -  !
.head 5 -  Set OST_PL  = OST_PL  * SalNumberPower(10, -nDig)
.head 5 -  Set OSTN    = OSTN    * SalNumberPower(10, -nDig)
.head 5 -  Set OSTN_PL = OSTN_PL * SalNumberPower(10, -nDig)
.head 5 -  Call SalFmtSetPicture(OST_PL,  '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
.head 5 -  Call SalFmtSetPicture(OSTN_PL, '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
.head 5 -  Call SalFmtSetPicture(dfRealProc,   '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
.head 5 -  Call SalFmtSetPicture(dfShtrafProc, '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
.head 5 -  Call SalFmtSetPicture(S_STOP,       '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
.head 5 -  ! Находим счет амортизации для авансового вида вклада
.head 5 +  If SqlPrepareAndExecute( hSql(), 
 "SELECT i.acrb INTO :ACCA
  FROM int_accn i,accounts a,dpt_deposit d,dpt_vidd v
  WHERE i.id=1              AND d.acc=i.acc   AND i.acrb=a.acc     AND 
        a.nbs=v.deposit_cod AND d.vidd=v.vidd AND d.deposit_id=:nID  " )
.head 6 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 5 +  If ACC=ACCN
.head 6 -  Call SalHideWindow( cmbTTN )
.head 6 -  Call SalHideWindow( NLSN )
.head 6 -  Call SalHideWindow( OSTN )
.head 6 -  Call SalHideWindow( OSTN_PL )
.head 6 -  Call SalHideWindow( MFOP )
.head 6 -  Call SalHideWindow( NLSP )
.head 6 -  Call SalHideWindow( NAMEP )
.head 6 -  Call SalHideWindow( OKPOP )
.head 6 -  Call SalHideWindow( ACR_DAT )
.head 6 -  Call SalHideWindow( TB2 )
.head 6 -  Call SalHideWindow( pb_N2 )
.head 6 -  Call SalHideWindow( pb_PrnLicN )
.head 5 -  ! Если счет начисленных % <> основному счету
.head 5 +  Else
.head 6 +  If OSTN_PL>0
.head 7 -  Call SalEnableWindow( cmbTTN )
.head 7 -  Call cmbTTN.Init(cmbTTN)
.head 7 -  ! Снятие со счета начисл.%% НАЛ=3/БЕЗНАЛ=4/ИНДИВИД.ВЫПЛАТА=33,44
.head 7 -  Call cmbTTN.Populate(hSql(),"TT", "NAME", "TTS", 
    " WHERE tt IN (SELECT tt FROM op_rules WHERE tag='DPTOP' AND val IN ('3','4','33','44')) 
        AND tt IN (SELECT tt FROM dpt_tts_vidd WHERE vidd=:nVidd )"||
  IifS(EVE_CASH='V',
              " AND tt IN  (SELECT tt FROM op_rules WHERE tag='EVKAS')",
              " AND tt NOT IN (SELECT tt FROM op_rules WHERE tag='EVKAS')" )||
  IifS(GRP_CASH!=STRING_Null,
              " AND (   tt IN (SELECT tt FROM op_rules WHERE tag='DPTGR' AND val=:GRP_CASH) 
                     OR tt NOT IN (SELECT tt FROM op_rules WHERE tag='DPTGR') )",
              " AND tt NOT IN (SELECT tt FROM op_rules WHERE tag='DPTGR') " )  )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( cmbTTN )
.head 6 -  Call SalTblPopulate ( TB2, hSqlAux2(), 
     "SELECT fdat,kos/100,dos/100,(ostf-dos+kos)/100
      INTO :TB2.DAT,:TB2.PRIP,:TB2.RASP,:TB2.ISXP
      FROM saldoa WHERE acc=:ACCN
      ORDER BY fdat desc", TBL_FillAll )
.head 5 -  Call cmbTT.Init(cmbTT)
.head 5 -  Call SalDisableWindow( pb_N1 ) 
.head 5 -  Call SalDisableWindow( pb_N2) 
.head 5 -  Call SalDisableWindow( pbClose ) 
.head 5 -  ! до востребования
.head 5 +  If dDAT_END = DATETIME_Null  AND OST_PL>0
.head 6 -  Call SalEnableWindow( pb_N1 ) 
.head 5 -  ! Срок истек 
.head 5 +  If dDAT_END != DATETIME_Null AND dDAT_END<=dBankDate
.head 6 -  ! Только снятие с основного счета
.head 6 +  If OST_PL>0
.head 7 -  Call cmbTT.Populate(hSql(),"TT", "NAME", "TTS", 
    " WHERE tt IN (SELECT tt FROM op_rules WHERE tag='DPTOP' AND val IN ('2','22','6')) 
        AND tt IN (SELECT tt FROM dpt_tts_vidd WHERE vidd=:nVidd )"||
  IifS(EVE_CASH='V',
              " AND tt IN  (SELECT tt FROM op_rules WHERE tag='EVKAS')",
              " AND tt NOT IN (SELECT tt FROM op_rules WHERE tag='EVKAS')" )||
  IifS(GRP_CASH!=STRING_Null,
              " AND (   tt IN (SELECT tt FROM op_rules WHERE tag='DPTGR' AND val=:GRP_CASH) 
                     OR tt NOT IN (SELECT tt FROM op_rules WHERE tag='DPTGR') )",
              " AND tt NOT IN (SELECT tt FROM op_rules WHERE tag='DPTGR') " )  )
.head 7 -  Call SalEnableWindow( pb_N1 ) 
.head 6 +  Else
.head 7 -  Call SalDisableWindow( cmbTT )
.head 7 -  Call SalDisableWindow( NLSP )
.head 7 -  Call SalDisableWindow( MFOP )
.head 7 -  Call SalDisableWindow( NAMEP )
.head 7 -  Call SalDisableWindow( OKPOP )
.head 5 -  ! Срок НЕ истек 
.head 5 +  Else
.head 6 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT ref INTO :nRefDPS 
     FROM opldok 
    WHERE tt = 'DPS' 
      AND sos > 0 
      AND fdat = bankdate 
      AND acc = :ACCN" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Set nRefDPS = 0 
.head 6 +  If deposit_id > 0  AND
   (nIdStop != 0)              AND 
   (dDAT_END!= DATETIME_Null)  AND
   ((OSTN_PL>0) OR (OST_PL>0)) AND 
   (dDAT_BEGIN<=dBankDate)     AND
    nRefDPS = 0 
.head 7 -  Call SalEnableWindow( pbClose ) 
.head 6 -  Call cmbTT.Populate(hSql(),"TT","NAME","TTS", 
         " WHERE tt IN (SELECT tt FROM op_rules WHERE tag='DPTOP' AND "||
         IifS(OST_PL=0,
                    " val='0')",
                    " (val='2' OR val='22' OR  val='1' OR val='6'))"
             )|| 
         " AND tt IN (SELECT tt FROM dpt_tts_vidd WHERE vidd=:nVidd ) "||
         IifS(EVE_CASH='V',
                      " AND tt IN  (SELECT tt FROM op_rules WHERE tag='EVKAS')",
                      " AND tt NOT IN (SELECT tt FROM op_rules WHERE tag='EVKAS')" 
             )||
         IifS(GRP_CASH!=STRING_Null AND GRP_CASH!='',
                       " AND (tt IN (SELECT tt FROM op_rules WHERE tag='DPTGR' AND val=:GRP_CASH) 
                           OR tt NOT IN (SELECT tt FROM op_rules WHERE tag='DPTGR') )",
                       " AND tt NOT IN (SELECT tt FROM op_rules WHERE tag='DPTGR')" 
             ))
.head 5 -  ! Если плановый остаток на % счету > 0 - разрешить полное снятие %
.head 5 +  If OSTN_PL > 0 AND dDAT_END<=dBankDate
.head 6 -  Call SalEnableWindow( pb_N2) 
.head 5 -  Call SalTblPopulate ( TB1, hSqlAux2(), "
 SELECT fdat,kos/100,dos/100,(ostf-dos+kos)/100, dpt.fproc(acc,fdat)
 INTO :TB1.DAT,:TB1.PRID,:TB1.RASD,:TB1.ISXD,:TB1.PROC
 FROM saldoa WHERE acc=:ACC
 ORDER BY fdat desc", TBL_FillAll )
.head 5 -  Call SalTblPopulate ( TB2, hSqlAux2(), "
 SELECT fdat,kos/100,dos/100,(ostf-dos+kos)/100
 INTO :TB2.DAT,:TB2.PRIP,:TB2.RASP,:TB2.ISXP
 FROM saldoa WHERE acc=:ACCN
 ORDER BY fdat desc", TBL_FillAll )
.head 5 -  ! Дата досрочного расторжения договора (для Петрокоммерцбанка)
.head 5 +  If GetGlobalOptionEx('VKL_MASK') = 2 AND dfEarlyEnd != DATETIME_Null
.head 6 -  Call SalShowWindow( dfEarlyEnd )
.head 5 +  Else
.head 6 -  Call SalHideWindow( dfEarlyEnd )
.head 5 -  ! Всяческая информация по вкладу
.head 5 -  Set strLangId = GetLang()
.head 5 -  Call SqlSetLongBindDatatype(1, 22)
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select substr(dpt.f_dpt_reminder(:nID,:strLangId),1,2000) into :mfText from dual")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  ! Выбор счетов для безнал.выплаты %%
.head 4 +  If FL_AUTO_ADD >0 
.head 5 -  Call SalShowWindow( pb_AUTO_ADD )
.head 4 +  Else
.head 5 -  Call SalHideWindow( pb_AUTO_ADD )
.head 4 +  If GetGlobalOption('DPT_NBSP')
.head 5 -  Set sNBSP = GetGlobalOption('DPT_NBSP')
.head 5 +  If SalIsNull(NLSP)
.head 6 -  Call SalEnableWindow( pbFindAcc )
.head 5 +  Else
.head 6 -  Call SalDisableWindow( pbFindAcc )
.head 4 +  Else
.head 5 -  Call SalHideWindow( pbFindAcc )
.head 3 +  On UM_CreateDoc
.head 4 -  Call CreateDepDoc( frm_Vklad.deposit_id, frm_Vklad.nVidd )
.head 1 +  Table Window: STUDENTS
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Вклады студентов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  16.183"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalTblReset( hWndForm )
.head 7 -  Call SalDisableWindow( pbOut )
.head 7 -  Call SalEnableWindow( pbOutS1 )
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 19025
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Карточка вклада
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('STUDENTS.cBTipDetails')
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWinV)
.head 8 -  Set hWinV= SalCreateWindow(frm_Vklad, hWndForm, 
                           STUDENTS.cDPT_ID, STUDENTS.sVIDD, STUDENTS.cNAME_F, 
                           STRING_Null, STRING_Null, STRING_Null, 
                           STRING_Null, STRING_Null, STRING_Null, STRING_Null)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 19026
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 19027
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbIn
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DOC_IN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Принять файл от ВУЗа
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('STUDENTS.cBTipIn')
.head 6 +  On SAM_Click
.head 7 -  ! Выбрать файл...
.head 7 -  Call SalDlgOpenFile ( hWndForm, CurrentLangTable.GetAtomTitle('STUDENTS.cTFileSelect'), strFilters, 2, nIndex, strFileIn, strPathIn )
.head 7 +  If SalStrUpperX( SalStrLeftX( strFileIn, 2 )) != 'SS'
.head 8 -  ! Неверное имя файла
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('STUDENTS.cTErrFileName'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop )
.head 7 +  Else
.head 8 -  Set dDatIn = SalDateConstruct( Val(Subs(strFileIn,7,2)) + 2000, Val(Subs(strFileIn,5,2)), Val(Subs(strFileIn,3,2)), 0, 0, 0 )
.head 8 -  Set nN_INST = Val(Subs(strFileIn,10,3))
.head 8 -  !
.head 8 -  Set sTempDbf = SalStrMidX(strPathIn, 0, SalStrLength( strPathIn )-3)||'dbf'
.head 8 -  Call VisFileCopy(strPathIn, sTempDbf)
.head 8 -  !
.head 8 -  Set SqlDatabase = 'dBase_Files'
.head 8 +  If SqlConnect(hSqlA)
.head 9 -  Call SalTblPopulate( hWndForm, hSqlA,
     "SELECT unikod, name_f, name_i, name_o, name_group, summa
     INTO :STUDENTS.cUNIKOD,:STUDENTS.cNAME_F,:STUDENTS.cNAME_I,
          :STUDENTS.cNAME_O,:STUDENTS.cNAME_GROUP,:STUDENTS.cSUMMA
     FROM " || Left(strFileIn, Len(strFileIn)-4), TBL_FillAll )
.head 9 -  Call SqlDisconnect(hSqlA)
.head 9 -  Call VisFileDelete(sTempDbf)
.head 9 -  Call SalEnableWindow( pbOut )
.head 9 -  Call SalDisableWindow( pbOutS1 )
.head 8 +  Else
.head 9 -  ! Ошибка подсоединения к Базе данных
.head 9 -  Call MessageAttention(CurrentLangTable.GetAtomTitle('STUDENTS.cTErrConnect') || ' ' ||SqlDatabase)
.head 4 +  Pushbutton: pbOut
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DOC_OUT.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Оплатить и отправить ВУЗу ведомость
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('STUDENTS.cBTipOut')
.head 6 +  On SAM_Click
.head 7 -  ! Произвести оплату и сформировать ведомость расхождений?
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('STUDENTS.cTMessOut'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion|MB_YesNo )=IDYES
.head 8 +  If F_CHECK(strFileIn)
.head 9 +  If NOT F_PAY()
.head 10 -  ! Невозможно оплатить файл <...>
.head 10 -  Call SalMessageBox (CurrentLangTable.GetAtomTitle('STUDENTS.cTErrFilePay') || ' '||strPathIn||' !',
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
.head 9 +  Else
.head 10 +  If NOT F_PRINT()
.head 11 -  ! Невозможно сформировать ведомость расхождений
.head 11 -  Call SalMessageBox (CurrentLangTable.GetAtomTitle('STUDENTS.cTErrFormVed'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
.head 10 +  Else
.head 11 +  If SqlPrepareAndExecute( hSql(), 
  "UPDATE dpt_study_files SET ref=:nREF WHERE fname_in=:strFileIn" )
.head 12 -  Call SqlCommit( hSql() )
.head 8 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 4 +  Pushbutton: pbOutS1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\DOC_DOWN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сформировать ВУЗу ведомость S1DDMMYY.INS
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('STUDENTS.cBTipOutS1')
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog( dlgStudents, STUDENTS, nN_INST )
.head 7 -  Call SalFileGetCurrentDirectory( sCurDir )
.head 7 -  Call SalTblPopulate( STUDENTS, hSqlAux2(), 
 "SELECT to_number(d.nd), 
         substr(upper(fio(c.nmk,1)),1,20), 
         substr(upper(fio(c.nmk,2)),1,20), 
         substr(upper(fio(c.nmk,3)),1,20),
         trim(df.code)||'-'||substr('000000'||ds.grp,-6,6)           
      INTO :STUDENTS.cUNIKOD,:STUDENTS.cNAME_F_Win,:STUDENTS.cNAME_I_Win,
           :STUDENTS.cNAME_O_Win,:STUDENTS.cNAME_GROUP_Win
      FROM dpt_deposit d, customer c, dpt_study ds, 
           dpt_study_inst di, dpt_study_fk df 
     WHERE d.deposit_id=ds.dpt_id AND d.rnk=c.rnk       AND 
           ds.inst=di.id_inst     AND ds.inst=:nN_INST  AND
	   di.id_inst=df.id_inst  AND df.id_fk=ds.fk 	   
     ORDER BY 5,2,3", TBL_FillAll )
.head 7 +  If nCountRows > 0
.head 8 -  ! Сформировать ведомость S1DDMMYY.INS?
.head 8 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('STUDENTS.cTMessOutS1'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion|MB_YesNo )=IDYES
.head 9 -  Set dDatOut = GetBankDate(  )
.head 9 -  Call SalFileSetCurrentDirectory( GetPrnDir(  ) )
.head 9 -  Set strFileOut ='S1'||SalFmtFormatDateTime(dDatOut,'ddMMyy')            
.head 9 -  Set strPathOutTemp =GetPrnDir(  )||'\\'||strFileOut||'.DBF'
.head 9 -  Set SqlDatabase = 'dBase_Files'
.head 9 +  If SqlConnect(hSqlA)
.head 10 -  Call VisFileDelete(strPathOutTemp)
.head 10 +  If SqlPrepareAndExecute( hSqlA,
   "CREATE TABLE "||strPathOutTemp||
   " (UNIKOD NUMBER(14), NAME_F CHAR(20), NAME_I CHAR(20), NAME_O CHAR(20), 
      NAME_GROUP CHAR(13), NFK NUMBER(6), GROUP NUMBER(6), 
      SUM_DOG NUMBER(16,2), SUM_PR NUMBER(16,2), SUM_RAS NUMBER(16,2), 
      SUM_REST NUMBER(16,2), DATE DATE) " )
.head 11 -  Set nRow = TBL_MinRow
.head 11 +  While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
.head 12 -  Call SalTblSetContext( hWndForm, nRow )
.head 12 -  If SqlPrepareAndExecute ( hSqlA,
   "INSERT INTO "||strFileOut||" 
      (unikod, name_f, name_i, name_o, name_group, nfk, group, 
       sum_dog, sum_pr, sum_ras, sum_rest, date) 
    VALUES 
      (:cUNIKOD, :cNAME_F, :cNAME_I, :cNAME_O, :cNAME_GROUP,
       :cID_FK, :cGROUP, :cSUM_DOG, :cKOS, :cDOS, :cOSTC, :dDatOut)")
.head 11 -  Call SqlCommit( hSqlA )
.head 11 -  Call SqlDisconnect(hSqlA)
.head 11 -  Set strFileOut =GetPrnDir(  )||'\\'||strFileOut||'.'||SalStrRightX( '000'||Str(nN_INST), 3 )            
.head 11 -  Call VisFileCopy(strPathOutTemp, strFileOut)
.head 11 -  Call VisFileDelete(strPathOutTemp)
.head 11 -  ! Успешно сформирован файл <...>
.head 11 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('STUDENTS.cTMessFormFileOk') || ' '||strFileOut, 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconInformation)
.head 9 -  Call SalFileSetCurrentDirectory( sCurDir )
.head 9 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 2 +  Contents
.head 3 +  Column: cID_INST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ВУЗа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cID_FK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
факульт.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.833"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cUNIKOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код вклада
UNIKOD
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cDPT_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код вклада
Барс
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Депозитный
счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cGROUP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
группы
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cSUM_DOG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNAME_F
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Фамилия
студента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNAME_I
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя
студента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNAME_O
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отчество
студента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNAME_GROUP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
группы
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNAME_F_Win
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Фамилия
студента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNAME_I_Win
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя
студента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNAME_O_Win
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отчество
студента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNAME_GROUP_Win
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № группы
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cKOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кт
обороты
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cDOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дт
обороты
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cOSTC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на вкладе
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cSUMMA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма на
списание
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cSUM2PAY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма к
оплате
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cOTM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отм
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 70
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_PAY
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSum
.head 5 -  String: sNLSA
.head 5 -  String: sNMSA
.head 5 -  String: sOKPOA
.head 5 -  String: sMFOB
.head 5 -  String: sNLSB
.head 5 -  String: sNMSB
.head 5 -  String: sOKPOB
.head 5 -  String: sNLS8
.head 5 -  Number: n980
.head 5 -  Number: nVOB
.head 5 -  String: sTT
.head 5 -  Date/Time: dBD
.head 5 -  Date/Time: dSD
.head 5 -  String: sNAZN
.head 4 +  Actions
.head 5 -  Set nSum = 0
.head 5 -  Set n980 = GetBaseVal(  )
.head 5 -  Set dBD  = GetBankDate(  )
.head 5 -  Set dSD  = SalDateCurrent(  )
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( hWndForm, nRow )
.head 6 -  Set nSum = nSum + IifN( cOTM = 1, cSUM2PAY*100, 0 )
.head 5 -  !
.head 5 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT a.nls, substr(a.nms,1,38), cb.okpo, 
	   di.mfo, di.nls, substr(c.nmk,1,38), c.okpo, b.nls 
      INTO :sNLSA,:sNMSA,:sOKPOA,:sMFOB,:sNLSB,:sNMSB,:sOKPOB, :sNLS8
      FROM dpt_study_inst di, accounts b, 
           accounts a, customer c, cust_acc cu, customer cb
     WHERE di.accc_d=a.acc AND di.rnk=c.rnk  AND
           a.acc=cu.acc    AND cu.rnk=cb.rnk AND
           b.acc=di.accc_8 AND di.id_inst=:nN_INST" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Return FALSE
.head 5 -  Set nVOB = 6
.head 5 -  Set sTT  = IifS( sMFOB = GetBankMfo(  ), 'DC3', 'DC2' )
.head 5 -  ! Перерахування плати за навчання згідно відомості
.head 5 -  Set sNAZN = CurrentLangTable.GetAtomTitle('STUDENTS.cTNAZN')
.head 5 +  If nSum > 0
.head 6 -  Call cDoc2.SetDoc
(NUMBER_Null, sTT, 1, nVOB, STRING_Null, 
 dSD, dSD, dBD, dBD,
 sNLSA, sNMSA, GetBankMfo(), '', n980, nSum, sOKPOA,
 sNLSB, sNMSB,        sMFOB, '', n980, nSum, sOKPOB,
 sNAZN, '', GetIdOper(), '', NUMBER_Null, 0)
.head 6 +  If cDoc2.oDoc()
.head 7 -  Set nREF = cDoc2.m_nRef
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
.head 8 -  Call SalTblSetContext( hWndForm, nRow )
.head 8 +  If cOTM = 1
.head 9 +  If NOT cDoc2.PayTT(0, nREF, dBD, 'DC3', 1, n980, cNLS, cSUM2PAY*100, n980, sNLS8, cSUM2PAY*100 )  
.head 10 -  Return FALSE
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 -  ! Документу присвоен РЕФ=<...>
.head 5 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('STUDENTS.cTMessDocRef') || '='||SalNumberToStrX( nREF, 0 )||' !',
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconInformation)
.head 5 -  Return TRUE
.head 3 +  Function: F_PRINT
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sPath
.head 5 -  File Handle: hFile
.head 5 -  Date/Time: dBD
.head 5 -  Boolean: bTitul
.head 5 -  Number: nRow
.head 5 -  Number: nDelta
.head 5 -  String: sNAME
.head 5 -  Number: nLength
.head 5 -  Number: nCount
.head 5 -  Number: nSum1
.head 5 -  Number: nSum2
.head 5 -  Number: nSum3
.head 5 -  String: sBoss
.head 5 -  String: sBuh
.head 4 +  Actions
.head 5 -  Set dBD = GetBankDate(  )
.head 5 -  Set sPath =GetPrnDir(  )|| '\\'||'SR'||SalFmtFormatDateTime(dBD,'ddMMyy')||'.TXT'            
.head 5 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT c.nmk, length(c.nmk) INTO :sNAME, :nLength FROM customer c, dpt_study_inst d
     WHERE c.rnk=d.rnk AND d.id_inst=:nN_INST" )
.head 6 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set sBoss = GetGlobalOption( 'BOSS' )
.head 5 -  Set sBuh  = GetGlobalOption( 'ACCMAN' )
.head 5 -  Set bTitul = FALSE
.head 5 -  Set nCount = 0
.head 5 -  Set nSum1 = 0
.head 5 -  Set nSum2 = 0
.head 5 -  Set nSum3 = 0
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( hWndForm, nRow )
.head 6 -  Set nDelta = cSUMMA - cSUM2PAY
.head 6 +  If nDelta > 0
.head 7 +  If NOT bTitul
.head 8 +  If not SalFileOpen( hFile, sPath, OF_Create | OF_ReadWrite )
.head 9 -  Call SalMessageBox('Ошибка при создании файла '||sPath||' !', 'Ошибка', MB_IconStop )
.head 9 -  Return FALSE
.head 8 -  Set bTitul = TRUE
.head 8 -  Call SalFilePutStr( hFile, Spac(5)||PadR(GetBankName(  ),55)||Spac(11)||PadL(sNAME,50))
.head 8 -  Call SalFilePutStr( hFile, Spac(5)||SalFmtFormatDateTime(dBD,'dd/MM/yyyy')|| Spac(111))
.head 8 -  Call SalFilePutStr( hFile, '' )
.head 8 -  Call SalFilePutStr( hFile, Spac(55)||'В І Д О М І С Т Ь'||Spac(54)||PutCrLf(  )||
                           Spac(30)||'різниці фактично списаних сум з сумами поданими на списання в листі'||Spac(29)||PutCrLf(  )||
                           Spac(62-nLength/2)||sNAME||Spac(62+nLength/2))
.head 8 -  Call SalFilePutStr( hFile, 
                    '+----------+-------------+--------------------------------------------------+'||
                    '----------------+----------------+----------------+'||PutCrLf(  )||
                    '|  № о/р   |    Група    |          Прізвище, імя, по-батькові              |'||
                    ' Сума зг.списку |Фактично списано|  Сума різниці  |'||PutCrLf(  )||
                    '+----------+-------------+--------------------------------------------------+'||
                    '----------------+----------------+----------------+')
.head 7 -  Set nSum1 = nSum1 + cSUMMA
.head 7 -  Set nSum2 = nSum2 + cSUM2PAY
.head 7 -  Set nSum3 = nSum3 + nDelta
.head 7 -  Set nCount = nCount + 1
.head 7 -  Call SalFilePutStr( hFile, 
                    '|'||
                    PadL(Str(cUNIKOD),10)||'|'|| 
                    PadL(cNAME_GROUP_Win,13)||'|'||
                    PadR(cNMK,50)||'|'||
                    PadL(SalNumberToStrX(cSUMMA,2),16) ||'|'||
                    PadL(SalNumberToStrX(cSUM2PAY,2),16) ||'|'||
                    PadL(SalNumberToStrX(nDelta,2),16)||'|')
.head 5 +  If bTitul = TRUE
.head 6 -  Call SalFilePutStr( hFile, 
                    '+----------+-------------+--------------------------------------------------+'||
                    '----------------+----------------+----------------+')
.head 6 -  Call SalFilePutStr( hFile, 
                    ' ВСЬОГО:   '||Spac(66)||
                    PadL(SalNumberToStrX(nSum1,2),16)||Spac(1)||
                    PadL(SalNumberToStrX(nSum2,2),16)||Spac(1)||
                    PadL(SalNumberToStrX(nSum3,2),16)||Spac(1))
.head 6 -  Call SalFilePutStr( hFile, '' )
.head 6 -  Call SalFilePutStr( hFile, '' )
.head 6 -  Call SalFilePutStr( hFile, Spac(15)||' Голова правління   '||Spac(40)||PadR(sBoss,50))
.head 6 -  Call SalFilePutStr( hFile, '' )
.head 6 -  Call SalFilePutStr( hFile, Spac(15)||' Головний бухгалтер '||Spac(40)||PadR(sBuh,50))
.head 6 -  Call SalFileClose( hFile )
.head 6 -  ! Ведомость расхождений успешно сформирована в файл <...>
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('STUDENTS.cTMessF_PRINTOk') || ' '||sPath||' !', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconInformation)
.head 5 +  Else
.head 6 -  ! Расхождения отсутствуют!
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('STUDENTS.cTMessF_PRINTNotDelta'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconInformation)
.head 5 -  Return TRUE
.head 3 +  Function: F_CHECK
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sFileNameIn
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRef
.head 5 -  Number: nSos
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT o.sos INTO :nSos FROM dpt_study_files d, oper o 
   WHERE o.ref=d.ref AND d.fname_in=:sFileNameIn") 
AND NOT SqlFetchNext( hSql(), nFetchRes ) 
.head 6 +  If SqlPrepareAndExecute(hSql(), 
   "DELETE FROM dpt_study_files WHERE fname_in=:sFileNameIn")
AND SqlPrepareAndExecute(hSql(), 
   "INSERT INTO dpt_study_files(dat,fname_in) VALUES (sysdate,:sFileNameIn)")
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  ! Невозможно обработать файл <...>
.head 7 -  Call SalMessageBox (CurrentLangTable.GetAtomTitle('STUDENTS.cTErrFileSave') || ' '||strPathIn||' !',
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
.head 5 +  Else
.head 6 +  If nSos < 0
.head 7 -  ! Сформировать повторно платежи по файлу <...> ?
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('STUDENTS.cTMessPay') ||  ' '||sFileNameIn||'?', 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion|MB_YesNo )=IDYES
.head 8 +  If SqlPrepareAndExecute(hSql(), 
   "DELETE FROM dpt_study_files WHERE fname_in=:sFileNameIn")
AND SqlPrepareAndExecute(hSql(), 
   "INSERT INTO dpt_study_files(dat,fname_in) VALUES (sysdate,:sFileNameIn)")
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  ! Невозможно обработать файл <...>
.head 9 -  Call SalMessageBox (CurrentLangTable.GetAtomTitle('STUDENTS.cTErrFileSave') || ' '||strPathIn||' !',
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
.head 6 +  Else
.head 7 -  ! По файлу <...> были сформированы платежи
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('STUDENTS.cTErrFileSos') || ' '||sFileNameIn||' ' || 
     CurrentLangTable.GetAtomTitle('STUDENTS.cTErrFileSos_'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop )
.head 5 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: sPar01
.head 3 -  String: sPar02
.head 2 +  Window Variables
.head 3 -  Number: nVIDD
.head 3 -  String: sVIDD
.head 3 -  Number: nFetchRes
.head 3 -  Number: nFlags
.head 3 -  String: sCurDir
.head 3 -  Number: nCountRows
.head 3 -  !
.head 3 -  String: strFilters[*]
.head 3 -  Number: nIndex
.head 3 -  !
.head 3 -  Number: nN_INST
.head 3 -  Date/Time: dDatIn
.head 3 -  String: strFileIn
.head 3 -  String: strPathIn
.head 3 -  String: sTempDbf
.head 3 -  Sql Handle: hSqlA
.head 3 -  !
.head 3 -  Date/Time: dDatOut
.head 3 -  String: strFileOut
.head 3 -  String: strPathOut
.head 3 -  String: strPathOutTemp
.head 3 -  !
.head 3 -  File Handle: hFile
.head 3 -  Number: nRow
.head 3 -  !
.head 3 -  String: sDrive
.head 3 -  String: sDir
.head 3 -  String: sFile
.head 3 -  String: sExt
.head 3 -  !
.head 3 -  : cDoc2
.head 4 -  Class: cDoc
.head 3 -  Number: nREF
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('STUDENTS.cTWndTitle'))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Set nCountRows = 0
.head 4 -  Set STUDENTS.nFlags = GT_NoDel|GT_NoIns|GT_NoUpd
.head 4 -  Set nVIDD = Val(GetGlobalOption('DPT_STUD'))
.head 4 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT type_name INTO :sVIDD FROM dpt_vidd WHERE vidd=:nVIDD" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Call SalMessageBox( 'Не описан вид вклада Студенческий!', 'Внимание', MB_IconStop )
.head 4 -  Set STUDENTS.strPrintFileName = 'STUDENTS'
.head 4 -  Set STUDENTS.nTabInstance = 1
.head 4 -  Set STUDENTS.strFilterTblName = 'DPT_STUDY'
.head 4 -  !
.head 4 -  Call SalDisableWindow( pbIns )
.head 4 -  Call SalDisableWindow( pbDel )
.head 4 -  Call SalDisableWindow( pbUpdate )
.head 4 -  Call SalDisableWindow( pbFilter )
.head 4 -  !
.head 4 -  Call SalDisableWindow( pbOut )
.head 4 -  !
.head 4 -  ! Список файлов от ВУЗов (SSDDMMYY.*)
.head 4 -  Set strFilters[0]=CurrentLangTable.GetAtomTitle('STUDENTS.cTFileList')
.head 4 -  Set strFilters[1]='*.*'
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If SalIsNull( cNAME_F_Win )
.head 5 -  Set cNAME_F_Win = SalStrUpperX(StrDosToWinX (cNAME_F))
.head 4 +  If SalIsNull( cNAME_I_Win )
.head 5 -  Set cNAME_I_Win = SalStrUpperX(StrDosToWinX (cNAME_I))
.head 4 +  If SalIsNull( cNAME_O_Win )
.head 5 -  Set cNAME_O_Win = SalStrUpperX(StrDosToWinX (cNAME_O))
.head 4 +  If SalIsNull( cNAME_GROUP_Win )
.head 5 -  Set cNAME_GROUP_Win = StrDosToWinX (cNAME_GROUP)
.head 4 -  !
.head 4 +  If SalIsNull( cNAME_F )
.head 5 -  Set cNAME_F = StrWinToDosX (cNAME_F_Win)
.head 4 +  If SalIsNull( cNAME_I )
.head 5 -  Set cNAME_I = StrWinToDosX (cNAME_I_Win)
.head 4 +  If SalIsNull( cNAME_O )
.head 5 -  Set cNAME_O = StrWinToDosX (cNAME_O_Win)
.head 4 +  If SalIsNull( cNAME_GROUP )
.head 5 -  Set cNAME_GROUP = StrWinToDosX (cNAME_GROUP_Win)
.head 4 -  Set cNMK = Subs(SalStrTrimX(cNAME_F_Win)||' '||SalStrTrimX(cNAME_I_Win)||' '||SalStrTrimX(cNAME_O_Win),1,50)
.head 4 -  !
.head 4 -  Set cID_INST = nN_INST
.head 4 -  Set nCountRows = nCountRows + 1
.head 4 -  Set cOTM = 1
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT s.dpt_id, s.fk, s.grp, s.sum_dog/100, a.nls, a.ostc/100,
          fdos(a.acc,a.daos,bankdate)/100,fkos(a.acc,a.daos,bankdate)/100 
     INTO :cDPT_ID, :cID_FK, :cGROUP, :cSUM_DOG, :cNLS, :cOSTC, :cDOS, :cKOS
   FROM dpt_study s, dpt_deposit d, accounts a
   WHERE d.acc=a.acc AND d.deposit_id=s.dpt_id AND
         s.inst=:cID_INST AND s.unikod=:cUNIKOD" )
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 4 +  If cOSTC < cSUMMA
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightPeriwinkle )
.head 4 -  Set cSUM2PAY = IifN( cOSTC < cSUMMA, cOSTC, cSUMMA )
.head 1 +  Dialog Box: dlgFields
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Дополнительные реквизиты вклада
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.95"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 3.798"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Дополнительные реквизиты вклада
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( dlgFields.tbl, nRow, ROW_Edited, 0 )
.head 8 -  Call SalTblSetContext( dlgFields.tbl, nRow )
.head 8 +  If dlgFields.tbl.nOBZ = 1 AND dlgFields.tbl.sVALUE = STRING_Null
.head 9 -  ! Не заполнен обязательный реквизит <sTAG>
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgFields.cTMessDR') ||  ' '|| dlgFields.tbl.sTAG||'!', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop ) 
.head 8 +  Else
.head 9 +  If SqlPrepareAndExecute( hSql(), 
   "BEGIN
      UPDATE dpt_depositw SET 
             value='"||dlgFields.tbl.sVALUE||"'
      WHERE dpt_id="||Str(nDpt)||" AND tag='"||dlgFields.tbl.sTAG||"';
      IF SQL%ROWCOUNT = 0 THEN
         INSERT INTO dpt_depositw (dpt_id, tag, value)
         VALUES ("||Str(nDpt)||",'"||dlgFields.tbl.sTAG||"','"||dlgFields.tbl.sVALUE||"');
      END IF;          
    END; " )
.head 10 -  ! Изменен доп.реквизит для вклада № <...>
.head 10 -  Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('dlgFields.cTUpdateDR')||Str(nDpt) )
.head 9 +  Else
.head 10 -  Call SqlRollback( hSql() )
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 4 -  Line
.head 5 -  Resource Id: 52063
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 52064
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сохранить данные и выйти
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('dlgFields.cBTipOk')
.head 6 +  On SAM_Click
.head 7 -  Set i = 0
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( dlgFields.tbl, nRow, 0, 0 )
.head 8 -  Call SalTblSetContext( dlgFields.tbl, nRow )
.head 8 +  If dlgFields.tbl.nOBZ = 1 AND dlgFields.tbl.sVALUE = STRING_Null
.head 9 -  ! Не заполнен обязательный реквизит <sTAG>
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgFields.cTMessDR') ||  ' '|| dlgFields.tbl.sTAG||'!', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop ) 
.head 9 -  Return FALSE
.head 8 -  Set sTagVal[i,0] = dlgFields.tbl.sTAG
.head 8 -  Set sTagVal[i,1] = dlgFields.tbl.sVALUE
.head 8 -  Set i = i + 1
.head 7 -  Set bOk = TRUE
.head 7 -  Call SalEndDialog( dlgFields, TRUE )
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If nDpt = 0
.head 8 -  ! Выйти без сохранения
.head 8 -  Set strTip = CurrentLangTable.GetAtomTitle('dlgFields.cBTipExit1')
.head 7 +  Else
.head 8 -  ! Завершить работу
.head 8 -  Set strTip = CurrentLangTable.GetAtomTitle('dlgFields.cBTipExit2')
.head 6 +  On SAM_Click
.head 7 +  If nDpt = 0
.head 8 -  ! Выйти без сохранения? Изменения будут утеряны!
.head 8 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('dlgFields.cTMessExit'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion|MB_YesNo ) =IDYES
.head 9 -  Set bOk = FALSE
.head 9 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 7 +  Else
.head 8 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 4 -  Line
.head 5 -  Resource Id: 52065
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: sTAG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реквизит
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 5
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: sNAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: nOBZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ОБЗ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: sVALUE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 500
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  4.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 +  If nDpt = 0 
.head 7 -  Set dlgFields.strSqlPopulate = 
    "SELECT f.tag, f.name, v.obz
       INTO :dlgFields.tbl.sTAG,
            :dlgFields.tbl.sNAME,
            :dlgFields.tbl.nOBZ 
       FROM dpt_field f, dpt_vidd_field v
      WHERE f.tag = v.tag AND v.vidd = :dlgFields.nVid
      ORDER BY 1 "
.head 6 +  Else
.head 7 -  Set dlgFields.strSqlPopulate = 
    "SELECT b.tag, f.name, b.obz, substr(w.value,1,500)
       INTO :dlgFields.tbl.sTAG,
            :dlgFields.tbl.sNAME,
            :dlgFields.tbl.nOBZ,
            :dlgFields.tbl.sVALUE  
       FROM 
           (SELECT f.tag, nvl(f.obz,0) OBZ
              FROM
                 (SELECT tag FROM dpt_depositw WHERE dpt_id=:dlgFields.nDpt) a, 
	          dpt_vidd_field f
             WHERE a.tag(+)=f.tag AND f.vidd=:dlgFields.nVid) b, 
	    dpt_depositw w, 
            dpt_field f 
      WHERE b.tag=w.tag(+) AND w.dpt_id(+)=:dlgFields.nDpt AND f.tag=b.tag
      ORDER BY 1 "
.head 5 +  On UM_Populate
.head 6 +  If nDpt = 0
.head 7 -  Call SalTblPopulate( hWndForm, cMain.hSql(), dlgFields.strSqlPopulate, TBL_FillAll )
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( dlgFields.tbl, nRow, 0, 0 )
.head 8 -  Call SalTblSetContext( dlgFields.tbl, nRow )
.head 8 -  Set i = 0 
.head 8 +  While i <= nCnt
.head 9 +  If sTagVal[i,0] = dlgFields.tbl.sTAG
.head 10 -  Set dlgFields.tbl.sVALUE = sTagVal[i,1] 
.head 10 -  Break
.head 9 -  Set i = i + 1
.head 6 +  Else
.head 7 -  Call SqlSetLongBindDatatype( 4, 22 )
.head 7 -  Call SalTblPopulate( hWndForm, cMain.hSql(), dlgFields.strSqlPopulate, TBL_FillAll )
.head 7 -  Call SalTblSetContext( hWndForm, 0 )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nVid
.head 3 -  Number: nDpt
.head 3 -  Number: nCnt
.head 3 -  Receive String: sTagVal[*,2]
.head 3 -  Receive Boolean: bOk
.head 2 +  Window Variables
.head 3 -  Number: i
.head 3 -  Number: nRow
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgFields.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 +  If nDpt = 0
.head 5 -  Set nFlags = GT_ReadOnly
.head 4 +  Else
.head 5 -  Set nFlags = GT_NoDel|GT_NoIns|GT_NoRet
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 1 +  Form Window: frm_New
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Открыть новый вклад
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? No
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.41"
.head 4 -  Top:    0.3"
.head 4 -  Width:  9.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.964"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.952"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbClear
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Очистить карточку открытия вклада
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_New.cBTipClear')
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor( TRUE )
.head 7 -  Call F_CLEAR()
.head 7 -  Call SalWaitCursor( FALSE )
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Открыть новый вклад (F10)
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_New.cBTipSave')
.head 6 +  On SAM_Click
.head 7 +  If not (dfVIDD = NUMBER_Null    OR
           nKV = NUMBER_Null    OR 
          nISP = NUMBER_Null    OR 
         dfSUM = NUMBER_Null    OR 
      dpt_open = DATETIME_Null  OR 
       bFilled = FALSE)
.head 8 -  Set nID = F_SAVE()
.head 8 +  If nID >0
.head 9 -  Call SqlCommit(hSql())
.head 9 -  ! Открытие вклада = <...>
.head 9 -  Call MessageNoWait(CurrentLangTable.GetAtomTitle('frm_New.cTMessOpenVklad') || ' =' ||Str(nID), 
     CurrentLangTable.GetAtomTitle('cTMessage'), 3, 0)
.head 9 -  Call SalDisableWindow( cmb_Vidd )
.head 9 -  Call SalDisableWindow( sND )
.head 9 -  Call SalDisableWindow( dfSUM )
.head 9 -  Call SalDisableWindow( dpt_datz )
.head 9 -  Call SalDisableWindow( dpt_open )
.head 9 -  Call SalDisableWindow( dpt_close)
.head 9 -  Call SalDisableWindow( pbClear )
.head 9 -  Call SalDisableWindow( NLS )
.head 9 -  Call SalDisableWindow( nISP )
.head 9 -  Call SalDisableWindow( NLSN )
.head 9 -  Call SalDisableWindow( pbSave )
.head 9 -  Call SalDisableWindow( cmb_ISP )
.head 9 -  Call SalDisableWindow( dfVIDD )
.head 9 -  Call SalDisableWindow( MFO_P )
.head 9 -  Call SalDisableWindow( NLS_P )
.head 9 -  Call SalDisableWindow( NAME_P )
.head 9 -  Call SalDisableWindow( OKPO_P )
.head 9 +  If FL_AUTO_ADD >0 
.head 10 -  Call SalShowWindow(pb_AUTO_ADD )
.head 9 +  Else
.head 10 -  Call SalHideWindow(pb_AUTO_ADD )
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  ! Ош.при Открытии вклада <...>
.head 9 -  Call MessageNoWait(CurrentLangTable.GetAtomTitle('frm_New.cTErrOpenVklad') || " "|| sEr, 
     CurrentLangTable.GetAtomTitle('cTErr'), 0, 1)
.head 8 -  Call SalSendMsg(frm_Kontr.Poisk, SAM_Click, wParam, lParam)
.head 7 +  Else
.head 8 +  If (nKV=NUMBER_Null)
.head 9 -  ! Не выбрана валюта
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrKV'),
     CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 8 +  Else If (dfVIDD=NUMBER_Null)
.head 9 -  ! Не выбран вид вклада
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrVIDD'),
     CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 8 +  Else If (nISP=NUMBER_Null)
.head 9 -  ! Не выбран исполнитель
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrISP'),
     CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 8 +  Else If (dfSUM=NUMBER_Null)
.head 9 -  ! Не указана сумма вклада
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrSUM'),
     CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 8 +  Else If (bFilled = FALSE)
.head 9 -  ! Не заполнены обязательные доп.реквизиты
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrFilled'),
     CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 8 +  Else
.head 9 -  ! Не указана дата открытия вклада
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrDptOpen'),
     CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 4 +  Pushbutton: pbIndiVidd
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\ACCOUNTS.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Задать условия индивидуального вклада
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_New.cBTipIndiVidd')
.head 6 +  On SAM_Click
.head 7 -  Call SalMessageBox('Данная опция отключена!', 'Внимание', MB_IconInformation)
.head 7 +  ! If nISP=NUMBER_Null
.head 8 -  ! Call SalMessageBox( 'Выберите ответ.исполнителя!', 'Внимание', MB_IconExclamation|MB_OK )
.head 8 -    Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTMessISP'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation|MB_OK )
.head 7 +  ! Else If dfVIDD=NUMBER_Null
.head 8 -  ! Call SalMessageBox( 'Задайте вид и срок вклада!', 'Внимание', MB_IconExclamation|MB_OK )
.head 8 -    Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTMessVIDD'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation|MB_OK )
.head 7 +  ! Else If nRNK=NUMBER_Null
.head 8 -  ! Call SalMessageBox( 'Выберите клиента!', 'Внимание', MB_IconExclamation|MB_OK )
.head 8 -    Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTMessRNK'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation|MB_OK )
.head 7 +  ! Else
.head 8 -    Call SalCreateWindow(frm_IndiVidd,hWndMDI,dfVIDD,dpt_durat_m,dpt_durat_d,nRNK,dpt_datz,dpt_close,nGrp,nISP,TT3,TT4,comment,NLS_Perekr,NAME_Perekr)
.head 4 +  Pushbutton: pb_AUTO_ADD
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Параметри Авто-поповнення вкладу"
.head 6 +  On SAM_Click
.head 7 -  Call Sel002(hWndMDI,16, nID, "","" )
.head 4 -  Line
.head 5 -  Resource Id: 40086
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.683"
.head 6 -  Begin Y:  0.071"
.head 6 -  End X:  2.683"
.head 6 -  End Y:  0.321"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbField
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SMTHING.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Заполнить доп.реквизиты вклада
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_New.cBTipField')
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog( dlgFields, hWndMDI, dfVIDD, 0, nCnt, sTagVal, bFilled )
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Завершить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_New.cBTipCancel')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  !
.head 4 +  Data Field: nRNK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    0.571"
.head 7 -  Width:  0.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: MS Sans Serif
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: None
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Рег.№ клиента
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipRNK'))
.head 4 +  Data Field: sNMK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.983"
.head 7 -  Top:    0.571"
.head 7 -  Width:  3.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: MS Sans Serif
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: None
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 -  Background Text: Номер вклада
.head 5 -  Resource Id: 48949
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.783"
.head 6 -  Top:    3.345"
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgID
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: nID
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.283"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.229"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Основной. счет: 
.head 5 -  Resource Id: 48947
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.0"
.head 6 -  Top:    0.095"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgNLS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: NLS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.25"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: MS Sans Serif
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: None
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Счет начисл. %%: 
.head 5 -  Resource Id: 48948
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.0"
.head 6 -  Top:    0.345"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgNLSN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: NLSN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.25"
.head 7 -  Top:    0.32"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: MS Sans Serif
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: None
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Счет амортизации: 
.head 5 -  Resource Id: 20205
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.0"
.head 6 -  Top:    0.595"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgNLSA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: NLSA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.25"
.head 7 -  Top:    0.571"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: MS Sans Serif
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: None
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 -  Background Text: Вид вклада:
.head 4 -  Resource Id: 41618
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.131"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    0.105"
.head 6 -  Width:  0.65"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код вида вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipVIDD'))
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( dfVIDD )
.head 7 -  Call SalListSetSelect( cmb_Vidd, -1 )
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmb_Vidd.SetSelectById( dfVIDD )
.head 6 +  If cmb_Vidd.nCurrentId
.head 7 -  Call SalSendMsg( cmb_Vidd, SAM_Click, 0, 0 )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  ! Нет такого вида вклада
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrNotVIDD'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Combo Box: cmb_Vidd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.5"
.head 5 -  Top:    0.105"
.head 5 -  Width:  4.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Вид договора
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipCmbVidd'))
.head 5 +  On SAM_Create
.head 6 +  If cmb_Vidd.Init( hWndItem )
.head 7 -  Call cmb_Vidd.Populate( hSql(), "VIDD", "TYPE_NAME", "V_DPT_VIDD_USER", " ORDER BY 1" )
.head 7 -  Call cmb_Vidd.SetSelectById( dfVIDD )
.head 7 -  Set dfVIDD = cmb_Vidd.GetKey( SalListQuerySelection(cmb_Vidd) )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 -  Set dfVIDD=cmb_Vidd.GetCurrentKey(  )
.head 6 +  If dfVIDD != NUMBER_Null
.head 7 +  If SqlPrepareAndExecute( hSql(),
   "SELECT v.duration, v.duration_days, nvl(v.min_summ,0), 
           v.kv, t.lcv||' '||t.name, v.br_id, 
           v.comproc, v.term_type, nvl(v.fl_2620,0), t.dig, 
           Nvl(v.AUTO_ADD,0) 
      INTO :dpt_durat_m,:dpt_durat_d,:min_summ,
           :nKV,:NAME_KV,:nBR_ID,:nComProc,
           :nFixDurat, :nFl2620, :nDig, :FL_AUTO_ADD 
    FROM dpt_vidd v, tabval t 
    WHERE v.kv=t.kv AND v.vidd="||Str(dfVIDD))
.head 8 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 8 +  If nDig
.head 9 -  Call SalFmtSetPicture(dfSUM, '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
.head 9 -  Call F_DecPoint(dfSUM)
.head 9 -  Call SalFmtSetPicture(min_summ, '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
.head 9 -  Call F_DecPoint(min_summ)
.head 8 -  ! Признак "Индивидуального" вклада (Петрокоммерцбанк)
.head 8 +  When SqlError
.head 9 -  ! Получаем код ошибки
.head 9 -  Call SqlExtractArgs (wParam, lParam, hSqlError, nErrorNum, nPos)
.head 9 -  ! Получаем текст ошибки
.head 9 -  Call SqlGetErrorText ( nErrorNum, strErrorText)
.head 9 -  ! 00942 - table or view does not exist
.head 9 +  If SalStrScan(SalStrUpperX(strErrorText), '00942') != -1
.head 10 -  Return 0
.head 8 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT count(*) INTO :nInd FROM dpt_individd where vidd = :dfVIDD")
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set nInd = 0
.head 8 +  If nInd = 0
.head 9 -  Call SalDisableWindow( pbIndiVidd )
.head 8 +  Else
.head 9 -  Call SalEnableWindow( pbIndiVidd )
.head 8 -  !
.head 8 +  If nFixDurat != 1
.head 9 -  Call SalEnableWindow( dpt_durat_m )
.head 9 -  Call SalEnableWindow( dpt_durat_d )
.head 8 +  Else
.head 9 -  Call SalDisableWindow( dpt_durat_m )
.head 9 -  Call SalDisableWindow( dpt_durat_d )
.head 8 -  Set dpt_close=DptGetDateClose(dpt_open, dpt_durat_m, dpt_durat_d)
.head 8 -  !
.head 8 +  If nComProc = 1  
.head 9 -  Set cb_Kapital = 1
.head 9 -  Call SalDisableWindow( cb_Kapital )
.head 9 -  Call SalDisableWindow( MFO_P )
.head 9 -  Call SalDisableWindow( NLS_P )
.head 9 -  Call SalDisableWindow( NAME_P  )
.head 9 -  Call SalDisableWindow( OKPO_P )
.head 9 -  Call SalDisableWindow( pbFindAcc )
.head 8 +  Else
.head 9 -  Set cb_Kapital = 0
.head 9 -  Call SalDisableWindow( cb_Kapital )
.head 9 -  Call SalEnableWindow( MFO_P )
.head 9 -  Call SalEnableWindow( NLS_P )
.head 9 -  Call SalEnableWindow( NAME_P  )
.head 9 -  Call SalEnableWindow( OKPO_P  )
.head 9 -  Call SalEnableWindow( pbFindAcc )
.head 8 -  !
.head 8 +  If nFl2620 = 1
.head 9 -  Set cb_Fl2620 = 1
.head 9 -  Call SalDisableWindow( NLS_Perekr )
.head 9 -  Call SalEnableWindow( cb_Fl2620 )
.head 8 +  Else
.head 9 -  Set cb_Fl2620 = 0
.head 9 -  Call SalEnableWindow( NLS_Perekr )
.head 9 -  Call SalDisableWindow( cb_Fl2620 )
.head 8 -  !
.head 8 +  If SqlPrepareAndExecute(hSql(),
   "SELECT max(BDATE) INTO :DAT_BRAT FROM br_normal 
    WHERE BDATE<=BANKDATE AND kv=:nKV AND BR_ID=:nBR_ID")
.head 9 -  Call SqlFetchNext( hSql(), nFetchRes)
.head 8 +  If SqlPrepareAndExecute(hSql(),
   "SELECT RATE INTO :nPROC FROM br_normal 
    WHERE kv=:nKV AND BR_ID=:nBR_ID AND BDATE=:DAT_BRAT")
.head 9 -  Call SqlFetchNext( hSql(), nFetchRes)
.head 8 -  ! Доп.реквизиты вклада
.head 8 -  Set i = 0
.head 8 -  Set bFilled = TRUE
.head 8 +  If SqlPrepareAndExecute(hSql(),
   "SELECT tag, nvl(obz,0) INTO :sTags, :nTmp
      FROM dpt_vidd_field 
     WHERE vidd = :dfVIDD")
.head 9 +  While SqlFetchNext( hSql(), nFetchRes )
.head 10 -  Set sTagVal[i,0] = sTags
.head 10 -  Set i = i + 1
.head 10 +  If nTmp = 1
.head 11 -  Set bFilled = FALSE
.head 9 +  If i = 0 
.head 10 -  Call SalDisableWindow( pbField )
.head 10 -  Set bFilled = TRUE
.head 9 +  Else
.head 10 -  Call SalEnableWindow( pbField )
.head 9 -  Set nCnt = i
.head 6 -  Set nPROC_Real = F_CALC_RATE (dfVIDD, dpt_durat_m, dpt_durat_d, dfSUM, nPROC) 
.head 3 -  !
.head 3 -  Background Text: Параметры вклада
.head 4 -  Resource Id: 2169
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.4"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: gboxParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Валюта:
.head 4 -  Resource Id: 41609
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.69"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: NAME_KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    0.65"
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Валюта договора
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipNAME_KV'))
.head 3 -  Background Text: Мин.сумма:
.head 4 -  Resource Id: 41608
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.94"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMinSumm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: min_summ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    0.9"
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Минимальная сумма взноса
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipMinsumm'))
.head 3 -  Background Text: Длит-ть:
.head 4 -  Resource Id: 58393
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.19"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDurat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dpt_durat_m
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    1.15"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Срок договора в месяцах
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipDurat_m'))
.head 5 +  On SAM_Validate
.head 6 +  If dpt_durat_m < 0 AND dpt_durat_m!=NUMBER_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set dpt_close=DptGetDateClose(dpt_open, dpt_durat_m, dpt_durat_d)
.head 7 -  Set nPROC_Real = F_CALC_RATE (dfVIDD, dpt_durat_m, dpt_durat_d, dfSUM, nPROC) 
.head 7 -  Return VALIDATE_Ok
.head 3 -  Background Text: + 
.head 4 -  Resource Id: 41615
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.9"
.head 5 -  Top:    1.179"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dpt_durat_d
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.5"
.head 6 -  Top:    1.155"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Срок договора в днях
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipDurat_d'))
.head 5 +  On SAM_Validate
.head 6 +  If dpt_durat_d < 0 AND dpt_durat_d!=NUMBER_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set dpt_close=DptGetDateClose(dpt_open, dpt_durat_m, dpt_durat_d)
.head 7 -  Set nPROC_Real = F_CALC_RATE (dfVIDD, dpt_durat_m, dpt_durat_d, dfSUM, nPROC) 
.head 7 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Даты договора
.head 4 -  Resource Id: 2170
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.7"
.head 5 -  Top:    0.405"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: gboxDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: name_early_end
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.633"
.head 6 -  Top:    0.679"
.head 6 -  Width:  3.083"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dpt_early_end
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.7"
.head 6 -  Top:    0.655"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: White
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dpt_early_end <= dpt_open
.head 7 -  ! Указанная дата досрочного расторжения меньше даты открытия вклада
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrEarlyEnd'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата досрочного расторжения договора
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipEarlyEnd'))
.head 3 -  Background Text: заключения
.head 4 -  Resource Id: 52763
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.65"
.head 5 -  Top:    0.929"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDatz
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dpt_datz
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    1.155"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: White
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dpt_datz=SalDateCurrent ( )
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата заключения договора
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipDatz'))
.head 3 -  Background Text: начала
.head 4 -  Resource Id: 60972
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.2"
.head 5 -  Top:    0.929"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOpen
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dpt_open
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.2"
.head 6 -  Top:    1.155"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: White
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dpt_open = GetBankDate()
.head 5 +  On SAM_Validate
.head 6 -  Set dpt_close = DptGetDateClose(dpt_open, dpt_durat_m, dpt_durat_d)
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата открытия договора
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipOpen'))
.head 3 -  Background Text: окончания
.head 4 -  Resource Id: 60973
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.7"
.head 5 -  Top:    0.929"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgClose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dpt_close
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.7"
.head 6 -  Top:    1.155"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Validate
.head 6 +    If dpt_open >= dpt_close
.head 7 -    Return VALIDATE_Cancel
.head 6 -    Return VALIDATE_Ok
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата завершения договора
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipClose'))
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 41614
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.595"
.head 5 -  Width:  4.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Договор №:
.head 4 -  Resource Id: 41616
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.702"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: sND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    1.7"
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 41613
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.095"
.head 5 -  Width:  4.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Сумма:
.head 4 -  Resource Id: 41617
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.2"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    2.2"
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfSUM)
.head 7 -  ! Укажите сумму договора
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrSetSumm'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If not SalIsValidNumber(hWndItem)
.head 7 -  ! Недопустимый формат суммы
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrSUMFormat'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call F_DecPoint(hWndItem)
.head 6 -  Set nPROC_Real = F_CALC_RATE (dfVIDD, dpt_durat_m, dpt_durat_d, dfSUM, nPROC) 
.head 6 -  ! Минимальная сумма вклада = <...> Продолжить?
.head 6 +  If min_summ > 0 AND min_summ > dfSUM AND 
SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cFTipMinSumm') || ' = ' ||
   SalNumberToStrX(min_summ,nDig)||' '||
   IifS(nKV=980,CurrentLangTable.GetAtomTitle('frm_New.cTMessGrn'),'/'||Str(nKV))||'.'|| PutCrLf()||
   CurrentLangTable.GetAtomTitle('cTContinue'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo | MB_IconQuestion) = IDNO
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 41612
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    1.6"
.head 5 -  Width:  4.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: %:
.head 4 -  Resource Id: 41607
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.7"
.head 5 -  Top:    1.702"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPROC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: DAT_BRAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    1.038"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Return IifN(dpt_open >= dpt_close,VALIDATE_Cancel,VALIDATE_Ok)
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Начало действия % ставки для вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipDAT_BRAT'))
.head 3 +  Data Field: nPROC 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    1.155"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! % ставка для вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipPROC'))
.head 3 +  Data Field: nPROC_Real 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.267"
.head 6 -  Top:    1.702"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! % ставка для вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipPROC_Real'))
.head 3 +  Data Field: sProcPr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.0"
.head 6 -  Top:    1.7"
.head 6 -  Width:  3.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! % ставка для вклада
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipProcPr'))
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 41611
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    2.1"
.head 5 -  Width:  4.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Исп:
.head 4 -  Resource Id: 41619
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.7"
.head 5 -  Top:    2.202"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: nISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.417"
.head 6 -  Top:    2.2"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код исполнителя по открываемым счетам
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipISP'))
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( nISP )
.head 7 -  Call SalListSetSelect( cmb_ISP, -1 )
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmb_ISP.SetSelectById( nISP )
.head 6 +  If cmb_ISP.nCurrentId
.head 7 -  Call SalSendMsg( cmb_ISP, SAM_Click, 0, 0 )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  ! Нет такого исполнителя
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrNotISP'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Combo Box: cmb_ISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.283"
.head 5 -  Top:    2.202"
.head 5 -  Width:  2.817"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmb_ISP.Init(hWndItem)
.head 6 -  Call cmb_ISP.Populate(hSql(),"ID","FIO","STAFF"," WHERE TYPE = 1 AND NVL(BAX,0) <> 0 ORDER BY 1")
.head 6 -  Call cmb_ISP.SetSelectById( GetUserId() )
.head 6 -  Set nISP = cmb_ISP.GetKey( SalListQuerySelection(cmb_ISP) )
.head 5 +  On SAM_Click
.head 6 -  Set nISP = cmb_ISP.GetKey( SalListQuerySelection(cmb_ISP) )
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Ф.И.О. исполнителя по открываемым счетам
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipCmbISP'))
.head 3 -  !
.head 3 -  Background Text: Выплата %
.head 4 -  Resource Id: 2168
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.6"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: gboxProc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cb_Kapital
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: На основной вклад
.head 4 -  Window Location and Size
.head 5 -  Left:   2.0"
.head 5 -  Top:    2.8"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: МФО банка:
.head 4 -  Resource Id: 60975
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.095"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMFO_P
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: MFO_P
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    3.048"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! МФО для перечисления %%
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipMFO_P'))
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Set strNb = ''
.head 7 -  Return VALIDATE_Ok
.head 6 +  If SqlPrepareAndExecute(hSql(),
  "SELECT nb INTO :strNb 
     FROM banks 
    WHERE mfo = :MFO_P AND nvl(blk, 0) != 4")
and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Set strNb = ''
.head 7 -  ! Введите правильный код МФО банка
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrSetMFO_P'),
                   CurrentLangTable.GetAtomTitle('frm_New.cTErrRekv'),
                   MB_Ok|MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Data Field: strNb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.05"
.head 6 -  Top:    3.048"
.head 6 -  Width:  3.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Наименование банка для перечисления %%
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipNb'))
.head 3 -  Background Text: Номер счета:
.head 4 -  Resource Id: 60976
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.345"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLS_P
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: NLS_P
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    3.3"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Счет для перечисления %%
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipNLS_P'))
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If Vkrz2(MFO_P, Str(NLS_P)) != Str(NLS_P)
.head 7 -  ! Ошибка в контрольном разряде номера счета!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrNLS_KR'),
                   CurrentLangTable.GetAtomTitle('frm_New.cTErrRekv'), 
                   MB_Ok|MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  ! Счет не существует!
.head 6 +  If MFO_P = GetBankMfo() 
.head 7 +  If SqlPrepareAndExecute(hSql(),
  "SELECT c.okpo, substr(a.nms, 1, 38) 
     INTO :OKPO_P, :NAME_P
     FROM customer c, accounts a
    WHERE c.rnk = a.rnk 
      AND a.nls = :NLS_P 
      AND a.kv  = :nKV 
      AND a.dazs IS NULL")
  and NOT SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrAccNotFound'),
                   CurrentLangTable.GetAtomTitle('frm_New.cTErrRekv'), 
                   MB_Ok|MB_IconStop)
.head 8 -  Return VALIDATE_Cancel
.head 3 +  Data Field: NAME_P 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.85"
.head 6 -  Top:    3.3"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Наименование получателя
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipNAME_P'))
.head 3 +  Data Field: OKPO_P 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.0"
.head 6 -  Top:    3.048"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( OKPO_P )
.head 7 -  Return VALIDATE_Ok
.head 6 +  If V_Okpo(OKPO_P)!=OKPO_P
.head 7 -  ! Ошибка кода ОКПО
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrOKPO'),
     CurrentLangTable.GetAtomTitle('frm_New.cTErrRekv'), MB_Ok|MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код ОКПО получателя
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_New.cFTipOKPO_P'))
.head 3 +  Pushbutton: pbFindAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.6"
.head 5 -  Top:    3.298"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.3"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\LOOK.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Найти счет
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_New.cBTipFindAcc')
.head 5 +  On SAM_Click
.head 6 +  If rnk AND nKV
.head 7 -  Call SalCreateWindow( PL_CARDS, hWndMDI, 0, sNBSP, rnk, nKV )
.head 3 -  !
.head 3 -  Background Text: Возврат вклада
.head 4 -  Resource Id: 2167
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.7"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: gboxVklad
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cb_Fl2620
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Открыть вклад "До востребования"
.head 4 -  Window Location and Size
.head 5 -  Left:   2.0"
.head 5 -  Top:    3.9"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cb_Fl2620
.head 7 -  Call SalDisableWindow( NLS_Perekr )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( NLS_Perekr )
.head 3 -  Background Text: Номер счета:
.head 4 -  Resource Id: 41610
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    4.179"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLS_Perekr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: MFO_Perekr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.483"
.head 6 -  Top:    3.274"
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: NLS_Perekr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    4.15"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( hWndItem )
.head 7 -  Return VALIDATE_Ok
.head 6 +  If Vkrz2( sMFO, NLS_Perekr ) != NLS_Perekr
.head 7 -  ! Ошибка в контрольном разряде номера счета
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrNLS_KR'),
     CurrentLangTable.GetAtomTitle('frm_New.cTErrRekv'), MB_Ok|MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If SqlPrepareAndExecute( hSql(), "
   SELECT nms INTO :NAME_Perekr FROM accounts 
   WHERE nls=:NLS_Perekr AND kv=:nKV " ) 
.head 7 +  If NOT SqlFetchNext( hSql(), nFetchRes )
.head 8 -  ! Счет <...> не существует
.head 8 -  Call SalMessageBox(NLS_Perekr||"/"||SalNumberToStrX( nKV, 0)||" - " ||
     CurrentLangTable.GetAtomTitle('frm_New.cTErrAccNotFound'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconInformation )
.head 8 -  Return VALIDATE_Cancel
.head 6 +  If SqlPrepareAndExecute( hSql(), "
   SELECT c.rnk, c.nmk INTO :nRNK1, :sNMK1 
   FROM accounts a, cust_acc ca, customer c
   WHERE a.nls=:NLS_Perekr AND a.kv=:nKV AND
         a.acc=ca.acc AND c.rnk=ca.rnk " ) 
.head 7 +  If SqlFetchNext( hSql(), nFetchRes )
.head 8 +  If nRNK1!=nRNK
.head 9 -  ! Данный счет зарегистрирован за клиентом <...> ! Продолжить?
.head 9 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTMessAccForRnk') || " " || sNMK1 || " ! " || 
   CurrentLangTable.GetAtomTitle('cTContinue'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo | MB_IconQuestion) = IDNO  
.head 10 -  Return VALIDATE_Cancel
.head 3 +  Data Field: NAME_Perekr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.85"
.head 6 -  Top:    4.155"
.head 6 -  Width:  5.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Комментарий
.head 4 -  Resource Id: 2171
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    4.55"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: gboxComment
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: comment
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 128
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    4.8"
.head 6 -  Width:  8.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.5"
.head 5 -  Width:  4.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pic2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    0.5"
.head 5 -  Width:  4.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pic3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.7"
.head 5 -  Width:  9.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.95"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pic4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    3.8"
.head 5 -  Width:  9.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pic5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    4.65"
.head 5 -  Width:  9.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.85"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_SAVE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: p_vidd
.head 5 -  Number: p_rnk
.head 5 -  String: p_nd
.head 5 -  Number: p_sum
.head 5 -  String: p_nls_intpay
.head 5 -  String: p_mfo_intpay
.head 5 -  String: p_okpo_intpay
.head 5 -  String: p_name_intpay
.head 5 -  Number: p_fl_dptpay
.head 5 -  String: p_nls_dptpay
.head 5 -  String: p_mfo_dptpay
.head 5 -  String: p_name_dptpay
.head 5 -  String: p_comments
.head 5 -  Date/Time: p_datz
.head 5 -  Date/Time: p_datbegin
.head 5 -  Date/Time: p_dat_end_alt
.head 5 -  Number: p_term_m
.head 5 -  Number: p_term_d
.head 5 -  Number: p_grp
.head 5 -  Number: p_isp
.head 5 -  Number: p_dptid
.head 5 -  String: p_nlsdep
.head 5 -  String: p_nlsint
.head 5 -  String: p_nlsamr
.head 5 -  String: p_errmsg
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set p_vidd         = dfVIDD
.head 5 -  Set p_rnk          = nRNK
.head 5 -  Set p_nd           = Subs(sND, 1, 35)
.head 5 -  Set p_sum          = dfSUM * SalNumberPower(10,nDig)
.head 5 -  Set p_nls_intpay   = Subs(Str(NLS_P),1,  15)
.head 5 -  Set p_mfo_intpay   = Subs(MFO_P,     1,  12)
.head 5 -  Set p_okpo_intpay  = Subs(OKPO_P,    1,  14)
.head 5 -  Set p_name_intpay  = Subs(NAME_P,    1, 128)
.head 5 -  Set p_fl_dptpay    = cb_Fl2620
.head 5 -  Set p_nls_dptpay   = Subs(NLS_Perekr,  1,  15)
.head 5 -  Set p_mfo_dptpay   = Subs(MFO_Perekr,  1,  12)
.head 5 -  Set p_name_dptpay  = Subs(NAME_Perekr, 1,  38)
.head 5 -  Set p_comments     = Subs(comment,     1, 128)
.head 5 -  Set p_datz         = dpt_datz
.head 5 -  Set p_datbegin     = dpt_open
.head 5 -  Set p_dat_end_alt  = dpt_early_end
.head 5 -  Set p_term_m       = dpt_durat_m
.head 5 -  Set p_term_d       = dpt_durat_d
.head 5 -  Set p_grp          = nGrp
.head 5 -  Set p_isp          = nISP
.head 5 -  !
.head 5 +  If SqlPLSQLCommand (hSql(),"bars.dpt.p_open_vklad_ex
     (p_vidd,
      p_rnk, 
      p_nd,
      p_sum,
      p_nls_intpay, 
      p_mfo_intpay,
      p_okpo_intpay,
      p_name_intpay,
      p_fl_dptpay,
      p_nls_dptpay,
      p_mfo_dptpay,
      p_name_dptpay,
      p_comments,
      p_datz,
      p_datbegin,
      p_dat_end_alt,
      p_term_m, 
      p_term_d,
      p_grp,
      p_isp,
      0,
      0,
      'DEP',
      'DEN',
      -1,
      p_dptid,
      p_nlsdep,
      p_nlsint,
      p_nlsamr,
      p_errmsg)")
.head 6 -  Set nID  = p_dptid
.head 6 -  Set NLS  = p_nlsdep
.head 6 -  Set NLSN = p_nlsint
.head 6 -  Set NLSA = p_nlsamr
.head 6 -  Set sEr  = p_errmsg
.head 6 +  If p_nls_dptpay = STRING_Null
.head 7 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT nls_d, nms_d 
      INTO :NLS_Perekr,:NAME_Perekr 
      FROM dpt_deposit
     WHERE deposit_id = :nID" )
.head 8 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set i = 0 
.head 6 +  While i <= nCnt
.head 7 +  If sTagVal[i,1] != STRING_Null
.head 8 -  If SqlPrepareAndExecute( hSql(), 
  "INSERT INTO dpt_depositw (dpt_id, tag, value)
   VALUES (:nID,'"||sTagVal[i,0]||"','"||sTagVal[i,1]||"')" )
.head 7 -  Set i = i + 1
.head 6 -  Return nID
.head 5 +  Else
.head 6 -  Set sEr = p_errmsg
.head 6 -  Return -101
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: F_CLEAR
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dfVIDD=NUMBER_Null 
.head 5 -  Set nISP=NUMBER_Null 
.head 5 -  Set dpt_durat_m=NUMBER_Null 
.head 5 -  Set dpt_durat_d=NUMBER_Null 
.head 5 -  Set min_summ=NUMBER_Null
.head 5 -  Set nPROC=NUMBER_Null 
.head 5 -  Set NLS_P=NUMBER_Null
.head 5 -  !
.head 5 -  Set dpt_open = GetBankDate()
.head 5 -  Set dpt_close=DATETIME_Null
.head 5 -  Set dpt_early_end=DATETIME_Null
.head 5 -  Set DAT_BRAT=DATETIME_Null
.head 5 -  Set dfSUM=NUMBER_Null
.head 5 -  Set nPROC_Real =NUMBER_Null
.head 5 -  Set sProcPr = STRING_Null
.head 5 -  !
.head 5 -  Set sND=STRING_Null
.head 5 -  Set cmb_Vidd=STRING_Null
.head 5 -  Set cmb_ISP=STRING_Null 
.head 5 -  Set NAME_KV=STRING_Null 
.head 5 -  Set MFO_P=STRING_Null
.head 5 -  Set strNb=STRING_Null
.head 5 -  Set NAME_P=STRING_Null
.head 5 -  Set OKPO_P=STRING_Null
.head 5 -  Set MFO_Perekr=STRING_Null
.head 5 -  Set NLS_Perekr=STRING_Null
.head 5 -  Set NAME_Perekr=STRING_Null
.head 5 -  Set comment=STRING_Null
.head 5 -  Set cb_Kapital=FALSE
.head 5 -  Set cb_Fl2620=FALSE
.head 5 -  Call SalEnableWindow( NAME_P )
.head 5 -  Call SalEnableWindow( MFO_P )
.head 5 -  Call SalEnableWindow( NLS_P )
.head 5 -  Call SalEnableWindow( OKPO_P  )
.head 5 -  Call SalEnableWindow( NLS_Perekr  )
.head 5 -  Call SalDisableWindow( pbSave )
.head 5 -  Call SalEnableWindow( pbFindAcc )
.head 3 +  Function: F_CALC_RATE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: p_vidd
.head 5 -  Number: p_term_m
.head 5 -  Number: p_term_d
.head 5 -  Number: p_sum
.head 5 -  Number: p_base_rate
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: n_rate
.head 5 -  Number: n_month
.head 5 -  Number: n_days
.head 4 +  Actions
.head 5 +  If p_vidd = NUMBER_Null
.head 6 -  Return NUMBER_Null
.head 5 -  Set n_month = IifN( p_term_m = NUMBER_Null, 0, p_term_m )
.head 5 -  Set n_days  = IifN( p_term_d = NUMBER_Null, 0, p_term_d )
.head 5 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT dpt.f_calc_rate("||
           Str(p_vidd)||","||
           Str(n_month)||","||
           Str(n_days)||","||
           Str(p_sum*SalNumberPower(10,nDig))||")
      INTO :n_rate FROM dual" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set n_rate = p_base_rate
.head 5 +  Else
.head 6 +  If n_rate = NUMBER_Null
.head 7 -  Set n_rate = p_base_rate
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT substr(f_sumpr("||VisStrSubstitute(Str(n_rate),',','.')||",'','F'),1,100)
   INTO :sProcPr
   FROM dual")
.head 6 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Return n_rate
.head 3 +  Function: F_DecPoint     
.head 4 -  Description: Корректировка символа "десятичной точки" (украла у Миши)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp
.head 5 -  String: sDecimal   ! симв десятичной точки
.head 5 -  String: sDecimal2  ! симв десятичной точки alt
.head 4 +  Actions
.head 5 -  Set sDecimal = SalStrMidX(SalNumberToStrX(1.1,1),1,1)
.head 5 +  If sDecimal = '.'
.head 6 -  Set sDecimal2 = ','
.head 5 +  Else
.head 6 -  Set sDecimal2 = '.'
.head 5 -  !
.head 5 -  Set sTmp = SalStrRepeatX( ' ', 20 )
.head 5 -  Call SalGetWindowText ( hWnd, sTmp, 20 )
.head 5 +  While SalStrScan(sTmp, sDecimal2) > 0
.head 6 -  Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
.head 5 -  Call SalFmtStrToField ( hWnd, sTmp, TRUE)
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nGrp
.head 3 -  Number: rnk
.head 3 -  String: nmk 
.head 3 -  Number: deposit_id
.head 3 -  String: pasp
.head 3 -  String: okpo
.head 3 -  String: adr
.head 3 -  Number: nKodCAgent  ! - - для проверки на резидентность
.head 3 -  String: sTT_P       !TT3TT4 - перечисление %% внутрибанк\межбанк
.head 2 +  Window Variables
.head 3 -  Number: FL_AUTO_ADD
.head 3 -  String: strWndName
.head 3 -  Number: nKV 
.head 3 -  Number: nDig
.head 3 -  Number: nInd
.head 3 -  Number: i
.head 3 -  Number: nCnt
.head 3 -  Number: nTmp
.head 3 -  Number: nRNK1
.head 3 -  Number: n980
.head 3 -  String: sMFO
.head 3 -  String: sNMK1
.head 3 -  Number: nFetchRes
.head 3 -  Number: nRezid
.head 3 -  Number: nFixDurat
.head 3 -  Number: nComProc 
.head 3 -  Number: nFl2620
.head 3 -  String: sEr
.head 3 -  Number: nSertificate 
.head 3 -  Number: nBR_ID
.head 3 -  Number: nMASKA
.head 3 -  Date/Time: dTest
.head 3 -  String: sNBSP
.head 3 -  String: sTagVal[*,2]
.head 3 -  String: sTags
.head 3 -  Boolean: bFilled
.head 3 -  String: TT3  !! код операции для перечисл.%% (внутрибанк)
.head 3 -  String: TT4  !! код операции для перечисл.%% (межбанк)
.head 3 -  !
.head 3 -  String: strErrorText
.head 3 -  Number: nErrorNum
.head 3 -  Number: nPos
.head 3 -  Sql Handle: hSqlError
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_New.cTWndTitle'))
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalGetWindowText(hWndForm, strWndName, 128)
.head 4 -  Call SaveInfoToLog(MSG_Invoke() || strWndName)
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Set nRNK = rnk
.head 4 -  Set n980 = GetBaseVal()
.head 4 -  Set sMFO = GetBankMfo(  )
.head 4 -  Set sNMK = nmk
.head 4 -  Set nID  = deposit_id
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  Call SalSetFocus( dfVIDD )
.head 4 -  Call SalDisableWindow( pbIndiVidd )
.head 4 -  Call SalDisableWindow( cb_Kapital )
.head 4 -  Call SalDisableWindow( cb_Fl2620 )
.head 4 -  Call SalDisableWindow( dpt_durat_m )
.head 4 -  Call SalDisableWindow( dpt_durat_d )
.head 4 -  Call SalEnableWindow( NLS_Perekr  )
.head 4 -  Call SalDisableWindow( NAME_Perekr )
.head 4 -  Call SalHideWindow( pb_AUTO_ADD )
.head 4 -  Set TT3 = Subs(sTT_P,1,3)
.head 4 -  Set TT4 = Subs(sTT_P,4,3)
.head 4 -  ! Дата досрочного расторжения договора (для Петрокоммерцбанка)
.head 4 +  If GetGlobalOptionEx('VKL_MASK') = 2
.head 5 -  Call SalShowWindow( dpt_early_end )
.head 5 -  Call SalShowWindow( name_early_end )
.head 5 -  ! Дата досрочного снятия
.head 5 -  Set name_early_end = CurrentLangTable.GetAtomTitle('frm_New.cTName_early_end')
.head 4 +  Else
.head 5 -  Call SalHideWindow( dpt_early_end )
.head 5 -  Call SalHideWindow( name_early_end )
.head 4 -  ! Выбор счетов для безнал.выплаты %%
.head 4 +  If GetGlobalOption('DPT_NBSP')
.head 5 -  Set sNBSP = GetGlobalOption('DPT_NBSP')
.head 5 -  Call SalShowWindow( pbFindAcc )
.head 4 +  Else
.head 5 -  Call SalHideWindow( pbFindAcc )
.head 4 -  ! Управление датой открытия договора
.head 4 +  If GetGlobalOptionEx('DPT_DTBK') > 0 OR 
   GetGlobalOptionEx('DPT_DTFW') > 0 
.head 5 -  Call SalEnableWindow(dpt_open)
.head 4 +  Else
.head 5 -  Call SalDisableWindow(dpt_open)
.head 1 +  ! Form Window: frm_IndiVidd
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Индивидуальный вклад
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.41"
.head 4 -  Top:    0.3"
.head 4 -  Width:  11.133"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.786"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -    Description: 
.head 2 -    Named Menus 
.head 2 -    Menu 
.head 2 +    Tool Bar 
.head 3 +    Contents 
.head 4 +    Pushbutton: pbClear
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -  ! " Очистить "
.head 7 -    Set strTip = CurrentLangTable.GetAtomTitle('frm_IndiVidd.cBTipClear')
.head 6 +    On SAM_Click
.head 7 -    Call F_POPULATE()
.head 4 +    Pushbutton: pbSave
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -  ! " Открыть вклад с индивидуальными условиями"
.head 7 -    Set strTip = CurrentLangTable.GetAtomTitle('frm_IndiVidd.cBTipSaue')
.head 6 +    On SAM_Click
.head 7 -    Set nID=F_OPEN()
.head 7 +    If nID >0
.head 8 -    Call SqlCommit(hSql())
.head 8 -  ! Call MessageNoWait('Открытие вклада =' ||Str(nID), 'Сообщение', 3, 0)
.head 8 -    Call MessageNoWait(CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTOpenVklad') || ' =' ||Str(nID), 
     CurrentLangTable.GetAtomTitle('cTMessage'), 3, 0)
.head 8 -    Call SalDisableWindow( cmb_FREQ )
.head 8 -    Call SalDisableWindow( cb_Amort )
.head 8 -    Call SalDisableWindow( cb_Kapital )
.head 8 -    Call SalDisableWindow( cmb_MINUS_SUM )
.head 8 -    Call SalDisableWindow( cmb_MINUS_COUNT )
.head 8 -    Call SalDisableWindow( cmb_STOP )
.head 8 -    Call SalDisableWindow( cmb_ADD )
.head 8 -    Call SalDisableWindow( pbSave )
.head 8 -    Set frm_New.nID=nID
.head 8 -    Set frm_New.NLS=sNLS
.head 8 -    Set frm_New.NLSN=sNLSN
.head 8 -    Set frm_New.NLSA=sNLSA
.head 8 -    Set frm_New.MFO_P=sMFO_P
.head 8 -    Set frm_New.NLS_P=Val(sNLS_P)
.head 8 -    Set frm_New.NAME_P=sNAME_P
.head 8 -    Set frm_New.OKPO_P=sOKPO_P
.head 8 -    Call SalDisableWindow( frm_New.pbIndiVidd )
.head 8 -    Call SalDisableWindow( frm_New.pbClear )
.head 8 -    Call SalDisableWindow( frm_New.pbSave )
.head 8 -    Call SalDisableWindow( frm_New.dfVIDD )
.head 8 -    Call SalDisableWindow( frm_New.cmb_Vidd )
.head 8 -    Call SalDisableWindow( frm_New.nISP )
.head 8 -    Call SalDisableWindow( frm_New.cmb_ISP )
.head 8 -    Call SalDisableWindow( frm_New.dpt_datz )
.head 8 -    Call SalDisableWindow( frm_New.MFO_P )
.head 8 -    Call SalDisableWindow( frm_New.NLS_P )
.head 8 -    Call SalDisableWindow( frm_New.NAME_P )
.head 8 -    Call SalDisableWindow( frm_New.OKPO_P )
.head 8 -    Call SalDisableWindow( frm_New.dpt_durat_m )
.head 8 -    Call SalDisableWindow( frm_New.dpt_durat_d )
.head 8 -    Call SalDisableWindow( frm_New.comment)
.head 7 +    Else 
.head 8 -    Call SqlRollback(hSql())
.head 8 -  ! Call MessageNoWait("Ошибка при открытии вклада "|| sEr, 'Ошибка', 0, 1)
.head 8 -    Call MessageNoWait(CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTErrOpenVklad') || " "|| sEr, 
     CurrentLangTable.GetAtomTitle('cTErr'), 0, 1)
.head 4 +    Pushbutton: pbCalc
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -  ! " Расчитать значение %-ной ставки "
.head 7 -    Set strTip = CurrentLangTable.GetAtomTitle('frm_IndiVidd.cBTipCalc')
.head 6 +    On SAM_Click
.head 7 +    If dfMINUS_COUNT>0 AND (dfMINUS_SUM=0 OR dfMINUS_SUM=NUMBER_Null)  
.head 8 -  ! Call SalMessageBox( 'Не задан процент суммы част.снятия со вклада!', 'Внимание', MB_IconExclamation )
.head 8 -    Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTErrProc'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 7 +    Else 
.head 8 -    Call F_CALCULATE()
.head 4 +    Pushbutton: pbCancel
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -  ! 'Завершить'
.head 7 -    Set strTip = CurrentLangTable.GetAtomTitle('frm_IndiVidd.cBTipCancel')
.head 6 +    On SAM_Click
.head 7 -    Call SalDestroyWindow(hWndForm)
.head 4 -    Line 
.head 2 +    Contents 
.head 3 -  ! Group Box: Параметры вклада
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.071"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 3 -    Background Text: Параметры вклада
.head 3 +    Data Field: gboxParams
.head 4 -    Message Actions 
.head 3 -    Background Text: Срок:
.head 3 +    Data Field: bgDURATION
.head 4 -    Message Actions 
.head 3 +    Data Field: dfDUR_M
.head 4 -    Message Actions 
.head 3 +    Data Field: dfDUR_D
.head 4 -    Message Actions 
.head 3 +    Data Field: dfDURATION
.head 4 -    Message Actions 
.head 3 -  !
.head 3 -    Background Text: Валюта:
.head 3 +    Data Field: bgKV
.head 4 -    Message Actions 
.head 3 +    Data Field: dfKV
.head 4 -    Message Actions 
.head 3 +    Data Field: dfISO
.head 4 -    Message Actions 
.head 3 +    Data Field: dfKV_NAME
.head 4 -    Message Actions 
.head 3 -  !
.head 3 -  ! Group Box: Процентная ставка
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.283"
.head 5 -  Top:    0.071"
.head 5 -  Width:  4.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 3 -    Background Text: Процентная ставка
.head 3 +    Data Field: gboxRate
.head 4 -    Message Actions 
.head 3 -    Background Text: MAX:
.head 3 +    Data Field: bgMAX
.head 4 -    Message Actions 
.head 3 +    Data Field: dfRATE_MAX
.head 4 -    Message Actions 
.head 3 -    Background Text: Фактич.:
.head 3 +    Data Field: bgRATE_REAL
.head 4 -    Message Actions 
.head 3 +    Data Field: dfRATE_REAL
.head 4 -    Message Actions 
.head 3 -  !
.head 3 -  ! Group Box: Индивидуальные условия вклада
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.738"
.head 5 -  Width:  10.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 3 -    Background Text: Индивидуальные условия вклада
.head 3 +    Data Field: gboxIndRate
.head 4 -    Message Actions 
.head 3 -  ! Group Box: Выплата процентов:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.988"
.head 5 -  Width:  10.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 3 -    Background Text: Выплата процентов:
.head 3 +    Data Field: gboxProc
.head 4 -    Message Actions 
.head 3 -    Background Text: Периодичность:
.head 3 +    Data Field: bgFREQ
.head 4 -    Message Actions 
.head 3 +    Data Field: dfFREQ
.head 4 -    Message Actions 
.head 3 +    Combo Box: cmb_FREQ
.head 4 -    List Initialization 
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 +    If cmb_FREQ.Init(hWndItem)
.head 7 -    Call cmb_FREQ.Populate(hSql(),"FREQ","NAME","FREQ",
   " WHERE freq IN (SELECT distinct val FROM dpt_individd 
                     WHERE vidd=:frm_IndiVidd.dfVIDD AND 
                           kv=:frm_IndiVidd.dfKV  AND 
                           duration_m=:frm_IndiVidd.dfDUR_M AND 
                           duration_d=:frm_IndiVidd.dfDUR_D AND  
                           tag='F' ) 
         OR freq IN (SELECT freq_k FROM dpt_vidd WHERE vidd=:frm_IndiVidd.dfVIDD) ORDER BY FREQ")
.head 7 -    Call cmb_FREQ.SetSelectById( dfFREQ )
.head 5 +    On SAM_Click
.head 6 -    Set dfFREQ = cmb_FREQ.GetKey( SalListQuerySelection(cmb_FREQ) )
.head 6 -    Set cb_Amort=FALSE
.head 6 -    Set cb_Kapital=FALSE
.head 3 -  !
.head 3 +    Check Box: cb_Amort
.head 4 +    Message Actions 
.head 5 +    On SAM_Click
.head 6 +    If cb_Amort=TRUE
.head 7 -    Set cb_Kapital=FALSE
.head 7 -    Call SalDisableWindow( cb_Kapital )
.head 7 -    Set dfFREQ=1
.head 7 -    Call SalDisableWindow( cmb_FREQ )
.head 6 +    Else 
.head 7 -    Call SalEnableWindow( cb_Kapital )
.head 7 -    Call SalEnableWindow( cmb_FREQ )
.head 3 +    Check Box: cb_Kapital
.head 4 +    Message Actions 
.head 5 +    On SAM_Click
.head 6 +    If cb_Kapital=TRUE
.head 7 -    Set cb_Amort=FALSE
.head 7 -    Call SalDisableWindow( cb_Amort )
.head 7 -    Set dfFREQ=1
.head 7 -    Call SalDisableWindow( cmb_FREQ )
.head 6 +    Else 
.head 7 -    Call SalEnableWindow( cb_Amort )
.head 7 -    Call SalEnableWindow( cmb_FREQ )
.head 3 -  !
.head 3 -  ! Group Box: Условия частичного снятия вклада:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    1.738"
.head 5 -  Width:  4.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 3 -    Background Text: Условия частичного снятия вклада:
.head 3 +    Data Field: gboxSn
.head 4 -    Message Actions 
.head 3 -    Background Text: Сумма (в %):
.head 3 +    Data Field: bgSUM
.head 4 -    Message Actions 
.head 3 +    Data Field: dfMINUS_SUM
.head 4 -    Message Actions 
.head 3 +    Combo Box: cmb_MINUS_SUM
.head 4 -    List Initialization 
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 +    If cmb_MINUS_SUM.Init( hWndItem )
.head 7 -    Call cmb_MINUS_SUM.Populate( hSql(),"TO_NUMBER(VAL)*100",
         " TO_CHAR(decode(VAL,0,' ',VAL*100||'% от остатка на счете'))", 
         "DPT_INDIVIDD"," WHERE vidd=:frm_IndiVidd.dfVIDD AND kv=:frm_IndiVidd.dfKV  AND 
               duration_m=:frm_IndiVidd.dfDUR_M AND duration_d=:frm_IndiVidd.dfDUR_D AND  
               tag='M' ORDER BY VAL" )
.head 7 -    Call cmb_MINUS_SUM.SetSelectById( dfMINUS_SUM )
.head 5 +    On SAM_Click
.head 6 -    Set dfMINUS_SUM=cmb_MINUS_SUM.GetKey( SalListQuerySelection(cmb_MINUS_SUM) )
.head 3 -  !
.head 3 -    Background Text: Кол-во операций:
.head 3 +    Data Field: bgCOUNT
.head 4 -    Message Actions 
.head 3 +    Data Field: dfMINUS_COUNT
.head 4 -    Message Actions 
.head 3 +    Combo Box: cmb_MINUS_COUNT
.head 4 -    List Initialization 
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 +    If cmb_MINUS_COUNT.Init( hWndItem )
.head 7 -  ! "decode(VAL,0,'без част.снятия',VAL||' раз в течении срока вклада')"
.head 7 -    Call cmb_MINUS_COUNT.Populate( hSql(),"TO_NUMBER(VAL)", "decode(VAL,0,'"||
     CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTCount')||"',VAL||' "||
     CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTCount_')||"')", 
         "DPT_INDIVIDD"," WHERE vidd=:frm_IndiVidd.dfVIDD AND kv=:frm_IndiVidd.dfKV  AND 
               duration_m=:frm_IndiVidd.dfDUR_M AND duration_d=:frm_IndiVidd.dfDUR_D AND  
               tag='N' ORDER BY VAL" )
.head 7 -    Call cmb_MINUS_COUNT.SetSelectById( dfMINUS_COUNT )
.head 5 +    On SAM_Click
.head 6 -    Set dfMINUS_COUNT=cmb_MINUS_COUNT.GetKey( SalListQuerySelection(cmb_MINUS_COUNT) )
.head 6 +    If dfMINUS_COUNT=0
.head 7 -    Set dfMINUS_SUM=NUMBER_Null
.head 7 -    Set cmb_MINUS_SUM=STRING_Null
.head 7 -    Call SalDisableWindow( cmb_MINUS_SUM )
.head 6 +    Else 
.head 7 -    Call SalEnableWindow( cmb_MINUS_SUM )
.head 3 -  !
.head 3 -  ! Group Box: Штраф и довзнос
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.283"
.head 5 -  Top:    1.738"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 3 -    Background Text: Штраф и довзнос
.head 3 +    Data Field: gboxSTOP
.head 4 -    Message Actions 
.head 3 -    Background Text: Штраф:
.head 3 +    Data Field: bgSTOP
.head 4 -    Message Actions 
.head 3 +    Data Field: dfSTOP
.head 4 -    Message Actions 
.head 3 +    Combo Box: cmb_STOP
.head 4 -    List Initialization 
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 +    If cmb_STOP.Init( hWndItem )
.head 7 -    Call cmb_STOP.Populate( hSql(), "ID", "NAME", "DPT_STOP", 
       " WHERE id      IN (SELECT distinct val FROM dpt_individd 
                           WHERE vidd=:frm_IndiVidd.dfVIDD AND 
                                 kv=:frm_IndiVidd.dfKV  AND 
                                 duration_m=:frm_IndiVidd.dfDUR_M AND 
                                 duration_d=:frm_IndiVidd.dfDUR_D AND  
                                 tag='S' ) 
         OR id    IN (SELECT id_stop FROM dpt_vidd WHERE vidd=:frm_IndiVidd.dfVIDD) ORDER BY ID" )
.head 7 -    Call cmb_STOP.SetSelectById( dfSTOP )
.head 5 +    On SAM_Click
.head 6 -    Set dfSTOP=cmb_STOP.GetKey( SalListQuerySelection(cmb_STOP) )
.head 3 -  !
.head 3 -    Background Text: Пополнение:
.head 3 +    Data Field: bgADD
.head 4 -    Message Actions 
.head 3 +    Data Field: dfADD
.head 4 -    Message Actions 
.head 3 +    Combo Box: cmb_ADD
.head 4 -    List Initialization 
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 +    If cmb_ADD.Init( hWndItem )
.head 7 +    If GetGlobalOptionEx('VKL_MASK')=2
.head 8 -  ! ' в течение ' ' дн.'
.head 8 -    Call cmb_ADD.Populate( hSql(),  "TO_NUMBER(VAL)*100",
     " decode(VAL,0,' ',
         ' "||CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTIn')||" '||"||
       Str(IifN(dfDUR_D=1000,nDURATION_D,370))||"*VAL || "||"' "||CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTInDay')||"'"||")", 
         " DPT_INDIVIDD ",
         " WHERE vidd=:frm_IndiVidd.dfVIDD            AND 
                 kv=:frm_IndiVidd.dfKV                AND 
                 duration_m=:frm_IndiVidd.dfDUR_M AND 
                 duration_d=:frm_IndiVidd.dfDUR_D AND  
                 tag='D' 
           ORDER BY VAL " )
.head 7 +    Else 
.head 8 -  ! 'в течение ' ' мес. ' ' дн.'
.head 8 -    Call cmb_ADD.Populate( hSql(),"TO_NUMBER(VAL)*100",
         " decode(DURATION_M*VAL,0,' ','"||CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTIn') ||"' '||DURATION_M*VAL||' "||
CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTInMonth')||" ')||
           decode(DURATION_D*VAL,0,' ','"||CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTIn')||" '||DURATION_D*VAL||' "||
CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTInDay')||"')", 
         "DPT_INDIVIDD"," WHERE vidd=:frm_IndiVidd.dfVIDD AND kv=:frm_IndiVidd.dfKV  AND 
               duration_m=:frm_IndiVidd.nDURATION_M AND duration_d=:frm_IndiVidd.nDURATION_D AND  
               tag='D' ORDER BY VAL" )
.head 7 -    Call cmb_ADD.SetSelectById( dfADD )
.head 5 +    On SAM_Click
.head 6 -    Set dfADD=cmb_ADD.GetKey( SalListQuerySelection(cmb_ADD) )
.head 3 -  !
.head 3 +    Picture: picParams
.head 4 -    Message Actions 
.head 3 +    Picture: picRate
.head 4 -    Message Actions 
.head 3 +    Picture: picIndRate
.head 4 -    Message Actions 
.head 3 +    Picture: picProc
.head 4 -    Message Actions 
.head 3 +    Picture: picSn
.head 4 -    Message Actions 
.head 3 +    Picture: picShtraf
.head 4 -    Message Actions 
.head 2 +    Functions 
.head 3 +    Function: F_POPULATE
.head 4 -    Description: 
.head 4 -    Returns 
.head 4 -    Parameters 
.head 4 -    Static Variables 
.head 4 -    Local variables 
.head 4 +    Actions 
.head 5 -    Set dfRATE_REAL=NUMBER_Null
.head 5 +    If SqlPrepareAndExecute( hSqlAux2(), 
   "SELECT t.kv, t.lcv, t.name, v.freq_k, f.name, decode(v.sour,4,0,1), 
	   v.comproc, v.id_stop, s.name
    INTO :frm_IndiVidd.dfKV,:frm_IndiVidd.dfISO,:frm_IndiVidd.dfKV_NAME, 
         :frm_IndiVidd.dfFREQ,:frm_IndiVidd.cmb_FREQ,
         :frm_IndiVidd.cb_Amort,:frm_IndiVidd.cb_Kapital,
         :frm_IndiVidd.dfSTOP,:frm_IndiVidd.cmb_STOP 
    FROM dpt_vidd v, tabval t, dpt_stop s, freq f
    WHERE v.kv=t.kv AND v.id_stop=s.id AND v.freq_k=f.freq AND 
          v.vidd=:frm_IndiVidd.dfVIDD " )
.head 6 -    Call SqlFetchNext( hSqlAux2(), nFetchRes )
.head 5 -  ! Или выплата %% с период-тью,  или аванс, или ежемесячная капитализация
.head 5 +    If cb_Amort=TRUE
.head 6 -    Call SalDisableWindow( cb_Kapital )
.head 6 -    Call SalDisableWindow( cmb_FREQ )
.head 5 +    Else If cb_Kapital
.head 6 -    Call SalDisableWindow( cb_Amort )
.head 6 -    Call SalDisableWindow( cmb_FREQ )
.head 5 +    Else If cmb_FREQ
.head 6 -    Call SalDisableWindow( cb_Amort )
.head 6 -    Call SalDisableWindow( cb_Kapital )
.head 5 +    Else 
.head 6 -    Call SalEnableWindow( cb_Amort )
.head 6 -    Call SalEnableWindow( cb_Kapital )
.head 6 -    Call SalEnableWindow( cmb_FREQ )
.head 5 -  ! Макс. ставка
.head 5 +    If SqlPrepareAndExecute( hSqlAux2(), 
   " SELECT max(rate) INTO :frm_IndiVidd.dfRATE_MAX FROM dpt_individd
     WHERE vidd=:frm_IndiVidd.dfVIDD AND kv=:frm_IndiVidd.dfKV  AND 
           duration_m=:frm_IndiVidd.dfDUR_M AND 
           duration_d=:frm_IndiVidd.dfDUR_D ") 
AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
.head 6 -    Set frm_IndiVidd.dfRATE_MAX=NUMBER_Null
.head 5 +    If dfRATE_MAX=NUMBER_Null
.head 6 -    Call SalDisableWindow( cmb_FREQ )
.head 6 -    Call SalDisableWindow( cmb_STOP )
.head 6 -    Call SalDisableWindow( cb_Amort )
.head 6 -    Call SalDisableWindow( cb_Kapital )
.head 6 -    Call SalDisableWindow( cmb_ADD )
.head 6 -    Call SalDisableWindow( cmb_MINUS_SUM )
.head 6 -    Call SalDisableWindow( cmb_MINUS_COUNT )
.head 6 +    If SqlPrepareAndExecute( hSql(), 
     "SELECT b.rate INTO :dfRATE_MAX 
      FROM br_normal b, dpt_vidd v  
      WHERE v.br_id=b.br_id AND v.kv=b.kv AND 
            v.vidd=:frm_IndiVidd.dfVIDD   AND 
            b.bdate=(SELECT max(BDATE) FROM br_normal 
                     WHERE bdate<=bankdate AND kv=b.kv AND br_id=b.br_id) " )
.head 7 -    Call SqlFetchNext( hSql(), nFetchRes )
.head 5 -  ! Срок пополнения (по умолчанию) 
.head 5 +    If SqlPrepareAndExecute( hSqlAux2(), 
   " SELECT nvl(val,0)*100 INTO :frm_IndiVidd.dfADD  FROM dpt_individd
     WHERE vidd=:frm_IndiVidd.dfVIDD AND kv=:frm_IndiVidd.dfKV  AND 
           duration_m=:frm_IndiVidd.dfDUR_M AND 
           duration_d=:frm_IndiVidd.dfDUR_D AND  
           tag='D' AND delta=0 ") 
AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
.head 6 -    Set frm_IndiVidd.dfADD=NUMBER_Null
.head 5 -  ! Макс.допустимое кол-во снятий со вклада (по умолчанию) 
.head 5 +    If SqlPrepareAndExecute( hSqlAux2(), 
   " SELECT nvl(val,0) INTO :frm_IndiVidd.dfMINUS_COUNT 
     FROM dpt_individd
     WHERE vidd=:frm_IndiVidd.dfVIDD AND kv=:frm_IndiVidd.dfKV  AND 
           duration_m=:frm_IndiVidd.dfDUR_M AND 
           duration_d=:frm_IndiVidd.dfDUR_D AND  
           tag='N' AND delta=0 ") 
AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
.head 6 -    Set dfMINUS_COUNT=NUMBER_Null
.head 5 -  ! Сумма част.снятия со вклада (по умолчанию) 
.head 5 +    If dfMINUS_COUNT>0
.head 6 +    If SqlPrepareAndExecute( hSqlAux2(), 
   " SELECT nvl(val,0)*100 INTO :frm_IndiVidd.dfMINUS_SUM 
     FROM dpt_individd
     WHERE vidd=:frm_IndiVidd.dfVIDD AND kv=:frm_IndiVidd.dfKV  AND 
           duration_m=:frm_IndiVidd.dfDUR_M AND 
           duration_d=:frm_IndiVidd.dfDUR_D AND  
           tag='M' AND delta=0 ") 
AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
.head 7 -    Set dfMINUS_SUM=NUMBER_Null
.head 5 +    Else 
.head 6 -    Set cmb_MINUS_SUM=STRING_Null
.head 6 -    Call SalDisableWindow( cmb_MINUS_SUM )
.head 3 +    Function: F_CALCULATE
.head 4 -    Description: Расчет фактической %-ной ставки
.head 4 -    Returns 
.head 4 -    Parameters 
.head 4 -    Static Variables 
.head 4 +    Local variables 
.head 5 -    Number: nDelta
.head 5 -    String: sTag
.head 5 -    Number: nVal
.head 5 -    Number: nRate
.head 4 +    Actions 
.head 5 -    Call SqlPrepareAndExecute( hSql(),
     "SELECT distinct tag INTO :sTag FROM dpt_individd ORDER BY tag" )
.head 5 -    Set nRate=dfRATE_MAX
.head 5 +    While SqlFetchNext( hSql(), nFetchRes )
.head 6 +    If sTag='A'
.head 7 -    Set nVal=cb_Amort
.head 6 +    Else If sTag='C'
.head 7 -    Set nVal=cb_Kapital
.head 6 +    Else If sTag='D'
.head 7 -    Set nVal=dfADD/100
.head 6 +    Else If sTag='F'
.head 7 -    Set nVal=dfFREQ
.head 6 +    Else If sTag='M'
.head 7 -    Set nVal=dfMINUS_SUM/100
.head 6 +    Else If sTag='N'
.head 7 -    Set nVal=dfMINUS_COUNT
.head 6 +    Else If sTag='S'
.head 7 -    Set nVal=dfSTOP
.head 6 +    Else 
.head 7 -    Set nVal=0
.head 6 +    If SqlPrepareAndExecute( hSqlAux2(), 
   " SELECT nvl(delta,0) INTO :nDelta 
     FROM dpt_individd
     WHERE vidd=:frm_IndiVidd.dfVIDD            AND 
           kv=:frm_IndiVidd.dfKV                AND 
           duration_m=:frm_IndiVidd.dfDUR_M     AND 
           duration_d=:frm_IndiVidd.dfDUR_D     AND  
           tag=:sTag                            AND 
           val=:nVal ") 
AND NOT SqlFetchNext( hSqlAux2(), nFetchRes )
.head 7 -    Set nDelta=0
.head 6 -    Set nRate=nRate-nDelta
.head 5 -    Set dfRATE_REAL=nRate
.head 3 +    Function: F_OPEN
.head 4 -    Description: 
.head 4 +    Returns 
.head 5 -    Number: 
.head 4 -    Parameters 
.head 4 -    Static Variables 
.head 4 +    Local variables 
.head 5 -    Number: nFetchRes
.head 5 -    Number: nTmp
.head 5 -    String: sTmp
.head 5 -  !
.head 5 -    Number: ACC
.head 5 -    Number: ACCN
.head 5 -    Number: ACCA
.head 5 -  !
.head 5 -    String: sOKPO
.head 5 -    String: sTT
.head 5 -    Number: nBASEY
.head 5 -    Number: nBASEM
.head 5 -    Number: nFREQN
.head 5 -    Number: nBR_ID_L
.head 5 -    Number: nMIN_SUM
.head 5 -    String: sBSD
.head 5 -    String: sBSN
.head 5 -    String: sBSA
.head 5 -    Number: nMETR
.head 5 -    Number: nTIPOST
.head 5 -    Number: nIDG
.head 5 -    Number: nIDS
.head 5 -    Number: nRASX
.head 5 -  !
.head 5 -    Date/Time: dSTOP
.head 5 -    Date/Time: dDAT_BEGIN
.head 5 -    Number: n980
.head 5 -  !
.head 5 -    Number: nMASKA
.head 5 -    Number: nSERTIFICATE 
.head 5 -    String: sNMS
.head 5 -    String: sNMSN
.head 5 -    String: sNMSA
.head 5 -  !
.head 5 -    String: sTTB
.head 5 -    Date/Time: dDAT1
.head 5 -    String: sMFO_Perekr
.head 5 -  !
.head 4 +    Actions 
.head 5 +    If dfMINUS_COUNT>0 AND (dfMINUS_SUM=0 OR dfMINUS_SUM=NUMBER_Null)  
.head 6 -    Set sEr='Не задан процент суммы част.снятия со вклада!'
.head 6 -    Return -1
.head 5 +    Else 
.head 6 -    Call F_CALCULATE()
.head 6 -    Set ACC=NUMBER_Null
.head 6 -    Set ACCN=NUMBER_Null
.head 6 -    Set ACCA=NUMBER_Null
.head 6 -    Set nID=NUMBER_Null
.head 6 -    Set n980=GetBaseVal(  )
.head 6 -    Set dDAT_BEGIN=GetBankDate(  )
.head 6 +    If dDATZ=DATETIME_Null
.head 7 -    Set dDATZ=dDAT_BEGIN
.head 6 -  ! Код операции для начисления %%
.head 6 -  ! Раньше для нерезидентов брали 10% в ПФ, 
.head 6 -  ! теперь для всех вкладчиков - %%1
.head 6 +    If SqlPrepareAndExecute( hSql(),
   "SELECT c.okpo, '%%1' 
    INTO :sOKPO, :sTT  
    FROM codcagent d, customer c
    WHERE c.rnk=:nRNK AND d.codcagent=c.codcagent") AND
NOT SqlFetchNext(hSql(),nFetchRes)
.head 7 -    Call SalMessageBox('Невозможно выбрать тип резидентности','Внимание',0)
.head 7 -    Return -2
.head 6 -    Call SqlPrepareAndExecute(hSql(),
     "SELECT basey,nvl(basem,0),freq_n,metr,nvl(tip_ost,0),acc7,br_id_l,
             min_summ*100,bsd,bsn,NVL(deposit_cod,'3500')
      INTO   :nBASEY,:nBASEM,:nFREQN,:nMETR,:nTIPOST,:nRASX,:nBR_ID_L,
             :nMIN_SUM,:sBSD,:sBSN,:sBSA             
      FROM dpt_vidd v 
      WHERE v.vidd=:dfVIDD")
.head 6 +    If SqlFetchNext(hSql(),nFetchRes)
.head 7 -    Set dSTOP=DATETIME_Null
.head 7 +    If dDAT_END=DATETIME_Null
.head 8 -    Call SalMessageBox('Создается договор до востребования!','Внимание',0)
.head 7 +    Else 
.head 8 +    If nBR_ID_L=0 OR nBR_ID_L=NUMBER_Null
.head 9 -    Set dSTOP=dDAT_END-1
.head 7 -  ! Номер вклада
.head 7 +    If NOT (SqlPrepareAndExecute(hSql(),"SELECT s_cc_deal.nextval INTO :nID FROM dual") AND 
        SqlFetchNext(hSql(),nFetchRes))
.head 8 -    Set sEr="Невозможно открыть договор"
.head 8 -    Return -3
.head 7 -  ! Счет расходов
.head 7 -  ! Генерация номеров счетов по разным маскам 
.head 7 -    Set nMASKA=SalStrToNumber( GetGlobalOption('VKL_MASK') )
.head 7 -  ! Сертификаты 3320
.head 7 +    If sBSD='3320'
.head 8 -    Call SalModalDialog( dlgSertificate, frm_IndiVidd, nSERTIFICATE )
.head 8 +    If SqlPrepareAndExecute( hSql(), 
  " SELECT substr(bars.dpt.f_nls('NLS',:nMASKA,:nRNK,:sBSD,:nSERTIFICATE,:dfVIDD),1,14) INTO :sNLS FROM dual" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -    Set sEr="Невозможно сгенерировать депозитный счет!"
.head 9 -    Return -5
.head 8 +    If SqlPrepareAndExecute( hSql(), 
  "SELECT substr(bars.dpt.f_nls('NLS',:nMASKA,:nRNK,:sBSN,:nSERTIFICATE,:dfVIDD),1,14) INTO :sNLSN FROM dual" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -    Set sEr="Невозможно сгенерировать счет начисл.%%!"
.head 9 -    Return -6
.head 7 +    Else 
.head 8 +    If SqlPrepareAndExecute( hSql(), 
  " SELECT substr(bars.dpt.f_nls('NLS',:nMASKA,:nRNK,:sBSD,:nID,:dfVIDD),1,14) INTO :sNLS FROM dual" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -    Set sEr="Невозможно сгенерировать депозитный счет!"
.head 9 -    Return -7
.head 8 +    If SqlPrepareAndExecute( hSql(), 
  "SELECT substr(bars.dpt.f_nls('NLS',:nMASKA,:nRNK,:sBSN,:nID,:dfVIDD),1,14) INTO :sNLSN FROM dual" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -    Set sEr="Невозможно сгенерировать счет начисл.%%!"
.head 9 -    Return -8
.head 8 -  ! Счет будущих расходов
.head 8 +    If cb_Amort
.head 9 +    If SqlPrepareAndExecute( hSql(), 
  " SELECT substr(bars.dpt.f_nls('NLS',:nMASKA,:nRNK,:sBSA,:nID,:dfVIDD),1,14) INTO :sNLSA FROM dual" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 10 -    Set sEr="Невозможно сгенерировать счет амортизации!"
.head 10 -    Return -9
.head 7 -    Set sNLS =Vkrz2(GetBankMfo(),sNLS)
.head 7 -    Set sNLSN=Vkrz2(GetBankMfo(),sNLSN)
.head 7 +    If cb_Amort 
.head 8 -    Set sNLSA=Vkrz2(GetBankMfo(),sNLSA)
.head 7 -  ! Генерация наименований счетов по разным маскам
.head 7 +    If sBSD='3320'
.head 8 +    If SqlPrepareAndExecute( hSql(), 
  " SELECT substr(bars.dpt.f_nls('NMS',:nMASKA,:nRNK,:sBSD,:nSERTIFICATE,:dfVIDD),1,38) INTO :sNMS FROM dual" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -    Set sEr="Невозможно сгенерировать наименование основного счета!"
.head 9 -    Return -10
.head 8 +    If SqlPrepareAndExecute( hSql(), 
  "SELECT substr(bars.dpt.f_nls('NMS',:nMASKA,:nRNK,:sBSN,:nSERTIFICATE,:dfVIDD),1,38) INTO :sNMSN FROM dual" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -    Set sEr="Невозможно сгенерировать наименование счета начисл.%%!"
.head 9 -    Return -11
.head 7 +    Else 
.head 8 +    If SqlPrepareAndExecute( hSql(), 
  " SELECT substr(bars.dpt.f_nls('NMS',:nMASKA,:nRNK,:sBSD,:nID,:dfVIDD),1,38) INTO :sNMS FROM dual" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -    Set sEr="Невозможно сгенерировать наименование основного счета!"
.head 9 -    Return -12
.head 8 +    If SqlPrepareAndExecute( hSql(), 
  "SELECT substr(bars.dpt.f_nls('NMS',:nMASKA,:nRNK,:sBSN,:nID,:dfVIDD),1,38) INTO :sNMSN FROM dual" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -    Set sEr="Невозможно сгенерировать наименование счета начисл.%%!"
.head 9 -    Return -13
.head 8 -  ! Счет будущих расходов
.head 8 +    If cb_Amort 
.head 9 +    If SqlPrepareAndExecute( hSql(), 
  " SELECT substr(bars.dpt.f_nls('NMS',:nMASKA,:nRNK,:sBSA,:nID,:dfVIDD),1,38) INTO :sNMSA FROM dual" ) 
AND NOT SqlFetchNext( hSql(), nFetchRes )
.head 10 -    Set sEr="Невозможно сгенерировать наименование счета амортизации!"
.head 10 -    Return -14
.head 7 -  !
.head 7 -  ! Открытие счетов 
.head 7 +    If NOT Op_Reg(99,0,0,nGRP,nTmp,nRNK,sNLS, dfKV,sNMS, "ODB",nISP,ACC) 
  OR NOT Op_Reg(99,0,0,nGRP,nTmp,nRNK,sNLSN,dfKV,sNMSN,"ODB",nISP,ACCN)
  OR (cb_Amort  AND 
     NOT Op_Reg(99,0,0,nGRP,nTmp,nRNK,sNLSA,n980,sNMSA,"ODB",nISP,ACCA))
.head 8 -    Set sEr="Невозможно открыть счет "||sNLS|| ' '||sNLSN|| IifS(cb_Amort, sNLSA,' ' )
.head 8 -    Return -15
.head 7 -  ! Капитализация начисленных %%
.head 7 +    If cb_Kapital
.head 8 -    Set sNLS_P=sNLS
.head 8 -    Set sMFO_P=GetBankMfo()
.head 8 -    Set sOKPO_P=sOKPO
.head 8 -    Set sNAME_P=sNMS
.head 8 -    Set dfFREQ=5
.head 7 -  ! Код операции по выплате %%
.head 7 +    If sTT3!=' ' AND sTT4!=''
.head 8 -    Set sTTB=IifS(sNLS_P=STRING_Null,'',IifS(sMFO_P=GetBankMfo(),sTT3,sTT4))
.head 7 +    Else 
.head 8 -    Set sTTB=IifS(sNLS_P=STRING_Null,'',IifS(sMFO_P=GetBankMfo(),'PS1','PS2'))
.head 7 -  ! Счет расходов но вкладам
.head 7 -    If SqlPrepareAndExecute(hSql(),
  "SELECT bars.f_proc_dr(:ACC,4,:dfVIDD,'DPT') INTO :nRASX FROM dual")
and SqlFetchNext(hSql(),nFetchRes)
.head 7 +    Else 
.head 8 -    Call SalMessageBox('Невозможно вычитать счет расходов! '|| SalNumberToStrX(dfVIDD,0), 'Внимание',0)
.head 8 -    Return -4
.head 7 -  ! Дата погашения
.head 7 +    If NOT SqlPrepareAndExecute(hSql(),"UPDATE accounts SET mdate=:dDAT_END WHERE acc=:ACC")
OR NOT SqlPrepareAndExecute(hSql(),"UPDATE accounts SET mdate=:dDAT_END WHERE acc=:ACCN")
OR NOT SqlPrepareAndExecute(hSql(),"UPDATE accounts SET mdate=:dDAT_END WHERE acc=:ACCA")
.head 8 -    Set sEr="Невозможно проставить дату закрытия"
.head 8 -    Return -16
.head 7 +  ! If NOT SqlPrepareAndExecute( hSql(), 
       "UPDATE accounts SET mdate=:dDAT_END WHERE acc=:ACC or acc=:ACCN or acc=:ACCA")
.head 8 -    Set sEr="Невозможно проставить дату закрытия"
.head 8 -    Return -16
.head 7 -  ! --------------------------------------------------------------------------------
.head 7 -  ! Штраф
.head 7 +    If dfSTOP!=NUMBER_Null
.head 8 +    If SqlPrepareAndExecute( hSql(),"SELECT acc FROM dpt_stop_acc WHERE acc=:ACC")
AND SqlFetchNext(hSql(),nFetchRes)
.head 9 -    Call SqlPrepareAndExecute( hSql(),"UPDATE dpt_stop_acc SET dpt_stop=:dfSTOP WHERE acc=:ACC")
.head 8 +    Else 
.head 9 -    Call SqlPrepareAndExecute( hSql(),"INSERT INTO dpt_stop_acc(acc,dpt_stop) VALUES (:ACC,:dfSTOP)")
.head 7 -  ! Срок пополнения
.head 7 +    If dfADD!=NUMBER_Null AND dfADD!=0
.head 8 +    If SqlPrepareAndExecute( hSql(),"SELECT acc FROM dpt_stop_acc WHERE acc=:ACC")
AND SqlFetchNext(hSql(),nFetchRes)
.head 9 -    Call SqlPrepareAndExecute( hSql(),"UPDATE dpt_stop_acc SET dpt_term_add=:dfADD WHERE acc=:ACC")
.head 8 +    Else 
.head 9 -    Call SqlPrepareAndExecute( hSql(),"INSERT INTO dpt_stop_acc(acc,dpt_term_add) VALUES (:ACC,:dfADD)")
.head 7 -  ! Процент суммы част.снятия со вклада
.head 7 +    If dfMINUS_SUM!=NUMBER_Null AND dfMINUS_SUM!=0
.head 8 +    If SqlPrepareAndExecute( hSql(),"SELECT acc FROM dpt_stop_acc WHERE acc=:ACC")
AND SqlFetchNext(hSql(),nFetchRes)
.head 9 -    Call SqlPrepareAndExecute( hSql(),"UPDATE dpt_stop_acc SET dpt_payout_proc=:dfMINUS_SUM WHERE acc=:ACC")
.head 8 +    Else 
.head 9 -    Call SqlPrepareAndExecute( hSql(),"INSERT INTO dpt_stop_acc(acc,dpt_payout_proc) VALUES (:ACC,:dfMINUS_SUM)")
.head 7 -  ! Макс.допустимое кол-во част.снятий со вклада
.head 7 +    If dfMINUS_COUNT!=NUMBER_Null
.head 8 +    If SqlPrepareAndExecute( hSql(),"SELECT acc FROM dpt_stop_acc WHERE acc=:ACC")
AND SqlFetchNext(hSql(),nFetchRes)
.head 9 -    Call SqlPrepareAndExecute( hSql(),"UPDATE dpt_stop_acc SET dpt_payout_count=:dfMINUS_COUNT WHERE acc=:ACC")
.head 8 +    Else 
.head 9 -    Call SqlPrepareAndExecute( hSql(),"INSERT INTO dpt_stop_acc(acc,dpt_payout_count) VALUES (:ACC,:dfMINUS_COUNT)")
.head 7 -  ! Дата досрочного расторжения (только для Петрокоммерцбанка)
.head 7 +    If GetGlobalOptionEx('VKL_MASK')=2
.head 8 +    If SqlPrepareAndExecute( hSql(),
  "SELECT count(*) INTO :nTmp FROM dpt_stop_acc WHERE acc=:ACC")
and SqlFetchNext(hSql(),nFetchRes)
.head 9 -    If SqlPrepareAndExecute(hSql(),
   "UPDATE dpt_stop_acc SET dpt_early_end=to_date(:dDAT_END_TRUE,'dd/MM/yyyy') WHERE acc=:ACC")
.head 8 +    Else 
.head 9 -    Call SqlPrepareAndExecute( hSql(),
   "INSERT INTO dpt_stop_acc(acc,dpt_earle_end) VALUES (:ACC,to_date(:dDAT_END_TRUE,'dd/MM/yyyy'))")
.head 7 -  ! --------------------------------------------------------------------------------
.head 7 -  ! KL_R011
.head 7 +    If SqlPrepareAndExecute( hSql(),
  "SELECT r011 INTO :nTmp FROM bars.kl_r011 WHERE r020r011=:sBSD AND r020=:sBSN")
and SqlFetchNext(hSql(),nFetchRes)
.head 8 -    If SqlPrepareAndExecute( hSql(),"UPDATE specparam SET r011=:nTmp WHERE acc=:ACCN ")
.head 7 +    Else 
.head 8 -    Call SqlPrepareAndExecute( hSql(),"INSERT INTO specparam (acc,r011) VALUES (:ACCN,:nTmp)")
.head 7 -  ! Спецпараметры для перекрытия 
.head 7 +    If SqlPrepareAndExecute( hSql(),
   "SELECT idg, ids INTO :nIDG,:nIDS  FROM dpt_vidd  
    WHERE vidd=:dfVIDD AND idg IN (SELECT idg FROM perekr_g) AND ids IN (SELECT ids FROM perekr_s)") 
AND SqlFetchNext(hSql(),nFetchRes)
.head 8 +    If SqlPrepareAndExecute( hSql(),"SELECT acc FROM specparam WHERE acc=:ACCN ")
AND SqlFetchNext(hSql(),nFetchRes)
.head 9 -    Call SqlPrepareAndExecute( hSql(),"UPDATE specparam SET idg=:nIDG,ids=:nIDS,sps=1 WHERE acc=:ACCN ")
.head 8 +    Else 
.head 9 -    Call SqlPrepareAndExecute( hSql(),"INSERT INTO specparam(acc,idg,ids,sps) VALUES (:ACCN,:nIDG,:nIDS,1)")
.head 7 -  ! Авансовый вклад
.head 7 +    If cb_Amort 
.head 8 +    If NOT SqlPrepareAndExecute( hSql(),
      "INSERT INTO int_accn(acc,id,tt,metr,io,basey,basem,freq,acr_dat,stp_dat,acra,acrb) 
            VALUES (:ACCA,0,:sTT,4,:nTIPOST,:nBASEY,:0,1,:dDAT_BEGIN,:dDAT_END,:ACCA,:nRASX)")
.head 9 -    Set sEr="Невозможно завести процентную карточку для счета "||sNLSA
.head 9 -    Return -17
.head 8 -    Set nRASX=ACCA
.head 7 -  ! Процентная карточка
.head 7 -    Set dDAT1=dDAT_BEGIN-1
.head 7 +    If SqlPrepareAndExecute(hSql(),"SELECT acc FROM int_accn WHERE acc=:ACC and id=1") 
AND NOT SqlFetchNext(hSql(),nFetchRes)
.head 8 -    Call SqlPrepareAndExecute(hSql(),"INSERT INTO int_accn (id,acc) VALUES (1,:ACC)")
.head 7 +    If not SqlPrepareAndExecute( hSql(),
       "UPDATE int_accn SET 
            tt=:sTT, metr=:nMETR, io=:nTIPOST, basey=:nBASEY, basem=0, freq=:nFREQN,
            acr_dat=:dDAT1, stp_dat=:dSTOP, acrb=:nRASX, acra=:ACCN, 
            kvb=:dfKV, nlsb=:sNLS_P, mfob=:sMFO_P, namb=:sNAME_P, ttb=:sTTB     
        WHERE acc=:ACC and id=1") 
.head 8 -    Set sEr="Нeуспешная запись процентной карточки"
.head 8 -    Return -18
.head 7 -  ! Запись ИНДИВИДУАЛЬНОЙ процентной ставки
.head 7 +    If SqlPrepareAndExecute(hSql(),"SELECT acc FROM int_ratn WHERE acc=:ACC and id=1 and bdat=:dDAT_BEGIN ")
.head 8 +    If SqlFetchNext(hSql(),nFetchRes)
.head 9 -    Set sTmp="UPDATE int_ratn SET br=NULL, ir=:dfRATE_REAL WHERE acc=:ACC and id=1 and bdat=:dDAT_BEGIN"
.head 8 +    Else 
.head 9 -    Set sTmp="INSERT INTO int_ratn (id,acc,bdat,ir) VALUES (1,:ACC,:dDAT_BEGIN,:dfRATE_REAL )"
.head 8 +    If not SqlPrepareAndExecute( hSql(),sTmp) 
.head 9 -    Set sEr="Нeуспешная запись процентной ставки"
.head 9 -    Return -19
.head 7 +    Else 
.head 8 -    Set sEr="Невозможно прочитать int_ratn для acc="|| SalNumberToStrX(ACC,0)
.head 8 -    Return -20
.head 7 -  ! Запись ставки пролонгации
.head 7 +    If nBR_ID_L >0 and dSTOP=DATETIME_Null
.head 8 +    If SqlPrepareAndExecute(hSql(),"SELECT acc FROM int_ratn WHERE acc=:ACC and id=1 and bdat=:dDAT_END ")
.head 9 +    If SqlFetchNext(hSql(),nFetchRes)
.head 10 -    Set sTmp="UPDATE int_ratn SET br=:nBR_ID_L WHERE acc=:ACC and id=1 and bdat=:dDAT_END "
.head 9 +    Else 
.head 10 -    Set sTmp="INSERT INTO int_ratn (id,acc,bdat,br) VALUES (1,:ACC,:dDAT_END,:nBR_ID_L )"
.head 9 +    If not SqlPrepareAndExecute( hSql(),sTmp) 
.head 10 -    Set sEr="Нeуспешная запись ставки пролонгации"
.head 10 -    Return -21
.head 7 -  ! Открываем депозитный договор 
.head 7 -    If SqlPrepareAndExecute(hSql(),
  "INSERT INTO dpt_deposit 
       (deposit_id,rnk,vidd,kv,acc,freq, limit,comments,
        datz,dat_begin,dat_end, mfo_p,nls_p,name_p,okpo_p) 
   VALUES 
       (:nID,:nRNK,:dfVIDD,:dfKV,:ACC,:dfFREQ,:nMIN_SUM,:sCOMMENT,
        :dDATZ,:dDAT_BEGIN,:dDAT_END,:sMFO_P,:sNLS_P,:sNAME_P,:sOKPO_P )")
.head 7 +    Else 
.head 8 -    Set sEr="Невозможно открыть договор"
.head 8 -    Return -22
.head 7 +    If sNLS_Perekr!=STRING_Null
.head 8 -    Set sMFO_Perekr=GetBankMfo(  )
.head 8 -    If SqlPrepareAndExecute(hSql(),
  "UPDATE dpt_deposit SET 
         mfo_d = :sMFO_Perekr, 
         nls_d = :sNLS_Perekr, 
         nms_d = :sNAME_Perekr
   WHERE deposit_id = :nID ")
.head 6 +    Else 
.head 7 -    Call SalMessageBox('Невозможно прочитать параметры вида вклада '|| SalNumberToStrX(dfVIDD,0),'Внимание',0)
.head 7 -    Return -23
.head 6 -    Return nID
.head 2 +    Window Parameters 
.head 3 -    Number: dfVIDD
.head 3 -    Number: nDURATION_M
.head 3 -    Number: nDURATION_D
.head 3 -    Number: nRNK
.head 3 -    Date/Time: dDATZ
.head 3 -    Date/Time: dDAT_END
.head 3 -    Number: nGRP
.head 3 -    Number: nISP
.head 3 -    String: sTT3
.head 3 -    String: sTT4
.head 3 -    String: sCOMMENT
.head 3 -    String: sNLS_Perekr
.head 3 -    String: sNAME_Perekr
.head 2 +    Window Variables 
.head 3 -    Number: nFetchRes
.head 3 -    Number: nFreq
.head 3 -    String: sFreq
.head 3 -    Date/Time: dDAT_END_TRUE
.head 3 -    Number: nID
.head 3 -    String: sEr
.head 3 -  !
.head 3 -    String: sNLS
.head 3 -    String: sNLSN
.head 3 -    String: sNLSA
.head 3 -  !
.head 3 -    String: sNLS_P
.head 3 -    String: sMFO_P
.head 3 -    String: sOKPO_P
.head 3 -    String: sNAME_P
.head 2 +    Message Actions 
.head 3 +    On SAM_Create
.head 4 -    Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -    Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTWndTitle'))
.head 4 -    Call PrepareWindowEx(hWndForm)
.head 4 -    Call XSalTooltipSetUserDefault()
.head 4 -  !
.head 4 -  ! Для Петрокоммерцбанка срок вклада преобразуем в 370 дней,а для остальных - тем, что ввели
.head 4 -  ! nDURATION_M ---> dfDUR_M     
.head 4 -  ! nDURATION_D ---> dfDUR_D
.head 4 -  !
.head 4 +    If (nDURATION_M=0 OR nDURATION_M=NUMBER_Null) AND nDURATION_D>370
.head 5 -    Set dfDUR_D=1000
.head 5 -    Set dfDUR_M=0
.head 4 +    Else 
.head 5 -    Set dfDUR_M=IifN(nDURATION_M=NUMBER_Null,0,nDURATION_M)
.head 5 -    Set dfDUR_D=IifN(nDURATION_D=NUMBER_Null,0,nDURATION_D)
.head 4 -  ! ------------- Петрокоммерцбанк --------------------------
.head 4 -    Set dDAT_END_TRUE=dDAT_END
.head 4 -  ! Для Петрокоммерцбанка - это дата досрочного расторжения
.head 4 +    If GetGlobalOptionEx('VKL_MASK')=2
.head 5 -    Set dDAT_END=GetBankDate(  )+IifN(dfDUR_D=1000,nDURATION_D,370)
.head 5 -  ! Set dfDURATION=Str(IifN(dfDUR_D=1000,nDURATION_D,370))||' дн.'
.head 5 -    Set dfDURATION=Str(IifN(dfDUR_D=1000,nDURATION_D,370))||' '||CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTInDay')
.head 4 +    Else 
.head 5 -  ! Set dfDURATION=IifS(dfDUR_M!=NUMBER_Null AND dfDUR_M!=0,Str(dfDUR_M)||' мес.','' )||
               IifS(dfDUR_D!=NUMBER_Null AND dfDUR_D!=0,Str(dfDUR_D)||' дн.','' )
.head 5 -    Set dfDURATION=IifS(dfDUR_M!=NUMBER_Null AND dfDUR_M!=0,Str(dfDUR_M)||' '||CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTInMonth'),'' )||
               IifS(dfDUR_D!=NUMBER_Null AND dfDUR_D!=0,Str(dfDUR_D)||' '||CurrentLangTable.GetAtomTitle('frm_IndiVidd.cTInDay'),'' )
.head 4 -  ! ----------------------------------------------------------
.head 4 -    Call F_POPULATE()
.head 4 -    Call SalMapEnterToTab( TRUE )
.head 1 +  Table Window: AcrPay             
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выплата  %%
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.35"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Sky
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 1000
.head 3 -  Discardable? No
.head 2 -  Description: Выплата процентов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 30623
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.533"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  4.533"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 30624
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.233"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  5.233"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set sFilt = ''
.head 7 +  If SetQueryFilter( cF )
.head 8 +  If cF.GetFilterWhereClause( FALSE )
.head 9 -  Set sFilt = 'AND '|| cF.GetFilterWhereClause( FALSE )
.head 8 +  If cF.GetFilterFromClause( FALSE )
.head 9 -  Set sAddFrom = ', '|| cF.GetFilterFromClause( FALSE )
.head 7 -  Call SalSendMsg(hWndForm,UM_Populate,0,0)
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 30625
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 30626
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbRun
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.017"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выполнить проводки
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('AcrPay.cBTipRun')
.head 6 +  On SAM_Click
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  Loop
.head 8 +  If SalTblFindNextRow(AcrPay, nRow, ROW_Selected, ROW_MarkDeleted)
.head 9 -  Call SalTblSetContext (AcrPay, nRow)
.head 9 -  Call SalTblSetFocusRow(AcrPay, nRow)
.head 9 -  Call SalTblSetRowFlags(AcrPay, nRow, ROW_Selected, TRUE)
.head 9 +  If nRow >= 0 
.head 10 +  If SqlPrepareAndExecute(hSql(),
  "SELECT apl_dat INTO :dDatApl 
     FROM int_accn 
    WHERE acc = :AcrPay.ACC AND id = 1 
      FOR UPDATE OF acc NOWAIT") AND
   SqlFetchNext(hSql(),nFetchRes)
.head 11 +  If not dDatApl or dDatApl <= dDat
.head 12 +  If SqlPrepareAndExecute( hSql(),"
   UPDATE int_accn SET apl_dat = :dDat WHERE acc = :AcrPay.ACC AND id = 1")
.head 13 -  Set nRef = NUMBER_Null
.head 13 +  If SR100 != 0
.head 14 -  Call cDoc.SetDoc(nRef, TT,   DK,   VOB,  '', 
                 dDat, dDat, dDat, dDat,
                 NLSA, NMSA, MFOA, '',   KVA, SR100, OKPOA,
                 NLSB, NMKB, MFOB, '',   KVB, SR200, OKPOB, 
                 NAZN, '',   GetIdOper(), '', NUMBER_Null, 0)
.head 14 +  If not cDoc.oDoc()
.head 15 -  Call SqlRollback(hSql())
.head 15 -  Break
.head 12 +  Else
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Break
.head 12 -  Call SqlCommit(hSql())
.head 10 +  Else
.head 11 -  Call SqlRollback(hSql())
.head 8 +  Else
.head 9 -  Break
.head 8 -  Call SalTblSetRowFlags(AcrPay, nRow, ROW_Selected, FALSE)
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 2 +  Contents
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № 
вклада
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 35
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Д/К
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
оп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sUnHide = '1'
.head 7 -  Call SalEnableWindow( hWndItem )
.head 3 +  Column: NLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВАЛ
А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отправитель
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 38
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
отправителя
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО 
получат.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SR100	! Сумма -1 в коп.
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
документа
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SR	! Сумма -1 с разделителем числ.
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
документа
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sUnHide = '1'
.head 7 -  Call SalEnableWindow( hWndItem )
.head 5 +  On SAM_Validate
.head 6 -  Set SR100 = SR*SalNumberPower(10,DIG)
.head 3 +  Column: sSR	! Строка-1 с разделителем симв.
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
документа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If sUnHide = '1'
.head 7 -  Call SalEnableWindow( hWndItem )
.head 5 +  On SAM_Validate
.head 6 -  Set SR = Val(sSR)
.head 6 -  Set SR100 = SR*SalNumberPower(10,DIG)
.head 3 +  Column: MFOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО 
получат.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет получателя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВАЛ
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Получатель
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 38
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
получат.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SR200	! Сумма-2 в коп.
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
документа
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назначение платежа
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DIG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DIG
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_IntPay
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Date/Time: dDat      ! дата выплаты %%
.head 5 -  String: sFilt        ! фильтр
.head 5 -  String: sAddFrom     ! список "внешних" таблиц
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPLSQLCommand(hSql(), "bars.dpt.p_intpay (nUserId, dDat, 'S', sFilt)")
.head 6 -  Call SqlCommit(hSql())
.head 5 +  Else
.head 6 -  Call Debug('Ошибка при выполнении процедуры dpt.p_intpay')
.head 6 -  Call SqlRollback(hSql())
.head 2 +  Window Parameters
.head 3 -  ! не исп. (пока 1)
.head 3 -  Number: nPar
.head 3 -  ! внешний фильтр
.head 3 -  String: sFiltP
.head 3 -  ! возможность корректировать код и сумму операции (пока 1)
.head 3 -  String: sUnHide
.head 3 -  ! коді операций для выплаты (не исп.)
.head 3 -  String: sTT_P
.head 2 +  Window Variables
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  Number: nRow
.head 3 -  Number: nUserId
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  Date/Time: dDat
.head 3 -  Date/Time: dDatApl
.head 3 -  Number: nFetchRes
.head 3 -  Number: nRef
.head 3 -  Number: nTmp
.head 3 -  Number: nSumD
.head 3 -  Number: nRowC
.head 3 -  String: sFilt
.head 3 -  String: sAddFrom
.head 3 -  Number: nMaxDig
.head 3 -  Number: nLastSortRow
.head 3 -  Number: nSortOrder
.head 3 -  Window Handle: hColumn
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('AcrPay.cTWndTitle'))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  Set dDat = GetBankDate()
.head 4 -  Set nUserId = GetUserId(  )
.head 4 -  Set AcrPay.nFlags = GT_NoRet | GT_NoIns 
.head 4 -  Set AcrPay.nTabInstance = 1
.head 4 -  Call cF.Init('DPT_1', 'd')
.head 4 -  Set AcrPay.strPrintFileName = 'ACR_PAY'
.head 4 -  !
.head 4 -  Set AcrPay.strSqlDelete =
   "DELETE FROM tmp_intpay WHERE id = USER_ID AND dpt_id = :AcrPay.ID"
.head 4 -  Set AcrPay.strSqlUpdate =
   "UPDATE int_accn SET nazn = :AcrPay.NAZN WHERE acc = :AcrPay.ACC"
.head 4 -  Set AcrPay.strSqlPopulate=
   "SELECT dpt_id, nd, dk, vob, tt, 
           mfoa, nlsa, nmsa, okpoa, kva, s,
           mfob, nlsb, nmsb, okpob, kvb, s2,  
           nazn, acc,  dig
      INTO :AcrPay.ID,   :AcrPay.ND,   :AcrPay.DK,   :AcrPay.VOB,   :AcrPay.TT,
           :AcrPay.MFOA, :AcrPay.NLSA, :AcrPay.NMSA, :AcrPay.OKPOA, :AcrPay.KVA, :AcrPay.SR100,
           :AcrPay.MFOB, :AcrPay.NLSB, :AcrPay.NMKB, :AcrPay.OKPOB, :AcrPay.KVB, :AcrPay.SR200,
           :AcrPay.NAZN, :AcrPay.ACC,  :AcrPay.DIG
      FROM tmp_intpay
     WHERE id = USER_ID
     ORDER BY 1" 
.head 4 -  !
.head 4 +  If DigInit() != -1
.head 5 -  Set nMaxDig = DigInit()
.head 4 +  Else
.head 5 -  Set nMaxDig = 4
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalEnableWindow(pbFilter)
.head 4 -  Call SalSendMsg(AcrPay.pbFilter, SAM_Click, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set SR = SR100/SalNumberPower(10, DIG)
.head 4 -  Set SR = SalNumberAbs(SR)
.head 4 -  Set sSR = Dig4(SR100/100, DIG, nMaxDig)
.head 4 -  ! формирование итогов
.head 4 -  Set nRowC = nRowC+1
.head 4 -  Set nSumD = nSumD + AcrPay.SR
.head 3 +  On UM_Populate
.head 4 -  Set nRowC = 0
.head 4 -  Set nSumD = 0
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call F_IntPay(dDat, sFiltP||' '||sFilt, sAddFrom)
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  ! итоговая строка
.head 4 -  Call SalTblDefineSplitWindow (hWndForm, 1, TRUE)
.head 4 -  Set nTmp = SalTblInsertRow ( hWndForm, TBL_MinRow)
.head 4 -  Call SalTblSetContext (hWndForm, nTmp)
.head 4 -  Call SalTblSetRowFlags(hWndForm, nTmp, ROW_New, FALSE)
.head 4 -  Call SalTblSetRowFlags(hWndForm, nTmp, ROW_UnusedFlag2, TRUE)
.head 4 -  Set AcrPay.VOB = nRowC
.head 4 -  Set AcrPay.SR  = nSumD
.head 4 -  Set AcrPay.sSR = Str(nSumD)
.head 3 +  On UM_DoubleClick
.head 4 +  If NOT SalIsNull(AcrPay.ID) 
.head 5 -  Call SalCreateWindow(frm_AcrPay, hWndMDI, AcrPay.ID, hWndForm)
.head 3 +  On UM_Update
.head 4 -  Set nRow = TBL_MinRow
.head 4 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow )
.head 5 -  Set nRowC = nRowC - 1
.head 5 -  Set nSumD = nSumD - AcrPay.SR
.head 5 -  Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
.head 4 -  Set nRow = TBL_MinRow  
.head 4 +  If SalTblFindNextRow(hWndForm, nRow, ROW_UnusedFlag2, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow )
.head 5 -  Set AcrPay.VOB = nRowC
.head 5 -  Set AcrPay.SR = nSumD
.head 5 -  Call SalSendClassMessage( UM_Update, 0, 0 )
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor (TRUE)
.head 4 +  If wParam != nLastSortRow
.head 5 -  Set nLastSortRow = wParam
.head 5 -  Set nSortOrder = TBL_SortIncreasing
.head 4 +  Else
.head 5 -  Set nSortOrder = 1 - nSortOrder
.head 4 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 4 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 4 -  ! сортировка строковых столбцов по числовым
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sSR), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(SR), COL_GetID))
.head 4 -  !
.head 4 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 4 -  Call SalTblSortRows( hWndForm, SalTblQueryColumnID(hColumn), nSortOrder)
.head 4 -  Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Form Window: CB_VVOD1
.head 2 -  Class: cDocW
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.15"
.head 4 -  Top:    0.958"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPayDoc 
.head 5 -  Class Child Ref Key: 27
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! Первичный взнос(=0)
.head 7 -  ! Пополнение (=1)
.head 7 -  ! Расход с основного счета(=2)
.head 7 -  ! или со счета начисл.%%(=3,33,4)
.head 7 +  If (nOpId=0 OR nOpId=1 OR nOpId=2 OR  nOpId=4 OR nOpId =3 OR nOpId =33) 
.head 8 +  If (nOpId=2 OR nOpId=3 OR nOpId=4)
.head 9 +  If Tiket()
.head 10 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 8 +  Else If nOpId=0
.head 9 +  If dfSumC < MINS AND MINS > 0 
.head 10 -  ! Минимальная сумма вклада = <...> Продолжить?
.head 10 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('CB_VVOD1.cTMessPayDocOpId0') || ' = '|| SalNumberToStrX(MINS,2)||' '||IifS(dfKvA='UAH','грн',dfKvA)||'.'|| PutCrLf()||
   CurrentLangTable.GetAtomTitle('cTContinue'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo | MB_IconQuestion)=IDYES
.head 11 +  If Tiket()
.head 12 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 9 +  Else
.head 10 +  If Tiket()
.head 11 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 8 +  Else If nOpId=1
.head 9 +  If dfSumC < MINS AND MINS>0 
.head 10 -  ! Минимальный дополнит.взнос = <...> Продолжить?
.head 10 -  If SalMessageBox(CurrentLangTable.GetAtomTitle('CB_VVOD1.cTMessPayDocOpId1') || ' = '|| SalNumberToStrX(MINS,2)||' '||IifS(dfKvA='UAH','грн',dfKvA)||'.'|| PutCrLf()||
   CurrentLangTable.GetAtomTitle('cTContinue'),
   CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo | MB_IconQuestion)=IDYES
.head 10 +  If Tiket()
.head 11 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 9 +  Else
.head 10 +  If Tiket()
.head 11 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 8 +  Else If nOpId=33 
.head 9 +  If MINS > 0 
.head 10 +  If dfSumC > MINS
.head 11 -  ! Сумма платежа не может превышать <...>
.head 11 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('CB_VVOD1.cTMessPayDocOpId33') || ' '||SalNumberToStrX(MINS,2)||' '||IifS(dfKvA='UAH','грн',dfKvA)||'.',
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconInformation)
.head 10 +  Else
.head 11 +  If Tiket()
.head 12 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 9 +  Else
.head 10 +  If Tiket()
.head 11 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 7 +  Else If nOpId=22
.head 8 +  If Tiket()
.head 9 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 7 +  Else
.head 8 +  If Tiket()
.head 9 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 7 +  If bRet
.head 8 -  Set nMASKA=SalStrToNumber( GetGlobalOption('VKL_MASK') )
.head 8 +  If nOpId != 0 AND nOpId != 3 AND nOpId != 4 AND nOpId != 33
.head 9 -  Call SalEnableWindow( pbDoc )
.head 8 -  Set nREF=CB_VVOD1.m_nRef
.head 7 +  If bRet AND CB_VVOD1.m_nRef 
.head 8 +  If (nOpId!=0 AND nOpId!=3 AND nOpId!=4 AND nOpId!=33) 
.head 9 +  If SqlPrepareAndExecute( hSql(),
  "INSERT into operw (ref,tag,value) 
   VALUES (:CB_VVOD1.m_nRef,'N_DEP',:nDPT)" )    
.head 10 -  Call SqlCommit( hSql() )
.head 9 +  Else
.head 10 -  Call SqlRollback( hSql() )
.head 10 -  ! Невозможно вставить запись в таблицу OPERW
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('CB_VVOD1.cTMessPayDocInsert'),
     CurrentLangTable.GetAtomTitle('cTAt'),MB_IconInformation)
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrtDoc
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61962
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text:
.head 5 -  Resource Id: 61963
.head 5 -  Class Child Ref Key: 75
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 61964
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 61965
.head 5 -  Class Child Ref Key: 59
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfZn
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfOst
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewDoc
.head 5 -  Class Child Ref Key: 53
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewTTs
.head 5 -  Class Child Ref Key: 60
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDocBal
.head 5 -  Class Child Ref Key: 72
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 62
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSaveKor
.head 5 -  Class Child Ref Key: 64
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61966
.head 5 -  Class Child Ref Key: 77
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbHotVytyag
.head 5 -  Class Child Ref Key: 138
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotName
.head 5 -  Class Child Ref Key: 137
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotFio
.head 5 -  Class Child Ref Key: 141
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDoc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.51"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Печать доп.соглашения
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('CB_VVOD1.cBTipDoc')
.head 6 +  On SAM_Click
.head 7 -  Call cdoc_ShowAllDocs( nDPT, CB_VVOD1 )
.head 4 +  Pushbutton: pbLocalD
.head 5 -  Class Child Ref Key: 148
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotOstat
.head 5 -  Class Child Ref Key: 150
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Combo Box: cmbVob
.head 4 -  Class Child Ref Key: 39
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text:
.head 4 -  Resource Id: 61957
.head 4 -  Class Child Ref Key: 36
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfNd
.head 4 -  Class Child Ref Key: 23
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDocD
.head 4 -  Class Child Ref Key: 22
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankA
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 50
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlat
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamA
.head 4 -  Class Child Ref Key: 7
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlatB
.head 4 -  Class Child Ref Key: 9
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbA
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.head 4 -  Class Child Ref Key: 13
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call CB_VVOD1.UnHideIt( hWndItem )
.head 6 +  If CB_VVOD1.nFli = 0 or CB_VVOD1.nFli = 2  ! Если Внутренние или SWIFT
.head 7 -  Set CB_VVOD1.dfBankB = GetBankMfo()
.head 7 -  Call CB_VVOD1.HideIt( hWndItem )
.head 6 +  Else
.head 7 +  If SalStrLength(CB_VVOD1.sBankB)>0
.head 8 -  Set CB_VVOD1.dfBankB = CB_VVOD1.sBankB
.head 6 +  If SalStrLength(CB_VVOD1.dfBankB)>0
.head 7 -  Call SalSendMsg( hWndItem, SAM_Validate, 0, 0 )
.head 3 +  Data Field: dfPoluB
.head 4 -  Class Child Ref Key: 18
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbB
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 51
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On UM_Update
.head 6 -  Call SalSendClassMessage( UM_Update, 0, 0 )
.head 6 +  If NOT nKVK AND CB_VVOD1.nFlv != 0
.head 7 -  Call SalSendMsg( dfSumA, SAM_Validate, 0, 0 )
.head 3 +  Data Field: dfNlsB
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call CB_VVOD1.UnHideIt( hWndItem )
.head 6 +  If CB_VVOD1.sNlsB
.head 7 -  Set CB_VVOD1.dfNlsB=CB_VVOD1.sNlsB
.head 7 -  If CB_VVOD1.nOpId=6 or 
  SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Ok
.head 7 +  If s3 !=STRING_Null
.head 8 -  Set CB_VVOD1.dfNamB =s3
.head 6 +  Else If CB_VVOD1.bFixNlsB
.head 7 -  Set CB_VVOD1.dfNlsB=CB_VVOD1.sFixNlsB
.head 7 -  If SalSendMsg( hWndItem, SAM_Validate, 0, 0 )=VALIDATE_Ok
.head 7 -  Call CB_VVOD1.SetItsColo(CB_VVOD1.bFixNlsB,COLOR_LightGray,COLOR_Default)
.head 3 +  Data Field: dfPolu
.head 4 -  Class Child Ref Key: 17
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamB
.head 4 -  Class Child Ref Key: 16
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call CB_VVOD1.UnHideIt( hWndItem )
.head 6 -  If SalStrLength(CB_VVOD1.dfNamB )>=3 and not CB_VVOD1.bFixNlsB
.head 3 +  Data Field: dfSumNA
.head 4 -  Class Child Ref Key: 135
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumA
.head 4 -  Class Child Ref Key: 20
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If NOT SalIsNull( dfSumA ) AND dfSumA != 0
.head 7 +  If SalSendClassMessage( SAM_Validate, 0, 0 )
.head 8 -  Return VALIDATE_Ok
.head 6 -  Return VALIDATE_Cancel
.head 3 +  Data Field: dfSumNB
.head 4 -  Class Child Ref Key: 122
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Gray
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumB
.head 4 -  Class Child Ref Key: 21
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage(SAM_Create,0,0)
.head 6 +  If CB_VVOD1.nFlv AND CB_VVOD1.aFlg[59]
.head 7 -  Call CB_VVOD1.UnHideIt( hWndItem )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( hWndItem )
.head 3 +  Data Field: dfRatNomN
.head 4 -  Class Child Ref Key: 123
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNom
.head 4 -  Class Child Ref Key: 57
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call CB_VVOD1.DecPoint(hWndItem)
.head 6 +  If CB_VVOD1.aFlg[58]
.head 7 +  If not SalIsValidDecimal( hWndItem, 15, CB_VVOD1.nDigA )
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrNomFormat'),
                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If CB_VVOD1.sS and dfRatNom and not CB_VVOD1.bTotVal
.head 8 +  If CB_VVOD1.sS
.head 9 -  Set CB_VVOD1.nTmp=dfRatNom*SalNumberPower( 10, CB_VVOD1.nDigA )
.head 9 +  If CB_VVOD1.SumPoNom(CB_VVOD1.nTmp,CB_VVOD1.sS,CB_VVOD1.nTmp)
.head 10 +  If CB_VVOD1.nTmp>0
.head 11 -  Set dfSumC=CB_VVOD1.nTmp/SalNumberPower( 10, CB_VVOD1.nDigA )
.head 11 -  Call SalSetFieldEdit ( dfSumC, TRUE )
.head 11 -  Return SalSendMsg( dfSumC, SAM_Validate, 0, 0 )
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfSumNC
.head 4 -  Class Child Ref Key: 125
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumC
.head 4 -  Class Child Ref Key: 44
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call CB_VVOD1.UnHideIt( hWndItem )
.head 6 -  Set CB_VVOD1.dfSumC=nSumFact 
.head 6 -  Set CB_VVOD1.nS=nSumFact
.head 6 -  Set CB_VVOD1.dfSumA=dfSumC
.head 6 -  Call SalSendMsg( dfSumA, SAM_Validate, 0, 0 )
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 3 +  List Box: lb1
.head 4 -  Class Child Ref Key: 85
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Set CB_VVOD1.i=0
.head 6 -  Call SalArrayGetUpperBound( CB_VVOD1.aTag, 1, CB_VVOD1.nTmp ) 
.head 6 +  While CB_VVOD1.i < CB_VVOD1.nTmp
.head 7 -  Set CB_VVOD1.i = CB_VVOD1.i+1
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])='FIO'
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.i]=Val_FIO
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])='PASP'
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.i]=Val_PASP
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])='PASPN'
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.i]=Val_PASPN
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])='PASP1' or
   SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])='ATRT'
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.i]=Val_ATRT
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])='POKPO'
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.i]=Val_POKPO
.head 7 -  ! Если адрес и дата рождения обязат.реквизиты, то вытянем и их
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])='ADRS'   OR
   SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])='ADRES'
.head 8 -  Call SqlPrepareAndExecute( hSql(), 
    "SELECT count(*) INTO :nAdrM FROM op_rules 
     WHERE tt=:CB_VVOD1.sTT AND opt='M' AND 
           tag='"||SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])||"'")
.head 8 +  If SqlFetchNext( hSql(), nFetchRes )
.head 9 +  If nAdrM>0
.head 10 -  Call SqlPrepareAndExecute( hSql(), 
    "SELECT c.adr INTO :sAdrM FROM customer c, dpt_deposit d
     WHERE c.rnk=d.rnk AND d.deposit_id=:CB_VVOD1.nDPT" )
.head 10 +  If NOT SqlFetchNext( hSql(), nFetchRes )
.head 11 -  Set sAdrM=''
.head 10 +  Else
.head 11 -  Set CB_VVOD1.aVal[CB_VVOD1.i]=sAdrM
.head 8 +  Else
.head 9 -  Set nAdrM=0
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])='DOBR'   OR
   SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])='DT_R'
.head 8 +  If SqlPrepareAndExecute( hSql(), 
    "SELECT count(*) INTO :nBirM FROM op_rules 
     WHERE tt=:CB_VVOD1.sTT AND opt='M' AND 
           tag='"||SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])||"'") AND
NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Set nBirM=0
.head 8 +  If nBirM>0
.head 9 -  Call SqlPrepareAndExecute( hSql(), 
    "SELECT to_char(p.bday,'dd/MM/yyyy') INTO :sBirM 
     FROM person p, dpt_deposit d
     WHERE p.rnk=d.rnk AND d.deposit_id=:CB_VVOD1.nDPT" )
.head 9 +  If NOT SqlFetchNext( hSql(), nFetchRes )
.head 10 -  Set sBirM=''
.head 9 +  Else
.head 10 -  Set CB_VVOD1.aVal[CB_VVOD1.i]=sBirM
.head 7 -  !
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i])='METAL'
.head 8 +  If SqlPrepareAndExecute(hSql(), "SELECT trim(substr(dpt.f_dptw(:nDPT,'METAL'),1,500)) INTO :tMetal FROM dual") AND 
   SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set CB_VVOD1.aVal[CB_VVOD1.i] = tMetal
.head 6 -  Call SalListSetSelect( lb1, 0 )
.head 6 -  Call SalSendMsg( hWndItem, SAM_Click, 0, 0 )
.head 3 +  Multiline Field: dfNazn
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 6 -  ! Назначение по формуле
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
    "SELECT nazn INTO :sTmpND FROM tts WHERE trim(nazn) IS NOT NULL AND tt = :sTT2")
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set nPosND = SalStrScan(sTmpND, '#(ND)')
.head 7 +  While nPosND != -1
.head 8 -  Set sTmpND = SalStrReplaceX(sTmpND, nPosND, 5, Str(nDPT))
.head 8 -  Set nPosND = SalStrScan(sTmpND, '#(ND)')
.head 7 +  If SalStrTrimX(sTmpND)
.head 8 +  If not hWndForm.CB_VVOD1.sTranN(dfNazn, sTmpND, hWndForm.CB_VVOD1.sTT, 
  dfNlsA, dfBankA, hWndForm.CB_VVOD1.nKvA, dfSumA*SalNumberPower( 10, hWndForm.CB_VVOD1.nDigA),
  dfNlsB, dfBankB, hWndForm.CB_VVOD1.nKvB, dfSumB*SalNumberPower( 10, hWndForm.CB_VVOD1.nDigB),
  dfSk,   dfEquiv*100, NUMBER_Null)
.head 9 -  Call MessageErrorEx(CurrentLangTable.GetAtomTitle('CB_VVOD1.cTErrNazn') || ' '|| sTmpND)
.head 6 +  Else
.head 7 -  Set dfNazn = CB_VVOD1.sTTN
.head 6 -  !
.head 6 -  Set CB_VVOD1.aVal[0]=dfNazn
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalSendClassMessage(SAM_SetFocus, wParam, lParam)
.head 6 +  If SalStrTrimX(CB_VVOD1.aTag[SalListQuerySelection(lb1)]) = 'FIO'
.head 7 -  Set bTrustee = TRUE
.head 7 -  Call SalEnableWindow(pbHelp)
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalSendClassMessage(SAM_KillFocus, wParam, lParam)
.head 6 -  Set bTrustee = FALSE
.head 3 +  Data Field: dfSkN
.head 4 -  Class Child Ref Key: 115
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSk
.head 4 -  Class Child Ref Key: 48
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1
.head 4 -  Class Child Ref Key: 25
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2N
.head 4 -  Class Child Ref Key: 131
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2
.head 4 -  Class Child Ref Key: 66
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfD
.head 4 -  Class Child Ref Key: 132
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK
.head 4 -  Class Child Ref Key: 133
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUgrnt
.head 4 -  Class Child Ref Key: 130
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoA
.head 4 -  Class Child Ref Key: 139
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoB
.head 4 -  Class Child Ref Key: 140
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVytyagN
.head 4 -  Class Child Ref Key: 142
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquivN
.head 4 -  Class Child Ref Key: 144
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Gray
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquiv
.head 4 -  Class Child Ref Key: 145
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    1.405"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    1.333"
.head 6 -  Width:  1.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfLocDat
.head 4 -  Class Child Ref Key: 149
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateFrom
.head 4 -  Class Child Ref Key: 155
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNssA
.head 4 -  Class Child Ref Key: 159
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSlashD
.head 4 -  Class Child Ref Key: 162
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNssB
.head 4 -  Class Child Ref Key: 163
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSlashK
.head 4 -  Class Child Ref Key: 164
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1N
.head 4 -  Class Child Ref Key: 160
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1f
.head 4 -  Class Child Ref Key: 156
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic2f
.head 4 -  Class Child Ref Key: 157
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic3f
.head 4 -  Class Child Ref Key: 158
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: oDoc
.head 4 -  Description: Оплатить  документ !!!
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set bRet = cDocW.oDoc()
.head 5 -  Return bRet
.head 3 +  Function: Tiket
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  If SqlPrepareAndExecute(hSql(),
    "SELECT count(*) INTO :CB_VVOD1.nVOB 
     FROM  tts_vob WHERE tt=:CB_VVOD1.sTT " )
and SqlFetchNext(hSql(),nFetchRes)
.head 5 +  If nVOB>1
.head 6 -  ! Будет сформирован <название вида документа> Продолжить?
.head 6 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('CB_VVOD1.cTMessFormDoc') || ' "'||SalStrUpperX(CB_VVOD1.cmbVob)||'" !'||PutCrLf(  )||
'SumA = ' || Str(dfSumA) || ' SumB = ' || Str(dfSumB) || PutCrLf(  ) ||
   ' ' || CurrentLangTable.GetAtomTitle('cTContinue'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion|MB_YesNo)=IDNO
.head 7 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: NlsSubst
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: Nls
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp
.head 4 +  Actions
.head 5 +  If SalStrLeftX(Nls,2)='#('
.head 6 -  Call SqlPrepareAndExecute( hSql(), "SELECT SUBSTR("||SalStrMidX(Nls,2,SalStrLength(Nls)-3)||",1,14) INTO :sTmp FROM dual" )
.head 6 +  If SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Return sTmp
.head 5 -  Return Nls
.head 2 +  Window Parameters
.head 3 -  Number: nDPT     !! № депозита
.head 3 -  String: sTT2     !! код операции
.head 3 -  Number: nOpId    !! вид операции 
.head 3 -  Number: nKv      !! валюта
.head 3 -  String: sNd      !! № документа  
.head 3 -  Number: nSumFact !! фактическая сумма  
.head 3 -  Number: MINS     !! min сумма для DPA (>0)
.head 3 -  Number: nS2      !! сумма в вал.2
.head 3 -  String: sAccA    !! Счет А главный
.head 3 -  String: sAccB    !! Счет Б главный
.head 3 -  String: s1       !! МФО получателя
.head 3 -  String: s2       !! Счет получателя
.head 3 -  String: s3       !! Наименование получателя
.head 3 -  String: Tag_ATRT  
.head 3 -  String: Val_ATRT 
.head 3 -  String: Tag_FIO 
.head 3 -  String: Val_FIO 
.head 3 -  String: Tag_PASP
.head 3 -  String: Val_PASP
.head 3 -  String: Tag_PASPN
.head 3 -  String: Val_PASPN
.head 3 -  String: Tag_POKPO
.head 3 -  String: Val_POKPO
.head 2 +  Window Variables
.head 3 -  String: sA
.head 3 -  String: sB
.head 3 -  Long String: sErrMsg
.head 3 -  Boolean: bRet
.head 3 -  Number: nKV
.head 3 -  Number: Sum1
.head 3 -  Number: nVIDD
.head 3 -  Number: nFetchRes
.head 3 -  Number: nREF
.head 3 -  String: sT
.head 3 -  Number: nMASKA
.head 3 -  Number: nVOB
.head 3 -  Number: nUser
.head 3 -  Number: nKVK
.head 3 -  !
.head 3 -  Number: nAdrM
.head 3 -  Number: nBirM
.head 3 -  String: sAdrM
.head 3 -  String: sBirM
.head 3 -  Window Handle: hNextDF
.head 3 -  String: strSumPr
.head 3 -  Boolean: bTrustee
.head 3 -  String: sPk
.head 3 -  !
.head 3 -  String: tFIO
.head 3 -  String: tPASP
.head 3 -  String: tPASPN
.head 3 -  String: tATRT
.head 3 -  String: tDT_R
.head 3 -  String: tADR
.head 3 -  String: tOKPO
.head 3 -  Long String: tMetal
.head 3 -  !
.head 3 -  Number: nPosND
.head 3 -  String: sTmpND
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SalDisableWindow( pbDoc )
.head 4 -  Call SalSendClassMessage(SAM_Create,0,0)
.head 3 +  On UM_Choose
.head 4 -  Set CB_VVOD1.sTT= sTT2
.head 4 -  Set nUser = GetUserId(  )
.head 4 +  If SqlPrepareAndExecute(hSql(),
"SELECT name, flags, fli, flv, dk, sk, nlsb, nlsa, mfob, kvk, s
 INTO 
   :CB_VVOD1.sTTN,     :CB_VVOD1.sFlags, :CB_VVOD1.nFli,     :CB_VVOD1.nFlv,
   :CB_VVOD1.nDk,      :CB_VVOD1.nSk_TT, :CB_VVOD1.sNlsB_TT, :CB_VVOD1.sNlsA_TT,
   :CB_VVOD1.sBankB_TT,:CB_VVOD1.nKVK,   :CB_VVOD1.sS   
  FROM  tts  WHERE tt=:CB_VVOD1.sTT " )
and SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call Flgs2aFlg(sFlags)
.head 4 +  Else
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  ! Не описана операция <код операции>
.head 5 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('CB_VVOD1.cTMessTT') || " " || CB_VVOD1.sTT, 
     CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_Ok|MB_IconExclamation)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Set CB_VVOD1.sNlsA_TT=NlsSubst(SalStrTrimX(CB_VVOD1.sNlsA_TT))
.head 4 -  Set CB_VVOD1.sNlsB_TT=NlsSubst(SalStrTrimX(CB_VVOD1.sNlsB_TT))
.head 4 -  !
.head 4 +  If CB_VVOD1.nFlv = 0
.head 5 -  Set CB_VVOD1.nKvA_TT=nKv
.head 5 -  Set CB_VVOD1.nKvB_TT=nKv
.head 4 +  Else
.head 5 -  Set CB_VVOD1.nKvA_TT=nKv
.head 5 -  Set CB_VVOD1.nKvB_TT=nKVK
.head 4 -  !
.head 4 -  !
.head 4 +  If sAccA !=STRING_Null
.head 5 -  Set CB_VVOD1.sNlsA_TT=sAccA
.head 4 +  If sAccB != STRING_Null
.head 5 -  Set CB_VVOD1.sNlsB_TT=sAccB
.head 4 +  If s1 !=STRING_Null
.head 5 -  Set CB_VVOD1.sBankB_TT =s1
.head 4 +  If s2 !=STRING_Null
.head 5 -  Set CB_VVOD1.sNlsB_TT  =s2
.head 4 -  !
.head 4 -  ! Ввод документа <код операции>
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('CB_VVOD1.cTWndTitle') || ' - [ ' ||CB_VVOD1.sTTN|| ' ]' )
.head 4 -  Call SalSendClassMessage(UM_Clear, 0, 0)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 4 -  Call SalSendMsg( frm_Vklad.pbRefresh, SAM_Click, 0, 0 )
.head 3 +  On SAM_CreateComplete
.head 4 +  If aFlg[58] = 1 
.head 5 -  Call SalDisableWindow( dfSumC )
.head 4 +  If (nOpId=4 OR nOpId =3)
.head 5 +  If SalIsNull( dfOkpoB )
.head 6 -  Set dfOkpoB=sOKPO
.head 4 +  If SqlPrepareAndExecute( hSql(), "
  SELECT tt INTO :sT FROM op_rules WHERE tt=:CB_VVOD1.sTT2 AND tag='EVKAS' " ) AND
SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set dfDocD=SalDateCurrent(  )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On UM_CreateDoc
.head 4 +  If SqlPrepareAndExecute( hSql(), 
"SELECT vidd INTO :nVIDD FROM dpt_deposit WHERE deposit_id=:nDPT" ) 
AND SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Call CreateDepAddDoc( nDPT, nVIDD,'S' )
.head 3 +  On UM_HotAccountList
.head 4 -  Call SalSendClassMessage(UM_HotAccountList, 0, 0)
.head 4 +  If bTrustee
.head 5 +  If not FunNSIGetFiltered('TRUSTEE', 'FIO', 
" rnk=(SELECT d.rnk FROM dpt_deposit d
        WHERE d.deposit_id=" || Str(CB_VVOD1.nDPT) || ") 
  ORDER BY fio", sPk, sTmp)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If sPk != '' 
AND SqlPrepareAndExecute(hSql(), 
"SELECT t.fio, p.name, t.okpo, 
        trim(t.doc_serial||' '||t.doc_number), 
        trim(t.doc_issuer||' '||to_char(t.doc_date,'dd/MM/yyyy')), 
        to_char(t.birthday,'dd/MM/yyyy'), t.adr
   INTO :tFIO, :tPASP, :tOKPO, :tPASPN, :tATRT, :tDT_R, :tADR 
   FROM trustee t, passp p 
  WHERE t.id=" || sPk || " AND t.doc_type=p.passp") 
AND SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set dfNazn = sTmp
.head 6 -  Set dfOkpoA = tOKPO
.head 6 -  Set CB_VVOD1.i = 0
.head 6 -  Call SalArrayGetUpperBound(CB_VVOD1.aTag, 1, CB_VVOD1.nTmp)
.head 6 +  While CB_VVOD1.i < CB_VVOD1.nTmp
.head 7 -  Set CB_VVOD1.i = CB_VVOD1.i+1
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i]) = 'FIO'
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.i] = tFIO
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i]) = 'PASP'
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.i] = tPASP
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i]) = 'PASPN'
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.i] = tPASPN
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i]) = 'PASP1' 
OR SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i]) = 'ATRT'
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.i] = tATRT
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i]) = 'ADRS' 
OR SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i]) = 'ADRES'
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.i] = tADR
.head 7 +  If SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i]) = 'DOBR' 
OR SalStrTrimX(CB_VVOD1.aTag[CB_VVOD1.i]) = 'DT_R'
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.i] = tDT_R
.head 5 -  !
.head 5 -  Call SalSetFieldEdit(dfNazn, TRUE)
.head 5 -  Call SalSetFocus(dfNazn)
.head 1 +  Form Window: frm_Client
.head 2 -  Class: cFormWindowRs
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  13.533"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 1.524"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Вкладчик
.head 4 -  Resource Id: 60154
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.4"
.head 5 -  Top:    0.083"
.head 5 -  Width:  2.283"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMan_nm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: man_nm
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002000 42696C6C5F303109 42696C6C5F303209
0020: 42696C6C5F303309 42696C6C5F303400 000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.017"
.head 6 -  Top:    0.357"
.head 6 -  Width:  4.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Вклад №
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002000 42696C6C5F303109 42696C6C5F303209
0020: 42696C6C5F303309 42696C6C5F303400 000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17917
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.967"
.head 5 -  Top:    0.167"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDpt_id
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dpt_id
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.917"
.head 6 -  Top:    0.357"
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: РНК клиента
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002000 42696C6C5F303109 42696C6C5F303209
0020: 42696C6C5F303309 42696C6C5F303400 000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17918
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.867"
.head 5 -  Top:    0.167"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRegNk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: regNk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.983"
.head 6 -  Top:    0.357"
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Лицевой счет №
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002000 42696C6C5F303109 42696C6C5F303209
0020: 42696C6C5F303309 42696C6C5F303400 000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17916
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.083"
.head 5 -  Top:    0.179"
.head 5 -  Width:  1.567"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDpt_nls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dpt_nls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.017"
.head 6 -  Top:    0.357"
.head 6 -  Width:  1.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: № договора
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002000 42696C6C5F303109 42696C6C5F303209
0020: 42696C6C5F303309 42696C6C5F303400 000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 2625
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.583"
.head 5 -  Top:    0.179"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: nd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.583"
.head 6 -  Top:    0.357"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: № пасп/удост
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002000 42696C6C5F303109 42696C6C5F303209
0020: 42696C6C5F303309 42696C6C5F303400 000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17915
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.033"
.head 5 -  Top:    0.167"
.head 5 -  Width:  1.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAusv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: Ausv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.0"
.head 6 -  Top:    0.357"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Идент. код
.data CLASSPROPSSIZE
0000: 3300
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573002000 42696C6C5F303109 42696C6C5F303209
0020: 42696C6C5F303309 42696C6C5F303400 000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17919
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.6"
.head 5 -  Top:    0.167"
.head 5 -  Width:  1.683"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgId_cod
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: id_cod
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.6"
.head 6 -  Top:    0.357"
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: Poisk
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001800 42696C6C5F303109 42696C6C5F303209
0020: 42696C6C5F303300 000000
.enddata
.data CLASSPROPSSIZE
0000: 2B00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    0.036"
.head 5 -  Width:  0.429"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Поиск Клиента
.head 6 -  Set strTip =  CurrentLangTable.GetAtomTitle('frm_Client.cBTipPoisk')
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(frm_Kontr.Poisk, SAM_Click,wParam ,lParam)
.head 3 +  Pushbutton: pbNewK !! новый клиент
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    0.036"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Newrec.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Регистрация нового клиента
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Client.cBTipNewK')
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(frm_Kontr.pbNewK , SAM_Click,wParam ,lParam)
.head 3 +  Pushbutton: pbClear
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.917"
.head 5 -  Top:    0.036"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Очистить поля поиска
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Client.cBTipClear')
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(frm_Kontr.pbClear , SAM_Click,wParam ,lParam)
.head 3 +  Pushbutton: pbEnter
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbChilds
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.883"
.head 5 -  Top:    0.393"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set hWndFocused = SalGetFocus ( )
.head 6 +  If ( ComparehWnd(hWndFocused, man_nm)   or 
     ComparehWnd(hWndFocused, dpt_nls) or 
     ComparehWnd(hWndFocused, dpt_id) or 
     ComparehWnd(hWndFocused, id_cod) or
     ComparehWnd(hWndFocused, nd) or
     ComparehWnd(hWndFocused, regNk) or 
     ComparehWnd(hWndFocused, Ausv)    )
.head 7 -  Call SalSendMsg(Poisk, SAM_Click,0,0)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndCliName
.head 3 -  Window Handle: hWndFocused
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetFocus(man_nm)
.head 4 -  Set hWndCliName= man_nm
.head 1 +  Form Window: frm_tblButtn
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.567"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.631"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbCreate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbPrint
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.0"
.head 5 -  Top:    0.0"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Работа с текстами договоров
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_tblButtn.cBTipCreate')
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(frm_Kontr.pbCreate, SAM_Click,wParam,lParam)
.head 3 +  Pushbutton: pbEditK   !! старый клиент
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbEdit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.867"
.head 5 -  Top:    0.0"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Изменение/Просмотр реквизитов клиента
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_tblButtn.cBTipEditK')
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(frm_Kontr.pbEditK, SAM_Click,wParam,lParam)
.head 3 +  Pushbutton: pbNewV  !! новый договор
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.433"
.head 5 -  Top:    0.0"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Новый договор
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_tblButtn.cBTipNewV')
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(frm_Kontr.pbNewV, SAM_Click,wParam,lParam)
.head 3 +  Pushbutton: pbEditV     !! старый договор
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.3"
.head 5 -  Top:    0.0"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Действующий договор
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_tblButtn.cBTipEditV')
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(frm_Kontr.pbEditV, SAM_Click,wParam,lParam)
.head 3 +  Pushbutton: pbNewStud !! новый вклад студента
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.74"
.head 5 -  Top:    0.0"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\CHEKIN.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Новый договор Студенческий
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_tblButtn.cBTipNewStud')
.head 6 +  If GetGlobalOption( 'DPT_STUD' )
.head 7 -  Call SalEnableWindow( pbNewStud )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( pbNewStud )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(frm_Kontr.pbNewStud, SAM_Click,wParam,lParam)
.head 3 +  Check Box: cbShowCallDpt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Показывать вклады "На вимогу"
.head 4 -  Window Location and Size
.head 5 -  Left:   2.383"
.head 5 -  Top:    0.071"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set frm_Kontr.nShowCallDpt = IifN( cbShowCallDpt, 1, 0 )
.head 6 -  Call SalSendMsg( frm_Kontr.Poisk, SAM_Click, 0, 0 )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nShowCallDpt
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Флаг показа вкладов до востребования
.head 4 -  Set nShowCallDpt = GetGlobalOptionEx('DPT_SHOW')
.head 4 -  Set cbShowCallDpt = IifN( nShowCallDpt = 1, TRUE, FALSE )
.head 4 -  Set frm_Kontr.nShowCallDpt = nShowCallDpt
.head 1 +  Dialog Box: dlgSertificate
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Задайте номер сертификата:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  4.3"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.774"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: № сертификата:
.head 4 -  Resource Id: 2404
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.262"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 9
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.583"
.head 6 -  Top:    0.238"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfN!=Int(dfN) OR dfN<=0
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set nSertif=dfN
.head 7 -  Return VALIDATE_Ok
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.583"
.head 5 -  Top:    0.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgSertificate, FALSE )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Утвердить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgSertificate, TRUE )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Number: nSertif
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgSertificate.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set dfN = NUMBER_Null
.head 4 -  Call SalSetFocus(dfN)
.head 3 +  On SAM_Close
.head 4 -  Call SalEndDialog(hWndForm, FALSE)
.head 1 +  Dialog Box: dlgStudents
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выберите ВУЗ:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.9"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.631"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: ВУЗ:
.head 4 -  Resource Id: 44070
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.08"
.head 5 -  Top:    0.262"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgINST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfINST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 9
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    0.238"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmb_INST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.783"
.head 5 -  Top:    0.238"
.head 5 -  Width:  3.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.2"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmb_INST.Init( hWndItem )
.head 7 -  Call cmb_INST.Populate( hSql(), "di.id_inst", "c.nmk", "dpt_study_inst di, customer c", " WHERE di.rnk=c.rnk ORDER BY di.id_inst" )
.head 7 -  Call cmb_INST.SetSelectById( dfINST )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage ( SAM_Click, 0, 0 )
.head 6 -  Set dfINST  = cmb_INST.GetCurrentKey(  )
.head 6 -  Set nInst = dfINST
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.283"
.head 5 -  Top:    0.655"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nInst = NUMBER_Null
.head 6 -  Call SalEndDialog( dlgStudents, FALSE )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Утвердить
.head 4 -  Window Location and Size
.head 5 -  Left:   1.1"
.head 5 -  Top:    0.655"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgStudents, TRUE )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Number: nInst
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgStudents.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set dfINST = NUMBER_Null
.head 4 -  Call SalSetFocus(dfINST)
.head 3 +  On SAM_Close
.head 4 -  Call SalEndDialog(hWndForm, FALSE)
.head 1 +  Dialog Box: dlgShtraf
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Подробности расчета штрафа
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.2"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.321"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Расчет штрафа
.head 4 -  Resource Id: 55914
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.883"
.head 5 -  Top:    0.179"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDetails
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: mlDetails
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: Long String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.383"
.head 6 -  Top:    0.405"
.head 6 -  Width:  6.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbPrint
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledPrint
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Печать
.head 4 -  Window Location and Size
.head 5 -  Left:   1.183"
.head 5 -  Top:    3.405"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\PRINT.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sFile=GetPrnDir(  )||IifS(Right( GetPrnDir(  ),1 )='\\','','\\')||'Shtf'||Str(nDPT_ID)||'.txt'
.head 6 -  Call SalFileOpen( fH, sFile, OF_Delete )
.head 6 +  If SalFileOpen( fH, sFile, OF_Create|OF_ReadWrite )
.head 7 -  Set sBuffer= mlDetails||PutCrLf(  )
.head 7 +  If SalFileWrite( fH, sBuffer, Len(sBuffer) )!=Len(sBuffer)
.head 8 -  Call SalFileClose(fH)
.head 8 -  ! Ошибка записи файла <имя файла>
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgShtraf.cTErrFileWrite') || ' '||sFile, 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 8 -  Return FALSE
.head 7 -  Call SalFileClose(fH)
.head 7 -  ! Сформирован файл <имя файла>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgShtraf.cTMessFileForm') || ' '||sFile, 
     CurrentLangTable.GetAtomTitle('cTmessage'),  MB_IconInformation )
.head 7 -  Call DosDirectPrint( sFile )
.head 7 -  Call SalEndDialog( hWndForm, 0 )
.head 6 +  Else
.head 7 -  ! Невозможно открыть файл <имя файла>
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgShtraf.cTErrFileOpen') || ' '||sFile, 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.083"
.head 5 -  Top:    3.405"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgShtraf, TRUE )
.head 3 -  Frame
.head 4 -  Resource Id: 55915
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.321"
.head 5 -  Width:  6.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nDPT_ID
.head 3 -  String: sDETAILS
.head 2 +  Window Variables
.head 3 -  String: sFile
.head 3 -  File Handle: fH
.head 3 -  String: sBuffer
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgShtraf.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set mlDetails = sDETAILS
.head 3 +  On SAM_Close
.head 4 -  Call SalEndDialog(hWndForm, TRUE)
.head 1 +  Form Window: frm_AcrPay
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? No
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.933"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.667"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Параметры выплаты процентов
.head 4 -  Resource Id: 41161
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.476"
.head 5 -  Width:  4.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.238"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: gboxParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: МФО
.head 4 -  Resource Id: 28696
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.798"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    0.8"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfMFO)
.head 7 -  Set dfNB = ''
.head 7 -  Return VALIDATE_Ok
.head 6 +  If SqlPrepareAndExecute(hSql(),
 "SELECT nb INTO :dfNB 
    FROM banks 
   WHERE mfo = :dfMFO AND nvl(blk, 0) != 4")
and SqlFetchNext(hSql(), nTmp)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Set dfNB = ''
.head 7 -  ! Введите правильный код МФО банка!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_AcrPay.cTErrMFO'),
                   CurrentLangTable.GetAtomTitle('frm_AcrPay.cTErrRekv'),
                   MB_Ok|MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 -  Background Text: Счет
.head 4 -  Resource Id: 28697
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.048"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    1.05"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(hWndItem)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If Vkrz2(dfMFO, dfNLS) != dfNLS
.head 7 -  ! Ошибка в контрольном разряде номера счета
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_AcrPay.cTErrNLS'),
                   CurrentLangTable.GetAtomTitle('frm_AcrPay.cTErrRekv'), 
                   MB_Ok|MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If dfMFO = GetBankMfo() 
.head 7 +  If SqlPrepareAndExecute(hSql(),
  "SELECT c.okpo, substr(a.nms, 1, 38)  
     INTO :dfOKPO, :dfNAME
     FROM customer c, accounts a, dpt_deposit d
    WHERE c.rnk        = a.rnk 
      AND a.nls        = :dfNLS
      AND a.kv         = d.kv
      AND d.deposit_id = :DPT_ID
      AND a.dazs IS NULL")
  and NOT SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_New.cTErrAccNotFound'),
                   CurrentLangTable.GetAtomTitle('frm_New.cTErrRekv'), 
                   MB_Ok|MB_IconStop)
.head 8 -  Return VALIDATE_Cancel
.head 3 -  Background Text: Наименование
.head 4 -  Resource Id: 28698
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.298"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    1.3"
.head 6 -  Width:  4.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Код ОКПО
.head 4 -  Resource Id: 28699
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.548"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    1.55"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfOKPO)
.head 7 -  Return VALIDATE_Ok
.head 6 +  If V_Okpo(dfOKPO) != dfOKPO
.head 7 -  ! Ошибка кода ОКПО!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_AcrPay.cTErrOKPO'),
                   CurrentLangTable.GetAtomTitle('frm_AcrPay.cTErrRekv'), 
                   MB_Ok|MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Data Field: dfNB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.583"
.head 6 -  Top:    0.798"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbRefresh
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbRefresh
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.13"
.head 5 -  Top:    0.06"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Перечитать
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_AcrPay.cBTipRefresh')
.head 5 +  On SAM_Click
.head 6 -  Call SalPostMsg( hWndForm, UM_Populate, 0, 0 )
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    0.06"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Сохранить
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_AcrPay.cBTipSave')
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If SqlPrepareAndExecute(hSql(),
  "UPDATE dpt_deposit 
      SET mfo_p  = :frm_AcrPay.dfMFO,
          nls_p  = :frm_AcrPay.dfNLS,
          name_p = :frm_AcrPay.dfNAME,
          okpo_p = :frm_AcrPay.dfOKPO  
    WHERE deposit_id = :frm_AcrPay.DPT_ID") 
.head 7 -  Call SqlCommit(hSql())
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalSetFocus( pbExit )
.head 6 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.183"
.head 5 -  Top:    0.06"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Завершить
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_AcrPay.cBTipExit')
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 -  Line
.head 4 -  Resource Id: 32114
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  1.083"
.head 5 -  Begin Y:  -0.012"
.head 5 -  End X:  1.083"
.head 5 -  End Y:  0.405"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 +  Picture: picParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.583"
.head 5 -  Width:  7.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.37"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: DPT_ID
.head 3 -  Window Handle: hWndParent
.head 2 +  Window Variables
.head 3 -  Number: nTmp
.head 3 -  String: strWndName
.head 3 -  Window Handle: hChild
.head 3 -  String: sTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalGetWindowText(hWndForm, strWndName, 128)
.head 4 -  Call SaveInfoToLog(MSG_Invoke() || strWndName)
.head 4 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 3 +  On SAM_CreateComplete
.head 4 -  ! Параметры выплаты процентов по вкладу <...>
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_AcrPay.cTWndTitle') || ' '|| SalNumberToStrX( DPT_ID, 0 ))
.head 3 +  On UM_Populate
.head 4 +  If DPT_ID != 0
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If SqlPrepareAndExecute ( hSql(),
 " SELECT d.mfo_p,b.nb,d.nls_p,d.name_p,d.okpo_p
   INTO :frm_AcrPay.dfMFO,:frm_AcrPay.dfNB,:frm_AcrPay.dfNLS,:frm_AcrPay.dfNAME,:frm_AcrPay.dfOKPO
   FROM dpt_deposit d, banks b
   WHERE d.mfo_p=b.mfo AND d.deposit_id=:frm_AcrPay.DPT_ID  "  )
.head 6 -  Call SqlFetchNext( hSql(), nTmp )
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_Destroy
.head 4 +  If hWndParent
.head 5 -  Call SalSendMsg( hWndParent, UM_Populate, 0, 0)
.head 1 +  Table Window: PL_CARDS
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Открытые счета клиента
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.683"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 3.452"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 25850
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.65"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  2.65"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.4"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 25851
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.983"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  1.983"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.117"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 25852
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  0.6"
.head 6 -  Begin Y:  0.071"
.head 6 -  End X:  0.6"
.head 6 -  End Y:  0.536"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выбрать счет
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('PL_CARDS.cBTipOk')
.head 6 +  On SAM_Click
.head 7 +  If pTIP = 0
.head 8 -  Set frm_New.MFO_P  = GetBankMfo(  )
.head 8 -  Set frm_New.NLS_P  = Val(cNLS)
.head 8 -  Set frm_New.NAME_P = cNMS
.head 8 -  Set frm_New.OKPO_P = PL_CARDS.pOKPO
.head 7 +  Else
.head 8 -  Set frm_Vklad.MFOP  = GetBankMfo(  )
.head 8 -  Set frm_Vklad.NLSP  = cNLS
.head 8 -  Set frm_Vklad.NAMEP = cNMS
.head 8 -  Set frm_Vklad.OKPOP = PL_CARDS.pOKPO
.head 7 -  Call SalDestroyWindow(PL_CARDS)
.head 2 +  Contents
.head 3 +  Column: cACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNBS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Бал.
счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cTIP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.583"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лицевой счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.75"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cNMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 70
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cDAOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата 
открытия
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: pTIP
.head 3 -  ! pTIP = 0 - открытие вклада
.head 3 -  ! pTIP = 1 - карточка вклада
.head 3 -  String: pNBS
.head 3 -  Number: pRNK
.head 3 -  Number: pKV
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  String: pOKPO
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('PL_CARDS.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 +  If SqlPrepareAndExecute(hSql(), 
   "SELECT okpo INTO :pOKPO FROM customer WHERE rnk=:PL_CARDS.pRNK" )
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 4 -  Set PL_CARDS.strFilterTblName = 'ACCOUNTS'
.head 4 -  Set PL_CARDS.strPrintFileName = 'PL_CARDS'
.head 4 -  Set PL_CARDS.strSqlPopulate=
    "SELECT accounts.acc, accounts.nbs, accounts.tip, 
            accounts.nls, t.lcv, substr(accounts.nms,1,38), accounts.daos
       FROM accounts, cust_acc ca, tabval t
      WHERE accounts.acc = ca.acc   
        AND accounts.kv = t.kv
        AND accounts.dazs IS NULL 
        AND ca.rnk = :PL_CARDS.pRNK 
        AND accounts.kv = :PL_CARDS.pKV
        AND accounts.nbs IN ("||PL_CARDS.pNBS||")
   ORDER BY accounts.nls"
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 1 +  Dialog Box: dlg_ImportCSV  ! Імпорт файлів у форматі CSV
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Імпорт файлів CSV (ver. 0.2)
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.625"
.head 4 -  Top:    0.625"
.head 4 -  Width:  6.183"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.667"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfFilePath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    1.714"
.head 6 -  Width:  5.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbChooseFile
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.383"
.head 5 -  Top:    1.655"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalDlgOpenFile(hWndForm, 'Open File', sFilters, nFilters, nIndex, sFileName, sFilePathName)
.head 7 -  Set dfFilePath=sFilePathName
.head 7 -  ! Set sFilePathName = SalStrLeftX(sFilePathName, SalStrScan(sFilePathName,sFileName))
.head 7 -  ! Set dfFilePath = SalStrLeftX(sFileName,SalStrScan(sFileName,'.'))
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Виконати
.head 4 -  Window Location and Size
.head 5 -  Left:   0.8"
.head 5 -  Top:    2.81"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! < Типи даних >
.head 6 +  If ( rbCREDIT= TRUE )
.head 7 -  Set DataType = 'CRD'
.head 6 +  If ( rbDEBIT= TRUE )
.head 7 -  Set DataType = 'DBT'
.head 6 +  If ( rbRETAIL_G = TRUE )
.head 7 -  Set DataType = 'RUG'
.head 6 +  If ( rbRETAIL_I = TRUE )
.head 7 -  Set DataType = 'RUI'
.head 6 +  If ( rbRETAIL_Z = TRUE )
.head 7 -  Set DataType = 'RUZ'
.head 6 +  ! If ( ( VisGetKeyState(VK_Alt) & KS_Down ) AND ( VisGetKeyState(VK_Control) & KS_Down ) )
.head 7 -  ! Запуск тестової процедури
.head 7 -  Set nRunID = 2
.head 6 +  If SalMessageBox( 'Ця операція приведе до видалення існуючих даних. Ви дійсно хочете виконати імпорт?',
                                       CurrentLangTable.GetAtomTitle('cTAt'),
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 7 -  Set dDate = get_OneDateValue( "SELECT csv.get_Date4Import INTO :dResult  FROM dual" )
.head 7 +  If ( dDate > SalDateMonthBegin( SalDateCurrent ( ) ) )
.head 8 +  If SalMessageBox( 'Імпорт даних за ' || SalFmtFormatDateTime( SalDateMonthBegin( SalDateCurrent ( ) ), 'dd.MM.yyyy') ||
                                       ' заборонено! Виконати імпорт за ' || SalFmtFormatDateTime( dDate, 'dd.MM.yyyy') || '?',
                                       CurrentLangTable.GetAtomTitle('cTAt'),
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 9 +  If ( cbFromFile )
.head 10 -  Call p_Imort_CSV()
.head 9 +  Else
.head 10 -  Call p_Fill_Data( 1 )
.head 7 +  Else
.head 8 +  If ( cbFromFile )
.head 9 -  Call p_Imort_CSV()
.head 8 +  Else
.head 9 -  Call p_Fill_Data( 1 )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вихід
.head 4 -  Window Location and Size
.head 5 -  Left:   3.2"
.head 5 -  Top:    2.81"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Якщо щось імпортували
.head 6 +  If ( bYES )
.head 7 +  If SalMessageBox( 'Виконати перерахунок резерву?',
                                       CurrentLangTable.GetAtomTitle('cTAt'),
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 8 -  Call SaveInfoToLog( 'ImportCSV: Вихід з перерахунком резерву за дату ' || SalFmtFormatDateTime( dDate, 'dd.MM.yyyy') )
.head 8 +  If SqlPLSQLCommand( hSql(), "BARS.Z23.REZ_23( dDate ) " ) 
.head 9 -  Set mlMsgBox =  mlMsgBox || 'Завершено перерахунок резерву.' || PutCrLf()
.head 9 -  Call SqlCommit( hSql() )
.head 7 +  Else
.head 8 -  Call SaveInfoToLog( 'ImportCSV: Вихід без перерахунку резерву.' )
.head 6 -  Call SalEndDialog(hWndForm,0)
.head 3 -  Background Text: Запис №
.head 4 -  Resource Id: 23428
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.583"
.head 5 -  Top:    0.881"
.head 5 -  Width:  1.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfRecN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    0.821"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Group Box: Вибір файлу для імпорту
.head 4 -  Resource Id: 23429
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.488"
.head 5 -  Width:  5.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Тип показників
.head 4 -  Resource Id: 62271
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.036"
.head 5 -  Width:  5.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.119"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbCREDIT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кредитний портфель
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.238"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbDEBIT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дебіторка (new)
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.536"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbRETAIL_G
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: RU (груповий)
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    0.238"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbRETAIL_I
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: RU (індивідувальний)
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    0.536"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbRETAIL_Z
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: RU (загальний)
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.833"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: mlMsgBox
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    2.155"
.head 6 -  Width:  5.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbFromFile
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Імпорт даних із файлу CSV
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.238"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If ( cbFromFile )
.head 7 -  Call SalEnableWindow( dfFilePath )
.head 7 -  Call SalEnableWindow( pbChooseFile )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( dfFilePath )
.head 7 -  Call SalDisableWindow( pbChooseFile )
.head 2 +  Functions
.head 3 +  Function: get_OneDateValue
.head 4 -  Description: ф-я повертає результат виконання переданого запиту в дату dResult
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  String: sSqlText
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetchRes
.head 5 -  Date/Time: dResult
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), sSqlText ) AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set dResult = DATETIME_Null
.head 5 -  Return dResult
.head 3 +  Function: get_OneStringValue
.head 4 -  Description: ф-я повертає результат виконання переданого запиту в строку sResult
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sSqlText
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetchRes
.head 5 -  String: sResult
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), sSqlText ) AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set sResult = STRING_Null
.head 5 -  Return sResult
.head 3 +  Function: p_Imort_CSV
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: hFile
.head 5 -  String: sLine
.head 5 -  Number: nTotalRec
.head 4 +  Actions
.head 5 -  Set dfRecN = 0
.head 5 -  Set nTotalRec = 0
.head 5 +  If VisFileOpen (hFile, dfFilePath, OF_Read) = 0 !! VTERR_Ok
.head 6 -  Call SaveInfoToLog( 'CSV.Import: Розпочато завантаження даних з файлу: ' || dfFilePath || ', Delimiter = ' || Str( nDelimiter ) )
.head 6 -  ! << Імпорт записів із файлу >>
.head 6 +  While VisFileReadString( hFile, sLine ) = 0    !! VTERR_Ok
.head 7 -  Set nTotalRec = nTotalRec + 1
.head 7 +  If SqlPLSQLCommand( hSql(), "BARS.CSV.IMP( nTotalRec, sLine, DataType, nDelimiter, dDate ) " ) 
.head 8 -  Set dfRecN = nTotalRec
.head 8 +  If ( Mod( nTotalRec, 100 ) = 0 )
.head 9 -  Call SalInvalidateWindow( dlg_ImportCSV )
.head 9 -  Call SalUpdateWindow( dfRecN )
.head 7 +  Else
.head 8 -  ! Set mlMsgBox = '0. Запис  '||Str(nTotalRec)||' не імпортовано.' || PutCrLf()
.head 8 -  Set mlMsgBox = 'ПОМИЛКА ІМПОРТУ! ' || PutCrLf()
.head 8 -  Call SqlRollback( hSql() )
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Break
.head 6 -  Call VisFileClose ( hFile )
.head 6 -  Call SqlCommit( hSql() )
.head 6 -  Call SaveInfoToLog( 'CSV.Import: Звантажено '||Str(dfRecN)|| ' із '||Str(nTotalRec)||' рядків файлу: ' || dfFilePath )
.head 6 -  Set mlMsgBox = '1. Звантажено '||Str(dfRecN)|| ' із '||Str(nTotalRec)||' записів.' || PutCrLf()
.head 6 -  ! << Наповнення NBU_23_REZ >>
.head 6 -  Call p_Fill_Data( 0 )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Незнайдено файл: ' || dfFilePath, 'Увага', MB_IconStop )
.head 3 +  Function: p_Imort_CSV_NEW
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: hFile
.head 5 -  String: sLine
.head 5 -  String: DataType  !! тип даних які завантажуються
.head 5 -  Number: nTotalRec
.head 4 +  Actions
.head 5 -  Set dfRecN = 0
.head 5 -  Set nTotalRec = 0
.head 5 +  If VisFileOpen (hFile, dfFilePath, OF_Read) = 0 !! VTERR_Ok
.head 6 -  Call SaveInfoToLog( 'CSV.Import: Розпочато завантаження даних з файлу: ' || dfFilePath || ', Delimiter = ' || Str( nDelimiter ) )
.head 6 -  ! < Типи даних >
.head 6 +  If ( rbCREDIT= TRUE )
.head 7 -  Set DataType = 'CRD'
.head 6 +  If ( rbDEBIT= TRUE )
.head 7 -  Set DataType = 'DBT'
.head 6 +  If ( rbRETAIL_G = TRUE )
.head 7 -  Set DataType = 'RUG'
.head 6 +  If ( rbRETAIL_I = TRUE )
.head 7 -  Set DataType = 'RUI'
.head 6 +  If ( rbRETAIL_Z = TRUE )
.head 7 -  Set DataType = 'RUZ'
.head 6 -  ! < Імпорт записів із файлу >
.head 6 +  While VisFileReadString( hFile, sLine ) = 0    !! VTERR_Ok
.head 7 -  Set CSV_LIST[nTotalRec] = sLine
.head 7 -  Set nTotalRec = nTotalRec + 1
.head 7 -  Set dfRecN = dfRecN +1
.head 7 +  ! If ( Mod( nTotalRec, 1000 ) = 0 )
.head 8 -   Call SalInvalidateWindow( dfRecN )
.head 8 -   Call SalUpdateWindow( dlg_ImportCSV )
.head 6 -  Call VisFileClose (hFile)
.head 6 -  Call SaveInfoToLog( 'CSV.Import: Наповнено масив ' || Str(nTotalRec) || ' рядками файлу: ' || dfFilePath )
.head 6 +  If ( SqlPLSQLCommand( hSql(), "CSV.IMPORT( DataType, dDate, CSV_LIST, nDelimiter ) " ) )
.head 7 -  ! Call SqlSetLongBindDatatype( 1, 22 )
.head 7 -  Call SaveInfoToLog( 'CSV.Import: Звантажено '||Str(dfRecN)|| ' із '||Str(nTotalRec)||' рядків файлу: ' || dfFilePath )
.head 7 -  ! чистим масив
.head 7 -  ! Call SalArraySetUpperBound ( CSV_LIST, 1, -1 )
.head 6 -  Call SqlCommit( hSql() )
.head 6 -  Set mlMsgBox = '1. Звантажено '||Str(dfRecN)|| ' із '||Str(nTotalRec)||' записів.' || PutCrLf()
.head 6 +  ! If SqlPLSQLCommand( hSql(), "BARS.CSV.UPD( DataType, dDate ) " ) 
.head 7 -   Call SqlCommit( hSql() )
.head 7 +   If ( DataType = 'CRD' )
.head 8 -   Set bYES = TRUE
.head 8 -   Set mlMsgBox =  mlMsgBox || '2. Завершено оновлення параметрів КД.' || PutCrLf()
.head 7 +   Else 
.head 8 -   Set mlMsgBox =  mlMsgBox || '2. Завершено наповнення таблиці NBU23_REZ.' || PutCrLf()
.head 6 +  ! Else 
.head 7 -   Call SqlRollback( hSql() )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Незнайдено файл: ' || dfFilePath, 'Увага', MB_IconStop )
.head 6 -  ! Return FALSE
.head 3 +  Function: p_Fill_Data
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  ! ( 0 - csv / 1 - table )
.head 5 -  Number: nParam
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If (nParam = 1 )
.head 6 -  Set mlMsgBox =  mlMsgBox || '1. Розпочато роботу з таблицею БД. ' || PutCrLf()
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  ! < Наповнення NBU_23_REZ >
.head 5 +  If SqlPLSQLCommand (hSql(), "BARS.CSV.UPD( DataType, dDate, nParam ) " )
.head 6 -  Call SqlCommit( hSql() )
.head 6 +  If ( DataType = 'CRD' )
.head 7 -  Set bYES = TRUE
.head 7 -  Set mlMsgBox =  mlMsgBox || '2. Завершено оновлення параметрів КД.' || PutCrLf()
.head 6 +  Else
.head 7 -  Set mlMsgBox =  mlMsgBox || '2. Завершено наповнення таблиці NBU23_REZ.' || PutCrLf()
.head 5 +  Else
.head 6 -  Call SqlRollback( hSql() )
.head 6 +  If ( DataType = 'CRD' )
.head 7 -  Set mlMsgBox =  mlMsgBox || '2. Помилка оновлення параметрів КД ! '
.head 6 +  Else
.head 7 -  Set mlMsgBox =  mlMsgBox || '2. Помилка наповнення таблиці NBU23_REZ ! '
.head 5 -  ! Call MessageError( "Невозможно закрыть договор "||Str(ND)||" / "||sTxt )
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nDelimiter
.head 2 +  Window Variables
.head 3 -  Number: nFilters
.head 3 -  Number: nIndex
.head 3 -  Number: nRunID
.head 3 -  String: sFilters[0:2]
.head 3 -  String: sFileName
.head 3 -  String: sFilePathName
.head 3 -  String: DataType  !! тип даних які завантажуються
.head 3 -  String: CSV_LIST[*]
.head 3 -  Boolean: bYES
.head 3 -  Date/Time: dDate
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sFilters[0] = 'CSV files'
.head 4 -  Set sFilters[1] = '*.csv'
.head 4 -  Set nFilters = 2
.head 4 -  Set nIndex = 1
.head 4 -  Set rbCREDIT = TRUE
.head 4 -  Call SalDisableWindow( rbRETAIL_G )
.head 4 -  Call SalDisableWindow( rbRETAIL_I )
.head 4 -  Call SalDisableWindow( dfFilePath )
.head 4 -  Call SalDisableWindow( pbChooseFile )
.head 4 -  Set bYES = FALSE
.head 4 -  Set cbFromFile = FALSE
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalCenterWindow( hWndForm )
