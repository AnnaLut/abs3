.head 0 +  Application Description: ! BARS009.APD - Dynalib 
! BARS009.APL - Овердрафты
! ООО Унити-Барс (C) 1996-2013
! Разработчик: Марценюк М.П.
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B20000 002C000000030000 0003000000000000 00C1020000F8FFFF
0040: FFE2FFFFFF000000 0000000000230300 00E3010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F777302544F
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001E71 3A5C626172733938 5C6C696272617279 5C524547434C4E45
0020: 582E646C6C1E713A 5C6261727339385C 6C6962726172795C 524547434C4E4558
0040: 2E61706300000101 011E713A5C626172 7339385C6C696272 6172795C52454743
0060: 4C4E45582E72756E 1E713A5C62617273 39385C6C69627261 72795C524547434C
0080: 4E45582E646C6C1E 713A5C6261727339 385C6C6962726172 795C524547434C4E
00A0: 45582E6170630000 010101175C424152 5339385C42494E5C 626172733030392E
00C0: 617064175C424152 5339385C42494E5C 70726F636170692E 646C6C175C424152
00E0: 5339385C42494E5C 70726F636170692E 6170630000010101 001E713A5C626172
0100: 7339385C6C696272 6172795C52454743 4C4E45582E646C6C 1E713A5C62617273
0120: 39385C6C69627261 72795C524547434C 4E45582E61706300 00010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: depo.apd
.head 2 -  Dynalib: Custacnt.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: bars022.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: Bars017.apd
.head 2 -  Dynalib: Bars017r.apd
.head 2 -  !
.head 2 -  File Include: Gentbld.apl
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: Genlabel.apl
.head 2 -  File Include: Qcktabs.apl
.head 2 -  File Include: Winapi.apl
.head 2 -  File Include:
.head 2 -  File Include: Xsalcpt.apl
.head 2 -  File Include: Docwis6.apl
.head 2 -  File Include: XSALIMG.APL
.head 2 -  !
.head 2 -  Dynalib: Bars010.apd
.head 2 -  Dynalib: Cc_doc.apd
.head 2 -  Dynalib: otcn.apd
.head 2 -  File Include: GENLBL.APL
.head 2 -  File Include: VTSPLIT.APL
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd-MM-yy
.head 3 -  Date/Time: dd/MM/yyyy
.head 3 -  Number: ###00000
.head 3 -  Number: ###00000
.head 3 -  Number: 00000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Number: #000
.head 3 -  Date/Time: dd.MM.yy
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 4 -  Number: UM_PayTransaction = SAM_User + 5001
.head 3 +  User
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  Window Handle: hWin0
.head 3 -  Window Handle: hWin1
.head 3 -  Window Handle: hWin4
.head 3 -  Window Handle: hWin11
.head 3 -  Window Handle: hWinKD
.head 3 -  Window Handle: hWin3
.head 3 -  Window Handle: hWin5
.head 3 -  Window Handle: hWin7 
.head 3 -  Window Handle: hWinW
.head 3 -  Window Handle: hWinSC
.head 3 -  Window Handle: hWinK
.head 3 -  Window Handle: hWinZ
.head 3 -  Window Handle: hWinTOArc
.head 3 -  Window Handle: hWinTOEvents
.head 3 -  Window Handle: hWinTOHistory
.head 3 -  Boolean: bApdInited
.head 3 -  Boolean: bOPLATA
.head 3 -  Number: nFetchRes
.head 2 +  Internal Functions
.head 3 +  Function: CloseAccount2          
.head 4 -  Description: Закрыть счет
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nAcc
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTmp
.head 5 -  Number: nAcrD
.head 5 -  Number: nAcrK
.head 5 -  String: sKV
.head 5 -  String: sNLS1
.head 5 -  String: sNLS2
.head 5 -  String: sNLS3
.head 5 -  String: ss
.head 5 -  Date/Time: DAZS
.head 5 -  Date/Time: DAPP
.head 5 -  Number: S1
.head 5 -  Number: S2
.head 5 -  Number: S3
.head 5 -  Boolean: bFL
.head 5 -  Boolean: bFLEIntc
.head 5 -  Date/Time: dDat
.head 5 -  Date/Time: dAcrDat
.head 5 -  Date/Time: dStpDat
.head 5 -  String: sDat
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set dDat  = GetBankDate()
.head 5 -  Set sDat  = GetBankDateEx()
.head 5 -  Set sNLS1 = ''
.head 5 -  Set ss  = 'Счет '
.head 5 -  Set bFL = FALSE
.head 5 -  Set bFL = FALSE
.head 5 +  Loop
.head 6 +  If not SqlPrepareAndExecute( hSql(),T("
  SELECT a.ostc,a.ostb,a.ostf,a.dapp,a.dazs,a.kv,a.NLS
  INTO   :S1, :S2, :S3, :DAPP, :DAZS, :sKV, :sNLS1
  FROM accounts a WHERE a.acc=:nAcc"))
or not SqlFetchNext( hSql(), nTmp )
.head 7 -  Set ss=ss||"не найден !"
.head 6 +  Else
.head 7 -  Set ss=ss||sKV||"/"||sNLS1 || " "
.head 7 +  If S1 !=0
.head 8 -  Set ss=ss||"ненулевой остаток(Ф) !"
.head 8 -  Break
.head 7 +  If S2 !=0
.head 8 -  Set ss=ss||"ненулевой остаток(П) !"
.head 8 -  Break
.head 7 +  If S3 !=0
.head 8 -  Set ss=ss||"ненулевой остаток(Б) !"
.head 8 -  Break
.head 7 +  If DAPP = dDat
.head 8 -  Set ss=ss||"имеет обороты !"
.head 8 -  Break
.head 7 +  If DAZS != DATETIME_Null
.head 8 -  Set ss=ss||"уже закрыт !"
.head 8 -  Break
.head 7 -  !
.head 7 +  If not SqlPrepareAndExecute( hSql(),
"SELECT i.acra, i.acr_dat,i.stp_dat,a.ostc,a.ostb,a.ostf,a.dapp,a.nls
  INTO :nAcrK,:dAcrDat,:dStpDat,:S1,:S2,:S3,:DAPP,:sNLS1
  FROM accounts a, int_accn i
  WHERE i.acra = a.acc AND a.dazs is NULL and i.acc=:nAcc ")
.head 8 -  Set ss = ss || 'Ошибка поиска счетов начисления %%!'
.head 8 -  Break
.head 7 +  While SqlFetchNext( hSql(), nTmp )
.head 8 -  Set ss = ss||" Счет начисления %% "||sNLS1|| " "
.head 8 +  If S1 !=0
.head 9 -  Set ss=ss||"ненулевой остаток(Ф) !"
.head 9 -  Set bFLEIntc = TRUE
.head 9 -  Break
.head 8 +  Else If S2 !=0
.head 9 -  Set ss=ss||"ненулевой остаток(П) !"
.head 9 -  Set bFLEIntc = TRUE
.head 9 -  Break
.head 8 +  Else If S3 !=0
.head 9 -  Set ss=ss||"ненулевой остаток(Б) !"
.head 9 -  Set bFLEIntc = TRUE
.head 9 -  Break
.head 8 +  Else If DAPP = dDat
.head 9 -  Set ss=ss||"имеет обороты !"
.head 9 -  Set bFLEIntc = TRUE
.head 9 -  Break
.head 8 +  Else If (( dStpDat = DATETIME_Null and dDat > dAcrDat )
     or ( dStpDat != DATETIME_Null and dStpDat > dAcrDat ))
.head 9 +  If SalMessageBox( ss || 'недоначислены %% !
Продолжать закрытие счета?','Внимание!', MB_IconQuestion | MB_YesNo) = IDNO
.head 10 -  Set bFLEIntc = TRUE
.head 10 -  Break
.head 8 +  Else If DAPP > dAcrDat
.head 9 +  If SalMessageBox('Счет начисления %% '||sNLS1||' может еще быть задействован! Продолжать закрытие счета?','Внимание!', MB_IconQuestion | MB_YesNo) = IDNO
.head 10 -  Set bFLEIntc = TRUE
.head 10 -  Break
.head 8 -  !
.head 8 +  If NOT SqlPrepareAndExecute( hSql(), "UPDATE accounts SET dazs=" || DateInQuery( sDat ) || " WHERE acc=:nAcrK")
.head 9 -  Set ss= ss || " Закрыть невозможно "
.head 9 -  Set bFLEIntc = TRUE
.head 8 +  If NOT SqlPrepareAndExecute( hSql(), "UPDATE int_accn SET stp_dat=" || DateInQuery( sDat ) || ",
       acr_dat=" || DateInQuery( sDat ) || " WHERE acc=:nAcc AND acra=:nAcrK")
.head 9 -  Set ss= ss || " Закрыть невозможно "
.head 9 -  Set bFLEIntc = TRUE
.head 7 +  If bFLEIntc
.head 8 -  Break
.head 7 -  !
.head 7 +  If SqlPrepareAndExecute( hSql(), "UPDATE accounts SET dazs=" || DateInQuery( sDat ) || " WHERE acc=:nAcc")
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 +  If SalMessageBox(ss||' закрыть?','Внимание!', MB_IconQuestion | MB_YesNo) = IDYES
.head 9 -  Call SalWaitCursor( TRUE )
.head 9 -  Set ss= ss||" закрыт "
.head 9 -  Call SaveFInfoToLog( ss )
.head 9 -  Set bFL=TRUE
.head 9 -  Call SalWaitCursor( FALSE )
.head 8 +  Else
.head 9 -  Set ss= ss || " не закрывается."
.head 8 -  Call SalWaitCursor( TRUE )
.head 7 +  Else
.head 8 -  Set ss= ss || " Закрыть невозможно "
.head 7 -  Break
.head 5 +  If not bFL
.head 6 -  Call SqlRollback( hSql())
.head 6 -  Call MessageError( ss )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 -  Return bFL
.head 3 +  Function: Sel009	! __exported
.head 4 -  Description: Bars009_Selector
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call Ini009()
.head 5 +  If nMode=1 or nMode>10
.head 6 -  Call Sel022(hWndMDI,nMode,nPar,strPar01,strPar02) ! Переход в BARS022
.head 6 -  ! Break
.head 5 +  Else
.head 6 +  Select Case nMode
.head 7 +  Case 0  ! Овердрафты
.head 8 +  If not IsWindow(hWin0)
.head 9 -  Set hWin0 = SalCreateWindow(TO, hWndParent, nMode, nPar, strPar01, strPar02 )
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop ( TO )
.head 8 -  Break
.head 7 +  Case 2
.head 8 -  Call SalModalDialog(dlg_OverOld, hWndParent, nPar, 'MDATE')
.head 8 -  Break
.head 7 +  Case 3
.head 8 +  If not IsWindow(hWinKD)
.head 9 -  Set hWinKD = SalCreateWindow( KD, hWndParent, nPar, strPar01 ,strPar02)
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop ( KD )
.head 8 -  Break
.head 7 +  Case 4  ! Овердрафты WH
.head 8 +  If not IsWindow(hWin4)
.head 9 -  Set hWin4= SalCreateWindow(TO_WH, hWndParent, nPar, strPar01, strPar02 )
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop ( TO_WH )
.head 8 -  Break
.head 7 +  Case 5  ! Овердрафты
.head 8 +  If not IsWindow(hWin0)
.head 9 -  Set hWin0 = SalCreateWindow(TO, hWndParent, nMode, nPar, strPar01, strPar02 )
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop ( TO )
.head 8 -  Break
.head 3 +  Function: Ini009
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not bApdInited
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars009.lng"
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 6 -  ! Call DocWisInit( 'CB_VVOD1' )
.head 6 -  Set bApdInited = TRUE
.head 5 -  Return bApdInited
.head 3 +  ! Function: F_NLS !! Открытие счета 2909
.head 4 -                                                                                       Description: 
.head 4 +                                                                                       Returns 
.head 5 -                                                                                       Boolean: ret
.head 4 +                                                                                       Parameters 
.head 5 -  ! Receive Number: nAcc
.head 5 -  ! Receive String: sNls
.head 5 -                                                                                       Number: nSKR
.head 5 -                                                                                       Number: nVID
.head 5 -                                                                                       Number: n980
.head 5 -                                                                                       Number: nRNK
.head 5 -                                                                                       Number: nGRP
.head 5 -                                                                                       Number: nISP
.head 4 -                                                                                       Static Variables 
.head 4 +                                                                                       Local variables 
.head 5 -                                                                                       Number: nTmp
.head 5 -                                                                                       String: sTmp
.head 5 -                                                                                       Number: nAcc
.head 5 -                                                                                       String: sNls
.head 4 +                                                                                       Actions 
.head 5 -                                                                                       Set nAcc=NUMBER_Null
.head 5 +                                                                                       If SqlPrepareAndExecute( hSql(),
  "SELECT n_sk INTO :nZ FROM spec_agio WHERE n_sk=:nSKR  " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 6 -                                                                                       Set sNls ='2909' || SalStrRightX( Str(1000000+nRNK), 6)||SalStrRightX( Str(1000+nSKR), 3)|| Str(nVID)
.head 6 -                                                                                       Set sNls =Vkrz2(GetBankMfo(),sNls)
.head 6 +                                                                                       If SqlPrepareAndExecute( hSql(),
  "SELECT acc INTO :nAcc FROM accounts WHERE kv=:n980 and nls=:sNls " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 7 +  ! If SalMessageBox('Открыть счет '|| sNls ||'/'||Str(n980)|| '?', 'Внимание!', MB_YesNo | MB_IconHand) = IDYES
.head 8 +                                                                                       If Op_Reg(99, 0, 0, nGRP, nTmp, nRNK, sNls, n980,
   Subs("Депоз.скринька № "||Str(nSKR),1,38),'ODB', nISP, nAcc)
.head 9 +                                                                                       If SqlPrepareAndExecute( hSqlAux(),T("
     INSERT into spec_agio (acc,n_sk,o_sk) VALUES (:nAcc,:nSKR,:nVID)") ) AND 
   SqlPrepareAndExecute( hSqlAux(),T("
     INSERT into podotch (nls) VALUES (:sNls)") )
.head 10 -                                                                                       Call SqlCommit( hSql() )
.head 10 -                                                                                       Call SaveFInfoToLog( "АвтоОткрытие сч."|| sNls ||"/"||Str(n980))
.head 10 -                                                                                       Call SalMessageBox('Счет открыт!','Внимание',MB_IconInformation)
.head 9 +                                                                                       Else 
.head 10 -                                                                                       Call SqlRollback( hSql() )
.head 10 -                                                                                       Call SalMessageBox('Невозможно вставить запись в таблицу "Депоз.сейфы"!','Внимание',MB_IconInformation)
.head 8 +                                                                                       Else 
.head 9 -                                                                                       Call SqlRollback( hSql() )
.head 9 -                                                                                       Call SalMessageBox('Невозможно открыть счет!','Внимание',MB_IconInformation)
.head 7 -                                                                                       Call SalModalDialog(dlgOPEN, hWndMDI, nAcc, sNls,  nSKR, nVID, n980, nRNK, nGRP, nISP)
.head 6 -                                                                                       Return TRUE
.head 5 +                                                                                       Else 
.head 6 -                                                                                       Call SalMessageBox('Сейф под таким номером уже существует!','Внимание',MB_IconInformation)
.head 3 -  !
.head 3 +  Function: CalcLim
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nAccl
.head 5 -  Window Handle: hW
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sOvrpar
.head 5 -  Number: nT
.head 4 +  Actions
.head 5 -  ! Вычитываем подстроку из параметра "Флаги овердрафтов" 
.head 5 -  ! LMET1 - методика Петрокоммерц 
! LMET2 - методика Ажио
.head 5 +  ! If SqlPrepareAndExecute ( hSql(), 
" select val into :sOvrpar  from params
   where par = 'OVRFLAGS' " )
.head 6 -                                                                   Call SqlFetchNext(hSql(),nT)
.head 6 -  ! Call Debug(sOvrpar)
.head 6 +                                                                   If sOvrpar != STRING_Null
.head 7 +                                                                   If OVR_PAR_VAL('LMET') = 1 
.head 8 -                                                                   Call SalModalDialog( dlg_Calclim, hW, nAccl)
.head 7 +                                                                   Else If OVR_PAR_VAL('LMET') = 2 
.head 8 -                                                                   Call SalModalDialog( dlg_Calclim2, hW, nAccl)
.head 7 +                                                                   Else 
.head 8 -                                                                   Call SalModalDialog( dlg_Calclim, hW, nAccl)
.head 5 +  If OVR_PAR_VAL('LMET') = '1' 
.head 6 -  Call SalModalDialog( dlg_Calclim, hW, nAccl)
.head 5 +  Else If OVR_PAR_VAL('LMET') = '2' 
.head 6 -  Call SalModalDialog( dlg_Calclim2, hW, nAccl)
.head 5 +  Else
.head 6 -  Call SalModalDialog( dlg_Calclim, hW, nAccl)
.head 3 +  Function: OVR_PAR_VAL
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: PAR_
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: NFeechRez
.head 5 -  String: VAL_
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSqlAux2(), "select substr(OVR.OVR_PAR_VAL(:PAR_),1,50) from dual INTO :VAL_")
.head 6 +  If SqlFetchNext( hSqlAux2(), NFeechRez ) 
.head 7 -  Return VAL_
.head 5 -  Return STRING_Null
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbEdit
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
.head 1 +  Table Window: TO
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Овердрафти
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.15"
.head 4 -  Top:    0.958"
.head 4 -  Width:  17.9"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.476"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: System Window Color
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 5000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Ведення овердрафтів
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.845"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 -  Line
.head 5 -  Resource Id: 64328
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.083"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  4.083"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 64329
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  8.667"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  8.667"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 28075
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  0.0"
.head 6 -  Begin Y:  0.429"
.head 6 -  End X:  15.283"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 12839
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.083"
.head 6 -  Begin Y:  0.833"
.head 6 -  End X:  2.083"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 31550
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.117"
.head 6 -  Begin Y:  0.833"
.head 6 -  End X:  2.117"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 28074
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  6.983"
.head 6 -  Begin Y:  0.429"
.head 6 -  End X:  6.983"
.head 6 -  End Y:  0.036"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pb_MOS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Marigold
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Доп.реквизиты по КД (для МОСКВЫ)'
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(ND)
.head 8 -  Call DOP_MOS (ND, NDOC, NMK,STRING_Null)
.head 4 +  Pushbutton: pb_MOS_Ex
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.567"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Marigold
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сформировать отчет № '|| Str(KODZ) || '. '|| NAM_KATZ
.head 6 +  On SAM_Click
.head 7 -  Call ZAPROS1(hWndMDI, KODZ )
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalModalDialog(TONewNLS, hWndForm,ACC_2600)
.head 8 +  If ACC_2600
.head 9 -  Call SalModalDialog(dlg_Over, hWndForm, ACC_2600, strType, IifN(nMode=5, 2,
     IifN(nPar=0 or UserType=0, 0, 1)), TRUE)
.head 8 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! Старое удаление строк
.head 7 -  ! нельзя удалять с ненул лимитом (использ или неиспольз)
.head 7 +  ! While SalTblFindNextRow(hWndForm, nRowNum, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRowNum)
.head 8 +  If not SalTblQueryRowFlags(hWndForm, nRowNum, ROW_New)
.head 9 +  ! If (Lim_Yes = 0 or Lim_Yes = Lim_Yes) and (Ost_8000 = 0 or Ost_8000 = NUMBER_Null)
.head 10 -                                                                        Call SalTblSetRowFlags(hWndForm, nRowNum, ROW_MarkDeleted,
     not SalTblQueryRowFlags(hWndForm, nRow,
     ROW_MarkDeleted))
.head 9 +  If ((Lim_2600 = 0 or Lim_2600 = NUMBER_Null) and Ost_2600 >= 0)
.head 10 -                                                                        Call SalTblSetRowFlags(hWndForm, nRowNum, ROW_MarkDeleted,
     not SalTblQueryRowFlags(hWndForm, nRow,
     ROW_MarkDeleted))
.head 9 +  Else 
.head 10 -  Call SalMessageBox('Договор ' || SalNumberToStrX(TO.ND, 0) ||
     ' не может быть удален из портфеля (текущий лимит <> 0 или остаток 2600 < 0)', 'ВНИМАНИЕ !!!',
     MB_Ok | MB_IconAsterisk)
.head 8 +  Else 
.head 9 -                                                                        Call SalTblDeleteRow(hWndForm, nRowNum, TBL_NoAdjust)
.head 7 -  ! Новое закрытие договора
.head 7 -  Set nRowNum=TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRowNum, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRowNum)
.head 8 +  If NOT SalTblQueryRowFlags(hWndForm, nRowNum, ROW_New) AND  colSos != 1 
.head 9 -  Call SqlPrepareAndExecute( hSql(), "select acc_2600 into :TMP from over_v where acc_2600=:TO.Acc_2600 and sos=1 " )
.head 9 +  If Lim_2600 !=0 AND Lim_2600 != NUMBER_Null  
.head 10 -  Call SalMessageBox('Договор '||SalNumberToStrX(TO.ND,0)||
'  не может быть удален из портфеля (текущий лимит <> 0)  ',
'ВНИМАНИЕ !!!',MB_Ok+MB_IconAsterisk) 
.head 9 +  Else If Ost_2600 <0
.head 10 -  Call SalMessageBox('Договор '||SalNumberToStrX(TO.ND,0)||
'  не может быть удален из портфеля (остаток 2600 < 0)  ',
'ВНИМАНИЕ !!!',MB_Ok+MB_IconAsterisk)
.head 9 +  Else If SqlPrepareAndExecute( hSqlAux(), 
"SELECT acc
  FROM (SELECT s.acc, cd.cdat, s.ostf - s.dos + s.kos s
          FROM (SELECT (SELECT acr_dat
                          FROM int_accn i
                         WHERE i.ID = 0 AND acc = :TO.Acc_2600) + num cdat
                  FROM conductor c
                 WHERE c.num < 365) cd,
               saldoa s
         WHERE (s.acc, s.fdat) =
                                (SELECT   ss.acc, MAX (ss.fdat)
                                     FROM saldoa ss
                                    WHERE ss.acc = s.acc
                                          AND ss.fdat <= cd.cdat
                                 GROUP BY ss.acc)
           AND s.acc = :TO.Acc_2600)
 WHERE s < 0 AND ROWNUM = 1  ") and  SqlFetchNext( hSqlAux(), NFetchRez )
.head 10 -  Call SalMessageBox('Договор '||SalNumberToStrX(TO.ND,0)||
'  не может быть удален из портфеля (недоначислены проценты по 2600)  ',
'ВНИМАНИЕ !!!',MB_Ok+MB_IconAsterisk)
.head 9 +  Else If SqlFetchNext( hSql(), NFetchRez )
.head 10 +  If TO.Ost_2096!=NUMBER_Null and TO.Ost_2096!=0
.head 11 -  Call SalMessageBox('Договор '||SalNumberToStrX(TO.ND,0)||
'  не может быть удален из портфеля (не закрыта сомнительная задолженность)  ',
'ВНИМАНИЕ !!!',MB_Ok+MB_IconAsterisk)
.head 10 +  Else
.head 11 -  Call SalMessageBox('Договор '||SalNumberToStrX(TO.ND,0)||
'  не может быть удален из портфеля (не закрыта просрочка)  ',
'ВНИМАНИЕ !!!',MB_Ok+MB_IconAsterisk)
.head 9 +  Else
.head 10 -  Call SalTblSetRowFlags(hWndForm, nRowNum, ROW_MarkDeleted,
     not SalTblQueryRowFlags(hWndForm, nRow,
     ROW_MarkDeleted))
.head 10 +  If SalMessageBox('Перенести договор '||SalNumberToStrX(TO.ND,0)||' в архив ?',
'ВНИМАНИЕ !!!',MB_YesNo+MB_IconAsterisk)=IDYES
.head 11 +  If SqlPrepareAndExecute( hSql(), "select vidd into :nTmp from cc_kol where vidd in (4,14,24) and nls is not null and rownum=1" ) and SqlFetchNext( hSql(), nFetchRes)
.head 12 -  Call SqlPLSQLCommand( hSql(), 'CCK.CC_9819(TO.ND,1)' )
.head 11 +  If DelOvrAccounts(TO.Acc_2600)  
.head 12 -  Call SqlCommitEx( hSql(),'Закр. дог. оверд.')
.head 12 -  Call SalWaitCursor(FALSE)
.head 11 +  Else
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalWaitCursor(FALSE)
.head 11 -  ! Call Debug('Референс договора='||SalNumberToStrX( TO.ND,0) )
.head 8 +  ! Else If NOT SalTblQueryRowFlags(hWndForm, nRowNum, ROW_New) AND  colSos = 1 
.head 9 +                                                                        If ((Lim_2600 = 0 OR Lim_2600 = NUMBER_Null )  AND Ost_2600 >=0   ) 
.head 10 -                                                                        Call SalTblSetRowFlags(hWndForm, nRowNum, ROW_MarkDeleted,
     not SalTblQueryRowFlags(hWndForm, nRow,
     ROW_MarkDeleted))
.head 10 +                                                                        If SalMessageBox('Перенести договор '||SalNumberToStrX(TO.ND,0)||' в архив ?',
'ВНИМАНИЕ !!!',MB_YesNo+MB_IconAsterisk)=IDYES
.head 11 +                                                                        If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( 8, Acc_2600 )" )
.head 12 -                                                                        Call SqlCommitEx( hSql(),'Закр. дог. оверд.')
.head 12 -                                                                        Call SalWaitCursor(FALSE)
.head 11 +                                                                        Else 
.head 12 -                                                                        Call SqlRollback(hSql())
.head 12 -                                                                        Call SalWaitCursor(FALSE)
.head 12 -                                                                        Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 9 +                                                                        Else 
.head 10 -                                                                        Call SalMessageBox('Договор  '||SalNumberToStrX(TO.ND,0)||
'  не может быть удален из портфеля (текущий лимит <> 0 или остаток 2600 < 0)  ',
'ВНИМАНИЕ !!!',MB_Ok+MB_IconAsterisk) 
.head 7 -  Return FALSE
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click,0,0 )
.head 7 +  ! If nNd != NUMBER_Null or nNd != 0 
.head 8 -                                                                        Set nRowNum=TBL_MinRow
.head 8 +                                                                        While SalTblFindNextRow(hWndForm, nRowNum, 0, 0)
.head 9 -                                                                        Call SalTblSetContext ( hWndForm, nRowNum ) 
.head 9 +                                                                        If ND = nNd and colSos !=1
.head 10 -                                                                        Break 
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 59116
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.817"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.25"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.117"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.683"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 59117
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   14.667"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 59118
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Pushbutton: pbProcN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.35"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Orchid
.head 5 -  Background Color: Yellow
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Начислить % a2600 по всему ПОРТФЕЛЮ '
.head 6 +  On SAM_Click
.head 7 -  Call Sel010(hWndForm,0,0,
" and (i.id=0 and 
s.acc in (select distinct acc from acc_over where tipo<>200 "||IifS(StrFilter!=""," and acc in "||StrFilter,"")||"
union all select distinct acc_9129 from acc_over where tipo<>200 "||IifS(StrFilter!=""," and acc in "||StrFilter,"")||"
union all select distinct acc_2067 from acc_over where tipo<>200 "||IifS(StrFilter!=""," and acc in "||StrFilter,"")||"
union all select distinct acc_2096 from acc_over where tipo<>200 "||IifS(StrFilter!=""," and acc in "||StrFilter,"")||" ))" ,
"SA" )
.head 4 +  Pushbutton: pbProcN1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.6"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_ints.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Yellow
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Начислить % a2600 по ОДНОМУ счету '
.head 6 +  On SAM_Click
.head 7 +  If TO.Acc_2067 >0
.head 8 -  Set temstr=","
.head 7 +  Else
.head 8 -  Set temstr=""
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call Sel010(hWndForm,0,0,
" and i.id=0 and s.acc in ("||Str(TO.Acc_2600)||",
                           "||Str(IifN(TO.Acc_2067=NUMBER_Null,-100,TO.Acc_2067))||",
                           "||Str(IifN(TO.Acc_9129=NUMBER_Null,-100,TO.Acc_9129))||",
                           "||Str(IifN(TO.Acc_2096=NUMBER_Null,-100,TO.Acc_2096))||")" , "SA" )
.head 4 -  !
.head 4 +  Pushbutton: pbProcP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.95"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Periwinkle
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Погасить возможный максимум % по всему ПОРТФЕЛЮ '
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox ("Выполнить '"||sActProcP||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 8 -  Call P_OVR8( 3, 0 )
.head 4 +  Pushbutton: pbProcP1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.2"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_ints.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Periwinkle
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Погасить возможный максимум % по ОДНОМУ счету '
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 +  If SalMessageBox ("Выполнить '"||sActProcP1||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 9 -  Call P_OVR8(3, TO.Acc_2067 )
.head 4 -  !
.head 4 +  Pushbutton: pbProcZ
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.55"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Chartreuse
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Погасить % по всему ПОРТФЕЛЮ (срок истек)'
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox ("Выполнить '"||sActProcZ||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 8 -  Call P_OVR8(1, 0)
.head 4 +  Pushbutton: pbProcZ1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.8"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_ints.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Chartreuse
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Погасить % по ОДНОМУ счету (срок истек)'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 +  If SalMessageBox ("Выполнить '"||sActProcZ1||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 9 -  Call P_OVR8(1, TO.Acc_2067)
.head 4 -  !
.head 4 +  Pushbutton: pbProcL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.05"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Chekin.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перенос на просрочку по всему ПОРТФЕЛЮ (срок истек)'
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox ("Выполнить '"||sActProcL||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 8 -  Call P_OVR8(2, 0)
.head 4 +  Pushbutton: pbProcS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.05"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Chekin.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перенос на сомнительную задолженность'
.head 6 +  On SAM_Click
.head 7 -  Call SqlPrepareAndExecute( hSql(), 'select A1.ostc, A2.ostc,A1.ostb,A2.ostb,A3.ostc,A4.ostc 
into :OSTC_2067, :OSTC_2069,:OSTB_2067, :OSTB_2069 ,:OSTC_2600,:OSTC_2607
from acc_over o, int_accn i, accounts A1, accounts A2, int_accn i2, accounts A3, accounts A4 
where o.acc=:TO.Acc_2600 and o.acc_2067=i.acc and a1.acc=i.acc and
 a2.acc=i.acra and nvl(o.sos,0)<>1 and o.acc=a3.acc and o.acc=i2.acc and i2.id=0 and a4.acc=i2.acra')
.head 7 -  If SqlFetchNext( hSql(), NFetchRez ) 
.head 7 +  If OSTC_2067>=0 and OSTC_2069>=0
.head 8 -  Call SalMessageBox("На счетах 2067, 2069 нет активных остатков!","Внимание !!!",MB_Ok)
.head 8 -  ! Call DebugN(OSTC_2067)
.head 8 -  ! Call DebugN(OSTC_2069)
.head 7 +  Else If (OSTC_2067!=OSTB_2067) OR (OSTC_2069!=OSTB_2069)
.head 8 -  Call SalMessageBox("По счетам 2067, 2069 имеются незавизированные документы!","Внимание !!!",MB_Ok)
.head 7 +  Else If (OSTC_2600!=0) OR (OSTC_2607!=0)
.head 8 -  Call SalMessageBox("Существуют остатки на счетах 2600, 2607!","Внимание !!!",MB_Ok)
.head 7 +  Else
.head 8 +  If SalMessageBox ("Выполнить '"||sActProcS||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 9 -  Call P_OVR8(96, TO.Acc_2600)
.head 4 +  Pushbutton: pbProcL1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.3"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перенос на просрочку по ОДНОМУ счету (срок истек)'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and  TO.colSos =0
.head 8 +  If SalMessageBox ("Выполнить '"||sActProcL1||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 9 -  Call P_OVR8(2, TO.Acc_2067 ) 
.head 4 +  Pushbutton: pbProcL2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.3"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перенос на просрочку по ОДНОМУ счету частичной суммы'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and  TO.colSos =0
.head 8 +  If SalModalDialog( dlg_Prosroch, TO,TO.Acc_2600,SUM,SUM_PR)
.head 9 -  !
.head 9 +  If SalMessageBox ("Выполнить '"||sActProcL2||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 10 -  Call P_OVR8(22, TO.Acc_2067) 
.head 4 -  !
.head 4 +  Pushbutton: pb_Acc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.55"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Счета по ОДНОМУ договору'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Set sTmp = "
 a.ACC in 
(          Select a.acc    from accounts a, acc_over o where o.acc=" || Str(Acc_2600) || " and
                                                             a.acc in (o.acco,o.acc_9129,o.acc_8000)
 union all select i.acra   from int_accn i, acc_over o where i.acra is not null and (i.id=0 or i.id=2) and
                                                             o.acc=" || Str(Acc_2600) || " and
                                                             i.acc in (o.acco,o.acc_9129,o.acc_8000)
 union all select a.acc    from accounts a where nbs='3579' and
                                                 a.rnk in (select rnk from accounts
                                                           where acc=" || Str(Acc_2600) || ")
 union all select acc      from cc_accp where accs=" || Str(Acc_2600) || "
 union all select acc_2096 from acc_over where acc_2096 is not null and acc=" || Str(Acc_2600) || "
 union all select i.acra   from acc_over a, int_accn i where i.acra is not null and i.acc=a.acc_2096 and
                                                             i.id=0 and a.acc=" || Str(Acc_2600) || "
 union all select n.acc    from nd_acc n, accounts a where a.acc=n.acc and a.nls like '3579%' and
                                                           n.nd=" || Str(ND) || "
 union all select n.acc    from nd_acc n, accounts a where a.acc=n.acc and a.nls like '8008%' and
                                                           n.nd=" || Str(ND) || "
 union all select acc      from cc_accp where accs=" || Str(Acc_2600) || "
 union all select acc_3739 from acc_over where acc_3739 is not null and acc=" || Str(Acc_2600) || "
 union all select acc_2067 from acc_over where acc_2067 is not null and acc=" || Str(Acc_2600) || "
 union all select acc_2069 from acc_over where acc_2069 is not null and acc=" || Str(Acc_2600) || "
 union all select acc_3600 from acc_over where acc_3600 is not null and acc=" || Str(Acc_2600) || "
 union all select acc from nd_acc where nd=" || Str(ND) || ")"
.head 8 -  Call ShowAccList(0, AVIEW_ALL,nEdAccFlag, sTmp)
.head 4 +  Pushbutton: pbShowArc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.633"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Books.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Архив овердрафтов'
.head 6 +  On SAM_Click
.head 7 +  If SalGetWindowState (hWinTOArc ) = Window_Invalid
.head 8 -  Set hWinTOArc =SalCreateWindow( TOArc,hWndMDI,Acc_2600)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (hWinTOArc )
.head 4 +  Pushbutton: pbCalclim
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.2"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Chartl.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If Acc_2600 != NUMBER_Null
.head 8 -  ! Call SalModalDialog( dlg_Calclim, hWndForm,Acc_2600)
.head 8 -  Call CalcLim(Acc_2600,hWndForm)
.head 8 -  Call SalSendMsg (TO, UM_Populate, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Расчитать лимит '
.head 4 +  Combo Box: cmbAction
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.45"
.head 6 -  Top:    0.095"
.head 6 -  Width:  4.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.821"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? Yes
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalListInsert (cmbAction,0,sActGash1 )
.head 7 -  Call SalListInsert (cmbAction,0,sActGash )
.head 7 -  Call SalListInsert (cmbAction,0,sActKom1)
.head 7 -  Call SalListInsert (cmbAction,0,sActKom)
.head 7 -  Call SalListInsert (cmbAction,0,sActProcL1)
.head 7 -  Call SalListInsert (cmbAction,0,sActProcL2)
.head 7 -  Call SalListInsert (cmbAction,0,sActProcL)
.head 7 -  Call SalListInsert (cmbAction,0,sActProcZ1)
.head 7 -  Call SalListInsert (cmbAction,0,sActProcZ)
.head 7 -  Call SalListInsert (cmbAction,0,sActProcP1)
.head 7 -  Call SalListInsert (cmbAction,0,sActProcP)
.head 7 -  Call SalListInsert (cmbAction,0, sActProcN1 )
.head 7 -  Call SalListInsert (cmbAction,0,sActProcN )
.head 7 -  Call SalListInsert (cmbAction,0,sActProcS )
.head 7 -  Call SalListInsert (cmbAction,0,sActProcL3)
.head 7 -  Call SalListInsert (cmbAction,0,sActProcL4)
.head 4 +  Pushbutton: pbExecute
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.867"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выполнить задачу '
.head 6 +  On SAM_Click
.head 7 -  ! 'Начислить % a2600 по всему ПОРТФЕЛЮ '
.head 7 +  If cmbAction=sActProcN
.head 8 -  Call SalSendMsg( pbProcN, SAM_Click, 0, 0 )
.head 7 -  ! 'Начислить % a2600 по ОДНОМУ счету '
.head 7 +  Else If cmbAction=sActProcN1
.head 8 -  Call SalSendMsg( pbProcN1, SAM_Click, 0, 0 )
.head 7 -  ! 'Погасить возможный максимум % по всему ПОРТФЕЛЮ '
.head 7 +  Else If cmbAction=sActProcP
.head 8 -  Call SalSendMsg( pbProcP, SAM_Click, 0, 0 )
.head 7 -  ! 'Погасить возможный максимум % по ОДНОМУ счету '
.head 7 +  Else If cmbAction=sActProcP1
.head 8 -  Call SalSendMsg( pbProcP1, SAM_Click, 0, 0 )
.head 7 -  ! 'Погасить % по всему ПОРТФЕЛЮ (срок истек)'
.head 7 +  Else If cmbAction=sActProcZ
.head 8 -  Call SalSendMsg( pbProcZ, SAM_Click, 0, 0 )
.head 7 -  ! 'Погасить % по ОДНОМУ счету (срок истек)'
.head 7 +  Else If cmbAction=sActProcZ1
.head 8 -  Call SalSendMsg( pbProcZ1, SAM_Click, 0, 0 )
.head 7 -  ! 'Перенос на просрочку по всему ПОРТФЕЛЮ (срок истек)'
.head 7 +  Else If cmbAction=sActProcL
.head 8 -  Call SalSendMsg( pbProcL, SAM_Click, 0, 0 )
.head 7 -  ! 'Перенос на просрочку по ОДНОМУ счету (срок истек)'
.head 7 +  Else If cmbAction=sActProcL1
.head 8 -  Call SalSendMsg( pbProcL1, SAM_Click, 0, 0 )
.head 7 -  ! 'Перенос на просрочку по ОДНОМУ счету частичной суммы'
.head 7 +  Else If cmbAction=sActProcL2
.head 8 -  Call SalSendMsg( pbProcL2, SAM_Click, 0, 0 )
.head 7 -  ! 'Перенос на сомнительную задолженность'
.head 7 +  Else If cmbAction=sActProcS
.head 8 -  Call SalSendMsg( pbProcS, SAM_Click, 0, 0 )
.head 7 -  ! !!!!!!!!
.head 7 +  Else If cmbAction=sActProcL3
.head 8 +  If SalMessageBox ("Выполнить '"||sActProcL3||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 9 +  ! If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 10 +                                                                        If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( 31, 0 )" )
.head 11 -                                                                        Call SqlCommitEx( hSql(),'Авто-пог комісії по оверд.')
.head 11 -                                                                        Call SalWaitCursor(FALSE)
.head 10 +                                                                        Else 
.head 11 -                                                                        Call SqlRollback(hSql())
.head 11 -                                                                        Call SalWaitCursor(FALSE)
.head 11 -                                                                        Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 9 -  Call P_OVR8(12, 0)
.head 7 +  Else If cmbAction=sActProcL4
.head 8 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 9 +  If SalMessageBox ("Выполнить '"||sActProcL4||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 10 +  ! If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 11 +                                                                        If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( 31, TO.Acc_8000 )" )
.head 12 -                                                                        Call SqlCommitEx( hSql(),'Авто-пог-% по оверд.')
.head 12 -                                                                        Call SalWaitCursor(FALSE)
.head 11 +                                                                        Else 
.head 12 -                                                                        Call SqlRollback(hSql())
.head 12 -                                                                        Call SalWaitCursor(FALSE)
.head 12 -                                                                        Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 10 -  Call P_OVR8(12, TO.Acc_2600)
.head 7 +  Else If cmbAction=sActKom
.head 8 +  If SalMessageBox ("Выполнить '"||sActKom||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 9 +  ! If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 10 +                                                                        If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( 31, 0 )" )
.head 11 -                                                                        Call SqlCommitEx( hSql(),'Авто-пог комісії по оверд.')
.head 11 -                                                                        Call SalWaitCursor(FALSE)
.head 10 +                                                                        Else 
.head 11 -                                                                        Call SqlRollback(hSql())
.head 11 -                                                                        Call SalWaitCursor(FALSE)
.head 11 -                                                                        Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 9 -  Call P_OVR8(31, 0)
.head 7 +  Else If cmbAction=sActKom1
.head 8 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and  TO.Acc_8000 != 0
.head 9 +  If SalMessageBox ("Выполнить '"||sActKom1||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 10 +  ! If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 11 +                                                                        If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( 31, TO.Acc_8000 )" )
.head 12 -                                                                        Call SqlCommitEx( hSql(),'Авто-пог-% по оверд.')
.head 12 -                                                                        Call SalWaitCursor(FALSE)
.head 11 +                                                                        Else 
.head 12 -                                                                        Call SqlRollback(hSql())
.head 12 -                                                                        Call SalWaitCursor(FALSE)
.head 12 -                                                                        Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 10 -  Call P_OVR8(31, TO.Acc_2600)
.head 7 -  !
.head 7 +  Else If cmbAction=sActGash
.head 8 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and  TO.Acc_8000 != 0
.head 9 +  If SalMessageBox ("Выполнить '"||sActGash||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 10 +  ! If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 11 +                                                                        If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( 31, TO.Acc_8000 )" )
.head 12 -                                                                        Call SqlCommitEx( hSql(),'Авто-пог-% по оверд.')
.head 12 -                                                                        Call SalWaitCursor(FALSE)
.head 11 +                                                                        Else 
.head 12 -                                                                        Call SqlRollback(hSql())
.head 12 -                                                                        Call SalWaitCursor(FALSE)
.head 12 -                                                                        Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 10 -  Call P_OVR8(33, TO.Acc_2600)
.head 7 +  Else If cmbAction=sActGash1
.head 8 +  If SalMessageBox ("Выполнить '"||sActGash1||"' ?", "Внимание !!!", MB_YesNo+MB_IconQuestion )=IDYES
.head 9 +  ! If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 10 +                                                                        If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( 31, TO.Acc_8000 )" )
.head 11 -                                                                        Call SqlCommitEx( hSql(),'Авто-пог-% по оверд.')
.head 11 -                                                                        Call SalWaitCursor(FALSE)
.head 10 +                                                                        Else 
.head 11 -                                                                        Call SqlRollback(hSql())
.head 11 -                                                                        Call SalWaitCursor(FALSE)
.head 11 -                                                                        Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 9 -  Call P_OVR8(33, 0)
.head 4 -  Line
.head 5 -  Resource Id: 9022
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  14.467"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  14.467"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbGoodcl
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.067"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Select.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  !
.head 7 +  If SalGetWindowState (hWinTOEvents ) = Window_Invalid
.head 8 -  Set hWinTOEvents =SalCreateWindow( TOEvents,hWndMDI)
.head 7 +  Else
.head 8 -  Call SalDestroyWindow ( hWinTOEvents )
.head 8 -  Set hWinTOEvents =SalCreateWindow( TOEvents,hWndMDI)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Кандидаты на овердрафт '
.head 4 +  Pushbutton: client
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.933"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Паспорт клиента-ссудозаемщика'
.head 6 +  On SAM_Click
.head 7 +  If Acc_2600 != NUMBER_Null
.head 8 +  If SqlPrepareAndExecute( hSql(), 
"select max(cu.custtype), max(cu.RNK) INTO :CUSTTYPE, :RNK 
 from customer cu, accounts cc where  cu.rnk=cc.rnk and cc.acc=:Acc_2600")
.head 9 -  Call SqlFetchNext( hSql(), nFetchRezult )
.head 8 +  If CUSTTYPE=2
.head 9 -  Call EditCustCorps(RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
.head 8 +  Else If CUSTTYPE=3
.head 9 -  Call EditCustPerson(RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
.head 8 +  Else If CUSTTYPE=1
.head 9 -  Call EditCustBanks(RNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
.head 4 +  Pushbutton: pbPrcAcc ! Все СЧета
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.5"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Открытые счета клиента'
.head 6 +  On SAM_Click
.head 7 +  If Acc_2600 != NUMBER_Null
.head 8 +  If SqlPrepareAndExecute( hSql(), 
"select  max(cu.RNK) INTO :RNK from customer cu, accounts cc where  cu.rnk=cc.rnk and cc.acc=:Acc_2600")
.head 9 -  Call SqlFetchNext( hSql(), nFetchRezult )
.head 8 -  Call ShowCustAccountsEx(RNK)
.head 4 +  Pushbutton: pbZalog
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    0.476"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_accs.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Yellow
.head 5 -  Background Color: Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Нові угоди забеспечення'
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute( hSql(), 
"select  max(cu.RNK) INTO  :RNK from customer cu, accounts cc where  cu.rnk=cc.rnk and cc.acc=:Acc_2600")
.head 8 -  Call SqlFetchNext( hSql(), nFetchRezult )
.head 8 +  If SqlPrepareAndExecute( hSql(),
  "SELECT acc INTO :ACCS from accounts where nls=:Nls_2600 and kv=:KV")
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call Sel017(hWndMDI,30, 2, 0, STRING_Null,Str(RNK), ACCS )
.head 4 +  Pushbutton: pbZalog_All
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.476"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Існуючі угоди забеспечення'
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute( hSql(),
"select  max(cu.RNK) INTO  :RNK from customer cu, accounts cc where  cu.rnk=cc.rnk and cc.acc=:Acc_2600")
.head 8 -  Call SqlFetchNext( hSql(), nFetchRezult )
.head 8 +  If SqlPrepareAndExecute( hSql(),
  "SELECT acc INTO :ACCS from accounts where nls=:Nls_2600 and kv=:KV")
and SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call Sel017( hWndMDI,30, 11, ND, 'OVER',Str(RNK), ACCS )
.head 4 +  Pushbutton: pbZ
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.933"
.head 6 -  Top:    0.476"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Зв'язок ссудних рахунків та рахунків забеспечення"
.head 6 +  On SAM_Click
.head 7 -  Call Bars017r1
( NUMBER_Null,NUMBER_Null,NUMBER_Null,
"and KU_109.NLSK ="|| Nls_2600 ||" and KVK=" || Str(KV) )
.head 4 +  Pushbutton: pb_Info
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.0"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Информация о свойствах портфеля'
.head 6 +  On SAM_Click
.head 7 -  Call SalMessageBox( NameForm, "Инфо", MB_Ok )
.head 4 +  Pushbutton: pb_T8
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.217"
.head 6 -  Top:    0.476"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Розрахунок ІНТЕГРОВАНОГО показника фін/стану позичальника'
.head 6 +  On SAM_Click
.head 7 +  If Acc_2600 != NUMBER_Null
.head 8 +  If FIN_2 = STRING_Null
.head 9 -  Call MessageError( "Не установлено модуль
"|| strTip )
.head 8 +  Else
.head 9 +  If SqlPrepareAndExecute(hSql(),
"SELECT to_number(c.okpo) INTO :nOkpo from customer c, accounts ca where c.rnk=ca.rnk and ca.acc=:Acc_2600 " ) and
 SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Call DEPO(hWndMDI, IifN(UserType=0, -1, 0), nOkpo)
.head 4 +  Pushbutton: pb_dop !  Пока ОдноОконная (в CustAcnt.apd)
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.833"
.head 6 -  Top:    0.476"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Доп.сведения о клиенте-заемщике'
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute( hSql(), 
"select cu.RNK,cu.CUSTTYPE INTO  :RNK,:CUSTTYPE from customer cu, accounts cc where  cu.rnk=cc.rnk and cc.acc=:Acc_2600 and rownum=1")
.head 8 -  Call SqlFetchNext( hSql(), nFetchRezult )
.head 8 +  If UserType=0
.head 9 -  Call F_Frm_DR( RNK, CUSTTYPE, CVIEW_ReadOnly )
.head 8 +  Else
.head 9 -  Call F_Frm_DR(RNK,CUSTTYPE, 0 )
.head 4 +  Pushbutton: pb_dop1 ! МногоОконная
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.333"
.head 6 -  Top:    0.476"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Arr2tor.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Sky
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Включить Доп.реквизит в таблицу'
.head 6 +  On SAM_Click
.head 7 -  Set DOP_TAG = STRING_Null
.head 7 -  Call FunNSIGetFiltered
("CUSTOMER_FIELD","NAME","(U is NOT null OR F is NOT null) ORDER BY TAG ",
 DOP_TAG, DOP_NAME )
.head 4 +  Data Field: DOP_TAG
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.833"
.head 7 -  Top:    0.476"
.head 7 -  Width:  1.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Sky
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: DOP_NAME
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.833"
.head 7 -  Top:    0.476"
.head 7 -  Width:  2.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Sky
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbCRD
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.5"
.head 6 -  Top:    0.476"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\cabinet.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = ' Кількісний (бланковий) облік договорів'
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute( hSql(), "SELECT a.grp INTO :sGr FROM accounts a WHERE a.acc=:nAcc ") and SqlFetchNext( hSql(), nFetchRes) 
.head 8 -  ! Call Sel017(hWndMDI,nTip_Ur, 200, N_ND, sGr, Str(nRnk),ACCS )
.head 8 -  Call Sel017(hWndMDI,AccesLevel, 200, TO.ND, sGr , Str(TO.RNK) , ACCS )
.head 4 +  Pushbutton: pb_DopW
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.983"
.head 6 -  Top:    0.488"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Childs.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Додаткові Реквізити Угоди'
.head 6 +  On SAM_Click
.head 7 +  If ND
.head 8 -  Call FunNSIEditF("CC_DOPW[NSIFUNCTION][PROC=>PUL.put( 'ND', '" || Str(ND) || "' )][EXEC=>BEFORE]", 2 )
.head 2 +  Contents
.head 3 +  Column: USERID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кр.
инсп

1
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
дог.

2
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Название
клиента

3
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NDOC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
дог

4
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SqlPrepareAndExecute( hSql(),
 "UPDATE acc_over SET ndoc=:TO.ND WHERE acc=:TO.Acc_2600 ")
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SaveFInfoToLog('OVR: № дог.'|| TO.NDOC )
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 3 +  Column: DOP_VAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DNEY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дни
Кален.
Банк.
5
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDatd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
начала.
дог.
6
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDatd2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
оконч.
дог.
7
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
Погашения

8
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
Вал

9
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBlkD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Бл.Деб
осн. сч.

10
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SqlPrepareAndExecute( hSql(),
 "UPDATE accounts SET tip=decode(:TO.colBlkD,1,'BLD','ODB') WHERE acc=:TO.Acc_2600 ")
.head 7 -  Call SaveFInfoToLog('OVR: № дог.'|| TO.NDOC ||' Блк='||Str(TO.colBlkD ))
.head 7 -  Call SqlCommit(hSql())
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 3 -  !
.head 3 +  Column: colFlag9
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Бл. 
неисп.
лим.
11
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nAccTek=TO.Acc_2600
.head 6 -  Set colFlagS = colFlag9*2 + colFlag+Int_Per*4
.head 6 +  If SqlPrepareAndExecute( hSql(), "UPDATE acc_over SET flag = :TO.colFlagS WHERE acc=:nAccTek")
.head 7 -  Call SaveFInfoToLog('OVR: № дог.'|| TO.NDOC ||' Флаг ='||Str(TO.colFlagS ))
.head 7 -  Call SqlCommit(hSql())
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 3 +  Column: Int_Per
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Нач.проц
от периода

12
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nAccTek=TO.Acc_2600
.head 6 -  Set colFlagS = colFlag9*2 + colFlag+Int_Per*4
.head 6 +  If SqlPrepareAndExecute( hSql(), "UPDATE acc_over SET flag = :TO.colFlagS WHERE acc=:nAccTek")
.head 7 -  Call SaveFInfoToLog('OVR: № дог.'|| TO.NDOC ||' Флаг ='||Str(TO.colFlagS ))
.head 7 -  Call SqlCommit(hSql())
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 3 +  Column: Nls_2600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Основной
счет

12
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpE = Nls_2600
.head 5 +  On SAM_AnyEdit
.head 6 -  Set Nls_2600 = sTmpE
.head 3 +  Column: Ost_2600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на основном
счете
13
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Nls_3739
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сч.гашения
3739

12-а
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpE = Nls_3739
.head 5 +  On SAM_AnyEdit
.head 6 -  Set Nls_3739 = sTmpE
.head 3 +  Column: Ost_3739
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на сч.гаш.

13-а
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Lim_dog
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лимит по
договору

14
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: Dos_2600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дебет
осн. сч.

15
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Lim_2600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Текущий
лимит
овердр.
16
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nTmp = Lim_2600 * 100 
.head 6 +  If SqlPrepareAndExecute( hSql(),
 "UPDATE accounts SET lim=:nTmp WHERE acc=:TO.Acc_2600 ")
.head 7 -  Call SaveFInfoToLog('OVR: № дог.'|| TO.NDOC ||' Блк='||Str(TO.colBlkD ))
.head 7 -  Call SqlCommit(hSql())
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 3 +  Column: Max_2600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Максимум
проплаты
с уч.лим.
17
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Lim_Yes
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
использ.
лимита
18
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Lim_No
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма 
НЕиспольз.
лимита
19
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  !
.head 3 +  Column: Nls_2607
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
Счет

20
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpE = Nls_2607
.head 5 +  On SAM_AnyEdit
.head 6 -  Set Nls_2607 = sTmpE
.head 3 +  Column: Ost_2607
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
Остаток

21
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Int_2600a
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Осн. %
став

22
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set nAcc=Acc_2067
.head 3 +  Column: Nls_2067 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
просрочки

23
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpE = Nls_2067
.head 5 +  On SAM_AnyEdit
.head 6 -  Set Nls_2067 = sTmpE
.head 3 +  Column: Nls_3578
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
комиссии

24
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpE = Nls_3578
.head 5 +  On SAM_AnyEdit
.head 6 -  Set Nls_3578 = sTmpE
.head 3 +  Column: Ost_3578
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Комиссия


25
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Nls_9129
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
неисп.
лим.
26
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpE = Nls_9129
.head 5 +  On SAM_AnyEdit
.head 6 -  Set Nls_9129 = sTmpE
.head 3 +  Column: Ost_9129
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ост.
неисп.
лим.
27
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: Acc_2600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_2067
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_2607
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_9129
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_8000
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFlag
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кл
гас.
сам
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nAccTek=TO.Acc_2600
.head 6 -  Set colFlagS = colFlag9*2 + colFlag+Int_Per*4
.head 6 +  If SqlPrepareAndExecute( hSql(),
 "UPDATE acc_over SET flag = :TO.colFlagS WHERE acc=:nAccTek")
.head 7 -  Call SaveFInfoToLog('OVR: № дог.'|| TO.NDOC ||' Флаг ='||Str(TO.colFlagS ))
.head 7 -  Call SqlCommit(hSql())
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 3 +  Column: colFlagS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Все флаги
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сост
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAPP_2600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
оконч.
дог.
5
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCrisk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Фин.
сост.

28
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Obs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сост.
обсл.
долга
(код)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SqlPrepareAndExecute( hSql(),
 "UPDATE acc_over SET obs=:TO.Obs WHERE acc=:TO.Acc_2600 ")
.head 7 -  Call SqlCommit(hSql())
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 3 +  Column: Obsname
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сост.
обсл.
долга
29
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S080
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: S080
(реальный)

30
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCriskcalc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: S080
(расчетный)

31
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_2096
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Nls_2096
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cчет сомн.
задолжен.

32
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpE = Nls_2096
.head 5 +  On SAM_AnyEdit
.head 6 -  Set Nls_2096 = sTmpE
.head 3 +  Column: Ost_2096
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на счете
сомн.задолж.
33
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_2480
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Nls_2480
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cчет сомн.
%% долга

34
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.833"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpE = Nls_2480
.head 5 +  On SAM_AnyEdit
.head 6 -  Set Nls_2480 = sTmpE
.head 3 +  Column: Ost_2480
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток на
счете сомн.
%% долга
35
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: SetColorRow
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nInd
.head 5 -  ! Number: nDig
.head 4 +  Actions
.head 5 -  ! Дата погашения
.head 5 +  If MDATE < dDat and Lim_Yes != 0        ! Просрочено
.head 6 -  Set nInd=COLOR_Red
.head 5 +  Else If MDATE = dDat and Lim_Yes != 0   ! Погашение сегодня
.head 6 -  Set nInd=COLOR_DarkGreen
.head 5 +  Else If MDATE > dDat and MDATE <= aDat[0] and Lim_Yes != 0 ! Погашение приближается c разрывом в 1 банк день
.head 6 -  Set nInd=COLOR_DarkBlue
.head 5 +  Else
.head 6 -  Set nInd=COLOR_Black
.head 5 -  Call SalTblSetCellTextColor( MDATE, nInd, FALSE )
.head 5 -  ! Сальдо 2000
.head 5 +  If Lim_Yes > 0
.head 6 -  Set nInd=COLOR_DarkBlue
.head 5 +  Else If Lim_Yes < 0
.head 6 -  Set nInd=COLOR_Red
.head 6 -  Set Lim_Yes = - Lim_Yes
.head 5 +  Else
.head 6 -  Set nInd=COLOR_Black
.head 5 -  Call SalTblSetCellTextColor( Lim_Yes, nInd, FALSE )
.head 5 -  ! Сальдо 2600
.head 5 +  If Ost_2600 > 0
.head 6 -  Set nInd=COLOR_DarkBlue
.head 5 +  Else If Ost_2600 < 0
.head 6 -  Set nInd=COLOR_Red
.head 5 +  Else
.head 6 -  Set nInd=COLOR_Black
.head 5 -  Call SalTblSetCellTextColor( Ost_2600, nInd, FALSE )
.head 5 -  ! Лимит Lim_No
.head 5 +  If Lim_No > 0
.head 6 -  Set nInd=COLOR_DarkBlue
.head 5 +  Else If Lim_No < 0
.head 6 -  Set nInd=COLOR_Red
.head 5 +  Else
.head 6 -  Set nInd=COLOR_Black
.head 5 -  Call SalTblSetCellTextColor( Lim_No, nInd, FALSE )
.head 5 -  ! Сальдо 2008
.head 5 +  If Ost_2607 > 0
.head 6 -  Set nInd=COLOR_DarkBlue
.head 5 +  Else If Ost_2607 < 0
.head 6 -  Set nInd=COLOR_Red
.head 6 -  Set Ost_2607 = - Ost_2607
.head 5 +  Else
.head 6 -  Set nInd=COLOR_Black
.head 5 -  Call SalTblSetCellTextColor( Ost_2607, nInd, FALSE )
.head 5 +  If Ost_2096 < 0
.head 6 -  Set nInd=COLOR_Red
.head 6 -  Set Ost_2096=Abs(Ost_2096)
.head 5 +  Else
.head 6 -  Set nInd=COLOR_Black
.head 5 -  Call SalTblSetCellTextColor( Ost_2096, nInd, FALSE )
.head 5 +  If Ost_2480 < 0
.head 6 -  Set nInd=COLOR_Red
.head 6 -  Set Ost_2480=Abs(Ost_2480)
.head 5 +  Else
.head 6 -  Set nInd=COLOR_Black
.head 5 -  Call SalTblSetCellTextColor( Ost_2480, nInd, FALSE )
.head 5 -  !
.head 5 +  If Lim_dog != Lim_2600 and Lim_2600 != NUMBER_Null
.head 6 -  Call XSalTblSetCellBackColor( Lim_2600, SalColorFromRGB( 255,210,250 ) )
.head 5 +  If colSos=1 and (TO.Ost_2096=NUMBER_Null or TO.Ost_2096=0)
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
.head 5 +  Else If colSos=1 and TO.Ost_2096!=0
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Orchid )
.head 5 +  If S080 != colCriskcalc
.head 6 -  Call XSalTblSetCellBackColor( colCriskcalc, SalColorFromRGB( 255,210,250 ) )
.head 5 +  If colDatd2 < dDat and Lim_Yes != 0  and colSos!=1      ! Просрочено
.head 6 -  Set nInd=COLOR_Salmon
.head 5 +  Else If colDatd2 = dDat and Lim_Yes != 0    and colSos!=1 ! Погашение сегодня
.head 6 -  Set nInd=COLOR_LightGreen	
.head 5 +  Else If colDatd2 > dDat and colDatd2 <= dDat+7 and Lim_Yes != 0    and colSos!=1 ! погашение втечение 7 дней 
.head 6 -  Set nInd=COLOR_LightAqua
.head 5 +  Else
.head 6 -  Set nInd=COLOR_White
.head 5 +  If nInd!=COLOR_White
.head 6 -  Call XSalTblSetCellBackColor( colDatd2, nInd)
.head 3 +  Function: P_OVR8
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nPar 
.head 5 -  Number: acc_2000
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCurrentRow
.head 5 -  Boolean: Result
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set Result=TRUE
.head 5 +  ! If nPar=0
.head 6 +                             If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 7 +                             If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( 3, acc_2000,NUMBER_Null,NUMBER_Null )" )
.head 8 -                             Call SqlCommitEx( hSql(),'Авто-пог-% по оверд.')
.head 8 -                             Call SalWaitCursor(FALSE)
.head 7 +                             Else 
.head 8 -                             Call SqlRollback(hSql())
.head 8 -                             Call SalWaitCursor(FALSE)
.head 8 -                             Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 5 +  ! If nPar=31
.head 6 +                             If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 7 +                             If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( 31, acc_2000,NUMBER_Null,NUMBER_Null )" )
.head 8 -                             Call SqlCommitEx( hSql(),'Авто-пог- комісії по оверд.')
.head 8 -                             Call SalWaitCursor(FALSE)
.head 7 +                             Else 
.head 8 -                             Call SqlRollback(hSql())
.head 8 -                             Call SalWaitCursor(FALSE)
.head 8 -                             Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 5 +  ! Else If nPar=1 
.head 6 +                             If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 7 +                             If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( nPar, acc_2000,NUMBER_Null,NUMBER_Null)" )
.head 8 -                             Call SqlCommitEx( hSql(),'Авто-пог.тек.% по оверд.')
.head 8 -                             Call SalWaitCursor(FALSE)
.head 7 +                             Else 
.head 8 -                             Call SqlRollback(hSql())
.head 8 -                             Call SalWaitCursor(FALSE)
.head 8 -                             Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 5 +  ! Else If nPar=2
.head 6 +                             If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 7 +                             If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( nPar, acc_2000,NUMBER_Null,NUMBER_Null)" )
.head 8 -                             Call SqlCommitEx( hSql(),'Перенос на просрочку по оверд.')
.head 8 -                             Call SalWaitCursor(FALSE)
.head 7 +                             Else 
.head 8 -                             Call SqlRollback(hSql())
.head 8 -                             Call SalWaitCursor(FALSE)
.head 8 -                             Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 5 +  ! Else If nPar=22
.head 6 +                             If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 7 +                             If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( 2, acc_2000,SUM,SUM_PR)" )
.head 8 -                             Call SqlCommitEx( hSql(),'Перенос на просрочку по оверд. част. суммы')
.head 8 -                             Call SalWaitCursor(FALSE)
.head 7 +                             Else 
.head 8 -                             Call SqlRollback(hSql())
.head 8 -                             Call SalWaitCursor(FALSE)
.head 8 -                             Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 5 +  ! Else If nPar=96
.head 6 +                             If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 7 +                             If SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( nPar, acc_2000,NUMBER_Null,NUMBER_Null)" )
.head 8 -                             Call SqlCommitEx( hSql(),'Перенос на сомнительную задолженность')
.head 8 -                             Call SalWaitCursor(FALSE)
.head 7 +                             Else 
.head 8 -                             Call SqlRollback(hSql())
.head 8 -                             Call SalWaitCursor(FALSE)
.head 8 -                             Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 5 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 6 +  If not acc_2000
.head 7 +  If sFilter!=STRING_Null
.head 8 +  If SalMessageBox( "Выпонить "||cmbAction||", используя установенный фильтр?" , "Внимание!", 1)=2
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Return 0
.head 7 -  Set nCurrentRow=TBL_MinRow
.head 7 -  ! Call DebugN(nCurrentRow)
.head 7 +  While SalTblFindNextRow( TO, nCurrentRow, 0, 0 )
.head 8 -  Call SalTblSetContext(TO,nCurrentRow)
.head 8 +  If colSos!=1 and TO.Acc_2600!=NUMBER_Null
.head 9 +  If not SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( nPar, TO.Acc_2600,SUM,SUM_PR)" )
.head 10 -  Set Result=FALSE
.head 9 -  ! Call DebugN(TO.Acc_2600)
.head 6 +  Else
.head 7 +  If not SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( nPar, acc_2000,SUM,SUM_PR)" )
.head 8 -  Set Result=FALSE
.head 6 +  If Result
.head 7 -  Call SqlCommitEx( hSql(),cmbAction||IifS(sFilter!=""," с использованием фильтра",""))
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1 )
.head 5 -  !
.head 5 -  Call SalSendMsg( TO.pbRefresh, SAM_Click, 0, 0 )
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: IfAccExists
.head 4 -  Description: Check to see if input account in GL
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sNls
.head 5 -  Number: nKv
.head 5 -  Receive Number: nAccN
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTmp
.head 5 -  Number: nR1 !! Рег № осн счета
.head 5 -  Number: nI1 !! исполнитель осн счета
.head 5 -  String: sN1  !! NLS осн счета
.head 5 -  String: sNMS !! NMS осн счета
.head 5 -  Number: nGrp !! Grp осн счета
.head 4 +  Actions
.head 5 -  Set nAccN=NUMBER_Null
.head 5 +  If sNls
.head 6 +  If SqlPrepareAndExecute( hSql(),
'SELECT acc INTO :nAccN FROM accounts WHERE kv=:nKv AND nls=:sNls' )
.head 7 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 8 +  If SalMessageBox('Счет '||sNls||'/'||Str(nKv)||' не открыт.'||PutCrLf()||
   ' Открыть ?', 'Внимание!', MB_YesNo | MB_IconHand) = IDYES
.head 9 -  Call SqlPrepareAndExecute( hSql(),
"SELECT a.rnk,a.isp,a.nms,a.grp INTO :nR1,:nI1,:sNMS,:nGrp
 FROM accounts a WHERE a.acc=:nAcc ")
.head 9 +  If SqlFetchNext( hSql(), nFetchRes ) and
   Op_Reg(99,0,0,nGrp,nTmp,nR1,sNls,nKv,
   SalStrLeftX("Ліміт ОВЕРДРАФТУ "||SalStrTrimX(sNMS),70),'ODB', nI1, nAccN)
.head 10 -  Call SqlCommit( hSql() )
.head 10 -  Call SaveFInfoToLog( "АвтоОткрытие сч."||sNls||"/"||Str(nKv))
.head 9 +  Else
.head 10 -  Call SqlRollback( hSql() )
.head 5 -  Return TRUE
.head 3 +  Function: CalcS080
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: Fin
.head 5 -  Number: Obs
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nS080t
.head 5 -  Number: nT
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(),
 "SELECT f.s080 INTO :nS080t FROM fin_obs_s080 f 
   WHERE f.FIN=:Fin and f.obs=:Obs ")
.head 6 -  Call SqlFetchNext(hSql(),nT)
.head 6 -  Return nS080t
.head 3 +  Function: DelOvrAccounts
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: ACCO
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: ACC2607_
.head 5 -  Number: ACC2067_
.head 5 -  Number: ACC2069_
.head 5 -  Number: ACC9129_
.head 5 -  Number: ACC8000_
.head 5 -  Number: ACC2096_
.head 5 -  Number: ACC3578_
.head 5 -  Number: ACCtmp_
.head 5 -  String: sOvrpar
.head 4 +  Actions
.head 5 -  If SqlPrepareAndExecute ( hSql(),"select i1.ACRA,
                                         ov.ACC_2067,
	                                 i2.ACRA,
                                         ov.ACC_8000,
                                         i3.ACRA,
                                         ov.ACC_9129,
                                         ov.ACC_2096
                                  into 
                                       :ACC2607_,
                                       :ACC2067_,
                                       :ACC2069_,
                                       :ACC8000_,
                                       :ACC3578_,
                                       :ACC9129_,
                                       :ACC2096_
                          from acc_over ov, int_accn i1, int_accn i2, int_accn i3 
                          where ov.acc=i1.acc(+) and ov.acc_2067=i2.acc(+) and ov.ACC_8000=i3.ACC(+)
	                         and i1.ID(+)=0  and i2.ID(+)=0  and i3.ID(+)=0 and nvl(ov.sos,0)<>1
                                 and ov.acc=:ACCO") and SqlFetchNext(hSql(),NFetchRez)
.head 5 -  ! Call Debug('2607='||SalNumberToStrX( ACC2607_, 0)||' 2067='||SalNumberToStrX( ACC2067_, 0)||' 2069='||SalNumberToStrX( ACC2069_, 0)||' 8000='||SalNumberToStrX( ACC8000_, 0)||' 9129='||SalNumberToStrX( ACC9129_, 0) )
.head 5 +  If not SqlPLSQLCommand(hSql(), "BARS.OVR.P_OVR8z( 8, Acc_2600,NUMBER_Null,NUMBER_Null)" )
.head 6 -  Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'OVR.P_OVR8z', 30, 1)
.head 6 -  Return FALSE
.head 5 +  ! If SqlPrepareAndExecute ( hSql(), 
" select val into :sOvrpar  from params
   where par = 'OVRFLAGS' " )
.head 6 -                                                                   Call SqlFetchNext(hSql(),NFetchRez)
.head 6 +                                                                   If sOvrpar != STRING_Null
.head 7 +                                                                   If SalStrScan(sOvrpar,'DELACC') != -1 
.head 8 +                                                                   If not (SqlPrepareAndExecute( hSql(), 'Delete from int_ratn where acc=:ACCO and id=0' ) and SqlPrepareAndExecute( hSql(), 'Delete from int_accn where acc=:ACCO and id=0' ))
.head 9 -                                                                   Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 9 -                                                                   Return FALSE
.head 8 +                                                                   If not  DelAcc(ACC2607_)
.head 9 -                                                                   Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 9 -                                                                   Return FALSE
.head 8 +                                                                   If not  DelAcc(ACC2067_)
.head 9 -                                                                   Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 9 -                                                                   Return FALSE
.head 8 +                                                                   If not  DelAcc(ACC2069_)
.head 9 -                                                                   Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 9 -                                                                   Return FALSE
.head 8 +                                                                   If not  DelAcc(ACC8000_)
.head 9 -                                                                   Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 9 -                                                                   Return FALSE
.head 8 +                                                                   If not  DelAcc(ACC3578_)
.head 9 -                                                                   Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 9 -                                                                   Return FALSE
.head 8 +                                                                   If not  DelAcc(ACC9129_)
.head 9 -                                                                   Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 9 -                                                                   Return FALSE
.head 8 +                                                                   If not  DelAcc(ACC2096_)
.head 9 -                                                                   Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 9 -                                                                   Return FALSE
.head 8 -                                                                   Return TRUE
.head 5 +  If OVR_PAR_VAL('DELACC') = 'TRUE' 
.head 6 +  If not SqlPrepareAndExecute( hSql(), 'Delete from int_ratn where acc=:ACCO     and id=0' ) 
.head 7 -  Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 7 -  Return FALSE
.head 6 +  If not  DelAcc(ACC2607_)
.head 7 -  Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 7 -  Return FALSE
.head 6 +  If not  DelAcc(ACC2067_)
.head 7 -  Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 7 -  Return FALSE
.head 6 +  If not  DelAcc(ACC2069_)
.head 7 -  Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 7 -  Return FALSE
.head 6 +  If not  DelAcc(ACC8000_)
.head 7 -  Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 7 -  Return FALSE
.head 6 +  If not  DelAcc(ACC3578_)
.head 7 -  Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 7 -  Return FALSE
.head 6 +  If not  DelAcc(ACC9129_)
.head 7 -  Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 7 -  Return FALSE
.head 6 +  If not  DelAcc(ACC2096_)
.head 7 -  Call MessageNoWait( 'Ошибка при закрытии счетов договора !', 'OVR.P_OVR8z', 30, 1)
.head 7 -  Return FALSE
.head 6 +  If SqlPrepareAndExecute( hSql(), "select acc into :ACCtmp_ from cc_accp  where accs=:ACCO and acc not in (select acc from cc_accp where ACCS!=:ACCO)" )
.head 7 +  While SqlFetchNext( hSql(), nFetchRezult )
.head 8 +  If not  DelAcc(ACCtmp_)
.head 9 -  Call MessageNoWait( 'Ошибка при закрытии счетов залога договора !', 'OVR.P_OVR8z', 30, 1)
.head 9 -  Return FALSE
.head 6 -  Return TRUE
.head 5 -  Return TRUE
.head 3 +  Function: DelAcc
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: ACC
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: DAZS_
.head 5 -  Number: TmpN_
.head 4 +  Actions
.head 5 -  If SqlPrepareAndExecute(hSql(), 'select dazs into :DAZS_ from accounts where acc=:ACC') and 
SqlFetchNext( hSql(), NFetchRez )
.head 5 +  If ACC=NUMBER_Null or ACC=0 or DAZS_!=DATETIME_Null
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 +  If CloseAccount2(ACC) and SqlPrepareAndExecute( hSql(), 'Delete from int_ratn where acc=:ACC and id=0' ) 
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Return FALSE
.head 3 +  Function: SetAdmOpt
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: NbsMainAcc
.head 5 -  Number: UserType !  1-Функции кредитчика, 2-Функции бухгалтера, 4-Функции Залоговика (и все варианті сумм)
.head 5 -  Number: AccesLevel! (Уровень доступа 0-Полный, 1-Свой отдел, 2-Только свои договора)
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: NPos
.head 5 -  Boolean: Res
.head 5 -  String: StrTmp
.head 4 +  Actions
.head 5 +  If NbsMainAcc=STRING_Null or Subs( NbsMainAcc,1,1 )='N'  or Subs( NbsMainAcc,1,1 )='R'
.head 6 -  Call SalHideWindow( TO.pb_Info )
.head 6 -  Return 0
.head 5 -  Set StrFilter=NbsMainAcc
.head 5 -  Set Res=FALSE
.head 5 -  Set AskInsp=FALSE
.head 5 -  Set AskBuh=FALSE
.head 5 -  Set AskZal=FALSE
.head 5 +  Loop
.head 6 -  Set NPos=SalStrScan(StrFilter,';')
.head 6 +  If NPos<0 
.head 7 -  Break
.head 6 +  Else
.head 7 -  Set StrFilter=SalStrLeftX ( StrFilter, NPos)||"' , '"||SalStrRightX ( StrFilter, SalStrLength(StrFilter)-NPos-1)
.head 7 -  Set Res=TRUE
.head 5 +  If AccesLevel=1
.head 6 -  Set StrTmp='where userid in (select ou1.userid from otd_user ou1,otd_user ou2 where ou2.userid='||SalNumberToStrX( GetUserId(),0)||' and ou2.otd=ou1.otd)'
.head 5 +  Else If AccesLevel=2
.head 6 -  Set StrTmp='where userid ='||SalNumberToStrX( GetUserId(),0)
.head 5 +  If Res
.head 6 -  Set StrFilter="  (select acc from accounts where acc in (select acc from acc_over "|| StrTmp ||") and nbs in ('"||StrFilter||"'))"
.head 5 +  Else If StrFilter!=STRING_Null
.head 6 -  Set StrFilter="  (select acc from accounts where acc in (select acc from acc_over "|| StrTmp ||") and nbs ='"||StrFilter||"')"
.head 5 +  If SalNumberMod (UserType,2)>0 
.head 6 -  Set AskInsp=TRUE
.head 5 +  If SalNumberMod (UserType,4)>1 
.head 6 -  Set AskBuh=TRUE
.head 5 +  If UserType>3 
.head 6 -  Set AskZal=TRUE
.head 5 +  If AskInsp=FALSE
.head 6 -  Call SalDisableWindow( pbIns )
.head 6 -  Call SalDisableWindow(pbDel )
.head 6 -  Call SalDisableWindow( pbUpdate )
.head 6 -  Call SalDisableWindow( pbUpdate )
.head 6 -  Call SalDisableWindow( pb_MOS )
.head 6 -  Call SalDisableWindow( pb_MOS_Ex )
.head 6 -  Call SalTblSetColumnFlags ( TO.colBlkD,2,FALSE)
.head 5 +  If AskBuh=FALSE
.head 6 -  Call SalDisableWindow( pbExecute )
.head 6 -  Call SalDisableWindow(cmbAction )
.head 5 +  If AskZal=FALSE
.head 6 -  Call SalDisableWindow( pbZalog )
.head 6 -  Call SalDisableWindow(pbZalog_All )
.head 6 -  Call SalDisableWindow(pbZ)
.head 5 +  Set NameForm="Портфель овердрафтов "||IifS(AccesLevel=1,"по подразделению 
","")||IifS(AccesLevel>0,"пользователя №"||SalNumberToStrX( GetUserId(),0),"")||" по балансовым счетам ("||NbsMainAcc||")
 c функциональностью"||IifS(not (AskInsp or AskBuh or AskZal)," просмотра","")||IifS( AskInsp," кредитного инспектора"||IifS( (AskBuh or AskZal),",",""),"")||IifS(AskBuh," 
бухгалтера"||IifS(AskZal,",",""),"")||IifS(AskZal," залоговика","")||IifS(SalStrUpperX( strType )='MDATE',".
 Установка даты от договора",". Установка даты от первого дебета")
.head 6 -  Call SalDisableWindow( pbZalog )
.head 6 -  Call SalDisableWindow(pbZalog_All )
.head 6 -  Call SalDisableWindow(pbZ)
.head 5 -  Call SalSetWindowText(TO,"Портфель овердрафтов")
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPar
.head 3 -  String: strType
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  Number: OVR_3739  ! признак использования счета гашения 3739. Исп в ГОУ ОБ
.head 3 -  String: sTmpE  
.head 3 -  Date/Time: dDat
.head 3 -  Number: nId
.head 3 -  Window Handle: hWndCol
.head 3 -  Number: nTmp
.head 3 -  Number: nAcc
.head 3 -  Number: nAccTek
.head 3 -  Number: nOldOst
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  Number: nS
.head 3 -  Number: nDk
.head 3 -  String: sKontrA
.head 3 -  String: sKontrN
.head 3 -  String: sTmp
.head 3 -  Number: i
.head 3 -  Date/Time: dTmp
.head 3 -  Date/Time: aDat[*]
.head 3 -  Boolean: bSortOrd
.head 3 -  Number: nColHan
.head 3 -  Number: nKol
.head 3 -  Number: n
.head 3 -  String: temstr
.head 3 -  String: sOkpob
.head 3 -  Number: nRez
.head 3 -  Number: nI
.head 3 -  Number: nRow
.head 3 -  Number: nRecCount
.head 3 -  Number: nFetchRezult
.head 3 -  Number: nDogToArcCount
.head 3 -  String: sTempStr
.head 3 -  String: sNls2067
.head 3 -  String: sNls2069
.head 3 -  String: sStrPrs
.head 3 -  Number: nRowNum
.head 3 -  !
.head 3 -  Number: g1
.head 3 -  Number: g8
.head 3 -  Number: g10
.head 3 -  Number: g11
.head 3 -  Number: g12
.head 3 -  Number: g13
.head 3 -  Number: g14
.head 3 -  Number: g17
.head 3 -  !
.head 3 -  String: sActProcN
.head 3 -  String: sActProcN1
.head 3 -  String: sActProcP
.head 3 -  String: sActProcP1
.head 3 -  String: sActProcZ
.head 3 -  String: sActProcZ1
.head 3 -  String: sActProcL
.head 3 -  String: sActProcS
.head 3 -  String: sActProcL1
.head 3 -  String: sActProcL2
.head 3 -  String: sActProcL3
.head 3 -  String: sActProcL4
.head 3 -  String: sActKom
.head 3 -  String: sActKom1
.head 3 -  String: sActGash
.head 3 -  String: sActGash1
.head 3 -  String: NAM_KATZ
.head 3 -  !
.head 3 -  Number: nEdAcc ! флаг признак возможности редактировать карточку счета
.head 3 -  Number: nEdAccFlag
.head 3 -  ! NAM_KATZ
.head 3 -  Number: nNd
.head 3 -  Number: KODZ
.head 3 -  Number: nNd2
.head 3 -  Number: ACC_2600
.head 3 -  Number: CUSTTYPE
.head 3 -  Number: RNK
.head 3 -  Number: SUM
.head 3 -  Number: SUM_PR
.head 3 -  Number: NFetchRez
.head 3 -  Number: TMP
.head 3 -  Number: OSTC_2067
.head 3 -  Number: OSTC_2069
.head 3 -  Number: OSTB_2067
.head 3 -  Number: OSTB_2069
.head 3 -  Number: OSTC_2600
.head 3 -  Number: OSTC_2607
.head 3 -  Number: ACCS
.head 3 -  Boolean: AskInsp
.head 3 -  Boolean: AskBuh
.head 3 -  Boolean: AskZal
.head 3 -  String: StrFilter
.head 3 -  Number: UserType !  1-Функции кредитчика, 2-Функции бухгалтера, 4-Функции Залоговика (и все варианті сумм)
.head 3 -  Number: AccesLevel! (Уровень доступа 0-Полный, 1-Свой отдел, 2-Только свои договора)
.head 3 -  String: sGr
.head 3 -  String: NameForm
.head 3 -  String: sFilter
.head 3 -  String: FIN_2
.head 3 -  Number: nOkpo
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  ! признак использования счета гашения 3739. Исп в ГОУ ОБ
.head 4 -  Set OVR_3739 = GetGlobalOptionEx('OVR_3739')
.head 4 +  If OVR_3739 = 1
.head 5 -  Call SalShowWindow( Nls_3739 )
.head 5 -  Call SalShowWindow( Ost_3739 )
.head 4 +  Else
.head 5 -  Call SalHideWindow( Nls_3739 )
.head 5 -  Call SalHideWindow( Ost_3739 )
.head 4 +  If SqlPrepareAndExecute( hSql(),
 "SELECT val into :FIN_2 from params where par='FIN_2' " ) and
not SqlFetchNext( hSql(),nFetchRes)
.head 5 -  Set FIN_2 = STRING_Null
.head 4 -  Set sActProcN ='Начислить % 2600+9129 по ПОРТФЕЛЮ'
.head 4 -  Set sActProcN1='Начислить % 2600+9129 по счету'
.head 4 -  Set sActProcP ='Погасить максимум % по ПОРТФЕЛЮ'
.head 4 -  Set sActProcP1='Погасить максимум % по счету'
.head 4 -  Set sActProcZ ='Погасить % по ПОРТФЕЛЮ (срок истек)'
.head 4 -  Set sActProcZ1='Погасить % по счету (срок истек)'
.head 4 -  Set sActProcL ='Перенос на просрочку по ПОРТФЕЛЮ'
.head 4 -  Set sActProcL1='Перенос на просрочку по счету'
.head 4 -  Set sActProcL2='Перенос на просрочку частичной суммы'
.head 4 -  Set sActProcL3='Перенос просроч % 2607->2069 по ПОРТФЕЛЮ'
.head 4 -  Set sActProcL4='Перенос просроч % 2607->2069 по счету'
.head 4 -  Set sActProcS ='Перенос на сомнительную задолженность'
.head 4 -  Set sActKom='Погасить комиссию по Портфелю'
.head 4 -  Set sActKom1='Погасить комиссию по счету'
.head 4 -  Set sActGash='Погасить все долги по счету'
.head 4 -  Set sActGash1='Погасить все долги по ПОРТФЕЛЮ'
.head 4 -  Set TO.dDat   = GetBankDate()
.head 4 -  Set UserType=SalNumberMod( nPar, 10 )
.head 4 -  Set AccesLevel=(nPar-SalNumberMod( nPar, 10 ))/10
.head 4 -  ! Call DebugN( AccesLevel)
.head 4 -  If nPar
.head 4 -  Call SetAdmOpt(strPar02,UserType,AccesLevel) 
.head 4 -  ! Call Debug(StrFilter)
.head 4 -  !
.head 4 -  Set KODZ=SalStrToNumber( OVR_PAR_VAL('KODZ') )
.head 4 +  If OVR_PAR_VAL('KODZ')=STRING_Null
.head 5 -  Call SalHideWindow( pb_MOS_Ex )
.head 5 -  ! Call SalHideWindow( pb_MOS)
.head 4 +  If OVR_PAR_VAL('MOS')!='1'
.head 5 -  Call SalHideWindow( pb_MOS_Ex )
.head 5 -  Call SalHideWindow( pb_MOS)
.head 4 +  Else
.head 5 +  If SqlPrepareAndExecute( hSql(), 'select name into :NAM_KATZ from zapros where KODZ=:KODZ')
.head 6 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 4 -  Set TO.nTabInstance = 1
.head 4 -  Set TO.fFilterAtStart =1
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 9)
.head 4 -  Set nFlags=GT_NoRet
.head 4 +  If Subs(strPar02,1,1)='N'
.head 5 -  ! Call SalDisableWindow( pbProcZ )
.head 5 -  ! Call SalDisableWindow( pbProcZ1 )
.head 4 +  Else If Subs(strPar02,1,1)='R' ! только просмотр 
.head 5 -  ! Call SalDisableWindow( pbProcZ )
.head 5 -  ! Call SalDisableWindow( pbProcZ1 )
.head 5 -  ! Call SalDisableWindow( pbProcL )
.head 5 -  ! Call SalDisableWindow( pbProcL1 )
.head 5 -  ! Call SalDisableWindow( pbProcP )
.head 5 -  ! Call SalDisableWindow( pbProcP1 )
.head 5 -  ! Call SalDisableWindow( pbProcN )
.head 5 -  ! Call SalDisableWindow( pbProcN1 )
.head 5 -  ! Call SalDisableWindow( pbIns)
.head 5 -  ! Call SalDisableWindow( pbDel )
.head 5 -  ! Call SalDisableWindow( pbUpdate )
.head 5 -  ! Call SalDisableWindow( pbShowArc )
.head 5 -  ! Call SalDisableWindow(cmbAction )
.head 5 -  ! Call SalDisableWindow( pbExecute )
.head 5 -  ! Call SalDisableWindow(pb_MOS_Ex )
.head 5 -  ! Call SalDisableWindow( pb_MOS )
.head 5 -  ! Call SalDisableWindow( pbCalclim )
.head 5 -  ! Set nI=1 
.head 5 +  ! While SalTblGetColumnWindow (hWndForm,nI,COL_GetPos) != hWndNULL
.head 6 -                                Call SalTblSetColumnFlags(SalTblGetColumnWindow (hWndForm,nI,COL_GetPos),COL_Editable, FALSE ) 
.head 6 -                                Set nI=nI+1
.head 4 -  Set strFilterTblName= 'over_v'
.head 4 -  Set strPrintFileName= 'OVR'
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  ! Call SetWindowFont( hWndForm )
.head 4 -  ! Call SetWindowFullSize( hWndForm )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 +  If SalStrUpperX( strType )='MDATE' and StrFilter=STRING_Null
.head 5 -  Call SalSetWindowText( hWndForm, 'ОВЕРДРАФТЫ. Установка даты от договора' )
.head 4 +  Else If StrFilter=STRING_Null 
.head 5 -  Call SalSetWindowText( hWndForm, 'ОВЕРДРАФТЫ. Установка даты от первого дебета' )
.head 4 -  Set dTmp=dDat
.head 4 -  Set i=0
.head 4 +  While i<1
.head 5 -  Set dTmp=dTmp+1
.head 5 -  Call SqlPrepareAndExecute( hSql(),
"SELECT 1 INTO :nTmp FROM holiday WHERE holiday=:dTmp AND kv=980")
.head 5 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set aDat[i]=dTmp
.head 6 -  Set i=i+1
.head 4 -  Set TO.strSqlUpdate = "UPDATE accounts SET mdate=:TO.MDATE WHERE acc=:TO.Acc_2600 "
.head 4 -  ! Set TO.strSqlDelete = "UPDATE acc_over SET deleted=1 WHERE acc=:TO.Acc_2600 and acco=:TO.Acc_2067  "
.head 4 -  ! определяем флаг редактирования карточки счета
.head 4 -  Set TO.strSqlDelete = TO.strSqlPopulate
.head 4 -  Set nEdAccFlag =AVIEW_ReadOnly | AVIEW_Financial | AVIEW_Interest | AVIEW_Limit
.head 4 +  If SqlPrepareAndExecute(hSql(),"SELECT nvl(instr(UPPER(val),'EDACC'),0) INTO :nEdAcc FROM params WHERE UPPER(par) = 'OVRFLAGS' ") 
and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nEdAcc >0
.head 6 -  Set nEdAccFlag = AVIEW_NoClose|AVIEW_Financial | AVIEW_Interest | AVIEW_Limit
.head 4 +  ! Else 
.head 5 -                                                                        Set nEdAccFlag =AVIEW_ReadOnly | AVIEW_Financial | AVIEW_Interest | AVIEW_Limit
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor( TRUE)
.head 4 +  If DOP_TAG != STRING_Null
.head 5 -  Call SalShowWindow( DOP_VAL )
.head 5 -  Call SalTblSetColumnTitle ( DOP_VAL, DOP_NAME )
.head 4 +  Else
.head 5 -  Call SalHideWindow( DOP_VAL )
.head 4 -  Set sFilter = ""
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 +  If TO.fFilterAtStart
.head 5 -  Set TO.fFilterAtStart = NOT TO.fFilterAtStart
.head 5 +  If NOT SetQueryFilter( cF )
.head 6 -  Call SalDestroyWindow( TO )
.head 4 -  Call SalWaitCursor( TRUE)
.head 4 -  Set sFilter = cF.GetFilterWhereClause( FALSE )
.head 4 -  Set nNd2=nNd
.head 4 -  Set g1  = 0
.head 4 -  Set g8  = 0
.head 4 -  Set g10 = 0
.head 4 -  Set g11 = 0
.head 4 -  Set g12 = 0
.head 4 -  Set g13 = 0
.head 4 -  Set g14 = 0
.head 4 -  Set g17 = 0
.head 4 -  ! Call SalSendClassMessage( UM_Populate, 0, 0)
.head 4 -  Set TO.strSqlPopulate=
" SELECT 
nd,	    NMK,	 NDOC,	      DNEY,         MDATE,  
KV,	    BLKD,	 nls_2600,    ost_2600/100, LIM_2600/100,
acc_2600,   nls_2067,    ost_2000/100, int_2000,     acc_2000,
nls_2008,   ost_2008/100,acc_2008,    FLAG,         SOS, 
sd_2600/100,datd2,       crisk,       dos_2600/100, DAPP_2600, 
ACC_9129,   ACC_8000,    NLS_3578,    OST_3578/100, obs,
s080,       userid,      obsname,     fin,          nls_9129,
ost_9129/100,datd,acc_2096,nls_2096,ost_2096/100 ,acc_2480,nls_2480,ost_2480/100 
  INTO 
:TO.ND,      :TO.NMK,     :TO.NDOC,    :TO.DNEY,     :TO.MDATE, 
:TO.KV,      :TO.colBlkD, :TO.Nls_2600,:TO.Ost_2600, :TO.Lim_2600,  
:TO.Acc_2600,:TO.Nls_2067,:TO.Lim_Yes, :TO.Int_2600a,:TO.Acc_2067,
:TO.Nls_2607,:TO.Ost_2607,:TO.Acc_2607,:TO.colFlagS ,:TO.colSos, 
:TO.Lim_dog, :TO.colDatd2,:TO.colCrisk,:TO.Dos_2600, :TO.DAPP_2600, 
:TO.Acc_9129,:TO.Acc_8000,:TO.Nls_3578,:TO.Ost_3578, :TO.Obs,
:TO.S080,    :TO.USERID,  :TO.Obsname, :TO.colFin,   :TO.Nls_9129,
:TO.Ost_9129,:TO.colDatd,:TO.Acc_2096,:TO.Nls_2096,:TO.Ost_2096,:TO.Nls_2480,:TO.Nls_2480,:TO.Ost_2480
 FROM over_v  " || IifS(sFilter||StrFilter="",""," where ") || IifS(sFilter = "","", sFilter || IifS(StrFilter!=""," and ","")) ||IifS(StrFilter!=STRING_Null," acc_2600 in "||StrFilter,"")|| "
 ORDER BY MDATE "
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblPopulate(hWndForm, cMain.hSql(), TO.strSqlPopulate, TBL_FillAll)
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  Call SalTblDefineSplitWindow ( hWndForm, 1, TRUE )
.head 4 -  Set nTmp=SalTblInsertRow ( hWndForm, TBL_MinRow )
.head 4 -  Call SalTblSetContext ( hWndForm, nTmp)
.head 4 -  Call SalTblSetRowFlags( hWndForm, nTmp, ROW_New, FALSE )
.head 4 -  Set NMK ='В с е г о  :   '||Str( g1 )
.head 4 -  Set Lim_dog   = g8
.head 4 -  Set Ost_2600  = g10 
.head 4 -  Set Lim_2600  = g11 
.head 4 -  Set Max_2600  = g12
.head 4 -  Set Lim_Yes   = g13 
.head 4 -  Set Lim_No    = g14 
.head 4 -  Set Ost_2607  = g17 
.head 4 -  Call SetColorRow()
.head 4 -  Call SalWaitCursor( FALSE)
.head 4 +  If nNd2 != NUMBER_Null and nNd2 != 0 
.head 5 -  Set nRowNum=TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRowNum, 0, 0)
.head 6 -  Call SalTblSetContext ( hWndForm, nRowNum ) 
.head 6 +  If ND = nNd2 
.head 7 -  Call SalTblSetFocusRow (hWndForm, nRowNum) 
.head 7 -  Return FALSE 
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set colCriskcalc=CalcS080(colFin,Obs)
.head 4 -  Call SetColorRow()
.head 4 -  Set colFlag  = 0
.head 4 -  Set colFlag9 = 0
.head 4 -  Set Int_Per  = 0
.head 4 +  If colFlagS = 1 or colFlagS = 3 or colFlagS = 5 or colFlagS = 7
.head 5 -  Set colFlag  = 1
.head 4 +  If colFlagS = 2 or colFlagS = 3 or colFlagS = 6 or colFlagS = 7
.head 5 -  Set colFlag9  = 1
.head 4 +  If colFlagS = 4 or colFlagS = 5 or colFlagS = 6 or colFlagS = 7
.head 5 -  Set Int_Per  = 1
.head 4 +  If DAPP_2600 != dDat
.head 5 -  Set TO.Dos_2600 = 0 
.head 4 +  If SqlPrepareAndExecute( hSqlAux(), "select count(*) into :nRecCount from over_v where nd=:ND")
.head 5 -  Call SqlFetchNext( hSqlAux(), NFetchRez )
.head 4 +  ! If nRecCount=1 !! нормальные
.head 5 -  ! если блокирован: лимит не брать
.head 5 -                                                          Set Max_2600 = Ost_2600 + IifN( colBlkD=0, Lim_2600, 0)
.head 5 -  ! если мах < 0 : то 0
.head 5 -                                                          Set Max_2600 = IifN( Max_2600<0, 0 , Max_2600)
.head 5 -  !
.head 5 -                                                          Set Lim_No = Lim_2600-Lim_Yes 
.head 5 +                                                          If Lim_No < 0
.head 6 -                                                          Set Lim_No=0
.head 5 -                                                          Set g1  = g1 + 1
.head 5 -                                                          Set g8  = Lim_dog  + g8
.head 5 -                                                          Set g10 = Ost_2600 + g10
.head 5 -                                                          Set g11 = Lim_2600 + g11
.head 5 -                                                          Set g12 = Max_2600 + g12
.head 5 -                                                          Set g13 = Lim_Yes  + g13
.head 5 -                                                          Set g14 = Lim_No   + g14
.head 5 -                                                          Set g17 = Ost_2607 + g17
.head 4 +  If 1 !! нормальные
.head 5 -  ! если блокирован: лимит не брать
.head 5 -  Set Max_2600 = Ost_2600 + IifN( colBlkD=0, Lim_2600, 0)
.head 5 -  ! если мах < 0 : то 0
.head 5 -  Set Max_2600 = IifN( Max_2600<0, 0 , Max_2600)
.head 5 -  !
.head 5 -  Set Lim_No = Lim_2600-Lim_Yes 
.head 5 +  If Lim_No < 0
.head 6 -  Set Lim_No=0
.head 5 -  Set g1  = g1 + 1
.head 5 -  Set g8  = Lim_dog  + g8
.head 5 -  Set g10 = Ost_2600 + g10
.head 5 -  Set g11 = Lim_2600 + g11
.head 5 -  Set g12 = Max_2600 + g12
.head 5 -  Set g13 = Lim_Yes  + g13
.head 5 -  Set g14 = Lim_No   + g14
.head 5 -  Set g17 = Ost_2607 + g17
.head 4 +  Else If nRecCount=2 !! просроченные
.head 5 -  ! Set Lim_2600 = NUMBER_Null
.head 4 +  If Ost_2600 >= 0
.head 5 +  If SqlPrepareAndExecute( hSqlAux(),
"SELECT ir INTO :TO.Int_2600a FROM int_ratn 
 WHERE acc=:TO.Acc_2600 and id=0 and 
       bdat=(select max(bdat) from int_ratn 
             where acc=:TO.Acc_2600 and id=0 and bdat<=:TO.dDat) " )
and not SqlFetchNext( hSqlAux(), nFetchRes )
.head 6 -  Set TO.Int_2600a = 0
.head 4 +  If DOP_TAG != STRING_Null
.head 5 -  If SqlPrepareAndExecute( hSqlAux(),
"SELECT SUBSTR(value,1,25) INTO :TO.DOP_VAL
 FROM CUSTOMERW C, accounts CA WHERE C.rnk=CA.RNK AND CA.ACC=:TO.Acc_2600 AND C.tag= :DOP_TAG")
and SqlFetchNext(hSqlAux(), nFetchRes)
.head 4 +  If OVR_3739 = 1
.head 5 -  If SqlPrepareAndExecute( hSqlAux(),
"SELECT nls, ostc/100 
 INTO :Nls_3739, :Ost_3739 
 FROM accounts a, acc_over o
 WHERE o.acc = :Acc_2600 and o.acc_3739 = a.acc   " )
and not SqlFetchNext( hSqlAux(), nFetchRes )
.head 3 +  On SAM_DoubleClick
.head 4 +  If colSos=0 AND Subs(strPar02,1,1) != 'R'
.head 5 +  If nAcc
.head 6 -  Call SetProcParN( nAcc,2,STRING_Null,STRING_Null)
.head 5 +  Else
.head 6 -  Call SalModalDialog(dlg_Over, hWndForm, TO.Acc_2600, strType, IifN(nMode=5, 2,
     IifN(nPar=0 or UserType=0, 0, 1)), FALSE)
.head 5 -  Set nAcc=NUMBER_Null
.head 5 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On SAM_RowSetContext
.head 4 -  Set nNd= ND
.head 1 +  Dialog Box: dlg_Over
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Параметры договора овердрафта
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.725"
.head 4 -  Top:    0.594"
.head 4 -  Width:  13.033"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.488"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? No
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 1.036"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbOPEN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? No
.head 6 -  Height: Class Default
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Внести изменения в Базу Данных'
.head 6 +  On SAM_Click
.head 7 +  If SalIsNull(cmbObs) and SalIsNull(cmbFin) and SalIsNull(cmbS080)
.head 8 -  Call SalMessageBox("Не заполнено одно из полей: фин.стан, обслуж. долга, категория риска", "ВНИМАНИЕ !!!",
     MB_Ok | MB_IconQuestion)
.head 8 -  Return FALSE
.head 7 +  If SalIsNull(dfND)
.head 8 -  Call SalMessageBox("Пустое поле 'НОМЕР ДОГОВОРА', необходимо ввести номер договора и сохранить изменения ещё раз",
     "ВНИМАНИЕ !!!", MB_Ok | MB_IconQuestion)
.head 8 -  Return FALSE
.head 7 +  If SalIsNull(MDATE) and SalStrUpperX(strType) = 'MDATE'
.head 8 -  Call SalMessageBox("Не заполнено поле 'Дата погашения остатка', необходимо ввести количество дней и сохранить " ||
     "изменения ещё раз", "ВНИМАНИЕ !!!", MB_Ok | MB_IconQuestion)
.head 8 -  Return FALSE
.head 7 +  If dfDD2 < MDATE or dfDD2 = DATETIME_Null
.head 8 +  If SalMessageBox(
   "Дата погашения остатка > даты окончания или неопределена. Принять дата окончания = дата погашения остатка ?",
   "ВНИМАНИЕ !!!", MB_YesNo | MB_IconQuestion) = IDYES
.head 9 -  Set dfDD2 = MDATE
.head 7 +  If rbKd
.head 8 -  Set nTipO = 14
.head 7 +  Else If rbBd 
.head 8 -  Set nTipO = 7
.head 7 -  ! сохранение 
.head 7 +  If F_SAVE()
.head 8 +  If ACC_3739 != NUMBER_Null
.head 9 -  If SqlPrepareAndExecute(hSql(), "
   update acc_over
   set    acc_3739=decode(:ACC_3739,0,null,:ACC_3739)
   where  acc=:nAcc")
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SaveFInfoToLog('OVR: ' || dfNlsO || ' Открыт дог=' || dfND || ' Тип=' || Str(nTipO) || ' Дней=' ||
     Str(dfDney))
.head 8 -  Call SalEnableWindow(pbPROC_2600)
.head 8 -  Call SalEnableWindow(pbPROC_8000)
.head 8 -  Call SalEnableWindow(pbPROC_9129)
.head 8 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalMessageBox('Невозможно откыть договор по счету ' || dfNlsO, 'Ошибка', MB_IconExclamation)
.head 4 +  Pushbutton: pbPROC_2600
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.567"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? No
.head 6 -  Height: Class Default
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Параметры начисления %% за ночной овердрафт '
.head 6 +  On SAM_Click
.head 7 +  ! If SetProcParN(nAcc, 0, STRING_Null, STRING_Null)
.head 8 -  If SqlPrepareAndExecute(hSql(), "
   UPDATE int_accn
   set    acr_dat=:dfDD-1
   where  acc=:nAcc and id=0") and SqlCommitEx(hSql(), strTip || ' acc=' || Str(aAcc))
.head 7 -  Call Proc_Kart(nAcc, 0, STRING_Null, STRING_Null, dfDD-1, strTip)
.head 4 +  Pushbutton: pbPROC_8000
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.017"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? No
.head 6 -  Height: Class Default
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Salmon
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Параметры начисления комиссии за однодневный овердрафт'
.head 6 +  On SAM_Click
.head 7 -  ! Call SetProcParN(nAcc_8000,0,STRING_Null,STRING_Null)
.head 7 -  Call Proc_Kart(nAcc_8000, 0, STRING_Null, STRING_Null, dfDD - 1, strTip)
.head 4 +  Pushbutton: pbPROC_9129
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.467"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? No
.head 6 -  Height: Class Default
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: Periwinkle
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Параметры начисления %% за неиспользованный лимит овердрафта '
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   SELECT a1.nls,a2.nls
   INTO   :NLSA,:NLSB
   FROM   int_accn i, accounts a1, accounts a2
   WHERE  i.acc=:nAcc and i.id=0 and i.acra=a1.acc and i.acrb=a2.acc") and  SqlFetchNext(hSql(), nFetchRes)
.head 8 -  ! Call SetProcParN(nAcc_9129, 0, NLSA, NLSB)
.head 7 -  Call Proc_Kart(nAcc_9129, 0, STRING_Null, STRING_Null, dfDD-1, strTip)
.head 4 +  ! ctb_pbGetValue: pb_Acc
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.817"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: Q:\BARS98\RESOURCE\BMP\Details.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Счета по ОДНОМУ договору'
.head 6 +  On SAM_Click
.head 7 -  Set sTmp = " substr(a.nls,6,9)='" || Subs(dfNls, 6, 9) ||
    "' and a.kv=980 and a.nbs in (2600,2607,2067,2069,9129,8000)"
.head 7 -  Set sTmp = " a.ACC in (
    Select a.acc
    from   accounts a, acc_over o
    where  o.acc=" || Str(Acc_2600) || " and a.acc in (o.acc,o.acco,o.acc_9129,o.acc_8000)
   union all
    select acc
    from   cc_accp
    where  accs=" || Str(Acc_2600) || ")"
.head 7 -  ! Call ShowAccF(hWndMDI, sTmp)
.head 7 -  ! Call ShowAccList (0, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_Financial | AVIEW_Interest | AVIEW_Limit, sTmp)
.head 4 +  Pushbutton: pbCLOSE
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.917"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   select max(nd)
   into   :ND
   from   acc_over
   where  ndoc='" || dfND || "'")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   DELETE
   FROM   acc_over
   WHERE  acc=:nAcc")
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   select vidd
   into   :nTmp
   from   cc_kol
   where  vidd in (4,14,24) and nls is not null and rownum=1") and SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SqlPLSQLCommand(hSql(), 'CCK.CC_9819(dfND,1)')
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SaveFInfoToLog('OVR: ' || dfNlsO || ' Удалён')
.head 8 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 8 -  Return TRUE
.head 7 -  ! Call Debug('Референс договора=' || SalNumberToStrX(ND, 0))
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Удалить связку счетов'
.head 4 +  Pushbutton: pbDocs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.367"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Docview.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Документы договора'
.head 6 +  On SAM_Click
.head 7 +  If nEdit = 0
.head 8 -  Call cdoc_ShowAllDocsReadOnly(TO.ND, hWndForm)
.head 7 +  Else If nEdit = 1
.head 8 -  Call cdoc_ShowAllDocs(TO.ND, hWndForm)
.head 7 +  Else If nEdit = 2
.head 8 -  Call cdoc_ShowAllDocsSign(TO.ND, hWndForm)
.head 4 +  Pushbutton: pbEXIT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.85"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? No
.head 6 -  Height: Class Default
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalEndDialog(hWndForm, 0)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Завершить работу и выйти'
.head 4 -  !
.head 4 -  Group Box: Тип дней
.head 5 -  Resource Id: 34503
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.476"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.512"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 4 +  Radio Button: rbKd
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: календарные
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.655"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nTipO = 14
.head 7 -  Call F_MDATE(nTipO, dfDney)
.head 4 +  Radio Button: rbBd
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: банковские
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.655"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nTipO = 7
.head 7 -  Call F_MDATE(nTipO, dfDney)
.head 4 -  !
.head 4 -  Group Box: Кол. дней / Дата пог. остатка
.head 5 -  Resource Id: 33883
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    0.476"
.head 6 -  Width:  3.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.512"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfDney
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.067"
.head 7 -  Top:    0.655"
.head 7 -  Width:  0.833"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, ' Кол. дней ')
.head 6 +  On SAM_SetFocus
.head 7 +  If nTipO = NUMBER_Null
.head 8 -  Set nTipO = 14
.head 8 -  ! Call SalSendMsg(nTipO, SAM_Validate, 0, 0)
.head 8 -  ! Call F_MDATE(dfTipO1, dfDney)
.head 8 -  Return VALIDATE_Ok 
.head 7 +  If dfDney = NUMBER_Null
.head 8 -  Set dfDney = nTipO
.head 6 +  On SAM_Validate
.head 7 +  If dfDney < 1
.head 8 -  Set dfDney = nTipO
.head 7 -  Call F_MDATE(nTipO, dfDney)
.head 7 -  Return VALIDATE_Ok 
.head 4 +  Data Field: MDATE
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.983"
.head 7 -  Top:    0.655"
.head 7 -  Width:  1.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: System Window Color
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Дата пог. остатка')
.head 4 -  Group Box: Тип шаблонов договора
.head 5 -  Resource Id: 41406
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.4"
.head 6 -  Top:    0.476"
.head 6 -  Width:  4.983"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.524"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 4 +  Combo Box: cmbVidd
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.583"
.head 6 -  Top:    0.655"
.head 6 -  Width:  4.633"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.036"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? Yes
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 1299
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  -0.017"
.head 6 -  Begin Y:  0.429"
.head 6 -  End X:  13.283"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Data Field: dfRnk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.383"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.333"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Рег.№ клиента')
.head 4 +  Data Field: dfNmk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 38
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.883"
.head 7 -  Top:    0.06"
.head 7 -  Width:  3.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.333"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Blue
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Наименование клиента')
.head 4 -  Background Text: Инсп.
.head 5 -  Resource Id: 38383
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.667"
.head 6 -  Top:    0.155"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Combo Box: cmbIsp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.283"
.head 6 -  Top:    0.119"
.head 6 -  Width:  3.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? Yes
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? Yes
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 -  Group Box: Счета клиента
.head 4 -  Resource Id: 1297
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.571"
.head 5 -  Width:  8.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.452"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Default
.head 3 -  Background Text: Основной
.head 4 -  Resource Id: 14590
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    0.881"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.821"
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Код вал')
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull(dfKv)
.head 7 -  Set dfKv = GetBaseVal()
.head 3 +  Data Field: dfNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    0.821"
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Основной лиц.счет')
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfNls)
.head 7 -  Set dfKv = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set dfNls = KeyAccount(GetBankMfo(), dfNls)
.head 6 +  If IfAccExists(dfNls,dfKv,nAcc)
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   select a.nms,c.nmk,sf.name,cr.name,a.rnk
   into   :dfNms,:dfNmk,:cmbFin,:cmbS080,:nRnk
   from   accounts a, customer c, stan_fin sf, specparam s, crisk cr
   where  a.acc=:nAcc and c.rnk=a.rnk and nvl(c.crisk,0)=sf.fin(+) and a.acc=s.acc(+) and
          nvl(s.s080,1)=cr.crisk") and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set dfRnk = nRnk
.head 7 +  If SalIsNull(dfNlsO)
.head 8 -  Set dfNlsO = dfNls
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   select to_char(f_newnls(" || SalNumberToStrX(nAcc, 0) || " ,'OV8000',''))
   into   :sNls8class
   from   dual")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If sNls8class = STRING_Null
.head 9 -  Set sNls8class = '8000' || Subs(dfNls, 5, 10)
.head 8 -  Set dfNls8 = KeyAccount(GetBankMfo(), '8000' || Subs(sNls8class, 5, 10))
.head 8 -  Set Nms8 = "Тек. оверд. " || dfNms
.head 8 -  ! для 9 класса персональная маска
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   select to_char(f_newnls(" || SalNumberToStrX(nAcc, 0) || " ,'OV9',''))
   into   :sNls9class
   from   dual")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 -  ! Set dfNls9 = KeyAccount(GetBankMfo(), '9129' || Subs(dfNls, 5, 10))
.head 8 +  If sNls9class = STRING_Null
.head 9 -  Set sNls9class= '9129' || Subs(dfNls, 5, 10)
.head 8 -  Set dfNls9 = KeyAccount(GetBankMfo(), NBS9129 || SalStrMidX(sNls9class, 4, 10))
.head 8 -  Set dfNms9 = "Лім.ОВРД." || dfNms
.head 7 +  If SalIsNull(dfNlsA)
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   select to_char(f_newnls(" || SalNumberToStrX(nAcc, 0) || ",'OV2607',:NBS2607))
   into   :sNls2607
   from   dual")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If sNls2607 = STRING_Null
.head 9 -  Set sNls2607 = KeyAccount(GetBankMfo(), NBS2607 || Subs(dfNls, 5, 10))
.head 8 -  Set dfNlsA = sNls2607
.head 8 -  Set dfNmsA = Subs("Нар.% за ОВРД." || dfNms, 1, 38)
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Return VALIDATE_OkClearFlag
.head 3 +  Data Field: dfNms
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.183"
.head 6 -  Top:    0.821"
.head 6 -  Width:  4.517"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Наименование счета')
.head 3 -  !
.head 3 +  Data Field: dfNls_3739
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    1.321"
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Счет гашения')
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfNls_3739)
.head 7 -  Set dfNms_3739 = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  !
.head 6 -  Set dfNls_3739 = KeyAccount(GetBankMfo(), dfNls_3739)
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   select acc,nms
   into   :ACC_3739,:dfNms_3739
   from   accounts
   where  kv=:dfKv and rnk=:nRnk and dazs is null and nls=:dfNls_3739") and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalMessageBox("Счет " || dfNls_3739 || "
для клиента Rnk=" || Str(nRnk) || "
НЕ найден !", "Ошибка!", MB_IconStop)
.head 7 -  Return VALIDATE_OkClearFlag
.head 3 +  Data Field: dfNms_3739
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.183"
.head 6 -  Top:    1.321"
.head 6 -  Width:  4.517"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Наименование счета Счета гашения')
.head 3 -  !
.head 3 -  Background Text: Овердрафт
.head 4 -  Resource Id: 14591
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    1.131"
.head 5 -  Width:  1.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNlsO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    1.071"
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Лиц.счет овердрафта')
.head 3 -  Background Text: Начислен. %%
.head 4 -  Resource Id: 25795
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.679"
.head 5 -  Width:  1.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    1.571"
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Лиц.счет нач.% по овердрафту')
.head 3 +  Data Field: dfNmsA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.183"
.head 6 -  Top:    1.571"
.head 6 -  Width:  4.517"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Наименование счета нач.%')
.head 3 -  Background Text: Неиспольз.лим.
.head 4 -  Resource Id: 25794
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.929"
.head 5 -  Width:  1.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNls9
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    1.821"
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Лиц.счет Неиспольз.лим. по овердрафту')
.head 3 +  Data Field: dfDiskont
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.183"
.head 6 -  Top:    2.405"
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Сумма одноразовой комисии (Дисконта)')
.head 5 +  On SAM_SetFocus
.head 6 -  ! Set nDiskont = dfDiskont
.head 6 -  Set bUpdateDiskont = FALSE
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfDiskont) or dfDiskont = 0
.head 7 -  Set bUpdateDiskont = dfDiskont!=nDiskont
.head 7 -  Set nDiskont = dfDiskont
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 +  If bNew
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   select to_char(f_newnls("||SalNumberToStrX(nAcc,0)||",'OV2607','3600'))
   into   :dfNlsDiskont
   from   dual")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If dfNlsDiskont = STRING_Null
.head 9 -  Set dfNlsDiskont = KeyAccount(GetBankMfo(), '3600' || Subs(dfNls, 5, 10))
.head 7 +  Else
.head 8 -  Set bUpdateDiskont = dfDiskont!=nDiskont
.head 7 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNlsDiskont
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.183"
.head 6 -  Top:    2.714"
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Лиц.счёт Неиспольз.лим. по овердрафту')
.head 5 +  On SAM_SetFocus
.head 6 -  ! Call Debug('dfNlsDiskont = ' || dfNlsDiskont)
.head 6 -  ! Set sNlsDiskont = dfNlsDiskont
.head 6 -  Set bDiskont = FALSE
.head 5 +  On SAM_Validate
.head 6 -  Set bDiskont = (not SalIsNull(dfNlsDiskont) and sNlsDiskont = STRING_Null) or
               (not sNlsDiskont = STRING_Null and SalIsNull(dfNlsDiskont)) or sNlsDiskont != dfNlsDiskont
.head 6 +  If not bNew
.head 7 +  If dfNlsDiskont != STRING_Null
.head 8 -  Set sAcc = GetValueStr("
    SELECT to_char(acc)
    from   accounts
    where  dazs is null and nls='" || dfNlsDiskont || "'")
.head 8 +  If sAcc = STRING_Null
.head 9 -  Call SalMessageBox('Счёт ' || dfNlsDiskont || '/980 не существует или закрыт!', 'Внимание!', MB_Ok | MB_IconStop)
.head 9 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Set sNlsDiskont = dfNlsDiskont
.head 9 -  Return VALIDATE_Ok
.head 7 +  Else
.head 8 -  Set sNlsDiskont = dfNlsDiskont
.head 8 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Set sNlsDiskont = dfNlsDiskont
.head 7 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNms9
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.183"
.head 6 -  Top:    1.821"
.head 6 -  Width:  4.517"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Наименование счёта Неиспольз.лим. по овердрафту')
.head 3 -  Background Text: Оверд.тек.дня
.head 4 -  Resource Id: 25796
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.179"
.head 5 -  Width:  1.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Счёт 3600
.head 4 -  Resource Id: 64653
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.217"
.head 5 -  Top:    2.726"
.head 5 -  Width:  1.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Сумма одноразовой комиссии (Дисконта)
.head 4 -  Resource Id: 64654
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.217"
.head 5 -  Top:    2.452"
.head 5 -  Width:  3.917"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNls8
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    2.071"
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Внесистемный счёт Оверд.тек.дня')
.head 3 -  !
.head 3 -  Background Text: № 
.head 4 -  Resource Id: 61466
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.95"
.head 5 -  Top:    0.833"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.383"
.head 6 -  Top:    0.821"
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Highlight Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, '№ договора')
.head 3 -  Background Text: Дата начала
.head 4 -  Resource Id: 36172
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.95"
.head 5 -  Top:    1.083"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.383"
.head 6 -  Top:    1.071"
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Highlight Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Дата нач. дог.')
.head 5 +  On SAM_Validate
.head 6 -  Set dfDD = CorrectDate(GetBaseVal(), dfDD, dfDD)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: завершения
.head 4 -  Resource Id: 22762
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.95"
.head 5 -  Top:    1.333"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDD2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.383"
.head 6 -  Top:    1.321"
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Дата кон. дог.')
.head 5 +  On SAM_Validate
.head 6 +  If dfDD >= dfDD2
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Set dfDD2 = CorrectDate(GetBaseVal(), dfDD2, dfDD2)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Сума/Лимит
.head 4 -  Resource Id: 11428
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.95"
.head 5 -  Top:    1.583"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.383"
.head 6 -  Top:    1.571"
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Highlight Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Сума договора (Лимит)')
.head 3 -  Background Text: Тек.лимит
.head 4 -  Resource Id: 64436
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.883"
.head 5 -  Top:    1.845"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Шкала для плавающей ставки
.head 4 -  Resource Id: 12221
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.15"
.head 5 -  Top:    2.119"
.head 5 -  Width:  2.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSD_Lim
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.383"
.head 6 -  Top:    1.821"
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Highlight Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Сума текущего лимита')
.head 3 +  Check Box: cbIskl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Блокировать 9 кл. (кред. линия)
.head 4 -  Window Location and Size
.head 5 -  Left:   8.983"
.head 5 -  Top:    1.488"
.head 5 -  Width:  3.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Group Box: Параметры юр. договора
.head 4 -  Resource Id: 1296
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.883"
.head 5 -  Top:    0.571"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Default
.head 3 -  !
.head 3 -  Group Box: Технические реквизиты
.head 4 -  Resource Id: 17264
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    -0.024"
.head 5 -  Width:  5.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Default
.head 3 +  Check Box: cbKrl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кред.линия
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.155"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUselim
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Использ.лим.
.head 4 -  Window Location and Size
.head 5 -  Left:   1.683"
.head 5 -  Top:    0.155"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbBl9kl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Бл. 9129* 
.head 4 -  Window Location and Size
.head 5 -  Left:   3.35"
.head 5 -  Top:    0.155"
.head 5 -  Width:  1.233"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Комментарий
.head 4 -  Resource Id: 1227
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    3.381"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTxt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.6"
.head 6 -  Top:    3.357"
.head 6 -  Width:  10.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! Background Text: Исп.
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.683"
.head 5 -  Top:    0.179"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  ! Combo Box: cmbIsp
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.183"
.head 5 -  Top:    0.145"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 -  Message Actions 
.head 3 -  Background Text: Фин.состояние
.head 4 -  Resource Id: 16942
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.767"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Обсл.долга
.head 4 -  Resource Id: 16941
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.9"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbObs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.95"
.head 5 -  Top:    0.298"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.655"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT fin
   INTO   :nFin
   FROM   stan_fin
   WHERE  name=:cmbFin") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT obs
   INTO   :nObs
   FROM   stan_obs
   WHERE  name=:cmbObs") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT c.name
   INTO   :cmbS080
   FROM   crisk c, FIN_OBS_S080 f
   WHERE  c.crisk=f.s080 and f.fin=:nFin and f.obs=:nObs") and SqlFetchNext(hSql(), nFetchRes)
.head 3 +  Combo Box: cmbFin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.767"
.head 5 -  Top:    0.298"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT fin
   INTO   :nFin
   FROM   stan_fin
   WHERE name=:cmbFin") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT obs
   INTO   :nObs
   FROM   stan_obs
   WHERE  name=:cmbObs") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT c.name
   INTO   :cmbS080
   FROM   crisk c, FIN_OBS_S080 f
   WHERE  c.crisk=f.s080 and f.fin=:nFin and f.obs=:nObs") and SqlFetchNext(hSql(), nFetchRes)
.head 3 +  Combo Box: cmbS080
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.183"
.head 5 -  Top:    0.298"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.655"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Data Field: R080
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.183"
.head 6 -  Top:    0.012"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Combo Box: cmbRang
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.983"
.head 5 -  Top:    2.405"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.429"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Check Box: cb_Rang
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.883"
.head 5 -  Top:    2.405"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cb_Rang = 1 and cmbRang != STRING_Null 
.head 7 -  Call F_RANG(cmbRang)
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Подтвердить изменение № шкалы')
.head 3 -  Background Text: День погашеня %%
.head 4 -  Resource Id: 59041
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    3.738"
.head 5 -  Width:  2.533"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDneyProc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.1"
.head 6 -  Top:    3.714"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfDneyProc < 1 or dfDneyProc > 31
.head 7 -  Call SalMessageBox('Для поля "День погашеня %%" допустимый диапазон от 1-го до 31-го!','Внимание!', MB_Ok)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfDos8
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.183"
.head 6 -  Top:    2.071"
.head 6 -  Width:  4.533"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, 'Сумма Оверд.тек.дня')
.head 2 +  Functions
.head 3 +  Function: F_SAVE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: SD100
.head 5 -  Number: nVidd
.head 5 -  Number: n980
.head 5 -  String: sSql
.head 5 -  Number: nAcra
.head 5 -  Number: nAcrb
.head 5 -  Number: kol
.head 5 -  Number: ACC_TMP
.head 5 -  String: B9129_
.head 5 -  String: nls9_
.head 5 -  Number: acc9_
.head 5 -  Number: REF_
.head 5 -  String: nms9_
.head 5 -  String: nazn_
.head 5 -  Date/Time: SYSDATE_
.head 5 -  String: nTobo
.head 5 -  Number: AGrp
.head 4 +  Actions
.head 5 -  !
.head 5 +  ! If bDiskont
.head 6 -  Call Debug('bDiskont = TRUE')
.head 5 +  ! If bUpdateDiskont
.head 6 -  Call Debug('bUpdateDiskont = TRUE')
.head 5 -  !
.head 5 -  ! Группу счета вычисляем сначала из параметров отделения, потом из параметров модуля
.head 5 +  If not (SqlPrepareAndExecute(hSql(), "
   select nvl(min(t.val),to_number(ovr.OVR_PAR_VAL('A_GRP')))
   into   :AGrp
   from   tobo_params t, accounts a
   where  t.tag='OVR_GRP' and t.tobo(+)=a.tobo and a.acc=:nAcc") and SqlFetchNext(hSql(), nFetchRes))
.head 6 -  Set AGrp = nGrp
.head 5 -  Set Ins = 0
.head 5 -  Set n980 = GetBaseVal()
.head 5 -  Set SD100 = dfSD*100
.head 5 -  Set nFlagval=cbBl9kl*2
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT decode(c.CUSTTYPE,1,24,2,4,3,14,4)
   INTO   :nVidd
   FROM   accounts a, customer c
   WHERE  a.rnk=c.rnk and a.nls=:dfNls and a.kv=:dfKv") and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT id
   INTO   :nUserid
   FROM   staff
   WHERE  id||'.'||fio=:cmbIsp") and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT fin
   INTO   :nFin
   FROM   stan_fin
   WHERE  name=:cmbFin") and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  If SqlPrepareAndExecute(hSql(), "
    SELECT obs
    INTO   :nObs
    FROM   stan_obs
    WHERE  name=:cmbObs") and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT crisk
   INTO   :sS080
   FROM   crisk
   WHERE  name=:cmbS080") and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  ! коррекция существующего 
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT nd
   INTO   :nOldND
   FROM   acc_over
   WHERE  acc=:nAcc") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set sSql = "
    UPDATE acc_over 
    SET    TIPO    =:nTipO, 
           FLAG    =:nFlagval, 
           DAY     =:dfDney, 
           DATD    =:dfDD, 
           SD      =:SD100, 
           NDOC    =:dfND,  
           VIDD    =:nVidd,  
           DATD2   =:dfDD2,  
           KRL     =:cbKrl, 
           USELIM  =:cbUselim , 
           TXT     =:dfTxt,
           PR_2600A=:dfDneyProc,  
           USERID  =:nUserid,
           OBS     =:nObs
    WHERE  acco=:nAcc"
.head 5 -  ! вствка нового
.head 5 +  Else
.head 6 -  ! Первый лимит и первая история дат погашения остатка
.head 6 -  Set sSql = "
    INSERT
    INTO acc_over (ACC,ACCO,TIPO,FLAG,DAY,DATD,SD,NDOC,VIDD,DATD2,KRL,USELIM,ACC_9129,ACC_8000,TXT,USERID,OBS,PR_2600A)
           values (:nAcc,:nAcc,:nTipO,:nFlagval,:dfDney,:dfDD,:SD100,:dfND,:nVidd,:dfDD2,:cbKrl,:cbUselim,:nAcc_9129,
                   :nAcc_8000,:dfTxt,:nUserid,:nObs,:dfDneyProc)"
.head 6 -  Set Ins=1
.head 6 -  ! определяем отв исп.
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   SELECT isp,tobo
   INTO   :nIsp,:nTobo
   FROM   accounts
   where  acc=:nAcc")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If not SqlPrepareAndExecute(hSql(), "
   UPDATE accounts
   SET    lim=:SD100
   where  acc=:nAcc")
.head 7 -  Call SalMessageBox("Ошибка при проставлении лимита овердрафта", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 6 +  If not SqlPLSQLCommand(hSql(), "
   op_reg_ex(99,0,0,AGrp,nTmp,nRnk,dfNls9,dfKv,dfNms9,'ODB',nIsp,nAcc_9129,'1',NUMBER_Null,NUMBER_Null,NUMBER_Null,
             NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,STRING_Null,STRING_Null,nTobo,
             NUMBER_Null)")
.head 7 -  Call SalMessageBox("Ошибка при открытии счета 9129", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 6 +  If not SqlPLSQLCommand(hSql(), "p_setAccessByAccmask(nAcc_9129,nAcc)")
.head 7 -  Call SalMessageBox("Ошибка при установке доступа для счета 9129", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 6 +  If AGrp
.head 7 +  If not SqlPLSQLCommand(hSql(), "SEC.addAgrp(nAcc_9129,AGrp)")
.head 8 -  Call SalMessageBox("Ошибка при установке доступа для счета 9129", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 6 +  If not SqlPLSQLCommand(hSql(), "
   Op_Reg_ex(99,0,0,AGrp,nTmp,nRnk,dfNls8,dfKv, Nms8 ,'ODB',nIsp,nAcc_8000,'1',NUMBER_Null,NUMBER_Null,NUMBER_Null,
             NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,STRING_Null,STRING_Null,nTobo,
             NUMBER_Null)")
.head 7 -  Call SalMessageBox("Ошибка при открытии счета 8000", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 6 +  If not SqlPLSQLCommand(hSql(), "p_setAccessByAccmask(nAcc_8000,nAcc)")
.head 7 -  Call SalMessageBox("Ошибка при установке доступа для счета 8000", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 6 +  If AGrp
.head 7 +  If not SqlPLSQLCommand(hSql(), "SEC.addAgrp(nAcc_8000,AGrp)")
.head 8 -  Call SalMessageBox("Ошибка при установке доступа для счета 8000", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 6 -  !
.head 6 +  If OVR_PAR_VAL('DO_3578') = 'TRUE'
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   select to_char(f_newnls(" || SalNumberToStrX(nAcc, 0) || " ,'OV3578',''))
   into   :sNls3class
   from   dual")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If sNls3class = STRING_Null
.head 8 -  Set sNls3class= '3578' || Subs(dfNls, 5, 10)
.head 7 -  Set Nls3 = KeyAccount(GetBankMfo(), '3578' || Subs(sNls3class, 5, 10))
.head 7 -  Set Nms3 = "Комис. за тек. оверд. " || dfNms
.head 7 +  If not SqlPLSQLCommand(hSql(), "
   Op_Reg_ex(99,0,0,AGrp,nTmp,nRnk,Nls3,dfKv,Nms3,'ODB',nIsp,nAcc_3578,'1',NUMBER_Null,NUMBER_Null,NUMBER_Null,
             NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,STRING_Null,STRING_Null,nTobo,
             NUMBER_Null)")
.head 8 -  Call SalMessageBox("Ошибка при открытии счета комиссии за однодневный овердрафт", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 7 +  If not SqlPLSQLCommand(hSql(), "p_setAccessByAccmask(nAcc_3578,nAcc)")
.head 8 -  Call SalMessageBox("Ошибка при установке доступа для счета комиссии за однодневный овердрафт", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 7 +  If AGrp
.head 8 +  If not SqlPLSQLCommand(hSql(), "SEC.addAgrp(nAcc_3578,AGrp)")
.head 9 -  Call SalMessageBox("Ошибка при установке доступа для счета комиссии за однодневный овердрафт", 'Ошибка!', MB_Ok)
.head 9 -  Return FALSE
.head 7 -  If SqlPrepareAndExecute(hSql(), "
   SELECT a.acc
   INTO   :nAcrb
   FROM   proc_dr p, accounts a
   WHERE  a.nls=decode(a.kv,980,p.g67,p.v67) and a.kv=980 and p.nbs='2000' and p.sour=4") and
   SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If nAcrb = 0
.head 8 -  Set nAcrb = NUMBER_Null
.head 7 +  If not SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   INT_ACCN (ACC,ID,METR,BASEM,BASEY,FREQ,TT,ACRA,ACRB,S)
            VALUES (:nAcc_8000,0,0,0,0,1,'%%1',:nAcc_3578,:nAcrb,0)")
.head 8 -  Call SalMessageBox("Ошибка создания процентной карточки 8000-го", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   select SUBSTR(T.NLSM,1,4),t.nlsk,SYSDATE
   into   :B9129_,:nls9_,:SYSDATE_
   from   tts t 
   where  t.tt='OV-'") and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Ищем в TOBO_PARAMS используя ТОБО основного счета овердрафта
.head 7 -  ! Если счет в TOBO_PARAMS не указан проверяем существует ли контрсчет 9 класса в карточке операции OV-
.head 7 +  If not (SqlPrepareAndExecute(hSql(), "
   select b.acc,substr(b.nms,1,38),nls
   into   :acc9_,:nms9_,:nls9_
   from   accounts b
   where  b.kv=:dfKv and b.nls=(select val
                                from   tobo_params
                                where  tobo=:nTobo and tag='NLS_9900')") and SqlFetchNext(hSql(), nFetchRes))
.head 8 -  If SqlPrepareAndExecute(hSql(), "
   select b.acc,substr(b.nms,1,38)
   into   :acc9_,:nms9_
   from   accounts b
   where  b.kv=:dfKv and b.nls=:nls9_") and SqlFetchNext(hSql(), nFetchRes)
.head 8 +  Else
.head 9 -  Call SalMessageBox("Контрсчёт 9900 не описан в карточке 'OV-' или в справочнике TOBO_PARAMS.", 'Ошибка!', MB_Ok)
.head 9 -  Return FALSE
.head 7 -  Set nazn_='Установка лимита овердрафта - дог.ов.№' || dfND || ' від ' || SalStrLeftX(
    SalFmtFormatDateTime(dfDD, 'DD-MM-YYYY'), 10)
.head 7 -  Call SqlPLSQLCommand(hSql(), 'GL.REF(REF_)')
.head 7 -  Call SqlPLSQLCommand(hSql(), "
     gl.in_doc3(REF_,'OV-',6,STRING_Null,SYSDATE_,GetBankDate(),1,dfKv,dfSD*100,dfKv,dfSD*100,NUMBER_Null,
                GetBankDate(),GetBankDate(),dfNms9,dfNls9,GetBankMfo(),nms9_,nls9_,GetBankMfo(),nazn_,STRING_Null,
                GetBankOkpoS(),GetBankOkpoS(),STRING_Null,STRING_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null)")
.head 7 -  Call SqlPLSQLCommand(hSql(), "GL.PAYV(1,REF_,GetBankDate(),'OV-',1,dfKv,dfNls9,dfSD*100,dfKv,nls9_,dfSD*100)")
.head 6 +  Else
.head 7 -  Call SalMessageBox("Не описана операция 'OV-'", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 6 -  !
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   SELECT count(*)
   INTO   :kol
   FROM   specparam
   where  acc=:nAcc_9129")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If kol = 1
.head 7 +  If not SqlPrepareAndExecute(hSql(), "
   UPDATE specparam
   SET    R013=" || OVR_PAR_VAL('9_R013') || " where acc=:nAcc_9129")
.head 8 -  Call SalMessageBox("Ошибка при изминении R013 по счету неиспользованного лимита", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 +  If not SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   specparam (ACC,R013)
             VALUES (:nAcc_9129," || OVR_PAR_VAL('9_R013') || ")")
.head 8 -  Call SalMessageBox("Ошибка при проставлении R013 по счету неиспользованного лимита", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 6 -  ! !!!!
.head 6 -  ! 1) найти счет доходов 
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT a.acc
   INTO   :nAcrb
   FROM   proc_dr p, accounts a
   WHERE  a.nls=decode(a.kv,980,p.g67,p.v67) and a.kv=980 and p.nbs='2000' and p.sour=4") and
   SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If nAcrb = 0
.head 7 -  Set nAcrb = NUMBER_Null
.head 6 -  ! 1) Открыть (или узнать асс счета нач%)
.head 6 +  If not SqlPLSQLCommand(hSql(), "
   Op_Reg_ex(99,0,0,AGrp,nTmp,nRnk,dfNlsA,dfKv,dfNmsA,'ODB',nIsp,nAcra,'1',NUMBER_Null,NUMBER_Null,NUMBER_Null,
             NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,STRING_Null,STRING_Null,nTobo,
             NUMBER_Null)")
.head 7 -  Call SalMessageBox("Ошибка при открытии процентного счета", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 6 +  If not SqlPLSQLCommand(hSql(), "p_setAccessByAccmask(nAcra,nAcc)")
.head 7 -  Call SalMessageBox("Ошибка при установке доступа для процентного счета", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 6 +  If AGrp
.head 7 +  If not SqlPLSQLCommand(hSql(), "SEC.addAgrp(nAcra,AGrp)")
.head 8 -  Call SalMessageBox("Ошибка при установке доступа для процентного счета", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 6 -  ! Создание новой % карточки (для Первого дог)
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   SELECT acc
   FROM   int_accn
   where acc=:nAcc and id=0") and not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  !
.head 7 +  If not SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   int_accn (ACC,ID,METR,BASEM,BASEY,FREQ,TT,ACRA,ACRB,S)
            values (:nAcc,0,0,0,0,1,'%%1',:nAcra,:nAcrb,0)")
.head 8 -  Call SalMessageBox("Ошибка при создании основной процентной карточки овердрафта", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 6 -  ! Обновление старой % карточки (для Следующих дог)
.head 6 +  Else
.head 7 +  If not SqlPrepareAndExecute(hSql(), "
   UPDATE int_accn
   set    ACRA=:nAcra,ACRB=:nAcrb
   where  acc=:nAcc and id=0")
.head 8 -  Call SalMessageBox("Ошибка при обновлении основной процентной карточки овердрафта", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 5 +  If SqlPrepareAndExecute(hSql(), sSql) And Ins
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   select max(nd)
   into   :ND
   from   acc_over
   where  ndoc='" || dfND || "'")
.head 7 +  If SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   select vidd
   into   :nTmp
   from   cc_kol
   where  vidd in (4,14,24) and nls is not null and rownum=1") and SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call SqlPLSQLCommand(hSql(), 'CCK.CC_9819(ND,0)')
.head 8 -  ! Call Debug('Референс договора='||SalNumberToStrX(ND, 0))
.head 6 -  Set Ins=0
.head 5 -  ! х-и договора
.head 5 +  If sS080 != "0" AND sS080 != STRING_Null
.head 6 -  Set sSql = "
    UPDATE specparam
    SET S080=:sS080
    where acc in (select acc      from acc_over where acc=:nAcc
        union all select acc_9129 from acc_over where acc=:nAcc
        union all select acc_2067 from acc_over where acc=:nAcc
        union all select acc_2096 from acc_over where acc=:nAcc)"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSql)
.head 6 -  Call SqlPrepareAndExecute(hSql(), "
     select acc
     into   :ACC_TMP
     from   accounts
     where  acc in (select acc      from acc_over where acc=:nAcc
          union all select acc_9129 from acc_over where acc=:nAcc
          union all select acc_2067 from acc_over where acc=:nAcc
          union all select acc_2096 from acc_over where acc=:nAcc) and acc not in (select acc from specparam)")
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SqlPrepareAndExecute(hSqlAux(), "
     insert
     into   specparam (acc,s080)
               values (:ACC_TMP,:sS080)")
.head 5 +  If not S180()
.head 6 -  Return FALSE
.head 5 +  If nFin != 0 AND nFin != NUMBER_Null
.head 6 +  If not SqlPrepareAndExecute(hSql(), "
   update customer
   SET    crisk =:nFin
   where  rnk=(select a.rnk
               from   accounts a
               where  a.acc=:nAcc)")
.head 7 -  Call SalMessageBox("Ошибка при проставлении категории риска клиента", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT nd
   INTO   :nOldND
   FROM   acc_over
   WHERE acc=:nAcc") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! определяем была ли запись данной даты на заданный договор  
.head 6 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT COUNT(*)
   INTO   :nCount
   FROM   acc_over_mdate
   WHERE  nd=:nOldND AND mdate=:MDATE")
.head 7 -  Call SqlFetchNext(hSql(),  nFetchRes)
.head 7 -  ! если записи еще нет
.head 7 +  If nCount = 0 AND NOT cbKrl AND MDATE != DATETIME_Null 
.head 8 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO acc_over_mdate (nd,mdate,acco,bdate)
                  VALUES (:nOldND,:MDATE,:nAcc,BANKDATE)")
.head 5 +  If not cbKrl
.head 6 +  If not SqlPrepareAndExecute(hSql(), "
   UPDATE accounts
   set    mdate=:MDATE
   WHERE  acc=:nAcc")
.head 7 -  Call SalMessageBox("Ошибка при проставлении даты гашения", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 6 +  If not SqlPrepareAndExecute(hSql(), "
   UPDATE accounts
   set    mdate=:dfDD2
   WHERE  acc=(select acc_9129
               from   acc_over
               where  acc=:nAcc and nvl(sos,0)!=1)")
.head 7 -  Call SalMessageBox("Ошибка при проставлении даты гашения", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 5 -  !
.head 5 +  If (bNew and dfDiskont>0) or bDiskont
.head 6 +  If bDiskont
.head 7 +  If not SqlPrepareAndExecute(hSql(), "
   UPDATE acc_over
   set    acc_3600=to_number(:sAcc)
   where  acc=:nAcc")
.head 8 -  Call SalMessageBox("Ошибка при изменении счёта 3600", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Set bDiskont = FALSE
.head 6 +  Else
.head 7 -  ! открыть счёт dfDiskont
.head 7 +  If not SqlPLSQLCommand(hSql(), "
   op_reg_ex(99,0,0,AGrp,nTmp,nRnk,dfNlsDiskont,dfKv,'Аморт.ОВРД.'||dfNms,'S36',nIsp,nAcc_3600,'1',NUMBER_Null,
             NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,
             STRING_Null,STRING_Null,nTobo,NUMBER_Null)")
.head 8 -  Call SalMessageBox("Ошибка при открытии счета 3600", 'Ошибка!', MB_Ok)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Set nDiskont = dfDiskont*100
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   UPDATE accounts
   set    MDATE=:dfDD2
   where  acc=:nAcc_3600") and SqlPrepareAndExecute(hSql(), "
   INSERT
   into   int_accn (acc,id,acra,acr_dat,metr,basey,freq,tt,io)
            values (:nAcc_3600,1,:nAcc_3600,:dfDD,4,0,1,'%%1',0)") and SqlPrepareAndExecute(hSql(), "
   UPDATE accounts
   set    tip='BLD'
   where  acc=:nAcc") and SqlPrepareAndExecute(hSql(), "
   UPDATE acc_over
   set    acc_3600=:nAcc_3600,s_3600=:nDiskont,flag_3600=1
   where  acc=:nAcc")
.head 9 -  Set nDiskont = dfDiskont
.head 8 +  Else
.head 9 -  Call SalMessageBox("Ошибка при сохранении параметров счёта 3600", 'Ошибка!', MB_Ok)
.head 9 -  Return FALSE
.head 5 -  !
.head 5 +  If bUpdateDiskont
.head 6 -  ! Call Debug('UPDATE')
.head 6 -  Set nDiskont = dfDiskont*100
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   UPDATE acc_over
   set    s_3600=:nDiskont
   where  acc=:nAcc")
.head 7 -  Set bUpdateDiskont = FALSE
.head 7 -  Set nDiskont = dfDiskont
.head 6 +  Else
.head 7 -  Call SalMessageBox("Ошибка при изменении суммы дисконта", 'Ошибка!', MB_Ok)
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Call SalMessageBox("Сохранены реквизиты договора " || dfND, 'Внимание!', MB_Ok | MB_IconAsterisk)
.head 5 -  Return TRUE
.head 3 +  Function: IfAccExists
.head 4 -  Description: Check to see if input account in GL
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sNls
.head 5 -  Number: nKv
.head 5 -  Receive Number: nAccN
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTmp
.head 5 -  Number: nR1 !! Рег № осн счета
.head 5 -  Number: nI1 !! исполнитель осн счета
.head 5 -  String: sN1  !! NLS осн счета
.head 5 -  String: sNMS !! NMS осн счета
.head 5 -  Number: nGrp !! Grp осн счета
.head 4 +  Actions
.head 5 -  Set nAccN = NUMBER_Null
.head 5 -  Call SqlPrepareAndExecute(hSql(), '
     SELECT acc
     INTO   :nAccN
     FROM   accounts
     WHERE  kv=:nKv and nls=:sNls')
.head 5 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalMessageBox('Счет ' || sNls || '/' || Str(nKv) || ' не открыт.', 'Внимание!', MB_IconHand)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: F_MDATE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  Number: tipo_
.head 5 -  Number: kol_
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! Date/Time: dat_
.head 5 -  Number: day_
.head 5 -  Number: i_
.head 5 -  Number: n980
.head 4 +  Actions
.head 5 -  Set n980 = GetBaseVal()
.head 5 -  Set MDATE = GetBankDate()
.head 5 -  Set day_ = 0
.head 5 +  If SalStrUpperX(strType) = 'MDATE'
.head 6 -  Call SalEnableWindow(MDATE)
.head 5 +  Loop
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   SELECT 0
   INTO   :i_
   FROM   holiday
   WHERE  holiday=:MDATE and kv=:n980")
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set i_ = 1
.head 7 +  If tipo_ = 7           !! банковские даты 
.head 8 -  Set day_ = day_ + i_
.head 8 +  If day_ < kol_  
.head 9 -  Set MDATE = MDATE + 1
.head 8 +  Else
.head 9 -  Return MDATE
.head 7 +  Else !! If tipo_ = 14  !! календарные даты
.head 8 -  Set day_ = day_ + 1
.head 8 +  If day_ < kol_ or i_ = 0
.head 9 -  Set MDATE = MDATE + 1
.head 8 +  Else
.head 9 -  Return MDATE
.head 5 -  Return MDATE
.head 3 +  ! Function: F_CalcDay
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 -  Actions 
.head 3 +  ! Function: SetDisabled
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call SalDisableWindow(dfND)
.head 5 -  ! Call SalDisableWindow(dfDD)
.head 5 -  ! Call SalDisableWindow(dfDD2)
.head 5 -  ! Call SalDisableWindow(dfSD)
.head 3 +  Function: Proc_Kart
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nAcc
.head 5 -  Number: nId
.head 5 -  String: Str1
.head 5 -  String: Str2
.head 5 -  Date/Time: dDat
.head 5 -  String: Txt
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SetProcParN(nAcc, nId, Str1, Str2)
.head 5 -  Return SqlPrepareAndExecute(hSql(), "
       UPDATE int_accn
       set    acr_dat=:dDat
       where  acc=:nAcc and id=:nId and (acr_dat<:dDat or acr_dat is null)") and
SqlCommitEx(hSql(), Txt || ' acc=' || Str(nAcc))
.head 3 -  !
.head 3 +  Function: If8000Exists
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sNls
.head 5 -  Number: nKv
.head 5 -  Receive Number: nAccN
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTmp
.head 5 -  Number: nR1 !! Рег № осн счета
.head 5 -  Number: nI1 !! исполнитель осн счета
.head 5 -  String: sN1  !! NLS осн счета
.head 5 -  String: sNMS !! NMS осн счета
.head 5 -  Number: nGrp !! Grp осн счета
.head 4 +  Actions
.head 5 -  Set nAccN = NUMBER_Null
.head 5 +  If sNls
.head 6 +  If SqlPrepareAndExecute(hSql(), '
   SELECT acc
   INTO   :nAccN
   FROM   accounts
   WHERE  kv=:nKv and nls=:sNls')
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If SalMessageBox('Счет ' || sNls || '/' || Str(nKv) ||' не открыт.' || PutCrLf() || ' Открыть ?', 'Внимание!',
   MB_YesNo | MB_IconHand) = IDYES
.head 9 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT a.rnk,a.isp,a.nms,a.grp
     INTO   :nR1,:nI1,:sNMS,:nGrp
     FROM   accounts a
     WHERE  a.acc=:nAcc")
.head 9 +  If SqlFetchNext(hSql(), nFetchRes) and SqlPLSQLCommand(hSql(), "
   Op_Reg_ex(99,0,0,AGrp,nTmp,nR1,sNls,nKv,SalStrLeftX('Ліміт ОВЕРДРАФТУ ' || SalStrTrimX(sNMS),70),'ODB',nI1,
             nAccN,'1',NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,NUMBER_Null,
             NUMBER_Null,NUMBER_Null,STRING_Null,STRING_Null,nTobo,NUMBER_Null)")
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SaveFInfoToLog("АвтоОткрытие сч." || sNls || "/" || Str(nKv))
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 5 -  Return TRUE
.head 3 +  Function: S180
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: NDays
.head 5 -  String: S180
.head 5 -  String: Dat1
.head 5 -  String: Dat2
.head 4 +  Actions
.head 5 -  Set NDays= MDATE - GetBankDate() +1
.head 5 -  Call SalDateToStr(dfDD, Dat1)
.head 5 -  Call SalDateToStr(MDATE, Dat2)
.head 5 +  If not (SqlPrepareAndExecute(hSql(), "
   select substr(f_srok(to_date(substr('" || Dat1 || "',1,10),'yyyy-mm-dd'),
          to_date(substr('" || Dat2 || "',1,10),'yyyy-mm-dd'),2),1,10)
   into   :S180
   from   dual") and SqlFetchNext(hSql(), nFetchRes))
.head 6 -  Call SalMessageBox("Ошибка при расчете параметра S180", 'Ошибка!', MB_Ok)
.head 6 -  Return FALSE
.head 5 +  If not SqlPrepareAndExecute(hSql(), '
   update specparam
   set    s180=:S180
   where  acc in (select acc
                  from   acc_over
                  where acc=:nAcc
                 union all
                  select acc_9129
                  from   acc_over
                  where  acc=:nAcc)')
.head 6 -  Call SalMessageBox("Ошибка при проставлении параметра S180", 'Ошибка!', MB_Ok)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: F_RANG
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sRang
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRang
.head 5 -  String: sInfo1
.head 5 -  String: sInfo2
.head 4 +  Actions
.head 5 +  If sRang != STRING_Null  
.head 6 -  Set nRang = Val(Left(sRang, 2))
.head 6 -  Set sInfo1 = 'Для сч.овр.' || dfNls || '/' || Str(dfKv)
.head 6 -  Set sInfo2 = 'Установлено шкалу ' || sRang
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   select 1
   from   int_accn
   where  acc=:nAcc and id=0 and metr=7") and not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox('Не найдена % карточка для метода плавающей ставки (7)', 'Внимание !', MB_IconStop)
.head 7 -  Return FALSE
.head 6 +  If not SqlPrepareAndExecute(hSql(), "
   update int_accn
   set    idr=:nRang
   where  id=0 and metr=7 and acc=:nAcc")
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 6 -  Call SqlCommitEx(hSql(), sInfo1 || ' ' || sInfo2)
.head 6 -  Call SalMessageBox(sInfo2, sInfo1, MB_Ok)
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nAcc 
.head 3 -  String: strType
.head 3 -  Number: nEdit    ! 1-Edit, 0-ReadOnly, 2-просмотр с правом подписи документов
.head 3 -  Boolean: bNew    ! 1-новый договор
.head 2 +  Window Variables
.head 3 -  Number: OVR_3739 ! признак использования счета гашения 3739. Исп в ГОУ ОБ
.head 3 -  Number: ACC_3739
.head 3 -  Number: nRnk
.head 3 -  Number: nIsp
.head 3 -  Number: nTmp
.head 3 -  Number: nDk
.head 3 -  Number: nRow
.head 3 -  Number: nGrp
.head 3 -  Number: nAccO
.head 3 -  Number: nAcc_2607
.head 3 -  Number: nAcc_9129
.head 3 -  Number: nAcc_8000
.head 3 -  Number: nAcc_3578
.head 3 -  Number: nFetchRes
.head 3 -  ! Date/Time: MDATE
.head 3 -  String: sSqlZ
.head 3 -  String: sTmp
.head 3 -  String: sTmpR
.head 3 -  Boolean: bTmp
.head 3 -  Number: nPawn
.head 3 -  Number: mPawn[*]
.head 3 -  Number: nPawnM
.head 3 -  Number: mPawnM[*]
.head 3 -  String: sNbs3[*]
.head 3 -  String: sTmp3
.head 3 -  String: sNlsK
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  Number: nAccz
.head 3 -  Number: nTipO
.head 3 -  String: strParentWindowName
.head 3 -  String: sOldDocNum
.head 3 -  Number: nNewND
.head 3 -  Number: nOldND
.head 3 -  Number: nCount
.head 3 -  Number: nNewDog
.head 3 -  Number: nFlagval
.head 3 -  Number: nAccLim
.head 3 -  String: sNls9class
.head 3 -  String: sNls2607
.head 3 -  String: sNls8class
.head 3 -  String: sNls3class
.head 3 -  Number: nUserid
.head 3 -  Number: nFin
.head 3 -  Number: nObs
.head 3 -  Number: nRef_
.head 3 -  String: sS080
.head 3 -  Number: bS080
.head 3 -  String: Nms8
.head 3 -  String: Nms3
.head 3 -  String: Nls3
.head 3 -  String: NBS2600
.head 3 -  String: NBS2000
.head 3 -  String: NBS2607
.head 3 -  String: NBS2067
.head 3 -  String: NBS2069
.head 3 -  String: NBS2096
.head 3 -  String: NBS2480
.head 3 -  String: NBS9129
.head 3 -  String: NLSA
.head 3 -  String: NLSB
.head 3 -  Number: ACCS
.head 3 -  Number: ND
.head 3 -  Number: Ins
.head 3 -  Number: CustType
.head 3 -  !
.head 3 -  Number: nAcc_3600
.head 3 -  Boolean: bDiskont
.head 3 -  String: sNlsDiskont
.head 3 -  Boolean: bUpdateDiskont
.head 3 -  String: sAcc
.head 3 -  Number: nDiskont
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 +  ! If not bNew
.head 5 -  Call SalDisableWindow(dfDiskont)
.head 4 -  Set bDiskont = FALSE
.head 4 -  Set bUpdateDiskont = FALSE
.head 4 -  Set OVR_3739 = GetGlobalOptionEx('OVR_3739')
.head 4 +  If OVR_3739 = 1
.head 5 -  Call SalShowWindow(dfNls_3739)
.head 5 -  Call SalShowWindow(dfNms_3739)
.head 4 +  Else
.head 5 -  Call SalHideWindow(dfNls_3739)
.head 5 -  Call SalHideWindow(dfNms_3739)
.head 4 +  If bNew and GetGlobalOptionEx('OVR_PK') = 0
.head 5 -  Call SalDisableWindow(pbPROC_2600)
.head 5 -  Call SalDisableWindow(pbPROC_8000)
.head 5 -  Call SalDisableWindow(pbPROC_9129)
.head 4 -  Set nNewDog = 0
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  ! анализ параметра вызова strType
.head 4 +  ! If SalStrUpperX(strType) = 'MDATE'
.head 5 -  Call SalSetWindowText(hWndForm, 'ОВЕРДРАФТ. Установка даты от договора')
.head 4 +  ! Else 
.head 5 -  Call SalSetWindowText(hWndForm, 'ОВЕРДРАФТ. Установка даты от первого дебета')
.head 4 +  If SqlPrepareAndExecute(hSql(), '
   select nbs2600,nbs2000,nbs2607,nbs2067,nbs2069,nbs2096,nbs2480,nbs9129
   into  :NBS2600,:NBS2000,:NBS2607,:NBS2067,:NBS2069,:NBS2096,:NBS2480,:NBS9129
   from  acc_over_nbs
   where nbs2600=(select nbs from accounts where acc=:nAcc)')
.head 5 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Set NBS2600 = '2600'
.head 6 -  Set NBS2000 = '2000'
.head 6 -  Set NBS2607 = '2607'
.head 6 -  Set NBS2067 = '2067'
.head 6 -  Set NBS2069 = '2069'
.head 6 -  Set NBS2096 = '2096'
.head 6 -  Set NBS2480 = '2480'
.head 6 -  Set NBS9129 = '9129'
.head 4 +  If SqlPrepareAndExecute(hSql(),
 "SELECT CUSTTYPE into :CustType  FROM accounts a, CUSTOMER c WHERE a.rnk=c.rnk AND a.acc=:nAcc")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  ! Call Debug(CustStr(CustType))
.head 4 -  Call SalListPopulate(cmbVidd, hSql(), "
     SELECT name
     FROM   CC_VIDD
     WHERE  custtype=:CustType and tipd=1 and vidd in (4,14,24)")
.head 4 -  Call SalListPopulate(cmbIsp, hSql(), "
     SELECT id||'.'||fio
     FROM   staff
     where  type=1")
.head 4 -  Call SalListPopulate(cmbFin, hSql(), "
     SELECT name
     FROM   stan_fin")
.head 4 -  Call SalListPopulate(cmbObs, hSql(), "
     SELECT name
     FROM   stan_obs")
.head 4 -  Call SalListPopulate(cmbS080, hSql(), "
     SELECT name
     FROM   crisk")
.head 4 -  ! проверка на наличие операции ZAL
.head 4 +  If SqlPrepareAndExecute(hSql(), "
    SELECT nlsm
    INTO   :sNlsK
    FROM   tts
    WHERE  tt='ZAL'") and not SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call SalMessageBox('Не описана операция ZAL' , 'Внимание !',  MB_IconExclamation)
.head 4 -  !
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set nRnk = NUMBER_Null
.head 4 -  Set nIsp = NUMBER_Null
.head 4 -  Set nFin = NUMBER_Null
.head 4 -  Set nObs = NUMBER_Null
.head 4 -  Set sS080 = STRING_Null
.head 4 -  Set nAccO = NUMBER_Null
.head 4 -  Call SalDisableWindow(pbOPEN)
.head 4 -  Call SalDisableWindow(pbCLOSE)
.head 4 -  ! ------------------------------------------------------------
.head 4 -  ! Населить комбо-бокс шкалами
.head 4 -  Call SalListPopulate(cmbRang, hSql(), "
     SELECT substr('0'||id,-2)||'/'|| name
     from   int_ovr_rang
     order by id desc")
.head 4 -  !
.head 4 +  If nAcc != NUMBER_Null and nAcc > 0 and SqlPrepareAndExecute(hSql(), "
   SELECT A.nls,A.kv,A.nms,C.rnk,C.nmk,O.acco,A.isp,A.grp,O.ndoc,O.TIPO,O.DAY,O.datd,O.datd2,V.name,O.nd,O.SD/100,
          A.lim/100,O.txt,C.crisk,O.OBS,P.S080,o.userid,sf.NAME,s.Id||'.'||s.FIO,so.NAME,p.acc,O.PR_2600A
   INTO   :dfNls,:dfKv,:dfNms,:nRnk,:dfNmk,:nAccO,:nIsp,:nGrp,:dfND,:nTipO,:dfDney,:dfDD,:dfDD2,:cmbVidd,:nOldND,:dfSD,
          :dfSD_Lim,:dfTxt,:nFin,:nObs,:sS080,:nUserid,:cmbFin,:cmbIsp,:cmbObs,:bS080,:dfDneyProc
   FROM   accounts A, customer C, acc_over O, cc_vidd V, STAN_FIN sf, STAFF S, STAN_OBS so, specparam P
   WHERE  A.acc=:nAcc and C.rnk=a.rnk and NVL(C.crisk,0)=SF.fin(+) and nvl(O.obs,0)=SO.obs(+) and A.acc=O.acc and
          NVL(o.userid,0)=s.ID(+) and nvl(o.vidd,0)=V.vidd(+) and nvl(o.sos,0)<>1 and p.acc(+)=a.acc") and
   SqlFetchNext(hSql(), nFetchRes)
.head 5 -  ! Установить нач.значение  шкалы
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT substr('0'||n.id,-2)||'/'||n.name
   into   :sTmpR
   FROM   int_accn i, int_ovr_rang n
   WHERE  i.acc=:nAcc and i.id=0 and i.metr=7 and nvl(i.idr,2)=n.id") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Call Debug(Str(nAcc) || ' '|| sTmpR)
.head 6 -  Call SalListSelectString(cmbRang, -1, sTmpR)
.head 5 -  !
.head 5 -  Call SalDisableWindow(dfNmk)
.head 5 -  ! Call SalDisableWindow(dfNls)
.head 5 -  ! Call SalDisableWindow(dfKv)
.head 5 -  Call SalDisableWindow(dfNms)
.head 5 -  Call SalEnableWindow(pbOPEN)
.head 5 -  Set nNewDog = 1
.head 4 +  Else If nAcc != NUMBER_Null and nAcc > 0 and dfNlsO = STRING_Null
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT A.nls,A.kv,A.grp
   INTO   :dfNls,:dfKv,:nGrp
   FROM   accounts A
   WHERE  A.acc=:nAcc") and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call SalPostMsg(dfNls, SAM_Validate, 0, 0)
.head 4 -  ! 3739
.head 4 +  If nAcc > 0
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT a.acc,a.nls,a.nms
   into   :ACC_3739,:dfNls_3739,:dfNms_3739
   FROM   accounts A, acc_over O
   WHERE  A.acc=o.acc_3739 and o.acc=:nAcc") and SqlFetchNext(hSql(), nFetchRes)
.head 4 -  Call SalDisableWindow(dfNls)
.head 4 -  Call SalDisableWindow(dfKv)
.head 4 -  If nRnk = NUMBER_Null and SqlPrepareAndExecute(hSql(), "
   select rnk
   into   :nRnk
   from   accounts
   where  acc=:nAcc") and SqlFetchNext(hSql(), nFetchRes)
.head 4 -  Set dfRnk = nRnk
.head 4 +  If nAccO
.head 5 +  If SqlPrepareAndExecute(hSql(), "
   SELECT a.nls,o.tipo,a.mdate,o.krl,o.uselim,decode(flag,3,1,2,1,0),n.nls,n.nms,o.ACC_9129,o.ACC_8000,av.nls,
          o.s_3600/100
   INTO   :dfNlsO,:nTipO,:MDATE,:cbKrl,:cbUselim,:cbBl9kl,:dfNlsA,:dfNmsA,:nAcc_9129,:nAcc_8000,:dfNlsDiskont,:dfDiskont
   FROM   accounts a, acc_over o, int_accn i, accounts n, accounts av
   WHERE  o.acco=:nAccO and a.acc=o.acco and nvl(o.sos,0)<>1 and a.acc=i.acc(+) and i.id(+)=0 and i.acra=n.acc and
          av.acc(+)=o.acc_3600") and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Call SalEnableWindow(pbCLOSE)
.head 6 -  Set sNlsDiskont = dfNlsDiskont
.head 6 -  Set nDiskont = dfDiskont
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT name
   INTO   :cmbS080
   FROM   crisk
   WHERE  crisk=:sS080") and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  !
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT c.name
   INTO   :R080
   FROM   crisk c, fin_obs_s080 f
   WHERE  f.s080=c.crisk and f.FIN=:nFin and f.obs=:nObs") and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  !
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT nls,nms
   INTO   :dfNls9,:dfNms9
   FROM   accounts
   WHERE  acc=:nAcc_9129") and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT nls,dos/100
   INTO   :dfNls8,:dfDos8
   FROM   sal
   WHERE  fdat=bankdate and acc=:nAcc_8000") and SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  If SqlPrepareAndExecute(hSql(), "
   SELECT nls,0
   INTO   :dfNls8,:dfDos8
   FROM   accounts
   WHERE  acc=:nAcc_8000") and SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set sSqlZ = "
    SELECT 1,a.acc,a.nls,a.kv,t.lcv,a.ostB/100,pa.mpawn,m.name,pa.pawn,v.name,pa.ndz,c.rnk,c.nmk
    INTO   :tZ.colFL,:tZ.colAcc,:tZ.colNls,:tZ.colKv,:tZ.colValZal,:tZ.colSumZal_1,:tZ.colPawnM,:tZ.colMestoZal,
           :tZ.colPawn,:tZ.colVidZal,:tZ.colNdz,:tZ.colRnk, :tZ.Zalogodatel
    FROM   accounts a, cc_accp p, cc_mpawn m, cc_pawn v, tabval t, customer c, pawn_acc pa
    WHERE  a.acc=p.acc and a.kv=t.kv and pa.mpawn=m.mpawn(+) and pa.pawn=v.pawn and p.accs=:nAccO and p.acc=pa.acc and
           a.rnk=c.rnk
    GROUP BY a.acc,a.nls,a.kv,t.lcv,a.ostB/100,pa.mpawn,m.name,pa.pawn,v.name,pa.ndz,c.rnk,c.nmk"
.head 5 -  ! Call SetDisabled()
.head 4 -  Else
.head 4 +  If nTipO = 7
.head 5 -  Set rbBd = TRUE
.head 4 +  If nTipO = 14
.head 5 -  Set rbKd = TRUE
.head 4 +  If cmbIsp = STRING_Null
.head 5 -  Set cmbIsp = Str(GetUserId()) || '.' || GetUserRealName()
.head 4 -  Set sOldDocNum = dfND
.head 4 -  Call SalEnableWindow(pbOPEN)
.head 4 +  If not TO.AskInsp and TO.strPar02 != ""
.head 5 -  Call SalDisableWindow(pbOPEN)
.head 5 -  Call SalDisableWindow(pbPROC_2600)
.head 5 -  Call SalDisableWindow(pbPROC_8000)
.head 5 -  Call SalDisableWindow(pbPROC_9129)
.head 5 -  Call SalDisableWindow(pbCLOSE)
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  Call SalSetFocus(pbEXIT)
.head 3 +  On UM_CreateDoc
.head 4 -  Call SalModalDialog(dlg_CreateOverDoc, hWndMDI, TO.ND)
.head 1 +  Dialog Box: dlg_MemoEditor
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.95"
.head 4 -  Top:    2.052"
.head 4 -  Width:  13.033"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.536"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Multiline Field: mlEditor
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.433"
.head 6 -  Top:    0.155"
.head 6 -  Width:  12.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Courier New
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Italic
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Set fEdited=TRUE
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: Title
.head 3 -  Receive Boolean: fEdited
.head 3 -  Receive Long String: SQLText
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText( dlg_MemoEditor, Title )
.head 4 -  Call SalCenterWindow( dlg_MemoEditor )
.head 4 -  Set mlEditor=SQLText
.head 4 -  Set fEdited=FALSE
.head 3 +  On SAM_Close
.head 4 +  If fEdited
.head 5 +  If SalMessageBox('Сохранить изменения?', 'Редактирование', MB_YesNo | MB_IconQuestion | MB_DefButton1) = IDYES
.head 6 -  Set SQLText=mlEditor
.head 1 +  Table Window: KD
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Управление модулем КД_888
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.229"
.head 4 -  Width:  15.867"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.5"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Открыть новоый договор'
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Изъять договор с нулевыми суммами'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and
    KD.SKP=0 and KD.SDP=0 and KD.SD=0 and KD.SK=0
and KD.OTM =NUMBER_Null
.head 8 +  If SqlPrepareAndExecute( hSql(),
"DELETE FROM KD_888 WHERE rnk=:KD.RNK" )
.head 9 -  Call SqlCommitEx( hSql(),'КД_888: Изъять договор '||Str(KD.RNK))
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сохранить реквизиты клиента '
.head 4 -  Line
.head 5 -  Resource Id: 49671
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.433"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  5.433"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.033"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.333"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Аналитические счета договора'
.head 6 +  On SAM_Click
.head 7 -  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and
    KD.ACC1>0 and KD.ACC2>0  and KD.ACC6>0  and KD.ACC7>0
and KD.OTM=NUMBER_Null
.head 7 -  Set sTmp="a.acc in ("||
Str(KD.ACC1)||","|| Str(KD.ACC2)||","|| Str(KD.ACC6)||","|| Str(KD.ACC7)|| ")"
.head 7 -  Call ShowAccF(hWndMDI,sTmp )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.9"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49672
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.0"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  5.0"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.533"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49673
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.917"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  1.917"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Pushbutton: pb_1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.967"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Help.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Salmon
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = sTip[1]
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and KD.ACC1 > 0
.head 8 -  Call SetProcParN( KD.ACC1, KD.n980, '', '')
.head 4 +  Pushbutton: pb_2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.42"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Help.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Periwinkle
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = sTip[2]
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and KD.ACC2 > 0
.head 8 -  Call SetProcParN( KD.ACC2, KD.n980, '', '')
.head 4 -  !
.head 4 +  Pushbutton: pb_3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.133"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CHEKIN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = sTip[3]
.head 6 +  On SAM_Click
.head 7 -  Call KD_P(0, 0)
.head 4 +  Pushbutton: pb_4
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.58"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Red
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip =  sTip[4]
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and KD.OTM=NUMBER_Null
.head 8 -  Call KD_P(0, KD.RNK)
.head 4 -  !
.head 4 +  Pushbutton: pb_5
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.15"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Orchid
.head 5 -  Background Color: Yellow
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = sTip[5]
.head 6 +  On SAM_Click
.head 7 -  Call Sel010(hWndForm,0,0, " and s.nls like '888%' " , STRING_Null )
.head 4 +  Pushbutton: pb_6
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_ints.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Yellow
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = sTip[6]
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and KD.ACC1>0 and KD.ACC2>0
and KD.OTM=NUMBER_Null
.head 8 -  Call Sel010(hWndForm,0,0,
" and s.acc in ("||Str(KD.ACC1)||","||Str(KD.ACC2)||")" ,
STRING_Null )
.head 4 -  !
.head 4 +  Pushbutton: pb_7
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.15"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Chartreuse
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip =sTip[7]
.head 6 +  On SAM_Click
.head 7 -  Call KD_P(1, 0)
.head 4 +  Pushbutton: pb_8
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_ints.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Chartreuse
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip =  sTip[8]
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call KD_P(1, KD.RNK)
.head 4 -  !
.head 4 +  Combo Box: cmbAction
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.867"
.head 6 -  Top:    0.143"
.head 6 -  Width:  4.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? Yes
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalListInsert (cmbAction,0, sTip [8] )
.head 7 -  Call SalListInsert (cmbAction,0, sTip [7] )
.head 7 -  Call SalListInsert (cmbAction,0, sTip [6] )
.head 7 -  Call SalListInsert (cmbAction,0, sTip [5] )
.head 7 -  Call SalListInsert (cmbAction,0, sTip [4] )
.head 7 -  Call SalListInsert (cmbAction,0, sTip [3] )
.head 7 -  Call SalListInsert (cmbAction,0, sTip [2] )
.head 7 -  Call SalListInsert (cmbAction,0, sTip [1] )
.head 4 +  Pushbutton: pbExecute
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.367"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выполнить ВЫБРАННУЮ задачу '
.head 6 +  On SAM_Click
.head 7 +  If cmbAction      = sTip [1]
.head 8 -  Call SalSendMsg(  pb_1, SAM_Click, 0, 0 )
.head 7 +  Else If cmbAction = sTip [2]
.head 8 -  Call SalSendMsg( pb_2, SAM_Click, 0, 0 )
.head 7 +  Else If cmbAction = sTip [3]
.head 8 -  Call SalSendMsg( pb_3, SAM_Click, 0, 0 )
.head 7 +  Else If cmbAction = sTip [4]
.head 8 -  Call SalSendMsg( pb_4, SAM_Click, 0, 0 )
.head 7 +  Else If cmbAction = sTip [5]
.head 8 -  Call SalSendMsg( pb_5, SAM_Click, 0, 0 )
.head 7 +  Else If cmbAction = sTip [6]
.head 8 -  Call SalSendMsg( pb_6, SAM_Click, 0, 0 )
.head 7 +  Else If cmbAction = sTip [7]
.head 8 -  Call SalSendMsg( pb_7, SAM_Click, 0, 0 )
.head 7 +  Else If cmbAction = sTip [8]
.head 8 -  Call SalSendMsg( pb_8, SAM_Click, 0, 0 )
.head 7 -  !
.head 4 -  Frame
.head 5 -  Resource Id: 49674
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.167"
.head 6 -  Top:    0.024"
.head 6 -  Width:  5.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.429"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Square
.head 5 -  Border Style: Raised-Shadow
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: Default
.head 5 -  Background Color: Default
.head 2 +  Contents
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег №
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If KD.OTM=NUMBER_Null
.head 7 +  If SqlPrepareAndExecute( hSql(),
"SELECT nmk INTO :KD.NMK FROM customer where rnk=:KD.RNK" )
.head 8 -  Return SqlFetchNext( hSql(), nFetchRes )
.head 6 +  Else
.head 7 -  Set RNK=NUMBER_Null
.head 7 -  Return TRUE
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpT=''
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наим.
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If KD.OTM=NUMBER_Null and (KD.ACC1=0 or KD.ACC1=NUMBER_Null)
.head 7 -  Set sTmp=Str(KD.RNK)
.head 7 -  Call FunNSIGet('CUSTOMER','NMK',sTmp, KD.NMK)
.head 7 -  Set KD.RNK=Val(sTmp)
.head 5 +  On SAM_SetFocus
.head 6 +  If KD.OTM=NUMBER_Null and (KD.ACC1=0 or KD.ACC1=NUMBER_Null)
.head 7 -  Set sTmpT='F4(DoubleClick): Выбор клиента'
.head 6 +  Else
.head 7 -  Set sTmpT=''
.head 3 +  Column: TIP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код Типа
клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TIPS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If KD.OTM=NUMBER_Null
.head 7 -  Set sTmp=STRING_Null
.head 7 -  Call FunNSIGet('KD_TIP','NAME',sTmp, KD.TIPS)
.head 7 -  Set KD.TIP=Val(sTmp)
.head 7 -  Call SalTblSetRowFlags( hWndForm, SalTblQueryContext( hWndForm ), ROW_Edited, TRUE )
.head 5 +  On SAM_SetFocus
.head 6 +  If KD.OTM=NUMBER_Null
.head 7 -  Set sTmpT='F4(DoubleClick): Выбор клиента'
.head 6 +  Else
.head 7 -  Set sTmpT=''
.head 3 +  Column: OKLAD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Оклад
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.883"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpT=''
.head 3 +  Column: KOL_OKL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кол.
окл.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpT=''
.head 3 +  Column: DATPR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
устан.% Кр
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpT=''
.head 3 +  Column: PR_K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: % ст
Кр
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpT=''
.head 3 +  Column: DATPR2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
устан.% Дп
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpT=''
.head 3 +  Column: PR_D
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: % ст
Дп
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpT=''
.head 3 +  Column: S_PR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код Способа
выплаты %
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S_PRS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Способ
выплаты %
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If KD.OTM=NUMBER_Null
.head 7 -  Set sTmp=STRING_Null
.head 7 -  Call FunNSIGet('KD_S_PR', 'NAME', sTmp, KD.S_PRS)
.head 7 -  Set KD.S_PR=Val(sTmp)
.head 7 -  Call SalTblSetRowFlags( hWndForm, SalTblQueryContext( hWndForm ), ROW_Edited, TRUE )
.head 5 +  On SAM_SetFocus
.head 6 +  If KD.OTM=NUMBER_Null
.head 7 -  Set sTmpT='F4(DoubleClick): Выбор способа выплаты %'
.head 6 +  Else
.head 7 -  Set sTmpT=''
.head 3 +  Column: N_KART
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
карточки
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpT=''
.head 3 -  !
.head 3 +  Column: SVP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: % к
выплате
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SKP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Нач %
по Кр
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SDP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Нач %
по Дп
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
Кредита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
Депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.133"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
Кр
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
Дп
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC6
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
Кр
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC7
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
Дп
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OTM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДЛя
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: KD_P
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMod
.head 5 -  Number: nRnk
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNazn
.head 5 -  Boolean: bTmp
.head 4 +  Actions
.head 5 -  Set sNazn = "Згідно з ..."
.head 5 +  If nMod = 0
.head 6 -  Call SalModalDialog( dlg_MemoEditor, hWndForm,
   "Підстава для виконання операцій", bTmp, sNazn )
.head 5 -  !
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 6 +  If SqlPLSQLCommand(hSql(), "BARS.KD_P( nMod, nISP, nRnk, sNazn )" )
.head 7 -  Call SqlCommitEx( hSql(),'КД_888: Обновление остатков '||Str(nRnk))
.head 7 -  Call SalWaitCursor(FALSE)
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'BARS.KD_P', 30, 1 )
.head 5 -  !
.head 5 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  String: sTip[*]
.head 3 -  String: sTmp
.head 3 -  String: sTmpT
.head 3 -  Date/Time: dDat
.head 3 -  Date/Time: dDATPR1
.head 3 -  Date/Time: dDATPR2
.head 3 -  Number: IR1
.head 3 -  Number: IR2
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  Number: n980
.head 3 -  Number: nISP
.head 3 -  !
.head 3 -  Number: nKol
.head 3 -  Number: nTmp
.head 3 -  Number: nSum0
.head 3 -  Number: nSum1
.head 3 -  Number: nSum2
.head 3 -  Number: nSum6
.head 3 -  Number: nSum7
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalTblSetLockedColumns(hWndForm,13)
.head 4 -  !
.head 4 -  Set sTip [1] = '1. ОДИН КРЕДИТ   - % карточка  '
.head 4 -  Set sTip [2] = '2. ОДИН ДЕПОЗИТ  - % карточка  '
.head 4 -  Set sTip [3] = '3. ВЕСЬ ПОРТФЕЛЬ - Обновление  '
.head 4 -  Set sTip [4] = '4. ОДИН ДОГОВОР  - Обновление  '
.head 4 -  Set sTip [5] = '5. ВЕСЬ ПОРТФЕЛЬ - Начислить % '
.head 4 -  Set sTip [6] = '6. ОДИН ДОГОВОР  - Начислить % '
.head 4 -  Set sTip [7] = '7. ВЕСЬ ПОРТФЕЛЬ - Выплата %   '
.head 4 -  Set sTip [8] = '8. ОДИН ДОГОВОР  - Выплата %   '
.head 4 -  !
.head 4 -  Set KD.strSqlPopulate=
"SELECT KD_888.RNK, c.NMK, KD_888.TIP, t.name, KD_888.OKLAD, KD_888.KOL_OKL,
        KD_888.PR_K,  KD_888.PR_D, KD_888.S_PR, s.name,  KD_888.N_KART,
        nvl(KD_888.acc1,0), nvl(KD_888.acc2,0),
        nvl(KD_888.acc6,0), nvl(KD_888.acc7,0),
        KD_888.DATPR, KD_888.DATPR2
 INTO :KD.RNK, :KD.NMK, :KD.TIP, :KD.TIPS, :KD.OKLAD, :KD.KOL_OKL,
      :KD.PR_K,:KD.PR_D,:KD.S_PR,:KD.S_PRS,:KD.N_KART,
      :KD.ACC1, :KD.ACC2, :KD.ACC6, :KD.ACC7,
      :KD.DATPR, :KD.DATPR2
 FROM KD_888, customer c, KD_TIP t, KD_S_PR s
 WHERE KD_888.rnk  = c.RNK and
       KD_888.S_PR = s.S_PR (+) and
       KD_888.tip  = t.tip (+)
 ORDER BY KD_888.tip, KD_888.OKLAD"
.head 4 -  !
.head 4 -  Set KD.strSqlUpdate =
"UPDATE KD_888
 SET TIP  =:KD.TIP , OKLAD =:KD.OKLAD, KOL_OKL=:KD.KOL_OKL, PR_K  =:KD.PR_K,
     PR_D =:KD.PR_D, S_PR  =:KD.S_PR , N_KART =:KD.N_KART ,
    DATPR =:KD.DATPR, DATPR2 =:KD.DATPR2
WHERE rnk=:KD.RNK"
.head 4 -  !
.head 4 -  Set KD.strSqlInsert =
"INSERT INTO KD_888 (RNK, KOL_OKL, OKLAD ,PR_K, PR_D, TIP, S_PR, N_KART,
                     DATPR,DATPR2 )
 VALUES
 (:KD.RNK,:KD.KOL_OKL,:KD.OKLAD,:KD.PR_K,:KD.PR_D,:KD.TIP,:KD.S_PR,:KD.N_KART,
  :KD.DATPR,:KD.DATPR2 ) "
.head 4 -  !
.head 4 -  Set KD.nFlags=GT_NoRet
.head 4 -  Set KD.strFilterTblName= 'KD_888'
.head 4 -  Set KD.strPrintFileName= 'KD_888'
.head 4 -  !
.head 4 -  Set KD.nISP=GetUserId()
.head 4 -  Set KD.n980=GetBaseVal()
.head 4 -  Set KD.dDat=GetBankDate()
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On SAM_FetchRowDone
.head 4 -  Call SalTblSetCellTextColor( KD.PR_K, COLOR_Red, FALSE )
.head 4 -  Call SalTblSetCellTextColor( KD.PR_D, COLOR_Blue, FALSE )
.head 4 -  Call SalTblSetCellTextColor( KD.SKP, COLOR_Red, FALSE )
.head 4 -  Call SalTblSetCellTextColor( KD.SDP, COLOR_Blue, FALSE )
.head 4 -  Call SalTblSetCellTextColor( KD.SK, COLOR_Red, FALSE )
.head 4 -  Call SalTblSetCellTextColor( KD.SD, COLOR_Blue, FALSE )
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute( hSqlAux2(),
"SELECT a6.ostb/100, a7.ostb/100, a1.ostb/100, a2.ostb/100
 INTO :KD.SKP, :KD.SDP,  :KD.SK,  :KD.SD
 FROM accounts a6, accounts a7, accounts a1, accounts a2
 WHERE a6.acc=:KD.ACC6 and a7.acc=:KD.ACC7 and a1.acc=:KD.ACC1 and a2.acc=:KD.ACC2 ")
and not SqlFetchNext( hSqlAux2(), nFetchRes )
.head 5 -  Set KD.SKP =0
.head 5 -  Set KD.SDP =0
.head 5 -  Set KD.SK  =0
.head 5 -  Set KD.SD  =0
.head 4 -  !
.head 4 -  Set KD.SVP = KD.SDP + KD.SKP
.head 4 +  If KD.OKLAD * KD.KOL_OKL = 0
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Salmon )
.head 4 +  Else If KD.SD != KD.OKLAD * KD.KOL_OKL
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam,COLOR_LightPeriwinkle )
.head 4 +  Else If KD.SD != -KD.SK
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Sky )
.head 4 -  !
.head 4 -  Set KD.nKol  = KD.nKol + 1
.head 4 -  Set KD.nSum0 = KD.nSum0 + KD.SVP
.head 4 -  Set KD.nSum1 = KD.nSum1 + KD.SK
.head 4 -  Set KD.nSum2 = KD.nSum2 + KD.SD
.head 4 -  Set KD.nSum6 = KD.nSum6 + KD.SKP
.head 4 -  Set KD.nSum7 = KD.nSum7 + KD.SDP
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute( hSqlAux2(),
  "SELECT max(bdat) INTO :KD.dDATPR1 FROM int_ratn WHERE id=0 and acc=:KD.ACC1 ")
and SqlFetchNext( hSqlAux2(), nFetchRes )

and SqlPrepareAndExecute( hSqlAux2(),
   "SELECT ir INTO :KD.IR1 FROM int_ratn WHERE id=0 and acc=:KD.ACC1 and bdat=:KD.dDATPR1 ")
and SqlFetchNext( hSqlAux2(), nFetchRes )

and SqlPrepareAndExecute( hSqlAux2(),
   "SELECT max(bdat) INTO :KD.dDATPR2 FROM int_ratn WHERE id=1 and acc=:KD.ACC2 ")
and SqlFetchNext( hSqlAux2(), nFetchRes )

and SqlPrepareAndExecute( hSqlAux2(),
   "SELECT ir INTO :KD.IR2 FROM int_ratn WHERE id=1 and acc=:KD.ACC2 and bdat=:KD.dDATPR2 ")
and SqlFetchNext( hSqlAux2(), nFetchRes )

.head 5 +  If KD.dDATPR1 != KD.DATPR
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Gray )
.head 5 +  If KD.IR1 != KD.PR_K
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
.head 5 -  !
.head 5 +  If KD.dDATPR2 != KD.DATPR2
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Green )
.head 5 +  If KD.IR2 != KD.PR_D
.head 6 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen )
.head 3 +  On UM_Populate
.head 4 -  Set KD.nKol  = 0
.head 4 -  Set KD.nSum0 = 0
.head 4 -  Set KD.nSum1 = 0
.head 4 -  Set KD.nSum2 = 0
.head 4 -  Set KD.nSum7 = 0
.head 4 -  Set KD.nSum6 = 0
.head 4 -  Call SalSendClassMessage( UM_Populate, 0, 0)
.head 4 -  Call SalTblDefineSplitWindow ( hWndForm, 3, TRUE )
.head 4 -  Set KD.nTmp=SalTblInsertRow ( hWndForm, TBL_MinRow )
.head 4 -  Call SalTblSetContext ( hWndForm, KD.nTmp)
.head 4 -  Call SalTblSetRowFlags( hWndForm, KD.nTmp, ROW_New, FALSE )
.head 4 -  Set KD.SVP = KD.nSum0
.head 4 -  Set KD.SKP = KD.nSum6
.head 4 -  Set KD.SDP = KD.nSum7
.head 4 -  Set KD.SK  = KD.nSum1
.head 4 -  Set KD.SD  = KD.nSum2
.head 4 -  Set KD.NMK = 'Всего: '||Str( KD.nKol )
.head 4 -  Set KD.OTM = 1
.head 3 +  On SAM_RowSetContext
.head 4 -  Call XSalTooltipShow( hWndForm, KD.sTmpT )
.head 1 +  ! cQuickTabsForm: SKP_Calc
.winattr class Form Window:
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name: qtchi11.dll
.head 2 -  Title: Предварительный расчет стоимости аренды
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.05"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.56"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  0.1"
.head 4 -  Height: 0.1"
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -                                                                                       Description: 
.head 2 -                                                                                       Named Menus 
.head 2 -                                                                                       Menu 
.head 2 +                                                                                       Tool Bar 
.head 3 -                                                                                       Contents 
.head 2 +                                                                                       Contents 
.head 3 +                                                                                       Picture: picSKP
.data CLASSPROPS
0000: 546162557365466F 6E74000700506172 656E740000546162 466F6E744E616D65
0020: 000E004D53205361 6E73205365726966 00005461624C6566 744D617267696E00
0040: 0200300000546162 43757272656E7400 06004E616D653000 00546162426F7474
0060: 6F6D4D617267696E 0002003000005461 6250616765436F75 6E74000200310000
0080: 5461624C6162656C 73001E00D0E0F1F7 E5F220F1F2EEE8EC EEF1F2E809D0E0F1
00A0: F7E5F220F1F0EEEA E000005461624E61 6D6573000C004E61 6D6530094E616D65
00C0: 3100005461625269 6768744D61726769 6E00020030000054 6162447261775374
00E0: 796C65000B005769 6E39355374796C65 0000546162466F72 6D50616765730002
0100: 0009000054616254 6F704D617267696E 0002003000005461 62466F6E7453697A
0120: 6500020038000054 61624F7269656E74 6174696F6E000100 0000000000000000
0140: 0000000000000000 0000000000000000 000000000000
.enddata
.data CLASSPROPSSIZE
0000: 5601
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Background Text: № сейфа:
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -                                                                                       Background Text: Дата начала аренды:
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -                                                                                       Background Text: Дата окончания аренды:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -                                                                                       Background Text: Стоимость аренды:
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 +                                                                                       Data Field: dfN_SKs
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +                                                                                       Message Actions 
.head 5 +                                                                                       On SAM_Validate
.head 6 -                                                                                       Call SqlPrepareAndExecute( hSql(), 
"SELECT n_sk INTO :SKP_Calc.dfN_SKs
 FROM spec_agio WHERE n_sk=:SKP_Calc.dfN_SKs " )
.head 6 +                                                                                       If not SqlFetchNext( hSql(), nFetchRes )
.head 7 -                                                                                       Call SalMessageBox( 'Сейф с таким номером не существует!', 'Внимание', MB_Ok | MB_IconExclamation)
.head 7 -                                                                                       Return VALIDATE_Cancel
.head 3 +                                                                                       Data Field: dfDAT1s
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -                                                                                       Message Actions 
.head 3 +                                                                                       Data Field: dfDAT2s
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +                                                                                       Message Actions 
.head 5 +                                                                                       On SAM_Validate
.head 6 +                                                                                       If dfDAT2s < dfDAT1s
.head 7 -                                                                                       Return VALIDATE_Cancel
.head 3 +                                                                                       Data Field: dfSs
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +                                                                                       Message Actions 
.head 5 +                                                                                       On SAM_Validate
.head 6 +                                                                                       If dfSs<0
.head 7 -                                                                                       Call SalMessageBox( 'Сейф занят!', 'Внимание', MB_Ok | MB_IconExclamation)
.head 3 +                                                                                       Data Field: dfNDS
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +                                                                                       Message Actions 
.head 5 +                                                                                       On SAM_Validate
.head 6 +                                                                                       If dfSs<0
.head 7 -                                                                                       Call SalMessageBox( 'Сейф занят!', 'Внимание', MB_Ok | MB_IconExclamation)
.head 3 +                                                                                       Pushbutton: pbCalcSum
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 +                                                                                       Message Actions 
.head 5 +                                                                                       On SAM_Click
.head 6 -                                                                                       Set dfSs = NUMBER_Null
.head 6 +                                                                                       If SalIsNull(dfDAT1s) OR SalIsNull(dfDAT2s) OR SalIsNull(dfN_SKs)
.head 7 -                                                                                       Call SalMessageBox( 'Заполнены не все реквизиты!', 'Внимание', MB_Ok | MB_IconExclamation)
.head 6 +                                                                                       Else 
.head 7 +                                                                                       If SqlPrepareAndExecute( hSql(), 
"SELECT bars.f_skrnk(1,:SKP_Calc.dfN_SKs,:SKP_Calc.dfDAT1s,:SKP_Calc.dfDAT2s,0)/100
 INTO :SKP_Calc.dfSs FROM dual " ) 
.head 8 -                                                                                       Call SqlFetchNext( hSql(), nFetchRes )
.head 8 +                                                                                       If dfSs<0
.head 9 -                                                                                       Set dfSs = NUMBER_Null
.head 9 -                                                                                       Set dfNDS = NUMBER_Null
.head 9 -                                                                                       Call SalMessageBox( 'Сейф занят!', 'Внимание', MB_Ok | MB_IconExclamation)
.head 8 +                                                                                       Else 
.head 9 -                                                                                       Set dfNDS = dfSs/6
.head 3 -  ! !
.head 3 -                                                                                       Background Text: № сейфа:
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -                                                                                       Background Text: Дата начала аренды:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -                                                                                       Background Text: Срок аренды(дн.):
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -                                                                                       Background Text: Сумма:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 +                                                                                       Data Field: dfN_SKd
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +                                                                                       Message Actions 
.head 5 +                                                                                       On SAM_Validate
.head 6 -                                                                                       Call SqlPrepareAndExecute( hSql(), 
"SELECT n_sk INTO :SKP_Calc.dfN_SKd
 FROM spec_agio WHERE n_sk=:SKP_Calc.dfN_SKd " )
.head 6 +                                                                                       If not SqlFetchNext( hSql(), nFetchRes )
.head 7 -                                                                                       Call SalMessageBox( 'Сейф с таким номером не существует!', 'Внимание', MB_Ok | MB_IconExclamation)
.head 7 -                                                                                       Return VALIDATE_Cancel
.head 3 +                                                                                       Data Field: dfSd
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -                                                                                       Message Actions 
.head 3 +                                                                                       Data Field: dfDAT1d
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +                                                                                       Message Actions 
.head 5 +  ! On SAM_Validate
.head 6 +                                                                                       If dfDAT1d < dDATA
.head 7 -                                                                                       Return VALIDATE_Cancel
.head 3 +                                                                                       Data Field: dfDAT2d
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -                                                                                       Message Actions 
.head 3 +                                                                                       Data Field: dfDELTA
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -                                                                                       Message Actions 
.head 3 +                                                                                       Pushbutton: pbCalcDat
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 +                                                                                       Message Actions 
.head 5 +                                                                                       On SAM_Click
.head 6 -                                                                                       Set dfDAT2d = DATETIME_Null
.head 6 +                                                                                       If SalIsNull(dfDAT1s) OR SalIsNull(dfSd) OR SalIsNull(dfN_SKd)
.head 7 -                                                                                       Call SalMessageBox( 'Заполнены не все реквизиты!', 'Внимание', MB_Ok | MB_IconExclamation)
.head 6 +                                                                                       Else 
.head 7 -                                                                                       Set nS=SKP_Calc.dfSd*100
.head 7 +                                                                                       If SqlPrepareAndExecute( hSql(), 
"SELECT bars.f_skrnk(2,:SKP_Calc.dfN_SKd,:SKP_Calc.dfDAT1d,:SKP_Calc.dfDAT1d,:SKP_Calc.nS)
 INTO :SKP_Calc.dfDELTA FROM dual " ) 
.head 8 -                                                                                       Call SqlFetchNext( hSql(), nFetchRes )
.head 8 +                                                                                       If dfDELTA=-1
.head 9 -                                                                                       Set dfDELTA = NUMBER_Null
.head 9 -                                                                                       Call SalMessageBox( 'Сейф занят !', 'Внимание', MB_Ok | MB_IconExclamation)
.head 8 +                                                                                       Else If dfDELTA=-2 
.head 9 -                                                                                       Set dfDELTA = NUMBER_Null
.head 9 -                                                                                       Call SalMessageBox( 'Данной суммы недостаточно для аренды сейфа !', 'Внимание', MB_Ok | MB_IconExclamation)
.head 8 +                                                                                       Else 
.head 9 -                                                                                       Set dfDAT2d=dfDAT1d+dfDELTA-1
.head 7 +  ! If SqlPrepareAndExecute( hSql(), 
"SELECT bars.f_skrnk(1,:SKP_Calc.dfN_SKs,:SKP_Calc.dfDAT1s,:SKP_Calc.dfDAT2s,0)/100
 INTO :SKP_Calc.dfSs FROM dual " ) 
.head 8 -                                                                                       Call SqlFetchNext( hSql(), nFetchRes )
.head 8 +                                                                                       If dfSs<0
.head 9 -                                                                                       Set dfSs = NUMBER_Null
.head 9 -                                                                                       Call SalMessageBox( 'Сейф занят!', 'Внимание', MB_Ok | MB_IconExclamation)
.head 3 -                                                                                       Frame 
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -                                                                                       Frame 
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -                                                                                       Frame 
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -                                                                                       Frame 
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -                                                                                       Background Text: Дата окончания аренды:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -                                                                                       Background Text: В том числе НДС:
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -                                                                                       Functions 
.head 2 +                                                                                       Window Parameters 
.head 3 -                                                                                       Number: N_SK
.head 3 -                                                                                       Date/Time: MDAT
.head 2 +                                                                                       Window Variables 
.head 3 -                                                                                       Number: nFetchRes
.head 3 -                                                                                       Number: nS
.head 3 -                                                                                       Date/Time: dDATA
.head 2 +                                                                                       Message Actions 
.head 3 +                                                                                       On SAM_Create
.head 4 -                                                                                       Set dDATA=GetBankDate(  )
.head 4 -                                                                                       Set dfDAT1s=MDAT
.head 4 -                                                                                       Set dfDAT1d=MDAT
.head 4 -                                                                                       Set dfN_SKs=N_SK
.head 4 -                                                                                       Set dfN_SKd=N_SK
.head 4 -                                                                                       Call SalSetFocus( dfDAT2s )
.head 4 -                                                                                       Call SalSetFocus( dfSd )
.head 1 +  !
.head 2 -                                                                                       Description: Карточка сейфа
.head 2 -                                                                                       Named Menus 
.head 2 -                                                                                       Menu 
.head 2 +                                                                                       Tool Bar 
.head 3 +                                                                                       Contents 
.head 4 +                                                                                       Pushbutton: pbRefresh
.head 5 +                                                                                       Message Actions 
.head 6 +                                                                                       On SAM_Create
.head 7 -                                                                                       Set strTip = 'Перечитать'
.head 6 +                                                                                       On SAM_Click
.head 7 -                                                                                       Call SalPostMsg( hWndForm, UM_Populate, 0, 0 )
.head 4 +                                                                                       Pushbutton: pbSave
.head 5 +                                                                                       Message Actions 
.head 6 +                                                                                       On SAM_Create
.head 7 -                                                                                       Set strTip = 'Сохранить'
.head 6 +                                                                                       On SAM_Click
.head 7 -                                                                                       Call SalWaitCursor(TRUE)
.head 7 +                                                                                       If SqlPrepareAndExecute( hSql(),
"UPDATE  skrynka SET  
         fio=:frmSKR.dfFIO,       dokum=:frmSKR.dfPASSP, 
         issued=:frmSKR.dfVYDAN,  adres=:frmSKR.dfADRES,
         dat_begin=:frmSKR.dfDAT1,dat_end=:frmSKR.dfDAT2,
         tel=:frmSKR.dfTEL,       dover=:frmSKR.dfDOVER
 WHERE nls =(SELECT a.nls FROM accounts a, spec_agio sp
             WHERE sp.acc=a.acc AND a.kv=980 AND 
                   sp.n_sk=:frmSKR.N_SK )" ) 
.head 8 -                                                                                       Call SqlCommit( hSql() )
.head 7 +                                                                                       Else 
.head 8 -                                                                                       Call SqlRollback( hSql() )
.head 7 -                                                                                       Call SalWaitCursor(FALSE)
.head 7 -                                                                                       Call SalSetFocus( pbExit )
.head 7 -                                                                                       Call SalPostMsg( hWndForm, UM_Populate, 0, 0 )
.head 4 +                                                                                       Pushbutton: pbExit
.head 5 +                                                                                       Message Actions 
.head 6 +                                                                                       On SAM_Create
.head 7 -                                                                                       Set strTip = 'Завершить'
.head 6 +                                                                                       On SAM_Click
.head 7 -                                                                                       Call SalDestroyWindow(hWndForm)
.head 4 -                                                                                       Line 
.head 4 +                                                                                       Pushbutton: pbDelete
.head 5 +                                                                                       Message Actions 
.head 6 +                                                                                       On SAM_Create
.head 7 -                                                                                       Set strTip = 'Освободить сейф'
.head 6 +                                                                                       On SAM_Click
.head 7 -                                                                                       Call SalWaitCursor(TRUE)
.head 7 +                                                                                       If SqlPrepareAndExecute( hSql(),
"UPDATE  skrynka SET  
   fio=NULL,       dokum=NULL,   issued=NULL, adres=NULL,
   dat_begin=NULL, dat_end=NULL, tel=NULL,    dover=NULL
 WHERE nls =(SELECT a.nls FROM accounts a, spec_agio sp
             WHERE sp.acc=a.acc AND a.kv=980 AND 
                   sp.n_sk=:frmSKR.N_SK )" ) 
.head 8 -                                                                                       Call SqlCommit( hSql() )
.head 7 +                                                                                       Else 
.head 8 -                                                                                       Call SqlRollback( hSql() )
.head 7 -                                                                                       Call SalWaitCursor(FALSE)
.head 7 -                                                                                       Call SalSetFocus( pbExit )
.head 7 -                                                                                       Call SalPostMsg( hWndForm, UM_Populate, 0, 0 )
.head 2 +                                                                                       Contents 
.head 3 -                                                                                       Background Text: Сейф №:
.head 3 +                                                                                       Data Field: dfN_SK
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Background Text: № счета залога:
.head 3 +                                                                                       Data Field: dfNLS
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Background Text: Сумма залога:
.head 3 +                                                                                       Data Field: dfS
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Background Text: Дата последней проплаты:
.head 3 +                                                                                       Data Field: dfMDATE
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Background Text: ФИО:
.head 3 +                                                                                       Data Field: dfFIO
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Background Text: Паспорт:
.head 3 +                                                                                       Data Field: dfPASSP
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Background Text: Кем и когда выдан:
.head 3 +                                                                                       Data Field: dfVYDAN
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Background Text: Адрес:
.head 3 +                                                                                       Data Field: dfADRES
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Background Text: Доверенное лицо:
.head 3 +                                                                                       Data Field: dfDOVER
.head 4 -                                                                                       Message Actions 
.head 3 +                                                                                       Data Field: dfTEL
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Background Text: Обьем:
.head 3 +                                                                                       Data Field: dfO_SK
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Group Box: Клиент
.head 3 -                                                                                       Background Text: Период действия договора:
.head 3 +                                                                                       Data Field: dfDAT1
.head 4 -                                                                                       Message Actions 
.head 3 +                                                                                       Data Field: dfDAT2
.head 4 -                                                                                       Message Actions 
.head 3 -                                                                                       Background Text: Телефон:
.head 3 -                                                                                       Background Text: - 
.head 2 +                                                                                       Functions 
.head 3 +  ! Function: CheckData
.head 4 -                                                                                       Description: Проверка заполнения обязательных полей
.head 4 +                                                                                       Returns 
.head 5 -                                                                                       Boolean: 
.head 4 -                                                                                       Parameters 
.head 4 -                                                                                       Static Variables 
.head 4 +                                                                                       Local variables 
.head 5 -                                                                                       String: strErrorList
.head 5 -                                                                                       Number: nErrorCount
.head 4 +                                                                                       Actions 
.head 5 -                                                                                       Set strErrorList = ''
.head 5 -                                                                                       Set nErrorCount = 0
.head 5 -  !
.head 5 +                                                                                       If SalIsNull( dfFIO )
.head 6 -                                                                                       Set nErrorCount = nErrorCount + 1
.head 6 -                                                                                       Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
'Не заполнен реквизит <ФИО>' || PutCrLf()
.head 5 +                                                                                       If SalIsNull(dfPASSP )
.head 6 -                                                                                       Set nErrorCount = nErrorCount + 1
.head 6 -                                                                                       Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
'Не заполнен реквизит <Документ>' || PutCrLf()
.head 5 +                                                                                       If SalIsNull(dfVYDAN )
.head 6 -                                                                                       Set nErrorCount = nErrorCount + 1
.head 6 -                                                                                       Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
'Не заполнен реквизит <Кем и когда выдан>' || PutCrLf()
.head 5 +                                                                                       If nErrorCount > 0
.head 6 -                                                                                       Call SalMessageBox( strErrorList, 'Ошибка заполнения реквизитов', MB_Ok )
.head 6 -                                                                                       Return FALSE
.head 5 -                                                                                       Return TRUE
.head 2 +                                                                                       Window Parameters 
.head 3 -                                                                                       Number: N_SK
.head 3 -                                                                                       Window Handle: hWndParent
.head 2 +                                                                                       Window Variables 
.head 3 -                                                                                       Number: nTmp
.head 3 -  ! String: sTmp
.head 2 +                                                                                       Message Actions 
.head 3 +                                                                                       On SAM_Create
.head 4 -                                                                                       Call SalCenterWindow( hWndForm )
.head 4 -                                                                                       Call SalSetWindowText( hWndForm, 'Карточка сейфа № '|| SalNumberToStrX( frmSKR.N_SK, 0 ) )
.head 4 -                                                                                       Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 4 +                                                                                       If ( dfS=0     OR SalIsNull(dfS)     ) AND 
   ( dfMDATE=DATETIME_Null OR SalIsNull(dfMDATE) ) 
.head 5 -                                                                                       Call SalEnableWindow( pbDelete )
.head 4 +                                                                                       Else 
.head 5 -                                                                                       Call SalDisableWindow( pbDelete )
.head 3 +                                                                                       On UM_Populate
.head 4 -                                                                                       Call SalWaitCursor( TRUE )
.head 4 +                                                                                       If SqlPrepareAndExecute ( hSql(),
 "SELECT sp.n_sk, sp.o_sk, a.nls, a.ostc/100, a.mdate,
         p.fio, p.dokum, p.issued,p.adres, 
         p.dat_begin, p.dat_end, p.tel, p.dover 
 INTO :frmSKR.dfN_SK, :frmSKR.dfO_SK, :frmSKR.dfNLS, 
      :frmSKR.dfS, :frmSKR.dfMDATE, 
      :frmSKR.dfFIO, :frmSKR.dfPASSP, :frmSKR.dfVYDAN, 
      :frmSKR.dfADRES, :frmSKR.dfDAT1, :frmSKR.dfDAT2,
      :frmSKR.dfTEL, :frmSKR.dfDOVER
 FROM spec_agio sp, accounts a, skrynka p, agio_dep_sk s
 WHERE sp.acc=a.acc    AND  a.nls=p.nls          AND 
       s.o_sk=sp.o_sk  AND  sp.n_sk=:frmSKR.N_SK "  )
.head 5 -                                                                                       Call SqlFetchNext( hSql(), nTmp )
.head 4 -                                                                                       Call SalWaitCursor( FALSE )
.head 3 +                                                                                       On SAM_Destroy
.head 4 +                                                                                       If hWndParent
.head 5 -                                                                                       Call SalSendMsg( hWndParent, UM_Populate, 0, 0)
.head 1 +  ! cGenericTableDlg: dlg_DocumentList
.winattr class Dialog Box:
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Список документов по договору №
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.557"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.81"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -  Description: Список документов по депозитному договору
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.406"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbIns
.winattr
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.052"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDel
.winattr
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.514"
.head 6 -  Top:    0.052"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbRefresh
.winattr
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.943"
.head 6 -  Top:    0.052"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbUpdate
.winattr
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.052"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  1.9"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  1.9"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbSearch
.winattr
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.033"
.head 6 -  Top:    0.052"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbFilter
.winattr
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    0.052"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.9"
.head 6 -  Top:    0.052"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  3.883"
.head 6 -  Begin Y:  0.429"
.head 6 -  End X:  3.883"
.head 6 -  End Y:  0.012"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbOk
.winattr
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.333"
.head 6 -  Top:    0.052"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click
.head 7 +  If tbl.colSTATE=1
.head 8 -  Set sDoc=tbl.colTEXT
.head 8 +  Select Case cdoc_ShowDoc( sDoc, TRUE, TRUE )
.head 9 +  Case 1
.head 10 -  Set tbl.colTEXT=sDoc
.head 10 +  If SqlPrepare( hSql(), '
UPDATE CC_DOCS SET TEXT=:sDoc, VERSION=SYSDATE WHERE
  ROWID= :dlg_DocumentList.tbl.colROWID ' )
.head 11 +  If SqlSetLongBindDatatype( 1, 23 )
.head 12 +  If SqlExecute( hSql() )
.head 13 -  Call SaveInfoToLog( 'Текст договора № ' ||
                    SalNumberToStrX(dlg_DocumentList.tbl.colND,0) ||
                    '[' || SalNumberToStrX(dlg_DocumentList.tbl.colADDS,0) || ']' ||
                    ' перезаписан в БД!' )
.head 10 -  Break 
.head 9 +  Case 2
.head 10 -  Set tbl.colTEXT=sDoc
.head 10 +  If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
 VALUES (:dlg_DocumentList.tbl.colID,:dlg_DocumentList.tbl.colND,
:sDoc,0)'  )
.head 11 +  If SqlSetLongBindDatatype( 3, 23 )
.head 12 +  If SqlExecute( hSql() )
.head 13 -  Call SaveInfoToLog( 'Добавлен текст договора № ' ||
                    SalNumberToStrX(dlg_DocumentList.tbl.colND,0) ||
                    '[' || SalNumberToStrX(dlg_DocumentList.tbl.colADDS,0) || ']' )
.head 10 -  Break 
.head 7 +  Else 
.head 8 +  If SalMessageBox( 'Документ уже подписан!
Открыть документ для просмотра?', 'Подтверждение', MB_IconQuestion | MB_YesNo )=IDYES
.head 9 -  Set sDoc=tbl.colTEXT
.head 9 -  Call cdoc_ShowDoc( sDoc, FALSE, FALSE )
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Посмотреть/Редактировать выбранный документ'
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.033"
.head 6 -  Top:    0.048"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions 
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  4.583"
.head 6 -  Begin Y:  0.44"
.head 6 -  End X:  4.583"
.head 6 -  End Y:  0.024"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 -  Line 
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.217"
.head 6 -  Begin Y:  0.44"
.head 6 -  End X:  5.217"
.head 6 -  End Y:  0.024"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbSign
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbEdit
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.048"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Edit.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Подписать договор'
.head 6 +  On SAM_Click
.head 7 +  If tbl.colSTATE=1
.head 8 +  If SalMessageBox(
'Вы уверены, что хотите подписать документ?
После подписания документа его редактирование и удаление станет невозможным!', 'Подтверждение',
MB_IconQuestion | MB_YesNo | MB_DefButton2 ) = IDYES
.head 9 +  If SqlPrepareAndExecute( hSqlAux(), '
UPDATE CC_DOCS SET STATE=2, VERSION=SYSDATE WHERE
  ROWID= :dlg_DocumentList.tbl.colROWID ' )
.head 10 -  Call SqlCommitEx( hSqlAux(), 'Договор подписан ' ||
dlg_DocumentList.tbl.colID || ' ' ||
SalNumberToStrX( dlg_DocumentList.tbl.colND, 0 ) || ' ' ||
SalNumberToStrX( dlg_DocumentList.tbl.colADDS, 0 ) )
.head 7 +  Else 
.head 8 -  Call SalMessageBox( 'Документ уже подписан!', 'Ошибка', MB_IconStop | MB_Ok  )
.head 7 -  Call SalSendMsg( tbl, UM_Populate, 0, 0 )
.head 2 +  Contents 
.head 3 +  Child Table: tbl
.winattr
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.033"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  9.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.119"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colROWID
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colID
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код шаблона
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.733"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colNAME
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование шаблона
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colND
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colADDS
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № доп. согл.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.571"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colVERSION
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата сохранения
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd/MM/yyyy hh:mm AMPM
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colSTATE
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Подписан
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.143"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 2
.head 8 -  Uncheck Value: 1
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colTEXT
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 16777216
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 +  Window Variables 
.head 5 -  Number: nRow
.head 5 -  Number: nCurRow
.head 4 +  Message Actions 
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 5 +  On UM_Insert
.head 6 -  Call SalSendMsg( hMessageWnd, UM_CreateDoc, 0, 0 )
.head 6 -  Call SalSendClassMessage( UM_Populate, 0, 0 )
.head 5 +  On UM_Delete
.head 6 -  Set nCurRow=SalTblQueryContext( hWndForm )
.head 6 -  Set nRow = 0
.head 6 +  While SalTblSetContext( hWndForm, nRow )
.head 7 +  If colSTATE=1 AND SalTblQueryRowFlags(  hWndForm, nRow, ROW_Selected )
.head 8 -  Call SalTblSetRowFlags(  hWndForm, nRow, ROW_MarkDeleted,
not SalTblQueryRowFlags(  hWndForm, nRow, ROW_MarkDeleted ) )
.head 7 -  Call SalTblSetRowFlags(  hWndForm, nRow, ROW_Selected, FALSE )
.head 7 -  Set nRow=nRow+1
.head 6 -  Call SalTblSetContext( hWndForm, nCurRow )
.head 2 -  Functions 
.head 2 +  Window Parameters 
.head 3 -  ! Номер договора
.head 3 -  Number: nND
.head 3 -  ! Окно, обрабатывающее сообщение о добавлении  документа
.head 3 -  Window Handle: hMessageWnd
.head 2 +  Window Variables 
.head 3 -  Long String: sDoc
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText( hWndForm, 'Список документов по договору №'||
                      SalNumberToStrX( nND, 0 ) )
.head 4 -  Set strPrintFileName = 'Docs'
.head 4 -  Set strFilterTblName = 'CC_DOCS'
.head 4 -  Set strSqlPopulate ="
SELECT
  D.ROWID,
  D.ID,
  S.NAME,
  D.ND,
  D.ADDS,
  D.VERSION,
  D.STATE,
  D.TEXT
INTO
  :dlg_DocumentList.tbl.colROWID,
  :dlg_DocumentList.tbl.colID,
  :dlg_DocumentList.tbl.colNAME,
  :dlg_DocumentList.tbl.colND,
  :dlg_DocumentList.tbl.colADDS,
  :dlg_DocumentList.tbl.colVERSION,
  :dlg_DocumentList.tbl.colSTATE,
  :dlg_DocumentList.tbl.colTEXT
FROM CC_DOCS D, DOC_SCHEME S
WHERE D.ID=S.ID AND D.ND= :dlg_DocumentList.nND
ORDER BY D.VERSION, S.NAME "
.head 4 -  !
.head 4 -  Set strSqlDelete = "
DELETE FROM CC_DOCS
WHERE
  ROWID= :dlg_DocumentList.tbl.colROWID "
.head 4 -  !
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Dialog Box: dlg_CreateOverDoc
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Новый документ
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.429"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.452"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Номер дополнительного соглашения:
.head 4 -  Resource Id: 47599
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.286"
.head 5 -  Top:    0.177"
.head 5 -  Width:  3.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  List Box: lbAdd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenListBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.1"
.head 5 -  Top:    0.146"
.head 5 -  Width:  1.186"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.229"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Yes
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListPopulate( lbAdd, hSql(), "
SELECT
adds
FROM
cc_add
WHERE
nd = :nND ")
.head 3 +  Child Table: tblTemplates
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.186"
.head 6 -  Top:    0.74"
.head 6 -  Width:  8.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Идентификатор
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.771"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.614"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblPopulate( dlg_CreateOverDoc.tblTemplates, hSql(),
"SELECT
r.id,
s.name
INTO
:dlg_CreateOverDoc.tblTemplates.colId,
:dlg_CreateOverDoc.tblTemplates.colName
FROM
acc_over d,
doc_root r,
doc_scheme s
WHERE
d.vidd = r.vidd
AND
s.id = r.id
AND
d.nd = :nND "
,TBL_FillAll )
.head 6 +  If SalTblAnyRows( tblTemplates, 0, 0 ) != TRUE
.head 7 -  Call SalMessageBox( 'Для договора не указаны шаблоны!', 'Ошибка', MB_IconStop | MB_Ok  )
.head 7 -  Call SalEndDialog( dlg_CreateOverDoc, 0 )
.head 6 +  Else
.head 7 -  Call SalTblSetContext( tblTemplates, TBL_MinRow )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Создать
.head 4 -  Window Location and Size
.head 5 -  Left:   5.017"
.head 5 -  Top:    3.571"
.head 5 -  Width:  1.543"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Call SalMessageBox( 'Дополнительное соглашение:'||SalListQueryTextX( lbAdd, 0 )||' Код шаблона:'||dlg_CreateDoc.tblTemplates.colId, 'Результат', MB_IconStop | MB_Ok  )
.head 6 -  ! Call cdoc_CreateDocFromTemplate(hSql(),hSqlAux(),tblTemplates.colId,nND,)
.head 6 -  Call XConnectGetParams( cCnc )
.head 6 +  If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
.head 7 -  Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), tblTemplates.colId,  nND,lbAdd.GetCurrentKey())
.head 7 +  If sDoc
.head 8 -  ! Показываем документ с редактированием
.head 8 +  If cdoc_ShowDoc( sDoc, TRUE, FALSE )!=3
.head 9 -  ! Сохраняем документ в БД
.head 9 +  If NOT cdoc_SetDocText(hSql(), TRUE,
  tblTemplates.colId, nND, 0, DATETIME_Null, sDoc)
.head 10 -  Call SqlRollback(hSql())
.head 9 +  Else
.head 10 -  Call SqlCommitEx(hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:' || SalNumberToStrX(lbAdd.GetCurrentKey(),0) || ' сохранен в БД!')
.head 9 +  ! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
 VALUES (:tblTemplates.colId,:nND,:sDoc,0)' )
.head 10 +  If SqlSetLongBindDatatype( 3, 23 )
.head 11 +  If SqlExecute( hSql() )
.head 12 -  Call SqlCommitEx( hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:'||SalNumberToStrX( lbAdd.GetCurrentKey(),0)|| ' сохранен в БД!' )
.head 12 -  ! Return 1
.head 7 -  Call cCnc.Disconnect()
.head 7 -  Call cCnc2.Disconnect()
.head 6 -  Call SalEndDialog( dlg_CreateOverDoc, 0 )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   6.7"
.head 5 -  Top:    3.573"
.head 5 -  Width:  1.55"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \bars98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlg_CreateOverDoc, 0 )
.head 3 -  Group Box: Выбор шаблона
.head 4 -  Resource Id: 47600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    0.49"
.head 5 -  Width:  8.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nND
.head 2 +  Window Variables
.head 3 -  : cCnc
.head 4 -  Class: cABSConnect
.head 3 -  : cCnc2
.head 4 -  Class: cABSConnect
.head 3 -  Long String: sDoc
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText( hWndForm, 'Новый документ к договору №'||
                      SalNumberToStrX( nND, 0 ) )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 1 +  Form Window: TOArc
.data CLASSPROPSSIZE
0000: 3A00
.enddata
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 000000000000C0C0 C000FFFFFF008080
0020: 8000020000000000 0000010000000100 0000000000000001 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -  Class: cSplitterWindow
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Архив овердрафтов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.229"
.head 4 -  Width:  15.083"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.738"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.464"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.953"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call PopulateTop()
.head 7 -  Call PopulateBottom(SalStrToNumber(sRnk))
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Обновить'
.head 4 +  Pushbutton: pbDetail
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg ( tblBottom, SAM_DoubleClick, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотр истории'
.head 4 +  Data Field: dfNmk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.383"
.head 7 -  Top:    0.111"
.head 7 -  Width:  6.1"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.52"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call TblFindString(tblTop,  DFIND_First)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Поиск'
.head 4 +  Pushbutton: pbDocs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Docview.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Документы договора'
.head 6 +  On SAM_Click
.head 7 -  Call cdoc_ShowAllDocsReadOnly( TOArc.tblBottom.colND, hWndForm )
.head 4 -  Line
.head 5 -  Resource Id: 6650
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.383"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  2.383"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow (  hWndForm )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Завершить работу и выйти'
.head 4 -  Line
.head 5 -  Resource Id: 6651
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.183"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  3.183"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.813"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Установить фильтр...'
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter( cF )
.head 8 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 8 +  If cF.GetFilterWhereClause(TRUE) != STRING_Null
.head 9 -  Set sFilter=" AND "||cF.GetFilterWhereClause(TRUE)
.head 8 +  Else
.head 9 -  Set sFilter=""
.head 8 -  Call PopulateTop()
.head 8 -  Call SalPostMsg(tblTop, SAM_RowSetContext,0,0)
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cSplitterWindow
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    2.5"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tblTop
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  11.983"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 20000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colRnk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: рег № .кл.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 -  On SAM_ColumnSelectClick
.head 5 +  Column: colNmk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  12.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Boolean: bSortOrd
.head 4 +  Message Actions
.head 5 +  On SAM_RowSetContext
.head 6 -  Call SalTblGetColumnText ( tblTop,1, sRnk )
.head 6 -  Call PopulateBottom(SalStrToNumber(sRnk))
.head 6 -  Call SalTblGetColumnText ( tblTop,2, sNmk ) 
.head 6 -  Call SalSetWindowText (dfNmk, sNmk )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd = not bSortOrd
.head 6 -  Call SalTblSortRows(tblTop, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 5 +  On SAM_Create
.head 6 -  Set bSortOrd=TRUE
.head 6 -  Call SalTblGetColumnText ( tblTop,1, sRnk )
.head 6 -  Call PopulateBottom(SalStrToNumber(sRnk))
.head 6 -  Call SalTblGetColumnText ( tblTop,2, sNmk ) 
.head 6 -  Call SalSetWindowText (dfNmk, sNmk )
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalTblGetColumnText ( tblTop,1, sRnk )
.head 6 -  Call PopulateBottom(SalStrToNumber(sRnk))
.head 6 -  Call SalTblGetColumnText ( tblTop,2, sNmk ) 
.head 6 -  Call SalSetWindowText (dfNmk, sNmk )
.head 3 +  Child Table: tblBottom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    2.571"
.head 6 -  Width:  11.983"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colPlace
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.
договора
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNDOC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № дог
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLS_2600
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
2600
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLS_2067
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
просрочки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLS_2096
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет сомнительной
 задолженности
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.283"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDATD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Начало 
договора
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDATD2
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Конец
договора
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
договора
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPR2600
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: % 2600
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPRKom
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: % комис.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPR9129
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: % 9129
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDeldate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Удален
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_RowSetContext
.head 6 -  Call SalTblGetColumnText ( tblTop,1, sNd )
.head 6 -  Call SalTblGetColumnText ( tblTop,2, sNdoc ) 
.head 5 -  On SAM_ColumnSelectClick
.head 5 +  On SAM_DoubleClick
.head 6 +  If SalGetWindowState (hWinTOHistory ) = Window_Invalid
.head 7 -  Set hWinTOHistory =SalCreateWindow( TOHistory,hWndMDI,
                                               TOArc.tblBottom.colND,
                                               TOArc.tblBottom.colDATD,
                                               TOArc.tblBottom.colDATD2)
.head 6 +  Else
.head 7 -  Call SalDestroyWindow ( hWinTOHistory )
.head 7 -  Set hWinTOHistory =SalCreateWindow( TOHistory,hWndMDI,
                                               TOArc.tblBottom.colND,
                                               TOArc.tblBottom.colDATD,
                                               TOArc.tblBottom.colDATD2)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If tblBottom.colPlace = "1"
.head 7 -  Call XSalTblSetRowBackColor( hWndForm, lParam,  COLOR_LightGreen	 )
.head 2 +  Functions
.head 3 +  Function: PopulateTop
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalTblPopulate ( tblTop, hSql(), 
" SELECT DISTINCT c.rnk, c.nmk 
   INTO  :TOArc.tblTop.colRnk,  :TOArc.tblTop.colNmk 
   FROM customer c,  accounts a 
   WHERE c.rnk=a.rnk  AND a.acc IN 
   (SELECT acco  FROM acc_over ao 
     WHERE nd IS NOT NULL "||sFilter||IifS(TO.StrFilter!=""," and acc in ","")||TO.StrFilter||")
   UNION
   SELECT DISTINCT c.rnk, c.nmk
   FROM customer c,  accounts a
   WHERE  c.rnk=a.rnk  AND a.acc IN 
   (SELECT acco  FROM acc_over_archive ao 
     WHERE nd IS NOT NULL "||sFilter||IifS(TO.StrFilter!=""," and acc in ","")||TO.StrFilter||") " ,TBL_FillAll )
.head 3 +  Function: PopulateBottom
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nRnk
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call SalTblPopulate ( tblBottom, hSql(), 
"SELECT DISTINCT '1' place,
                 ao.ndoc,
                 a.nls,
                 a2.nls,
                 a3.nls,
                 a.kv,  
                 ao.datd, 
                 ao.datd2, 
                 ao.sd/100,
                 ao.pr_2600a,
                 ao.pr_komis,
                 ao.pr_9129,
                 ao.nd,
                 to_date(null)  
  INTO   :TOArc.tblBottom.colPlace, 
         :TOArc.tblBottom.colNDOC,
         :TOArc.tblBottom.colNLS_2600, 
         :TOArc.tblBottom.colNLS_2067,
         :TOArc.tblBottom.colNLS_2096,   
         :TOArc.tblBottom.colKv,
         :TOArc.tblBottom.colDATD, 
         :TOArc.tblBottom.colDATD2, 
         :TOArc.tblBottom.colSD,
         :TOArc.tblBottom.colPR2600, 
         :TOArc.tblBottom.colPRKom,
         :TOArc.tblBottom.colPR9129,
         :TOArc.tblBottom.colND,
         :TOArc.tblBottom.colDeldate 
  FROM accounts a, 
       acc_over ao,      
       customer c,
       accounts a2,
       accounts a3 
  WHERE a.rnk=c.rnk 
    AND c.rnk= :nRnk
    AND ao.acco=a.acc
    and decode(nvl(ao.acc_2096,0),0,-1,ao.acc_2096)=a3.acc(+)
    AND decode(nvl(ao.acc_2067,-1),0,-1,nvl(ao.acc_2067,-1))=a2.acc(+)
    AND  a.acc IN 
  (SELECT aa.acc FROM acc_over aa WHERE nvl(aa.sos,0) = 0 ) 
  UNION ALL
  SELECT DISTINCT '2' place,
                 ao.ndoc,
                 a.nls,
                 a2.nls,
                 a3.nls,
                 a.kv,  
                 ao.datd, 
                 ao.datd2, 
                 ao.sd/100,
                 ao.pr_2600a,
                 ao.pr_komis,
                 ao.pr_9129,
                 ao.nd,
                 ao.deldate
  FROM accounts a, 
       acc_over_archive ao,
       customer c,
       accounts a2, 
       accounts a3
  WHERE a.rnk=c.rnk 
    AND c.rnk= :nRnk
    AND ao.acco=a.acc
    and decode(nvl(ao.acc_2096,0),0,-1,ao.acc_2096)=a3.acc(+)
    AND decode(nvl(ao.acc_2067,-1),0,-1,nvl(ao.acc_2067,-1))=a2.acc(+)  "
,TBL_FillAll )
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nAcc
.head 2 +  Window Variables
.head 3 -  String: sTemp
.head 3 -  String: sNmk
.head 3 -  String: sNdoc
.head 3 -  String: sNd
.head 3 -  String: sRnk
.head 3 -  Window Handle: hTab1
.head 3 -  Window Handle: hTab2
.head 3 -  String: sFilter
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  : cQ
.head 4 -  Class: cGenQuery
.head 3 -  String: strFilterTblName
.head 3 -  Boolean: fFilterAtStart
.head 3 -  String: strDSql
.head 3 -  Number: nRnk
.head 3 -  Number: nRow
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalTblSetTableFlags(tblTop,TBL_Flag_SelectableCols,TRUE)
.head 4 -  Set strFilterTblName="ACC_OVER_ARC"
.head 4 +  If strFilterTblName != ''
.head 5 -  Call cF.Init(strFilterTblName, "ao")
.head 4 -  Call PopulateTop()
.head 4 +  If SqlPrepareAndExecute( hSql(), "SELECT rnk INTO :nRnk FROM accounts WHERE acc=:nAcc ")
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set nRow= VisTblFindNumber(tblTop,0 ,tblTop.colRnk,nRnk)
.head 5 -  Call SalTblSetFocusRow( tblTop, nRow )
.head 5 -  Call SalTblSetContext(tblTop, nRow )
.head 3 +  On UM_CreateDoc
.head 4 -  ! Call SalModalDialog(dlg_CreateOverDoc,hWndMDI,TOArc.tblBottom.colNd)
.head 3 +  On UM_Populate
.head 4 +  If fFilterAtStart
.head 5 -  Set fFilterAtStart = NOT fFilterAtStart
.head 5 +  If NOT SetQueryFilter( cF )
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 5 -  Set strDSql = cQ.GetFullSQLString(cF)
.head 1 +  Table Window: TOHistory
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: История задолженности овердрафта
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.767"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 20000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Добавить плановую дату погашения'
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  ! On SAM_Click
.head 7 -                                                                        Set nRowNum=TBL_MinRow
.head 7 +                                                                        While SalTblFindNextRow(hWndForm, nRowNum, ROW_Selected, 0)
.head 8 -                                                                        Call SalTblSetContext ( hWndForm, nRowNum ) 
.head 8 +                                                                        If NOT SalTblQueryRowFlags(hWndForm, nRowNum, ROW_New)
.head 9 +                                                                        If colEvent = 3
.head 10 -                                                                        Call SalTblSetRowFlags(hWndForm, nRowNum, ROW_MarkDeleted,
     not SalTblQueryRowFlags(hWndForm, nRow,
     ROW_MarkDeleted))
.head 8 +  ! Else 
.head 9 -                                                                        Call SalTblDeleteRow(hWndForm, nRowNum, TBL_NoAdjust)
.head 7 -                                                                        Return FALSE
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Удалить плановую дату погашения'
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! Call GetProtocol()
.head 7 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Обновить'
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm,UM_Update, 0, 0 )
.head 7 -  Call GetProtocol()
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сохранить изменения'
.head 4 -  Line
.head 5 -  Resource Id: 49802
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Поиск'
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Печать'
.head 4 -  Line
.head 5 -  Resource Id: 49803
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow (  hWndForm )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Завершить работу и выйти'
.head 4 -  Line
.head 5 -  Resource Id: 49804
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfComment
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.683"
.head 7 -  Top:    0.09"
.head 7 -  Width:  3.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: colBdate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Банковская 
дата
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.367"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: StaffID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
исполнителя
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTxt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Событие
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 300
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  10.583"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSeq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: GetProtocol
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  ! If SqlPLSQLCommand(hSql(), "BARS.P_FOVHIST(nNd,Dat1,Dat2 )" )
.head 6 -                                                                        Call SqlCommitEx( hSql(),'Авто-пог.тек.% по оверд.')
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nNd
.head 3 -  Date/Time: Dat1
.head 3 -  Date/Time: Dat2
.head 2 +  Window Variables
.head 3 -  Number: nRowNum
.head 3 -  Number: nRow
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set strPrintFileName = 'overarc'
.head 4 -  ! Set strFilterTblName = 'CC_DOCS'
.head 4 -  ! Call SalDisableWindow (TOHistory.pbIns )
.head 4 -  ! Call SalDisableWindow (TOHistory.pbDel )
.head 4 -  ! Call SalDisableWindow (TOHistory.pbUpdate )
.head 4 -  Call SalDisableWindow (TOHistory.pbDetails )
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Set dfComment='Реф. договора '||SalNumberToStrX(nNd,0)
.head 4 -  Set TOHistory.strSqlPopulate=
" select s.id,s.fdat,substr(s.txt,1,150),s.isp
  into :TOHistory.colSeq,:TOHistory.colBdate,:TOHistory.colTxt,:TOHistory.StaffID 
  from cc_sob s
  where s.nd = :TOHistory.nNd
  union all
  select 1,bdat,'Процентная ставка ('||a.nls||')= '||to_char(i.ir),to_number(NULL)
  from accounts a, int_ratn i
  where i.id=0
    and i.acc=a.acc
    and i.bdat >= :TOHistory.Dat1
    and i.bdat <= :TOHistory.Dat2
    and a.acc = ( select distinct acc 
                  from acc_over 
                  where nd=:TOHistory.nNd
                    and nvl(sos,0)<> 1 )
  union all
  select 1,bdat,'Процентная ставка ('||a.nls||')= '||to_char(i.ir),to_number(NULL)
  from accounts a, int_ratn i
  where i.id=0
    and i.acc=a.acc
    and i.bdat >= :TOHistory.Dat1
    and i.bdat <= :TOHistory.Dat2
    and a.acc = ( select distinct acc_9129 
                  from acc_over 
                  where nd=:TOHistory.nNd
                    and nvl(sos,0)<> 1 )  
union all
  select 1,bdat,'Процентная ставка ('||a.nls||')= '||to_char(i.ir),to_number(NULL)
  from accounts a, int_ratn i
  where i.id=0
    and i.acc=a.acc
    and i.bdat >= :TOHistory.Dat1
    and i.bdat <= :TOHistory.Dat2
    and a.acc = ( select distinct acc_8000 
                  from acc_over 
                  where nd=:TOHistory.nNd
                    and nvl(sos,0)<> 1 )
union all
  select 1,bdat,'Процентная ставка ('||a.nls||')= '||to_char(i.ir),to_number(NULL)
  from accounts a, int_ratn i
  where i.id=0
    and i.acc=a.acc
    and i.bdat >= :TOHistory.Dat1
    and i.bdat <= :TOHistory.Dat2
    and a.acc = ( select distinct acco 
                  from acc_over 
                  where nd=:TOHistory.nNd
                    and nvl(sos,0)= 1 )  
  order by 2,1 "
.head 4 -  ! Set TOHistory.strSqlDelete="DELETE FROM acc_over_mdate WHERE  nd=:TOHistory.nNd AND mdate = :TOHistory.colDat "
.head 4 -  ! Set TOHistory.strSqlInsert="INSERT INTO acc_over_mdate (nd,mdate,bdate) 
VALUES( :TOHistory.nNd, :TOHistory.colDat, bankdate ) "
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  ! On SAM_FetchRowDone
.head 4 +                                                                        If TOHistory.colTextcl !=NUMBER_Null
.head 5 -                                                                        Call SalTblSetCellTextColor (TOHistory.colS , TOHistory.colTextcl, TRUE )
.head 5 -                                                                        Call SalTblSetCellTextColor (TOHistory.colComm ,TOHistory.colTextcl, TRUE )
.head 5 -                                                                        Call SalTblSetCellTextColor (TOHistory.colDat ,TOHistory.colTextcl, TRUE )
.head 5 -                                                                        Call SalTblSetCellTextColor (TOHistory.colRef ,TOHistory.colTextcl, TRUE )
.head 4 +                                                                        If TOHistory.colBackcl !=NUMBER_Null
.head 5 -                                                                        Call XSalTblSetRowBackColor( hWndForm, lParam,  TOHistory.colBackcl )
.head 3 +  On UM_Update
.head 4 -  Call SalSendClassMessage( UM_Update, 0, 0 )
.head 4 -  ! Call GetProtocol()
.head 1 +  Dialog Box: dlg_Calclim
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Расчет лимита овердрафта
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.202"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Расчет лимита овердрафта версия "Петрокомерц"
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Etched
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 1.845"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbFind
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call TblFindString(tblS,  DFIND_First)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Поиск'
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Установить фильтр...'
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter( cF )
.head 8 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 8 +  If cF.GetFilterWhereClause(TRUE) != STRING_Null
.head 9 -  Set sFilter=" AND "||cF.GetFilterWhereClause(TRUE)
.head 8 +  Else
.head 9 -  Set sFilter=""
.head 8 -  Call Populate()
.head 8 -  Call SalPostMsg(tblS, SAM_RowSetContext,0,0)
.head 4 +  Pushbutton: pbRefr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call CalcDay()
.head 7 -  Call Populate()
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перечитать'
.head 4 +  Pushbutton: pbEx
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  ! If SqlPrepareAndExecute ( hSql(), " select ROUND(MONTHS_BETWEEN(:dfD2,:dfD1)) into :nMCount  from dual  " )
.head 8 -                                                                        Call SqlFetchNext(hSql(),nT1)
.head 7 +  ! If nMCount  !=  3
.head 8 -                                                                        Call SalMessageBox ("Диапазон дат должен быть равен 3 месяцам.", "Внимание !!!", MB_Ok+MB_IconExclamation )
.head 8 -                                                                        Return FALSE
.head 7 -  Call CalcDay()
.head 7 -  Call CalcSum()
.head 7 +  If dfDC2 = 0 or dfDC3 = 0 or dfK2 = 0 or dfK3 = 0 
.head 8 -  Set dfDK2=NUMBER_Null
.head 8 -  Set dfDK3=NUMBER_Null
.head 8 -  Set dfLim=NUMBER_Null
.head 8 -  Call SalMessageBox ("Недостаточно данных для расчета.", "Внимание !!!", MB_Ok+MB_IconExclamation )
.head 8 -  Return FALSE
.head 7 +  If dfProc = NUMBER_Null
.head 8 -  Call SalMessageBox ("Необходимо ввести процентное число.", "Внимание !!!", MB_Ok+MB_IconExclamation )
.head 8 -  Return FALSE
.head 7 -  Set dfDK2 = dfK2/dfDC2
.head 7 -  Set dfDK3 = dfK3/dfDC3
.head 7 -  Set nK=dfDK3/dfDK2
.head 7 -  Set dfMK = dfKAll/3
.head 7 +  If nK > 1
.head 8 -  Call SalMessageBox ("Коэффициент > 1.", "Внимание !!!", MB_Ok+MB_IconExclamation )
.head 8 -  ! Return FALSE
.head 8 -  Set nK=1
.head 7 -  Set dfLim = (dfProc/100)*dfMK*nK
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Расчитать лимит'
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow (  hWndForm )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Завершить работу и выйти'
.head 4 +  Data Field: dfD1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    0.655"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfD2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    1.405"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Sky
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: с
.head 5 -  Resource Id: 2004
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.679"
.head 6 -  Width:  0.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: по
.head 5 -  Resource Id: 2005
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.429"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 9025
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  -0.017"
.head 6 -  Begin Y:  0.405"
.head 6 -  End X:  13.083"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 9026
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.683"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  2.683"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Background Text: 2
.head 5 -  Resource Id: 9027
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.929"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: 3
.head 5 -  Resource Id: 9028
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    1.179"
.head 6 -  Width:  0.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: 1
.head 5 -  Resource Id: 9029
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.679"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Раб. дней
.head 5 -  Resource Id: 9030
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.883"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Поступило
.head 5 -  Resource Id: 9031
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.083"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Всего
.head 5 -  Resource Id: 9023
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    1.429"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Ср.дн.оборот
.head 5 -  Resource Id: 9024
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.383"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgDK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfDC1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    0.655"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDC2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    0.905"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDC3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    1.155"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDCAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    1.405"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfK1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    0.655"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfK2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    0.905"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfK3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    1.155"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfKAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    1.405"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDK2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.283"
.head 7 -  Top:    0.905"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDK3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.283"
.head 7 -  Top:    1.155"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Ср.мес.оборот
.head 5 -  Resource Id: 9032
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.783"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgMK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfMK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.783"
.head 7 -  Top:    1.405"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Расч. лим.
.head 5 -  Resource Id: 9033
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.383"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgLim
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfLim
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.383"
.head 7 -  Top:    1.405"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Aqua
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfName
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.383"
.head 7 -  Top:    0.071"
.head 7 -  Width:  9.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17174
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.583"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  1.583"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Data Field: dfProc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.283"
.head 7 -  Top:    1.405"
.head 7 -  Width:  0.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: %
.head 5 -  Resource Id: 17492
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.083"
.head 6 -  Top:    1.429"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgProc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 -  Background Text: Месяц
.head 5 -  Resource Id: 17493
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    0.512"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Pushbutton: pbPr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Печать содержания таблицы'
.head 6 +  On SAM_Click
.head 7 -  Set nRowNum=TBL_MinRow
.head 7 -  If SqlPrepareAndExecute( hSql(),
" SELECT id INTO :nUid FROM staff WHERE  upper(logname)=upper(USER) ")
and SqlFetchNext( hSql(), nFetchRes )
.head 7 -  If SqlPrepareAndExecute( hSql(),
" delete from acc_over_rep1 
  where userid = :nUid ")
.head 7 +  While SalTblFindNextRow(tblS, nRowNum, 0, 0)
.head 8 -  Call SalTblSetContext ( tblS, nRowNum ) 
.head 8 +  If NOT tblS.colUse
.head 9 -  !
.head 9 -  Call SqlPrepareAndExecute( hSql(),
    "INSERT INTO acc_over_rep1(userid ,dat1,dat2,dat3,dat4,
       days1,days2,days3,days4,post1,
       post2,post3,post4,sob2, sob3,
       sobm, pr,   lim,  used, refd,
       nls1, nls2, kv,   tt,   sn,
       sq,nazn,   k, datd, acc )
     VALUES (:nUid,:dfD1,:dDD2,:dDD3,:dfD2,
        :dfDC1,:dfDC2,:dfDC3,:dfDCAll,:dfK1,
        :dfK2,:dfK3,:dfKAll,:dfDK2,:dfDK3,
        :dfMK,:dfProc,:dfLim,:tblS.colUse,:tblS.colRef,
        :tblS.colNlsa,:tblS.colNlsb,:tblS.colKva,:tblS.colTt,:tblS.colS,
        :tblS.colSQ,:tblS.colNazn,:nK,:tblS.colDatv,:nR1  )" )
.head 7 -  Call SqlCommitEx( hSql(),'Розрах.лим.овр.')
.head 7 -  Set sFname='lim_'||SalNumberToStrX(nR1,0)||'.txt'
.head 7 -  Call ExportCatQuery(10001,sFname,3,'',FALSE)
.head 7 -  ! Call Debug(GetPrnDir() || '\\')
.head 7 -  Call SalLoadApp( 'dview.exe', GetPrnDir() || '\\'||sFname )
.head 4 +  Data Field: dDD2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    0.905"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dDD3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    1.155"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tblS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  12.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colUse
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Откл.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRef
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.
док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.733"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsa
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: НЛС Д
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKva
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: КВ 
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: НЛС К
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Операция
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дат.вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пост.
ном.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSQ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пост.
экв.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSuit
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Подходит
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNazn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение
платежа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNam_a
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
отправителя
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Boolean: bSortOrd
.head 4 +  Message Actions
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd = not bSortOrd
.head 6 -  Call SalTblSortRows(tblS, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 2 +  Functions
.head 3 +  Function: Populate
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sSele = 
" select ref,v.nlsd, v.kv, v.nlsk,   v.tt, v.fdat, v.s,v.sq, v.nazn, nam_a
   into :tblS.colRef,:tblS.colNlsa,:tblS.colKva,:tblS.colNlsb,:tblS.colTt, 
        :tblS.colDatv,:tblS.colS,:tblS.colSQ, :tblS.colNazn, :tblS.colNam_a  
   from v_calcoverlim v
   where v.acck = :nR1
     and  v.fdat >= :dfD1 and v.fdat < :dfD2 "||sFilter
.head 5 -  Call SalTblPopulate(tblS,hSql(),sSele||sFilter,TBL_FillAll)
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: CalcDay
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nT1
.head 4 +  Actions
.head 5 -  Set nDay= SalDateDay(dfD2)
.head 5 +  If dDD2=DATETIME_Null
.head 6 -  Set dDD2=SalDateConstruct ( 
SalDateYear(dfD2), 
SalDateMonth(dfD2)-2, 
SalDateDay(dfD2), 
0, 
0, 
0  )
.head 5 +  If dDD3=DATETIME_Null
.head 6 -  Set dDD3=SalDateConstruct ( 
SalDateYear(dfD2), 
SalDateMonth(dfD2)-1, 
SalDateDay(dfD2), 
0, 
0, 
0  )
.head 5 +  If dfD1=DATETIME_Null
.head 6 -  Set dfD1=SalDateConstruct ( 
SalDateYear(dfD2), 
SalDateMonth(dfD2)-3, 
SalDateDay(dfD2), 
0, 
0, 
0  )
.head 5 +  If SqlPrepareAndExecute ( hSql(), " select count(*) into :dlg_Calclim.dfDC1  from fdat
  where fdat >= :dlg_Calclim.dfD1
       and fdat <= :dDD2 " )
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 5 +  If SqlPrepareAndExecute ( hSql(), " select count(*) into :dlg_Calclim.dfDC2  from fdat
  where fdat > :dDD2
       and fdat <=  :dDD3  " )
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 5 +  If SqlPrepareAndExecute ( hSql(), " select count(*) into :dlg_Calclim.dfDC3  from fdat
  where fdat > :dDD3
       and fdat <=:dlg_Calclim.dfD2 " )
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 5 -  Set dfDCAll=dfDC1+dfDC2+dfDC3
.head 3 +  Function: CalcSum
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRN
.head 5 -  Number: nT1
.head 4 +  Actions
.head 5 -  Set nRN = TBL_MinRow
.head 5 -  Set dfK1=0
.head 5 -  Set dfK2=0
.head 5 -  Set dfK3=0
.head 5 -  Set dfKAll=0
.head 5 +  If SqlPrepareAndExecute ( hSql(), " select last_day(:dlg_Calclim.dfD1),last_day(last_day(:dlg_Calclim.dfD1)+1) into :dD1,:dD2 from dual " )
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 5 +  While SalTblFindNextRow(tblS, nRN, 0, 0)
.head 6 -  Call SalTblSetContext ( tblS, nRN ) 
.head 6 +  If not tblS.colUse
.head 7 +  If (tblS.colDatv >=dfD1) and  (tblS.colDatv <= dDD2)
.head 8 -  Set dfK1 = dfK1+tblS.colS
.head 7 +  Else If (tblS.colDatv >dDD2) and (tblS.colDatv <= dDD3)
.head 8 -  Set dfK2 = dfK2+ tblS.colS
.head 7 +  Else If (tblS.colDatv >dDD3) and  (tblS.colDatv <= dfD2)
.head 8 -  Set dfK3 = dfK3+ tblS.colS
.head 5 -  Set dfKAll=dfK1+dfK2+dfK3
.head 2 +  Window Parameters
.head 3 -  Number: nR1
.head 2 +  Window Variables
.head 3 -  String: BANKTYPE
.head 3 -  String: sSele
.head 3 -  Date/Time: dD1
.head 3 -  Date/Time: dD2
.head 3 -  Number: nT1
.head 3 -  String: sFilter
.head 3 -  Boolean: fFilterAtStart
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  : cQ
.head 4 -  Class: cGenQuery
.head 3 -  String: strFilterTblName
.head 3 -  String: strDSql
.head 3 -  Number: nMCount
.head 3 -  Number: nK
.head 3 -  String: strPrintFileName
.head 3 -  ! Date/Time: dDD2
.head 3 -  ! Date/Time: dDD3
.head 3 -  Number: nRowNum
.head 3 -  Number: nDay
.head 3 -  Number: nUid
.head 3 -  String: sFname
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set BANKTYPE = GetGlobalOption('BANKTYPE')
.head 4 +  If BANKTYPE = 'SBER'
.head 5 -  Call SalHideWindowAndLabel(bgDK)
.head 5 -  Call SalHideWindow(dfDK2)
.head 5 -  Call SalHideWindow(dfDK3)
.head 5 -  Call SalHideWindowAndLabel(bgMK)
.head 5 -  Call SalHideWindow(dfMK)
.head 5 -  Call SalHideWindow(dfProc)
.head 5 -  Call SalHideWindowAndLabel(bgProc)
.head 5 -  Call SalHideWindowAndLabel(bgLim)
.head 5 -  Call SalHideWindow(dfLim)
.head 4 -  Call SalTblSetTableFlags(tblS, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Set strFilterTblName = "V_CALCOVERLIM"
.head 4 -  Set strPrintFileName = "calclim"
.head 4 -  Set dfProc=10
.head 4 +  If strFilterTblName != ''
.head 5 -  Call cF.Init(strFilterTblName, "v")
.head 4 +  If SqlPrepareAndExecute ( hSql(), 
" select a.nls||' ('||to_char(a.kv)||')'||a.nms 
  into :dfName  
  from accounts a, customer c 
  where a.rnk=c.rnk 
    and a.acc=:nR1  " )
.head 5 -  Call SqlFetchNext(hSql(),nT1)
.head 4 -  Call Populate()
.head 3 +  On UM_Populate
.head 4 +  If fFilterAtStart
.head 5 -  Set fFilterAtStart = NOT fFilterAtStart
.head 5 +  If NOT SetQueryFilter( cF )
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 5 -  Set strDSql = cQ.GetFullSQLString(cF)
.head 4 +  If sFilter != STRING_Null
.head 5 -  Call SalColorSet ( pbFilter, COLOR_IndexWindow,COLOR_LightAqua )
.head 4 +  Else
.head 5 -  Call SalColorSet ( pbFilter, COLOR_IndexWindow,COLOR_Default )
.head 3 +  On UM_Print
.head 4 +  If strPrintFileName
.head 5 -  ! Call SalGetWindowText(hWndForm, strOldTitle, 99)
.head 5 -  Call TablePrint(tblS, "Раcчет лимита овердрафта", GetPrnDir() || '\\'
     || strPrintFileName, '')
.head 1 +  Dialog Box: dlg_OverOld
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Овердрафт
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.288"
.head 4 -  Top:    0.74"
.head 4 -  Width:  13.35"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.75"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? No
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.94"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbOPEN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? No
.head 6 -  Height: Class Default
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If Op_Reg(3,nAcc,0,nGrp,nTmp,nRnk,dfNlsO,dfKvO,dfNmsO,'ODB',nIsp,nAccO)
.head 8 +  If SqlPrepareAndExecute( hSql(), "UPDATE acc_over SET tipo=:dfTipO, day=:dfDney,
                                         ndoc=:dfND, datd=to_date(:dfDD,'dd.mm.yyyy'),
                                         sd=(SELECT to_number(:dfSD,'999999999990.00')*POWER(10,dig) from tabval where kv=:dfKvO),
                                         vidd= (SELECT vidd FROM cc_vidd WHERE name=:cmbVidd)
                                  WHERE  acc=:nAcc")
.head 9 +  If SalStrUpperX( strType )='MDATE'
.head 10 -  Call SqlPrepareAndExecute(hSql(), "UPDATE accounts set mdate=:MDATE WHERE acc=:nAccO ")
.head 9 -  If SqlPrepareAndExecute( hSql(),"select acc from specparam where acc=:nAccO")
and  not SqlFetchNext(hSql(), nFetchRes)
and SqlPrepareAndExecute( hSql(),"insert into specparam (acc, s080) values (:nAccO, 1)" )
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SalSendMsg( hWndForm, UM_Populate, 0,0 )
.head 9 -  Call SaveFInfoToLog(
'OVR: '||dfNlsO||' Открыт дог='||dfND||' Тип='|| Str(dfTipO) ||' Дней='||Str(dfDney) )
.head 9 -  Return TRUE
.head 7 -  !
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Call SalMessageBox('Невозможно откыть счет '||dfNlsO,'Ошибка', MB_IconExclamation)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Внести изменения в Базу Данных'
.head 4 +  Pushbutton: pbPROC
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? No
.head 6 -  Height: Class Default
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SetProcParN(nAccO,0,STRING_Null,STRING_Null)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Параметры начисления %%'
.head 4 +  Pushbutton: pbEXIT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? No
.head 6 -  Height: Class Default
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalEndDialog( hWndForm, 0 )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Завершить работу и выйти'
.head 4 +  Pushbutton: pbCLOSE
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute( hSql(),"DELETE FROM acc_over WHERE acc=:nAcc ")
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SaveFInfoToLog('OVR: '||dfNlsO||' Удален' )
.head 8 -  Call SalSendMsg( hWndForm, UM_Populate, 0,0 )
.head 8 -  Return TRUE
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Удалить связку счетов'
.head 4 -  Background Text: Тип овердрафту
.head 5 -  Resource Id: 48414
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    0.524"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 4 -  Background Text: (14 календ., 7 банк.)
.head 5 -  Resource Id: 48415
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.35"
.head 6 -  Top:    0.738"
.head 6 -  Width:  2.133"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.274"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfTipO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.733"
.head 7 -  Top:    0.571"
.head 7 -  Width:  0.733"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_SetFocus
.head 7 +  If dfTipO = NUMBER_Null
.head 8 -  Set dfTipO = 14
.head 8 -  Call SalSendMsg( dfTipO, SAM_Validate, 0, 0 )
.head 6 +  On SAM_Validate
.head 7 +  If dfTipO != 7 and dfTipO != 14
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If dfDney = NUMBER_Null
.head 8 -  Set dfDney = dfTipO
.head 7 -  Call F_MDATE(dfTipO, dfDney)
.head 7 -  Return VALIDATE_Ok
.head 4 -  Background Text: днів :
.head 5 -  Resource Id: 48416
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    0.607"
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 4 -  Background Text: від дог.
.head 5 -  Resource Id: 48417
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.35"
.head 6 -  Top:    0.607"
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfDney
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.483"
.head 7 -  Top:    0.571"
.head 7 -  Width:  0.733"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_SetFocus
.head 7 +  If dfTipO = NUMBER_Null
.head 8 -  Set dfTipO = 14
.head 8 -  Call SalSendMsg( dfTipO, SAM_Validate, 0, 0 )
.head 7 +  If dfDney = NUMBER_Null
.head 8 -  Set dfDney = dfTipO
.head 6 +  On SAM_Validate
.head 7 +  If dfDney < 1
.head 8 -  Set dfDney = dfTipO
.head 7 -  Call F_MDATE(dfTipO, dfDney)
.head 7 -  Return VALIDATE_Ok
.head 4 +  Data Field: MDATE
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.283"
.head 7 -  Top:    0.571"
.head 7 -  Width:  1.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: System Window Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDocs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Tomail.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Документы договора'
.head 6 +  On SAM_Click
.head 7 -  ! Call Debug(SalNumberToStrX(TO.colND,0))
.head 7 -  ! Call cdoc_ShowAllDocs( TO.colND, hWndForm )
.head 7 -  ! Call SalModalDialog( dlg_DocumentList, hWndMDI, TO.colND, hWndForm )
.head 4 +  Combo Box: cmbVidd
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.571"
.head 6 -  Width:  4.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.036"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? Yes
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Data Field: dfNmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.25"
.head 6 -  Top:    0.238"
.head 6 -  Width:  9.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.292"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfRach
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.583"
.head 6 -  Width:  1.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.202"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfRach='Рахунки'
.head 5 +  On UM_NoFontChange
.head 6 -  Return TRUE
.head 3 +  Data Field: dfKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.833"
.head 6 -  Top:    0.929"
.head 6 -  Width:  0.557"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull( dfKv )
.head 7 -  Set dfKv=GetBaseVal()
.head 5 +  On SAM_Validate
.head 6 -  Set dfKvO = dfKv
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.929"
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( dfNls )
.head 7 -  Set dfKv=NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set dfNls = KeyAccount(GetBankMfo(),dfNls)
.head 6 +  If IfAccExists(dfNls,dfKv,nAcc)
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0,0 )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Return VALIDATE_OkClearFlag
.head 3 +  Data Field: dfNms
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.383"
.head 6 -  Top:    0.929"
.head 6 -  Width:  4.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.833"
.head 6 -  Top:    1.179"
.head 6 -  Width:  0.557"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull( dfKvO )
.head 7 -  Set dfKvO = dfKv
.head 3 +  Data Field: dfNlsO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    1.179"
.head 6 -  Width:  1.814"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( dfNlsO )
.head 7 -  Set dfKvO=NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set dfNlsO = KeyAccount(GetBankMfo(),dfNlsO)
.head 6 +  If IfAccExists(dfNlsO,dfKvO,nTmp)
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0,0 )
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0,0 )
.head 7 -  Return VALIDATE_OkClearFlag
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull( dfNlsO )
.head 7 -  Set dfNlsO = KeyAccount(GetBankMfo(),SalStrReplaceX ( dfNls, 0, 4, '2000' ))
.head 7 +  If SalIsNull( dfKvO )
.head 8 -  Set dfKvO = dfKv
.head 3 +  Data Field: dfNmsO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.383"
.head 6 -  Top:    1.179"
.head 6 -  Width:  4.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull( dfNmsO )
.head 7 -  Set dfNmsO = 'Овердрафт '||dfNms
.head 3 -  !
.head 3 +  Data Field: dfValN1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    0.583"
.head 6 -  Width:  0.557"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.202"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfValN1='Вал'
.head 3 +  Data Field: dfNlsN1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.533"
.head 6 -  Top:    0.583"
.head 6 -  Width:  1.817"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.202"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfNlsN1='№ Рах'
.head 3 +  Data Field: dfNamN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    0.583"
.head 6 -  Width:  4.783"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.202"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfNamN='Назва'
.head 3 +  Data Field: dfOsnN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.233"
.head 6 -  Top:    0.952"
.head 6 -  Width:  1.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfOsnN='Основний'
.head 3 +  Data Field: dfOvrN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.233"
.head 6 -  Top:    1.202"
.head 6 -  Width:  1.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfOvrN='Овердрафту'
.head 3 -  Frame
.head 4 -  Resource Id: 48407
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.119"
.head 5 -  Width:  12.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.679"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 48408
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    2.238"
.head 5 -  Width:  12.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.881"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 48409
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.733"
.head 5 -  Top:    0.821"
.head 5 -  Width:  7.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.714"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: № угоди
.head 4 -  Resource Id: 48410
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.633"
.head 5 -  Top:    0.262"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Сума угоди
.head 4 -  Resource Id: 48411
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.233"
.head 5 -  Top:    0.702"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.633"
.head 6 -  Top:    0.429"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull( dfKv )
.head 7 -  Set dfKv=GetBaseVal()
.head 5 +  On SAM_Validate
.head 6 -  Set dfKvO = dfKv
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.533"
.head 6 -  Top:    0.869"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull( dfKv )
.head 7 -  Set dfKv=GetBaseVal()
.head 5 +  On SAM_Validate
.head 6 -  Set dfKvO = dfKv
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.3"
.head 6 -  Top:    0.429"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 +  If SalIsNull( dfKv )
.head 7 -  Set dfKv=GetBaseVal()
.head 5 +  On SAM_Validate
.head 6 -  Set dfKvO = dfKv
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  Background Text: Застава
.head 4 -  Resource Id: 48412
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.467"
.head 5 -  Top:    2.369"
.head 5 -  Width:  5.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Child Table: tZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    2.643"
.head 6 -  Width:  12.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.405"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colNdz
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф
дог.
зал.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.667"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRnk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рег.№
заста-
водав-
ця
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Zalogodatel
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва
заставодавця
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If tZ.colNdz = NUMBER_Null
.head 9 -  Set sTmp=Str(tZ.colRnk)
.head 9 -  Call FunNSIGet('CUSTOMER','NMK',sTmp,tZ.Zalogodatel)
.head 9 -  Set tZ.colRnk=Val(sTmp)
.head 7 +  On SAM_SetFocus
.head 8 +  If tZ.colRnk = NUMBER_Null
.head 9 -  Set tZ.colRnk = nRnk
.head 9 -  Set tZ.Zalogodatel= dfNmk
.head 5 +  Column: colVidZal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вид
застави
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If SqlPrepareAndExecute(hSql(),
    "SELECT name,pawn, substr(nbsz,1,3) INTO :sTmp,:nPawn,:sTmp3
     FROM cc_pawn ORDER by pawn")
.head 9 -  Set nTmp = 0
.head 9 -  Call SalArraySetUpperBound(mPawn, 1, -1)
.head 9 -  Call SalListClear(hWndItem)
.head 9 +  While SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Call SalListAdd(hWndItem, sTmp)
.head 10 -  Set mPawn[nTmp] = nPawn
.head 10 -  Set sNbs3[nTmp] = sTmp3
.head 10 -  Set nTmp = nTmp+1
.head 7 +  On SAM_Validate
.head 8 -  Set nTmp = SalListQuerySelection(hWndItem)
.head 8 +  If nTmp >= 0
.head 9 -  Set tZ.colPawn = mPawn[nTmp]
.head 9 -  ! Изменение вида залога в пределах бс
.head 9 +  If tZ.colAcc !=NUMBER_Null
.head 10 +  If Subs(tZ.colNls,1,3) !=sNbs3[nTmp]
.head 11 -  Call Debug('Несоотв.вида зал. и БС')
.head 11 -  Return FALSE
.head 10 +  Else
.head 11 -  If SqlPrepareAndExecute( hSql(),"UPDATE cc_accp SET pawn=:colPawn WHERE acc=:nAcc" )
and SqlCommit(hSql())
.head 11 -  Call SalSetFocus( tZ.colSumZal )
.head 9 +  Else
.head 10 -  Call SalSetFocus( tZ.colMestoZal )
.head 8 +  Else
.head 9 -  Set tZ.colPawn = 0
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colMestoZal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Місце
знаходження
завтави
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If SqlPrepareAndExecute(hSql(), "SELECT name,mpawn INTO :sTmp,:nPawnM FROM cc_mpawn ORDER by mpawn")
.head 9 -  Set nTmp = 0
.head 9 -  Call SalArraySetUpperBound(mPawnM, 1, -1)
.head 9 -  Call SalListClear(hWndItem)
.head 9 +  While SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Call SalListAdd(hWndItem, sTmp)
.head 10 -  Set mPawnM[nTmp] = nPawnM
.head 10 -  Set nTmp = nTmp+1
.head 7 +  On SAM_Validate
.head 8 -  Set nTmp = SalListQuerySelection(hWndItem)
.head 8 +  If nTmp >= 0
.head 9 -  Set tZ.colPawnM = mPawnM[nTmp]
.head 8 +  Else
.head 9 -  Set tZ.colPawnM = 0
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colSumZal_1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Поточна сума
на рахунку
застави
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSumZal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: + Збільшити,
-  Зменшити
суму
застави
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If not SalIsValidDecimal(hWndItem, 15, 2)
.head 9 -  Call SalMessageBox("Неверный формат суммы", "Ошибка", MB_IconExclamation)
.head 9 -  Return VALIDATE_Cancel
.head 8 +  If tZ.colSumZal !=0 and tZ.colSumZal !=NUMBER_Null
.head 9 +  If tZ.NAZN = STRING_Null
.head 10 -  Set tZ.NAZN = IifS( tZ.colSumZal > 0, "Збільшення", "Зменшення") ||
 " сумы застави по угоді " ||dfND|| '.'||tZ.colVidZal || '.' ||tZ.colMestoZal || '.'
.head 8 +  Else
.head 9 -  Set tZ.NAZN = STRING_Null
.head 5 +  Column: colNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рахунок
обліку
застави
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.614"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If not SalIsValidInteger(hWndItem)
.head 9 -  Call SalMessageBox("Нецифра в номере счета", "Ошибка", MB_IconExclamation)
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Set tZ.colNls = KeyAccount(GetBankMfo(), tZ.colNls)
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 +  If tZ.colNdz = NUMBER_Null
.head 9 -  If SqlPrepareAndExecute(hSqlAux(),
"SELECT s_cc_accp.NEXTVAL INTO :tZ.colNdz FROM dual")
and  SqlFetchNext(hSqlAux(), nFetchRes)
.head 8 +  If SalIsNull(tZ.colNls)
.head 9 -  ! If SqlPrepareAndExecute(hSqlAux(),
  "SELECT bars.cc_f_nls(
    decode (:tZ.colPawnM, 1, nbsz, 2, nvl(nbsz2,nbsz), nvl(nbsz3,nbsz) ),
    :tZ.colRnk,:tZ.colPawnM,:dfND, :tZ.colPawn,'ZAL')
   INTO :tZ.colNls FROM cc_pawn where pawn=:tZ.colPawn")
and SqlFetchNext(hSqlAux(), nFetchRes)
.head 9 +  If SalIsNull(tZ.colNls)
.head 10 -  If SqlPrepareAndExecute(hSqlAux(),
  "SELECT bars.cc_f_nls(
    decode (:tZ.colPawnM, 1,nbsz, 2,nvl(nbsz2,nbsz), nvl(nbsz3,nbsz) ),
    :tZ.colRnk,:tZ.colPawnM,:tZ.colNdz, :tZ.colPawn,'ZAL')
   INTO :tZ.colNls FROM cc_pawn where pawn=:tZ.colPawn")
and SqlFetchNext(hSqlAux(), nFetchRes)
.head 5 +  Column: colValZal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал

.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If SalIsValidInteger(hWndItem)
.head 9 -  Set sTmp = 'kv'
.head 8 +  Else
.head 9 -  Set sTmp = 'lcv'
.head 9 -  Set tZ.colValZal = SalStrUpperX(tZ.colValZal)
.head 8 +  If SqlPrepareAndExecute(hSql(), "SELECT kv,lcv INTO :colKv,:colValZal FROM tabval WHERE " ||sTmp||"=:colValZal")
.head 9 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Call SalMessageBox("Не найден код валюты " ||tZ.colValZal, 'Ошибка', MB_IconExclamation)
.head 10 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 5 +  Column: colAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № счета
внутр
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPawn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
залога
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPawnM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код места
залога
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
валюты
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Призначення
платежу
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.733"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 -  Set sTmp=tZ.NAZN
.head 8 -  Call SalModalDialog( dlg_MemoEditor, hWndForm,'Редактирование назначения пл по залогу', bTmp, sTmp )
.head 8 +  If bTmp
.head 9 -  Set tZ.NAZN = sTmp
.head 5 +  Column: colFL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Флаг
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbZ_Save
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.55"
.head 5 -  Top:    2.298"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Сохранить изменения'
.head 5 +  On SAM_Click
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tZ, nRow,  ROW_New | ROW_Edited, 0)
.head 7 -  Call SalTblSetContext(tZ, nRow)
.head 7 +  If Op_Reg(99, nAcc, tZ.colPawn, tZ.colPawnM, tZ.colNdz, tZ.colRnk, tZ.colNls, tZ.colKv,
    'Залог по дог. овердрафта №' || dfND, 'ODB',GetUserId(), nAcc)
.head 8 -  Call SqlPrepareAndExecute( hSql(),
"UPDATE accounts SET grp="||Str(nGrp)||" WHERE acc=:nAcc AND grp IS NULL" )
.head 8 -  !
.head 8 +  If SqlPrepareAndExecute( hSql(), "SELECT * FROM cc_accp WHERE acc=:nAcc AND accs=:nAccO " )
.head 9 +  If not SqlFetchNext( hSql(),  nFetchRes )
.head 10 -  Call SqlPrepareAndExecute( hSql(),
    "INSERT INTO cc_accp (ACC,MPAWN,PAWN,ND,RNK,NDZ,ACCS)
     VALUES (:nAcc,:tZ.colPawnM,:tZ.colPawn,0,:tZ.colRnk,:tZ.colNdz,:nAccO)" )
.head 9 -  !
.head 9 +  If tZ.colSumZal !=0 and tZ.colSumZal !=NUMBER_Null
.head 10 -  Set nTmp = tZ.colSumZal * 100
.head 10 +  If nTmp > 0
.head 11 -  Set nDk = 1
.head 10 +  Else
.head 11 -  Set nDk = 0
.head 11 -  Set nTmp = -nTmp
.head 10 -  Call cDoc.SetDoc(0, 'ZAL', nDk, 6, dfND,
     GetBankDate(),  GetBankDate(),  GetBankDate(),  GetBankDate(),
     sNlsK, GetBankName(),GetBankMfo(), '', tZ.colKv, nTmp,
     '', tZ.colNls, tZ.Zalogodatel, GetBankMfo(), '', tZ.colKv, nTmp,
     '', tZ.NAZN , '' , GetIdOper(), '', 0,0)
.head 10 +  If cDoc.oDoc()
.head 11 -  Call SqlCommit(hSql())
.head 10 +  Else
.head 11 -  Call SqlRollback(hSql())
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalMessageBox('Невозможно откыть счет залога ' || tZ.colNls, 'Ошибка', MB_IconExclamation)
.head 6 -  Call SalTblPopulate(tZ, hSql(), sSqlZ, TBL_FillAll)
.head 3 +  Pushbutton: pbZ_New
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.05"
.head 5 -  Top:    2.298"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not SalTblAnyRows(tZ, ROW_New, 0)
.head 7 -  Call SalTblDefineSplitWindow(tZ, 1, TBL_Split_Adjustable)
.head 6 -  Set nRow = SalTblInsertRow(tZ, TBL_MinRow)
.head 6 -  Call SalTblSetContext(tZ, nRow)
.head 6 -  Call SalTblSetFocusCell(tZ, nRow, tZ.Zalogodatel, 0, 1)
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Добавить новый'
.head 3 +  Pushbutton: pbZ_Del
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.05"
.head 5 -  Top:    2.298"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Отключить залог '
.head 5 +  On SAM_Click
.head 6 +  If SqlPrepareAndExecute( hSql(),
"delete from cc_accp where accs=:nAccO and acc=:tZ.colAcc" )
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalTblPopulate(tZ, hSql(), sSqlZ, TBL_FillAll)
.head 3 +  Pushbutton: pb_Obn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbRefresh
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.55"
.head 5 -  Top:    2.298"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Перечитать информацию о залогах'
.head 5 +  On SAM_Click
.head 6 -  Call SalTblPopulate(tZ, hSql(), sSqlZ, TBL_FillAll)
.head 3 -  Background Text: Дата угоди
.head 4 -  Resource Id: 48413
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.283"
.head 5 -  Top:    0.262"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: IfAccExists
.head 4 -  Description: Check to see if input account in GL
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sNls
.head 5 -  Number: nKv
.head 5 -  Receive Number: nAccN
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTmp
.head 5 -  Number: nR1 !! Рег № осн счета
.head 5 -  Number: nI1 !! исполнитель осн счета
.head 5 -  String: sN1  !! NLS осн счета
.head 5 -  String: sNMS !! NMS осн счета
.head 5 -  Number: nGrp !! Grp осн счета
.head 4 +  Actions
.head 5 -  Set nAccN=NUMBER_Null
.head 5 -  Call SqlPrepareAndExecute( hSql(),
'SELECT acc INTO :nAccN FROM accounts WHERE kv=:nKv AND nls=:sNls' )
.head 5 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Call SalMessageBox('Счет '||sNls||'/'||Str(nKv)||' не открыт.', 'Внимание!', MB_IconHand)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: F_MDATE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  Number: tipo_
.head 5 -  Number: kol_
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! Date/Time: dat_
.head 5 -  Number: day_
.head 5 -  Number: i_
.head 5 -  Number: n980
.head 4 +  Actions
.head 5 -  Set n980 = GetBaseVal()
.head 5 -  Set MDATE = GetBankDate()
.head 5 -  Set day_ = 0
.head 5 +  If SalStrUpperX( strType )='MDATE'
.head 6 -  Call SalEnableWindow( MDATE )
.head 5 +  Loop
.head 6 +  If SqlPrepareAndExecute( hSql(), "SELECT 0 INTO :i_ FROM holiday WHERE holiday=:MDATE AND kv=:n980 ")
.head 7 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set i_ = 1
.head 7 +  If tipo_=7  !! банковские даты
.head 8 -  Set day_ = day_ + i_
.head 8 +  If day_ < kol_
.head 9 -  Set MDATE = MDATE + 1
.head 8 +  Else
.head 9 -  Return MDATE
.head 7 +  Else !!   If tipo_=14  !! календарные даты
.head 8 -  Set day_ = day_ + 1
.head 8 +  If day_ < kol_ or i_ = 0
.head 9 -  Set MDATE = MDATE + 1
.head 8 +  Else
.head 9 -  Return MDATE
.head 5 -  Return MDATE
.head 2 +  Window Parameters
.head 3 -  Number: nAcc
.head 3 -  String: strType
.head 2 +  Window Variables
.head 3 -  Number: nRnk
.head 3 -  Number: nIsp
.head 3 -  Number: nTmp
.head 3 -  Number: nDk
.head 3 -  Number: nRow
.head 3 -  Number: nGrp
.head 3 -  Number: nAccO
.head 3 -  Number: nFetchRes
.head 3 -  ! Date/Time: MDATE
.head 3 -  String: sSqlZ
.head 3 -  String: sTmp
.head 3 -  Boolean: bTmp
.head 3 -  Number: nPawn
.head 3 -  Number: mPawn[*]
.head 3 -  Number: nPawnM
.head 3 -  Number: mPawnM[*]
.head 3 -  String: sNbs3[*]
.head 3 -  String: sTmp3
.head 3 -  String: sNlsK
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  ! Call Debug (strType)
.head 4 +  If SalStrUpperX( strType )='MDATE'
.head 5 -  Call SalSetWindowText( hWndForm, 'ОВЕРДРАФТ. Установка даты от договора' )
.head 4 +  Else
.head 5 -  Call SalSetWindowText( hWndForm, 'ОВЕРДРАФТ. Установка даты от первого дебета' )
.head 4 -  !
.head 4 -  Call SalDisableWindow(tZ)
.head 4 -  Call SalDisableWindow(pbZ_Save)
.head 4 -  Call SalDisableWindow(pbZ_Del)
.head 4 -  Call SalDisableWindow(pbZ_New)
.head 4 +  If SqlPrepareAndExecute(hSql(),"SELECT nlsm INTO :sNlsK FROM tts WHERE tt='ZAL' ")
and not SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call SalMessageBox('Не описана операция ZAL' , 'Внимание !',  MB_IconExclamation)
.head 4 -  Call SalListPopulate (cmbVidd,hSql(),"SELECT name FROM CC_VIDD")
.head 3 +  On UM_Populate
.head 4 -  Set nRnk=NUMBER_Null
.head 4 -  Set nIsp=NUMBER_Null
.head 4 -  Set nAccO=NUMBER_Null
.head 4 -  !
.head 4 -  Call SalDisableWindow(pbOPEN)
.head 4 -  Call SalDisableWindow(pbPROC)
.head 4 -  Call SalDisableWindow(pbCLOSE)
.head 4 -  ! ------------------------------------------------------------
.head 4 +  If SqlPrepareAndExecute( hSql(),
  "SELECT a.nls, a.kv, a.nms, k.rnk, k.nmk, o.acco, a.isp, a.grp,
          o.ndoc,o.TIPO,o.DAY,to_char(o.datd,'dd.mm.yyyy'),
          LTRIM(to_char(o.sd/POWER(10,t.dig),'999999999990.00')),
          cv.name
   FROM accounts a,customer k, acc_over o, tabval t, cc_vidd cv
   WHERE a.acc=:nAcc AND k.rnk=a.rnk AND a.acc=o.acc (+)
     AND a.kv=t.kv AND o.vidd=cv.vidd(+)
   INTO :dfNls,:dfKv,:dfNms,:nRnk,:dfNmk,:nAccO,:nIsp,:nGrp,:dfND,
        :dfTipO,:dfDney,:dfDD,:dfSD, :cmbVidd ")
.head 5 +  If SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Call SalDisableWindow(dfNmk)
.head 6 -  Call SalDisableWindow(dfNls)
.head 6 -  Call SalDisableWindow(dfKv)
.head 6 -  Call SalDisableWindow(dfNms)
.head 6 -  Call SalEnableWindow(pbOPEN)
.head 6 +  If nAccO
.head 7 +  If SqlPrepareAndExecute( hSql(),
  "SELECT a.nls, a.kv, a.nms, o.tipo , a.mdate
   FROM accounts a,acc_over o WHERE a.acc=:nAccO AND a.acc=o.acco
   INTO :dfNlsO,:dfKvO,:dfNmsO,:dfTipO, :MDATE ")
.head 8 +  If SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SalDisableWindow(dfNlsO)
.head 9 -  Call SalDisableWindow(dfKvO)
.head 9 -  Call SalDisableWindow(dfNmsO)
.head 9 -  Call SalEnableWindow(pbPROC)
.head 9 -  Call SalEnableWindow(pbCLOSE)
.head 8 +  Else
.head 9 -  Call SalEnableWindow(dfNlsO)
.head 9 -  Call SalEnableWindow(dfKvO)
.head 9 -  Call SalEnableWindow(dfNmsO)
.head 7 -  Set sSqlZ =
"SELECT 1,a.acc,a.nls,a.kv,t.lcv,a.ostB/100,p.mpawn,m.name,p.pawn,v.name,p.ndz,p.rnk, c.nmk
 INTO :tZ.colFL, :tZ.colAcc, :tZ.colNls,:tZ.colKv,:tZ.colValZal,:tZ.colSumZal_1, :tZ.colPawnM, :tZ.colMestoZal,
      :tZ.colPawn,:tZ.colVidZal,:tZ.colNdz, :tZ.colRnk, :tZ.Zalogodatel
 FROM accounts a, cc_accp p, cc_mpawn m,cc_pawn v,tabval t, customer c
 WHERE a.acc=p.acc and a.kv=t.kv and p.mpawn=m.mpawn and p.pawn=v.pawn and
       p.accs=:nAccO and c.rnk=p.rnk
 GROUP BY a.acc,a.nls,a.kv,t.lcv,a.ostB/100,p.mpawn,m.name,p.pawn,v.name,p.ndz,p.rnk, c.nmk "
.head 7 -  !
.head 7 -  Call SalEnableWindow(tZ)
.head 7 -  Call SalEnableWindow(pbZ_Save)
.head 7 -  Call SalEnableWindow(pbZ_Del)
.head 7 -  Call SalEnableWindow(pbZ_New)
.head 7 -  Call SalTblPopulate(tZ, hSql(), sSqlZ, TBL_FillAll)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(tZ)
.head 7 -  Call SalDisableWindow(pbZ_Save)
.head 7 -  Call SalDisableWindow(pbZ_Del)
.head 7 -  Call SalDisableWindow(pbZ_New)
.head 4 +  If SalStrTrimX(dfSD)= ""
.head 5 -  ! Set dfSD= SalNumberToStrX(TO.Ost_8000F,2)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On UM_CreateDoc
.head 4 -  ! Call SalModalDialog(dlg_CreateOverDoc,hWndMDI,TO.colND)
.head 1 +  Dialog Box: dlg_ShowOvrEvents
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 13099
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 13100
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 13101
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tblEvents
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 -  Contents
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  ! Set nFlags
.head 4 -  ! Set strSqlPopulate
.head 4 -  ! Set strSqlInsert
.head 4 -  ! Set strSqlDelete
.head 4 -  ! Set strSqlUpdate
.head 4 -  ! Set strFilterTblName
.head 4 -  ! Set strTitleAux
.head 4 -  ! Set strPrintFileName
.head 4 -  ! Set fFilterAtStart
.head 4 -  ! Set nTabInstance
.head 4 -  ! Set fNoReposition
.head 1 +  Table Window: TOEvents
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Кандидаты на овердрафт
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 20000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 10537
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc_turn.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If TOEvents.colAcc != NUMBER_Null
.head 8 -  Call CalcLim(TOEvents.colAcc,hWndForm)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Расчитать лимит '
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 10538
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 10539
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfDat1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.283"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDat2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.583"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: с
.head 5 -  Resource Id: 18972
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: по
.head 5 -  Resource Id: 18973
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.083"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 2 +  Contents
.head 3 +  Column: colAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код 
валюты
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNms
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  5.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRnk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег. №
клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  7.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты (К)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sFilter
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Set strPrintFileName = 'overevent'
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set strFilterTblName="V_OVERCL"
.head 4 -  Call cF.Init(strFilterTblName, "s")
.head 4 -  Set TOEvents.strSqlPopulate=
" select distinct acc,nls,kv,nms,rnk,nmk,SUM(kos)/100
  into :TOEvents.colAcc,
       :TOEvents.colNls,
       :TOEvents.colKv,
       :TOEvents.colNms,
       :TOEvents.colRnk,
       :TOEvents.colNmk,
       :TOEvents.colS 
  from V_OVERCL  
where fdat  >= :TOEvents.dfDat1
  and fdat  <= :TOEvents.dfDat2
  group by acc,nls,kv,nms,rnk,nmk  "
.head 4 +  If SqlPrepareAndExecute( hSql(),"SELECT bankdate,bankdate-30 INTO :TOEvents.dfDat2,:TOEvents.dfDat1 FROM dual ")
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 4 -  Call SalDisableWindow( pbDel )
.head 4 -  Call SalDisableWindow( pbIns )
.head 4 -  Call SalDisableWindow( pbUpdate )
.head 1 +  Dialog Box: dlg_Calclim2
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Расчет лимита овердрафта
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.202"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Расчет лимита овердрафта версия "Ажио"
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Etched
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 1.845"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbFind
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call TblFindString(tblS2,  DFIND_First)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Поиск'
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Установить фильтр...'
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter( cF )
.head 8 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 8 +  If cF.GetFilterWhereClause(TRUE) != STRING_Null
.head 9 -  Set sFilter=" AND "||cF.GetFilterWhereClause(TRUE)
.head 8 +  Else
.head 9 -  Set sFilter=""
.head 8 -  Call Populate()
.head 8 -  Call SalPostMsg(tblS2, SAM_RowSetContext,0,0)
.head 4 +  Pushbutton: pbRefr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call CalcDay()
.head 7 -  Call Populate()
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перечитать'
.head 4 +  Pushbutton: pbEx
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  ! If SqlPrepareAndExecute ( hSql(), " select ROUND(MONTHS_BETWEEN(:dfD2,:dfD1)) into :nMCount  from dual  " )
.head 8 -                                                                        Call SqlFetchNext(hSql(),nT1)
.head 7 +  ! If nMCount  !=  3
.head 8 -                                                                        Call SalMessageBox ("Диапазон дат должен быть равен 3 месяцам.", "Внимание !!!", MB_Ok+MB_IconExclamation )
.head 8 -                                                                        Return FALSE
.head 7 -  Call CalcDay()
.head 7 -  Call CalcSum()
.head 7 +  ! If dfDC2 = 0 or dfDC3 = 0 or dfK2 = 0 or dfK3 = 0 
.head 8 -                                                                        Set dfLim=NUMBER_Null
.head 8 -                                                                        Call SalMessageBox ("Недостаточно данных для расчета.", "Внимание !!!", MB_Ok+MB_IconExclamation )
.head 8 -                                                                        Return FALSE
.head 7 +  If dfProc = NUMBER_Null
.head 8 -  Call SalMessageBox ("Необходимо ввести процентное число.", "Внимание !!!", MB_Ok+MB_IconExclamation )
.head 8 -  Return FALSE
.head 7 -  ! Set dfDK2 = dfK2/dfDC2
.head 7 -  ! Set dfDK3 = dfK3/dfDC3
.head 7 -  Set nK=(dfKAll/3+dfK3)/2
.head 7 -  Set dfMK = nK
.head 7 +  ! If nK > 1
.head 8 -                                                                        Call SalMessageBox ("Коэффициент > 1.", "Внимание !!!", MB_Ok+MB_IconExclamation )
.head 8 -  ! Return FALSE
.head 8 -                                                                        Set nK=1
.head 7 -  Set dfLim = (dfProc/100)*nK
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Расчитать лимит'
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow (  hWndForm )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Завершить работу и выйти'
.head 4 +  Data Field: dfD1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    0.655"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfD2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    1.405"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Sky
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: с
.head 5 -  Resource Id: 6708
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.679"
.head 6 -  Width:  0.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: по
.head 5 -  Resource Id: 6709
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.429"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 6710
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  -0.017"
.head 6 -  Begin Y:  0.405"
.head 6 -  End X:  13.083"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 6711
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.683"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  2.683"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Background Text: 2
.head 5 -  Resource Id: 6712
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.929"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: 3
.head 5 -  Resource Id: 6713
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    1.179"
.head 6 -  Width:  0.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: 1
.head 5 -  Resource Id: 6714
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.679"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Раб. дней
.head 5 -  Resource Id: 6715
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.883"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Ср.кр.оборот
.head 5 -  Resource Id: 6716
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Всего
.head 5 -  Resource Id: 6717
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    1.429"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfDC1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    0.655"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDC2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    0.905"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDC3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    1.155"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDCAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    1.405"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfK1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    0.655"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfK2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    0.905"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfK3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    1.155"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfKAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    1.405"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: (Ср.мес.об + Ср.об. 3 мес.)/2
.head 5 -  Resource Id: 6719
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.283"
.head 6 -  Top:    0.512"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfMK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.283"
.head 7 -  Top:    0.905"
.head 7 -  Width:  2.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Расч. лим.
.head 5 -  Resource Id: 6720
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.383"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfLim
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.483"
.head 7 -  Top:    0.905"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Aqua
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfName
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.383"
.head 7 -  Top:    0.071"
.head 7 -  Width:  9.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 6721
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.583"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  1.583"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Data Field: dfProc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.283"
.head 7 -  Top:    0.905"
.head 7 -  Width:  0.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: %
.head 5 -  Resource Id: 6722
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.083"
.head 6 -  Top:    0.929"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Месяц
.head 5 -  Resource Id: 6723
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    0.512"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Pushbutton: pbPr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Печать содержания таблицы'
.head 6 +  On SAM_Click
.head 7 -  Set nRowNum=TBL_MinRow
.head 7 -  If SqlPrepareAndExecute( hSql(),
" SELECT id INTO :nUid FROM staff WHERE  upper(logname)=upper(USER) ")
and SqlFetchNext( hSql(), nFetchRes )
.head 7 -  If SqlPrepareAndExecute( hSql(),
" delete from acc_over_rep1 
  where userid = :nUid ")
.head 7 +  While SalTblFindNextRow(tblS2, nRowNum, 0, 0)
.head 8 -  Call SalTblSetContext ( tblS2, nRowNum ) 
.head 8 +  If NOT tblS2.colUse
.head 9 -  !
.head 9 -  Call SqlPrepareAndExecute( hSql(),
    "INSERT INTO acc_over_rep1(userid ,dat1,dat2,dat3,dat4,
       days1,days2,days3,days4,post1,
       post2,post3,post4,sob2, sob3,
       sobm, pr,   lim,  used, refd,
       nls1, nls2, kv,   tt,   sn,
       sq,nazn,   k, datd, acc )
     VALUES (:nUid,:dfD1,:dDD2,:dDD3,:dfD2,
        :dfDC1,:dfDC2,:dfDC3,:dfDCAll,:dfK1,
        :dfK2,:dfK3,:dfKAll,:dfKCount30,null,
        :dfMK,:dfProc,:dfLim,:tblS2.colUse,:tblS2.colRef,
        :tblS2.colNlsa,:tblS2.colNlsb,:tblS2.colKva,:tblS2.colTt,:tblS2.colS,
        :tblS2.colSQ,:tblS2.colNazn,:nK,:tblS2.colDatv,:nR1  )" )
.head 7 -  ! Set dfD1=
.head 7 -  Call SqlCommitEx( hSql(),'Розрах.лим.овр.')
.head 7 -  Set sFname='lim_'||SalNumberToStrX(nR1,0)||'.txt'
.head 7 -  Call ExportCatQuery(10001,sFname,3,'',FALSE)
.head 7 -  ! Call Debug(GetPrnDir() || '\\')
.head 7 -  Call SalLoadApp( 'dview.exe', GetPrnDir() || '\\'||sFname )
.head 4 +  Data Field: dDD2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    0.905"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dDD3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    1.155"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Процент
.head 5 -  Resource Id: 6725
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.183"
.head 6 -  Top:    0.512"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Оборотов за последние 30 дней:
.head 5 -  Resource Id: 56635
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.183"
.head 6 -  Top:    1.286"
.head 6 -  Width:  2.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfKCount30
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.017"
.head 7 -  Top:    1.25"
.head 7 -  Width:  1.1"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Всего оборотов за 90 дней:
.head 5 -  Resource Id: 40429
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.617"
.head 6 -  Top:    1.536"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfKCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.017"
.head 7 -  Top:    1.512"
.head 7 -  Width:  1.1"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tblS2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  12.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colUse
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Откл.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRef
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.
док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsa
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: НЛС Д
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKva
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: КВ 
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: НЛС К
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Операция
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дат.вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пост.
ном.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSQ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пост.
экв.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSuit
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Подходит
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNazn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение
платежа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNam_a
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
отправителя
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Boolean: bSortOrd
.head 4 +  Message Actions
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd = not bSortOrd
.head 6 -  Call SalTblSortRows(tblS2, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 2 +  Functions
.head 3 +  Function: Populate
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sSele = 
" select ref,v.nlsd, v.kv, v.nlsk,   v.tt, v.fdat, v.s,v.sq, v.nazn, nam_a
   into :tblS2.colRef,:tblS2.colNlsa,:tblS2.colKva,:tblS2.colNlsb,:tblS2.colTt, 
        :tblS2.colDatv,:tblS2.colS,:tblS2.colSQ, :tblS2.colNazn, :tblS2.colNam_a  
   from v_calcoverlim v
   where v.acck = :nR1
     and  v.fdat >= :dfD1 and v.fdat < :dfD2 "||sFilter
.head 5 -  Call SalTblPopulate(tblS2,hSql(),sSele||sFilter,TBL_FillAll)
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: CalcDay
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nT1
.head 4 +  Actions
.head 5 -  Set nDay= SalDateDay(dfD2)
.head 5 +  If dDD2=DATETIME_Null
.head 6 -  Set dDD2=dfD2-60
.head 5 +  If dDD3=DATETIME_Null
.head 6 -  Set dDD3=dfD2-30
.head 5 +  If dfD1=DATETIME_Null
.head 6 -  Set dfD1=dfD2-90
.head 5 +  If SqlPrepareAndExecute ( hSql(), " select count(*) into :dlg_Calclim2.dfDC1  from fdat
  where fdat >= :dlg_Calclim2.dfD1
       and fdat <= :dDD2 " )
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 5 +  If SqlPrepareAndExecute ( hSql(), " select count(*) into :dlg_Calclim2.dfDC2  from fdat
  where fdat > :dDD2
       and fdat <=  :dDD3  " )
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 5 +  If SqlPrepareAndExecute ( hSql(), " select count(*) into :dlg_Calclim2.dfDC3  from fdat
  where fdat > :dDD3
       and fdat <=:dlg_Calclim2.dfD2 " )
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 5 -  Set dfDCAll=dfDC1+dfDC2+dfDC3
.head 3 +  Function: CalcSum
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRN
.head 5 -  Number: nT1
.head 4 +  Actions
.head 5 -  Set nRN = TBL_MinRow
.head 5 -  Set dfK1=0
.head 5 -  Set dfK2=0
.head 5 -  Set dfK3=0
.head 5 -  Set dfKAll=0
.head 5 +  ! If SqlPrepareAndExecute ( hSql(), 
" select sum(kos)  
  into :dfK1
  from salo s 
  where acc = :nR1
    and fdat >= :dfD1
    and fdat <= :dDD2  " )
.head 6 -                                                                        Call SqlFetchNext(hSql(),nT1)
.head 5 +  ! If SqlPrepareAndExecute ( hSql(), 
" select sum(kos) 
  into :dfK2 
  from salo s 
  where acc = :nR1
    and fdat > :dDD2
    and fdat <= :dDD3  " )
.head 6 -                                                                        Call SqlFetchNext(hSql(),nT1)
.head 5 +  ! If SqlPrepareAndExecute ( hSql(), 
" select sum(kos)  
  into :dfK3 
  from salo s 
  where acc = :nR1
    and fdat > :dDD3
    and fdat <= :dfD2  " )
.head 6 -                                                                        Call SqlFetchNext(hSql(),nT1)
.head 5 +  ! If SqlPrepareAndExecute ( hSql(), 
" select sum(kos)  
  into :dfKAll 
  from salo s 
  where acc = :nR1
    and fdat >= :dfD1
    and fdat <= :dfD2  " )
.head 6 -                                                                        Call SqlFetchNext(hSql(),nT1)
.head 5 -  Set nKCount=0
.head 5 +  While SalTblFindNextRow(tblS2, nRN, 0, 0)
.head 6 -  Call SalTblSetContext ( tblS2, nRN ) 
.head 6 +  If not tblS2.colUse
.head 7 +  If (tblS2.colDatv >=dfD1) and  (tblS2.colDatv <= dDD2)
.head 8 -  Set dfK1 = dfK1 + tblS2.colS
.head 7 +  Else If (tblS2.colDatv >dDD2) and (tblS2.colDatv <= dDD3)
.head 8 -  Set dfK2 = dfK2 + tblS2.colS
.head 7 +  Else If (tblS2.colDatv >dDD3) and  (tblS2.colDatv <= dfD2)
.head 8 -  Set dfK3 = dfK3 + tblS2.colS
.head 7 -  Set nKCount=nKCount+1
.head 5 -  Set dfKAll=dfK1+dfK2+dfK3
.head 5 -  Set dfKCount=nKCount
.head 5 +  If SqlPrepareAndExecute ( hSql(),'select count(*)
   into :dfKCount30
  from v_calcoverlim v
   where v.acck = :nR1
     and  v.fdat >= :dDD3 and v.fdat < :dfD2')
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 2 +  Window Parameters
.head 3 -  Number: nR1
.head 2 +  Window Variables
.head 3 -  String: sSele
.head 3 -  Number: nT1
.head 3 -  String: sFilter
.head 3 -  Boolean: fFilterAtStart
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  : cQ
.head 4 -  Class: cGenQuery
.head 3 -  String: strFilterTblName
.head 3 -  String: strDSql
.head 3 -  Number: nMCount
.head 3 -  Number: nK
.head 3 -  String: strPrintFileName
.head 3 -  Number: nRowNum
.head 3 -  Number: nDay
.head 3 -  Number: nUid
.head 3 -  Number: nKCount
.head 3 -  String: sFname
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalTblSetTableFlags(tblS2,TBL_Flag_SelectableCols,TRUE)
.head 4 -  Set strFilterTblName="V_CALCOVERLIM"
.head 4 -  Set strPrintFileName="calclim"
.head 4 -  Set dfProc=30
.head 4 +  If strFilterTblName != ''
.head 5 -  Call cF.Init(strFilterTblName, "v")
.head 4 +  If SqlPrepareAndExecute ( hSql(), 
" select a.nls||' ('||to_char(a.kv)||')'||a.nms 
  into :dfName  
  from accounts a, customer c 
  where a.rnk=c.rnk  and a.acc=:nR1  " )
.head 5 -  Call SqlFetchNext(hSql(),nT1)
.head 4 -  Call Populate()
.head 3 +  On UM_Populate
.head 4 +  If fFilterAtStart
.head 5 -  Set fFilterAtStart = NOT fFilterAtStart
.head 5 +  If NOT SetQueryFilter( cF )
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 5 -  Set strDSql = cQ.GetFullSQLString(cF)
.head 4 +  If sFilter != STRING_Null
.head 5 -  Call SalColorSet ( pbFilter, COLOR_IndexWindow,COLOR_LightAqua )
.head 4 +  Else
.head 5 -  Call SalColorSet ( pbFilter, COLOR_IndexWindow,COLOR_Default )
.head 3 +  On UM_Print
.head 4 +  If strPrintFileName
.head 5 -  ! Call SalGetWindowText(hWndForm, strOldTitle, 99)
.head 5 -  Call TablePrint(tblS2, "Раcчет лимита овердрафта", GetPrnDir() || '\\'
     || strPrintFileName, '')
.head 1 +  Dialog Box: TONewNLS
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Заведение нового договора
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  4.283"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.524"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.383"
.head 6 -  Top:    0.988"
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Номер лицевого счета' )
.head 5 +  On SAM_Validate
.head 6 -  Call SalSetFocus( KV )
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( TRUE )
.head 3 +  Data Field: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.883"
.head 6 -  Top:    0.988"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Код валюты' )
.head 5 +  On SAM_Validate
.head 6 -  Call SalSetFocus( OK )
.head 3 -  Background Text: Введите номер лицевого счета и валюту
.head 4 -  Resource Id: 52646
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.203"
.head 5 -  Top:    0.262"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.476"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: OK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.5"
.head 5 -  Width:  1.183"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SqlPrepareAndExecute( hSql(), "select count(o.acc) into :NDog from acc_over o, accounts a 
where a.nls=:TONewNLS.NLS and a.kv=:TONewNLS.KV and a.acc=o.acc") 
and SqlFetchNext( hSql(), feature )
.head 7 +  If NDog>0 
.head 8 +  If SalMessageBox ( 'На счет №'||TONewNLS.NLS||' уже открыт договор овердрафта
Вы хотите закрыть текущий договор?','Внимание!', 1 )=1
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 +  If SqlPrepareAndExecute( hSql(), "select distinct acc,lim,ostc into :ACC_2600,:Lim_2600,:Ost_2600 from accounts a 
where a.nls=:TONewNLS.NLS and a.kv=to_number(:TONewNLS.KV)")
and SqlFetchNext( hSql(), feature )
.head 10 -  Call SalSendMsg ( TO.pbDel,SAM_Click, 0, 0 )
.head 7 +  Else
.head 8 +  If SqlPrepareAndExecute( hSql(), "select nbs2600 into :NBSmain from acc_over_nbs 
where substr(:TONewNLS.NLS,1,4)=nbs2600 or substr(:TONewNLS.NLS,1,4)='2600'") 
and not SqlFetchNext( hSql(), feature )
.head 9 -  Call SalMessageBox ( 'Недопустимый балансовый счет!','Внимание!', MB_Ok )
.head 8 -  Else If SqlPrepareAndExecute( hSql(), "select acc into :ACC_2600 from accounts a 
where a.nls=:TONewNLS.NLS and a.kv=to_number(:TONewNLS.KV) and dazs is null") 
and SqlFetchNext( hSql(), feature )
.head 8 +  If ACC_2600=NUMBER_Null or ACC_2600=0
.head 9 -  Call SalMessageBox ( 'Cчет №'||TONewNLS.NLS||' по валюте '||TONewNLS.KV||' не открыт!','Внимание!', MB_Ok )
.head 8 +  Else
.head 9 -  Call SalEndDialog(hWndForm, TRUE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalMapEnterToTab( FALSE )
.head 3 +  Pushbutton: CANSEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.6"
.head 5 -  Top:    1.5"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set ACC_2600 = NUMBER_Null
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.head 4 -  Resource Id: 52648
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.821"
.head 5 -  Width:  3.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 52650
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.071"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 52649
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.405"
.head 5 -  Width:  3.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Number: ACC_2600
.head 2 +  Window Variables
.head 3 -  Number: feature
.head 3 -  Number: NDog
.head 3 -  Number: Lim_2600
.head 3 -  Number: Ost_2600
.head 3 -  String: NBSmain
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 1 +  Dialog Box: dlg_Prosroch
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Перенос на просрочку частичной суммы овердрафта
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.883"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.845"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.405"
.head 6 -  Width:  5.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: DAT_OV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата взятия
овердрафта
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Right
.head 6 -  Width:  1.267"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: SUM_OV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
овердрафта
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRC_OV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Начисленные
проценты
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRC_CHISL
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Процентное
число
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SumCol()
.head 3 +  Data Field: df1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    3.274"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    3.619"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: OK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Перенести
.head 4 -  Window Location and Size
.head 5 -  Left:   1.1"
.head 5 -  Top:    5.0"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set SUM=100*dlg_Prosroch.df3
.head 6 -  Set SUM_PR=100*dlg_Prosroch.df4
.head 6 -  Call SalEndDialog ( dlg_Prosroch,TRUE) 
.head 3 +  Pushbutton: CANCEL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.467"
.head 5 -  Top:    5.012"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog ( dlg_Prosroch,FALSE) 
.head 3 +  Data Field: df3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    4.095"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If df3>df1
.head 7 -  Call SalMessageBox( 'Cумма переноса не может 
быть больше, чем остаток на счете!','Внимание!', MB_Ok )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: df4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    4.44"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If df4>df2
.head 7 -  Call SalMessageBox( 'Cумма переноса не может 
быть больше, чем остаток на счете!','Внимание!', MB_Ok )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Общая сумма овердрафта
.head 4 -  Resource Id: 24770
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.3"
.head 5 -  Top:    3.321"
.head 5 -  Width:  2.333"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Начисленные проценты
.head 4 -  Resource Id: 24771
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.3"
.head 5 -  Top:    3.667"
.head 5 -  Width:  2.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Сумма переносимого овердрафта
.head 4 -  Resource Id: 24772
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    4.119"
.head 5 -  Width:  2.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Сумма переносимых процентов
.head 4 -  Resource Id: 24773
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.517"
.head 5 -  Top:    4.488"
.head 5 -  Width:  2.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 24774
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.06"
.head 5 -  Width:  5.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.881"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 24775
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    3.988"
.head 5 -  Width:  5.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.845"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: График формирования текущего состояния
.head 4 -  Resource Id: 48408
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.617"
.head 5 -  Top:    0.167"
.head 5 -  Width:  4.617"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: SumCol
.head 4 -  Description: Сумирует SELECTED колонку
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nH
.head 5 -  Number: nP
.head 4 +  Actions
.head 5 -  Set nH=SalTblColumnSum( tbl1,SalTblQueryColumnID(tbl1.SUM_OV), ROW_Selected, 0 )
.head 5 +  If nH
.head 6 -  Set df3=nH
.head 5 -  Set nP=SalTblColumnSum( tbl1,SalTblQueryColumnID(tbl1.PRC_OV), ROW_Selected, 0 )
.head 5 +  If nP
.head 6 -  Set df4=nP
.head 2 +  Window Parameters
.head 3 -  Number: ACC_OVR
.head 3 -  Receive Number: SUM
.head 3 -  Receive Number: SUM_PR
.head 2 +  Window Variables
.head 3 -  Number: ACC_
.head 3 -  Number: OST_ISH
.head 3 -  Number: OST_VH
.head 3 -  Number: SUM_OVER
.head 3 -  Number: OST_OVR
.head 3 -  Number: DEBET
.head 3 -  Number: KREDIT
.head 3 -  Date/Time: FDAT
.head 3 -  Number: nFetchRezult
.head 3 -  Number: n
.head 3 -  Number: COL_DAT
.head 3 -  Number: SUM_PRC_CHISL
.head 3 -  Number: SUM_PRC_OV
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 +  If SqlPrepareAndExecute( hSql(), "select ostc into :OST_ISH from accounts where acc=:ACC_OVR" )
.head 5 -  Call SqlFetchNext( hSql(), nFetchRezult )
.head 4 +  If SqlPrepareAndExecute( hSql(), "select abs(ostc/100) into :df2 from accounts where acc=(select acra 
from int_accn where acc=:ACC_OVR and id=0)" )
.head 5 -  Call SqlFetchNext( hSql(), nFetchRezult )
.head 4 -  Set OST_OVR=OST_ISH
.head 4 -  Set OST_VH=OST_ISH
.head 4 -  Set df1=Abs(OST_ISH/100)
.head 4 +  If SqlPrepareAndExecute( hSql(), "select sum(decode(dk,0,s,0)) debet,sum(decode(dk,1,s,0)) kredit,fdat INTO :DEBET,:KREDIT,:FDAT from opldok where acc=:ACC_OVR and sos=5  group by fdat order by fdat desc " )
.head 5 -  Set n= 1
.head 5 -  Set SUM_PRC_CHISL=0
.head 5 +  While OST_VH<0 and SqlFetchNext( hSql(), nFetchRezult )
.head 6 -  ! Set OST_VH=OST_ISH+DEBET-KREDIT
.head 6 +  If DEBET>KREDIT
.head 7 -  Set OST_VH=OST_ISH+DEBET-KREDIT
.head 7 +  If OST_VH<0
.head 8 -  Set SUM_OVER=Abs(OST_OVR-OST_VH)
.head 7 +  Else
.head 8 -  Set SUM_OVER=Abs(OST_OVR)
.head 7 -  Set OST_OVR= OST_VH
.head 7 -  Call SalTblInsertRow( tbl1, n )
.head 7 -  Set tbl1.DAT_OV=FDAT
.head 7 -  Set tbl1.SUM_OV=SUM_OVER/100
.head 7 -  Set n=n+1
.head 7 -  Call SqlPrepareAndExecute( hSqlAux(),'select count(*)-1 into :COL_DAT from fdat f, INT_ACCN I where 
                           i.acc=:ACC_OVR and f.fdat between :FDAT and i.ACR_DAT')
.head 7 -  Call SqlFetchNext(  hSqlAux(),nFetchRezult)
.head 7 +  If COL_DAT<0
.head 8 -  Call SalMessageBox ("Дата последнего начисления меньше
даты взятия последнего овердрафта!
Выполните функцию начисления процентов.", "Внимание !!!", MB_Ok )
.head 8 -  Call SalEndDialog ( dlg_Prosroch,FALSE) 
.head 7 -  Set tbl1.PRC_CHISL=SUM_OVER*COL_DAT
.head 7 -  Set SUM_PRC_CHISL=SUM_PRC_CHISL+tbl1.PRC_CHISL
.head 6 -  Set OST_ISH= OST_VH
.head 4 -  Call SalTblSetFlagsAnyRows ( tbl1, ROW_New, FALSE, ROW_New, 0 )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalTblSetRow(tbl1,TBL_SetLastRow)
.head 4 -  Set FDAT=tbl1.DAT_OV
.head 4 -  Set SUM_PRC_OV=0
.head 4 -  Call SalTblSetRow(tbl1,TBL_SetFirstRow)
.head 4 +  While tbl1.DAT_OV>FDAT
.head 5 -  Set tbl1.PRC_OV=df2*tbl1.PRC_CHISL/SUM_PRC_CHISL
.head 5 -  Set SUM_PRC_OV=SUM_PRC_OV+tbl1.PRC_OV
.head 5 -  Call SalTblSetRow(tbl1,TBL_SetNextRow)
.head 4 -  Set tbl1.PRC_OV=df2-SUM_PRC_OV
.head 4 -  Call SalTblSetRow(tbl1,TBL_SetFirstRow)
.head 4 -  ! Set tbl1.PRC_OV=df2*tbl1.PRC_CHISL/SUM_PRC_CHISL
.head 1 +  Dialog Box: dlg_Calclim_WH
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ХД. Расчет лимита овердрафта
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.202"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Расчет лимита овердрафта версия "Петрокомерц"
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Etched
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 1.845"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbFind
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call TblFindString(tblS,  DFIND_First)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Поиск'
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Установить фильтр...'
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter( cF )
.head 8 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 8 +  If cF.GetFilterWhereClause(TRUE) != STRING_Null
.head 9 -  Set sFilter=" AND "||cF.GetFilterWhereClause(TRUE)
.head 8 +  Else
.head 9 -  Set sFilter=""
.head 8 -  Call Populate()
.head 8 -  Call SalPostMsg(tblS, SAM_RowSetContext,0,0)
.head 4 +  Pushbutton: pbRefr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call CalcDay()
.head 7 -  Call Populate()
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перечитать'
.head 4 +  Pushbutton: pbEx
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call CalcDay()
.head 7 -  Call CalcSum()
.head 7 +  If dfDC2 = 0 or dfDC3 = 0 or dfK2 = 0 or dfK3 = 0
.head 8 -  Set dfDK2=NUMBER_Null
.head 8 -  Set dfDK3=NUMBER_Null
.head 8 -  Set dfLim=NUMBER_Null
.head 8 -  Call SalMessageBox ("Недостаточно данных для расчета.", "Внимание !!!", MB_Ok+MB_IconExclamation )
.head 8 -  Return FALSE
.head 7 +  If dfProc = NUMBER_Null
.head 8 -  Call SalMessageBox ("Необходимо ввести процентное число.", "Внимание !!!", MB_Ok+MB_IconExclamation )
.head 8 -  Return FALSE
.head 7 -  Set dfDK2 = dfK2/dfDC2
.head 7 -  Set dfDK3 = dfK3/dfDC3
.head 7 -  Set nK=dfDK3/dfDK2
.head 7 -  Set dfMK = dfKAll/3
.head 7 +  If nK > 1
.head 8 -  Call SalMessageBox ("Коэффициент > 1.", "Внимание !!!", MB_Ok+MB_IconExclamation )
.head 8 -  ! Return FALSE
.head 8 -  Set nK=1
.head 7 -  Set dfLim = (dfProc/100)*dfMK*nK
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Расчитать лимит'
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow (  hWndForm )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Завершить работу и выйти'
.head 4 +  Data Field: dfD1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    0.655"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfD2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    1.405"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Sky
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: с
.head 5 -  Resource Id: 47066
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.679"
.head 6 -  Width:  0.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: по
.head 5 -  Resource Id: 47067
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.429"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 47068
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  -0.017"
.head 6 -  Begin Y:  0.405"
.head 6 -  End X:  13.083"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 47069
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.683"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  2.683"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Background Text: 2
.head 5 -  Resource Id: 47070
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.929"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: 3
.head 5 -  Resource Id: 47071
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    1.179"
.head 6 -  Width:  0.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: 1
.head 5 -  Resource Id: 47072
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.679"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Раб. дней
.head 5 -  Resource Id: 47073
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.883"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Поступило
.head 5 -  Resource Id: 47074
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.083"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Всего
.head 5 -  Resource Id: 47075
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    1.429"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Ср.дн.оборот
.head 5 -  Resource Id: 47076
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.383"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfDC1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    0.655"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDC2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    0.905"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDC3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    1.155"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDCAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.983"
.head 7 -  Top:    1.405"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfK1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    0.655"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfK2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    0.905"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfK3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    1.155"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfKAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    1.405"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDK2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.283"
.head 7 -  Top:    0.905"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfDK3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.283"
.head 7 -  Top:    1.155"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Ср.мес.оборот
.head 5 -  Resource Id: 47077
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.783"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfMK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.783"
.head 7 -  Top:    1.405"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Расч. лим.
.head 5 -  Resource Id: 47078
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.383"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfLim
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.383"
.head 7 -  Top:    1.405"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Aqua
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dfName
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.383"
.head 7 -  Top:    0.071"
.head 7 -  Width:  9.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 47079
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.583"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  1.583"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Data Field: dfProc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.283"
.head 7 -  Top:    1.405"
.head 7 -  Width:  0.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: %
.head 5 -  Resource Id: 47080
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.083"
.head 6 -  Top:    1.429"
.head 6 -  Width:  0.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Месяц
.head 5 -  Resource Id: 47081
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.183"
.head 6 -  Top:    0.512"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Pushbutton: pbPr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Печать содержания таблицы'
.head 6 +  On SAM_Click
.head 7 -  Set nRowNum=TBL_MinRow
.head 7 -  If SqlPrepareAndExecute( hSql(),
" delete from TMP_OVER_REP ")
.head 7 +  While SalTblFindNextRow(tblS, nRowNum, 0, 0)
.head 8 -  Call SalTblSetContext ( tblS, nRowNum )
.head 8 +  If NOT tblS.colUse
.head 9 -  !
.head 9 -  Call SqlPrepareAndExecute( hSql(),
    "INSERT INTO TMP_OVER_REP(dat1,dat2,dat3,dat4,
       days1,days2,days3,days4,post1,
       post2,post3,post4,sob2, sob3,
       sobm, pr,   lim,  used, refd,
       nls1, nls2, kv,   tt,   sn,
       sq,nazn,   k, datd, nmk, ndoc, datd2, dayd )
     VALUES (:dfD1,:dDD2,:dDD3,:dfD2,
        :dfDC1,:dfDC2,:dfDC3,:dfDCAll,:dfK1,
        :dfK2,:dfK3,:dfKAll,:dfDK2,:dfDK3,
        :dfMK,:dfProc,:dfLim,:tblS.colUse,:tblS.colRef,
        :tblS.colNlsa,:tblS.colNlsb,:tblS.colKva,:tblS.colTt,:tblS.colS,
        :tblS.colSQ,:tblS.colNazn,:nK,:tblS.colDatv, :nmk, :ndoc, :datD2, :dayd  )" )
.head 7 -  Call SqlCommitEx( hSql(),'Розрах.лим.овр.')
.head 7 -  Set sFname='lim_' || acc_code ||'.txt'
.head 7 -  Call ExportCatQuery(20001,sFname,3,'',FALSE)
.head 7 -  ! Call Debug(GetPrnDir() || '\\')
.head 7 -  Call SalLoadApp( 'dview.exe', GetPrnDir() || '\\'||sFname )
.head 4 +  Data Field: dDD2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    0.905"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dDD3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    1.155"
.head 7 -  Width:  1.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tblS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  12.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colUse
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Откл.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRef
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.
док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.733"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsa
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет Д
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKva
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: КВ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsb
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет К
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Операция
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
валютир.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd-MM-yy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма.в
ном.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSQ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма в
экв.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSuit
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Подходит
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNazn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение
платежа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNam_a
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
отправителя
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Boolean: bSortOrd
.head 4 +  Message Actions
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd = not bSortOrd
.head 6 -  Call SalTblSortRows(tblS, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 2 +  Functions
.head 3 +  Function: Populate
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sSele =
" select G1, G2, G3, G4, G5, G6, G7/100, G8/100, G9, G10
   into :tblS.colRef,:tblS.colNlsa,:tblS.colKva,:tblS.colNlsb,:tblS.colTt,
        :tblS.colDatv,:tblS.colS,:tblS.colSQ, :tblS.colNazn, :tblS.colNam_a
   from WH_DOCS_2600 v
   where DEPARTMENT_ID = :dep_id
     AND ACC_CODE = :acc_code
    and  cal_dat >= :dfD1 and cal_dat < :dfD2 "||sFilter
.head 5 -  Call SalTblPopulate(tblS,hSql(),sSele||sFilter,TBL_FillAll)
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: CalcDay
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nT1
.head 4 +  Actions
.head 5 -  Set nDay= SalDateDay(dfD2)
.head 5 +  If dDD2=DATETIME_Null
.head 6 -  Set dDD2=SalDateConstruct (
SalDateYear(dfD2),
SalDateMonth(dfD2)-2,
SalDateDay(dfD2),
0,
0,
0  )
.head 5 +  If dDD3=DATETIME_Null
.head 6 -  Set dDD3=SalDateConstruct (
SalDateYear(dfD2),
SalDateMonth(dfD2)-1,
SalDateDay(dfD2),
0,
0,
0  )
.head 5 +  If dfD1=DATETIME_Null
.head 6 -  Set dfD1=SalDateConstruct (
SalDateYear(dfD2),
SalDateMonth(dfD2)-3,
SalDateDay(dfD2),
0,
0,
0  )
.head 5 +  If SqlPrepareAndExecute ( hSql(), " select COUNT(DISTINCT bank_dat) into :dlg_Calclim_WH.dfDC1  FROM times@wh_otcn
  WHERE cal_DAT >= :dlg_Calclim_WH.dfD1
       and cal_DAT <= :dDD2 " )
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 5 +  If SqlPrepareAndExecute ( hSql(), " select COUNT(DISTINCT bank_dat) into :dlg_Calclim_WH.dfDC2 FROM times@wh_otcn
  WHERE cal_DAT > :dDD2
       and cal_DAT <=  :dDD3  " )
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 5 +  If SqlPrepareAndExecute ( hSql(), " select COUNT(DISTINCT bank_dat) into :dlg_Calclim_WH.dfDC3  FROM times@wh_otcn
  WHERE cal_DAT > :dDD3
       and cal_DAT <=:dlg_Calclim_WH.dfD2 " )
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 5 -  Set dfDCAll=dfDC1+dfDC2+dfDC3
.head 3 +  Function: CalcSum
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRN
.head 5 -  Number: nT1
.head 4 +  Actions
.head 5 -  Set nRN = TBL_MinRow
.head 5 -  Set dfK1=0
.head 5 -  Set dfK2=0
.head 5 -  Set dfK3=0
.head 5 -  Set dfKAll=0
.head 5 +  If SqlPrepareAndExecute ( hSql(), " select last_day(:dlg_Calclim_WH.dfD1),last_day(last_day(:dlg_Calclim_WH.dfD1)+1) into :dD1,:dD2 from dual " )
.head 6 -  Call SqlFetchNext(hSql(),nT1)
.head 5 +  While SalTblFindNextRow(tblS, nRN, 0, 0)
.head 6 -  Call SalTblSetContext ( tblS, nRN )
.head 6 +  If not tblS.colUse
.head 7 +  If (tblS.colDatv >=dfD1) and  (tblS.colDatv <= dDD2)
.head 8 -  Set dfK1 = dfK1+tblS.colS
.head 7 +  Else If (tblS.colDatv >dDD2) and (tblS.colDatv <= dDD3)
.head 8 -  Set dfK2 = dfK2+ tblS.colS
.head 7 +  Else If (tblS.colDatv >dDD3) and  (tblS.colDatv <= dfD2)
.head 8 -  Set dfK3 = dfK3+ tblS.colS
.head 5 -  Set dfKAll=dfK1+dfK2+dfK3
.head 2 +  Window Parameters
.head 3 -  String: nR1
.head 3 -  String: acc_code
.head 3 -  Number: dep_id
.head 3 -  String: kv
.head 3 -  String: nmk
.head 3 -  String: ndoc
.head 3 -  Date/Time: datD2
.head 3 -  String: dayd
.head 2 +  Window Variables
.head 3 -  String: sSele
.head 3 -  Date/Time: dD1
.head 3 -  Date/Time: dD2
.head 3 -  Number: nT1
.head 3 -  String: sFilter
.head 3 -  Boolean: fFilterAtStart
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  : cQ
.head 4 -  Class: cGenQuery
.head 3 -  String: strFilterTblName
.head 3 -  String: strDSql
.head 3 -  Number: nMCount
.head 3 -  Number: nK
.head 3 -  String: strPrintFileName
.head 3 -  ! Date/Time: dDD2
.head 3 -  ! Date/Time: dDD3
.head 3 -  Number: nRowNum
.head 3 -  Number: nDay
.head 3 -  Number: nUid
.head 3 -  String: sFname
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalTblSetTableFlags(tblS,TBL_Flag_SelectableCols,TRUE)
.head 4 -  Set strFilterTblName="WH_DOCS_2600"
.head 4 -  Set strPrintFileName="calclim"
.head 4 -  Set dfProc=10
.head 4 +  If strFilterTblName != ''
.head 5 -  Call cF.Init(strFilterTblName, "v")
.head 4 -  Set dfName = nR1 || ' (' || kv || ') ' || nmk
.head 4 -  Call Populate()
.head 3 +  On UM_Populate
.head 4 +  If fFilterAtStart
.head 5 -  Set fFilterAtStart = NOT fFilterAtStart
.head 5 +  If NOT SetQueryFilter( cF )
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 5 -  Set strDSql = cQ.GetFullSQLString(cF)
.head 4 +  If sFilter != STRING_Null
.head 5 -  Call SalColorSet ( pbFilter, COLOR_IndexWindow,COLOR_LightAqua )
.head 4 +  Else
.head 5 -  Call SalColorSet ( pbFilter, COLOR_IndexWindow,COLOR_Default )
.head 3 +  On UM_Print
.head 4 +  If strPrintFileName
.head 5 -  ! Call SalGetWindowText(hWndForm, strOldTitle, 99)
.head 5 -  Call TablePrint(tblS, "Раcчет лимита овердрафта", GetPrnDir() || '\\'
     || strPrintFileName, '')
.head 1 +  Dialog Box: dlg_SetDatOver  ! Установить локальную операционную дату
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выбор даты
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.838"
.head 4 -  Top:    1.885"
.head 4 -  Width:  3.75"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.369"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Midnight Blue
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Bottom
.head 4 -  Visible? Yes
.head 4 -  Size: 0.143"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.033"
.head 5 -  Top:    1.369"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, IDCANCEL )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать
.head 4 -  Window Location and Size
.head 5 -  Left:   1.083"
.head 5 -  Top:    1.369"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalMessageBox( 'Выбрать данные за дату '||SalFmtFormatDateTime( dfDat, 'dd/MM/yyyy' )||'?',
  'Внимание!', MB_YesNo | MB_IconQuestion)=IDYES
.head 7 -  Set dDat=dfDat
.head 7 -  Call SalEndDialog( hWndForm, IDOK )
.head 3 +  Data Field: dfDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.733"
.head 6 -  Top:    0.774"
.head 6 -  Width:  2.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.357"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SqlPrepareAndExecute( hSql(), 'SELECT b.cal_id INTO :CalId_
FROM WH_TIMES b
WHERE b.cal_dat=:dfDat')
.head 7 +  If NOT SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Call SalMessageBox( 'Нет данных за выбранную дату. ', 'Ошибка.', MB_IconExclamation )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 +  If SqlPrepareAndExecute( hSql(), 'SELECT count(*) INTO :Cnt_
FROM WH_CONTRACT_OVER
WHERE cal_id=:CalId_')
.head 9 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 9 +  If Cnt_ = 0
.head 10 -  Call SalMessageBox( 'Нет данных за выбранную дату. ', 'Ошибка.', MB_IconExclamation )
.head 10 -  Return VALIDATE_Cancel
.head 6 +  If not SalIsValidDateTime( hWndItem )
.head 7 -  Call SalMessageBox( 'Ош. формат даты', 'Ошибка.', MB_IconExclamation )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If dfDat>GetBankDate()
.head 7 -  Call SalMessageBox( 'Устанавливаемая дата больше банковской. ', 'Ошибка.', MB_IconExclamation )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_OkClearFlag
.head 3 -  Frame
.head 4 -  Resource Id: 47082
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    0.667"
.head 5 -  Width:  2.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.571"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: System Frame Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: ХД. Состояние портфеля овердрафтов на дату
.head 4 -  Resource Id: 47083
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    0.071"
.head 5 -  Width:  2.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Number: CalId_
.head 3 -  Receive Date/Time: dDat
.head 2 +  Window Variables
.head 3 -  Number: Cnt_
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndItem)
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call SalSetFocus( pbOk )
.head 4 +  If SqlPrepareAndExecute( hSql(), 'SELECT a.cal_id, b.cal_dat INTO :CalId_, :dfDat
FROM (SELECT MAX(cal_id) cal_id
FROM WH_CONTRACT_OVER) a,WH_TIMES b
WHERE a.cal_id=b.cal_id')
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 4 -  ! Set dfDat=GetBankDate()
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Table Window: TO_WH
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ХД. Овердрафты
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.15"
.head 4 -  Top:    0.958"
.head 4 -  Width:  14.867"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.476"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: System Window Color
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 5000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Ведення овердрафтів
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.488"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb_MOS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Marigold
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb_MOS_Ex
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.567"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Marigold
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click,0,0 )
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 47085
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.117"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 47086
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 47087
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Pushbutton: pbProcN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.35"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Orchid
.head 5 -  Background Color: Yellow
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbProcN1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.6"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_ints.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Yellow
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pbProcP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.95"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Periwinkle
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbProcP1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.2"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_ints.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Periwinkle
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pbProcZ
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.55"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Chartreuse
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbProcZ1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.8"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_ints.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Chartreuse
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pbProcL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.05"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Chekin.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Red
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbProcS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.05"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Chekin.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Red
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbProcL1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.3"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Red
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbProcL2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.3"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Red
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Pushbutton: pb_Acc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.55"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbShowArc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.633"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Books.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbCalclim
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Chartl.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If Acc_2600 != STRING_Null
.head 8 -  ! Call SalModalDialog( dlg_Calclim, hWndForm,Acc_2600)
.head 8 -  Call SalModalDialog( dlg_Calclim_WH, hWndCol, Nls_2600, Acc_2600, dep_id, KV, NMK, NDOC, colDatd2, DNEY)
.head 8 -  Call SalSendMsg (TO_WH, UM_Populate, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Расчитать лимит '
.head 4 -  Line
.head 5 -  Resource Id: 47088
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  14.5"
.head 6 -  Begin Y:  0.393"
.head 6 -  End X:  14.5"
.head 6 -  End Y:  0.786"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Combo Box: cmbAction
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.881"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? Yes
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set KolDep_=0
.head 7 -  Call SalListInsert (cmbAction,-1,STRING_Null)
.head 7 +  If SqlPrepareAndExecute( hSql(),
"SELECT a.DEPARTMENT_ID, b.DEPARTMENT_NAME
INTO :DepId_, :DepName_
FROM (SELECT DISTINCT DEPARTMENT_ID
FROM WH_CONTRACT_OVER where cal_id=:CalId_) a, WH_DEPARTMENT b
WHERE a.DEPARTMENT_ID=b.DEPARTMENT_ID ")
.head 8 +  While SqlFetchNext( hSql(), nTmp )
.head 9 -  Call SalListInsert (cmbAction,KolDep_,DepName_)
.head 9 -  Set Dep[KolDep_]=DepId_
.head 9 -  Set KolDep_=KolDep_+1
.head 7 +  If KolDep_=1
.head 8 -  Set cmbAction=DepName_
.head 7 +  Else
.head 8 -  Set cmbAction=STRING_Null
.head 6 +  On SAM_Click
.head 7 -  Set DepId_= Dep[SalListQuerySelection ( cmbAction )]
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0)
.head 7 -  ! Call SalMessageBox ( "1: " || SalNumberToStrX(SalListQuerySelection ( cmbAction ), 0) ||
"  2: " || SalNumberToStrX(DepId_,0), "Дата", MB_Ok )
.head 4 +  Pushbutton: pbExecute
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.867"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbGoodcl
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.067"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Select.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: client
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.933"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrcAcc ! Все СЧета
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.5"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb_dop
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Sky
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbZalog
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    0.476"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_accs.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Yellow
.head 5 -  Background Color: Gray
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbZalog_All
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.476"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Gray
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbZ
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.933"
.head 6 -  Top:    0.476"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb_Info
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.0"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Background Text: Подразделение
.head 5 -  Resource Id: 47089
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 2 +  Contents
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
дог.

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.75"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Название
клиента

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NDOC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
дог

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SqlPrepareAndExecute( hSql(),
 "UPDATE acc_over SET ndoc=:TO_WH.ND WHERE acc=:TO_WH.Acc_2600 ")
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SaveFInfoToLog('OVR: № дог.'|| TO_WH.NDOC )
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 3 +  Column: DNEY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дни
Кален.
Банк.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDatd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
начала.
дог.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDatd2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
оконч.
дог.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
Погашения

.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
Вал

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: Int_Per
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Нач.проц
от периода

12
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Nls_2600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Основной
счет

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Lim_dog
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Лимит по
договору

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: Lim_2600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Текущий
лимит
овердр.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Lim_Yes
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
использ.
лимита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Lim_No
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
НЕиспольз.
лимита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 15
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  !
.head 3 +  Column: Acc_2600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: acc_code
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_2067
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_2607
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_9129
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_8000
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFlag
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кл
гас.
сам
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFlagS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Все флаги
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сост
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAPP_2600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
оконч.
дог.
5
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Obs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сост.
обсл.
долга
(код)
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SqlPrepareAndExecute( hSql(),
 "UPDATE acc_over SET obs=:TO_WH.Obs WHERE acc=:TO_WH.Acc_2600 ")
.head 7 -  Call SqlCommit(hSql())
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 3 +  Column: colFin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_2096
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Acc_2480
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dep_id
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: dep_id
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: CalcS080
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: Fin
.head 5 -  Number: Obs
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nS080t
.head 5 -  Number: nT
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(),
 "SELECT f.s080 INTO :nS080t FROM fin_obs_s080 f
   WHERE f.FIN=:Fin and f.obs=:Obs ")
.head 6 -  Call SqlFetchNext(hSql(),nT)
.head 6 -  Return nS080t
.head 3 +  Function: SetAdmOpt
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: NbsMainAcc
.head 5 -  Number: UserType !  1-Функции кредитчика, 2-Функции бухгалтера, 4-Функции Залоговика (и все варианті сумм)
.head 5 -  Number: AccesLevel! (Уровень доступа 0-Полный, 1-Свой отдел, 2-Только свои договора)
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: NPos
.head 5 -  Boolean: Res
.head 5 -  String: StrTmp
.head 4 +  Actions
.head 5 +  If NbsMainAcc=STRING_Null or Subs( NbsMainAcc,1,1 )='N'  or Subs( NbsMainAcc,1,1 )='R'
.head 6 -  Call SalHideWindow( TO_WH.pb_Info )
.head 6 -  Return 0
.head 5 -  Set StrFilter=NbsMainAcc
.head 5 -  Set Res=FALSE
.head 5 -  Set AskInsp=FALSE
.head 5 -  Set AskBuh=FALSE
.head 5 -  Set AskZal=FALSE
.head 5 +  Loop
.head 6 -  Set NPos=SalStrScan(StrFilter,';')
.head 6 +  If NPos<0
.head 7 -  Break
.head 6 +  Else
.head 7 -  Set StrFilter=SalStrLeftX ( StrFilter, NPos)||"' , '"||SalStrRightX ( StrFilter, SalStrLength(StrFilter)-NPos-1)
.head 7 -  Set Res=TRUE
.head 5 +  If AccesLevel=1
.head 6 -  Set StrTmp='where userid in (select ou1.userid from otd_user ou1,otd_user ou2 where ou2.userid='||SalNumberToStrX( GetUserId(),0)||' and ou2.otd=ou1.otd)'
.head 5 +  Else If AccesLevel=2
.head 6 -  Set StrTmp='where userid ='||SalNumberToStrX( GetUserId(),0)
.head 5 +  If Res
.head 6 -  Set StrFilter="  (select acc from accounts where acc in (select acc from acc_over "|| StrTmp ||") and nbs in ('"||StrFilter||"'))"
.head 5 +  Else If StrFilter!=STRING_Null
.head 6 -  Set StrFilter="  (select acc from accounts where acc in (select acc from acc_over "|| StrTmp ||") and nbs ='"||StrFilter||"')"
.head 5 +  If SalNumberMod (UserType,2)>0
.head 6 -  Set AskInsp=TRUE
.head 5 +  If SalNumberMod (UserType,4)>1
.head 6 -  Set AskBuh=TRUE
.head 5 +  If UserType>3
.head 6 -  Set AskZal=TRUE
.head 5 +  If AskInsp=FALSE
.head 6 -  Call SalDisableWindow( pbIns )
.head 6 -  Call SalDisableWindow(pbDel )
.head 6 -  Call SalDisableWindow( pbUpdate )
.head 6 -  Call SalDisableWindow( pbUpdate )
.head 6 -  Call SalDisableWindow( pbCalclim )
.head 6 -  Call SalDisableWindow( pb_MOS )
.head 6 -  Call SalDisableWindow( pb_MOS_Ex )
.head 5 +  If AskBuh=FALSE
.head 6 -  Call SalDisableWindow( pbExecute )
.head 6 -  Call SalDisableWindow(cmbAction )
.head 5 +  If AskZal=FALSE
.head 6 -  Call SalDisableWindow( pbZalog )
.head 6 -  Call SalDisableWindow(pbZalog_All )
.head 6 -  Call SalDisableWindow(pbZ)
.head 5 +  Set NameForm="Портфель овердрафтов "||IifS(AccesLevel=1,"по подразделению
","")||IifS(AccesLevel>0,"пользователя №"||SalNumberToStrX( GetUserId(),0),"")||" по балансовым счетам ("||NbsMainAcc||")
 c функциональностью"||IifS(not (AskInsp or AskBuh or AskZal)," просмотра","")||IifS( AskInsp," кредитного инспектора"||IifS( (AskBuh or AskZal),",",""),"")||IifS(AskBuh,"
бухгалтера"||IifS(AskZal,",",""),"")||IifS(AskZal," залоговика","")||IifS(SalStrUpperX( strType )='MDATE',".
 Установка даты от договора",". Установка даты от первого дебета")
.head 6 -  Call SalDisableWindow( pbZalog )
.head 6 -  Call SalDisableWindow(pbZalog_All )
.head 6 -  Call SalDisableWindow(pbZ)
.head 5 -  Call SalSetWindowText(TO_WH,"Портфель овердрафтов")
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: strType
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  Date/Time: dDat
.head 3 -  Number: nId
.head 3 -  Window Handle: hWndCol
.head 3 -  Number: nTmp
.head 3 -  Number: nAcc
.head 3 -  Number: nAccTek
.head 3 -  Number: nOldOst
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  Number: nS
.head 3 -  Number: nDk
.head 3 -  String: sKontrA
.head 3 -  String: sKontrN
.head 3 -  String: sTmp
.head 3 -  Number: i
.head 3 -  Date/Time: dTmp
.head 3 -  Date/Time: aDat[*]
.head 3 -  Boolean: bSortOrd
.head 3 -  Number: nColHan
.head 3 -  Number: nKol
.head 3 -  Number: n
.head 3 -  String: temstr
.head 3 -  String: sOkpob
.head 3 -  Number: nRez
.head 3 -  Number: nI
.head 3 -  Number: nRow
.head 3 -  Number: nRecCount
.head 3 -  Number: nFetchRezult
.head 3 -  Number: nDogToArcCount
.head 3 -  String: sTempStr
.head 3 -  String: sNls2067
.head 3 -  String: sNls2069
.head 3 -  String: sStrPrs
.head 3 -  Number: nRowNum
.head 3 -  !
.head 3 -  Number: g1
.head 3 -  Number: g8
.head 3 -  Number: g10
.head 3 -  Number: g11
.head 3 -  Number: g12
.head 3 -  Number: g13
.head 3 -  Number: g14
.head 3 -  Number: g17
.head 3 -  !
.head 3 -  String: sActProcN
.head 3 -  String: sActProcN1
.head 3 -  String: sActProcP
.head 3 -  String: sActProcP1
.head 3 -  String: sActProcZ
.head 3 -  String: sActProcZ1
.head 3 -  String: sActProcL
.head 3 -  String: sActProcS
.head 3 -  String: sActProcL1
.head 3 -  String: sActProcL2
.head 3 -  String: sActProcL3
.head 3 -  String: sActProcL4
.head 3 -  String: sActKom
.head 3 -  String: sActKom1
.head 3 -  String: NAM_KATZ
.head 3 -  !
.head 3 -  Number: nEdAcc ! флаг признак возможности редактировать карточку счета
.head 3 -  Number: nEdAccFlag
.head 3 -  ! NAM_KATZ
.head 3 -  Number: nNd
.head 3 -  Number: KODZ
.head 3 -  Number: nNd2
.head 3 -  Number: ACC_2600
.head 3 -  Number: CUSTTYPE
.head 3 -  Number: RNK
.head 3 -  Number: SUM
.head 3 -  Number: SUM_PR
.head 3 -  Number: NFetchRez
.head 3 -  Number: TMP
.head 3 -  Number: OSTC_2067
.head 3 -  Number: OSTC_2069
.head 3 -  Number: OSTB_2067
.head 3 -  Number: OSTB_2069
.head 3 -  Number: OSTC_2600
.head 3 -  Number: OSTC_2607
.head 3 -  Number: ACCS
.head 3 -  Boolean: AskInsp
.head 3 -  Boolean: AskBuh
.head 3 -  Boolean: AskZal
.head 3 -  String: StrFilter
.head 3 -  Number: UserType !  1-Функции кредитчика, 2-Функции бухгалтера, 4-Функции Залоговика (и все варианті сумм)
.head 3 -  Number: AccesLevel! (Уровень доступа 0-Полный, 1-Свой отдел, 2-Только свои договора)
.head 3 -  String: NameForm
.head 3 -  String: sFilter
.head 3 -  Number: CalId_
.head 3 -  Number: DepId_
.head 3 -  Number: Dep[*]
.head 3 -  Number: KolDep_
.head 3 -  String: DepName_
.head 3 -  Date/Time: CalDat_
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set TO_WH.dDat   = GetBankDate()
.head 4 -  Set UserType=SalNumberMod( nPar, 10 )
.head 4 -  Set AccesLevel=(nPar-SalNumberMod( nPar, 10 ))/10
.head 4 -  !
.head 4 -  Set TO_WH.nTabInstance = 1
.head 4 -  Set TO_WH.fFilterAtStart =1
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 9)
.head 4 -  Set nFlags=GT_NoRet
.head 4 -  Set strFilterTblName= 'WH_OVER_STATE'
.head 4 -  Set strPrintFileName= 'OVR'
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Set dTmp=dDat
.head 4 -  Set i=0
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 4 -  Call SalModalDialog( dlg_SetDatOver, hWndForm, CalId_, CalDat_)
.head 4 -  Call SalSetWindowText( hWndForm, 'ХД. Состояние портфеля овердрафтов на дату '||SalFmtFormatDateTime( CalDat_, 'dd/MM/yyyy' ) )
.head 4 -  ! Call ShowWindow( TO_WH, SW_SHOWMAXIMAZED )
.head 3 +  On UM_Populate
.head 4 -  Set sFilter = ""
.head 4 +  If TO_WH.fFilterAtStart
.head 5 -  Set TO_WH.fFilterAtStart = NOT TO_WH.fFilterAtStart
.head 5 +  If NOT SetQueryFilter( cF )
.head 6 -  Call SalDestroyWindow( TO_WH )
.head 4 -  Set sFilter = cF.GetFilterWhereClause( FALSE )
.head 4 -  Set nNd2=nNd
.head 4 -  Set g1  = 0
.head 4 -  Set g8  = 0
.head 4 -  Set g10 = 0
.head 4 -  Set g11 = 0
.head 4 -  Set g12 = 0
.head 4 -  Set g13 = 0
.head 4 -  Set g14 = 0
.head 4 -  Set g17 = 0
.head 4 -  ! Call SalSendClassMessage( UM_Populate, 0, 0)
.head 4 -  Set strSqlPopulate=" SELECT contract_code, cust_name, contract_num, days, acc_majority_date,
kv, ACC_NUM, LIM, amount, dat2, abs(rest), dat1, acc_code, department_id
INTO :ND,
:NMK,
:NDOC,
:DNEY,
:MDATE,
:KV,
:Nls_2600,
:Lim_2600,
:Lim_dog,
:colDatd2,
:Lim_No,
:colDatd,
:Acc_2600,
:dep_id
  FROM  WH_OVER_STATE
where cal_id=:CalId_ "  || IifS(cmbAction="",""," and department_id=:DepId_ ")
|| IifS(sFilter||StrFilter="",""," and ") || IifS(sFilter = "","", sFilter || IifS(StrFilter!=""," and ","")) ||IifS(StrFilter!=STRING_Null," acc_2600 in "||StrFilter,"")|| "
  ORDER BY acc_majority_date "
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblPopulate(hWndForm, cMain.hSql(), TO_WH.strSqlPopulate, TBL_FillAll)
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  Call SalTblDefineSplitWindow ( hWndForm, 1, TRUE )
.head 4 -  Set nTmp=SalTblInsertRow ( hWndForm, TBL_MinRow )
.head 4 -  Call SalTblSetContext ( hWndForm, nTmp)
.head 4 -  Call SalTblSetRowFlags( hWndForm, nTmp, ROW_New, FALSE )
.head 4 -  Set NMK ='В с е г о  :   '||Str( g1 )
.head 4 -  Set Lim_dog   = g8
.head 4 -  Set Lim_2600  = g11
.head 4 -  Set Lim_Yes   = g13
.head 4 -  Set Lim_No    = g14
.head 4 +  If nNd2 != NUMBER_Null and nNd2 != 0
.head 5 -  Set nRowNum=TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRowNum, 0, 0)
.head 6 -  Call SalTblSetContext ( hWndForm, nRowNum )
.head 6 +  If SalStrToNumber(ND) = nNd2
.head 7 -  Call SalTblSetFocusRow (hWndForm, nRowNum)
.head 7 -  Return FALSE
.head 3 +  On SAM_FetchRowDone
.head 4 -  !
.head 4 -  Set g1  = g1 + 1
.head 4 -  Set g8  = Lim_dog  + g8
.head 4 -  Set g11 = Lim_2600 + g11
.head 4 -  Set g14 = Lim_No   + g14
.head 4 -  Set Lim_Yes = Lim_2600-Lim_No
.head 4 +  If Lim_Yes < 0
.head 5 -  Set Lim_Yes=0
.head 4 -  Set g13 = Lim_Yes  + g13
