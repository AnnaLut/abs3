.head 0 +  Application Description:
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000009A0000 002C000000020000 0003000000000000 0077020000FCFFFF
0040: FFE9FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 020000000016713A 5C6261727339385C 62696E5C50425F31 2E61706418713A5C
0020: 6261727339385C62 696E5C6E65776170 702E646C6C18713A 5C6261727339385C
0040: 62696E5C6E657761 70702E6170630000 01010115433A5C43 454E545552415C6E
0060: 65776170702E7275 6E15433A5C43454E 545552415C6E6577 6170702E646C6C15
0080: 433A5C43454E5455 52415C6E65776170 702E617063000001 0101145C62617273
00A0: 39385C62696E5C43 425F312E61706416 5C6261727339385C 62696E5C6E657761
00C0: 70702E646C6C165C 6261727339385C62 696E5C6E65776170 702E617063000001
00E0: 010115433A5C4345 4E545552415C6E65 776170702E61706C 15433A5C43454E54
0100: 5552415C6E657761 70702E646C6C1543 3A5C43454E545552 415C6E6577617070
0120: 2E61706300000101 01
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0218B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? Yes
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Docwis6.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: Winbars2.apl
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Custacnt.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: Procapi.apd
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Arial
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd-MM-yyyy
.head 3 -  Number: #00000
.head 3 -  Number: 0000
.head 3 -  Number: #0000
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  String: DlgMSG_Error = 'Внимание ! Ошибка ! '
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  Sql Handle: hSqlTmp1
.head 3 -  Sql Handle: hSqlTmp2
.head 3 -  Sql Handle: hSqlTmp3
.head 3 -  Boolean: bApdInited
.head 3 -  Number: z1
.head 3 -  Number: z2
.head 3 -  Number: z3
.head 3 -  Number: z4
.head 3 -  Number: z5
.head 2 +  Internal Functions
.head 3 +  Function: CB_1  !__exported
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Window Handle:
.head 4 +  Parameters
.head 5 -  Window Handle: hW
.head 5 -  Number: z
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call Ini_CB()
.head 5 +  If z=1 !! АКЦИИ собственной эммиссии
.head 6 -  Return SalCreateWindow(CB1, hWndForm , z )
.head 5 +  If z=2 !! АКЦИИ других
.head 6 -  Return SalCreateWindow(CBA, hWndForm , z )
.head 3 +  Function: Ini_CB
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not bApdInited
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars009.lng"
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 6 -  Call DocWisInit( 'CB_VVOD' )
.head 6 -  Set bApdInited = TRUE
.head 5 -  Return bApdInited
.head 3 +  Function: nF0    !! Числовой ноль=NUMBER_Null
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Receive Number: nn
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nn=0
.head 6 -  Set nn=NUMBER_Null
.head 5 -  Return nn
.head 3 +  Function: F_NLS0
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean: ret
.head 4 +  Parameters
.head 5 -  Number: KOD !! 0 - для банка, RNK для клиентов
.head 5 -  String: KODI
.head 5 -  Number: inst_num
.head 5 -  String: TIP
.head 5 -  Receive String: NLS
.head 5 -  Receive Number: OST
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nI
.head 5 -  String: ss
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set ss="SELECT a.nls,a.ostc INTO :NLS,:OST 
        FROM accounts a,cb_acc c "|| IifS(KOD>0,
",cust_acc u WHERE u.acc=a.acc and u.rnk=:KOD and ", "WHERE ")||
"a.tip=:TIP and a.acc=c.acc and c.inst_num=:inst_num " 
.head 5 -  Call SqlPrepareAndExecute(hSql(),ss )   
.head 5 +  If not SqlFetchNext(hSql(),nI)
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Call SalMessageBox("Не открыт счет эмиссии "||KODI||" для "||
IifS(KOD=0,'банка', 'клиента '||Str(KOD) )||':'||
GetValueStr("SELECT name from tips where tip='"||TIP||"'"), DlgMSG_Error, MB_IconExclamation)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: F_VVOD
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: WRG
.head 5 -  Window Handle: WR
.head 5 -  Number: nCB
.head 5 -  String: sTT2
.head 5 -  Number: nKv
.head 5 -  String: sNd
.head 5 -  Number: nSum_
.head 5 -  Number: NOM
.head 5 -  Number: nS2
.head 5 -  String: sAccA !! Счет А главный
.head 5 -  String: sAccB !! Счет Б главный
.head 5 -  String: s1 !! Счет дополнительный 
.head 5 -  String: s2 !! Счет дополнительный 
.head 5 -  String: s3 !! Счет дополнительный 
.head 5 -  String: s4 !! Счет дополнительный 
.head 5 -  String: s5 !! Счет дополнительный 
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Call SalCreateWindow(CB_VVOD, hWndForm, WRG, WR, nCB,
sTT2,nKv,sNd,nSum_, NOM, nS2, sAccA, sAccB, s1, s2, s3, s4, s5 )      
.head 5 -  Return TRUE
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 3148913166
0000: AA010000D3000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF0101805A
0080: 0000000102000004 63446F6300EE0000 0009000000EF02FE 00FF9304000002FB
00A0: 00FF0F08000000EE 0200FF3F0C00B000 00010D00FFFFE019 00000001FE00FF83
00C0: 2600000001FB00FF 0F33000000EE0100 FF3F4000B8000001 00FFFFE04D000000
00E0: 01FE00FF03
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cMeter
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
.head 3 +  ! On SAM_SqlError
.head 4 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 4 -  !
.head 4 -            Call ShowSqlError( wParam, lParam )
.head 4 -  !
.head 4 -            Return FALSE
.head 4 -  !
.head 4 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 1 +  Table Window: CBA
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ценные бумаги других эмитентов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.013"
.head 4 -  Top:    0.24"
.head 4 -  Width:  14.529"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.823"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: на &ПРОДАЖУ... 
.head 4 -  Resource Id: 55432
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &1.Приобретение 
.head 5 -  Resource Id: 55446
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) 
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'PUF',ss,i0) and 
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CB1',s1,i0) and 
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CB2',s2,i0) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,'BUF',s3,i0) 
.head 7 -  Set s4=STRING_Null
.head 7 +  If nCB=2 !! облигации
.head 8 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'CBD',s4,i0)
.head 9 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF8',nKV,Str(inst_num),0,NOM, 0, 
ss, STRING_Null, s1, s2, s3, s4, STRING_Null )      
.head 7 +  Else If nCB=4 !! aкции 
.head 8 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF8',nKV,Str(inst_num),0,NOM,0, 
ss, STRING_Null, s1, s2, s3, s4, STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &2.Продажа
.head 5 -  Resource Id: 55447
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
SPUF !=NUMBER_Null 
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'PUF',ss,i0) and 
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CB1',s1,i0) and 
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CB2',s2,i0) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,'BUF',s3,i0) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CUF',s4,i0)        
.head 7 +  If nCB=2 !! облигации
.head 8 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'CBD',s5,i0)
.head 9 -  Call F_VVOD( hWndForm, pbRefresh,nCB,
'UF9',nKV,Str(inst_num), BS1*100, NOM, CS1*100, 
ss, STRING_Null, s1, s2, s3, s4, s5 )      
.head 7 +  Else If nCB=4 !! акции
.head 8 -  Call F_VVOD( hWndForm, pbRefresh,nCB,
'UF9',nKV,Str(inst_num),BS1*100, NOM,0, 
ss, STRING_Null, s1, s2, s3, s4, STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &3.Изменение рыночной стоимости 
.head 5 -  Resource Id: 42626
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
nCB=4 and
SPUF !=NUMBER_Null and 
RS1  !=NUMBER_Null and 
RS1  !=BS1 
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'CB0',s1,i0)
.head 7 -  Set i1=SalNumberAbs( SPUF - (SPUF/BS1)*RS1 )
.head 7 +  If i1 >= 0.01
.head 8 +  If RS1>BS1 and F_NLS0(nOUR_RNK,inst_code,inst_num,'CB4',s4,i0) 
.head 9 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF7', nKV, Str(inst_num), i1, NOM,0,
s1, s4, STRING_Null, STRING_Null, STRING_Null,STRING_Null, STRING_Null )      
.head 8 +  Else If F_NLS0(nOUR_RNK,inst_code,inst_num,'CB3',s3,i0)
.head 9 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF7', nKV, Str(inst_num), i1, NOM, 0,
s3, s1, STRING_Null, STRING_Null, STRING_Null,STRING_Null,STRING_Null )      
.head 7 -  Call SalWaitCursor( FALSE )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &4.Перевод "продажа" -> "инвестиции"
.head 5 -  Resource Id: 42615
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
SPUF !=NUMBER_Null 
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If nCB=4 !! акции
.head 7 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'PUF',ss,i1) and   
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CB6',s1,i2) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,'BUF',s2,i1) and   
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CBB',s3,i2) 
.head 8 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF5',nKV,Str(inst_num), BS1*100, NOM, 0,
s1, ss, s2, s3, STRING_Null,STRING_Null,STRING_Null )      
.head 6 +  If nCB=2 !! облигации
.head 7 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'PUF',ss,i1) and   
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CB6',s1,i2) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CBD',s2,i1) and   
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CBE',s3,i2) 
.head 8 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF5',nKV,Str(inst_num), BS1*100, NOM, 0,
s1, ss, s2, s3, STRING_Null,STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &5.Погашение обязательств эмитента
.head 5 -  Resource Id: 42622
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
nCB=4 and
SPUF !=NUMBER_Null !! только для акций
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'CB2',s1,i0) and   
   F_NLS0(nOUR_RNK,inst_code,inst_num,'PUF',s3,i3) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,'BUF',s4,i4)    
.head 7 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UFX', nKV, Str(inst_num), i3, i4, 0,
s1, s3, STRING_Null, s4, STRING_Null, STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 3 +  Popup Menu: на &ИНВЕСТИЦИИ...
.head 4 -  Resource Id: 42623
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &1.Приобретение 
.head 5 -  Resource Id: 42624
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) 
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'CB6',ss,i0) and 
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CB1',s1,i0) and 
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CB2',s2,i0) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,IifS(nCB=4,'CBB','BUF'),s3,i0) 
.head 7 -  Set s4=STRING_Null
.head 7 +  If nCB=2 !! облигации
.head 8 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'CBE',s4,i0) 
.head 9 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF8',nKV,Str(inst_num),0,NOM, 0, 
ss, STRING_Null, s1, s2, s3, s4, STRING_Null )      
.head 7 +  Else If nCB=4
.head 8 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF8',nKV,Str(inst_num),0,NOM, 0, 
ss, STRING_Null, s1, s2, s3, s4, STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &2.Приобретение (накопленный %) 
.head 5 -  Resource Id: 6201
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
nCB=2
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'DUF',ss,i0) 
.head 7 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF8',nKV,Str(inst_num),0,NOM,0,
 ss, STRING_Null, STRING_Null, STRING_Null, STRING_Null, STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &3.Изменение рыночной стоимости 
.head 5 -  Resource Id: 42627
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
nCB=4 and 
SCB6 !=NUMBER_Null and 
RS1  !=NUMBER_Null and 
RS1  !=BS1 
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'CB7',s1,i0)
.head 7 -  Set i1=SalNumberAbs( SCB6 - (SCB6/BS2)*RS1 )
.head 7 +  If i1 >= 0.01
.head 8 +  If RS1>BS2 and F_NLS0(nOUR_RNK,inst_code,inst_num,'CBA',s4,i0) 
.head 9 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF7', nKV, Str(inst_num), i1, NOM,0,
s1, s4, STRING_Null, STRING_Null, STRING_Null,STRING_Null,STRING_Null )      
.head 8 +  Else If F_NLS0(nOUR_RNK,inst_code,inst_num,'CB8',s3,i0)
.head 9 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF7', nKV, Str(inst_num), i1, NOM,0,
s3, s1, STRING_Null, STRING_Null, STRING_Null,STRING_Null,STRING_Null )      
.head 7 -  Call SalWaitCursor( FALSE )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &4.Перевод "продажа" <- "инвестиции"
.head 5 -  Resource Id: 42628
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
SCB6 !=NUMBER_Null 
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If nCB=4 !! акции
.head 7 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'CB6',ss,i1) and   
   F_NLS0(nOUR_RNK,inst_code,inst_num,'PUF',s1,i2) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CBB',s2,i1) and   
   F_NLS0(nOUR_RNK,inst_code,inst_num,'BUF',s3,i2) 
.head 8 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF5',nKV,Str(inst_num), BS2*100, NOM,0, 
s1, ss, s2, s3, STRING_Null,STRING_Null,STRING_Null )      
.head 6 +  If nCB=2 !! облигации
.head 7 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'PUF',ss,i1) and   
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CB6',s1,i2) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CBD',s2,i1) and   
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CBE',s3,i2) 
.head 8 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF5',nKV,Str(inst_num), BS2*100, NOM, 0,
ss, s1, s3, s2, STRING_Null,STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &5.Погашение обязательств эмитента
.head 5 -  Resource Id: 27783
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
nCB=2 and 
SCB6 !=NUMBER_Null !! только для облигаций
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'CB2',s1,i1) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CB6',s2,i2) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,'BUF',s3,i3)    
.head 7 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UFX', nKV, Str(inst_num), i1, i2, 0,
s1, s2, s3, STRING_Null, STRING_Null, STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 3 +  Popup Menu: &Общие операции... 
.head 4 -  Resource Id: 42617
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &1.Сообщение о выплате дивидендов
.head 5 -  Resource Id: 42619
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
nCB=4
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'DUF',s1,i0) and
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CB5',s2,i0)
.head 7 -  Call F_VVOD( hWndForm, pbRefresh, nCB,
'UF1', nKV, Str(inst_num), 0, NOM,0,
s1, s2, STRING_Null, STRING_Null, STRING_Null,STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Выход
.head 5 -  Resource Id: 42618
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.686"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.886"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.286"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 57040
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  7.943"
.head 6 -  Begin Y:  0.021"
.head 6 -  End X:  7.943"
.head 6 -  End Y:  0.479"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 7014
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  9.071"
.head 6 -  Begin Y:  0.031"
.head 6 -  End X:  9.071"
.head 6 -  End Y:  0.49"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.486"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.543"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.971"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.086"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call TablePrint( hWndForm,"ЦБ Других эмитентов",GetPrnDir()||'\\'|| SqlUser,'' )
.head 4 -  Line
.head 5 -  Resource Id: 57041
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.986"
.head 6 -  Begin Y:  -0.021"
.head 6 -  End X:  5.986"
.head 6 -  End Y:  0.438"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.886"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 57042
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.0"
.head 6 -  Begin Y:  -0.021"
.head 6 -  End X:  4.0"
.head 6 -  End Y:  0.438"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSwitch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.286"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, UM_HotAccountList, 0, 0)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Счета по учету акций'
.head 4 +  Pushbutton: pbDEPO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.686"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Депозитарий акционеров банка'
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow(CB3, hWndForm)
.head 4 +  Combo Box: cmb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.071"
.head 6 -  Top:    0.104"
.head 6 -  Width:  3.817"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.927"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: 35
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmb1.Init(hWndItem)
.head 7 -  Call cmb1.Populate(hSql(), "t.CB",
"t.INST_TYPE || ' ' || t.NAME", "inst_type t ",
" WHERE t.cb in (2,4)  ORDER BY t.cb ")
.head 7 -  Call SalListSetSelect(hWndItem, 0)
.head 7 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 6 +  On SAM_Click
.head 7 -  Set nCB= cmb1.GetKey(SalListQuerySelection(hWndItem))
.head 7 -  !
.head 7 +  If nCB=4 !! акции - скрыть дисконт
.head 8 -  Call SalHideWindow(CBA.SCBD)
.head 8 -  Call SalHideWindow(CBA.SCBE)
.head 8 -  Call SalHideWindow(CBA.CS1)
.head 8 -  !
.head 8 -  Call SalShowWindow(CBA.RS1)
.head 8 -  Call SalShowWindow(CBA.SBUF)
.head 8 -  Call SalShowWindow(CBA.SCBB)
.head 8 -  !
.head 8 -  Set emis="(SELECT c.inst_num,
 sum(decode(a.tip,'PUF', -a.ostc,0))/100 s1,
 sum(decode(a.tip,'CB1', a.ostc,0))/100 s2,
 sum(decode(a.tip,'CB2',a.ostc,0))/100 s3,
 sum(decode(a.tip,'BUF',-a.ostc,0))/100 s4,
 sum(decode(a.tip,'CB6',-a.ostc,0))/100 s5,
 sum(decode(a.tip,'CBB',-a.ostc,0))/100 s6
 FROM accounts a, cb_acc c 
 WHERE a.acc=c.acc  GROUP BY c.inst_num) "
.head 8 -  Set CBA.strSqlPopulate="
SELECT b.kv, b.ISSUE_DATE, b.name,
       b.par_value,
       k.s1, k.s2, k.s3, k.s4, k.s5, k.s6,
       b.inst_num, 
       b.inst_code,
       b.ISSUE_PRICE/100, 
       c.nmk
FROM instrument b, customer c,"||emis|| " k 
WHERE b.rnk=c.rnk and 
      b.cb="||Str(nCB)||" and 
      b.inst_num=k.inst_num (+) 
ORDER BY b.rnk, b.ISSUE_DATE, b.inst_num
INTO :CBA.KV, :CBA.DAT, :CBA.NAME, 
     :CBA.NOM100,
     :CBA.SPUF, :CBA.SCB1, :CBA.SCB2, :CBA.SBUF, :CBA.SCB6, :CBA.SCBB,
     :CBA.inst_num,
     :CBA.inst_code, 
     :CBA.RS1,
     :CBA.NMK "
.head 7 +  If nCB=2 !! облигации
.head 8 -  Call SalHideWindow(CBA.RS1)
.head 8 -  ! Call SalHideWindow(CBA.BS1)
.head 8 -  ! Call SalHideWindow(CBA.BS2)
.head 8 -  Call SalHideWindow(CBA.SBUF)
.head 8 -  Call SalHideWindow(CBA.SCBB)
.head 8 -  !
.head 8 -  Call SalShowWindow(CBA.SCBD)
.head 8 -  Call SalShowWindow(CBA.SCBE)
.head 8 -  Call SalShowWindow(CBA.CS1)
.head 8 -  !
.head 8 -  Set emis="(SELECT c.inst_num,
 sum(decode(a.tip,'PUF',-a.ostc,0))/100 s1,
 sum(decode(a.tip,'CB1', a.ostc,0))/100 s2,
 sum(decode(a.tip,'CB2', a.ostc,0))/100 s3,
 sum(decode(a.tip,'CBD', a.ostc,0))/100 s4,
 sum(decode(a.tip,'CB6',-a.ostc,0))/100 s5,
 sum(decode(a.tip,'CBE', a.ostc,0))/100 s6
 FROM accounts a, cb_acc c 
 WHERE a.acc=c.acc  GROUP BY c.inst_num) "
.head 8 -  Set CBA.strSqlPopulate="
SELECT b.kv, b.ISSUE_DATE, b.name,
       b.par_value,
       k.s1, k.s2, k.s3, k.s4, k.s5, k.s6,
       b.inst_num, 
       b.inst_code,
       b.ISSUE_PRICE/100, 
       c.nmk
FROM instrument b, customer c,"||emis|| " k 
WHERE b.rnk=c.rnk and 
      b.cb="||Str(nCB)||" and 
      b.inst_num=k.inst_num (+) 
ORDER BY b.rnk, b.ISSUE_DATE, b.inst_num
INTO :CBA.KV, :CBA.DAT, :CBA.NAME, 
     :CBA.NOM100,
     :CBA.SPUF, :CBA.SCB1, :CBA.SCB2, :CBA.SCBD, :CBA.SCB6, :CBA.SCBE,
     :CBA.inst_num,
     :CBA.inst_code, 
     :CBA.RS1,
     :CBA.NMK "
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 2 +  Contents
.head 3 +  Column: inst_code
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
инстр.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.614"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Название
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
регистрации
Эмиссии
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Right
.head 4 -  Width:  1.286"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рыночная
стоимость 
1 ЦБ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.057"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номин.
стоимость
1 ЦБ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.057"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set NOM100=NOM*100
.head 6 +  If not SalIsNull(NOM) and NOM>0
.head 7 -  Set KOL=SBUF/NOM
.head 7 +  If SPUF >0 and KOL >0
.head 8 -  Set BS1= SPUF/KOL
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: NOM100
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номинал
акции

.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.883"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Цена 
приобре
тения 
1 ЦБ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.057"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SBUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПП
Номинальная
стоимость
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SPUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПП
Балансовая
стоимость

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SCBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПП
Дисконт +
Премия  -
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПП
Стоимость 
Д/П 1 ЦБ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.086"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SCBB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПИ
Номинальная
стоимость
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SCB6
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПИ
Балансовая
стоимость
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SCBE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПИ
Дисконт +
Премия   -
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BS2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ПИ
Стоимость
Д/П 1 ЦБ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: inst_num
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Эмитент
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SCB2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Прибыль 
отвлеченная
для ЦБ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.314"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SCB1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Прибыль 
нераспредел
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.343"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Кол-во

.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: CB
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nKV
.head 3 -  Number: nOUR_RNK
.head 3 -  String: ss
.head 3 -  Number: nI
.head 3 -  !
.head 3 -  String: emis
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  String: s3
.head 3 -  String: s4
.head 3 -  String: s5
.head 3 -  Number: i0
.head 3 -  Number: i1
.head 3 -  Number: i2
.head 3 -  Number: i3
.head 3 -  Number: i4
.head 3 -  Number: i5
.head 3 -  Number: i6
.head 3 -  Number: i7
.head 3 -  Number: i8
.head 3 -  Number: i9
.head 3 -  Number: nCB
.head 3 -  Date/Time: dDATA
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set dDATA=GetBankDate()
.head 4 -  Set nOUR_RNK= SalStrToNumber( GetOurRnk())
.head 4 -  Set nKV=980
.head 4 -  Set CBA.strSqlInsert="INSERT INTO instrument 
(inst_num, 
 ACTIVE_FLAG, CB,  KV,  CTRY_ISSUE,
 CTRY_RISK, INST_CODE, ISSUE_DATE, RNK, 
 NAME, PRICE_MULT, SHRT_NAME,
 EX_DIV_FLAG, PAR_VALUE,  entry_date,ISSUE_PRICE
) 
VALUES 
(0, 'Y',:nCB,:CBA.KV, 804,  804, :CBA.inst_code, :CBA.DAT,"||GetOurRnk()||", 
 :CBA.NAME, 1, 'UF', 'N', :CBA.NOM100, :CBA.DAT ,100 * :CBA.RS1) "
.head 4 -  ! Call SalTblSetLockedColumns( hWndForm, 2)
.head 4 -  ! Call SalMapEnterToTab( TRUE )
.head 4 -  !
.head 4 -  Set CBA.strSqlUpdate=
"UPDATE instrument SET
   ISSUE_DATE  =:CBA.DAT,
   name        =:CBA.NAME, 
   par_value   =:CBA.NOM100, 
   inst_code   =:CBA.inst_code,
   ISSUE_PRICE =100 * :CBA.RS1 
WHERE inst_num =:CBA.inst_num "
.head 4 -  !
.head 4 -  Set CBA.strSqlDelete=
"DELETE from instrument 
WHERE inst_num=:CBA.inst_num and
     inst_num  not in (select inst_num from cb_acc ) "
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set NOM=NOM100/100
.head 4 +  If not SalIsNull(NOM) and NOM>0
.head 5 -  Set KOL=(SBUF+SCBB )/NOM
.head 5 +  If nCB=4
.head 6 +  If SBUF >0
.head 7 -  Set BS1= SPUF / (SBUF/NOM)
.head 6 +  If SCBB >0
.head 7 -  Set BS2= SCB6 / (SCBB/NOM)
.head 5 +  Else If nCB=2
.head 6 +  If SPUF >0
.head 7 -  Set BS1= SCBD / (SPUF/NOM)
.head 6 +  If SCB6 >0
.head 7 -  Set BS2= SCBE / (SCB6/NOM)
.head 6 +  If SPUF >0 or SCB6 >0
.head 7 -  Set CS1= SCB2 / ( ( SPUF+SCB6)/NOM)
.head 4 -  Call nF0 (SPUF)
.head 4 -  Call nF0 (SCB6)
.head 4 -  Call nF0 (SCB1)
.head 4 -  Call nF0 (SCBB)
.head 4 -  Call nF0 (SCB2)
.head 4 -  Call nF0 (SBUF)
.head 4 -  Call nF0 (RS1)
.head 4 -  Call nF0 (BS1)
.head 4 -  Call nF0 (BS2)
.head 4 -  Call nF0 (KOL)
.head 4 -  Call nF0 (SCBD)
.head 4 -  Call nF0 (SCBE)
.head 3 +  On UM_DoubleClick
.head 4 -  ! Call SalCreateWindow(CB2, hWndForm, hWndForm, pbRefresh,
inst_code,inst_num,DAT,NAME,KOL,SKUF,SPUF,SNUF,SP1,NOM)
.head 3 +  On UM_HotAccountList
.head 4 -  Call SalCreateWindow(frmOpAkciAcc,hWndForm,pbSwitch,pbRefresh,nCB,inst_num,SalStrToNumber(GetOurRnk()),'Текст')
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SalTblPopulate( hWndForm, cMain.hSql(), T(strSqlPopulate), TBL_FillAll )
.head 4 -  Call SalTblSetLockedColumns( hWndForm,6 )
.head 4 -  Call SalTblDefineSplitWindow( hWndForm, 0, FALSE )
.head 4 -  Call SalTblSetContext( hWndForm, 0 )
.head 4 -  Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_Destroy
.head 4 -  ! Disactivation of  function's role, which activated for calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(),' CB_1(hWndMDI,2) ')
.head 1 +  Table Window: CB1
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.23"
.head 4 -  Top:    0.358"
.head 4 -  Width:  12.286"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.823"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: &Операции
.head 4 -  Resource Id: 55434
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: UF&M.Оплата пошлины за регистрацию эмиссии
.head 5 -  Resource Id: 55435
.head 5 -  Keyboard Accelerator: F1
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
SRUF = NUMBER_Null and 
SKUF = NUMBER_Null 
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'7UF',ss,i0)
.head 7 -  Call F_VVOD( hWndForm, pbRefresh, 1,
'UFM',980,Str(inst_num),0,NOM,0,
ss, STRING_Null, STRING_Null, STRING_Null, STRING_Null,STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: UF&2.Получение разрешения на эмиссию
.head 5 -  Resource Id: 55436
.head 5 -  Keyboard Accelerator: F2
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and
SRUF = NUMBER_Null and 
SKUF = NUMBER_Null 
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'RUF',ss,i0)
.head 7 -  Call F_VVOD( hWndForm, pbRefresh,1,
'UF2',980,Str(inst_num),0,NOM,0,
ss, STRING_Null, STRING_Null, STRING_Null, STRING_Null,STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: UF&3.Оприходование бланков акций
.head 5 -  Resource Id: 55437
.head 5 -  Keyboard Accelerator: F3
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'AUF',ss,i1) 
.head 7 -  Call F_VVOD( hWndForm, pbRefresh,1,
'UF3',980,Str(inst_num),0,NOM,0,
ss, STRING_Null, STRING_Null, STRING_Null, STRING_Null,STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: UF&6.Отражение результатов эмиссии после регистрации
.head 5 -  Resource Id: 55438
.head 5 -  Keyboard Accelerator: F4
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
SNUF > 0 !! если есть взносы
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalModalDialog( CB_UF,hWndForm, pbRefresh, inst_code, inst_num, SKUF, SRUF, SNUF )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: U&F6.Анулирование выкупленных акций 
.head 5 -  Resource Id: 55439
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
SPUF > 0 !! если есть выкупленные акции
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If F_NLS0(nOUR_RNK,inst_code,inst_num,'BUF',ss,i0) and 
   F_NLS0(nOUR_RNK,inst_code,inst_num,'PUF',s1,i1) and 
   F_NLS0(nOUR_RNK,inst_code,inst_num,'KUF',s2,i2) and 
   F_NLS0(nOUR_RNK,inst_code,inst_num,'XUF',s3,i3) and 
   F_NLS0(nOUR_RNK,inst_code,inst_num,'CUF',s4,i4)    
.head 7 -  Call F_VVOD( hWndForm, pbRefresh,1,
'UFX',980,Str(inst_num), (i1*NOM/i0) *100,NOM,0, 
s2,s1,s3,ss,s2,s4,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: UF&1.Начисление дивидендов 
.head 5 -  Resource Id: 55440
.head 5 -  Keyboard Accelerator: F6
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
SKUF > 0
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalModalDialog( CB_UF2, hWndForm, pbRefresh, inst_code )
.head 5 -  Menu Item Name:
.head 4 +  ! Menu Item: &UF6.Индексация акций за счет прибыли
.head 5 -        Keyboard Accelerator: F7
.head 5 -        Status Text: 
.head 5 +        Menu Settings 
.head 6 -        Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
SKUF > 0
.head 6 -        Checked when: 
.head 5 +        Menu Actions 
.head 6 -        Call SalModalDialog( CB_UF3, hWndForm, pbRefresh, inst_code)
.head 5 -        Menu Item Name: 
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Выход
.head 5 -  Resource Id: 55442
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.686"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.886"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.286"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 55443
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.9"
.head 6 -  Begin Y:  -0.031"
.head 6 -  End X:  4.9"
.head 6 -  End Y:  0.427"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.486"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.443"
.head 6 -  Top:    0.063"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.186"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Tudasuda.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Состав '
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call TablePrint( hWndForm,'Акции банка',GetPrnDir()||'\\'|| SqlUser,'' )
.head 4 -  Line
.head 5 -  Resource Id: 55444
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.829"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  3.829"
.head 6 -  End Y:  0.458"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSwitch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.686"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Счета по учету акций'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call SalCreateWindow(frmOpAkciAcc,hWndForm,hWndForm,pbRefresh,CB,CB1.inst_num,SalStrToNumber(GetOurRnk()),' ')
.head 4 +  Pushbutton: pbDEPO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.786"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Депозитарий акционеров банка'
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow(CB3, hWndForm)
.head 4 -  Line
.head 5 -  Resource Id: 55445
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.986"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: inst_code
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
инстр.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.771"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Название
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
регистрации
Эмиссии
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Right
.head 4 -  Width:  1.033"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номи-
нал
1акции

.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.786"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set NOM100=NOM*100
.head 6 +  If not SalIsNull(NOM) and NOM>0
.head 7 -  Set KOL=SKUF/NOM
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: NOM100
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номинал
акции

.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.883"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SKUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 5000 - УФ
зарегистри-
рованный
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.25"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Кол-во
акций
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SPUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 3120 -
 Акции
на продажу
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SP1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Баланс.
стоимо-
сть 1 ак
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.886"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SBUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 9819 -
Выкуп-
ленные
акции
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SAUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 9820 -
Новые
бланки 
акций
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SNUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 3630 -
Взносы в
УФ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SDUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 3631 -
Невыплач. 
дивиденды
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.186"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SXUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 9812 -
Аннулиро-
ванные
акции
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SRUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 9811 -
Разрешения 
на выпуск
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SEUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 5010 -
Эмиссион.
 разницы
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.071"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: inst_num
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: CB
.head 2 +  Window Variables
.head 3 -  Number: nRNK
.head 3 -  Number: nOUR_RNK
.head 3 -  String: ss
.head 3 -  Number: nI
.head 3 -  !
.head 3 -  String: emis
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  String: s3
.head 3 -  String: s4
.head 3 -  Number: i0
.head 3 -  Number: i1
.head 3 -  Number: i2
.head 3 -  Number: i3
.head 3 -  Number: i4
.head 3 -  Number: i5
.head 3 -  Number: i6
.head 3 -  Number: i7
.head 3 -  Number: i8
.head 3 -  Number: i9
.head 3 -  Number: i10
.head 3 -  Date/Time: dDATA
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText( hWndForm, 'Акции банка')
.head 4 -  Set dDATA=GetBankDate()
.head 4 -  Set nOUR_RNK= SalStrToNumber( GetOurRnk())
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 2)
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  Set CB1.strSqlInsert=
   "INSERT INTO instrument (inst_num, 
 ACTIVE_FLAG, CB, KV, CTRY_ISSUE, CTRY_RISK, INST_CODE, ISSUE_DATE, RNK, 
  NAME, PRICE_MULT, SHRT_NAME, EX_DIV_FLAG,PAR_VALUE, entry_date) 
VALUES  (0, 
'Y', :CB1.CB, 980, 804, 804, :CB1.inst_code, :CB1.DAT,"||GetOurRnk()||", 
  :CB1.NAME, 1, 'UF', 'N', :CB1.NOM100, :CB1.DAT ) "
.head 4 -  !
.head 4 -  Set emis="(SELECT c.inst_num, 
 sum(decode(a.tip,'KUF', a.ostc,0))/100 s1, 
 sum(decode(a.tip,'DUF', a.ostc,0))/100 s2, 
 sum(decode(a.tip,'PUF',-a.ostc,0))/100 s3, 
 sum(decode(a.tip,'NUF', a.ostc,0))/100 s4, 
 sum(decode(a.tip,'EUF', a.ostc,0))/100 s5, 
 sum(decode(a.tip,'RUF',-a.ostc,0))/100 s6, 
 sum(decode(a.tip,'AUF',-a.ostc,0))/100 s7, 
 sum(decode(a.tip,'BUF',-a.ostc,0))/100 s8, 
 sum(decode(a.tip,'XUF',-a.ostc,0))/100 s9 
 FROM accounts a, cb_acc c  
 WHERE a.acc=c.acc  GROUP BY c.inst_num) "
.head 4 -  Set CB1.strSqlUpdate="UPDATE instrument SET 
   ISSUE_DATE=:CB1.DAT, 
   name=:CB1.NAME,  
   par_value=:CB1.NOM100,  
   inst_code=:CB1.inst_code  
WHERE cb=1 and inst_num=:CB1.inst_num "
.head 4 -  Set CB1.strSqlDelete=
"DELETE from instrument 
WHERE cb=:CB1.CB and inst_num=:CB1.inst_num and
     inst_num  not in (select inst_num from cb_acc ) "
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set NOM=NOM100/100
.head 4 +  If not SalIsNull(CB1.NOM) and  CB1.NOM>0
.head 5 -  Set KOL=SKUF/NOM
.head 4 +  If SBUF >0 and SPUF >0
.head 5 -  Set SP1= SPUF*NOM/SBUF
.head 4 -  Set i0=i0+1
.head 4 -  Set i1=i1+KOL
.head 4 -  Set i2=i2+SKUF
.head 4 -  Set i3=i3+SDUF
.head 4 -  Set i4=i4+SPUF
.head 4 -  Set i5=i5+SNUF
.head 4 -  Set i6=i6+SEUF
.head 4 -  Set i7=i7+SAUF
.head 4 -  Set i8=i8+SRUF
.head 4 -  Set i9=i9+SBUF
.head 4 -  Set i10=i10+SBUF
.head 4 -  Call nF0 (CB1.SEUF)
.head 4 -  Call nF0 (CB1.SNUF)
.head 4 -  Call nF0 (CB1.SPUF)
.head 4 -  Call nF0 (CB1.SDUF)
.head 4 -  Call nF0 (CB1.SKUF)
.head 4 -  Call nF0 (CB1.SRUF)
.head 4 -  Call nF0 (CB1.SAUF)
.head 4 -  Call nF0 (CB1.SBUF)
.head 4 -  Call nF0 (CB1.KOL)
.head 4 -  Call nF0 (CB1.SXUF)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set CB1.strSqlPopulate="
SELECT b.ISSUE_DATE, 
       b.name, 
       b.par_value, 
       k.s1, k.s2, k.s3, k.s4, k.s5, k.s6, k.s7, k.s8, k.s9, 
       b.inst_num, 
       b.inst_code 
FROM instrument b,"||emis|| " k 
WHERE b.cb=:CB1.CB and b.inst_num=k.inst_num (+) 
ORDER BY b.ISSUE_DATE, b.inst_num 
INTO :CB1.DAT, 
     :CB1.NAME,  
     :CB1.NOM100, 
     :CB1.SKUF,:CB1.SDUF,:CB1.SPUF,:CB1.SNUF,:CB1.SEUF,:CB1.SRUF,:CB1.SAUF,:CB1.SBUF,:CB1.SXUF, 
     :CB1.inst_num, 
     :CB1.inst_code "
.head 4 -  Call SalTblPopulate( hWndForm, cMain.hSql(), T(strSqlPopulate), TBL_FillAll )
.head 4 -  Call SalTblSetLockedColumns( hWndForm,4 )
.head 4 -  !
.head 4 -  Set i0=0
.head 4 -  Set i1=0
.head 4 -  Set i2=0
.head 4 -  Set i3=0
.head 4 -  Set i4=0
.head 4 -  Set i5=0
.head 4 -  Set i6=0
.head 4 -  Set i7=0
.head 4 -  Set i8=0
.head 4 -  Set i9=0
.head 4 -  Set i10=0
.head 4 -  !
.head 4 -  Call SalTblDefineSplitWindow( hWndForm, 0, FALSE )
.head 4 -  Call SalTblSetContext( hWndForm, 0 )
.head 4 -  Call SalTblDefineSplitWindow( hWndForm, 1, TBL_Split_Adjustable )
.head 4 -  Call SalTblFetchRow( hWndForm, SalTblInsertRow( hWndForm, TBL_MinSplitRow ) )
.head 4 -  Set inst_code= Str(i0)
.head 4 -  Set KOL =i1
.head 4 -  Set SKUF=i2
.head 4 -  Set SDUF=i3
.head 4 -  Set SPUF=i4
.head 4 -  Set SNUF=i5
.head 4 -  Set SEUF=i6
.head 4 -  Set SAUF=i7
.head 4 -  Set SRUF=i8
.head 4 -  Set SBUF=i9
.head 4 -  Set SXUF=i10
.head 4 -  Set NAME='Всего'
.head 4 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_New, FALSE,0,0 )
.head 4 -  Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On UM_DoubleClick
.head 4 -  If NAME='Всего'
.head 4 +  Else
.head 5 -  Call SalCreateWindow(CB2, hWndForm, hWndForm, pbRefresh,
inst_code,inst_num,DAT,NAME,KOL,SKUF,SPUF,SNUF,SP1,NOM)
.head 3 +  On SAM_Destroy
.head 4 -  ! Disactivation of  function's role, which activated for calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(),' CB_1(hWndMDI,1) ')
.head 1 +  Table Window: CB3
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Депозитаний акционеров банка
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.838"
.head 4 -  Top:    0.448"
.head 4 -  Width:  11.4"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.417"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 20000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.448"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.071"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.386"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.929"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 19958
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  0.01"
.head 6 -  End X:  Class Default
.head 6 -  End Y:  0.469"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.986"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.386"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.586"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Паспорт акционера'
.head 6 +  On SAM_Click
.head 7 +  If CB3.nTip=2
.head 8 -  Call EditCustCorps(CB3.RNK,CVIEW_ReadOnly | CVIEW_Accounts,hWndMDI)
.head 7 +  Else If CB3.nTip=3
.head 8 -  Call EditCustPerson(CB3.RNK,CVIEW_ReadOnly | CVIEW_Accounts,hWndMDI)
.head 7 +  Else If CB3.nTip=1
.head 8 -  Call EditCustBanks(CB3.RNK, CVIEW_ReadOnly | CVIEW_Accounts,hWndMDI)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.186"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call TablePrint( hWndForm,"Акционеры банка",GetPrnDir()||'\\'|| SqlUser,'' )
.head 4 -  Line
.head 5 -  Resource Id: 19959
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 19960
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.8"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.№
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: AG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Характеристика
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SKUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 5000 - УФ
зарегистри-
рованный
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S8UF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 8711 - 
номинал
Взносы в УФ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SNUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 3630 -
факт
Взносы в УФ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SDUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 3631 -
Невыплач.
дивиденды
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nTip
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.№
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nI
.head 3 -  String: emis
.head 3 -  Number: i0
.head 3 -  Number: i1
.head 3 -  Number: i2
.head 3 -  Number: i3
.head 3 -  Number: i4
.head 3 -  Number: i5
.head 3 -  Number: i6
.head 3 -  Number: OUR_RNK
.head 3 -  Number: RNK2
.head 3 -  String: ss
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  String: s3
.head 3 -  String: s4
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set OUR_RNK=SalStrToNumber( GetOurRnk())
.head 4 -  Set emis=" (SELECT r.rnk,
 sum(decode(a.tip,'KUF',a.ostc,0))/100 s1,
 sum(decode(a.tip,'NUF',a.ostc,0))/100 s2,
 sum(decode(a.tip,'DUF',a.ostc,0))/100 s3,
 sum(decode(a.tip,'8UF',a.ostc,0))/100 s4
 FROM accounts a, cb_acc c , cust_acc r
 WHERE a.acc=c.acc and 
       a.acc=r.acc and 
       a.tip in ('KUF','NUF','DUF','8UF')        
 GROUP BY r.rnk ) k "
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Set CB3.strSqlPopulate="
SELECT c.rnk,c.nmk,g.name,k.s1,k.s2,k.s3,k.s4,c.CUSTTYPE
INTO :CB3.RNK,:CB3.NMK,:CB3.AG,:CB3.SKUF,:CB3.SNUF,:CB3.SDUF,:CB3.S8UF,:CB3.nTip 
FROM customer c, CODCAGENT g,"||emis||" 
WHERE c.rnk=k.rnk and c.CODCAGENT=g.CODCAGENT       
ORDER BY 3, 4 desc, 5 desc , 6 desc"
.head 4 -  Set i0=0
.head 4 -  Set i1=0
.head 4 -  Set i2=0
.head 4 -  Set i3=0
.head 4 -  Set i4=0
.head 4 -  Set i5=0
.head 4 -  Call SalTblPopulate( hWndForm, cMain.hSql(), T(strSqlPopulate), TBL_FillAll )
.head 4 -  Call SalTblDefineSplitWindow( CB3, 1, TRUE )
.head 4 -  Call SalTblSetContext( CB3, SalTblInsertRow( CB3,  TBL_MinRow))
.head 4 -  Set RNK= i0
.head 4 -  Set SKUF=i2
.head 4 -  Set SDUF=i4
.head 4 -  Set SNUF=i3
.head 4 -  Set S8UF=i5
.head 4 -  Set NMK='Всего'
.head 4 -  Call SalTblSetFlagsAnyRows( CB3, ROW_New, FALSE,0,0 )
.head 4 -  Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set i0=i0+1
.head 4 -  Set i2=i2+SKUF
.head 4 -  Set i3=i3+SNUF
.head 4 -  Set i4=i4+SDUF
.head 4 +  If S8UF > 0
.head 5 -  Set i5=i5+S8UF
.head 4 -  Call nF0(SKUF)
.head 4 -  Call nF0(SNUF)
.head 4 -  Call nF0(SDUF)
.head 4 -  Call nF0(S8UF)
.head 4 +  If RNK=OUR_RNK
.head 5 -  Call SalTblSetCellTextColor(NMK, COLOR_Red, TRUE)
.head 3 -  On SAM_Destroy
.head 1 +  Table Window: CB2
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.213"
.head 4 -  Top:    0.083"
.head 4 -  Width:  11.957"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.429"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 20000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: &Операции
.head 4 -  Resource Id: 14273
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: UF&4.Продажа акций новой эмиссии
.head 5 -  Resource Id: 14274
.head 5 -  Keyboard Accelerator: F8
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
OUR_RNK != RNK and
F_NLS0(OUR_RNK,inst_code,inst_num,'AUF',s1,i0) and  i0 < 0 and 
F_NLS0(OUR_RNK,inst_code,inst_num,'8UF',s2,i0)  
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If OUR_RNK != RNK and
   F_NLS0(OUR_RNK,inst_code,inst_num,'AUF',s1,i0) and  
   F_NLS0(OUR_RNK,inst_code,inst_num,'8UF',s2,i0)  and 
   F_NLS0(RNK,inst_code,inst_num,'8UF',s3,i0) and
   F_NLS0(RNK,inst_code,inst_num,'NUF',ss,i0) 
.head 7 -  Call F_VVOD( hWndForm, pbRefresh,1,
'UF4',980,Str(inst_num),0, NOM,0, 
ss, STRING_Null, s1, s2, s3,STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: UF&8.Выкуп акций
.head 5 -  Resource Id: 14275
.head 5 -  Keyboard Accelerator: F9
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
OUR_RNK != RNK and SKUF != NUMBER_Null 
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If OUR_RNK != RNK and
   F_NLS0(OUR_RNK,inst_code,inst_num,'PUF',ss,i0) and 
   F_NLS0(OUR_RNK,inst_code,inst_num,'KUF',s2,i0) and 
   F_NLS0(RNK,    inst_code,inst_num,'KUF',s1,i0) and
   F_NLS0(OUR_RNK,inst_code,inst_num,'BUF',s3,i0) 
.head 7 -  Call F_VVOD( hWndForm, pbRefresh,1,
'UF8',980,Str(inst_num),0,NOM,0, 
ss, STRING_Null, s1, s2, s3,STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: UF&9.Перепродажа выкупленных акций
.head 5 -  Resource Id: 14276
.head 5 -  Keyboard Accelerator: F11
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
OUR_RNK != RNK and CENA>0
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If OUR_RNK != RNK and
   F_NLS0(OUR_RNK,inst_code,inst_num,'PUF',ss,i0)       and 
   F_NLS0(OUR_RNK,inst_code,inst_num,'KUF',s2,i0) and 
   F_NLS0(RNK,    inst_code,inst_num,'KUF',s1,i0)     and
   F_NLS0(OUR_RNK,inst_code,inst_num,'BUF',s3,i0)       and
   F_NLS0(OUR_RNK,inst_code,inst_num,'CUF',s4,i0)        
.head 7 -  Call F_VVOD( hWndForm, pbRefresh,1,
'UF9',980,Str(inst_num),CENA*100, NOM, 0,
ss, STRING_Null, s1, s2, s3, s4,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: UF&6.Перепродажа акций вне банка
.head 5 -  Resource Id: 14277
.head 5 -  Keyboard Accelerator: F12
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
OUR_RNK != RNK  and 
F_NLS0(RNK,inst_code,inst_num,'KUF',s1,i0) 
and i0 > 0  
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If OUR_RNK != RNK  and 
   F_NLS0(RNK,    inst_code,inst_num,'KUF',s1,i0) and   
   F_NLS0(OUR_RNK,inst_code,inst_num,'OUF',ss,i0)     
.head 7 -  Call SalModalDialog( CB_UF1,hWndForm, RNK, NMK, RNK2 )
.head 7 +  If RNK2 >0 and F_NLS0(RNK2,inst_code,inst_num,'KUF', s2, i0)
.head 8 -  Call F_VVOD( hWndForm, pbRefresh,1,
'UF0',980,Str(inst_num),0, NOM, 0,
ss, STRING_Null, s2, s1, STRING_Null, STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: UF&V.Выплата дивидендов
.head 5 -  Resource Id: 55431
.head 5 -  Keyboard Accelerator: F8
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and 
OUR_RNK != RNK and SDUF != NUMBER_Null
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If OUR_RNK != RNK and
   F_NLS0(RNK,inst_code,inst_num,'DUF',s1,i0) 
.head 7 -  Call F_VVOD( hWndForm, pbRefresh,1,
'UFV',980,Str(inst_num),i0, NOM, 0,
s1, STRING_Null, STRING_Null, STRING_Null, STRING_Null,STRING_Null,STRING_Null )      
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Выход
.head 5 -  Resource Id: 14278
.head 5 -  Keyboard Accelerator: F10
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.469"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Data Field: nRNK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.029"
.head 7 -  Top:    0.115"
.head 7 -  Width:  0.733"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  Call SqlPrepareAndExecute( hSql(),"
SELECT nmk INTO :sNMK from customer where rnk=:nRNK" )
.head 7 +  If SqlFetchNext( hSql(), nI )
.head 8 +  If SalMessageBox( "Открыть/Показать счета ?",
sNMK, MB_IconQuestion | MB_YesNo ) = IDYES
.head 9 -  Call RNK_NLS( 1, inst_num,nRNK,sNMK)
.head 7 +  Else
.head 8 -  Set sNMK='Не зарегистрирован !'
.head 7 -  Return VALIDATE_Ok
.head 4 +  Data Field: sNMK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.729"
.head 7 -  Top:    0.115"
.head 7 -  Width:  3.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.786"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalShowWindow(nRNK)
.head 7 -  Call SalShowWindow(sNMK)
.head 7 -  Call SalSetFocus( nRNK )
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.271"
.head 6 -  Top:    0.094"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.986"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.386"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14279
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  8.657"
.head 6 -  Begin Y:  0.01"
.head 6 -  End X:  8.657"
.head 6 -  End Y:  0.469"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 7015
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  9.329"
.head 6 -  Begin Y:  0.021"
.head 6 -  End X:  9.329"
.head 6 -  End Y:  0.479"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.586"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.257"
.head 6 -  Top:    0.094"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.786"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Паспорт акционера'
.head 6 +  On SAM_Click
.head 7 +  If CB2.nTip=2
.head 8 -  Call EditCustCorps(CB2.RNK,CVIEW_ReadOnly | CVIEW_Accounts,hWndMDI)
.head 7 +  Else If CB2.nTip=3
.head 8 -  Call EditCustPerson(CB2.RNK,CVIEW_ReadOnly | CVIEW_Accounts,hWndMDI)
.head 7 +  Else If CB2.nTip=1
.head 8 -  Call EditCustBanks(CB2.RNK, CVIEW_ReadOnly | CVIEW_Accounts,hWndMDI)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.186"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call TablePrint( hWndForm,NAME,GetPrnDir()||'\\'|| SqlUser,'' )
.head 4 -  Line
.head 5 -  Resource Id: 14280
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  6.671"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  6.671"
.head 6 -  End Y:  0.458"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.986"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14281
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.714"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  4.714"
.head 6 -  End Y:  0.458"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSwitch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.386"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call RNK_NLS( 1, inst_num,RNK,NMK)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Счета по учету акций'
.head 4 +  Data Field: CENA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.3"
.head 7 -  Top:    0.208"
.head 7 -  Width:  1.271"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Цена выкупа
.head 5 -  Resource Id: 14282
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.3"
.head 6 -  Top:    0.031"
.head 6 -  Width:  1.271"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: df4
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   12.183"
.head 7 -  Top:    0.071"
.head 7 -  Width:  0.5"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.№
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Количество
бланков
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет 
акционера
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SKUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 5000 - УФ
зарегистри-
рованный
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S8UF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 8711 - 
номинал
Взносы в УФ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SNUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 3630 -
факт
Взносы в УФ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SDUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 3631 -
Невыплач.
дивиденды
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nTip
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.№
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: RNK_NLS
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: CB
.head 5 -  Number: inst_num
.head 5 -  Number: RNK_
.head 5 -  String: NMK_
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalCreateWindow(frmOpAkciAcc,hWndForm, hWndForm, pbRefresh, CB, inst_num,RNK_,NMK_)
.head 2 +  Window Parameters
.head 3 -  Window Handle: WRG
.head 3 -  Window Handle: WR
.head 3 -  String: inst_code
.head 3 -  Number: inst_num
.head 3 -  Date/Time: DAT
.head 3 -  String: NAME
.head 3 -  Number: KOL1
.head 3 -  Number: SKUF1
.head 3 -  Number: SPUF1
.head 3 -  Number: SNUF1
.head 3 -  Number: SP1
.head 3 -  Number: NOM
.head 2 +  Window Variables
.head 3 -  Number: nI
.head 3 -  String: emis
.head 3 -  Number: i0
.head 3 -  Number: i1
.head 3 -  Number: i2
.head 3 -  Number: i3
.head 3 -  Number: i4
.head 3 -  Number: i5
.head 3 -  Number: i6
.head 3 -  Number: OUR_RNK
.head 3 -  Number: RNK2
.head 3 -  String: ss
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  String: s3
.head 3 -  String: s4
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalDisableWindow(WRG)
.head 4 -  Call SalSetWindowText( hWndForm, NAME)
.head 4 -  Set OUR_RNK=SalStrToNumber( GetOurRnk())
.head 4 -  Set emis=" (SELECT r.rnk,
 sum(decode(a.tip,'KUF',a.ostc,0))/100 s1,
 sum(decode(a.tip,'NUF',a.ostc,0))/100 s2,
 sum(decode(a.tip,'DUF',a.ostc,0))/100 s3,
 sum(decode(a.tip,'8UF',a.ostc,0))/100 s4
 FROM accounts a, cb_acc c , cust_acc r
 WHERE a.acc=c.acc and 
       a.acc=r.acc and 
       a.tip in ('KUF','NUF','DUF','8UF') and 
       c.inst_num="||Str(inst_num)||" 
 GROUP BY r.rnk ) k, 
 OUTER (SELECT rr.rnk,aa.nls
 FROM accounts aa, cb_acc cc , cust_acc rr
 WHERE aa.acc=cc.acc and aa.acc=rr.acc and aa.tip ='KUF' and
       cc.inst_num="||Str(inst_num)||" ) m "
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalHideWindow(nRNK)
.head 4 -  Call SalHideWindow(sNMK)
.head 4 -  Set CB2.strSqlPopulate="
SELECT c.rnk,c.nmk,m.nls,k.s1,k.s2,k.s3,k.s4 ,c.CUSTTYPE
INTO :CB2.RNK, :CB2.NMK, :CB2.NLS,:CB2.SKUF,:CB2.SNUF,
     :CB2.SDUF,:CB2.S8UF,:CB2.nTip
FROM customer c, "||emis||" 
WHERE c.rnk=k.rnk and c.rnk=m.rnk(+) 
ORDER BY 4 desc, 5 desc , 6 desc"
.head 4 -  Set i0=0
.head 4 -  Set i1=0
.head 4 -  Set i2=0
.head 4 -  Set i3=0
.head 4 -  Set i4=0
.head 4 -  Set i5=0
.head 4 -  Call SalTblPopulate( hWndForm, cMain.hSql(), T(strSqlPopulate), TBL_FillAll )
.head 4 -  Call SalTblDefineSplitWindow( CB2, 1, TRUE )
.head 4 -  Call SalTblSetContext( CB2, SalTblInsertRow( CB2,  TBL_MinRow))
.head 4 -  Set CB2.RNK= i0
.head 4 -  Set CB2.KOL =i1
.head 4 -  Set CB2.SKUF=i2
.head 4 -  Set CB2.SDUF=i4
.head 4 -  Set CB2.SNUF=i3
.head 4 -  Set CB2.S8UF=i5
.head 4 -  Set CB2.NMK='Всего'
.head 4 -  Call SalTblSetFlagsAnyRows( CB2, ROW_New, FALSE,0,0 )
.head 4 -  Call F_NLS0(OUR_RNK,inst_code,inst_num,'BUF',s3,i0)  
.head 4 -  Call F_NLS0(OUR_RNK,inst_code,inst_num,'PUF',s3,i1)  
.head 4 +  If i0 <0 and i1 <0
.head 5 -  Set CENA = i1*NOM/i0
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If NOM != NUMBER_Null and  NOM>0
.head 5 -  Set CB2.KOL=CB2.SKUF/NOM
.head 4 -  Set i0=i0+1
.head 4 -  Set i1=i1+KOL
.head 4 -  Set i2=i2+SKUF
.head 4 -  Set i3=i3+SNUF
.head 4 -  Set i4=i4+SDUF
.head 4 +  If S8UF > 0
.head 5 -  Set i5=i5+S8UF
.head 4 -  Call nF0(SKUF)
.head 4 -  Call nF0(SNUF)
.head 4 -  Call nF0(SDUF)
.head 4 -  Call nF0(S8UF)
.head 4 -  Call nF0(KOL)
.head 3 +  ! On UM_HotAccountList
.head 4 -            Call SalCreateWindow(frmOpAkciAcc,hWndForm,pbSwitch,1,CB2.EMI,lParam,'Текст')
.head 3 +  On SAM_Destroy
.head 4 -  Call SalEnableWindow(WRG)
.head 4 -  Call SalSendMsg( WR, SAM_Click, 0, 0 )
.head 1 +  Dialog Box: CB_UF1
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Перепродажа акций вне банка
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.625"
.head 4 -  Top:    0.99"
.head 4 -  Width:  7.317"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.012"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Продавец
.head 4 -  Resource Id: 52622
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: R1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: N1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Покупатель
.head 4 -  Resource Id: 36052
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.512"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: R2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.283"
.head 6 -  Top:    0.488"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlPrepareAndExecute( hSql(), "
SELECT nmk INTO :N2 FROM customer WHERE rnk=:R2")
.head 6 +  If not SqlFetchNext( hSql(), nI )
.head 7 -  Set R2=0
.head 7 -  Set N2='Отсутствует'
.head 6 -  Set RNK2=R2
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: N2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.383"
.head 6 -  Top:    0.488"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbEX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbEdit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выйти
.head 4 -  Window Location and Size
.head 5 -  Left:   2.483"
.head 5 -  Top:    0.821"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 3 +  Pushbutton: pbOK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbEdit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   1.3"
.head 5 -  Top:    0.833"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If R2 >0
.head 7 +  If SalMessageBox( N2,
" Покупатель ", MB_IconQuestion | MB_YesNo ) = IDYES
.head 8 -  Call SalEndDialog( hWndForm, 0 )
.head 6 +  Else
.head 7 -  Call SalMessageBox(N2 , DlgMSG_Error, MB_IconExclamation)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: RNK
.head 3 -  String: NMK
.head 3 -  Receive Number: RNK2
.head 2 +  Window Variables
.head 3 -  Number: nI
.head 3 -  !
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set R1=RNK
.head 4 -  Set N1=NMK
.head 1 +  Dialog Box: CB_UF3
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Индексация акций за счет прибыли, остающейся в распоряжении банка 
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.625"
.head 4 -  Top:    0.625"
.head 4 -  Width:  12.383"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.476"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: ВВЕДИТЕ :
.head 4 -  Resource Id: 534
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.383"
.head 5 -  Top:    0.262"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Дату начислений (включительно)
.head 4 -  Resource Id: 15197
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.157"
.head 5 -  Top:    0.781"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: dEMI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.283"
.head 6 -  Top:    0.738"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlPrepareAndExecute( hSqlAux2(),
"SELECT sum(a.ostc)/100  INTO :SKUF
 FROM cust_acc cu, accounts a, cb_acc c , instrument i
 WHERE cu.acc=a.acc and a.acc=c.acc and 
       c.inst_num = i.inst_num and 
       i.issue_date <=:dEMI and 
       i.cb= 1 and
       cu.rnk<>"||RNK_B||" and a.tip ='KUF' ") 
.head 6 +  If not SqlFetchNext( hSqlAux2(), nI ) or SKUF <=0
.head 7 -  Call SalMessageBox('НЕТ УФ !','Для индексации ',MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call SalSetFocus(NLSD)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: SKUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.786"
.head 6 -  Top:    0.738"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: VES
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.383"
.head 6 -  Top:    0.738"
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Лиц.счет (ДЕБЕТ) -
 Прибыль прошлого года или рез.фонды
.head 4 -  Resource Id: 535
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.262"
.head 5 -  Width:  4.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.726"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: NLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.383"
.head 6 -  Top:    1.405"
.head 6 -  Width:  2.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlPrepareAndExecute( hSql(),
"SELECT nms,ostc/100,pap  INTO :NMS, :nOSTC, :nPAP 
 FROM accounts  WHERE nls=:NLSD and kv=980")
.head 6 +  If not SqlFetchNext( hSql(), nI )
.head 7 -  Set NMS="Не найден !"
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call SalSetFocus(nS)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: NMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.383"
.head 6 -  Top:    1.762"
.head 6 -  Width:  6.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: nOSTC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.383"
.head 6 -  Top:    1.405"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Введите  УТВЕРЖДЕННУЮ  сумму индексации
.head 4 -  Resource Id: 36057
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    2.512"
.head 5 -  Width:  3.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.56"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Default
.head 3 +  Data Field: nS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    2.571"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SKUF !=NUMBER_Null and NLSD !=STRING_Null
.head 7 +  If nPAP=2 and nOSTC < nS
.head 8 -  Call SalMessageBox('НЕДОСТАТОЧНО средств на счете !','Для начисления дивидендов ',MB_IconStop)
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Set VES=nS / SKUF !! дивид. на 1 УФ
.head 6 -  Call SalSetFocus(pbOK)
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 +  Pushbutton: pbOK 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbEdit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.483"
.head 5 -  Top:    3.238"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SKUF =NUMBER_Null 
.head 7 -  Call SalSetFocus(dEMI)
.head 6 +  Else If NLSD =STRING_Null
.head 7 -  Call SalSetFocus(NLSD)
.head 6 +  Else
.head 7 +  If OPLATA ()
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SalMessageBox('Выплнен успешно','Проект проводок',MB_IconInformation)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalMessageBox('НЕУСПЕШНАЯ попытка !','Проект проводок',MB_IconStop)
.head 3 +  Pushbutton: pbEX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbEdit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выйти
.head 4 -  Window Location and Size
.head 5 -  Left:   5.983"
.head 5 -  Top:    3.238"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 2 +  Functions
.head 3 +  Function: OPLATA
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: SUM
.head 5 -  Number: nRef
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set AMFO=GetBankMfo()
.head 5 -  Set AQH=GetBankName()
.head 5 -  Set dDATA=GetBankDate()
.head 5 -  !
.head 5 -  Call SqlPrepareAndExecute( hSqlAux2(),
"SELECT a.nls, a.ostc 
 INTO :NLS,:OSTC 
 FROM cust_acc cu,  accounts a,  cb_acc c, instrument i
 WHERE cu.acc=a.acc and a.ostc >0 and a.acc=c.acc and 
        cu.rnk <> "||RNK_B||" and i.cb=1 and  
        c.inst_num = i.inst_num and 
        i.issue_date <=:dEMI and  
        a.tip='KUF' " )
.head 5 +  While SqlFetchNext( hSqlAux2(), nI )
.head 6 -  Set SUM=VES*OSTC
.head 6 +  If SUM > 1
.head 7 -  Set nRef=NUMBER_Null
.head 7 -  Call cDoc2.SetDoc( nRef, 'UF6', 1, 6, 'I', dDATA, dDATA, dDATA, dDATA,
 NLSD, NMS,  AMFO, '', 980, SUM, '', 
 NLS, "Акционер банка", AMFO, '', 980, SUM, '', 
 "Индексация акций", '' , GetIdOper(), '', NUMBER_Null, NUMBER_Null )
.head 7 -  ! Number: nRef     !! референс (NUMBER_Null для новых)
.head 7 -  ! String: sTT      !! Код операции
.head 7 -  ! Number: nDk      !! ДК (0-дебет, 1-кредит)
.head 7 -  ! Number: nVob     !! Вид обработки
.head 7 -  ! String: sNd      !! № док 
.head 7 -  ! Date/Time: dDoc  !! Дата док
.head 7 -  ! Date/Time: dPos  !! Дата ввода(поступления в банк)
.head 7 -  ! Date/Time: dVal1  !! Дата валютирования основной операции
.head 7 -  ! Date/Time: dVal2  !! Дата валютирования связаной операции
.head 7 -  ! String: sNls1     !! Счет-А
.head 7 -  ! String: sNam1     !! Наим-А
.head 7 -  ! String: sBank1    !! МФО-А
.head 7 -  ! String: sNb1      !! Наим банка-А(м.б. '')
.head 7 -  ! Number: nKv1      !! Код вал-А 
.head 7 -  ! Number: nS1       !! Сумма-А
.head 7 -  ! String: sOkpo1    !! ОКПО-А 
.head 7 -  ! String: sNls2     !! Счет-Б     
.head 7 -  ! String: sNam2     !! Наим-Б
.head 7 -  ! String: sBank2    !! МФО-Б
.head 7 -  ! String: sNb2      !! Наим банка-Б(м.б. '')
.head 7 -  ! Number: nKv2      !! Код вал-Б 
.head 7 -  ! Number: nS2       !! Сумма-Б
.head 7 -  ! String: sOkpo2    !! ОКПО-Б
.head 7 -  ! String: sNazn     !! Назначение пл
.head 7 -  ! String: sDrec     !! Доп реквизиты
.head 7 -  ! String: sOperId   !! Идентификатор ключа опрециониста
.head 7 -  ! Long String: lsSign !! ЭЦП опрециониста
.head 7 -  ! Number: nSk       !! СКП
.head 7 -  !
.head 7 -  ! Number: nPrty     !! Приоритет документа
.head 7 +  If not cDoc2.oDoc()
.head 8 -  Return FALSE
.head 5 -  Return SqlPrepareAndExecute( hSqlAux2(),
"UPDATE instrument SET par_value = par_value + par_value * :VES 
WHERE issue_date <=:dEMI and cb=1"  ) 
.head 2 +  Window Parameters
.head 3 -  Window Handle: WR
.head 3 -  String: inst_code
.head 2 +  Window Variables
.head 3 -  Number: nI
.head 3 -  Number: nPAP
.head 3 -  Number: nD
.head 3 -  : cDoc2
.head 4 -  Class: cDoc
.head 3 -  String: NLS
.head 3 -  Number: OSTC
.head 3 -  String: AMFO
.head 3 -  String: AQH
.head 3 -  Date/Time: dDATA
.head 3 -  String: RNK_B
.head 3 -  !
.head 2 +  Message Actions
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendMsg( WR, SAM_Click, 0, 0 )
.head 3 +  On SAM_Create
.head 4 -  Set RNK_B=GetOurRnk()
.head 1 +  Dialog Box: CB_UF2
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Начисление дивидентов по акциям
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.625"
.head 4 -  Top:    0.625"
.head 4 -  Width:  12.383"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.476"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Дату начислений (включительно)
.head 4 -  Resource Id: 536
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.76"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.313"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: dEMI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.383"
.head 6 -  Top:    0.738"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlPrepareAndExecute( hSqlAux2(),
"SELECT sum(a.ostc)/100  INTO :SKUF
 FROM cust_acc cu, accounts a, cb_acc c , instrument i
 WHERE cu.acc=a.acc and a.acc=c.acc and 
       c.inst_num = i.inst_num and 
       i.issue_date <=:dEMI and 
       i.cb= 1 and
       cu.rnk<>"||RNK_B||" and a.tip ='KUF' ") 
.head 6 +  If not SqlFetchNext( hSqlAux2(), nI ) or SKUF <=0
.head 7 -  Call SalMessageBox('НЕТ УФ !','Для начисления дивидендов ',MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call SalSetFocus(NLSD)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: SKUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.886"
.head 6 -  Top:    0.738"
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Лиц.счет (ДЕБЕТ) -
 Прибыль прошлого года или рез.фонды
.head 4 -  Resource Id: 537
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.262"
.head 5 -  Width:  4.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.726"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: NLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.383"
.head 6 -  Top:    1.405"
.head 6 -  Width:  2.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlPrepareAndExecute( hSql(),
"SELECT nms,ostc/100,pap  INTO :NMS, :nOSTC, :nPAP 
 FROM accounts  WHERE nls=:NLSD and kv=980")
.head 6 +  If not SqlFetchNext( hSql(), nI )
.head 7 -  Set NMS="Не найден !"
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call SalSetFocus(nS)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: NMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.383"
.head 6 -  Top:    1.762"
.head 6 -  Width:  6.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: nOSTC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.383"
.head 6 -  Top:    1.405"
.head 6 -  Width:  3.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Введите  УТВЕРЖДЕННУЮ  сумму дивидендов
.head 4 -  Resource Id: 538
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    2.512"
.head 5 -  Width:  3.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.56"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Default
.head 3 +  Data Field: nS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    2.571"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SKUF !=NUMBER_Null and NLSD !=STRING_Null
.head 7 +  If nPAP=2 and nOSTC < nS
.head 8 -  Call SalMessageBox('НЕДОСТАТОЧНО средств на счете !','Для начисления дивидендов ',MB_IconStop)
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Set VES=nS / SKUF !! дивид. на 1 УФ
.head 6 -  Call SalSetFocus(pbOK)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: VES
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.383"
.head 6 -  Top:    0.738"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbOK 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbEdit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.483"
.head 5 -  Top:    3.238"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SKUF =NUMBER_Null 
.head 7 -  Call SalSetFocus(dEMI)
.head 6 +  Else If NLSD =STRING_Null
.head 7 -  Call SalSetFocus(NLSD)
.head 6 +  Else
.head 7 +  If OPLATA ()
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SalMessageBox('Выплнен успешно','Проект проводок',MB_IconInformation)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call SalMessageBox('НЕУСПЕШНАЯ попытка !','Проект проводок',MB_IconStop)
.head 3 +  Pushbutton: pbEX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbEdit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выйти
.head 4 -  Window Location and Size
.head 5 -  Left:   5.983"
.head 5 -  Top:    3.238"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 3 -  Background Text: ВВЕДИТЕ :
.head 4 -  Resource Id: 539
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.383"
.head 5 -  Top:    0.262"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: OPLATA
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: inst_num
.head 5 -  Number: inst_num1
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set AMFO=GetBankMfo()
.head 5 -  Set AQH=GetBankName()
.head 5 -  Set dDATA=GetBankDate()
.head 5 -  Set RNK1=0
.head 5 -  Set inst_num1=0
.head 5 -  Call SqlPrepareAndExecute( hSqlAux2(),
"SELECT i.inst_num, i.inst_code, cu.rnk, a.nls, a.ostc, a.tip 
 INTO :inst_num,    :emi,        :RNK,   :NLS,  :OSTC,  :TIP 
 FROM cust_acc cu,  accounts a, cb_acc c, instrument i
 WHERE cu.acc=a.acc and 
        a.acc=c.acc and 
        cu.rnk <> "||RNK_B||" and i.cb=1 and  
        c.inst_num = i.inst_num and 
        i.issue_date <=:dEMI and 
        a.tip in('DUF','KUF') 
 ORDER BY i.inst_num, cu.rnk, a.tip " )
.head 5 +  While SqlFetchNext( hSqlAux2(), nI )
.head 6 +  If RNK1 != RNK  or inst_num1 != inst_num
.head 7 +  If not OPLATA1()
.head 8 -  Return FALSE
.head 7 -  Set RNK1=RNK
.head 7 -  Set inst_num1 = inst_num
.head 7 -  Set s3631=STRING_Null
.head 7 -  Set s5000=STRING_Null
.head 7 -  Set n5000=0
.head 6 +  If TIP='DUF'
.head 7 -  Set s3631=NLS
.head 6 +  If TIP='KUF'
.head 7 -  Set s5000=NLS
.head 7 -  Set n5000=OSTC
.head 5 -  Return OPLATA1()
.head 3 +  Function: OPLATA1
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean: ret
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: SUM
.head 5 -  Number: nRef
.head 4 +  Actions
.head 5 -  Set SUM=VES*n5000
.head 5 +  If RNK1=0 or n5000=0 or s5000=STRING_Null or SUM < 1
.head 6 -  Return TRUE
.head 5 +  If s3631=STRING_Null
.head 6 -  Call SalMessageBox("Эмиссия "||emi||". НЕ открыт счет 3631 акционера "||Str(RNK1) , DlgMSG_Error, MB_IconExclamation)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set nRef=NUMBER_Null
.head 5 -  Call cDoc2.SetDoc(
 nRef,'UF1',1,6,'D/'||Str(RNK1), dDATA,dDATA,dDATA,dDATA,
 NLSD,NMS,  AMFO,'',980,SUM,'', 
 s3631,"Начисленные дивиденды",AMFO,'',980,SUM,'',
 "Начисленные дивиденды",'',GetIdOper(), '',NUMBER_Null , NUMBER_Null)
.head 5 -  Return cDoc2.oDoc()
.head 2 +  Window Parameters
.head 3 -  Window Handle: WR
.head 3 -  String: inst_code
.head 2 +  Window Variables
.head 3 -  Number: nI
.head 3 -  Number: nPAP
.head 3 -  Number: nD
.head 3 -  : cDoc2
.head 4 -  Class: cDoc
.head 3 -  Number: RNK
.head 3 -  Number: RNK1
.head 3 -  String: NLS
.head 3 -  Number: OSTC
.head 3 -  String: TIP
.head 3 -  String: emi
.head 3 -  String: s5000
.head 3 -  Number: n5000
.head 3 -  String: s3631
.head 3 -  String: AMFO
.head 3 -  String: AQH
.head 3 -  Date/Time: dDATA
.head 3 -  String: RNK_B
.head 3 -  !
.head 2 +  Message Actions
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendMsg( WR, SAM_Click, 0, 0 )
.head 3 +  On SAM_Create
.head 4 -  Set RNK_B=GetOurRnk()
.head 1 +  Dialog Box: CB_UF
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ввод суммы для перекрытия 3630 -> 5000(+5010)
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.625"
.head 4 -  Top:    0.625"
.head 4 -  Width:  10.517"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.631"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Оплаченный зарегистрированный УФ
.head 4 -  Resource Id: 46090
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    0.095"
.head 5 -  Width:  5.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: KUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Факт. сумма взносов в незарег. УФ
.head 4 -  Resource Id: 46091
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    1.012"
.head 5 -  Width:  5.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: NUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    0.988"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Номин. сумма взносов в незарег. УФ
.head 4 -  Resource Id: 46092
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    1.345"
.head 5 -  Width:  5.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: UF8
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    1.321"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Полученные разрешения на эмиссию
.head 4 -  Resource Id: 46093
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    0.679"
.head 5 -  Width:  5.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Default
.head 3 +  Data Field: RUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    0.655"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Введите  УТВЕРЖДЕННУЮ  сумму результатов эмиссии 
.head 4 -  Resource Id: 46094
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.45"
.head 5 -  Top:    2.202"
.head 5 -  Width:  5.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.619"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: UUF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    2.238"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalEnableWindow(pbOK)
.head 6 +  If UUF >UF8
.head 7 -  Call SalDisableWindow(pbOK)
.head 7 -  Call SalMessageBox("Сумма взносов НЕДОСТАТОЧНА !" , DlgMSG_Error, MB_IconExclamation)
.head 6 +  If UUF >RUF
.head 7 -  Call SalDisableWindow(pbOK)
.head 7 -  Call SalMessageBox("Сумма разрешений НЕДОСТАТОЧНА !" , DlgMSG_Error, MB_IconExclamation)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Pushbutton: pbOK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbEdit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   5.483"
.head 5 -  Top:    2.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If OPLATA (inst_code,inst_num,UUF)
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalMessageBox('Выплнен успешно','Проект проводок',MB_IconInformation)
.head 7 -  Call SalEnableWindow(pbReport)
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Call SalMessageBox('НЕУСПЕШНАЯ попытка !','Проект проводок',MB_IconStop)
.head 3 +  Pushbutton: pbEX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbEdit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выйти
.head 4 -  Window Location and Size
.head 5 -  Left:   7.883"
.head 5 -  Top:    2.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 3 +  Pushbutton: pbReport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Печать
.head 4 -  Window Location and Size
.head 5 -  Left:   6.683"
.head 5 -  Top:    2.738"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F10
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\PRINT.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! вызов функции печати 
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set TIP=GetPrnDir()||"\\EM-"|| inst_code ||".rtf"
.head 6 -  ! Set strBind='REF,TT,NLSD,NLSK,S'
.head 6 -  Call SalReportPrintToFile(hWndForm,
GetTemplateDir()||"\\REP_CB_1.QRP", 
TIP ,
'REF,NLSD,NLSK,S', 'REF,NLSD,NLSK,S', 
1, RPT_PrintAll, 1, 1, TRUE, nI )
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 +  If SalMessageBox( "Желаете просмотреть файл отчета " || TIP || " в редакторе?",
"Отчет сформирован успешно!", MB_IconQuestion | MB_YesNo ) = IDYES
.head 7 -  ! Call SalLoadApp ( CDOC_RTFEditorProgram, TIP )
.head 7 -  Call SalLoadAppAndWait(GetEditorPath()||' '||TIP,3,nI)
.head 6 -  ! конец
.head 2 +  Functions
.head 3 +  Function: OBNUL
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set RNK1=RNK
.head 5 -  Set s3630=STRING_Null
.head 5 -  Set s8711=STRING_Null
.head 5 -  Set s5000=STRING_Null
.head 5 -  Set n3630=0
.head 5 -  Set n8711=0
.head 3 +  Function: OPLATA
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: inst_code
.head 5 -  Number: inst_num
.head 5 -  Number: UUF
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: RNK_B
.head 4 +  Actions
.head 5 +  If not F_NLS0(OUR_RNK,inst_code,inst_num,'RUF',s9811,nI) or
   not F_NLS0(OUR_RNK,inst_code,inst_num,'EUF',s5010,nI) or 
   not F_NLS0(OUR_RNK,inst_code,inst_num,'8UF',s87,nI) 
.head 6 -  Return FALSE
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set RNK1=0
.head 5 -  Set REF1=0
.head 5 -  Set RAB_UUF = UUF*100
.head 5 -  Set k3630="Незагер.УФ"
.head 5 -  Set k5000="Зарег.УФ"
.head 5 -  Set k8711="Проданные акции"
.head 5 -  Set AMFO=GetBankMfo()
.head 5 -  Set AQH=GetBankName()
.head 5 -  Set NAZN="Отражение резельтатов эмиссии"
.head 5 -  Set dDATA=GetBankDate()
.head 5 -  Set RNK_B=GetOurRnk()
.head 5 -  Call SqlPrepareAndExecute( hSqlAux2(),
"SELECT cu.rnk, a.nls, a.ostc, a.tip 
 INTO :RNK,:NLS,:OSTC,:TIP 
 FROM cust_acc cu, 
      accounts a, 
      cb_acc c
 WHERE cu.acc=a.acc and 
        a.acc=c.acc and 
        cu.rnk <> "||RNK_B||" and
        c.inst_num="||Str(inst_num)||" and 
       a.tip in('NUF','KUF','8UF') 
 ORDER BY cu.rnk, a.tip " )
.head 5 +  While SqlFetchNext( hSqlAux2(), nI )
.head 6 +  If RNK1 != RNK
.head 7 +  If not OPLATA1()
.head 8 -  Return FALSE
.head 7 -  Call OBNUL()
.head 6 +  If TIP='NUF'
.head 7 -  Set s3630=NLS
.head 7 -  Set n3630=OSTC
.head 6 +  If TIP='8UF'
.head 7 -  Set s8711=NLS
.head 7 -  Set n8711=OSTC
.head 6 +  If TIP='KUF'
.head 7 -  Set s5000=NLS
.head 5 -  Return OPLATA1()
.head 3 +  Function: OPLATA1
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean: ret
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: SUM
.head 5 -  Number: RAZ
.head 5 -  Number: nREF
.head 5 -  String: ND
.head 4 +  Actions
.head 5 +  If RAB_UUF =0 or RNK1=0 or n8711 = 0 or n3630 < n8711
.head 6 -  Return TRUE
.head 5 +  If s3630=STRING_Null or s8711=STRING_Null or s5000=STRING_Null
.head 6 +  If s3630=STRING_Null
.head 7 -  Call SalMessageBox("НЕ открыт счет 3630 акционера"||Str(RNK1) , DlgMSG_Error, MB_IconExclamation)
.head 6 +  If s8711=STRING_Null
.head 7 -  Call SalMessageBox("НЕ открыт счет 8711 акционера"||Str(RNK1) , DlgMSG_Error, MB_IconExclamation)
.head 6 +  If s5000=STRING_Null
.head 7 -  Call SalMessageBox("НЕ открыт счет 5000 акционера"||Str(RNK1) , DlgMSG_Error, MB_IconExclamation)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set SUM=SalNumberMin( RAB_UUF, n8711 )
.head 5 -  ! Call DebugN(RNK1)
.head 5 -  ! Call DebugN(SUM)
.head 5 -  Set ND=inst_code||'/'||Str(RNK1)
.head 5 -  ! D 3630k  - K 5000k
.head 5 -  Set nREF=NUMBER_Null
.head 5 -  Call cDoc2.SetDoc(
 nREF,'UF6',1,6,ND, dDATA,dDATA,dDATA,dDATA,
 s3630,k3630,AMFO,'',980,SUM,'', 
 s5000,k5000,AMFO,'',980,SUM,'',
 NAZN,'',GetIdOper(), '',NUMBER_Null, NUMBER_Null )
.head 5 +  If not cDoc2.oDoc()
.head 6 -  Return FALSE
.head 5 -  ! D 9910  -  K 9811b
.head 5 -  Set nREF = cDoc2.m_nRef
.head 5 -  Call cDoc2.SetDoc(
 nREF,'UF2',0,6,ND,dDATA,dDATA,dDATA,dDATA,
 s9811,AQH,AMFO,'',980, SUM, '',
 '',   AQH,AMFO,'',980, SUM, '',
 NAZN,'',GetIdOper(), '', NUMBER_Null, NUMBER_Null  )
.head 5 +  If not cDoc2.oDoc()
.head 6 -  Return FALSE
.head 5 -  ! D 8711k - K8711b
.head 5 -  Call cDoc2.SetDoc(
 nREF,'UF5',1,6,ND,dDATA,dDATA,dDATA,dDATA,
 s8711,k8711,AMFO,'',980, SUM,'',
 s87,  AQH,  AMFO,'',980, SUM, '',
 NAZN,'',GetIdOper(), '', NUMBER_Null, NUMBER_Null  )
.head 5 +  If not cDoc2.oDoc()
.head 6 -  Return FALSE
.head 5 -  ! D 3630k - K 5010b
.head 5 +  If SUM = n8711  and  n3630-n8711 > 0
.head 6 -  Set RAZ = n3630 - n8711
.head 6 -  Call cDoc2.SetDoc(
nREF,'UF7',1,6,ND,dDATA,dDATA,dDATA,dDATA,
s3630,k3630,AMFO,'',980, RAZ,'',
s5010,AQH,  AMFO,'',980, RAZ, '',
NAZN,'',GetIdOper(), '', NUMBER_Null, NUMBER_Null  )
.head 6 +  If not cDoc2.oDoc()
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Set RAB_UUF = RAB_UUF - n8711
.head 5 +  If REF1=0
.head 6 -  Set REF1=nREF
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Window Handle: WR
.head 3 -  String: inst_code
.head 3 -  Number: inst_num
.head 3 -  Number: SKUF
.head 3 -  Number: SRUF
.head 3 -  Number: SNUF
.head 2 +  Window Variables
.head 3 -  : cDoc2
.head 4 -  Class: cDoc
.head 3 -  Number: RNK
.head 3 -  Number: RNK1
.head 3 -  Number: OUR_RNK
.head 3 -  String: NLS
.head 3 -  Number: OSTC
.head 3 -  String: TIP
.head 3 -  String: s9811
.head 3 -  String: s87
.head 3 -  String: s5010
.head 3 -  String: s3630
.head 3 -  String: s5000
.head 3 -  String: s8711
.head 3 -  Number: n3630
.head 3 -  Number: n8711
.head 3 -  Number: nI
.head 3 -  String: k3630
.head 3 -  String: k5000
.head 3 -  String: k8711
.head 3 -  String: AMFO
.head 3 -  String: AQH
.head 3 -  String: NAZN
.head 3 -  Date/Time: dDATA
.head 3 -  Number: RAB_UUF
.head 3 -  !
.head 3 -  Number: REF1
.head 3 -  Number: REF
.head 3 -  String: NLSD
.head 3 -  String: NLSK
.head 3 -  Number: S
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set NUF=SNUF
.head 4 -  Set OUR_RNK=SalStrToNumber( GetOurRnk())
.head 4 -  Call SalDisableWindow(pbReport)
.head 4 -  Set RUF=SRUF
.head 4 -  Set KUF=SKUF
.head 4 -  Call F_NLS0(OUR_RNK,inst_code,inst_num,'8UF',s87,nI) 
.head 4 -  Set UF8=-nI/100
.head 4 -  Set UUF=SalNumberMin( UF8, RUF )
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendMsg( WR, SAM_Click, 0, 0 )
.head 3 +  On SAM_ReportStart
.head 4 -  Call SqlPrepareAndExecute( hSql(), T("
SELECT p.ref, a.nls , kontr_acc(p.ref,p.tt, - p.s) , p.s/100 
INTO   :REF, :NLSD, :NLSK, :S
FROM oper o, opldok p, accounts a 
WHERE o.ref >= :REF1 and a.nbs <8000 and 
      o.tt='UF6' and p.acc=a.acc and 
      o.ref=p.ref and  p.dk=0 ORDER BY 1,2 " ))
.head 3 +  On SAM_ReportFetchInit
.head 4 -  Return TRUE
.head 3 +  On SAM_ReportFetchNext
.head 4 -  Return SqlFetchNext( hSql(), nI)
.head 3 +  On SAM_ReportFinish
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Form Window: CB_VVOD
.head 2 -  Class: cDocW
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.4"
.head 4 -  Top:    0.792"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPayDoc
.head 5 -  Class Child Ref Key: 27
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.8"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrtDoc
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.371"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 57028
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  2.443"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  2.443"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 57029
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 57030
.head 5 -  Class Child Ref Key: 59
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfZn
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfOst
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewDoc
.head 5 -  Class Child Ref Key: 53
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewTTs
.head 5 -  Class Child Ref Key: 60
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  ! On SAM_Create
.head 7 -            Set strTip = 'Перейти к следующему документу выдачи'
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 62
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSaveKor
.head 5 -  Class Child Ref Key: 64
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbBALANS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.943"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If CB_VVOD.m_nRef > 0 
.head 8 -  ! Call DocViewListInt( " a.ref="||Str(CB_VVOD.m_nRef)," Введенный документ")
.head 8 -  ! Call ViewDoc1 (hWndForm, CB_VVOD.m_nRef, 'OPER', 2 )
.head 8 -  Call DocViewContentsEx( hWndMDI, CB_VVOD.m_nRef )
.head 4 +  Pushbutton: pbBCK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.514"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delete.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If CB_VVOD.m_nRef >0 
.head 8 +  If SalMessageBox( "Выполнить откат операции ?",
"Операция № референс="||Str(CB_VVOD.m_nRef), MB_IconQuestion | MB_YesNo ) = IDYES
.head 9 -  Call Pay_Bck( CB_VVOD.m_nRef, 5 ,'')
.head 4 +  Pushbutton: pbDocBal
.head 5 -  Class Child Ref Key: 72
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Background Text:
.head 5 -  Resource Id: 22710
.head 5 -  Class Child Ref Key: 75
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 22711
.head 5 -  Class Child Ref Key: 77
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbHotVytyag
.head 5 -  Class Child Ref Key: 138
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotFio
.head 5 -  Class Child Ref Key: 141
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotName
.head 5 -  Class Child Ref Key: 137
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbLocalD
.head 5 -  Class Child Ref Key: 148
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotOstat
.head 5 -  Class Child Ref Key: 150
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocW
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Combo Box: cmbVob
.head 4 -  Class Child Ref Key: 39
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text:
.head 4 -  Resource Id: 57023
.head 4 -  Class Child Ref Key: 36
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfNd
.head 4 -  Class Child Ref Key: 23
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfNd=sNd
.head 3 -  Background Text:
.head 4 -  Resource Id: 57024
.head 4 -  Class Child Ref Key: 37
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfDocD
.head 4 -  Class Child Ref Key: 22
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankA
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 50
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlat
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamA
.head 4 -  Class Child Ref Key: 7
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlatB
.head 4 -  Class Child Ref Key: 9
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbA
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.head 4 -  Class Child Ref Key: 13
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 6 +  If sTT2='UF8'
.head 7 -  Call CB_VVOD.UnHideIt( hWndItem )
.head 3 +  Data Field: dfPoluB
.head 4 -  Class Child Ref Key: 18
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbB
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 51
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsB
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPolu
.head 4 -  Class Child Ref Key: 17
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamB
.head 4 -  Class Child Ref Key: 16
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumA
.head 4 -  Class Child Ref Key: 20
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumB
.head 4 -  Class Child Ref Key: 21
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRat
.head 4 -  Class Child Ref Key: 57
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    1.417"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If ( CB_VVOD.sTT='UFX' and nCB=1) or 
   ( CB_VVOD.sTT='UF5' and nCB>1 )
.head 7 -  Set dfSumC=dfRat
.head 7 -  Set dfSumA=dfRat
.head 7 -  Set dfSumB=dfRat
.head 6 -  Return SalSendClassMessage(SAM_Validate, 0, 0)
.head 3 +  Data Field: dfSumC
.head 4 -  Class Child Ref Key: 44
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  ! If ( CB_VVOD.sTT='UFX' and nCB=1 ) 
.head 7 -     Call SalHideWindow( dfSumC )
.head 7 -     Call SalHideWindow( dfSumNC )
.head 6 +  If ( CB_VVOD.sTT='UFX' and nCB=1 ) or ( CB_VVOD.sTT='UF5' and nCB>1 )
.head 7 -  Call SalHideWindow( dfSumC )
.head 7 -  Call SalHideWindow( dfSumNC )
.head 6 +  Else If CB_VVOD.sTT='UF7' and nCB>1
.head 7 -  Set dfSumC=nSum_
.head 7 -  Call SalSendClassMessage(SAM_Validate, 0, 0)
.head 5 +  On SAM_Validate
.head 6 +  If SalSendClassMessage(SAM_Validate, 0, 0)=VALIDATE_Ok
.head 7 +  If nCB=1 and (CB_VVOD.sTT != 'UF9' and
              CB_VVOD.sTT != 'UFX' and    
                          nSum_ >0 and 
              dfSumC>nSum_/100 ) 
.head 8 -  Call SalMessageBox("Несоответствие сумм !" , DlgMSG_Error, MB_IconExclamation)
.head 7 +  If CB_VVOD.sTT = 'UF4'   and
   dfSumC != NUMBER_Null and dfRat  != NUMBER_Null and
   dfSumC < dfRat
.head 8 -  Call SalMessageBox("Несоответствие сумм !" , DlgMSG_Error, MB_IconExclamation)
.head 7 -  Return VALIDATE_Ok
.head 3 +  List Box: lb1
.head 4 -  Class Child Ref Key: 85
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfNazn
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfNazn = CB_VVOD.sTTN
.head 3 +  Data Field: dfSk
.head 4 -  Class Child Ref Key: 48
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1
.head 4 -  Class Child Ref Key: 25
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2
.head 4 -  Class Child Ref Key: 66
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 57025
.head 4 -  Class Child Ref Key: 10
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Frame
.head 4 -  Resource Id: 57026
.head 4 -  Class Child Ref Key: 45
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Frame
.head 4 -  Resource Id: 19957
.head 4 -  Class Child Ref Key: 88
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfOkpoA
.head 4 -  Class Child Ref Key: 139
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoB
.head 4 -  Class Child Ref Key: 140
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNA
.head 4 -  Class Child Ref Key: 135
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNB
.head 4 -  Class Child Ref Key: 122
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNomN
.head 4 -  Class Child Ref Key: 123
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNC
.head 4 -  Class Child Ref Key: 125
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSkN
.head 4 -  Class Child Ref Key: 115
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1N
.head 4 -  Class Child Ref Key: 116
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2N
.head 4 -  Class Child Ref Key: 131
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfD
.head 4 -  Class Child Ref Key: 132
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK
.head 4 -  Class Child Ref Key: 133
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUgrnt
.head 4 -  Class Child Ref Key: 130
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVytyagN
.head 4 -  Class Child Ref Key: 142
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquivN
.head 4 -  Class Child Ref Key: 144
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquiv
.head 4 -  Class Child Ref Key: 145
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLocDat
.head 4 -  Class Child Ref Key: 149
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocW
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: oDoc
.head 4 -  Description: Оплатить  документ с прибамбасами
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: FL
.head 5 -  Number: SUM_V !! Сумма выкупа
.head 5 -  Number: SUM_P !! Сумма перепродажи
.head 5 -  Number: MARZA
.head 5 -  String: sa_
.head 5 -  String: sb_
.head 4 +  Actions
.head 5 -  Set FL=FALSE
.head 5 -  ! Анулирование акций сэ
.head 5 +  If nCB =1 and CB_VVOD.sTT='UFX'
.head 6 -  Set SUM_V = ( CB_VVOD.m_nNom / (NOM*100) ) * nSum_  !! сумм выкупа
.head 6 -  Set CB_VVOD.A.S = SalNumberMin( SUM_V, CB_VVOD.m_nNom )
.head 6 -  Set CB_VVOD.B.S=CB_VVOD.A.S 
.head 6 -  Set MARZA = CB_VVOD.m_nNom - SUM_V
.head 6 +  If cDocW.oDoc()
.head 7 +  If SalNumberAbs( MARZA ) < 1 !! без маржи
.head 8 -  Set FL= TRUE
.head 7 +  Else !! с маржой
.head 8 +  If MARZA >0
.head 9 -  Set CB_VVOD.B.Nls=s4                                                                             
.head 9 -  Set CB_VVOD.A.S= MARZA 
.head 9 -  Set CB_VVOD.B.S= MARZA 
.head 8 +  Else
.head 9 -  Set CB_VVOD.A.Nls=s4                                                                                    
.head 9 -  Set CB_VVOD.A.S= - MARZA 
.head 9 -  Set CB_VVOD.B.S= - MARZA 
.head 8 -  Set FL= cDocW.oDoc()
.head 7 +  If FL
.head 8 -  Set CB_VVOD.m_sTT='UFY'
.head 8 -  Set CB_VVOD.A.Nls=s1
.head 8 -  Set CB_VVOD.B.Nls=s2
.head 8 -  Set CB_VVOD.A.S=CB_VVOD.m_nNom
.head 8 -  Set CB_VVOD.B.S=CB_VVOD.m_nNom
.head 8 -  Set FL= cDocW.oDoc()
.head 5 -  ! Перекладка Акций из портфеля в другой
.head 5 +  Else If nCB =4 and CB_VVOD.sTT='UF5'
.head 6 -  Set CB_VVOD.A.S=( CB_VVOD.m_nNom / (NOM*100) ) * nSum_ 
.head 6 -  Set CB_VVOD.B.S=CB_VVOD.A.S
.head 6 +  If cDocW.oDoc()
.head 7 -  Set CB_VVOD.A.Nls=s2                                                                                
.head 7 -  Set CB_VVOD.B.Nls=s1                                                                                
.head 7 -  Set CB_VVOD.A.S=CB_VVOD.m_nNom
.head 7 -  Set CB_VVOD.B.S=CB_VVOD.m_nNom
.head 7 -  Set FL= cDocW.oDoc()
.head 5 -  ! Перекладка Облигаций из портфеля в другой
.head 5 +  Else If nCB =2 and CB_VVOD.sTT='UF5'
.head 6 -  Set CB_VVOD.A.S= CB_VVOD.m_nNom 
.head 6 -  Set CB_VVOD.B.S= CB_VVOD.m_nNom 
.head 6 -  Set FL=cDocW.oDoc() 
.head 6 -  Set SUM_V = ( CB_VVOD.m_nNom / (NOM*100) ) * nSum_  !! неамортиз
.head 6 +  If FL and SalNumberAbs( SUM_V ) >=1
.head 7 -  Set CB_VVOD.m_sTT='UF6'
.head 7 +  If SUM_V >0 !! дисконт
.head 8 -  Set CB_VVOD.A.S=SUM_V
.head 8 -  Set CB_VVOD.B.S=SUM_V
.head 8 -  Set CB_VVOD.A.Nls=s1                                                                          
.head 8 -  Set CB_VVOD.B.Nls=s2                                                                                
.head 7 +  Else !! премия
.head 8 -  Set CB_VVOD.A.S=-SUM_V
.head 8 -  Set CB_VVOD.B.S=-SUM_V
.head 8 -  Set CB_VVOD.A.Nls=s2                                                                                
.head 8 -  Set CB_VVOD.B.Nls=s1                                                                                
.head 7 -  Set FL= cDocW.oDoc()
.head 5 -  ! Продажа Акций любых
.head 5 +  Else If (nCB=1 or nCB=4) and CB_VVOD.sTT='UF9' 
.head 6 -  Set SUM_V = ( CB_VVOD.m_nNom / (NOM*100) ) * nSum_  !! сумм выкупа
.head 6 -  Set SUM_P=CB_VVOD.A.S
.head 6 -  Set CB_VVOD.A.S = SalNumberMin( SUM_V, SUM_P )
.head 6 -  Set CB_VVOD.B.S = SalNumberMin( SUM_V, SUM_P )
.head 6 -  Set MARZA = SUM_P - SUM_V
.head 6 +  If cDocW.oDoc()
.head 7 +  If SalNumberAbs( MARZA ) < 1
.head 8 -  Set FL= TRUE
.head 7 +  Else
.head 8 +  If MARZA >0
.head 9 -  Set CB_VVOD.A.Nls=s4                                                                                    
.head 9 -  Set CB_VVOD.A.S=MARZA
.head 9 -  Set CB_VVOD.B.S=MARZA
.head 8 +  Else
.head 9 -  Set CB_VVOD.B.Nls=s4                                                                                    
.head 9 -  Set CB_VVOD.A.S = -MARZA
.head 9 -  Set CB_VVOD.B.S = -MARZA
.head 8 -  Set FL= cDocW.oDoc()
.head 7 +  If FL
.head 8 -  Set CB_VVOD.nDk = 0
.head 8 -  Set CB_VVOD.m_sTT='UF6'
.head 8 -  Set CB_VVOD.A.Nls=s1
.head 8 -  Set CB_VVOD.B.Nls=s2
.head 8 +  If nCB=1
.head 9 -  Set CB_VVOD.A.S=CB_VVOD.m_nNom
.head 9 -  Set CB_VVOD.B.S=CB_VVOD.m_nNom
.head 8 +  Else
.head 9 -  Set CB_VVOD.A.S=SUM_V
.head 9 -  Set CB_VVOD.B.S=SUM_V
.head 8 +  If cDocW.oDoc()
.head 9 -  Set CB_VVOD.m_sTT='UF3'
.head 9 -  Set CB_VVOD.A.Nls=s3
.head 9 -  Set CB_VVOD.B.Nls=''
.head 9 -  Set CB_VVOD.A.S=CB_VVOD.m_nNom
.head 9 -  Set CB_VVOD.B.S=CB_VVOD.m_nNom
.head 9 -  Set FL= cDocW.oDoc()
.head 5 -  ! Продажа  облигаций
.head 5 +  Else If nCB=2 and CB_VVOD.sTT='UF9'
.head 6 -  Set SUM_V=SalNumberMin( CB_VVOD.m_nNom, CB_VVOD.A.S )
.head 6 -  Set MARZA=CB_VVOD.m_nNom - CB_VVOD.A.S
.head 6 -  Set CB_VVOD.A.S =SUM_V
.head 6 -  Set CB_VVOD.B.S = SUM_V
.head 6 +  If cDocW.oDoc()
.head 7 -  Set FL= TRUE
.head 7 -  Set SUM_P = CB_VVOD.m_nNom / (NOM*100)   !! кол-во
.head 7 +  If SalNumberAbs( MARZA ) >= 1
.head 8 +  If MARZA >0
.head 9 -  Set CB_VVOD.B.Nls=s4                                                                                    
.head 9 -  Set CB_VVOD.A.S=MARZA
.head 9 -  Set CB_VVOD.B.S=MARZA
.head 8 +  Else
.head 9 -  Set CB_VVOD.A.Nls=s4                                                                                    
.head 9 -  Set CB_VVOD.A.S = -MARZA
.head 9 -  Set CB_VVOD.B.S = -MARZA
.head 8 -  Set FL= cDocW.oDoc()
.head 7 +  If FL
.head 8 -  Set CB_VVOD.m_sTT='UF6'
.head 8 -  Set SUM_V=nS2 * SUM_P !! стоимость по цене выкупа
.head 8 -  Set CB_VVOD.A.Nls=s1
.head 8 -  Set CB_VVOD.B.Nls=s2
.head 8 -  Set CB_VVOD.A.S=SUM_V
.head 8 -  Set CB_VVOD.B.S=SUM_V
.head 8 +  If cDocW.oDoc()
.head 9 -  Set CB_VVOD.m_sTT='UF3' !! внебаланс
.head 9 -  Set CB_VVOD.A.Nls=s3
.head 9 -  Set CB_VVOD.B.Nls=''
.head 9 -  Set CB_VVOD.A.S=CB_VVOD.m_nNom
.head 9 -  Set CB_VVOD.B.S=CB_VVOD.m_nNom
.head 9 -  Set FL= cDocW.oDoc()
.head 9 +  If FL and nSum_ != 0 !! неам дисконт-премия
.head 10 -  Set SUM_V =  nSum_ * SUM_P !! сумма неам дис-прем
.head 10 -  Set CB_VVOD.m_sTT='UF5'
.head 10 +  If SUM_V > 0 !! премия
.head 11 -  Set CB_VVOD.A.Nls=s4                                                                                    
.head 11 -  Set CB_VVOD.B.Nls=s5                                                                                    
.head 11 -  Set CB_VVOD.A.S=SUM_V
.head 11 -  Set CB_VVOD.B.S=SUM_V
.head 10 +  Else !! дисконт
.head 11 -  Set CB_VVOD.A.Nls=s5                                                                                    
.head 11 -  Set CB_VVOD.B.Nls=s4                                                                                    
.head 11 -  Set CB_VVOD.A.S= -SUM_V
.head 11 -  Set CB_VVOD.B.S= -SUM_V
.head 10 -  Set FL= cDocW.oDoc()
.head 5 -  ! Первичная Продажа акций cэ
.head 5 +  Else If nCB=1 and CB_VVOD.sTT='UF4' 
.head 6 +  If cDocW.oDoc()
.head 7 -  Set CB_VVOD.m_sTT='UF3'
.head 7 -  Set CB_VVOD.A.Nls=s1
.head 7 -  Set CB_VVOD.A.S=CB_VVOD.m_nNom
.head 7 -  Set CB_VVOD.B.S=CB_VVOD.m_nNom
.head 7 +  If cDocW.oDoc()
.head 8 -  Set CB_VVOD.m_sTT='UF5'
.head 8 -  Set CB_VVOD.A.Nls=s3
.head 8 -  Set CB_VVOD.B.Nls=s2
.head 8 -  Set FL= cDocW.oDoc()
.head 5 -  ! Выкуп акций cэ или Покупка ЦБ
.head 5 +  Else If CB_VVOD.sTT='UF8' 
.head 6 -  Set SUM_V=CB_VVOD.A.S 
.head 6 +  If dfBankB != GetBankMfo()
.head 7 -  Set CB_VVOD.m_sTT='UFM'
.head 6 -  Set FL=cDocW.oDoc()
.head 6 +  If FL and s1 != STRING_Null
.head 7 -  Set CB_VVOD.m_sTT='UF6'
.head 7 -  Set CB_VVOD.A.Nls=s1
.head 7 -  Set CB_VVOD.B.Nls=s2
.head 7 +  If nCB=1 !! собств акции
.head 8 -  Set CB_VVOD.A.S=CB_VVOD.m_nNom
.head 8 -  Set CB_VVOD.B.S=CB_VVOD.m_nNom
.head 7 +  If cDocW.oDoc()
.head 8 -  Set CB_VVOD.m_sTT='UF3'
.head 8 -  Set CB_VVOD.A.Nls=s3
.head 8 -  Set CB_VVOD.B.Nls=''
.head 8 -  Set CB_VVOD.A.S=CB_VVOD.m_nNom
.head 8 -  Set CB_VVOD.B.S=CB_VVOD.m_nNom
.head 8 -  Set FL= cDocW.oDoc()
.head 8 +  If FL and nCB=2 !! облигации
.head 9 -  Set MARZA = SUM_V - CB_VVOD.m_nNom 
.head 9 +  If SalNumberAbs( MARZA ) < 1 !! без маржи
.head 10 -  Set FL= TRUE
.head 9 +  Else
.head 10 -  Set CB_VVOD.m_sTT='UF8'
.head 10 +  If MARZA > 0 !! премия
.head 11 -  Set CB_VVOD.A.Nls=s4                                                                             
.head 11 -  Set CB_VVOD.B.Nls=sAccA                                                                          
.head 11 -  Set CB_VVOD.A.S= MARZA 
.head 11 -  Set CB_VVOD.B.S= MARZA 
.head 10 +  Else !! Дисконт
.head 11 -  Set CB_VVOD.A.Nls=sAccA                                                                                 
.head 11 -  Set CB_VVOD.B.Nls=s4                                                                                    
.head 11 -  Set CB_VVOD.A.S= - MARZA 
.head 11 -  Set CB_VVOD.B.S= - MARZA 
.head 10 -  Set FL= cDocW.oDoc()
.head 5 -  ! ВНЕ банка 
.head 5 +  Else If nCB=1 and CB_VVOD.sTT='UF0'
.head 6 -  Set sa_=CB_VVOD.A.Nls
.head 6 -  Set sb_=CB_VVOD.B.Nls
.head 6 -  Set MARZA=CB_VVOD.A.S
.head 6 -  Set CB_VVOD.m_sTT='UF6'
.head 6 -  Set CB_VVOD.A.Nls=s1
.head 6 -  Set CB_VVOD.B.Nls=s2
.head 6 -  Set CB_VVOD.A.S=CB_VVOD.m_nNom
.head 6 -  Set CB_VVOD.B.S=CB_VVOD.m_nNom
.head 6 +  If cDocW.oDoc()
.head 7 -  Set CB_VVOD.m_sTT='UF0'
.head 7 -  Set CB_VVOD.A.Nls=sa_
.head 7 -  Set CB_VVOD.B.Nls=sb_
.head 7 -  Set CB_VVOD.A.S=MARZA
.head 7 -  Set CB_VVOD.B.S=MARZA
.head 7 -  Set FL= cDocW.oDoc()
.head 5 -  ! Погашение обязательств ємитента АКЦИЙ
.head 5 +  Else If CB_VVOD.sTT='UFX' and nCB =4  !!
.head 6 -  !
.head 6 -  ! Call Debug(CB_VVOD.m_sTT)
.head 6 -  ! Call Debug(CB_VVOD.A.Nls)
.head 6 -  ! Call Debug(CB_VVOD.B.Nls)
.head 6 -  ! Call DebugN(CB_VVOD.A.S)
.head 6 -  ! Call DebugN(CB_VVOD.m_nDk)
.head 6 -  !
.head 6 +  If cDocW.oDoc()
.head 7 -  Set CB_VVOD.m_sTT='UF3'
.head 7 -  Set CB_VVOD.A.Nls=s2
.head 7 -  Set CB_VVOD.A.S=CB_VVOD.m_nNom
.head 7 -  Set CB_VVOD.B.S=CB_VVOD.m_nNom
.head 7 -  Set CB_VVOD.m_nDk = 0
.head 7 -  !
.head 7 -  ! Call Debug(CB_VVOD.m_sTT)
.head 7 -  ! Call Debug(CB_VVOD.A.Nls)
.head 7 -  ! Call Debug(CB_VVOD.B.Nls)
.head 7 -  ! Call DebugN(CB_VVOD.A.S)
.head 7 -  ! Call DebugN(CB_VVOD.m_nDk)
.head 7 -  !
.head 7 -  Set FL= cDocW.oDoc()
.head 7 +  ! If nSum_ < 0
.head 8 -     Set CB_VVOD.m_sTT='UFX'
.head 8 -     Set CB_VVOD.A.Nls=s1                                                                               
.head 8 -     Set CB_VVOD.B.Nls=sAccA                                                                          
.head 8 -     Set CB_VVOD.A.S= - nSum_
.head 8 -     Set CB_VVOD.B.S= - nSum_ 
.head 8 -  !
.head 8 -     Call Debug(CB_VVOD.m_sTT)
.head 8 -     Call Debug(CB_VVOD.A.Nls)
.head 8 -     Call Debug(CB_VVOD.B.Nls)
.head 8 -     Call DebugN(CB_VVOD.A.S)
.head 8 -     Call DebugN(CB_VVOD.B.S)
.head 8 -     Call DebugN(CB_VVOD.m_nDk)
.head 8 -  !
.head 8 -     Set FL= cDocW.oDoc()
.head 5 -  ! Погашение обязательств эмитента ОБЛИГАЦИЙ
.head 5 +  Else If CB_VVOD.sTT='UFX' and nCB =2 
.head 6 +  If cDocW.oDoc()
.head 7 -  Set CB_VVOD.m_sTT='UF3'
.head 7 -  Set CB_VVOD.A.Nls=s1
.head 7 -  Set CB_VVOD.m_nDk = 0
.head 7 -  Set FL= cDocW.oDoc()
.head 7 +  ! If nSum_ < 0
.head 8 -       Set CB_VVOD.m_sTT='UFX'
.head 8 -       Set CB_VVOD.A.Nls=s1                                                                               
.head 8 -       Set CB_VVOD.B.Nls=sAccA                                                                          
.head 8 -       Set CB_VVOD.A.S= - nSum_
.head 8 -       Set CB_VVOD.B.S= - nSum_ 
.head 8 -       Call Debug(CB_VVOD.m_sTT)
.head 8 -       Call Debug(CB_VVOD.A.Nls)
.head 8 -       Call Debug(CB_VVOD.B.Nls)
.head 8 -       Call DebugN(CB_VVOD.A.S)
.head 8 -       Call DebugN(CB_VVOD.m_nDk)
.head 8 -       Set FL= cDocW.oDoc()
.head 5 -  !
.head 5 +  Else !! Прочие одиночки
.head 6 -  Set FL=cDocW.oDoc()
.head 5 -  !
.head 5 +  If FL
.head 6 -  Call SalEnableWindow(pbBALANS)
.head 5 -  Return FL
.head 2 +  Window Parameters
.head 3 -  Window Handle: WRG
.head 3 -  Window Handle: WR
.head 3 -  Number: nCB
.head 3 -  String: sTT2
.head 3 -  Number: nKv
.head 3 -  String: sNd
.head 3 -  !
.head 3 -  Number: nSum_
.head 3 -  Number: NOM
.head 3 -  Number: nS2
.head 3 -  !
.head 3 -  String: sAccA !! Счет А главный
.head 3 -  String: sAccB !! Счет Б главный
.head 3 -  String: s1 !! Счет дополнительный 
.head 3 -  String: s2 !! Счет дополнительный 
.head 3 -  String: s3 !! Счет дополнительный 
.head 3 -  String: s4 !! Счет дополнительный 
.head 3 -  String: s5 !! Счет дополнительный 
.head 2 +  Window Variables
.head 3 -  String: sA
.head 3 -  String: sB
.head 3 -  ! Boolean: bU
.head 3 -  ! Number: nU
.head 3 -  ! Number: nSupro
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SalDisableWindow(WRG)
.head 4 -  Call SalDisableWindow(pbBALANS)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Choose
.head 4 -  ! !!
.head 4 -  Set CB_VVOD.sTT=sTT2
.head 4 -  Set CB_VVOD.nKvB_TT=nKv
.head 4 -  Set CB_VVOD.nKvA_TT=nKv
.head 4 -  Call SqlPrepareAndExecute(hSql(),T("
     SELECT t.name, 
            t.flags[38,38], 
            t.flags[10,10], 
            t.flags[61,61], 
            t.fli,
            t.flv,
            t.dk, 
            t.sk,
            t.flags[4,4],
            t.nlsb,
            t.nlsa,
            t.mfob,
            t.flags[59,59]
       INTO :CB_VVOD.sTTN, 
            :CB_VVOD.nFpy, 
            :CB_VVOD.nFsk, 
            :CB_VVOD.nFbk, 
            :CB_VVOD.nFli,
            :CB_VVOD.nFlv, 
            :CB_VVOD.nDk,
            :CB_VVOD.nSk_TT,
            :CB_VVOD.nFvD1,
            :CB_VVOD.sNlsB_TT,
            :CB_VVOD.sNlsA_TT,
            :CB_VVOD.sBankB_TT,
            :CB_VVOD.nFcb
       FROM tts t
       WHERE t.tt=:CB_VVOD.sTT"))
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 +  If not SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call SalMessageBox("Нет описана операция " || CB_VVOD.sTT, DlgMSG_Error, MB_IconExclamation)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 +  If sAccA !=STRING_Null
.head 5 -  Set CB_VVOD.sNlsA_TT=sAccA
.head 4 +  If sAccB != STRING_Null
.head 5 -  Set CB_VVOD.sNlsB_TT=sAccB
.head 4 -  !
.head 4 +  ! If CB_VVOD.sTT='UFX' and nCB >1 
.head 5 -     Set CB_VVOD.nFcb=0
.head 4 -  !
.head 4 +  Else If CB_VVOD.sTT='UF5' and nCB >1 
.head 5 -  Set CB_VVOD.nFcb=1
.head 4 -  !
.head 4 -  Call SalSetWindowText( hWndForm, 'Ввод документа - [ ' ||CB_VVOD.sTTN|| ' ]' )
.head 4 -  Call SalSendClassMessage(UM_Clear, 0, 0)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalMapEnterToTab( FALSE )
.head 4 -  Call SalEnableWindow(WRG)
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  Call SalSendMsg( WR, SAM_Click, 0, 0 )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor( FALSE )
.head 1 +  Table Window: frmOpAkciAcc
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.0"
.head 4 -  Top:    0.01"
.head 4 -  Width:  14.186"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.988"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? No
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Открыть/Подключить счета по учету акций'
.head 4 -  Line
.head 5 -  Resource Id: 55567
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call TablePrint( hWndForm,'',GetPrnDir()||'\\'|| SqlUser,'' )
.head 4 -  Line
.head 5 -  Resource Id: 55568
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 55569
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbPROC
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If colFlOp
.head 8 +  If colTip='CBD' or 
   colTip='CBE' or 
   colTip='PUF' or 
   colTip='CB6'
.head 9 -  Call SetProcPar(colAcc, colKv, STRING_Null, STRING_Null)
.head 8 +  ! Else If colTip = 'SP '
.head 9 -            Call SetProcPar(colAcc, colKv, sNlsSN8, sNlsSD8)
.head 8 +  ! Else If colTip = 'SL '
.head 9 -            Call SetProcPar(colAcc, colKv, '', '')
.head 8 -  ! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: colTip
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTipN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
Типа счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер счета
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsValidInteger(hWndItem)
.head 7 -  Call SalMessageBox("Нецифра в номере счета", "Ошибка", MB_IconExclamation)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Set colNls = KeyAccount(sBankMfo, colNls)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colLcv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
юта
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -            Call SqlPrepareAndExecute(hSql(), T("
       SELECT lcv,kv
       INTO :sTmp,:nKv
       FROM tabval
       ORDER  by kv
       DESC"))
.head 6 -            Set nTmp = 0
.head 6 -            Call SalArraySetUpperBound(mKv, 1, -1)
.head 6 -            Call SalListClear(hWndItem)
.head 6 +            While SqlFetchNext(hSql(), nFetchRes)
.head 7 -            Call SalListAdd(hWndItem, sTmp)
.head 7 -            Set mKv[nTmp] = nKv
.head 7 -            Set nTmp = nTmp+1
.head 5 +  ! On SAM_Validate
.head 6 -            Set nTmp = SalListQuerySelection(hWndItem)
.head 6 +            If nTmp >= 0
.head 7 -            Set colKv = mKv[nTmp]
.head 6 +            Else
.head 7 -            Set colKv = 0
.head 6 -            Return VALIDATE_Ok
.head 5 +  On SAM_Validate
.head 6 +  If SalIsValidInteger(hWndItem)
.head 7 -  Set sTmp = 'kv'
.head 6 +  Else
.head 7 -  Set sTmp = 'lcv'
.head 7 -  Set colLcv = SalStrUpperX(colLcv)
.head 6 -  Call SqlPrepareAndExecute(hSql(), "
       SELECT kv,lcv
       INTO :colKv,:colLcv
       FROM tabval
       WHERE " || sTmp || "=:colLcv")
.head 6 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox("Не найден код валюты " || colLcv,
      'Ошибка', MB_IconExclamation)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.543"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFlOp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Откр
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
ставка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 5
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Внетренний
№ счета
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOstc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
Дебет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты
Кредит
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDapp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
движения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDaos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
открытия
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDazs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
закрытия
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOrd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Порядок
сортировки
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Window Handle: hPb
.head 3 -  Window Handle: hPbREF
.head 3 -  Number: nCb   ! Вид ЦБ
.head 3 -  Number: nInst ! № инструмента
.head 3 -  Number: nRnk  ! Рег номер клиента
.head 3 -  String: CC_ID
.head 2 +  Window Variables
.head 3 -  String: sErrTxt
.head 3 -  String: sNlsSN
.head 3 -  String: sNlsSD
.head 3 -  String: sNlsSN8
.head 3 -  String: sNlsSD8
.head 3 -  String: sNbs
.head 3 -  String: sLcv
.head 3 -  Number: nAcc
.head 3 -  Number: nId
.head 3 -  Date/Time: dDat
.head 3 -  Number: nPap
.head 3 -  ! Для таблицы INT_RATES
.head 3 -  Number: nIr_C
.head 3 -  Number: nIr_D
.head 3 -  ! Для таблицы INT_ACC
.head 3 -  Number: nMetr
.head 3 -  Number: nBaseM
.head 3 -  Number: nBaseY
.head 3 -  Number: nFreq
.head 3 -  Boolean: bRat
.head 3 -  Number: nRow
.head 3 -  !
.head 3 -  ! Number: nRnk
.head 3 -  Number: nFetchRes
.head 3 -  Number: nTmp
.head 3 -  Number: n980
.head 3 -  String: sTmp
.head 3 -  Number: mMetr[*]
.head 3 -  Number: mBaseY[*]
.head 3 -  Number: mBaseM[*]
.head 3 -  Number: mFreq[*]
.head 3 -  !
.head 3 -  Number: nNd
.head 3 -  String: sFnls
.head 3 -  String: sSour
.head 3 -  Number: nKvD
.head 3 -  String: sBankMfo
.head 3 -  ! по эмиссии акций
.head 3 -  Date/Time: dDatE ! дата эмиссии
.head 3 -  String: sNam     ! наименование эмиссии
.head 3 -  Number: nNom     ! номинал
.head 3 -  !
.head 3 -  String: SELE1
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalDisableWindow(hPb)
.head 4 -  Set nFlags = GT_NoIns 
.head 4 -  Set nId = GetUserId()
.head 4 -  Set dDat = GetBankDate()
.head 4 -  Set sBankMfo = GetBankMfo()
.head 4 -  Set n980=GetBaseVal()
.head 4 +  If nRnk = SalStrToNumber(GetOurRnk())
.head 5 -  Set sTmp='0'
.head 4 +  Else
.head 5 -  Set sTmp='1'
.head 4 -  Call SqlPrepareAndExecute(hSql(), "
       SELECT i.ISSUE_DATE,i.NAME,i.PAR_VALUE
         FROM instrument i WHERE i.INST_NUM=:nInst 
         INTO :dDatE, :sNam, :nNom")
.head 4 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call SalMessageBox('Нет информации по инструменту №' ||
       SalNumberToStrX(nInst,0), 'Ошибка', MB_IconExclamation)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Return FALSE
.head 4 -  Set sFnls = 'N/A'
.head 4 -  Set sFnls = "'" || sFnls || "'"
.head 4 -  Set strSqlDelete="DELETE FROM cb_acc 
                  WHERE inst_num=:frmOpAkciAcc.nInst AND acc=:frmOpAkciAcc.colAcc" 
.head 4 -  Call SalSetWindowText(hWndForm,
      Str(nRnk)||' '||CC_ID||':'||sNam)
.head 4 -  Set SELE1="SELECT t.ord,t.tip,t.name,a.nls,a.kv,v.lcv,1,a.acc,a.ostc/100,
             a.dos/100,a.kos/100,a.dapp,a.daos,a.dazs,acrN.fproc(a.acc)
       INTO :frmOpAkciAcc.colOrd, :frmOpAkciAcc.colTip,
            :frmOpAkciAcc.colTipN,:frmOpAkciAcc.colNls,
            :frmOpAkciAcc.colKv,  :frmOpAkciAcc.colLcv,
            :frmOpAkciAcc.colFlOp,:frmOpAkciAcc.colAcc,
            :frmOpAkciAcc.colOstc,:frmOpAkciAcc.colDos,
            :frmOpAkciAcc.colKos, :frmOpAkciAcc.colDapp,
            :frmOpAkciAcc.colDaos,:frmOpAkciAcc.colDazs,:frmOpAkciAcc.colRat "
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set strSqlPopulate =SELE1 ||
   " FROM accounts a,cb_acc n, tips t, tabval v, cust_acc c
     WHERE n.inst_num=:frmOpAkciAcc.nInst AND
           a.acc=n.acc AND a.tip=t.tip AND a.kv=v.kv AND
           a.acc=c.acc AND c.rnk=:frmOpAkciAcc.nRnk
      UNION ALL
      SELECT t.ord,t.tip,t.name," || sFnls || ","||Str(n980)||",'',0,0,0,
             0,0,to_date(null),to_date(null),to_date(null),to_number(null) 
      FROM tips t
      WHERE t.tip NOT IN (
       SELECT a.tip FROM accounts a,cb_acc n,cust_acc c
        WHERE a.acc=n.acc AND n.inst_num=:frmOpAkciAcc.nInst AND
              a.acc=c.acc AND c.rnk=:frmOpAkciAcc.nRnk)
          AND t.tip IN
      (SELECT tip FROM cb_tip WHERE cb=:frmOpAkciAcc.nCb AND kod="||sTmp||")
      ORDER BY 1"
.head 4 -  Call SalTblPopulate( hWndForm, cMain.hSql(), T(strSqlPopulate), TBL_FillAll )
.head 4 -  Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On UM_Update
.head 4 -  Set nRow = TBL_MinRow
.head 4 -  Set sErrTxt = ''
.head 4 +  While SalTblFindNextRow(hWndForm, nRow, ROW_New | ROW_Edited, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow)
.head 5 -  ! If not colFlOp
.head 5 -  ! Call Debug(Str(nInst)||' '||
           Str(nTmp) ||' '||
           Str(nRnk) ||' '||
           colNls || ' ' ||
           Str(colKv) ||' '||
           colTipN || ' по '||sNam || ' ' ||
colTip || ' ' || Str(nId) || ' ' || Str(nAcc) )
.head 5 +  If not Op_Reg(0, nInst, nTmp, nTmp, nTmp, nRnk, colNls, colKv, colTipN ||
    ' по '||sNam, colTip, nId,nAcc)
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Call SalMessageBox('Невозможно откыть счет ' || colNls,
       'Ошибка', MB_IconExclamation)
.head 6 -  Break
.head 5 -  ! Call DebugN(nAcc)
.head 5 -  ! Call Debug(colTip)
.head 5 -  ! Call DebugN(nRnk)
.head 5 -  Set colFlOp = 1
.head 5 -  Call SqlPrepareAndExecute( hSql(),
 "UPDATE accounts SET tip=:colTip WHERE acc=:nAcc " )
.head 5 -  Call SqlPrepareAndExecute( hSql(),
 "UPDATE cust_acc SET rnk= :nRnk WHERE acc=:nAcc " )
.head 5 -  Set colAcc=nAcc
.head 4 -  Call SqlCommit(hSql())
.head 4 -  Call SalSendClassMessage(UM_Update, 0, 0)
.head 3 +  On UM_DoubleClick
.head 4 +  If colFlOp
.head 5 -  Call Show_Sal_Day(colAcc)
.head 3 +  On SAM_TblDoDetails
.head 4 +  If colFlOp
.head 5 -  Call SalEnableWindow(pbDetails)
.head 4 +  Else
.head 5 -  Call SalDisableWindow(pbDetails)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalEnableWindow(hPb)
.head 4 -  Call SalSendMsg( hPbREF, SAM_Click, 0, 0 )
.head 3 +  On SAM_FetchRowDone
.head 4 -  Call SalTblSetCellTextColor(colOstc, IifN(colOstc < 0, COLOR_Red,       COLOR_Blue), TRUE)
.head 4 -  Set colOstc = SalNumberAbs(colOstc)
.head 4 +  If colDazs 
.head 5 -  Call SalTblSetCellTextColor(colTipN, COLOR_Red, TRUE)
.head 5 -  Call SalTblSetCellTextColor(colNls,  COLOR_Red, TRUE)
.head 5 -  Call SalTblSetCellTextColor(colLcv,  COLOR_Red, TRUE)
.head 5 -  Call SalTblSetCellTextColor(colFlOp, COLOR_Red, TRUE)
.head 3 +  ! On SAM_ColumnSelectClick
.head 4 -            Call SalTblSortRows(hWndForm, SalTblQueryColumnID(
       SalNumberToWindowHandle(wParam)), TBL_SortIncreasing)
