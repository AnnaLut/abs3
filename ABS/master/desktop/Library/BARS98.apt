.head 0 +  Application Description: АБС БАРС98 starter application
(C) 1999-2003, Сыропоршнев Д.Л.
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B20000 002C000000020000 0003000000000000 0064020000FCFFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 00000000215C4261 727339385C526573 6F757263655C4943 4F5C526F6F746E6F
0020: 64652E69636F1A5C 4261727339385C42 494E5C6261727339 38636363322E6578
0040: 65165C4261727339 385C42494E5C4261 727339382E646C6C 165C426172733938
0060: 5C42494E5C426172 7339382E61706300 000101011B433A5C 576F726B5C44796E
0080: 4D656E75735C4261 727339382E72756E 1B433A5C576F726B 5C44796E4D656E75
00A0: 735C426172733938 2E646C6C1B433A5C 576F726B5C44796E 4D656E75735C4261
00C0: 727339382E617063 00000101011B433A 5C576F726B5C4479 6E4D656E75735C42
00E0: 61727339382E6170 641B433A5C576F72 6B5C44796E4D656E 75735C4261727339
0100: 382E646C6C1B433A 5C576F726B5C4479 6E4D656E75735C42 61727339382E6170
0120: 6300000101011B43 3A5C576F726B5C44 796E4D656E75735C 4261727339382E61
0140: 706C1B433A5C576F 726B5C44796E4D65 6E75735C42617273 39382E646C6C1B43
0160: 3A5C576F726B5C44 796E4D656E75735C 4261727339382E61 70630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: Constant.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  !
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: License.apd
.head 2 -  Dynalib: Verctrl.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: Ssplash.apd
.head 2 -  Dynalib: Dblogin.apd
.head 2 -  !
.head 2 -  Dynalib: Arms.apd
.head 2 -  Dynalib: Bankapi.apd
.head 2 -  Dynalib: BarsVega.apd
.head 2 -  Dynalib: CB_1.apd
.head 2 -  ! Dynalib: Cc_dd.apd   УБРАЛ   MIK
.head 2 -  Dynalib: Cc_doc.apd
.head 2 -  Dynalib: Cc_input.apd
.head 2 -  Dynalib: Chckinnr.apd
.head 2 -  Dynalib: Contract.apd
.head 2 -  ! Dynalib: Cr.apd      УБРАЛ   MIK
.head 2 -  Dynalib: Cus_ifc.apd
.head 2 -  Dynalib: Custacnt.apd
.head 2 -  Dynalib: Depo.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: ImpExp.apd
.head 2 -  Dynalib: Imex_dop.apd
.head 2 -  Dynalib: Impnal8.apd
.head 2 -  Dynalib: Fincalc.apd
.head 2 -  Dynalib: Figure.apd
.head 2 -  Dynalib: Flistapi.apd
.head 2 -  ! Dynalib: Geo_makv.apd
.head 2 -  Dynalib: Graf.apd
.head 2 -  Dynalib: Guisetup.apd
.head 2 -  Dynalib: Holiday.apd
.head 2 -  ! Dynalib: Klop_bob.apd
.head 2 -  ! Dynalib: Klop_tex.apd
.head 2 -  Dynalib: Mainmenu.apd
.head 2 -  Dynalib: Metabase.apd
.head 2 -  Dynalib: Nal_Dec.apd
.head 2 -  ! Dynalib: Nostro.apd  УБРАЛИ  MOM+NATA
.head 2 -  Dynalib: Otcn.apd
.head 2 -  Dynalib: Pb_1.apd
.head 2 -  Dynalib: Procapi.apd
.head 2 -  Dynalib: Registry.apd
.head 2 -  Dynalib: Referenc.apd
.head 2 -  Dynalib: Repbank.apd
.head 2 -  Dynalib: Rep_dku.apd
.head 2 -  Dynalib: Reports.apd
.head 2 -  Dynalib: Rnbufile.apd
.head 2 -  Dynalib: Security.apd
.head 2 -  Dynalib: Service.apd
.head 2 -  Dynalib: Swiftapi.apd
.head 2 -  Dynalib: Techsrv.apd
.head 2 -  Dynalib: Techbank.apd
.head 2 -  ! Dynalib: Um_i.apd     Убрал  MIK
.head 2 -  Dynalib: Um_o.apd
.head 2 -  Dynalib: V_balans.apd
.head 2 -  Dynalib: Zay.apd
.head 2 -  Dynalib: zayf.apd
.head 2 -  Dynalib: dcp.apd
.head 2 -  ! --Пустая
.head 2 -  Dynalib: Bars008.apd
.head 2 -  ! --Селекторы
.head 2 -  Dynalib: Bars000.apd
.head 2 -  ! --Пустая
.head 2 -  Dynalib: Bars001.apd
.head 2 -  ! --РКО+Регулярные платежи
.head 2 -  Dynalib: Bars002.apd
.head 2 -  ! --Пустая
.head 2 -  Dynalib: Bars003.apd
.head 2 -  ! --Пустая
.head 2 -  Dynalib: Bars004.apd
.head 2 -  ! --Пустая
.head 2 -  Dynalib: Bars005.apd
.head 2 -  ! --Депозиты Юр.Лиц
.head 2 -  Dynalib: Bars006.apd
.head 2 -  ! --Экспортно-Импортные контракты
.head 2 -  Dynalib: BARS007.APD
.head 2 -  ! --Овердрафты
.head 2 -  Dynalib: Bars009.apd
.head 2 -  ! --Проценты
.head 2 -  Dynalib: Bars010.apd
.head 2 -  ! --Ввод документов
.head 2 -  Dynalib: Bars011.apd       
.head 2 -  ! --S.W.I.F.T
.head 2 -  Dynalib: Bars013.apd       
.head 2 -  ! --СЕП НБУ
.head 2 -  Dynalib: Bars014.apd
.head 2 -  ! --Перекрытия/Расщепления сальдо счетов
.head 2 -  Dynalib: Bars015.apd
.head 2 -  ! --Вклады населения (после отладки) взамен Invest.apd
.head 2 -  Dynalib: Bars016.apd 
.head 2 -  Dynalib: BARS016f.apd
.head 2 -  Dynalib: Invest.apd
.head 2 -  ! --Внутренняя отчетность НБУ
.head 2 -  Dynalib: Bars018.apd
.head 2 -  ! --МВО (НБУ)
.head 2 -  Dynalib: Bars020.apd
.head 2 -  ! --Депозитные сейфы
.head 2 -  Dynalib: bars022.apd
.head 2 -  ! Казначейская
.head 2 -  Dynalib: Bars023.apd
.head 2 -  Dynalib: Bars024.apd
.head 2 -  Dynalib: Bars025.apd
.head 2 -  Dynalib: BARS026.apd
.head 2 -  ! ! ============================ Пустые ======
.head 2 -  Dynalib: BARS027.apd
.head 2 -  Dynalib: BARS028.apd
.head 2 -  Dynalib: BARS029.apd
.head 2 -  Dynalib: BARS030.apd
.head 2 -  Dynalib: BARS031.apd
.head 2 -  Dynalib: BARS032.apd
.head 2 -  Dynalib: BARS033.apd
.head 2 -  Dynalib: BARS034.apd
.head 2 -  Dynalib: BARS035.apd
.head 2 -  Dynalib: BARS036.apd
.head 2 -  Dynalib: BARS037.apd
.head 2 -  Dynalib: BARS038.apd
.head 2 -  ! Dynalib: BARS039.apd  УБРАЛИ  MOM+NATA
.head 2 -  Dynalib: BARS040.apd
.head 2 -  ! Управление филиалами By Ivan
.head 2 -  Dynalib: Branch.apd
.head 2 -  ! Интерфейс с процессинговым центром By Ivan
.head 2 -  Dynalib: OBANKPC.APD
.head 2 -  ! Автоматическая загрузка компонентов By Ivan
.head 2 -  Dynalib: Cbtodi.apd
.head 2 -  ! Работа с Реестром Должников
.head 2 -  Dynalib: debreg.APD
.head 2 -  !
.head 2 -  File Include: VTWIN.APL
.head 2 -  File Include: VTMENU.APL
.head 2 -  File Include: VTCOMM.APL
.head 2 -  ! File Include: Vtarray.apl
.head 2 -  File Include: Winapi.apl
.head 2 -  File Include: Watchdog.apc
.head 2 -  File Include: BarsNet.apc
.head 2 -  File Include: Genemnu.apl
.head 2 -  File Include: Gentimer.apl
.head 2 -  File Include: Genfcls.apl
.head 2 -  File Include: GENLABEL.APL
.head 2 -  File Include: Ttp32.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd/MM/yyyy
.head 3 -  Date/Time: dd/MM/yy
.head 3 -  Date/Time: dd-MM-yyyy
.head 3 -  Date/Time: dd-MM-yy
.head 3 -  Input: 99/99/9999
.head 2 +  External Functions
.head 3 +  Library name: seclogin.dll
.head 4 +  Function: DestroyAllBridges
.head 5 -  Description: int DestroyAllBridges() ! уничтожает все мосты в шлюзе
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 -  Parameters
.head 3 +  Library name: hooks.dll
.head 4 +  Function: GetLastInputTime
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 -  Parameters
.head 4 +  Function: EnablePrintScreen
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Number: INT
.head 4 +  Function: EnableCopyPasteKeys
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Number: INT
.head 3 +  ! Library name: hex2bin.dll
.head 4 +  Function: ConvertHexToBin
.head 5 -  Description: long ConvertHexToBin(
	char*	szSource,		// Исходная строка hex-цифр
	char*	szDest,			// приемный буфер.
	long	nDestLen );		// размер приемного буфера.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns 
.head 6 -  Number: LONG
.head 5 +  Parameters 
.head 6 -  String: LPCSTR
.head 6 -  String: LPSTR
.head 6 -  Number: LONG
.head 4 +  ! Function: ConvertBinToHex
.head 5 -  Description: void ConvertBinToHex(
	char*	szSource,		// Исходный сырой BLOB.
	char*	szDest,			// буфер для результирующей строки hex-цифр
	long	nSourceLen );	// размер исходного массива.
.head 5 -  Export Ordinal: 0
.head 5 -  Returns 
.head 5 +  Parameters 
.head 6 -  String: LPCSTR
.head 6 -  String: LPSTR
.head 6 -  Number: LONG
.head 4 +  ! Function: GetOffset
.head 5 -  Description: char* GetOffset(
char*	szSource,	// Исходный сырой BLOB.
long	nOffset	)	// смещение

.head 5 -  Export Ordinal: 0
.head 5 +  Returns 
.head 6 -  String: LPSTR
.head 5 +  Parameters 
.head 6 -  String: LPCSTR
.head 6 -  Number: LONG
.head 4 +  ! Function: ConcatBufs
.head 5 -  Description: char* ConcatBufs(char* szResult,
         const char* szBuf1,
	 unsigned long nSize1,
	 const char* szBuf2,
	 unsigned long nSize2)
.head 5 -  Export Ordinal: 0
.head 5 -  Returns 
.head 5 +  Parameters 
.head 6 -  String: LPSTR
.head 6 -  String: LPCSTR
.head 6 -  Number: LONG
.head 6 -  String: LPCSTR
.head 6 -  Number: LONG
.head 4 +  ! Function: NumPtr2HexStr
.head 5 -  Description: char* NumPtr2HexStr(unsigned int nNumPtr, unsigned int nBufSize)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns 
.head 6 -  String: LPSTR
.head 5 +  Parameters 
.head 6 -  Number: DWORD
.head 6 -  Number: DWORD
.head 4 +  ! Function: NumPtr2Str
.head 5 -  Description: char* NumPtr2Str(unsigned int nNumPtr)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns 
.head 6 -  String: LPSTR
.head 5 +  Parameters 
.head 6 -  Number: DWORD
.head 4 +  ! Function: InsertBuf
.head 5 -  Description: void InsertBuf(
char*szTarget,       // результирующий BLOB
longnTargetOffset,   // смещение в результирующем BLOBе
const char*szSource, // исходный сырой BLOB
longnSourceOffset,   // смещение в исходном BLOBеlong
nCopySize            // размер копируемого буфера)
.head 5 -  Export Ordinal: 0
.head 5 -  Returns 
.head 5 +  Parameters 
.head 6 -  Receive String: LPVOID
.head 6 -  Number: LONG
.head 6 -  String: LPVOID
.head 6 -  Number: LONG
.head 6 -  Number: LONG
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 4 -  ! ***** Version And Copyright Control *****
.head 4 -  String: BARS_FrontName = 'Барс "Millennium"'
.head 4 -  String: BARS_Version   = '3.877'
.head 4 -  String: BARS_Copyright = '1996-2006, "Унити-БАРС"'
.head 3 +  User
.head 4 -  ! Number: MDIMenu_PictureL1     = 114
.head 4 -  ! Number: MDIMenu_PictureL2     = 209
.head 4 -  ! Number: MDIMenu_PictureW1     = 306
.head 4 -  ! Number: MDIMenu_PictureW2     = 327
.head 4 -  String: INI_MainLayout       = 'Layout'
.head 4 -  ! String: VERSION_BARS98 = 'VERSION_BARS98__1.000000'
.head 2 +  Resources
.head 3 +  Bitmap: bmp1
.head 4 -  File Name: /Bars98/Resource/Bmp/P_red.bmp
.head 3 +  ! Bitmap: bmp2
.head 4 -  File Name: /Bars98/Resource/Bmp/P_yellow.bmp
.head 3 +  Bitmap: bmp3
.head 4 -  File Name: /Bars98/Resource/Bmp/P_green.bmp
.head 2 +  Variables
.data RESOURCE 0 0 1 4266152339
0000: 1E00000011000000 0000000000000000 02000001000000D1 000000E0010D0000
0020: 00FF3F
.enddata
.head 3 -  String: sBANKTYPE
.head 3 -  Date/Time: dtWBDate
.head 3 -  Number: nPeriodGlobal
.head 3 -  Number: nGP
.head 3 -  Number: nI_GP
.head 3 -  String: sGP1
.head 3 -  String: sGP2
.head 3 -  String: sGP3
.head 3 -  String: smGP[*,1:3]
.head 3 -  Boolean: fInitLib
.head 3 -  Boolean: bTOBO
.head 3 -  Boolean: bShowSqlError
.head 3 -  !
.head 3 -  Boolean: bAUTO
.head 3 -  Boolean: bNotifier_Recieve
.head 3 -  !
.head 3 -  Window Handle: hSW
.head 3 -  Number: nWait
.head 3 -  String: sUserTobo
.head 3 -  String: sChangePwd
.head 3 -  Number: nFetchRes
.head 2 +  Internal Functions
.head 3 +  Function: Bars98_Init
.head 4 -  Description: Инициализация лингвистической таблицы и прочего
для библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  !
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not fInitLib
.head 6 -  ! To set constraction mode uncomment below
.head 6 -  ! Set CurrentLangTable.fConstructMode = TRUE
.head 6 -  !
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars98.lng"
.head 6 -  !
.head 6 +  If (not strLangId) OR (not CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('cTInfo', 'Информация')
.head 7 -  Call CurrentLangTable.AddAtom('cTAt', 'Внимание!')
.head 7 -  Call CurrentLangTable.AddAtom('cTErr','Ошибка!')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAudit','Ошибка аудита')
.head 7 -  Call CurrentLangTable.AddAtom('cTBankDay', 'Банковский день')
.head 7 -  Call CurrentLangTable.AddAtom('cTBDClose', 'закрыт')
.head 7 -  Call CurrentLangTable.AddAtom('cTBDReopen','переключен')
.head 7 -  Call CurrentLangTable.AddAtom('cTBDOpen',  'открыт')
.head 7 -  Call CurrentLangTable.AddAtom('cTTech','Технолог')
.head 7 -  Call CurrentLangTable.AddAtom('cTAdm', 'АБС "БАРС"')
.head 7 -  Call CurrentLangTable.AddAtom('cTBankData','Банковская дата')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('cTStatusText1','Проверка синхронизации програмных файлов...')
.head 7 -  Call CurrentLangTable.AddAtom('cTStatusText2','Инициализация сетевого интерфейса...')
.head 7 -  Call CurrentLangTable.AddAtom('cTStatusText3','Проверка лицензионных параметров...')
.head 7 -  Call CurrentLangTable.AddAtom('cTStatusText4','Проверка целостности конфигурационного INI-файла...')
.head 7 -  Call CurrentLangTable.AddAtom('cTStatusText5','Установка рабочих параметров системы...')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrAudit',  'Невозможно установить связь с сервером аудита')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrIniFile','Нарушена целостность конфигурационного INI-файла комплекса')
.head 7 -  Call CurrentLangTable.AddAtom('cTErrSumm',   'или отсутствует контрольная сумма')
.head 7 -  Call CurrentLangTable.AddAtom('cTNeedChangePassword','Необходимо сменить пароль!')
.head 7 -  Call CurrentLangTable.AddAtom('cTQuitWithoutChangePassword','Без смены пароля вход в комплекс запрещен!')
.head 7 -  ! ====================================================
.head 7 -  Call CurrentLangTable.AddAtom('FunRunMenuItem.cTErrFuncRun','Ошибка при вызове функции!')
.head 7 -  Call CurrentLangTable.AddAtom('FunRunMenuItem.cTGotoAdmin','Обратитесь к Администратору АБС')
.head 7 -  Call CurrentLangTable.AddAtom('FunRunMenuItem.cTErrFuncWrite','Неправильно описана функция!')
.head 7 -  Call CurrentLangTable.AddAtom('StartChecking.cTMsgLic1','Истек срок действия лицензии!')
.head 7 -  Call CurrentLangTable.AddAtom('StartChecking.cTMsgLic2','Лицензирование!')
.head 7 -  Call CurrentLangTable.AddAtom('StartChecking.cTMsgLic3','Лицензия неверна или истек срок ее действия!')
.head 7 -  Call CurrentLangTable.AddAtom('StartChecking.cTMsgLic4','Срок действия лицензии истекает через')
.head 7 -  Call CurrentLangTable.AddAtom('StartChecking.cTMsgLic5','день')
.head 7 -  Call CurrentLangTable.AddAtom('StartChecking.cTMsgLic6','дня')
.head 7 -  Call CurrentLangTable.AddAtom('StartChecking.cTMsgLic7','дней')
.head 7 -  ! ====================================================
.head 7 -  ! winMain
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTWndTitle','АБС Барс "Millennium"')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu0','Режимы')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu1','Меню')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu2','Компонент')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu3','Инструментарий')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu4','Окна')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu5','Помощь')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu00','Меню приложений')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu01','Настройки')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu02','Войти под &другим именем')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu03','Поменять пароль...')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu04','Заблокировать рабочее место')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu05','Выход')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu10','Развернуть все')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu11','Развернуть секцию')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu12','Свернуть секцию')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu13','Свернуть все')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu14','Выполнить...')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu15','Установки')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu16','Вид')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu17','Закрыть меню')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu30','Просмотр счетов')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu31','Просмотр документов')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu32','Финансовый калькулятор')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu33','Расчет контрольного разряда Счета')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu34','Расчет контрольного разряда МФО')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu35','Расчет контрольного разряда ОКПО')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu36','Расчет эквивалента валют')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu37','Послать соо&бщение')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu38a',
     'Выключить &прием сообщений о изменении банковской даты')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu38b',
     'Включить &прием сообщений о изменении банковской даты')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTooltip38a',
     'Прием сообщений о изменении банковской даты включён')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTooltip38b',
     'Прием сообщений о изменении банковской даты выключен')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu41','Разместить &каскадом')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu42','Задать всем полный размер')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu43','Закрыть все')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu50','Общая справка')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu51','Контекстная справка')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu52','Кто я?')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu53','О Программе...')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu150','Авто&запуск при старте АБС')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu151','Использовать в меню большие значки')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu152','Автосохранение настроек')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu153','Сохранить настройки')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu160','Большие значки')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu161','Маленкие значки')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu162','Список')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTMenu163','Детально')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTErrMessLang','bars_msg.set_lang: Невозможно установить язык')
.head 7 -  ! ====================================================
.head 7 -  ! ElektroDocUser
.head 7 -  Call CurrentLangTable.AddAtom('winMain.F_ElektroDocUser.cTMessKlb','Имеются необработанные "электронные" документы (КЛИЕНТ-БАНК)')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.F_ElektroDocUser.cTMessKb3','Имеются необработанные "электронные" документы (ЗАЯВКИ НА КОНВЕРСИЮ)')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.F_ElektroDocUser.cTMessKb6','Имеются необработанные "электронные" документы (ЗАГРАНПЕРЕВОДЫ)')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.F_ElektroDocUser.cTMessKb7','Имеются необработанные "электронные" документы (ПЛ.ПОРУЧЕНИЯ в ИНВАЛЮТЕ)')
.head 7 -  ! ====================================================
.head 7 -  ! ElektroDocUserZaya
.head 7 -  Call CurrentLangTable.AddAtom('winMain.F_ElektroDocUserZaya.cTMessZaya','Имеются необработанные "электронные" документы (ЗАЯВКИ НА ПОКУПКУ/ПРОДАЖУ)')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.F_ElektroDocUserZaya.cTMessZayd','Имеются необработанные "электронные" документы (ЗАЯВКИ НА ОБЯЗАТЕЛЬНУЮ ПРОДАЖУ)')
.head 7 -  ! ====================================================
.head 7 -  ! MDIChangeLogin
.head 7 -  ! Call CurrentLangTable.AddAtom('winMain.F_MDIChangeLogin.cTQ1','Вы хотите завершить работу текущим пользователем и ' ||
'продолжить ее другим?')
.head 7 -  ! Call CurrentLangTable.AddAtom('winMain.F_MDIChangeLogin.cTQ2','Режимы')
.head 7 -  ! Call CurrentLangTable.AddAtom('winMain.F_MDIChangeLogin.cTToLog1','Банковская дата')
.head 7 -  ! Call CurrentLangTable.AddAtom('winMain.F_MDIChangeLogin.cTToLog2','Смена рабочего имени')
.head 7 -  ! ====================================================
.head 7 -  ! MDICheckVPSTransit
.head 7 -  Call CurrentLangTable.AddAtom('winMain.F_MDICheckVPSTransit.cTMess1','Поступили средства для подкрепления К/C ВПС')
.head 7 -  Call CurrentLangTable.AddAtom('winMain.F_MDICheckVPSTransit.cTMess2','Сумма')
.head 7 -  ! ====================================================
.head 7 -  ! MDIUnBundMsg
.head 7 -  Call CurrentLangTable.AddAtom('winMain.F_MDIUnBundMsg.cTMessSWIFT','Имеются неразобранные SWIFT сообщения')
.head 7 -  ! ====================================================
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('winMain.cTExit','Вы намерены прекратить работу?')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_KR
.head 7 -  Call CurrentLangTable.AddAtom('dlg_KR.cTWndTitleKRAcc', 'Расчет КР Счета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_KR.cTWndTitleKRMfo', 'Расчет КР МФО')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_KR.cTWndTitleKROkpo','Расчет КР ОКПО')
.head 7 -  ! Button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_KR.pbCalc','Рассчитать')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_KR.pbRef', 'Справочник')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_KR.pbExit','Выход')
.head 7 -  ! Constants
.head 7 -  Call CurrentLangTable.AddAtom('dlg_KR.cTMfo', 'МФО')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_KR.cTAcc', 'Счет')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_KR.cTOkpo','ОКПО')
.head 7 -  ! Error text
.head 7 -  Call CurrentLangTable.AddAtom('dlg_KR.cTErrData','Некорректно введены данные')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_Kurs
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Kurs.cTWndTitle','Расчет эквивалента валют')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Kurs.bgDat','Дата :')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Kurs.bgVal','Валюта :')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Kurs.bgSum','Сумма :')
.head 7 -  ! Button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Kurs.pbCalc','Рассчитать')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Kurs.pbExit','Выход')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_Lock
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Lock.cTWndTitle','Системная блокировка Рабочего Места')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Lock.bg1','Рабочее место заблокировано!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Lock.bg2','Оно может быть разблокировано пользователем')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Lock.bgPassword','Пароль:')
.head 7 -  ! Button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Lock.pbOK','Разблокировать!')
.head 7 -  ! Message
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Lock.cTMessOn', 'Включен режим блокировки рабочего места')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Lock.cTMessOff','Режим блокировки рабочего места снят')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Lock.cTMessPassword','Пароль указан неверно!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Lock.cTMessBlock',   'Ошибка при снятии блокировки рабочего места! Неверный пароль.')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_Passwd
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTWndTitle','Смена Пароля')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.bgPasswordNew2','Повторите новый пароль :')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.bgPasswordOld', 'Старый пароль :')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.bgPasswordNew', 'Новый пароль :')
.head 7 -  ! Button
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.pbCancel','Выход')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.pbOk','F10 - Сменить')
.head 7 -  ! Message
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTMessNumber','ЦИФРА в первом символе недопустима')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTMessPasswNotChange','Пароль НЕ изменился')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTMessPasswOld','Попытка смены пароля. Неверно введен старый пароль!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTMessErrPasswChange','Ошибка при смене пароля!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTMessPasswChangeOk','Успешная смена пароля для')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTMessPassswSave','Пароль успешно сменен. Запомните его!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTMessInputPasswOld','Введите старый пароль')
.head 7 -  ! Error
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTErrPassw1','Заполните поле пароль')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTErrPassw2','Повторите ввод пароля')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTErrPassw3','Новые пароли не совпадают!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTErrPassw4','Неверный пароль!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Passwd.cTErrPassw5','Операция по смене пароля выполнилась неуспешно!')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_WhoAmI
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.cTWndTitle','Информация о пользователе')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgPersonalStatus','Персональный статус ')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgABSId','ID в АБС:')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgLoginName','Рабочее имя:')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgRealName','Реальное имя:')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgPrivs','Привелегии:')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgWorkParams','Рабочие параметры ')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgDB','Рабочая БД:')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgDBMSType','Тип СУБД:')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgPrintDir','Каталог печати:')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgLic','Параметры лицензии')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgExpDate','Дата окончания лицензии:')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgLimitAccount','Лимит пользователей:')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgPermAccount','Постоянных пользователей:')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_WhoAmI.bgTempAccount','Временных пользователей:')
.head 7 -  ! ====================================================
.head 7 -  ! Call CurrentLangTable.SaveToFile('C:\\TEMP\\bars98.lng','RUS')
.head 7 -  !
.head 6 -  !
.head 6 -  Set fInitLib = TRUE
.head 5 -  Return fInitLib
.head 3 +  Function: FunRunMenuItem
.head 4 -  Description: Запустить выбраный пункт меню
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Sql Handle: hConnect
.head 5 -  Number: nOperId
.head 5 -  Number: nArmId
.head 4 +  Static Variables
.head 5 -  Number: nFetchRes
.head 4 +  Local variables
.head 5 -  String: strName
.head 5 -  String: strFuncName
.head 5 -  String: strRoleName
.head 5 -  !
.head 5 -  String: strR
.head 5 -  !
.head 5 -  Number: nRet
.head 5 -  String: sRet
.head 5 -  Window Handle: hRet
.head 5 -  Date/Time: dRet
.head 5 -  Number: nEvalErr
.head 5 -  Number: nEvalErrPos
.head 4 +  Actions
.head 5 -  ! Call Debug('nOperId=' ||Str(nOperId))
.head 5 -  ! Call Debug('nArmId=' ||Str(nArmId))
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call SetCodeApp(NumberToARMId(nArmId))
.head 5 -  Set strName     = ''
.head 5 -  Set strFuncName = ''
.head 5 -  Set strRoleName = ''
.head 5 -  Call SqlPrepareAndExecute(hConnect, "
     SELECT name, trim(substr(funcname,1,250)), rolename
     INTO   :strName, :strFuncName, :strRoleName
     FROM   operlist
     WHERE  codeoper=:nOperId")
.head 5 +  If SqlFetchNext(hConnect, nFetchRes)
.head 6 -  ! Call Debug('strFuncName=' ||strFuncName)
.head 6 +  If strRoleName != '' and strRoleName != STRING_Null
.head 7 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 8 -  Call XRoleSet(hConnect, strFuncName, strRoleName)
.head 7 +  Else
.head 8 -  ! Needs for Informix DS ver > 7.31
.head 8 -  ! No set autorization command in active transaction
.head 8 -  Set strR = 'SET ROLE ' || SalStrUpperX(strRoleName)
.head 8 -  Call SqlCommit(hConnect)
.head 8 -  Call SqlPrepareAndExecute(hConnect, strR)
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  ! Call Debug('strFuncName=' ||strFuncName)
.head 6 +  If strFuncName != ''
.head 7 -  Call SalCompileAndEvaluate(strFuncName, nEvalErr,
     nEvalErrPos, nRet, sRet, dRet, hRet, TRUE,
     SalContextCurrent())
.head 7 +  If nEvalErr != 0
.head 8 -  Set sRet = strFuncName || ' - ( ' ||
    SalNumberToStrX(nEvalErr, 0) || '@' ||
    SalNumberToStrX(nEvalErrPos, 0) || ' )'
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  ! Ошибка при вызове функции! Обратитесь к Администратору АБС
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FunRunMenuItem.cTErrFuncRun') || ' ' ||
     CurrentLangTable.GetAtomTitle('FunRunMenuItem.cTGotoAdmin') || PutCrLf() || sRet, 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop | MB_Ok)
.head 8 -  Return FALSE
.head 7 -  Call SaveInfoToLog("Вызвана функция: " || GetCodeApp() || " - " || strName)
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Call SalMessageBeep(MB_IconStop)
.head 7 -  ! Неправильно описана функция! Обратитесь к Администратору АБС
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('FunRunMenuItem.cTErrFuncWrite') || ' ' ||
     CurrentLangTable.GetAtomTitle('FunRunMenuItem.cTGotoAdmin'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop | MB_Ok)
.head 7 -  Return FALSE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return FALSE
.head 3 +  Function: FunRunInternalFunction
.head 4 -  Description: Запустить выбраный пункт меню
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sFuncName
.head 5 -  Number: nEvalErr
.head 5 -  Number: nEvalErrPos
.head 5 -  Number: nRet
.head 5 -  String: sRet
.head 5 -  Date/Time: dRet
.head 5 -  Window Handle: hRet
.head 4 +  Actions
.head 5 -  Set sFuncName = GetInternalFunctionName()
.head 5 +  If sFuncName
.head 6 -  Call SalCompileAndEvaluate(sFuncName, nEvalErr,
     nEvalErrPos, nRet, sRet, dRet, hRet, TRUE,
     SalContextCurrent())
.head 6 -  Return TRUE
.head 5 -  Return TRUE
.head 3 +  Function: StartChecking
.head 4 -  Description: Проверка лицензии, даты действия и прочего...
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nUsers
.head 5 -  Date/Time: dtExpDate
.head 5 -  !
.head 5 -  Boolean: fRet
.head 5 -  String: sD
.head 5 -  Number: nI
.head 5 -  Number: nLicenseCheckDay
.head 4 +  Actions
.head 5 -  Set fRet = TRUE
.head 5 -  Set nUsers = GetGlobalOptionEx('USRLIMIT')
.head 5 -  Set dtExpDate = SalFmtFormatStrDateTime(GetGlobalOption('EXPDATE'), 'dd/MM/yyyy')
.head 5 +  If dtExpDate < SalDateCurrent()
.head 6 -  Call SalMessageBeep(MB_IconStop)
.head 6 -  ! Истек срок действия лицензии, Bars: Лицензирование!
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('StartChecking.cTMsgLic1'), 
     'Bars: ' || CurrentLangTable.GetAtomTitle('StartChecking.cTMsgLic2'), MB_Ok)
.head 6 -  Set fRet = FALSE
.head 5 +  Else
.head 6 +  If not IsLicenseValid(GetBankMfo(), GetBankName(), nUsers, dtExpDate, FALSE)
.head 7 -  Call SalMessageBeep(MB_IconStop)
.head 7 -  ! Лицензия неверна или истек срок ее действия!, 'Bars: Лицензирование!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('StartChecking.cTMsgLic3'),
     'Bars: ' || CurrentLangTable.GetAtomTitle('StartChecking.cTMsgLic2'), MB_Ok)
.head 7 -  Set fRet = FALSE
.head 6 +  Else
.head 7 -  Set nLicenseCheckDay = GetGlobalOptionEx('LICCHDAY')
.head 7 -  Set nLicenseCheckDay = IifN(nLicenseCheckDay=0, 31, nLicenseCheckDay)
.head 7 +  If dtExpDate - SalDateCurrent() < nLicenseCheckDay
.head 8 -  Call SalMessageBeep(MB_IconStop)
.head 8 -  Set nI = Int(dtExpDate - SalDateCurrent())
.head 8 +  If Mod(nI, 10) = 1 and Mod(nI, 100) != 11
.head 9 -  ! день
.head 9 -  Set sD = CurrentLangTable.GetAtomTitle('StartChecking.cTMsgLic5')
.head 8 +  Else If (Mod(nI, 10) = 2 and Mod(nI, 100) != 12) or
        (Mod(nI, 10) = 3 and Mod(nI, 100) != 13) or
        (Mod(nI, 10) = 4 and Mod(nI, 100) != 14)
.head 9 -  ! дня
.head 9 -  Set sD = CurrentLangTable.GetAtomTitle('StartChecking.cTMsgLic6')
.head 8 +  Else
.head 9 -  ! дней
.head 9 -  Set sD = CurrentLangTable.GetAtomTitle('StartChecking.cTMsgLic7')
.head 8 -  ! Срок действия лицензии истекает через nI sD!, Bars: Лицензирование!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('StartChecking.cTMsgLic4') || ' ' || Str(nI) || ' ' || sD || '!', 
     'Bars: ' || CurrentLangTable.GetAtomTitle('StartChecking.cTMsgLic2'), MB_Ok)
.head 5 -  Return fRet
.head 3 +  Function: StartSetTobo
.head 4 -  Description: установки для TOBO
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetchRes
.head 5 -  String: sDat1
.head 5 -  String: sDat2
.head 5 -  String: sDatC
.head 5 -  String: sToboNot
.head 5 -  String: sTobo
.head 5 -  Date/Time: dDat1
.head 5 -  Date/Time: dDat2
.head 5 -  Number: nI
.head 5 -  !
.head 5 -  String: sHaveTobo
.head 4 +  Actions
.head 5 -  Set sHaveTobo = GetGlobalOption('HAVETOBO')
.head 5 +  If sHaveTobo = '2' or sHaveTobo = '1' or sHaveTobo = '0' or Len(sHaveTobo) = 0
.head 6 -  Set bTOBO = FALSE
.head 6 +  If nGP > 0
.head 7 -  Set nI_GP = 1
.head 7 +  While nI_GP <= nGP
.head 8 -  Set sGP1 = SalStrUpperX(smGP[nI_GP-1,1])
.head 8 +  If sGP1 = 'KOD_TOBO'
.head 9 -  Set bTOBO = TRUE
.head 8 -  Set sGP2 = smGP[nI_GP-1,2]
.head 8 -  Set sGP3 = smGP[nI_GP-1,3]
.head 8 +  If sGP1 = 'KOD_TOBO' and sHaveTobo = '2'
.head 9 -  ! для схемы HAVETOBO=2 ничего не делаем
.head 8 +  Else
.head 9 +  If not SqlPLSQLCommand(hSql(), "bars.pul.Set_Mas_Ini(sGP1,sGP2,sGP3)")
.head 10 -  Call SalQuit()
.head 8 -  Set nI_GP = nI_GP + 1
.head 6 +  If GetGlobalOption('HAVETOBO')='1' and not bTOBO
.head 7 -  ! устанавливаем стартовое значение ('0') TOBO в таблице STAFF ('Головной Банк')
.head 7 -  Call SetToboStart()
.head 6 -  ! здесь замена банковской даты для ТОБО (кроме исключений)
.head 6 -  Set sDatC = GetGlobalOption('TOBO_CHD')
.head 6 -  Set sToboNot = GetGlobalOption('TOBO_EXC')
.head 6 -  Set sTobo = GetValueStr("
    SELECT tobo
    FROM staff
    WHERE clsid<=0 and id=" || Str(GetUserId()))
.head 6 +  If Len(sDatC) > 0 and Len(sTobo) > 0
.head 7 -  Set nI = At(',', sDatC)
.head 7 +  If nI > 0
.head 8 -  Set sDat1 = SalStrTrimX(Left(sDatC, nI-1))
.head 8 -  Set sDat2 = SalStrTrimX(Right(sDatC, Len(sDatC)-nI))
.head 8 -  Set dDat1 = SalDateConstruct(Val(Subs(sDat1, 7, 4)), Val(Subs(sDat1, 4, 2)), Val(Left(sDat1, 2)), 0, 0, 0)
.head 8 -  Set dDat2 = SalDateConstruct(Val(Subs(sDat2, 7, 4)), Val(Subs(sDat2, 4, 2)), Val(Left(sDat2, 2)), 0, 0, 0)
.head 8 +  If dDat1 = GetBankDate() and sTobo != '0'
.head 9 +  If At(sTobo, sToboNot) = 0
.head 10 -  Set dtWBDate = dDat2
.head 10 -  Call SetWorkBankDate(dtWBDate)
.head 10 -  Call Pl_dat(dtWBDate)
.head 10 -  Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('cTBankData') || ' -> ' ||
     SalFmtFormatDateTime(dtWBDate, 'dd/MM/yyyy'))
.head 5 +  If GetGlobalOption('HAVETOBO')='2'
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   SELECT sys_context('bars_context','user_branch')
   INTO :sGP2
   FROM dual") and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set sGP1 = 'KOD_TOBO'
.head 7 -  Set sGP3 = 'код ТОБО (безбалансового отделения)'
.head 7 +  If not SqlPLSQLCommand(hSql(), "bars.pul.Set_Mas_Ini(sGP1,sGP2,sGP3)")
.head 8 -  Call SalQuit()
.head 6 +  Else
.head 7 -  Call SalQuit()
.head 3 +  Function: Wait
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nPeriod
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTemp
.head 5 -  Number: nBeg
.head 4 +  Actions
.head 5 -  ! Set nBeg = Val(SalFmtFormatDateTime(SalDateCurrent(), 'ddMMyyyyhhhhmmssmmmmmm'))
.head 5 -  Set nTemp = nPeriod
.head 5 +  While nTemp > 0
.head 6 -  Call SalNumberRandInit(0)
.head 6 -  Set nTemp = nTemp - 1
.head 5 -  ! Call SalMessageBox(Str(Val(SalFmtFormatDateTime(SalDateCurrent(), 'ddMMyyyyhhhhmmssmmmmmm'))-nBeg), ' time ' ||
     Str(nPeriod), MB_Ok)
.head 3 +  Function: CalcKR                        ! __exported
.head 4 -  Description: Пересчет контрольного разряда
( параметр = 0 - КР счета, 
             1 - КР МФО, 
             2 - КР ОКПО )
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nMode
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call SalCreateWindow( frm_KR, hWndForm, nMode )
.head 5 -  Call SalModalDialog( dlg_KR, hWndMDI, nMode )
.head 2 -  Named Menus
.head 2 +  Class Definitions
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: cPushButtonLabeled
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 +  Application Actions
.head 3 +  On SAM_AppStartup
.head 4 -  Set hSW = SplashOpenWindow()
.head 4 -  !
.head 4 -  Set bShowSqlError = TRUE
.head 4 -  !
.head 4 -  ! Инициализация начальных  параметров
.head 4 -  Call GetConfigSettings()
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Set nWait = SalGetProfileInt('Common Parameters', 'WAITS', 0, GetIniFileName())
.head 4 -  Set nWait = IifN(nWait<=0, 2/3, nWait) * 600000
.head 4 -  !
.head 4 -  Call Wait(nWait)
.head 4 -  !
.head 4 -  Call Bars98_Init()
.head 4 -  !
.head 4 -  ! Проверка синхронизации програмных файлов
.head 4 +  If GetFileCheckOn()
.head 5 -  ! Проверка синхронизации програмных файлов...
.head 5 -  Call SplashSetStatusText(CurrentLangTable.GetAtomTitle('cTStatusText1'))
.head 5 -  Call Wait(nWait)
.head 5 +  If not CheckOut()
.head 6 -  Call SalQuit()
.head 4 -  ! связь с сервером аудита
.head 4 +  If Audit_PutMsg('INFO', 'Run BARS Millennium') != 0
.head 5 -  ! Невозможно установить связь с сервером аудита, Ошибка аудита
.head 5 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTErrAudit'), 
     CurrentLangTable.GetAtomTitle('cTErrAudit'), MB_Ok|MB_IconStop)
.head 5 -  Call SalQuit()
.head 4 -  ! Инициализация сетевого интерфейса...
.head 4 -  Call SplashSetStatusText(CurrentLangTable.GetAtomTitle('cTStatusText2'))
.head 4 -  Call Wait(nWait)
.head 4 -  !
.head 4 -  Call SalHideWindow(hSW)
.head 4 +  If not DatabaseLogin(dtWBDate)
.head 5 -  Call SalQuit()
.head 4 -  !
.head 4 -  Set sBANKTYPE = GetGlobalOption('BANKTYPE')
.head 4 -  !
.head 4 -  Set sUserTobo = ''
.head 4 +  If GetGlobalOptionEx('HAVETOBO') = 2
.head 5 -  Call SqlPrepareAndExecute(hSql(),
"select tobo into :sUserTobo from staff where upper(logname)=user")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  !
.head 4 -  ! == не проверяем лицензию  для пользователя /
.head 4 -  If sUserTobo = '/' and GetGlobalOptionEx('/LIC') = 1
.head 4 +  Else
.head 5 +  If not StartChecking()
.head 6 -  Call SalQuit()
.head 4 -  ! ==
.head 4 -  !
.head 4 -  ! проверить CRC INI-файла, если установлен параметр CRCINI=1 в конфигурационных параметрах
.head 4 +  If GetGlobalOption('CRCINI')='1' and not IniCRCvalid()
.head 5 -  ! Нарушена целостность конфигурационного INI-файла комплекса (GetIniFileName() или отсутствует контрольная сумма (CRC) ...
.head 5 -  Set sGP1 = CurrentLangTable.GetAtomTitle('cTErrIniFile') || ' (' || GetIniFileName() || ') ' ||
    CurrentLangTable.GetAtomTitle('cTErrSumm') || ' (CRC) ...'
.head 5 -  Call SaveErrorToLog(sGP1)
.head 5 -  Call SalMessageBox(sGP1, CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconHand)
.head 5 -  Call SalQuit()
.head 4 -  !
.head 4 -  ! == не устанавливаем БД для пользователя /
.head 4 -  If sUserTobo = '/' and GetGlobalOptionEx('/BDATE') = 1
.head 4 +  Else
.head 5 -  Call SetWorkBankDate(dtWBDate)
.head 4 -  ! ==
.head 4 -  !
.head 4 -  ! == не устанавливаем локальнуюБД для пользователя /
.head 4 -  If sUserTobo = '/' and GetGlobalOptionEx('/LDATE') = 1
.head 4 +  Else
.head 5 -  Call Pl_dat(dtWBDate)
.head 4 -  ! ==
.head 4 -  !
.head 4 -  ! Банковская дата -> dtWBDate
.head 4 -  Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('cTBankData') || ' -> ' || SalFmtFormatDateTime(dtWBDate, 'dd/MM/yyyy'))
.head 4 -  !
.head 4 -  ! создать пул переменных ЛЮБЫХ (используя секцию [AnyParameters] INI-файла АБС)
.head 4 -  Set nGP = GetIniSection('AnyParameters', smGP)
.head 4 -  !
.head 4 -  Call StartSetTobo()
.head 4 -  !
.head 4 +  If GetGlobalOptionEx('CHGPWD')
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select substr(get_userpwd_change, 1, 30) into :sChangePwd from dual")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If sChangePwd = 'Y'
.head 6 -  ! Необходимо сменить пароль!
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTNeedChangePassword'), 
     CurrentLangTable.GetAtomTitle('cTInfo'), MB_IconAsterisk | MB_Ok)
.head 6 +  If not SalModalDialog(dlg_Passwd, hWndMDI)
.head 7 -  ! Без смены пароля вход в комплекс запрещен!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('cTQuitWithoutChangePassword'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 7 -  Call SalQuit()
.head 4 -  !
.head 4 -  Set bAUTO = Val(GetGlobalOption('KL_PAY'))=1
.head 4 -  Call SplashCloseWindow()
.head 4 +  If GetGlobalOption('PRNT_OFF') = '1'
.head 5 -  Call EnableCopyPasteKeys(TRUE)
.head 5 -  Call EnablePrintScreen(TRUE)
.head 4 -  !
.head 4 -  Call SalCreateWindow(winMain, hWndNULL)
.head 3 +  On SAM_AppExit
.head 4 +  If hSql()
.head 5 -  Call SaveInfoToLog(MSG_DisconnectDbs() || GetDbs())
.head 4 -  !
.head 4 +  If hSqlAux3()
.head 5 -  Call SqlDisconnect(hSqlAux3())
.head 4 +  If hSqlAux2()
.head 5 -  Call SqlDisconnect(hSqlAux2())
.head 4 +  If hSqlAux()
.head 5 -  Call SqlDisconnect(hSqlAux())
.head 4 +  If hSql()
.head 5 -  Call SqlDisconnect(hSql())
.head 4 -  !
.head 4 -  Call DBSpy_Disconnect()
.head 4 -  ! если работаем через шлюз ==> удалить все мосты
.head 4 +  If UseGateway()
.head 5 -  Call DestroyAllBridges()
.head 4 -  !
.head 4 +  If GetGlobalOption('PRNT_OFF') = '1'
.head 5 -  Call EnableCopyPasteKeys(FALSE)
.head 5 -  Call EnablePrintScreen(FALSE)
.head 3 +  On SAM_SqlError
.head 4 +  If bShowSqlError
.head 5 -  Call ShowSqlError(wParam, lParam)
.head 5 -  !
.head 5 -  Return FALSE
.head 1 +  MDI Window: winMain          ! Главное окно
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: АБС Барс "Millennium"
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.17"
.head 4 -  Top:    0.083"
.head 4 -  Width:  9.42"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.025"
.head 4 -  Height Editable? Yes
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Description: Окно верхнего уровня (многодокументное)
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: &Режимы
.head 4 -  Resource Id: 33899
.head 4 -  Enabled when:
.head 4 -  Status Text: Режимы работы системы
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Меню приложений
.head 5 -  Resource Id: 33900
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Главное меню комплекса
.head 5 +  Menu Settings
.head 6 -  Enabled when: not FunIsMenuActive()
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_MainMenu, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Настройки
.head 5 -  Resource Id: 33901
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Персональные настройки пользовтеля
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg( hWndMDI, UM_WinMenuAction, MDIMenu_Settings, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  ! Menu Item: Войти под &другим именем
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Закрыть все приложения и присоединится к базе под другим именем
.head 5 +  Menu Settings 
.head 6 -  Enabled when: 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_ChangeName, 0)
.head 5 -  Menu Item Name: 
.head 4 +  Menu Item: &Поменять пароль...
.head 5 -  Resource Id: 33903
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: SalStrUpperX(GetDBMS()) = 'ORACLE' and not UseGateway()
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_ChangePasswd, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Заблокировать рабочее место
.head 5 -  Resource Id: 9179
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_LockStation, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: В&ыход
.head 5 -  Resource Id: 33904
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Завершение работы приложения
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsgToChildren(hWndMDI, SAM_Close, 0, 0)
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_Exit, 0)
.head 5 -  Menu Item Name:
.head 3 +  Popup Menu: &Меню
.head 4 -  Resource Id: 33905
.head 4 -  Enabled when: FunIsMenuActive()
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Развернуть все
.head 5 -  Resource Id: 33906
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuExpandA, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Р&азвернуть секцию
.head 5 -  Resource Id: 33907
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuExpand, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: С&вернуть секцию
.head 5 -  Resource Id: 33908
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuCollapse, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Свернуть все
.head 5 -  Resource Id: 33909
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuCollapseA, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Выполнить...
.head 5 -  Resource Id: 33910
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuExecute, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Popup Menu: Выбор базы
.head 5 -  Resource Id: 16614
.head 5 -  Enabled when: bUseArchiveSchem
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: Оперативная база
.head 6 -  Resource Id: 16616
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: fWorkDB
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction,MDIMenu_MenuChangeDB, 0)
.head 7 -  Set fWorkDB = not fWorkDB
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Архивная база
.head 6 -  Resource Id: 16615
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: not fWorkDB
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_MenuChangeDB, 1)
.head 7 -  Set fWorkDB = not fWorkDB
.head 6 -  Menu Item Name:
.head 4 +  Popup Menu: &Установки
.head 5 -  Resource Id: 33911
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: Авто&запуск при старте АБС
.head 6 -  Resource Id: 33912
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: fMenuAutoStart
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuAutoStart, 0)
.head 7 -  Set fMenuAutoStart = not fMenuAutoStart
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Использовать в меню большие значки
.head 6 -  Resource Id: 33913
.head 6 -  Keyboard Accelerator: Ctrl+B
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: fUseLargeIcons
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuLargeIco, 0)
.head 7 -  Set fUseLargeIcons = not fUseLargeIcons
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Автосохранение настроек
.head 6 -  Resource Id: 33914
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: fAutoSaveSettings
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuAutoSave, 0)
.head 7 -  Set fAutoSaveSettings = not fAutoSaveSettings
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: &Сохранить настройки
.head 6 -  Resource Id: 33915
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalSendMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuSaveSet, 0)
.head 6 -  Menu Item Name:
.head 4 +  Popup Menu: В&ид
.head 5 -  Resource Id: 33916
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: &Большие значки
.head 6 -  Resource Id: 33918
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: nListViewStyle = VLIST_Large
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuViewLIco, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Маленкие значки
.head 6 -  Resource Id: 33917
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: nListViewStyle = VLIST_Small
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuViewSIco, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Список
.head 6 -  Resource Id: 33920
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: nListViewStyle = VLIST_List
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuViewList, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Детально
.head 6 -  Resource Id: 33919
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when: nListViewStyle = VLIST_Detail
.head 6 +  Menu Actions
.head 7 -  Call SalPostMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuViewDet, 0)
.head 6 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Закрыть меню
.head 5 -  Resource Id: 33921
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndForm, UM_WinMenuAction, MDIMenu_MenuExit, 0)
.head 5 -  Menu Item Name:
.head 3 +  Menu Item: Компонент
.head 4 -  Resource Id: 28156
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Status Text:
.head 4 +  Menu Settings
.head 5 -  Enabled when: TComponent.IsActive()
.head 5 -  Checked when:
.head 4 +  Menu Actions
.head 5 -  Call TComponent.Show(  )
.head 4 -  Menu Item Name:
.head 3 +  Popup Menu: &Инструментарий
.head 4 -  Resource Id: 33922
.head 4 -  Enabled when:
.head 4 -  Status Text: Различные вспомогательные компоненты
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Просмотр &счетов
.head 5 -  Resource Id: 33923
.head 5 -  Keyboard Accelerator: Ctrl+A
.head 5 -  Status Text: Список счетов комплекса
.head 5 +  Menu Settings
.head 6 -  Enabled when: not (GetGlobalOptionEx('MISYS') or GetGlobalOptionEx('FINACLE'))
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_Accounts, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Просмотр &документов
.head 5 -  Resource Id: 33924
.head 5 -  Keyboard Accelerator: Ctrl+D
.head 5 -  Status Text: Документы, введенные пользователем
.head 5 +  Menu Settings
.head 6 -  Enabled when: not (GetGlobalOptionEx('MISYS') or GetGlobalOptionEx('FINACLE'))
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_Payments, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Финансовый &калькулятор
.head 5 -  Resource Id: 33925
.head 5 -  Keyboard Accelerator: Ctrl+K
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_Calc, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Расчет контрольного разряда Счета
.head 5 -  Resource Id: 12361
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_CRC, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Расчет контрольного разряда МФО
.head 5 -  Resource Id: 12362
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_CRC, 1)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Расчет контрольного разряда ОКПО
.head 5 -  Resource Id: 12363
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_CRC, 2)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Расчет эквивалента валют
.head 5 -  Resource Id: 13621
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_CRC, 3)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Послать соо&бщение
.head 5 -  Resource Id: 33926
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_SendMsg, 0)
.head 5 -  Menu Item Name:
.head 4 +  ! Menu Item: Выключить &прием сообщений о изменении банковской даты
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Set bNotifier_Recieve = not bNotifier_Recieve
.head 6 -  Call VisMenuSetText(hWndMDI, VisMenuGetPopupHandle(VisMenuGetHandle(hWndMDI), 3 + 0),
     10, CurrentLangTable.GetAtomTitle('winMain.cTMenu38' ||
     IifS(bNotifier_Recieve, 'a', 'b')))
.head 6 +  If bNotifier_Recieve
.head 7 -  Set hBitmap = XSalBitmapFromResource('bmp3')
.head 6 +  Else 
.head 7 -  Set hBitmap = XSalBitmapFromResource('bmp1')
.head 6 -  Call BitMap()
.head 5 -  Menu Item Name: 
.head 3 +  Windows Menu: &Окна
.head 4 -  Resource Id: 33927
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Разместить &каскадом
.head 5 -  Resource Id: 33928
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_WinCascade, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Задать всем &полный размер
.head 5 -  Resource Id: 1226
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_WinFSizeAll, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Закрыть все
.head 5 -  Resource Id: 33929
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_WinCloseAll, 0)
.head 5 -  Menu Item Name:
.head 3 +  Popup Menu: &Помощь
.head 4 -  Resource Id: 33930
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Общая справка
.head 5 -  Resource Id: 33931
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Общие положения по использованию интерфейса
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_GeneralHelp, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Контекстная справка
.head 5 -  Resource Id: 11081
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndForm, SAM_Help, 0, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Кто &я?
.head 5 -  Resource Id: 33932
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Информация о текущем пользователе
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_WhoAmI, 0)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: О &Программе...
.head 5 -  Resource Id: 33934
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_About, 0)
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 -  Contents
.head 2 +  Functions
.head 3 +  Function: MDICloseAllChildren
.head 4 -  Description: Закрывает все дочерние окна
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndChild
.head 5 -  Window Handle: hWndNextChild
.head 5 -  String: strX
.head 4 +  Actions
.head 5 -  ! Убиваем все окошки, что от главного наследуются.
.head 5 -  Set hWndChild = SalGetFirstChild(hWin, TYPE_Any)
.head 5 +  While hWndChild
.head 6 -  ! Call SalPostMsg(hWndChild, WM_SysCommand, SC_Close, 0)
.head 6 -  Set hWndNextChild = SalGetNextChild(hWndChild, TYPE_FormWindow | TYPE_TableWindow)
.head 6 -  ! Call SalGetItemName(hWndChild, strX)
.head 6 -  ! Call Debug(strX)
.head 6 -  Call SalDestroyWindow(hWndChild)
.head 6 -  Set hWndChild = hWndNextChild
.head 5 -  ! Попробуем найти окошко ввода документов
.head 5 -  Set hWndChild = GetDocInputWindow()
.head 5 +  If hWndChild
.head 6 -  Call SalDestroyWindow( hWndChild )
.head 3 +  Function: MDISetAllMaxSize
.head 4 -  Description: Устанавливает всем дочерним окнам максимальный размер.
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWin
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndChild
.head 4 +  Actions
.head 5 -  Set hWndChild = SalGetFirstChild( hWin, TYPE_FormWindow | TYPE_TableWindow )
.head 5 +  While hWndChild
.head 6 -  Call SetWindowFullSize( hWndChild )
.head 6 -  Set hWndChild = SalGetNextChild( hWndChild, TYPE_FormWindow | TYPE_TableWindow )
.head 3 +  Function: MDIGetLayout
.head 4 -  Description: Вычитать установки главного окна
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strNumber
.head 4 +  Actions
.head 5 -  Call SalUseRegistry( TRUE, GetCompanyName() )
.head 5 -  Set fMenuAutoStart = SalGetProfileInt('Main Menu', 'AutoStart', 0, GetProductName() )
.head 5 -  Set nInitialState = SalGetProfileInt(INI_MainLayout, 'InitialState', Window_Normal, GetProductName() )
.head 5 -  Call SalGetProfileString( INI_MainLayout, 'NormalTopLeftX', '0', strNumber, GetProductName() )
.head 5 -  Set nNormalTLX = SalStrToNumber(strNumber)
.head 5 -  Call SalGetProfileString( INI_MainLayout, 'NormalTopLeftY', '0', strNumber, GetProductName() )
.head 5 -  Set nNormalTLY = SalStrToNumber(strNumber)
.head 5 -  Call SalGetProfileString( INI_MainLayout, 'NormalWidth', '0', strNumber, GetProductName() )
.head 5 -  Set nNormalWidth = SalStrToNumber(strNumber)
.head 5 -  Call SalGetProfileString( INI_MainLayout, 'NormalHeigh', '0', strNumber, GetProductName() )
.head 5 -  Set nNormalHeigh = SalStrToNumber(strNumber)
.head 5 -  !
.head 5 +  Select Case nInitialState
.head 6 +  Case Window_Maximized
.head 7 -  Call SalSendMsg( hWndMDI, WM_SysCommand, SC_Maximize, 0 )
.head 7 -  Break
.head 6 +  Case Window_Minimized
.head 7 -  Call SalSendMsg( hWndMDI, WM_SysCommand, SC_Minimize, 0 )
.head 7 -  Break
.head 6 +  Default
.head 7 +  If nNormalWidth AND nNormalHeigh
.head 8 -  Call SalSetWindowSize( hWndMDI, nNormalWidth, nNormalHeigh )
.head 7 -  Call SalSetWindowLoc( hWndMDI, nNormalTLX, nNormalTLY )
.head 3 +  Function: MDISetLayout
.head 4 -  Description: Сохранить настройки главного окна
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalUseRegistry( TRUE, GetCompanyName() )
.head 5 -  Call SalSetProfileString( INI_MainLayout, 'InitialState', SalNumberToStrX( nInitialState, 0 ), GetProductName() )
.head 5 -  Call SalSetProfileString( INI_MainLayout, 'NormalTopLeftX', SalNumberToStrX( nNormalTLX, 3 ), GetProductName() )
.head 5 -  Call SalSetProfileString( INI_MainLayout, 'NormalTopLeftY', SalNumberToStrX( nNormalTLY, 3 ), GetProductName() )
.head 5 -  Call SalSetProfileString( INI_MainLayout, 'NormalWidth', SalNumberToStrX( nNormalWidth, 3 ), GetProductName() )
.head 5 -  Call SalSetProfileString( INI_MainLayout, 'NormalHeigh', SalNumberToStrX( nNormalHeigh, 3 ), GetProductName() )
.head 3 +  ! Function: MDIChangeLogin
.head 4 -  Description: Сменить рабочее имя не выходя из комплекса
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nI
.head 4 +  Actions 
.head 5 -  Call SalMessageBeep(MB_IconAsterisk)
.head 5 -  ! Вы хотите завершить работу текущим пользователем и продолжить ее другим? Режимы
.head 5 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('winMain.F_MDIChangeLogin.cTQ1'),
   CurrentLangTable.GetAtomTitle('winMain.F_MDIChangeLogin.cTQ2'),
   MB_IconAsterisk | MB_YesNo) = IDYES
.head 6 +  ! If SalMessageBox('NO CHANGE USERNAME from version 3.877 - exit ?', 'Attention!', MB_IconAsterisk | MB_YesNo) = IDYES
.head 7 -  Call SalQuit()
.head 6 -  Set nI = SalModalDialog(dlg_ReLogin, hWndMDI)
.head 6 +  If nI = 0
.head 7 -  Call SalQuit()
.head 6 +  Else If nI = 1
.head 7 -  Return FALSE
.head 6 +  Else If nI = 2
.head 7 -  Call MDICloseAllChildren(hWndMDI)
.head 7 +  If DatabaseLogin(dtWBDate)
.head 8 +  If StartChecking()
.head 9 -  Call SetWorkBankDate(dtWBDate)
.head 9 -  Call Pl_dat(dtWBDate)
.head 9 -  ! Банковская дата -> 'dtWBDate
.head 9 -  Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('winMain.F_MDIChangeLogin.cTToLog1') || ' -> ' || SalFmtFormatDateTime(dtWBDate, 'dd/MM/yyyy'))
.head 9 -  !
.head 9 -  Call StartSetTobo()
.head 9 -  !
.head 9 -  Call MDIGetLayout()
.head 9 -  Call XNetInit(hWndMDI, UM_NetMessage, GetUserLoginName(), not BroadcastAllowed(),
     hSql(), GetDBMS())
.head 9 -  ! Смена рабочего имени -> GetUserLoginName()
.head 9 -  Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('winMain.F_MDIChangeLogin.cTToLog2') || ' -> ' || GetUserLoginName())
.head 9 -  Call SalSendMsg(hWndMDI, UM_Update, 0, 0)
.head 9 +  If fMenuAutoStart
.head 10 -  Call SalSendMsg(hWndMDI, UM_WinMenuAction, MDIMenu_MainMenu, 0)
.head 3 +  Function: MDILockWorkstation
.head 4 -  Description: Заблокировать рабочую станцию
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set fLocked = TRUE
.head 5 -  Call SalModalDialog( dlg_Lock, hWndMDI )
.head 5 -  Set fLocked = FALSE
.head 3 +  Function: MDICheckVPSTransit
.head 4 -  Description: Проверить и сигнализировать о пдкреплении К/C ВПС СБАРБАНКА.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSum
.head 5 -  Number: nOperIsp
.head 5 -  Number: nRes
.head 4 +  Actions
.head 5 -  Set fLocked = TRUE
.head 5 +  If not cElDoc.IsConnected()
.head 6 +  If not cElDoc.Connect()
.head 7 -  Return FALSE
.head 5 -  Set nOperIsp = GetUserId()
.head 5 -  Call SqlPrepareAndExecute(cElDoc.hSql(), "
     SELECT sum(ostc)
     INTO :nSum
     FROM saldo 
     WHERE tip='SKS' and isp=:nOperIsp")
.head 5 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nSum
.head 6 -  Call SalMessageBeep(MB_IconAsterisk)
.head 6 -  ! Call MessageNoWait(
     'Поступили средства для подкрепления К/C ВПС.
     Сумма: ' || SalNumberToStrX(nSum/100, 2) || '.',
     'ВНИМАНИЕ !!!', 17, 1)
.head 6 -  Call MessageNoWait(CurrentLangTable.GetAtomTitle('winMain.F_MDICheckVPSTransit.cTMess1') || '.' || 
  CurrentLangTable.GetAtomTitle('winMain.F_MDICheckVPSTransit.cTMess1') || ': ' || SalNumberToStrX(nSum/100, 2) || '.',
  CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 5 -  Set fLocked = FALSE
.head 5 -  ! mik
.head 3 +  Function: MDIUnBundMsg
.head 4 -  Description: Проверить и сигнализировать о наличии неразобранных 
SWIFT сообщений для пользователя.
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRes
.head 5 -  Number: nOperIsp
.head 5 -  Number: nC
.head 4 +  Actions
.head 5 -  Set fLocked = TRUE
.head 5 +  If not cElDoc.IsConnected()
.head 6 +  If not cElDoc.Connect()
.head 7 -  Return FALSE
.head 5 -  Set nOperIsp = GetUserId()
.head 5 -  Call SqlPrepareAndExecute(cElDoc.hSql(), '
     SELECT count(*)
     INTO :nC
     FROM sw_journal
     WHERE id=:nOperIsp AND 
           swref not in (SELECT swref FROM sw_oper)')
.head 5 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nC > 0
.head 6 -  Call SalMessageBeep(MB_IconAsterisk)
.head 6 -  ! Call MessageNoWait('Имеются неразобранные SWIFT '
     || ' сообщения - ' || Str(nC) || ' .',
     'ВНИМАНИЕ !!!', 17, 1)
.head 6 -  Call MessageNoWait(CurrentLangTable.GetAtomTitle('winMain.F_MDIUnBundMsg.cTMessSWIFT') || ' - ' || Str(nC) || ' .',
  CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 5 -  Set fLocked = FALSE
.head 3 +  Function: MDICheckBankDay
.head 4 -  Description: Проверить состояние банковского дня
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRet
.head 5 -  Date/Time: dtBDate
.head 5 -  String: strStatus
.head 5 -  String: strDispStatus
.head 5 -  Boolean: fReturn
.head 4 +  Actions
.head 5 -  ! Set sTmp1 = SalFmtFormatDateTime(SalDateCurrent(), 'hhhh:mm:ss:mmmmmm')
.head 5 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 6 -  Set fReturn = SqlPLSQLCommand(cDconnect.hSql(),
    "bars_notifier_receive(nRet,dtBDate,strStatus)")
.head 6 +  While fReturn and nRet
.head 7 +  If dtBDate = GetBankDate()
.head 8 +  If strStatus = 'CLOSED' or strStatus = 'PROHIBITED'
.head 9 -  ! закрыт
.head 9 -  Set strDispStatus = CurrentLangTable.GetAtomTitle('cTBDClose')
.head 8 +  Else If strStatus = 'SWITCHED'
.head 9 -  ! переключен
.head 9 -  Set strDispStatus = CurrentLangTable.GetAtomTitle('cTBDReopen')
.head 8 +  Else
.head 9 -  ! открыт
.head 9 -  Set strDispStatus = CurrentLangTable.GetAtomTitle('cTBDOpen')
.head 8 -  !
.head 8 -  ! Технолог, АБС "БАРС", Банковский день dtBDate strDispStatus !
.head 8 -  Call XNetDispatchMessageEx(hWndMDI, CurrentLangTable.GetAtomTitle('cTTech'),
     CurrentLangTable.GetAtomTitle('cTAdm'), CurrentLangTable.GetAtomTitle('cTBankDay') || ' ' ||
     SalFmtFormatDateTime(dtBDate, 'dd/MM/yyyy') || ' ' || strDispStatus || IifS(
     GetGlobalOption('HAVETOBO')='2' and GetGlobalOption('NBUBANK')='1', ' в МФО ' || GetBankMfo(), '') || ' !',
     4)
.head 8 -  ! Check user rights and do smth.
.head 8 +  If strStatus = 'CLOSED' and GetUserMark() < GetGlobalOptionEx('MARKDATE') or
   strStatus = 'PROHIBITED'
.head 9 -  Call SalQuit()
.head 8 +  If strStatus = 'SWITCHED'
.head 9 -  ! Закрыть все окна
.head 9 -  Call MDICloseAllChildren(hWndMDI)
.head 9 -  ! Вычитать параметры из params
.head 9 -  Call GetParamsSettings(hSql())
.head 9 -  Set dtBDate = SalFmtFormatStrDateTime(GetGlobalOption('BANKDATE'), 'MM/dd/yyyy')
.head 9 -  ! Назначить новую дату пользователю.
.head 9 -  Call SetWorkBankDate(dtBDate)
.head 9 -  Call Pl_dat(dtBDate)
.head 9 -  ! Банковская дата -> dtBDate
.head 9 -  Call SaveInfoToLog(CurrentLangTable.GetAtomTitle('cTBankData') || ' -> ' ||
     SalFmtFormatDateTime(dtBDate, 'dd/MM/yyyy'))
.head 9 +  If fMenuAutoStart
.head 10 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_MainMenu, 0)
.head 8 -  Call SalSendMsg(hWndMDI, UM_Update, 0, 0)
.head 7 -  Set fReturn = SqlPLSQLCommand(cDconnect.hSql(),
    "bars_notifier_receive(nRet,dtBDate,strStatus)")
.head 5 -  ! Set sTmp2 = SalFmtFormatDateTime(SalDateCurrent(), 'hhhh:mm:ss:mmmmmm')
.head 5 -  Return TRUE
.head 3 +  Function: MDIGetMessage
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sMsg
.head 5 -  Number: nId
.head 5 -  Date/Time: dDat
.head 4 +  Actions
.head 5 +  If BMS_DequeueMsg(sMsg, nId, dDat)
.head 6 -  ! Call BMS_ShowMsg(sMsg, nId, 'Технолог', 'АБС "БАРС"')
.head 6 -  Call BMS_ShowMsg(hWndMDI, sMsg, nId, dDat, CurrentLangTable.GetAtomTitle('cTTech'),
     CurrentLangTable.GetAtomTitle('cTAdm'))
.head 5 -  Return TRUE
.head 3 +  Function: MDISetMenu
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nMenuItem
.head 4 +  Actions
.head 5 -  Set nMenuItem = IifN(VisMenuGetText( hWndMDI, VisMenuGetHandle( hWndMDI ), 0 )!='',0,1)
.head 5 -  ! 0 Режимы
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetHandle( hWndMDI ), 0 + nMenuItem,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu0') )
.head 5 -  ! Меню приложений
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 0 + nMenuItem ), 0,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu00') )
.head 5 -  ! Настройки
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 0 + nMenuItem ), 1,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu01') )
.head 5 -  ! ---
.head 5 -  ! Войти под &другим именем
.head 5 -  ! Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 0 + nMenuItem ), 3,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu02') )
.head 5 -  ! Поменять пароль...
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 0 + nMenuItem ), 3,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu03') )
.head 5 -  ! Заблокировать рабочее место
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 0 + nMenuItem ), 4,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu04') )
.head 5 -  ! ---
.head 5 -  ! В&ыход
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 0 + nMenuItem ), 6,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu05') )
.head 5 -  ! 1 Меню
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetHandle( hWndMDI ), 1 + nMenuItem,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu1') )
.head 5 -  ! Развернуть все
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 0,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu10') )
.head 5 -  ! Р&азвернуть секцию
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 1,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu11') )
.head 5 -  ! С&вернуть секцию
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 2,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu12') )
.head 5 -  ! Свернуть все
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 3,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu13') )
.head 5 -  ! ---
.head 5 -  ! Выполнить...
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 5,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu14') )
.head 5 -  ! ---
.head 5 -  ! Выбор базы
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 7,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu14_1') )
.head 5 -  ! Оперативня база
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle(VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 7), 0,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu14_10') )
.head 5 -  ! Архивная база
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle(VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 7), 1,
  CurrentLangTable.GetAtomTitle('winMain.cTMenu14_11') )
.head 5 -  !
.head 5 -  ! Установки
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 8,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu15') )
.head 5 -  ! Авто&запуск при старте АБС
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle(VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 8), 0,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu150') )
.head 5 -  ! Использовать в меню большие значки
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle(VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 8), 1,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu151') ||'	Ctrl+B' )
.head 5 -  ! Автосохранение настроек
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle(VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 8), 2,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu152') )
.head 5 -  !
.head 5 -  ! Сохранить настройки
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle(VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 8), 4,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu153') )
.head 5 -  ! В&ид
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 9,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu16') )
.head 5 -  ! Большие значки
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle(VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 9), 0,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu160') )
.head 5 -  ! Маленкие значки
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle(VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 9), 1,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu161') )
.head 5 -  ! Список
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle(VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 9), 2,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu162') )
.head 5 -  ! Детально
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle(VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 9), 3,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu163') )
.head 5 -  ! Закрыть меню
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 1 + nMenuItem ), 11,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu17') )
.head 5 -  ! 2 Компонент
.head 5 -  ! Call VisMenuSetText( hWndMDI, VisMenuGetHandle( hWndMDI ), 2,
  CurrentLangTable.GetAtomTitle('winMain.cTMenu2') )
.head 5 -  ! 3 Инструментарий
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetHandle( hWndMDI ), 3 + nMenuItem,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu3') )
.head 5 -  ! Просмотр &счетов
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ),
     3 + nMenuItem ), 0,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu30') || '	Ctrl+A' )
.head 5 -  ! Просмотр &документов
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ),
     3 + nMenuItem ), 1,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu31') || '	Ctrl+D')
.head 5 -  ! ---
.head 5 -  ! Финансовый &калькулятор
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ),
     3 + nMenuItem ), 3,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu32') || '	Ctrl+K' )
.head 5 -  ! Расчет контрольного разряда Счета
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ),
     3 + nMenuItem ), 4,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu33') )
.head 5 -  ! Расчет контрольного разряда МФО
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ),
     3 + nMenuItem ), 5,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu34') )
.head 5 -  ! Расчет контрольного разряда ОКПО
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ),
     3 + nMenuItem ), 6,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu35') )
.head 5 -  ! Расчет эквивалента валют
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ),
     3 + nMenuItem ), 7,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu36') )
.head 5 -  ! ---
.head 5 -  ! Послать соо&бщение
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ),
     3 + nMenuItem ), 9,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu37') )
.head 5 -  ! Послать соо&бщение
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ),
     3 + nMenuItem ), 10,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu38a') )
.head 5 -  ! 4 Окна
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetHandle( hWndMDI ), 4 + nMenuItem,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu4') )
.head 5 -  ! Разместить &каскадом
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 4 + nMenuItem ), 0,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu41') )
.head 5 -  ! Задать всем &полный размер
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 4 + nMenuItem ), 1,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu42') )
.head 5 -  ! Закрыть все
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 4 + nMenuItem ), 2,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu43') )
.head 5 -  ! 5 Помощь
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetHandle( hWndMDI ), 5 + nMenuItem,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu5') )
.head 5 -  ! Общая справка
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 5 + nMenuItem ), 0,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu50') )
.head 5 -  ! Контекстная справка
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 5 + nMenuItem ), 1,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu51') )
.head 5 -  ! ---
.head 5 -  ! Кто &я?
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 5 + nMenuItem ), 3,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu52') )
.head 5 -  ! ---
.head 5 -  ! О &Программе...
.head 5 -  Call VisMenuSetText( hWndMDI, VisMenuGetPopupHandle( VisMenuGetHandle( hWndMDI ), 5 + nMenuItem ), 5,
     CurrentLangTable.GetAtomTitle('winMain.cTMenu53') )
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  ! Function: ElektroDocUser
.head 4 -  Description: Проверить и сигнализировать о наличии клиентских платежей для пользователя.
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nKwoED
.head 5 -  Number: nSumED
.head 5 -  Number: nOperIsp
.head 5 -  Number: nRes
.head 4 +  Actions 
.head 5 -  ! mom (сообщение о наличии, количестве и сумме "электронных"
! документов от КЛИЕНТ-БАНК) включать ТОЛЬКО после проверки
.head 5 -  Set fLocked = TRUE
.head 5 +  If not cElDoc.IsConnected()
.head 6 +  If not cElDoc.Connect()
.head 7 -  Return FALSE
.head 5 -  Set nOperIsp = GetUserId()
.head 5 +  If bAUTO
.head 6 +  If SqlPrepareAndExecute(cElDoc.hSql(), '
     SELECT count(*),sum(s)
     INTO :nKwoED,:nSumED
     FROM klp
     WHERE fl<4 and eom=:nOperIsp and noauto is not null')
.head 7 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nKwoED > 0
.head 8 -  Call SalMessageBeep(MB_IconAsterisk)
.head 8 -  ! Call MessageNoWait('Имеются необработанные "электронные" документы (КЛИЕНТ-БАНК) - '
     || Str(nKwoED) || '(' || SalNumberToStrX(nSumED/100, 2) || ').',
     'ВНИМАНИЕ !!!', 17, 1)
.head 8 -  Call MessageNoWait(
     CurrentLangTable.GetAtomTitle('winMain.F_ElektroDocUser.cTMessKlb') || ' - ' ||
     Str(nKwoED) || '(' || SalNumberToStrX(nSumED/100, 2) || ').',
     CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 5 +  Else 
.head 6 +  If SqlPrepareAndExecute(cElDoc.hSql(), '
     SELECT count(*),sum(s)
     INTO :nKwoED,:nSumED
     FROM klp
     WHERE fl<4 and eom=:nOperIsp')
.head 7 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nKwoED > 0
.head 8 -  Call SalMessageBeep(MB_IconAsterisk)
.head 8 -  ! Call MessageNoWait('Имеются необработанные "электронные" документы (КЛИЕНТ-БАНК) - '
     || Str(nKwoED) || '(' || SalNumberToStrX(nSumED/100, 2) || ').',
     'ВНИМАНИЕ !!!', 17, 1)
.head 8 -  Call MessageNoWait(
     CurrentLangTable.GetAtomTitle('winMain.F_ElektroDocUser.cTMessKlb') || ' - ' ||
     Str(nKwoED) || '(' || SalNumberToStrX(nSumED/100, 2) || ').',
     CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 5 +  If Val(GetGlobalOption('REMD_VKB'))=1
.head 6 +  If bAUTO
.head 7 +  If SqlPrepareAndExecute(cElDoc.hSql(), '
   SELECT count(*)
   INTO :nKwoED
   FROM klpv
   WHERE fl<4 and neom=:nOperIsp and tipkb=3 and noauto is not null')
.head 8 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nKwoED > 0
.head 9 -  Call SalMessageBeep(MB_IconAsterisk)
.head 9 -  ! Call MessageNoWait(
     'Имеются необработанные "электронные" документы (ЗАЯВКИ НА КОНВЕРСИЮ) - ' ||
     Str(nKwoED) || '.', 'ВНИМАНИЕ !!!', 17, 1)
.head 9 -  Call MessageNoWait(
     CurrentLangTable.GetAtomTitle('winMain.F_ElektroDocUser.cTMessKb3') || ' - '
     || Str(nKwoED) || '.', CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 6 +  Else 
.head 7 +  If SqlPrepareAndExecute(cElDoc.hSql(), '
   SELECT count(*)
   INTO :nKwoED
   FROM klpv
   WHERE fl<4 and neom=:nOperIsp and tipkb=3')
.head 8 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nKwoED > 0
.head 9 -  Call SalMessageBeep(MB_IconAsterisk)
.head 9 -  ! Call MessageNoWait(
     'Имеются необработанные "электронные" документы (ЗАЯВКИ НА КОНВЕРСИЮ) - ' ||
     Str(nKwoED) || '.', 'ВНИМАНИЕ !!!', 17, 1)
.head 9 -  Call MessageNoWait(
     CurrentLangTable.GetAtomTitle('winMain.F_ElektroDocUser.cTMessKb3') || ' - '
     || Str(nKwoED) || '.', CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 6 -  !
.head 6 +  If bAUTO
.head 7 +  If SqlPrepareAndExecute(cElDoc.hSql(), '
   SELECT count(*)
   INTO :nKwoED
   FROM klpv
   WHERE fl<4 and neom=:nOperIsp and tipkb=6 and noauto is not null')
.head 8 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nKwoED > 0
.head 9 -  Call SalMessageBeep(MB_IconAsterisk)
.head 9 -  ! Call MessageNoWait(
     'Имеются необработанные "электронные" документы (ЗАГРАНПЕРЕВОДЫ) - ' ||
     Str(nKwoED) || '.', 'ВНИМАНИЕ !!!', 17, 1)
.head 9 -  Call MessageNoWait(
     CurrentLangTable.GetAtomTitle('winMain.F_ElektroDocUser.cTMessKb6') || ' - '
     || Str(nKwoED) || '.', CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 6 +  Else 
.head 7 +  If SqlPrepareAndExecute(cElDoc.hSql(), '
   SELECT count(*)
   INTO :nKwoED
   FROM klpv
   WHERE fl<4 and neom=:nOperIsp and tipkb=6')
.head 8 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nKwoED > 0
.head 9 -  Call SalMessageBeep(MB_IconAsterisk)
.head 9 -  ! Call MessageNoWait(
     'Имеются необработанные "электронные" документы (ЗАГРАНПЕРЕВОДЫ) - ' ||
     Str(nKwoED) || '.', 'ВНИМАНИЕ !!!', 17, 1)
.head 9 -  Call MessageNoWait(
     CurrentLangTable.GetAtomTitle('winMain.F_ElektroDocUser.cTMessKb6') || ' - '
     || Str(nKwoED) || '.', CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 6 -  !
.head 6 +  If bAUTO
.head 7 +  If SqlPrepareAndExecute(cElDoc.hSql(), '
   SELECT count(*)
   INTO :nKwoED
   FROM klpv
   WHERE fl<4 and neom=:nOperIsp and tipkb=7 and noauto is not null')
.head 8 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nKwoED > 0
.head 9 -  Call SalMessageBeep(MB_IconAsterisk)
.head 9 -  ! Call MessageNoWait(
     'Имеются необработанные "электронные" документы (ПЛ.ПОРУЧЕНИЯ в ИНВАЛЮТЕ) - '
     || Str(nKwoED) || '.', 'ВНИМАНИЕ !!!', 17, 1)
.head 9 -  Call MessageNoWait(
     CurrentLangTable.GetAtomTitle('winMain.F_ElektroDocUser.cTMessKb7') || ' - '
     || Str(nKwoED) || '.', CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 6 +  Else 
.head 7 +  If SqlPrepareAndExecute(cElDoc.hSql(), '
   SELECT count(*)
   INTO :nKwoED
   FROM klpv
   WHERE fl<4 and neom=:nOperIsp and tipkb=7')
.head 8 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nKwoED > 0
.head 9 -  Call SalMessageBeep(MB_IconAsterisk)
.head 9 -  ! Call MessageNoWait(
     'Имеются необработанные "электронные" документы (ПЛ.ПОРУЧЕНИЯ в ИНВАЛЮТЕ) - '
     || Str(nKwoED) || '.', 'ВНИМАНИЕ !!!', 17, 1)
.head 9 -  Call MessageNoWait(
     CurrentLangTable.GetAtomTitle('winMain.F_ElektroDocUser.cTMessKb7') || ' - '
     || Str(nKwoED) || '.', CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 5 -  Set fLocked = FALSE
.head 5 -  ! mom
.head 3 +  Function: ElektroDocUserZaya
.head 4 -  Description: Проверить и сигнализировать о наличии клиентских платежей для пользователя.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nKwoED
.head 5 -  Number: nSumED
.head 5 -  Number: nOperIsp
.head 5 -  Number: nRes
.head 4 +  Actions
.head 5 -  ! mom (сообщение о наличии, количестве и сумме "электронных"
! документов от КЛИЕНТ-БАНК) включать ТОЛЬКО после проверки
.head 5 -  Set fLocked = TRUE
.head 5 +  If not cElDoc.IsConnected()
.head 6 +  If not cElDoc.Connect()
.head 7 -  Return FALSE
.head 5 -  Set nOperIsp = GetUserId()
.head 5 +  If Val(GetGlobalOption('REMD_VKB'))=1
.head 6 +  If SqlPrepareAndExecute(cElDoc.hSql(), '
     SELECT count(*)
     INTO :nKwoED
     FROM zayavka
     WHERE sos=0 and viza=0 and tipkb is not null and fnamekb is not null and
           identkb is not null')
.head 7 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nKwoED > 0
.head 8 -  Call SalMessageBeep(MB_IconAsterisk)
.head 8 -  ! Call MessageNoWait('Имеются необработанные "электронные" документы (ЗАЯВКИ НА ' ||
     'ПОКУПКУ/ПРОДАЖУ) - ' || Str(nKwoED) || '.', 'ВНИМАНИЕ !!!', 17, 1)
.head 8 -  Call MessageNoWait(CurrentLangTable.GetAtomTitle('winMain.F_ElektroDocUserZaya.cTMessZaya') || ' - ' || Str(nKwoED) || '.', 
  CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 6 -  !
.head 6 +  If SqlPrepareAndExecute(cElDoc.hSql(), '
     SELECT count(*)
     INTO :nKwoED
     FROM zay_debt_klb')
.head 7 +  If SqlFetchNext(cElDoc.hSql(), nRes) and nKwoED > 0
.head 8 -  Call SalMessageBeep(MB_IconAsterisk)
.head 8 -  ! Call MessageNoWait(
     'Имеются необработанные "электронные" документы (ЗАЯВКИ НА ОБЯЗАТЕЛЬНУЮ ' ||
     'ПРОДАЖУ) - ' || Str(nKwoED) || '.', 'ВНИМАНИЕ !!!', 17, 1)
.head 8 -  Call MessageNoWait(CurrentLangTable.GetAtomTitle('winMain.F_ElektroDocUserZaya.cTMessZayd') || ' - ' || Str(nKwoED) || '.', 
  CurrentLangTable.GetAtomTitle('cTAt'), 17, 1)
.head 5 -  Set fLocked = FALSE
.head 5 -  ! mom
.head 3 +  ! Function: ElektroDocRuko
.head 4 -  Description: Проверить и сигнализировать о наличии клиентских платежей для руководителя.
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  String: sSabi
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nRes
.head 5 -  Number: nI
.head 5 -  String: sNLS
.head 5 -  String: sNLSP
.head 5 -  String: sMFO
.head 5 -  String: sNAIMP
.head 5 -  Number: nS
.head 5 -  String: smAll[*]
.head 4 +  Actions 
.head 5 -  ! mom (сообщение о наличии, количестве и сумме "электронных"
! документов от КЛИЕНТ-БАНК для РУКОВОДИТЕЛЯ) включать ТОЛЬКО после проверки
.head 5 -  Set fLocked = TRUE
.head 5 +  If not cElDoc.IsConnected()
.head 6 +  If not cElDoc.Connect()
.head 7 -  Return FALSE
.head 5 -  Set nOperIsp = GetUserId()
.head 5 -  Call SalWaitCursor(TRUE)							
.head 5 +  If SqlPrepareAndExecute(cElDoc.hSql(), "
   SELECT nls,nlsp,mfo,naimp,s
   INTO :sNLS,:sNLSP,:sMFO,:sNAIMP,:nS
   FROM klp
   WHERE fl<4 and (substr(naex,8,1) || substr(naex,10,3) in (" || sSabi || ") or
                   substr(naex,3,4) in                      (" || sSabi || "))")
.head 6 -  Set nI = 0
.head 6 -  Call SalArraySetUpperBound(smAll, 1, -1)
.head 6 +  While SqlFetchNext(cElDoc.hSql(), nRes)
.head 7 -  Set smAll[nI] = PadR(sNLS, 18) || PadR(sMFO, 10) || PadR(sNLSP, 18) || PadR(sNAIMP, 40) || PadL(
    SalNumberToStrX(nS/100, 2), 20)
.head 7 -  Set nI = nI + 1
.head 6 -  Call SalWaitCursor(FALSE)							
.head 6 +  If nI > 0
.head 7 -  ! Call SalModalDialog(dlg_ElkInfoRuk, hWndNULL, smAll, nI)
.head 7 -  Call SalModalDialog(dlg_ElkInfoRuk, hWndMDI, smAll, nI)
.head 5 -  Set fLocked = FALSE
.head 5 -  ! mom
.head 3 +  Function: BitMap
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nWidth
.head 5 -  Number: nHeight
.head 5 -  Window Handle: hToolBar
.head 5 -  ! Window Handle: hPoint
.head 4 +  Actions
.head 5 -  Call SalGetWindowSize(hWndForm, nWidth, nHeight)
.head 5 -  ! Call Debug(Str(nWidth))
.head 5 -  ! Call XSalBitmapDraw(hWndForm, hBitmapNull, nWidth*58.42-8, 2, 15, 15, FALSE)
.head 5 -  Call SalUpdateWindow(hWndForm)
.head 5 -  Set hToolBar = SalGetFirstChild(hWndForm, TYPE_FormToolBar)
.head 5 +  ! If hToolBar = hWndNULL
.head 6 -  Set hPoint = hWndForm
.head 5 +  ! Else
.head 6 -  Set hPoint = hToolBar
.head 5 -  ! Call XSalBitmapDraw(hPoint, hBitmap, nWidth*58.42-8, 2, 15, 15, TRUE)
.head 5 +  If hToolBar != hWndNULL
.head 6 -  Call XSalBitmapDraw(hToolBar, hBitmap, nWidth*58.42-8, 2, 15, 15, TRUE)
.head 5 -  ! Call SalInvalidateWindow(hWndForm)
.head 5 -  ! Call XSalTooltipSetDelay(200, 30000)
.head 5 -  ! Call XSalTooltipShow(hPoint, CurrentLangTable.GetAtomTitle('winMain.cTooltip38' ||
     IifS(bNotifier_Recieve, 'a', 'b')))
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  ! Установки главного окна, координаты, размеры, состояние при старте и пр.
.head 3 -  Number: nInitialState ! Статус окна при запуске
.head 3 -  Number: nNormalTLX    ! Х-координата окна в нормальном состоянии
.head 3 -  Number: nNormalTLY    ! Y-координата окна в нормальном состоянии
.head 3 -  Number: nNormalHeigh  ! высота окна в нормальном состоянии
.head 3 -  Number: nNormalWidth  ! ширина окна в нормальном состоянии
.head 3 -  !
.head 3 -  Number: nListViewStyle
.head 3 -  Boolean: fMenuAutoStart
.head 3 -  Boolean: fUseLargeIcons
.head 3 -  Boolean: fAutoSaveSettings
.head 3 -  !
.head 3 -  : TComponent
.head 4 -  Class: cParentMenuEngine
.head 3 -  Number: nMenuOffset
.head 3 -  !
.head 3 -  Boolean: fLocked
.head 3 -  Boolean: fElkOper
.head 3 -  Boolean: fElkZaya
.head 3 -  Boolean: fCheckBankDay
.head 3 -  Number: nSumTime[*]
.head 3 -  Number: nTMOUTAGE	! GlobalOption TMOUTAGE - время простоя операционной системы (в мин), после которого запускать блокировку комплекса
.head 3 -  Number: nTimeOutage	! время простоя операционной системы (в сек)
.head 3 -  !
.head 3 -  : cRconnect
.head 4 -  Class: cABSConnect
.head 3 -  : cDconnect
.head 4 -  Class: cABSConnect
.head 3 -  : cElDoc
.head 4 -  Class: cABSConnect
.head 3 -  String: sSABi
.head 3 -  Number: nSABiSwift
.head 3 -  Number: nPeriod
.head 3 -  Number: nOperIsp
.head 3 -  Number: nFetchRes
.head 3 -  !
.head 3 -  ! String: sTmp1
.head 3 -  Number: hBitmap
.head 3 -  Number: nRes
.head 3 -  !
.head 3 -  String: sCurrentSchema     ! Текущая схема пользов-ля
.head 3 -  Boolean: bUseArchiveSchem  ! Исполтзуется ли работа с архивом
.head 3 -  Boolean: bCanUserUseArchSchem! Может ли пользователь работать в архивной схеме
.head 3 -  Boolean: fWorkDB           ! Ткеущая база  (true-опреативная, false-архивная)
.head 3 -  String: sLocalUserLang     ! Настройки языка для данной станции
.head 3 -  !
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call WaitCursorOn()
.head 4 -  Call MDIGetLayout()
.head 4 -  Call XNetInit(hWndMDI, UM_NetMessage, GetUserLoginName(), not BroadcastAllowed(), hSql(),
     GetDBMS())
.head 4 -  Call SaveInfoToLog("! LAN MACs: " || SalStrUpperX(XNetGetMACList()))
.head 4 -  Call SaveInfoToLog(MSG_StartApp())
.head 4 -  !
.head 4 -  ! Инициализация переменных для работы польз-ля в оперативн. или архивн. схеме
.head 4 -  Set fWorkDB=TRUE
.head 4 -  Set bUseArchiveSchem = IifN(GetGlobalOption('USEHIST')='',0,GetGlobalOptionEx('USEHIST') )
.head 4 +  If bUseArchiveSchem
.head 5 +  If SqlPrepareAndExecute(hSql(),
     "SELECT cschema, usearc
      INTO :sCurrentSchema, :bCanUserUseArchSchem
      FROM bars.staff$base
      WHERE logname = sys_context('userenv', 'session_user')")  AND SqlFetchNext(hSql(), nRes)
.head 6 +  If bCanUserUseArchSchem
.head 7 +  If (sCurrentSchema= DB_SCHEM_ARCHIVE  OR sCurrentSchema= DB_SCHEM_OPERATIVE)
.head 8 -  Set fWorkDB = IifN(sCurrentSchema=DB_SCHEM_OPERATIVE, 1, 0)
.head 7 +  Else
.head 8 +  Call MessageError(CurrentLangTable.GetAtomTitle('winMain.cTErrMess_OnCreate1') || sCurrentSchema ||
                  CurrentLangTable.GetAtomTitle('winMain.cTErrMess_OnCreate2'))
.head 9 -  Call SalQuit()
.head 6 +  Else
.head 7 -  Set bUseArchiveSchem=FALSE
.head 5 +  Else
.head 6 +  Call MessageError(CurrentLangTable.GetAtomTitle('winMain.cTErrMess_OnCreate3'))
.head 7 -  Call SalQuit()
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  ! Инициализация языка по локальным настройкам станции (для oracle session).
.head 4 -  Set sLocalUserLang = GetLang()
.head 4 +  If not SqlPLSQLCommand(hSql(), "bars_msg.set_lang(sLocalUserLang, 0)")
.head 5 -  Call SqlRollbackEx(hSql(), CurrentLangTable.GetAtomTitle('winMain.cTErrMessLang')||' '||sLocalUserLang)
.head 4 -  !
.head 4 -  !
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call MDISetMenu()
.head 4 -  !
.head 4 -  !
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  Call SalSendMsg(hWndMDI, UM_Update, 0, 0)
.head 4 +  If fMenuAutoStart
.head 5 -  Call SalSendMsg(hWndMDI, UM_WinMenuAction, MDIMenu_MainMenu, 0)
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  ! Запуск таймеров для проверок различных 
.head 4 -  !
.head 4 -  Call XConnectGetParams(cDconnect)
.head 4 +  If cDconnect.Connect()
.head 5 -  ! Смотрим за датой
.head 5 -  Set nSumTime[0] = 0
.head 5 -  Call SalTimerSet(hWndMDI, 0, 15000)
.head 5 -  Call SalPostMsg(hWndMDI, SAM_Timer, 0, 0)
.head 4 -  Call XConnectGetParams(cElDoc)
.head 4 -  !
.head 4 -  Set nSumTime[1] = 0
.head 4 -  Call SalTimerSet(hWndMDI, 1, 60000)
.head 4 -  !
.head 4 -  Call XConnectGetParams(cRconnect)
.head 4 -  ! Call Debug(Str(Len(GetGlobalOption('CHK_PIPE'))))
.head 4 -  ! Call Debug(GetGlobalOption('CHK_PIPE'))
.head 4 -  Set fCheckBankDay = (Len(GetGlobalOption('CHK_PIPE'))=0 or
    GetGlobalOption('CHK_PIPE')='1')
.head 4 +  ! If fCheckBankDay
.head 5 -   Call Debug('PIPE')
.head 4 +  ! Else
.head 5 -   Call Debug('NOPIPE')
.head 4 +  If GetGlobalOptionEx('REMD_ELR') = 1
.head 5 -  Set fLocked = TRUE
.head 5 +  If not cRconnect.IsConnected()
.head 6 -  Call cRconnect.Connect()
.head 5 +  If cRconnect.IsConnected()
.head 6 -  Set nOperIsp = GetUserId()
.head 6 +  If SqlPrepareAndExecute(cRconnect.hSql(), '
   SELECT sabi,period
   INTO :sSABi,:nPeriod
   FROM klp_info
   WHERE id=:nOperIsp')
.head 7 +  If SqlFetchNext(cRconnect.hSql(), nFetchRes)
.head 8 +  If nPeriod > 0
.head 9 -  Set nPeriodGlobal = nPeriod*60000
.head 9 -  Set nSumTime[2] = 0
.head 9 -  Call SalTimerSet(hWndMDI, 2, 60000)
.head 6 -  Set fLocked = FALSE
.head 4 +  If GetGlobalOptionEx('REMD_ELK') = 1
.head 5 -  Set fLocked = TRUE
.head 5 +  If not cRconnect.IsConnected()
.head 6 -  Call cRconnect.Connect()
.head 5 +  If cRconnect.IsConnected()
.head 6 -  Set nOperIsp = GetUserId()
.head 6 +  If SqlPrepareAndExecute(cRconnect.hSql(), "
   SELECT count(*)
   INTO :nPeriod
   FROM applist_staff a
   WHERE a.id=:nOperIsp and a.codeapp in (
         SELECT DISTINCT codeapp
         FROM operapp
         WHERE codeoper in (
               SELECT codeoper
               FROM operlist
               WHERE funcname LIKE '%KLOP%'))")
.head 7 +  If SqlFetchNext(cRconnect.hSql(), nFetchRes)
.head 8 +  If nPeriod > 0
.head 9 -  Set fElkOper = TRUE
.head 6 -  ! заявки на покупку/продажу и обязательную продажу 
.head 6 +  If SqlPrepareAndExecute(cRconnect.hSql(), "
   SELECT count(*)
   INTO :nPeriod
   FROM applist_staff a
   WHERE a.id=:nOperIsp and a.codeapp in (
         SELECT DISTINCT codeapp
         FROM operapp
         WHERE codeoper in (
               SELECT codeoper
               FROM operlist
               WHERE funcname LIKE '%ZAYAVKA%31%' or funcname LIKE '%ZAYAVKA%34%'))")
.head 7 +  If SqlFetchNext(cRconnect.hSql(), nFetchRes)
.head 8 +  If nPeriod > 0
.head 9 -  Set fElkZaya = TRUE
.head 6 -  Set fLocked = FALSE
.head 4 +  If GetGlobalOptionEx('REMD_VIS') = 1
.head 5 -  Set fLocked = TRUE
.head 5 +  If not cRconnect.IsConnected()
.head 6 -  Call cRconnect.Connect()
.head 5 +  If cRconnect.IsConnected()
.head 6 -  Set nSumTime[3] = 0
.head 6 -  Call SalTimerSet(hWndMDI, 3, 60000)
.head 5 -  Set fLocked = FALSE
.head 4 +  If GetGlobalOptionEx('REMD_SWT') = 1
.head 5 -  Set fLocked = TRUE
.head 5 +  If not cRconnect.IsConnected()
.head 6 -  Call cRconnect.Connect()
.head 5 +  If cRconnect.IsConnected()
.head 6 -  Set nSumTime[4] = 0
.head 6 -  Call SalTimerSet(hWndMDI, 4, 60000)
.head 5 -  Set fLocked = FALSE
.head 4 -  ! Принимаем сообщения
.head 4 +  If GetGlobalOptionEx('BMS') = 1
.head 5 -  Set nSumTime[6] = 0
.head 5 -  Call SalTimerSet(hWndMDI, 6,IifN(GetGlobalOptionEx('BMSINT')<=0, 15000, Min(GetGlobalOptionEx('BMSINT'), 65000)))
.head 5 -  Call SalPostMsg(hWndMDI, SAM_Timer, 6, 0)
.head 4 -  Set nTMOUTAGE = GetGlobalOptionEx('TMOUTAGE')
.head 4 +  If nTMOUTAGE
.head 5 -  Set fLocked = TRUE
.head 5 +  If not cRconnect.IsConnected()
.head 6 -  Call cRconnect.Connect()
.head 5 +  If cRconnect.IsConnected()
.head 6 -  Set nSumTime[5] = 0
.head 6 -  Call SalTimerSet(hWndMDI, 5, 60000)
.head 5 -  Set fLocked = FALSE
.head 4 -  !
.head 4 -  !
.head 4 -  Set bNotifier_Recieve = TRUE
.head 4 -  !
.head 4 -  Call SetMainWindow(hWndMDI)
.head 4 -  !
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_CreateComplete
.head 4 -  Call TComponent.Init(hWndMDI, 2)
.head 4 -  Set hBitmap = XSalBitmapFromResource('bmp3')
.head 4 -  ! Set hBitmap2 = XSalBitmapFromResource('bmp2')
.head 4 -  Call BitMap()
.head 3 +  On UM_Update
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call GetParamsSettings( hSql() )
.head 4 -  ! АБС Барс "Millennium". 
  MSG_UserInfo() GetUserRealName() (branch), 
  MSG_BankDate() SalFmtFormatDateTime(GetBankDate(), ddMMyyyy()) - IifS(IsBankDayOpen(), 'ОТКРЫТ', 'ЗАКРЫТ')
  (cTArchiveDB)
.head 4 -  Call SalSetWindowText(hWndMDI, CurrentLangTable.GetAtomTitle('winMain.cTWndTitle') || ' (' || SqlDatabase || '). ' ||
     MSG_UserInfo() || ' ' || GetUserRealName() || 
     IifS(GetGlobalOption('HAVETOBO')='2', ' (' || GetValueStr("select substr(sys_context('bars_context','user_branch'), 1, 30)  from dual") || ')', '')|| ', ' || 
     MSG_BankDate() || ' ' || SalFmtFormatDateTime(GetBankDate(), ddMMyyyy()) || ' - ' || 
     IifS(IsBankDayOpen(), CurrentLangTable.GetAtomTitle('cTBDOpen'), CurrentLangTable.GetAtomTitle('cTBDClose')) || 
     IifS(not fWorkDB, ' (' || CurrentLangTable.GetAtomTitle('cTArchiveDB') || ')', ''))
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On UM_MenuSelect
.head 4 -  Call Pl_dat( GetBankDate() )
.head 4 -  Call FunRunMenuItem( hSql(), wParam, lParam )
.head 4 -  Call SalSendMsg(hWndMDI, UM_WinMenuSet, 0, 0)
.head 3 +  On UM_WinMenuSet
.head 4 -  Call MDISetMenu()
.head 4 +  ! If SalGetWindowState( hWndForm ) = Window_Maximized
.head 5 -   Set nMenuOffset = 1
.head 4 +  If VisMenuGetText( hWndMDI, VisMenuGetHandle( hWndMDI ), 0 ) = ''
.head 5 -  Set nMenuOffset = 1
.head 4 +  Else
.head 5 -  Set nMenuOffset = 0
.head 4 -  !
.head 4 +  If lParam
.head 5 -  Call VisMenuEnable( VisMenuGetHandle( hWndMDI ), 1 + nMenuOffset)
.head 4 +  Else
.head 5 -  Call VisMenuDisable( VisMenuGetHandle( hWndMDI ), 1 + nMenuOffset)
.head 4 -  !
.head 4 -  Call DrawMenuBar( hWndMDI )
.head 3 +  On UM_WinMenuAction
.head 4 +  Select Case wParam
.head 5 +  Case MDIMenu_Recycle
.head 6 -  Set nListViewStyle = FunGetViewSettings(  )
.head 6 -  Call FunGetMenuSettings( fUseLargeIcons, fAutoSaveSettings )
.head 6 -  Break
.head 5 -  !
.head 5 +  Case MDIMenu_MainMenu
.head 6 -  Call FunRunMainMenu( hWndMDI, hSqlAux(), GetUserId(), IifN(fWorkDB, DB_OPERATIVE, DB_ARCHIVE) )
.head 6 -  Set nListViewStyle = FunGetViewSettings(  )
.head 6 -  Call FunGetMenuSettings( fUseLargeIcons, fAutoSaveSettings )
.head 6 -  Break
.head 5 +  Case MDIMenu_Settings
.head 6 -  Call EditCustomSettings( hSqlAux(), hWndMDI )
.head 6 -  Break
.head 5 +  ! Case MDIMenu_ChangeName
.head 6 -  Call MDIChangeLogin()
.head 6 -  Break 
.head 5 +  Case MDIMenu_ChangePasswd
.head 6 -  Call SalModalDialog(dlg_Passwd, hWndMDI)
.head 6 -  Break
.head 5 +  Case MDIMenu_LockStation
.head 6 -  Call MDILockWorkstation(  )
.head 6 -  Break
.head 5 +  Case MDIMenu_Exit
.head 6 -  ! Вы намерены прекратить работу?
.head 6 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('winMain.cTExit'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo) = IDYES
.head 7 -  Call SalQuit()
.head 6 -  Break
.head 5 -  !
.head 5 +  Case MDIMenu_Accounts
.head 6 -  Call ShowUserAccounts(hWndMDI)
.head 6 -  Break
.head 5 +  Case MDIMenu_Payments
.head 6 -  Call F_Ctrl_D( FALSE )
.head 6 -  Break
.head 5 +  Case MDIMenu_Calc
.head 6 -  Call FinCalc()
.head 6 -  Break
.head 5 +  Case MDIMenu_SendMsg
.head 6 -  Call XNetEditMessage( hWndMDI )
.head 6 -  Break
.head 5 +  Case MDIMenu_CRC
.head 6 +  Select Case lParam
.head 7 +  Case 0
.head 8 -  Call CalcKR( 0 )
.head 8 -  Break
.head 7 +  Case 1
.head 8 -  Call CalcKR( 1 )
.head 8 -  Break
.head 7 +  Case 2
.head 8 -  Call CalcKR( 2 )
.head 8 -  Break
.head 7 +  Case 3
.head 8 -  Call SalModalDialog( dlg_Kurs, hWndMDI )
.head 8 -  Break
.head 7 +  Default
.head 8 -  Break
.head 6 -  Break
.head 5 -  !
.head 5 +  Case MDIMenu_WinCascade
.head 6 -  Call SalMDICascade( hWndMDI )
.head 6 -  Break
.head 5 +  Case MDIMenu_WinCloseAll
.head 6 -  Call MDICloseAllChildren( hWndMDI )
.head 6 -  Break
.head 5 +  Case MDIMenu_WinFSizeAll
.head 6 -  Call MDISetAllMaxSize( hWndMDI )
.head 6 -  Break
.head 5 -  !
.head 5 +  Case MDIMenu_GeneralHelp
.head 6 -  ! Call SalWinHelp( hWndMDI, GetDir() || '\\HELP\\abs.hlp', HELP_Finder, 0, '' )
.head 6 -  Call SalLoadApp( 'WinHlp32.exe', GetHelpFile() )
.head 6 -  Break
.head 5 +  Case MDIMenu_WhoAmI
.head 6 -  Call SalModalDialog( dlg_WhoAmI, hWndMDI )
.head 6 -  Break
.head 5 +  Case MDIMenu_About
.head 6 -  Call SalModalDialog( dlg_About, hWndMDI )
.head 6 -  Break
.head 5 +  Case MDIMenu_MenuChangeDB
.head 6 -  Call SalPostMsg(hWndMDI, UM_Update, 0,0)
.head 6 -  ! Установить текущую схему
.head 6 +  If SqlPLSQLCommand(hSql(), 
    "bars_context.set_cschema('"|| IifS(fWorkDB, DB_SCHEM_OPERATIVE, DB_SCHEM_ARCHIVE)||"')" )
.head 7 -  Call SqlCommitEx(hSql(), 'Переключение в '||IifS(fWorkDB,'перативную','архивную')||' базу')
.head 7 -  Call FunReCreatedARMList( hWndMDI, hSqlAux(), GetUserId(), IifN(fWorkDB, DB_OPERATIVE, DB_ARCHIVE) )
.head 6 +  Else
.head 7 -  Call MessageError('Ошибка переключения!')
.head 5 -  !
.head 5 +  Default
.head 6 -  Break
.head 4 -  Call SalSendMsg(hWndMDI, UM_WinMenuSet, 0, 0)
.head 4 -  Return TRUE
.head 3 +  On UM_MenuComponentSet	! Устанавливаем Меню на "Компонент" (напр., "Счета")
.head 4 -  Call TComponent.SetItem( wParam, lParam )
.head 4 -  Call SalSendMsg(hWndMDI, UM_WinMenuSet, 0, 0)
.head 3 +  On UM_MenuComponentDisable
.head 4 -  Call MDISetMenu()
.head 4 -  Call TComponent.Disable(  )
.head 3 +  On UM_MenuComponentKill
.head 4 -  Call TComponent.Kill(  )
.head 4 -  ! Call SalSendMsg(hWndMDI, UM_WinMenuSet, 0, 0)
.head 3 +  On UM_NetMessage
.head 4 -  Call XNetDispatchMessage( lParam, hWndNULL )
.head 4 +  Select Case wParam
.head 5 +  Case BNTC_APPQUIT
.head 6 -  Call SalQuit()
.head 6 -  Break
.head 5 -  Case BNTC_DAYCLOSE
.head 5 -  Case BNTC_DAYOPEN
.head 5 +  Case BNTC_DATECHANGE
.head 6 -  Call SalPostMsg(hWndMDI, UM_Update, 0, 0)
.head 6 -  Break
.head 5 +  Default
.head 6 -  Break
.head 3 +  On UM_CallFunction
.head 4 -  Call FunRunInternalFunction()
.head 3 +  On WM_Size
.head 4 -  Set nInitialState = SalGetWindowState( hWndMDI )
.head 4 +  If nInitialState = Window_Normal
.head 5 -  Call SalGetWindowSize( hWndMDI, nNormalWidth, nNormalHeigh )
.head 3 +  On WM_Move
.head 4 -  Call SalGetWindowLoc( hWndMDI, nNormalTLX, nNormalTLY )
.head 3 +  On SAM_Timer
.head 4 +  Select Case wParam
.head 5 +  Case 0 ! Смотрим за датой !
.head 6 +  If fCheckBankDay and bNotifier_Recieve
.head 7 -  ! Call Debug('yes')
.head 7 -  Call MDICheckBankDay()
.head 6 -  Break
.head 5 +  Case 1 ! Оповещаем о разном
.head 6 +  If not fLocked
.head 7 -  Set nSumTime[wParam] = nSumTime[wParam] + 60000
.head 7 +  If nSumTime[wParam] >= 300000 ! 5 минут
.head 8 -  Set nSumTime[wParam] = 0
.head 8 +  ! If fElkOper
.head 9 -  Call ElektroDocUser()
.head 8 +  If fElkZaya
.head 9 -  Call ElektroDocUserZaya()
.head 8 +  If GetGlobalOptionEx('REMD_VPS') = 1
.head 9 -  Call MDICheckVPSTransit()
.head 8 +  If GetGlobalOptionEx('REMD_UBM') = 1
.head 9 -  Call MDIUnBundMsg()
.head 6 -  Break
.head 5 +  ! Case 2 ! Оповещаем руководителя о док-тах кл-банк
.head 6 +  If not fLocked
.head 7 -  Set nSumTime[wParam] = nSumTime[wParam] + 60000
.head 7 +  If nSumTime[wParam] >= nPeriodGlobal
.head 8 -  Set nSumTime[wParam] = 0
.head 8 -  Call ElektroDocRuko(sSABi)
.head 6 -  Break 
.head 5 +  Case 3 ! Оповещаем о наличии незавизированных документов
.head 6 +  If not fLocked
.head 7 -  Set nSumTime[wParam] = nSumTime[wParam] + 60000
.head 7 +  If nSumTime[wParam] >= GetGlobalOptionEx('RVISTIME')*60000 ! 1800000 ! 30 минут
.head 8 -  Set nSumTime[wParam] = 0
.head 8 -  Set nOperIsp = GetUserId()
.head 8 +  If SqlPrepareAndExecute(cRconnect.hSql(), "
   SELECT decode(count(q.ref),0,0,1) 
   INTO :nPeriod
   FROM oper p, ref_que q
   WHERE p.ref=q.ref and p.SOS<5 and p.SOS>0 and
         ((p.nextvisagrp=(SELECT substr('0' || chk.to_hex(to_number(val)),-2,2)
                        FROM params
                        WHERE par='SELFVISA') and p.userid=:nOperIsp) or
         (p.nextvisagrp in (SELECT substr('0' || chk.to_hex(s.chkid),-2,2)
                          FROM staff_chk s, otd_user o, otd_user o1
                          WHERE s.id=:nOperIsp and s.id=o.userid and o.otd=o1.otd and o1.userid=p.userid and
                                p.userid<>:nOperIsp) and
         p.nextvisagrp<>(SELECT substr('0' || chk.to_hex(to_number(val)),-2,2)
                       FROM params 
                       WHERE par='SELFVISA')))") and SqlFetchNext (cRconnect.hSql(), nFetchRes) and nPeriod = 1
.head 9 -  Call MessageNoWait("Присутствуют незавизированные документы на контроле!", "В Н И М А Н И Е !",
     GetGlobalOptionEx('RVISTIME')*60-1, 0)
.head 6 -  Break
.head 5 +  Case 4 ! Оповещаем о наличии срочных SWIFT-платежей (EARLY)
.head 6 +  If not fLocked
.head 7 -  Set nSumTime[wParam] = nSumTime[wParam] + 60000
.head 7 +  If nSumTime[wParam] >= GetGlobalOptionEx('RSWTTIME')*60000
.head 8 -  Set nSumTime[wParam] = 0
.head 8 -  Set nOperIsp = GetUserId()
.head 8 +  ! If SqlPrepareAndExecute(cRconnect.hSql(), "
   SELECT decode(count(j.swref),0,0,1),count(j.swref)
   INTO :nPeriod,:nSABiSwift
   FROM sw_journal j, sw_operw w
   WHERE j.date_pay is null and j.swref=w.swref and w.tag='72' and w.value like '%EARLY%' and
         :nOperIsp in (SELECT userid
                       FROM otd_USER
                       WHERE otd=to_number(" || GetGlobalOption('RSWTOTDU') || "))") and
   SqlFetchNext (cRconnect.hSql(), nFetchRes) and nPeriod = 1
.head 9 -  Call MessageNoWait("Имеется " || Str(nSABiSwift) || " срочных SWIFT-платежей (EARLY)!", "В Н И М А Н И Е !",
     GetGlobalOptionEx('RSWTTIME')*60-1, 0)
.head 8 +  If SqlPrepareAndExecute(cRconnect.hSql(), "
   SELECT decode(count(j.swref),0,0,1),count(j.swref)
   INTO :nPeriod,:nSABiSwift
   FROM sw_journal j, sw_operw w
   WHERE j.date_pay is null and j.swref=w.swref and w.tag='72' and w.value like '%EARLY%' and
         :nOperIsp in (SELECT userid
                       FROM otd_USER
                       WHERE otd=to_number(" || Str(Val(GetGlobalOption('RSWTOTDU'))) || "))") and
   SqlFetchNext (cRconnect.hSql(), nFetchRes) and nPeriod = 1
.head 9 -  Call MessageNoWait("Имеется " || Str(nSABiSwift) || " срочных SWIFT-платежей (EARLY)!", "В Н И М А Н И Е !",
     GetGlobalOptionEx('RSWTTIME')*60-1, 0)
.head 6 -  Break
.head 5 +  Case 5 ! Блокирование приложения при простое
.head 6 +  If nTMOUTAGE and not fLocked
.head 7 -  Set nTimeOutage = GetLastInputTime()
.head 7 +  If nTimeOutage >= nTMOUTAGE
.head 8 -  Call MDILockWorkstation()
.head 6 -  Break
.head 5 +  Case 6 ! Принимаем сообщения
.head 6 -  Call MDIGetMessage()
.head 6 -  Break
.head 5 +  Default
.head 6 -  Break
.head 3 +  On SAM_Help
.head 4 -  Call SalPostMsg(hWndMDI, UM_WinMenuAction, MDIMenu_GeneralHelp,0)
.head 3 +  On SAM_Close
.head 4 -  ! Вы намерены прекратить работу?
.head 4 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('winMain.cTExit'), 
   CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo) = IDYES
.head 5 -  Call SalQuit()
.head 4 +  Else
.head 5 -  Return FALSE
.head 3 +  On SAM_Destroy
.head 4 -  Call XNetDown()
.head 4 -  Call MDISetLayout()
.head 4 -  Call TComponent.Destructor()
.head 4 -  Call SalTimerKill(hWndMDI, 0)
.head 4 -  Call SalTimerKill(hWndMDI, 1)
.head 4 -  Call SalTimerKill(hWndMDI, 2)
.head 4 +  If cRconnect.IsConnected(  )
.head 5 -  Call cRconnect.Disconnect(  )
.head 4 -  !
.head 4 +  If cDconnect.IsConnected(  )
.head 5 -  Call cDconnect.Disconnect(  )
.head 4 +  If cElDoc.IsConnected(  )
.head 5 -  Call cElDoc.Disconnect(  )
.head 4 -  Call SaveInfoToLog(MSG_EndApp())
.head 3 -  !
.head 3 +  On WM_MouseMove
.head 4 -  Call BitMap()
.head 3 +  On WM_Paint
.head 4 -  Call BitMap()
.head 1 +  Form Window: winStatusBars   ! СтатусБар
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  11.367"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 0.607"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Форма для создания собственных объектов в statusbar-е
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Банковский день:
.head 4 -  Resource Id: 1819
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    0.024"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfBdate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.733"
.head 6 -  Top:    0.0"
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.23"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfStatus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.05"
.head 6 -  Top:    0.0"
.head 6 -  Width:  1.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Пользователь:
.head 4 -  Resource Id: 1820
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.517"
.head 5 -  Top:    0.024"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfLogin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.917"
.head 6 -  Top:    0.0"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfFIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.317"
.head 6 -  Top:    0.0"
.head 6 -  Width:  3.167"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 1821
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.083"
.head 5 -  Begin Y:  -0.012"
.head 5 -  End X:  0.083"
.head 5 -  End Y:  0.226"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 -  Message Actions
.head 1 -  !
.head 1 +  Dialog Box: dlg_CommandLine  ! Коммандная строка
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: SuperVisor Command Line Center...
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.643"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.229"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Вызов ЛЮБОЙ функции Центуры из команднорй строки
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfCommand
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 512
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.083"
.head 6 -  Width:  7.371"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.271"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfResult
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.5"
.head 6 -  Width:  3.943"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbRun
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Just Do It !
.head 4 -  Window Location and Size
.head 5 -  Left:   4.229"
.head 5 -  Top:    0.479"
.head 5 -  Width:  1.514"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nType =  SalCompileAndEvaluate( SalStrTrimX(dfCommand), nError, nErrPos, nRet, sRet, dRet, hWnd, FALSE, SalContextCurrent(  ) )
.head 6 +  If nType = EVAL_Number
.head 7 -  Set dfResult = SalNumberToStrX( nRet,  0 )
.head 6 +  Else If nType = EVAL_String
.head 7 -  Set dfResult = sRet
.head 6 +  Else If nType = EVAL_Date
.head 7 -  Call SalDateToStr( dRet, dfResult )
.head 6 +  Else If nType = EVAL_Handle
.head 7 -  Set dfResult =  SalNumberToStrX ( SalWindowHandleToNumber(hWnd), 0 )
.head 6 +  Else If nType = EVAL_Set
.head 7 -  Set dfResult = 'Set! Eval Error: ' || SalNumberToStrX( nError, 0) || ' (' ||
SalNumberToStrX( nErrPos, 0 ) || ' )'
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Exit
.head 4 -  Window Location and Size
.head 5 -  Left:   5.9"
.head 5 -  Top:    0.479"
.head 5 -  Width:  1.514"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nType
.head 3 -  Number: nError
.head 3 -  Number: nErrPos
.head 3 -  Number: nRet
.head 3 -  String: sRet
.head 3 -  Date/Time: dRet
.head 3 -  Window Handle: hWnd
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowLoc( hWndForm, 0, 0 )
.head 1 +  Dialog Box: dlg_Passwd       ! Смена пароля
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Смена Пароля
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.6"
.head 4 -  Top:    1.6"
.head 4 -  Width:  5.7"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.5"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Смена пароля пользователя
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 40721
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.05"
.head 5 -  Width:  5.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Старый пароль:
.head 4 -  Resource Id: 51214
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.25"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPasswordOld
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOld
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.85"
.head 6 -  Top:    0.2"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Invisible
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Новый пароль:
.head 4 -  Resource Id: 51215
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.75"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPasswordNew
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNew1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.85"
.head 6 -  Top:    0.7"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Invisible
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalStrIsValidNumber(SalStrLeftX(dfNew1,1))
.head 7 -  ! ЦИФРА в первом символе недопустима
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_Passwd.cTMessNumber'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconHand)
.head 7 -  Return FALSE
.head 3 -  Background Text: Повторите новый пароль:
.head 4 -  Resource Id: 51213
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.05"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPasswordNew2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNew2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.85"
.head 6 -  Top:    1.0"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Invisible
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 40723
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.6"
.head 5 -  Width:  5.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.55"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: F10 - С&менить
.head 4 -  Window Location and Size
.head 5 -  Left:   1.7"
.head 5 -  Top:    1.7"
.head 5 -  Width:  1.657"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F10
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If uf_Passwd()
.head 7 -  Call SalEndDialog(hWndForm, TRUE)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: В&ыход
.head 4 -  Window Location and Size
.head 5 -  Left:   3.55"
.head 5 -  Top:    1.7"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 2 +  Functions
.head 3 +  Function: uf_Passwd
.head 4 -  Description: Таки меняем пароль user'a в oracle :)
.head 4 +  Returns
.head 5 -  Boolean: rr
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlCheck
.head 5 -  String: sUser
.head 5 -  String: sDB
.head 5 -  Number: nErr
.head 5 -  Number: nSqlError
.head 5 -  String: strErrorText
.head 5 -  Number: nErrorPos
.head 5 -  String: strErrorPos
.head 4 +  Actions
.head 5 +  If SalIsNull(dfNew1)
.head 6 -  ! Заполните поле пароль
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_Passwd.cTErrPassw1'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconHand)
.head 6 -  Call SalSetFocus(dfNew1)
.head 6 -  Return FALSE
.head 5 +  If SalIsNull(dfNew2)
.head 6 -  ! Повторите ввод пароля
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_Passwd.cTErrPassw2'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconHand)
.head 6 -  Call SalSetFocus(dfNew2)
.head 6 -  Return FALSE
.head 5 +  If dfNew1 != dfNew2
.head 6 -  ! Новые пароли не совпадают!
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_Passwd.cTErrPassw3'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconHand)
.head 6 -  Call SalSetFocus(dfNew2)
.head 6 -  Return FALSE
.head 5 +  If SalIsNull(dfOld)
.head 6 -  ! Введите старый пароль
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_Passwd.cTMessInputPasswOld'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconHand)
.head 6 -  Call SalSetFocus(dfOld)
.head 6 -  Return FALSE
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call SqlPrepareAndExecute(hSql(), "SELECT user into :sUser from dual")
.head 5 -  Call SqlFetchNext(hSql(), nErr)
.head 5 -  Set sDB = GetDbs()
.head 5 -  Set SqlUser = sUser
.head 5 -  Set SqlDatabase = sDB
.head 5 -  Set SqlPassword = dfOld
.head 5 +  When SqlError
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  ! Неверный пароль!
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_Passwd.cTErrPassw4'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconHand)
.head 6 -  ! Попытка смены пароля. Неверно введен старый пароль!
.head 6 -  Call SaveErrorToLog(CurrentLangTable.GetAtomTitle('dlg_Passwd.cTMessPasswOld'))
.head 6 -  Return FALSE
.head 5 +  If SqlConnect(hSqlCheck)
.head 6 +  When SqlError
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SqlExtractArgs (wParam, lParam, hSqlCheck, nSqlError, nErrorPos)
.head 7 -  Call SqlGetErrorText ( nSqlError, strErrorText )
.head 7 -  Call SalNumberToStr ( nErrorPos, 0, strErrorPos )
.head 7 -  Call SalMessageBox ( 'SQL Error: ' || strErrorText|| 'Error Position: ' || strErrorPos, 'Invalid SQL', 
MB_IconStop|MB_Ok )
.head 7 -  ! Операция по смене пароля выполнилась неуспешно!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_Passwd.cTErrPassw5'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconHand)
.head 7 -  ! Ошибка при смене пароля!
.head 7 -  Call SaveErrorToLog(CurrentLangTable.GetAtomTitle('dlg_Passwd.cTMessErrPasswChange'))
.head 7 -  Call SqlClose(hSqlCheck)
.head 7 -  Return FALSE
.head 6 +  If SqlPLSQLCommand(hSqlCheck, "change_user_password(dfNew1)")
.head 7 -  ! Успешная смена пароля для sUser
.head 7 -  Call SqlCommitEx(hSqlCheck, CurrentLangTable.GetAtomTitle('dlg_Passwd.cTMessPasswChangeOk') || ' ' || sUser)
.head 7 -  Call SqlClose(hSqlCheck)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  ! Пароль успешно сменен. Запомните его!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_Passwd.cTMessPassswSave'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconAsterisk )
.head 7 -  Return TRUE
.head 5 -  Return FALSE
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_Passwd.cTWndTitle'))
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor( FALSE )
.head 1 +  Dialog Box: dlg_About        ! О программе
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: О программе
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.7"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Диалог общей информации о программе.
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfProductName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.4"
.head 6 -  Top:    0.1"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = BARS_FrontName
.head 3 +  Data Field: dfCopyRight
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.4"
.head 6 -  Top:    0.35"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = 'Copyright (c) ' || BARS_Copyright
.head 3 +  Picture: picTitle
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.6"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\Atitle.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: No Border
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalColorSet(hWndItem, COLOR_IndexTransparent, SalColorFromRGB(191, 191, 191))
.head 3 +  Data Field: dfProductVersion
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.4"
.head 6 -  Top:    1.7"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = 'Версия: ' || BARS_Version
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok!
.head 4 -  Window Location and Size
.head 5 -  Left:   2.114"
.head 5 -  Top:    2.25"
.head 5 -  Width:  1.386"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.3"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 5 +  On VTM_KeyDown
.head 6 +  If wParam = VK_F12
.head 7 -  Set nAltStatus = VisGetKeyState(VK_Alt)
.head 7 -  Set nCtlStatus = VisGetKeyState(VK_Control)
.head 7 +  If (nAltStatus & KS_Down) AND (nCtlStatus & KS_Down)
.head 8 -  Call SalModalDialog(dlg_CommandLine, hWndMDI)
.head 3 +  Data Field: dfDelta
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.4"
.head 6 -  Top:    1.95"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If GetGlobalOptionEx('SHOWDLT') = 1
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"select descr, ins_date into :sLibDescr, :dLibDat 
   from be_libs
  where ins_date = (select max(ins_date) from be_libs) and rownum = 1")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"select descr, ins_date into :sPatchDescr, :dPatchDat 
   from be_patches
  where ins_date = (select max(ins_date) from be_patches) and rownum = 1")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If dLibDat > dPatchDat
.head 8 -  Set dfDelta = sLibDescr
.head 7 +  Else
.head 8 -  Set dfDelta = sPatchDescr
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nAltStatus
.head 3 -  Number: nCtlStatus
.head 3 -  String: sLibDescr
.head 3 -  Date/Time: dLibDat
.head 3 -  String: sPatchDescr
.head 3 -  Date/Time: dPatchDat
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 1 +  Dialog Box: dlg_Lock         ! Блокировка рабочего места
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Системная блокировка Рабочего Места
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.7"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.929"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Диалог общей информации о программе.
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: picTitle
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.317"
.head 5 -  Top:    0.179"
.head 5 -  Width:  4.943"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.927"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \BARS98\RESOURCE\BMP\Atitle.bmp
.head 4 -  Storage: Internal
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: No Border
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexTransparent, SalColorFromRGB( 191, 191, 191 ) )
.head 3 -  Background Text: Рабочее место заблокировано!
.head 4 -  Resource Id: 35274
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    1.214"
.head 5 -  Width:  5.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Оно может быть разблокировано пользователем
.head 4 -  Resource Id: 35275
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    1.405"
.head 5 -  Width:  5.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfUserName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.267"
.head 6 -  Top:    1.595"
.head 6 -  Width:  5.033"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = GetUserLoginName() || ' : ' || GetUserRealName()
.head 3 -  Background Text: Пароль:
.head 4 -  Resource Id: 35276
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.017"
.head 5 -  Top:    1.857"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPassword
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPassword
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.133"
.head 6 -  Top:    1.821"
.head 6 -  Width:  2.267"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Invisible
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 +  If not SalIsNull(hWndItem)
.head 7 -  Call SalEnableWindow( pbOk )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( pbOk )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Разблокировать!
.head 4 -  Window Location and Size
.head 5 -  Left:   1.783"
.head 5 -  Top:    2.202"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( pbOk )
.head 5 +  On SAM_Click
.head 6 -  Set SqlUser = GetUserLoginName(  )
.head 6 -  Set SqlDatabase = GetDbs(  )
.head 6 -  Set SqlPassword = dfPassword
.head 6 +  When SqlError
.head 7 -  Call SqlExtractArgs(wParam, lParam, hSqlErrorHandle, nErrorNum, nErrorPos)
.head 7 -  Set strErrorText = SqlGetErrorTextX (nErrorNum)
.head 7 -  ! 01017 - пароль неверный
.head 7 +  If SalStrScan(strErrorText, '01017') != -1
.head 8 -  Call SalMessageBeep( MB_IconStop )
.head 8 -  ! Пароль указан неверно!
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_Lock.cTMessPassword'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok | MB_IconStop )
.head 8 -  ! Ошибка при снятии блокировки рабочего места! Неверный пароль.
.head 8 -  Call SaveErrorToLog( CurrentLangTable.GetAtomTitle('dlg_Lock.cTMessBlock') )
.head 8 -  Set dfPassword = ''
.head 8 -  Call SalDisableWindow( pbOk )
.head 8 -  Call SalSetFocus ( dfPassword )
.head 8 -  !
.head 8 -  Set bShowSqlError = FALSE
.head 8 -  Set nCountConnect = nCountConnect + 1
.head 8 +  If nCountConnect = 3
.head 9 -  Call SalQuit()
.head 8 -  Return FALSE
.head 6 +  If SqlConnect( hSqlProbe )
.head 7 -  Call SqlDisconnect( hSqlProbe )
.head 7 -  ! Режим блокировки рабочего места снят
.head 7 -  Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('dlg_Lock.cTMessOff') )
.head 7 -  Call SalEndDialog( hWndForm, 0 )
.head 7 -  Set bShowSqlError = TRUE
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Sql Handle: hSqlProbe
.head 3 -  Number: nCountConnect
.head 3 -  !
.head 3 -  Sql Handle: hSqlErrorHandle
.head 3 -  Number: nErrorNum
.head 3 -  Number: nErrorPos
.head 3 -  String: strErrorText
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_Lock.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  ! Call SaveInfoToLog( 'Включен режим блокировки рабочего места' )
.head 4 -  Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('dlg_Lock.cTMessOn') )
.head 4 -  Set bShowSqlError = TRUE
.head 4 -  Set nCountConnect = 0
.head 3 +  On SAM_Close
.head 4 -  Return FALSE
.head 1 +  Dialog Box: dlg_WhoAmI       ! Кто я? Где я? И где мои вещи?
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Информация о пользователе
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   5.013"
.head 4 -  Top:    1.906"
.head 4 -  Width:  6.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.65"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? No
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.1"
.head 5 -  Width:  6.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  ! Персональный статус 
.head 3 -  Background Text: Персональный статус 
.head 4 -  Resource Id: 21181
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.05"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPersonalStatus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: ID  в АБС:
.head 4 -  Resource Id: 40921
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.3"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgABSId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfABSId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    0.298"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = GetUserId()
.head 3 -  Background Text: Рабочее имя:
.head 4 -  Resource Id: 40922
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.243"
.head 5 -  Top:    0.55"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgLoginName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLoginName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    0.548"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = GetUserLoginName()
.head 3 -  Background Text: Реальное имя:
.head 4 -  Resource Id: 40923
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.243"
.head 5 -  Top:    0.8"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRealName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRealName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    0.798"
.head 6 -  Width:  3.529"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = GetUserRealName()
.head 3 -  Background Text: Привелегии:
.head 4 -  Resource Id: 40926
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.243"
.head 5 -  Top:    1.05"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPrivs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPrivs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    1.048"
.head 6 -  Width:  3.529"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If SqlPrepareAndExecute(hSql(), '
   SELECT c.name
   INTO :MyValue
   FROM staff s, staff_class c
   WHERE c.clsid=s.clsid and id=:dfABSId')
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 3 +  Picture: pic2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.37"
.head 5 -  Width:  6.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.02"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  ! Рабочие параметры 
.head 3 -  Background Text: Рабочие параметры 
.head 4 -  Resource Id: 21182
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.3"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgWorkParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Рабочая БД:
.head 4 -  Resource Id: 40925
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.55"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    1.548"
.head 6 -  Width:  3.529"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = GetDbs()
.head 3 -  Background Text: Тип СУБД:
.head 4 -  Resource Id: 40924
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.8"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDBMSType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDBMSType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    1.798"
.head 6 -  Width:  3.529"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = SalStrUpperX(GetDBMS())
.head 3 -  Background Text: Каталог печати:
.head 4 -  Resource Id: 40927
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.05"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPrintDir
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPrintDir
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    2.048"
.head 6 -  Width:  3.529"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = GetPrnDir()
.head 3 -  ! Параметры лицензии
.head 3 -  Background Text: Параметры лицензии
.head 4 -  Resource Id: 62213
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.3"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgLic
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Дата окончания лицензии:
.head 4 -  Resource Id: 62218
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.55"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgExpDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfExpDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    2.548"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Лимит пользователей:
.head 4 -  Resource Id: 62214
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.8"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgLimitAccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLimitAccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    2.798"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Постоянных пользователей:
.head 4 -  Resource Id: 62216
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    3.05"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPermAccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPermAccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    3.048"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Временных пользователей:
.head 4 -  Resource Id: 62215
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    3.3"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTempAccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTempAccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.8"
.head 6 -  Top:    3.298"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 62217
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    3.65"
.head 5 -  Width:  6.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.6"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok!
.head 4 -  Window Location and Size
.head 5 -  Left:   2.8"
.head 5 -  Top:    3.8"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.3"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  String: sCurDir
.head 3 -  String: sPictureDir
.head 3 -  Number: nXa
.head 3 -  Number: nYa
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalFileGetCurrentDirectory(sCurDir)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Common Parameters', 'PictureDir', sCurDir, sPictureDir, GetIniFileName())
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_WhoAmI.cTWndTitle'))
.head 4 -  !
.head 4 -  Call SqlPrepareAndExecute(hSql(), 
"select license_expired, limit_account, perm_account, temp_account
   into :dfExpDate, :dfLimitAccount, :dfPermAccount, :dfTempAccount 
   from v_license_usage")
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 +  If dfExpDate - SalDateCurrent() < 31
.head 5 -  Call SalColorSet(dfExpDate, COLOR_IndexWindowText, COLOR_Red)
.head 4 +  If dfPermAccount > dfLimitAccount
.head 5 -  Call SalColorSet(dfPermAccount, COLOR_IndexWindowText, COLOR_Red)
.head 4 +  If dfTempAccount > 0
.head 5 -  Call SalColorSet(dfTempAccount, COLOR_IndexWindowText, COLOR_Red)
.head 1 +  ! Dialog Box: dlg_ElkInfoRuk   ! Информация руководителю о док-тах Кл-Банк.
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Необработанные документы электронных клиентов
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.1"
.head 4 -  Top:    0.625"
.head 4 -  Width:  15.083"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.488"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Blue
.head 3 -  Background Color: Default
.end
.head 2 -  Description: информация руководящему составу о документах КЛИЕНТ-БАНК
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 +  Child Table: tbl1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  15.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Light Periwinkle
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 3333
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: col1
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: СчетА             МфоБ      СчетБ             Наименование получателя                             Сумма   
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 106
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  10.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 -  Window Variables 
.head 4 -  Message Actions 
.head 3 +  Pushbutton: pb1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: OK!
.head 4 -  Window Location and Size
.head 5 -  Left:   6.667"
.head 5 -  Top:    4.786"
.head 5 -  Width:  1.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  ! Call SalTimerSet(hWndItem, 3, 45000)
.head 6 -  ! Call SalTimerSet(hWndItem, 3, nPeriodGlobal/5)
.head 6 -  Call SalTimerSet(hWndItem, 3, 1000)
.head 5 +  On SAM_Click
.head 6 -  Call SalTimerKill(hWndItem, 3)
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 5 +  On SAM_Timer
.head 6 -  Set nTm = nTm + 1
.head 6 +  If nTm > nTz
.head 7 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 6 +  Else 
.head 7 -  Call SalSetWindowText(hWndItem, 'OK! (' || Str(nTz-nTm) || ')')
.head 2 -  Functions 
.head 2 +  Window Parameters 
.head 3 -  String: smPokaz[*]
.head 3 -  Number: nKwo
.head 2 +  Window Variables 
.head 3 -  Number: nNewRow
.head 3 -  Number: nI
.head 3 -  String: sText
.head 3 -  Number: nTz
.head 3 -  Number: nTm
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Set nTm = 0
.head 4 -  Set nTz = Int(nPeriodGlobal / 5000)
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalGetWindowText(hWndForm, sText, 99)
.head 4 -  Call SalSetWindowText(hWndForm, sText || ' (' || SalFmtFormatDateTime(
     SalDateCurrent(), 'hhhh:mm:ss') || ')')
.head 4 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set nI = 0
.head 4 +  While nI < nKwo
.head 5 -  Set nNewRow =  SalTblInsertRow(tbl1, TBL_MaxRow)
.head 5 -  Call SalTblSetContext(tbl1, nNewRow)
.head 5 -  Call SalTblSetFocusRow(tbl1, nNewRow)
.head 5 -  Set tbl1.col1 = smPokaz[nI]
.head 5 -  ! Call SalTblSetRowFlags(tbl1, nNewRow, ROW_New, FALSE)
.head 5 -  ! Call SalMessageBeep(MB_Ok)
.head 5 -  Set nI = nI + 1
.head 4 -  Call SalTblSetFocusRow(tbl1, 0)
.head 4 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected | ROW_New, FALSE, 0, 0)
.head 4 -  Call SalSetFocus(pb1)
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  Call PlaySound('DING.WAV', 1, 1)
.head 1 -  !
.head 1 +  Dialog Box: dlg_KR
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.5"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: df1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.171"
.head 6 -  Top:    0.281"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.202"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    0.229"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalColorSet( dfMFO, COLOR_IndexWindowText, COLOR_Black )
.head 6 -  Set dfAcc = ''
.head 3 +  Data Field: dfNB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.186"
.head 6 -  Top:    0.76"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.171"
.head 6 -  Top:    0.844"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.202"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    0.792"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalColorSet( dfAcc, COLOR_IndexWindowText, COLOR_Black )
.head 3 +  Pushbutton: pbCalc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рассчитать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.548"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If nPar = 0
.head 7 +  If SalIsNull( dfMFO ) or SalIsNull( dfAcc )
.head 8 -  ! Некорректно введены данные
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_KR.cTErrData'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Set dfAcc = Vkrz2( dfMFO, dfAcc)
.head 8 -  Call SalColorSet( dfAcc, COLOR_IndexWindowText, COLOR_DarkGreen )
.head 6 +  If nPar = 1
.head 7 +  If SalIsNull( dfMFO ) or SalStrLength( dfMFO ) < 6
.head 8 -  ! Некорректно введены данные
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_KR.cTErrData'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Call SalStrTrim( dfMFO, sMFO )
.head 8 -  Set nMFO = SalStrToNumber( sMFO )
.head 8 -  Set nWeight[0] = 1
.head 8 -  Set nWeight[1] = 3
.head 8 -  Set nWeight[2] = 7
.head 8 -  Set nWeight[3] = 1
.head 8 -  Set nWeight[4] = 3
.head 8 -  Set i = 0
.head 8 -  Set nSumDigits = 0
.head 8 +  While i < 5
.head 9 -  Set nSumDigits = nSumDigits +
    GetLastDigit( nWeight[ i ] * GetDigit( nMFO, i ))
.head 9 -  Set i = i + 1
.head 8 -  Set nSumDigits = GetLastDigit( nSumDigits * 7 )
.head 8 -  Set dfMFO = Left( sMFO, SalStrLength(sMFO)-1 ) || Str( nSumDigits )
.head 8 -  Call SalColorSet( dfMFO, COLOR_IndexWindowText, COLOR_DarkGreen )
.head 8 -  !
.head 8 -  Set dfNB = ''
.head 8 -  Call SqlPrepareAndExecute( hSql(), 
"SELECT nb INTO :dfNB
 FROM banks WHERE mfo=:dfMFO" )
.head 8 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 6 +  If nPar = 2
.head 7 +  If SalIsNull( dfMFO ) or ( SalStrLength(dfMFO) < 8 and SalStrLength(dfMFO) != 3)
.head 8 -  ! Некорректно введены данные
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_KR.cTErrData'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Set dfMFO = V_Okpo( dfMFO )
.head 8 -  Call SalColorSet( dfMFO, COLOR_IndexWindowText, COLOR_DarkGreen )
.head 3 +  Pushbutton: pbRef
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Справочник
.head 4 -  Window Location and Size
.head 5 -  Left:   2.217"
.head 5 -  Top:    1.548"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.405"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If nPar = 1
.head 7 -  Call FunNSIGet( "BANKS_V", "NB", dfMFO, dfNB )
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   4.05"
.head 5 -  Top:    1.548"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.405"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 3 -  Frame
.head 4 -  Resource Id: 27255
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.07"
.head 5 -  Top:    1.4"
.head 5 -  Width:  5.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 27256
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.07"
.head 5 -  Top:    0.05"
.head 5 -  Width:  5.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.3"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  ! 0 - КР счета
  1 - КР МФО
  2 - КР ОКПО
.head 2 +  Window Variables
.head 3 -  String: sMFO
.head 3 -  Number: nMFO
.head 3 -  Number: nWeight[5]
.head 3 -  Number: nSumDigits
.head 3 -  Number: i
.head 3 -  String: sTitle
.head 3 -  Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_KR.cTWndTitle'))
.head 4 +  If nPar = 0     ! КР Счета
.head 5 -  ! Set sTitle = 'Расчет КР Счета'
.head 5 -  Set sTitle = CurrentLangTable.GetAtomTitle('dlg_KR.cTWndTitleKRAcc')
.head 5 -  Set dfMFO = GetBankMfo()
.head 5 -  ! Set df1 = 'МФО :'
.head 5 -  Set df1 = CurrentLangTable.GetAtomTitle('dlg_KR.cTMfo') || ' :'
.head 5 -  ! Set df2 = 'Счет :'
.head 5 -  Set df2 = CurrentLangTable.GetAtomTitle('dlg_KR.cTAcc') || ' :'
.head 5 -  Call SalHideWindow( pbRef )
.head 4 +  If nPar = 1     ! КР МФО
.head 5 -  ! Set sTitle = 'Расчет КР МФО'
.head 5 -  Set sTitle = CurrentLangTable.GetAtomTitle('dlg_KR.cTWndTitleKRMfo')
.head 5 -  ! Set df1 = 'МФО :'
.head 5 -  Set df1 = CurrentLangTable.GetAtomTitle('dlg_KR.cTMfo') || ' :'
.head 5 -  Call SalHideWindow( df2 )
.head 5 -  Call SalHideWindow( dfAcc )
.head 4 +  If nPar = 2     ! КР ОКПО
.head 5 -  ! Set sTitle = 'Расчет КР ОКПО'
.head 5 -  Set sTitle = CurrentLangTable.GetAtomTitle('dlg_KR.cTWndTitleKROkpo')
.head 5 -  ! Set df1 = 'ОКПО :'
.head 5 -  Set df1 = CurrentLangTable.GetAtomTitle('dlg_KR.cTOkpo') || ' :'
.head 5 -  Call SalHideWindow( df2 )
.head 5 -  Call SalHideWindow( dfAcc )
.head 5 -  Call SalHideWindow( pbRef )
.head 4 -  ! If nPar = 3     ! Курс валют
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetWindowText( hWndForm, sTitle )
.head 1 +  Dialog Box: dlg_Kurs
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Расчет эквивалента валют
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.49"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Дата :
.head 4 -  Resource Id: 3290
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.143"
.head 5 -  Top:    0.198"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.5"
.head 6 -  Top:    0.188"
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfDat = GetBankDate()
.head 5 +  On SAM_AnyEdit
.head 6 -  Set dfS  = NUMBER_Null
.head 6 -  Set dfS2 = NUMBER_Null
.head 3 -  Background Text: Валюта :
.head 4 -  Resource Id: 3289
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.157"
.head 5 -  Top:    0.573"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.5"
.head 5 -  Top:    0.542"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.26"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbVal.Init( hWndItem )
.head 7 -  Call cmbVal.Populate( hSql(), 'kv', 'name', 'tabval', 'ORDER BY name' )
.head 5 +  On SAM_Click
.head 6 -  Set dfS  = NUMBER_Null
.head 6 -  Set dfS2 = NUMBER_Null
.head 6 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 -  Set nKV = cmbVal.GetCurrentKey()
.head 3 -  Background Text: Сумма :
.head 4 -  Resource Id: 3291
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.143"
.head 5 -  Top:    0.948"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.5"
.head 6 -  Top:    0.896"
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Set dfS2 = NUMBER_Null
.head 3 +  Combo Box: cmbVal2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.129"
.head 5 -  Top:    0.542"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.26"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbVal2.Init( hWndItem )
.head 7 -  Call cmbVal2.Populate( hSql(), 'kv', 'name', 'tabval', 'ORDER BY name' )
.head 7 -  Call cmbVal2.SetSelectById( GetBaseVal() )
.head 7 -  Set nKV2 = cmbVal2.GetCurrentKey()
.head 5 +  On SAM_Click
.head 6 -  Set dfS2 = NUMBER_Null
.head 6 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 -  Set nKV2 = cmbVal2.GetCurrentKey()
.head 3 +  Data Field: dfS2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.129"
.head 6 -  Top:    0.896"
.head 6 -  Width:  2.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Decimal
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbCalc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рассчитать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.686"
.head 5 -  Top:    1.531"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If nKV != 0 AND dfS != NUMBER_Null AND nKV2 != 0
.head 7 +  If not SqlPLSQLCommand( hSql(),"gl.x_rat(nRatO,nRatB,nRatS,nKV,nKV2,dfDat)")
.head 8 -  Set dfS2 = NUMBER_Null
.head 7 +  Else
.head 8 -  Set dfS2 = dfS*nRatO
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   4.8"
.head 5 -  Top:    1.531"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.396"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 3 -  Frame
.head 4 -  Resource Id: 3292
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.057"
.head 5 -  Top:    0.031"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.3"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 3293
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.057"
.head 5 -  Top:    1.385"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nKV
.head 3 -  Number: nKV2
.head 3 -  Number: nRatO
.head 3 -  Number: nRatB
.head 3 -  Number: nRatS
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_Kurs.cTWndTitle'))
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetFocus(pbExit)
.head 1 +  ! Dialog Box: dlg_ReLogin
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ReLogin Window
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.388"
.head 4 -  Top:    0.969"
.head 4 -  Width:  6.633"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.845"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 +  Data Field: df1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.119"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.286"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  ! On VTM_KeyUp
.head 6 -  Call KeyS(wParam)
.head 3 +  Data Field: df2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.512"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.286"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  ! On VTM_KeyUp
.head 6 -  Call KeyS(wParam)
.head 3 +  Pushbutton: pbYes
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Да
.head 4 -  Window Location and Size
.head 5 -  Left:   0.533"
.head 5 -  Top:    1.095"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 5 +  On VTM_KeyUp
.head 6 -  Call KeyS(wParam)
.head 3 +  Pushbutton: pbNo
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Нет
.head 4 -  Window Location and Size
.head 5 -  Left:   4.833"
.head 5 -  Top:    1.095"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 1)
.head 5 +  On VTM_KeyUp
.head 6 -  Call KeyS(wParam)
.head 2 +  Functions 
.head 3 +  Function: KeyS
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: nParam
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call SaveInfoToLog('1-' || Str(nParam))
.head 5 +  If nParam = 122
.head 6 -  Set n1 = 1
.head 5 +  Else 
.head 6 +  If nParam = 123
.head 7 +  If n1 = 1
.head 8 -  Call SalEndDialog(hWndForm, 2)
.head 6 +  Else 
.head 7 -  ! Call SaveInfoToLog('2-' || Str(nParam))
.head 7 -  Set n1 = 0
.head 2 -  Window Parameters 
.head 2 +  Window Variables 
.head 3 -  Number: n1
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call SalMapEnterToTab(FALSE)
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! Set df1 = 'NO CHANGE USERNAME for'
.head 4 -  ! Set df2 = 'version 3.877 and later - Exit ?'
.head 4 -  Set df1 = 'Для версий программы 3.877 и выше'
.head 4 -  Set df2 = 'данная опция отключена - Выход ?'
.head 4 -  Set n1 = 0
.head 3 +  On VTM_KeyUp
.head 4 +  Call KeyS(wParam)
.head 5 -  Call SalEndDialog(hWndForm, 2)

.head 3 +  On SAM_Create
.head 4 -  Call SalMapEnterToTab(FALSE)
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  ! Set df1 = 'NO CHANGE USERNAME for'
.head 4 -  ! Set df2 = 'version 3.877 and later - Exit ?'
.head 4 -  Set df1 = 'Для версий программы 3.877 и выше'
.head 4 -  Set df2 = 'данная опция отключена - Выход ?'
.head 4 -  Set n1 = 0
.head 3 +  On VTM_KeyUp
.head 4 +  Call KeyS(wParam)
.head 5 -  Call SalEndDialog(hWndForm, 2)
