Application Description: ОБ ЭНЕРГОРЫНОК
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000001D0100 002C000000020000 0003000000000000 001C020000F8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001D51 3A5C424152533938 5C4C494252415259 5C42415253303135
0020: 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42 4152533031352E61
0040: 706300000101011D 513A5C4241525339 385C4C4942524152 595C424152533031
0060: 352E72756E1D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0080: 646C6C1D513A5C42 41525339385C4C49 42524152595C4241 52533031352E6170
00A0: 630000010101185C 6261727339385C42 494E5C4241525330 34302E617064200C
00C0: 5C6261727339385C 42494E5C0C5C6261 727339385C42494E 5C0001010101001D
00E0: 513A5C4241525339 385C4C4942524152 595C424152533031 352E646C6C1D513A
0100: 5C4241525339385C 4C4942524152595C 424152533031352E 6170630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: Genlist.apl
		File Include: Gentbl.apl
		File Include: GENTBLF.APL
		File Include: GENTBLS.APL
		File Include: vttblwin.apl
		File Include: Docfun6.apl
		File Include: Xsalcpt.apl
		File Include: vtcal.apl
		File Include: qckdvc.apl
		File Include: Vtfile.apl
		Dynalib: Nsiapi.apd
		Dynalib: CustAcnt.apd
		Dynalib: DOCVIEW.APD
		Dynalib: cc_input.apd
		Dynalib: Bars001.apd
		!
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Number: ###0
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				String: ApdNum   =  '40'
				String: ApdVer   =  '03'
				! История изменений: -----------------------------------------------------|
				! 01 13-05-05  MIK     Начало Регулярных платежей                         |
				! 02 02-06-08  Nata    Перевод депозитов отделений                        |
				! 03 04-06-08  Nata    Перевод депозитов отделений: исправлен sqlPopulate |
						!                      + галочка "не открывать сущ-щие депозиты"          |
				! 04
		Resources
		Variables
.data RESOURCE 0 0 1 2328934428
0000: 1E00000011000000 0000000000000000 02000001000000D6 000000E0010D0000
0020: 00FF3F
.enddata
			Number: nHaveTOBO
			Window Handle: hWin0
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hWin3
			Window Handle: hWin4
			Window Handle: hWin5
			Window Handle: hWin10
			Window Handle: hWin33
			Number: nFetchRes
			Window Handle: hTK
			Window Handle: hKOB
			Window Handle: hKOB1
			Window Handle: hKOB2
			Window Handle: hKOB3
			Window Handle: hOB
			Window Handle: hVVR
			! Window Handle: h23
			Date/Time: dtDat1
			Date/Time: dtDat2
		Internal Functions
			Function: Sel040	! __exported
				Description: Bars040_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
					String: strFilters[*]
					Number: nIndex
					Number: nRet
					String: strFileName
					String: sSPECIFIC
					String: sTxt
					File Handle: hFile
				Actions
					! надо вставить инициализацию apd
					Set nHaveTOBO = GetGlobalOptionEx('HAVETOBO')
					Select Case nMode
						Case 0 !! Взаєморозрахунки згідно протоколов в АБС ГОУ
							If not IsWindow(hWin1)
								Set hWin1 = SalCreateWindow( ENR1, hWndMDI, nMode, nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin1 )
							Break
						! В БД протоколів
						Case 1 !! Просмотр и Ввод  протоколов в ГОУ
							If not IsWindow(hWin1)
								Set hWin1 = SalCreateWindow( ENR1, hWndMDI, nMode, nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin1 )
							Break
						Case 2 !! Просмотр протоколов и ввод платежек в Филиале - WEB
							If not IsWindow(hWin1)
								Set hWin1 = SalCreateWindow( ENR1, hWndMDI, nMode, nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin1 )
							Break
						!
						Case 5 !! Формування файлів згідно протоколов в АБС ГОУ
							If not IsWindow(hWin1)
								Set hWin1 = SalCreateWindow( ENR1, hWndMDI, nMode, nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin1 )
						Case 11 !! Картотека кредитових надходжень (Комісія ОБ)
							If not IsWindow(hKOB)
								Set hKOB = SalCreateWindow( KOB, hWndMDI, nMode, nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hKOB )
							Break
						Case 12 !! Розподіл сум для компенсаційних вкладів
							If not IsWindow(hTK)
								Set hTK = SalCreateWindow( TK, hWndMDI, nMode, nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hTK )
							Break
						Case 13 !! KOB - просмотр первичных док
							Call SalCreateWindow( KOB4, hWndMDI, nMode, nPar, strPar01,strPar02 )
							Break
						!
						Case 21 !! Контроль внутрiшн.рахункiв за типами ТВБВ (ЦВ)
							Call SalCreateWindow( BTI, hWndMDI,nMode, nPar,strPar01,strPar02)
							Break
						Case 22 !! Контроль спец.парам OB22
							If not IsWindow(hOB)
								Set hOB = SalCreateWindow( OB, hWndMDI, nMode, nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hOB )
							Break
						Case 23 !! Гляделка для DEPSBER
							Set dtDat1 = GetBankDate()
							Set dtDat2 = GetBankDate()
							Call SalCreateWindow( RES, hWndMDI,nMode, "","", FALSE,TRUE,FALSE, FALSE, 1, dtDat1, dtDat2)
							Break
						Case 24 !! Гляделка для DEPSBER
							Set dtDat1 = GetBankDate()
							Set dtDat2 = GetBankDate()
							Call SalCreateWindow( RES, hWndMDI,nMode, "","", TRUE,FALSE,FALSE, FALSE, 1, dtDat1, dtDat2)
							Break
						!
						! Case 30
							                                                  Call SalCreateWindow(tblView, hWndParent, nPar, strPar01, strPar02)
							                                                  Break 
						! Case 31
							                                                 Call SalCreateWindow(tblView2, hWndParent, nPar, strPar01, strPar02)
							                                                 Break 
						Case 31
							Call SalCreateWindow(frmView4, hWndParent, nPar, strPar01, strPar02)
							Break
						Case 32
							Call SalCreateWindow(tblView3, hWndParent, nPar, strPar01, strPar02)
							Break
						Case 33
							If not IsWindow(hWin33)
								Set hWin33 = SalCreateWindow(frmChangeTobo, hWndMDI, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin33)
							Break
						!
						Case 35 !! ОБ ГОУ - XML - Кліринговий файл по платіжним системам (від ПРОФІКС)
								Див. D:\profix\ 
							Set strFilters[0] = 'Кліринг-файл по платіжним системам (PROFIX)'
							Set strFilters[1] = '*.xml'
							Set nIndex = 1
							If not SalDlgOpenFile ( hWndForm, 'Вибір електронного документу', strFilters, 2, nIndex, strFileName, sSPECIFIC )
								Return FALSE
							If GetGlobalOptionEx ('SIGN_PROFIX') = 1
							Else
								! Проверка подписи на файл
								Call SalLoadAppAndWait('bars.checkXml.exe '|| Str(nPar) || ' ' || strFileName, 2, nRet) 
								If nRet !=100 !! если проверка не прошла
									If nRet=2 !! не найдено файл bars.checkXml.exe
										Call MessageNoWait('Не знайдено файл  bars.checkXml.exe для перевірки підпису на файлі ! Імпорт файлу неможливий.', 'У В А Г А, помилка перевірки підпису на файлі ! ', 15, 1)
									Else If nRet=101 !! подпись не верна
										Call MessageNoWait('Підпис на файлі ' || strFileName || ' не вірний! Імпорт файлу неможливий.', 'У В А Г А, помилка перевірки підпису на файлі ! ', 15, 1)
									Else If nRet >100 !! ошибка проверки подписи 
										Call MessageNoWait('Помилка перевірки підпису на файлі ' || strFileName || '! Перегляньте лог-файл для уточнення проблеми.', 'У В А Г А, помилка перевірки підпису на файлі ! ', 15, 1)
										Call SalLoadApp('bars.checkXml.exe', '3')  !! загрузка лог-файла
									Else !! что-то другое
										Call MessageNoWait('Системна помилка перевірки підпису на файлі, код= ' || Str(nRet) || '! Імпорт файлу неможливий.', 'У В А Г А, помилка перевірки підпису на файлі ! ', 15, 1)
									Return FALSE
							! -------
							Set sTxt = 'Виконано iмпорт файла в БД 
									' || strFileName || ' 
									Оргiнал файлу буде вилучено !'
							If PutFileToTmpLob( hSql(), strFileName, 'C')
								If SqlPLSQLCommand( hSql(), "monex.GET_FIle(0)" )
									Call SqlCommitEx( hSql(),sTxt )
									!
									Call SalWaitCursor(FALSE)
									Call MessageNoWait( sTxt, 'Перегляньте його в таблиці АБС',10,0)
									!
									If SalFileOpen( hFile, strFileName, OF_Delete )
										Call MessageNoWait(  'Оргiнал файлу вилулено.', ' У В А Г А ! ', 10,0)
									Else
										Call MessageNoWait(  'Неможливо вилучити Оргiнал файлу ! ',' *** У В А Г А ! ***',10,0)
									! Call FunNSIEditF("MONEXR",1)
									Return TRUE
								Else
									Return FALSE
								! Call SqlCommit(  hSql() )
							Else
								Call MessageNoWait('HE ' || sTxt, 'У В А Г А, погані новини ! ', 5, 1)
								Return FALSE
							Break
						!
						Case 100
							If not IsWindow( hVVR )
								Set hVVR = SalCreateWindow(VVR, hWndMDI, nMode, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop( hVVR )
							Break
						Case 2012 !! До виплати в 2012 р. Компенсації вкладникам Сбербанку СРСР.
							Call SalCreateWindow( K2012, hWndMDI, nMode, nPar, strPar01, strPar02 )
							Break
						!
						Case 2015 !! Селектор по разводу портфелей дебиторки
							If nPar = 0 or nPar = 1  
								Call FunNSIEditFFiltered("FIN_DEBVC" , 0, " PROD='" || strPar01 ||"'" )
							Else If nPar = 2
								Call CC_INKRE(hWndMDI, 92,0,15)
							Else If nPar = 3
								Call CC_INKRE(hWndMDI, 93,0,15)
							Else If nPar = 4
								Call Sel001( hWndMDI, 3, 99, "ELT", "" )
							Break
						Default
							Break
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 37876618
0000: 2C03000080010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F61003C00 000B5F005F457272
0040: 6F72426100736556 0100000D003C0000 010DFA0000FF6F0D 00EE0100FF3F1A00
0060: B800000100FFFFE0 2700000001FE00FF 03340000000204F8 000000FF0F380000
0080: 00EE0200FF3F3C00 B800000200FFFF80 40000000030400FE 00FF834400000002
00A0: FB00FF0F48000000 EE0200FF3F4C00B8 00000300FFFFE050 00000003FE00FF83
00C0: 5400000001FB00FF 0F01800D00110001 0000065F005F466C 61671E0000EC0001
00E0: 00D9010D00FF7F01 08801A0000020000 00000B6351756963 6B805461626C6538
0100: 00EC000200D9010D 00FF7F0D73000100 FFFF010180220000 0003000000000A63
0120: 47656E0046696C74 65727400D0000004 00003302040001FA 0000078001000000
0140: FFC60400010DFE00 FF831100000002FB 00FF0F15000000EE 0100FF3F01806622
0160: 0004001A0B474446 697F00F604008E02 000100FE00C98001 0000BF04B100010D
0180: 00FFFFE6110002FE 00FF9B150001FB00 FF0F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbSwitch
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box: cGenComboBox_StrId
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	Table Window: ENR5
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: 1000
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  17.267"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54900
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.45"
						Begin Y:  Class Default
						End X:  5.45"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54901
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54902
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_File
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\TOMAIL.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Генерувати ' || strTitle
						On SAM_Click
							If VZ_DAT = DATETIME_Null OR VZ_DAT != GetBankDate()
								Call SalMessageBox( "Дата взаєморозрахунку НЕ рівна поточній банківській даті !", "УВАГА !", MB_IconStop)
							Else
								If SalMessageBox( strTip , 'У В А Г А ! ', MB_YesNo | MB_IconQuestion )=IDYES
									If SqlPLSQLCommand( hSql(), "enr_fn (REF_PROT)" ) 
											and SqlCommitEx( hSql(), strTip )
										Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
									Else
										Call SqlRollback( hSql() )
				Data Field: VZ_DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.85"
							Top:    0.095"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата взаєморозрахунку')
				Data Field: dTitl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.15"
							Top:    0.095"
							Width:  2.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№, Дата протоколу')
		Contents
			Column: nPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REFD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: РефД
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REFK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: РефК
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FILE_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Файл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RECD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: REC-Д
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RECK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: REC-К
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: OTM
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата/Время
						создания
						файла
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Right
				Width:  1.883"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SDE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						 (дебет)
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SKR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма 
						(кредит)
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: N
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						строк
				Visible? Yes
				Editable? No
				Maximum Data Length: 5
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата/Время
						квитовки 
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Right
				Width:  1.8"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: REF_PROT
			String: sTT !! Цепочка кодов операции = 'TT0,TTK,TTD'
			String: NLST !! Счет - транзит 
			String: strTitle
		Window Variables
			Number: nOTM
			! Number: nRec
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, strTitle  )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				If SqlPrepareAndExecute( hSql(),
						"SELECT id ||'  від '|| to_char( DAT,'dd/mm/yyyy'),VZ_DAT
						 into :dTitl, :VZ_DAT from enr_prot WHERE ref = :REF_PROT " ) 
						and NOT SqlFetchNext( hSql(),nFetchRes) 
					Call SalDestroyWindow(hWndForm)
				!
				Call SalSendClassMessage( SAM_Create, 0, 0 )
				!
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set nOTM = 3
				Call SalTblPopulate(hWndForm,hSql(), 
						"SELECT e.NPP, e.MFO, b.nb, e.REFD, e.REFK, e.FILE_NAME, e.RECD, e.RECK, e.OTM
						 INTO :ENR5.nPP, :ENR5.MFO, :ENR5.NB,:ENR5.REFD,:ENR5.REFK,:ENR5.FILE_NAME,
						      :ENR5.RECD,:ENR5.RECK,:ENR5.OTM       
						 FROM enr_file e, banks b 
						 WHERE e.mfo=b.mfo and e.ref_prot=:ENR5.REF_PROT    
						 ORDER BY e.npp ", TBL_FillAll)
				If nOTM = 1 
					Call SalEnableWindow( pb_File )
				Else
					Call SalDisableWindow( pb_File )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_ColumnSelectClick
			! On SAM_DoubleClick
			On SAM_FetchRowDone
				If MFO = GetBankMfo()
					Call XSalTblSetCellBackColor( nPP,COLOR_Red)
				If OTM = 1 and RECD != NUMBER_Null and RECK != NUMBER_Null
					Set nOTM = 1
				If FILE_NAME != STRING_Null
					If SqlPrepareAndExecute( hSqlAux2(), 
							  "SELECT DAT,N, SDE/100, SKR/100, DATK 
							   INTO :DAT,:N,:SDE,:SKR,:DATK
							   FROM Zag_b WHERE FN =:FILE_NAME and dat >=:VZ_DAT and dat-1 < :VZ_DAT " ) 
							and SqlFetchNext( hSqlAux2(), nFetchRes) 
	Table Window: K2012
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: До виплати в 2012 р. Компенсації вкладникам Сбербанку СРСР.
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  14.433"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.536"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44304
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44305
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44306
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Frame
					Resource Id: 44307
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.083"
						Top:    0.071"
						Width:  5.5"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Data Field: dKol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.683"
							Top:    0.155"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dSum
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.683"
							Top:    0.155"
							Width:  2.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Option Button: op_TS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.071"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \bars98\RESOURCE\BMP\TUDASUDA.BMP
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Показати Згорнено/Розгорнено по РУ' )
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Column: VDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата 
						валютування
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  Class Default
				Width Editable? Class Default
				Format: Date
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: RU
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: № 
						РУ
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  0.6"
				Width Editable? Class Default
				Format: #0
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: MFOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: МФО
						 РУ
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва 
						РУ
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.483"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Кількість
						до виплати
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Class Default
				Format: ###0
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сума до
						виплати
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  2.55"
				Width Editable? Class Default
				Format: ###000
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sSql
			Number: n980
			Number: nRed
			Date/Time: bDat
		Message Actions
			On SAM_Create
				Set K2012.n980= GetBaseVal()
				Set bDat = GetBankDate()
				Set K2012.nRed = SalColorFromRGB( 255,210,250 )
				! Call SalColorSet( pb_Kart, COLOR_IndexWindow, KOB.nRed )
				Set K2012.strPrintFileName = 'K2012'
				!
				Call SalTblSetLockedColumns( hWndForm, 4 )
				Set op_TS = TRUE
				Call SalHideWindow( RU )
				Call SalHideWindow( MFOB )
				Call SalHideWindow( NAME )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set dKol = 0
				Set dSum = 0
				!
				If op_TS
					Call SalHideWindow( RU )
					Call SalHideWindow( MFOB )
					Call SalHideWindow( NAME )
					Set K2012.sSql =
							"SELECT k.VDAT, r.RU, k.MFOB, r.NAME, k.K, k.S
							 INTO :K2012.VDAT, :K2012.RU, :K2012.MFOB, :K2012.NAME, :K2012.K, :K2012.S     
							 FROM banks_ru r,
							     (select o.VDAT,o.MFOB,count(*) K, sum (o.s)/100 S from oper o
							      where o.sos = 3   and exists 
							(select 1 from DPT_PAYMENTS_EXT d where d.int_ref = o.ref and d.ext_ref is null) 
							      group by o.VDAT,o.MFOB  
							      ) k 
							 WHERE k.MFOB = r.MFO Order by  k.VDAT, r.RU "
				Else
					Call SalShowWindow( RU )
					Call SalShowWindow( MFOB )
					Call SalShowWindow( NAME )
					Set K2012.sSql =
							"select o.VDAT, count(*) K, sum(o.s)/100 S 
							 INTO :K2012.VDAT, :K2012.K, :K2012.S    
							 from oper o where sos = 3   and exists 
							   (select 1 from DPT_PAYMENTS_EXT d 
							    where d.int_ref = o.ref and d.ext_ref is null)        
							 group by o.VDAT Order by o.VDAT "
				Call SalTblPopulate(hWndForm, hSql(), K2012.sSql , TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If VDAT < bDat
					Call XSalTblSetRowBackColor( hWndForm, lParam, nRed )
				Else If VDAT = bDat
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Sky )
				Else If VDAT > bDat
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen )
				Set dKol = dKol + K 
				Set dSum = dSum + S 
			! On SAM_TblDoDetails
	Table Window: ENR		! 01
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: 1000
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  13.767"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50275
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.45"
						Begin Y:  Class Default
						End X:  5.45"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50276
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 50277
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Doc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\EXECUTE.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Генерація платежів по взвєморозрахунку на суму '|| SalNumberToStrX( nS/100, 2 )
						On SAM_Click
							If SalMessageBox( strTip , 'У В А Г А ! ', MB_YesNo | MB_IconQuestion )=IDYES
								If F_OPL()
									Call SqlCommitEx( hSql(), strTip )
									Call SalWaitCursor( FALSE )
								Else
									Call SqlRollback( hSql() )
									Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: VZ_DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.683"
							Top:    0.071"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата взаєморозрахунку')
				Data Field: dTitl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.983"
							Top:    0.071"
							Width:  2.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№, Дата протоколу')
		Contents
			Column: nPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						платежу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.533"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						документу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № док
						платника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFOA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						платника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						платника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						отримувача
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						отримувача
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAMA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						платника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPOA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ЗКПО
						платника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAMB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						отримувача
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ЗКПО
						отримувача
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Призначення
						платежу
				Visible? Yes
				Editable? No
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  3.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REFD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						Деб
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REFD != NUMBER_Null
							Call DocViewContentsEx(hWndForm, REFD )
			Column: REFK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						Крд
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REFK != NUMBER_Null
							Call DocViewContentsEx(hWndForm, REFK )
			!
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ID
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_OPL
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nPP1
				Actions
					Call SalWaitCursor( TRUE )
					Set nRow = TBL_MinRow
					! Заглавная общая часть
					Set nREFL = 0
					Call cDoc.SetDoc( 0, TT0, 3, 90, ND, dDat, dDat, dDat, dDat,
							     NLST, GetBankName(), aMfo,'', n980, nS, GetBankOkpoS(),
							     NLST, GetBankName(), aMfo,'', n980, nS, GetBankOkpoS(),
							     strTitle, '', GetIdOper(), '', NUMBER_Null, 0 )
					If NOT cDoc.oDoc() 
						Return FALSE
					If NOT F_REFL (cDoc.m_nRef) 
							OR NOT SqlPrepareAndExecute( hSql(),
							      "DELETE from ENR_FILE where REF_PROT=:REF_PROT ")
							OR NOT SqlPrepareAndExecute( hSql(),
							      "INSERT into ENR_FILE (REF_PROT,npp,mfo) select REF,npp,mfo from ENR_UCH where ref=:REF_PROT") 
						Return FALSE
					!
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If SqlPrepareAndExecute( hSql(),"SELECT npp FROM enr_uch where ref=:REF_PROT and npp=:nPP FOR UPDATE OF got NOWAIT " ) 
								and NOT SqlFetchNext( hSql(),nFetchRes)
							Return FALSE
						! Дебетовая часть
						Call cDoc.SetDoc( 0, TTD, 0,90, ND, ENR.DATD, dDat, dDat, dDat,
								     NLSB, NAMB, MFOB,'', n980, nS, OKPOB,
								     NLSA, NAMA, MFOA,'', n980, nS, OKPOA,
								     NAZN, '', GetIdOper(), '', NUMBER_Null, 0 )
						If NOT cDoc.oDoc() 
							Return FALSE
						If NOT F_REFL (cDoc.m_nRef) 
							Return FALSE
						Set REFD = cDoc.m_nRef
						!
						! Кредитовая часть
						Call cDoc.SetDoc( 0, TTK, 1, 90, ND, ENR.DATD, dDat, dDat, dDat,
								     NLSA, NAMA, MFOA,'', n980, nS, OKPOA,
								     NLSB, NAMB, MFOB,'', n980, nS, OKPOB,
								     NAZN, '', GetIdOper(), '', NUMBER_Null, 0 )
						If NOT cDoc.oDoc() 
							Return FALSE
						If NOT F_REFL (cDoc.m_nRef) 
							Return FALSE
						Set REFK = cDoc.m_nRef
						!
						If nPP = MAX_nPP
							Set nPP1 = 1
						Else
							Set nPP1 = nPP + 1
						If NOT SqlPrepareAndExecute(hSql(),
								      "UPDATE enr_uch SET got=5,ref_absD=:REFD,ref_absK=:REFK 
								       WHERE ref=:REF_PROT and npp=:nPP" ) 
								OR NOT SqlPrepareAndExecute( hSql(),
								      "UPDATE ENR_FILE set REFK=:REFK where npp=:nPP1 and mfo=:MFOB and REF_PROT=:REF_PROT ") 
								OR NOT SqlPrepareAndExecute( hSql(),
								      "UPDATE ENR_FILE set REFD=:REFD where npp=:nPP and mfo=:MFOA and REF_PROT=:REF_PROT ") 
							Return FALSE
					!
					If NOT SqlPrepareAndExecute(hSql(),"UPDATE enr_prot SET sos=5 WHERE ref=:REF_PROT " ) 
						Return FALSE
					Return TRUE
			Function: F_REFL
				Description:
				Returns
				Parameters
					Number: nRef
				Static Variables
				Local variables
				Actions
					If nREFL > 0
						If NOT SqlPrepareAndExecute(hSql(),"UPDATE oper SET REFL=:nRef WHERE ref=:nREFL" ) 
							Return FALSE
					Set nREFL = nRef
					Return TRUE
		Window Parameters
			Number: REF_PROT
			String: sTT !! Цепочка кодов операции = 'TT0,TTK,TTD'
			String: NLST !! Счет - транзит 
			String: strTitle
		Window Variables
			Date/Time: dDat
			Number: n980
			Number: nS
			Number: nColA
			Number: nColB
			Number: nCol
			String: aMfo
			String: MFOA1
			String: TT0
			String: TTK
			String: TTD
			: cDoc
				Class: cDoc
			Number: nREFL
			Number: nDel
			Number: MAX_nPP
		Message Actions
			On SAM_Create
				Set dDat = GetBankDate()
				Set n980 = GetBaseVal()
				Set aMfo = GetBankMfo()
				Call ShowApdVersion('01')
				Set TT0 = Subs(sTT,1,3)  
				Set TTK = Subs(sTT,5,3)  
				Set TTD = Subs(sTT,9,3)  
				! Call Debug(strTitle)
				Call SalSetWindowText( hWndForm, strTitle  )
				If SqlPrepareAndExecute( hSql(),
						"SELECT id ||'  від '|| to_char( DAT,'dd/mm/yyyy'),VZ_S*100, VZ_DAT
						 into :dTitl, :nS, :VZ_DAT from enr_prot WHERE ref = :REF_PROT " ) 
						and NOT SqlFetchNext( hSql(),nFetchRes) 
					Call SalDestroyWindow(hWndForm)
				If VZ_DAT = DATETIME_Null OR VZ_DAT != dDat
					Call SalMessageBox( "Дата взаєморозрахунку НЕ рівна поточній банківській даті !", "УВАГА !", MB_IconStop)
					Call SalDestroyWindow(hWndForm)
				Set ENR.strSqlPopulate =
						"SELECT u.NPP,o.s/100, o.datd,
						        o.nd,o.mfoa,o.nlsa,o.mfob,o.nlsb,o.nam_a,o.id_a,o.nam_b,o.id_b,
						        o.nazn, o.ref
						 INTO :ENR.nPP,:ENR.S,:ENR.DATD,
						      :ENR.ND, :ENR.MFOA,:ENR.NLSA,:ENR.MFOB,:ENR.NLSB,:ENR.NAMA,:ENR.OKPOA,
						      :ENR.NAMB,:ENR.OKPOB,:ENR.NAZN,:ENR.ID       
						 FROM enr_UCH u, enr_oper o 
						 WHERE u.ref=:ENR.REF_PROT and u.ref_pl=o.ref and u.ref_absd is null and u.ref_absk is null 
						 ORDER BY u.npp "
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Set nFlags=GT_NoRet | GT_NoIns | GT_NoDel | GT_NoUpd
				Set nColA=SalColorFromRGB( 230,255,230 )
				Set nColB=SalColorFromRGB( 220,255,255 )
				!
				Call SalSendClassMessage( SAM_Create, 0, 0 )
				!
			On SAM_ColumnSelectClick
			! On SAM_DoubleClick
			On SAM_FetchRowDone
				Set MAX_nPP = nPP
				If VZ_DAT - DATD > 8
					Call SalDisableWindow( pb_Doc )
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,250 ) ) ! розовій 
					! Call XSalTblSetCellBackColor( MFOA, nColA )
				! Call XSalTblSetCellBackColor( NLSA, nColA )
				! Call XSalTblSetCellBackColor( MFOB, nColB )
				! Call XSalTblSetCellBackColor( NLSB, nColB )
				! Set nCol = nColA
				! Set nColA = nColB
				! Set nColB = nCol
	Table Window: ENR1		! 01
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Протокол погодження взаєморозрахункiв
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  13.767"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.417"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54906
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.45"
						Begin Y:  Class Default
						End X:  5.45"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Учасники вибранного Протоколу '
						! On SAM_Create
							                                                                                                          If nMode = 0 
								                                                                                                          Set strTip = 'Генерація платежів по взвєморозрахунку вибраного Протоколу '
							                                                                                                          Else 
								                                                                                                          Set strTip = 'Учасники вибранного Протоколу '
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pb_Mod
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\LOOK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Аудит модифікації вибраного Протоколу та його Учасників'
						On SAM_Click
							If REF > 0
								If not IsWindow(hWin4)
									Set hWin4 = SalCreateWindow( ENR4, hWndMDI, 
											nMode, REF, IifN(SOS<4 and nMode = 1 ,nPar, 1 ), 
											ID || ' від ' || SalFmtFormatDateTime( DAT, 'dd/MM/yyyy'), 
											strPar01, strPar02 )
								Else
									Call SalBringWindowToTop ( hWin4 )
				Line
					Resource Id: 54907
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54908
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Doc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.983"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\DOCS.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути' || IifS(nMode=0,'/Генерувати','') || 
									' Пл.документи вибранного Протоколу ' || IifS(nMode=0," в АБС"," в інф.БД")
						On SAM_Click
							If REF > 0
								If nMode=0
									If SOS = 4
										If not IsWindow(hWin0)
											Set hWin0 = SalCreateWindow( ENR, hWndMDI, REF, strPar01,strPar02, 
													'Взаєморозрахунок згідно протоколу № ' || ID || " від " || SalFmtFormatDateTime( DAT, 'dd/MM/yyyy')  )
										Else
											Call SalBringWindowToTop ( hWin0 )
									Else If SOS = 5
										Call DocViewListInt( hWndMDI,
												"a.sos>=0 and a.ref in 
												(select ref_ABSd from enr_UCH where ref_ABSd is not null and ref="|| Str(REF) ||"
												 union all 
												 select ref_ABSk from enr_UCH where ref_ABSk is not null and ref="|| Str(REF) ||")",
												strTip || " № "|| ID || " від " || SalFmtFormatDateTime( DAT, 'dd/MM/yyyy') )
								Else
									Call DocViewListInt( hWndMDI,
											"a.sos>=0 and a.ref in 
											(select ref_PL from enr_UCH 
											 where ref_PL is not null and ref="|| Str(REF) ||")",
											strTip || " № "|| ID || " від " || SalFmtFormatDateTime( DAT, 'dd/MM/yyyy') )
				Pushbutton: pb_File
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.483"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\TOMAIL.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							If nMode != 5
								Call SalDisableWindow( pb_File )
							Set strTip = 'Переглянути/Генерувати файли ВПС вибранного Протоколу ' 
						On SAM_Click
							If REF > 0
								If not IsWindow(hWin5)
									Set hWin5 = 
											SalCreateWindow( ENR5, hWndMDI,REF, strPar01,strPar02,
											'Файли ВПС згідно протоколу № ' || ID || " від " || SalFmtFormatDateTime( DAT, 'dd/MM/yyyy') 
											)
								Else
									Call SalBringWindowToTop ( hWin5 )
				!
				Pushbutton: pb_Run1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.071"
						Width:  0.45"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Загрузити оригінал протоколу в БД з елестронного носія'
						On SAM_Click
							If REF > 0
								Set nYES1 = Imp_File( SPECIFIC, REF, nYES1 )
				Pushbutton: pb_Run2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.071"
						Width:  0.45"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCVIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вигрузка та Перегляд документу-Протоколу з БД'
						On SAM_Click
							If REF > 0 and nYES1 = 1 
								If SqlPrepareAndExecute( hSqlAux2(),
										  "SELECT F_SIZE into :F_SIZE FROM enr_body WHERE ref=:REF and F_SIZE > 0 " )
										and SqlFetchNext( hSqlAux2(), nFetchRes )
									Call Exp_File( SPECIFIC, F_SIZE, REF )
								Else
									Set nYES1 = 0
				Pushbutton: pb_Bak
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.983"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Відновити протокол на модифікацію"
						On SAM_Click
							If REF > 0
								If F_Bak(strTip )
		Contents
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Системний
						реф
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: URAD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Постанова 
						Уряду
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NKRE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Постанова 
						НКРЕ
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.133"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № 
						протоколу
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						протоколу
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VZ_S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума 
						взаєморозрахунку
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KR_S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума 
						кредиту
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KR_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № 
						кред.дог.
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KR_DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						кред.дог.
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.117"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VZ_KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: кiлькiсть 
						учасникiв
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: GOT_KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Готових
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: стан 
						протоколу
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME_SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: стан 
						протоколу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VZ_DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						взаєморозрахунку
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.117"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: nYES1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Протокол
						в БД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F_SIZE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Розмір
						файлу
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SPECIFIC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Спеціифікація
						 файлу
				Visible? Yes
				Editable? No
				Maximum Data Length: 70
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: Imp_File
				Description: Принять 1 файл  по выбору
				Returns
					Number: nn
				Parameters
					String: sSPECIFIC
					Number: nRef
					Number: nYES
				Static Variables
				Local variables
					String: strFilters[*]
					String: strFileName
					String: strFilePath
					Number: nIndex
					Number: nSize
					!
					File Handle: inFile
					Long String: sTiket
					String: sFileM[*]
					Number: nNumFiles
					Number: nRet
				Actions
					Set strFilters[0] = 'Електронний документ-Протокол'
					Set strFilters[1] = '*'||SalStrRightX( SalStrTrimX( sSPECIFIC ) , 5 )
					! Call Debug(strFilters[1])
					Set nIndex = 1
					Set nRet = -1
					If not SalDlgOpenFile ( hWndForm, 'Вибір електронного документу-Протоколу', strFilters, 2, nIndex, strFileName, sSPECIFIC )
						Return nRet
					!
					Call SalWaitCursor(FALSE)
					Set strFileName = SalStrUpperX( strFileName )
					If nYES
						If SalMessageBox ( "Документ " || strFileName || " уже прийнято. Замінити ?", 'Увагае !', MB_YesNo | MB_IconQuestion ) = IDNO
							Return nRet
						If SqlPrepareAndExecute( hSql(), "delete from ENR_body where ID=:nRef ")
								and SqlCommit( hSql())
						Else
							Return nRet
					!
					If SalFileOpen ( inFile, strFileName, OF_Read )
						Set nSize = VisFileGetSize( strFileName )
						If SalFileRead( inFile, sTiket, nSize ) > 0
								and SqlPrepare( hSql(), "INSERT INTO Enr_body (REF, STIKET, F_size ) values (:nRef, :sTiket, :nSize )")
								and SqlSetLongBindDatatype(2, BLOB_BYTE)
								and SqlExecute(hSql())
								and SqlPrepareAndExecute( hSql(), "UPDATE enr_prot set SPECIFIC =:strFileName where ref=:nRef " )
								and SqlPrepareAndExecute( hSql(), 'COMMIT')
							Set nRet = 1
							Set SPECIFIC = strFileName 
							Set F_SIZE = nSize
							Call SalMessageBox ('Файл ' || strFileName || ' прийнято', 'Повідомлення', MB_Ok | MB_IconExclamation)
						Else
							Call SqlPrepareAndExecute( hSql(), 'ROLL')
						!
						Call SalFileClose( inFile )
					Return nRet
			Function: Exp_File
				Description:
				Returns
					Boolean:
				Parameters
					String: sSPECIFIC
					Number: nSize
					Number: nRef
				Static Variables
				Local variables
					String: strReport
					File Handle: hFile
					Long String: sTiket
					Number: nK
					String: MAS[*]
				Actions
					! прочитать из архива этот ID и его показать
					Set strReport= SalStrTrimX( sSPECIFIC  )
					Set nK = SalStrTokenize( strReport, '', '\\', MAS )
					Set strReport = MAS[nK-1]
					!
					If SqlPrepareAndExecute( hSql(),
							  "SELECT STIKET INTO :sTiket from enr_body where ref=:nRef and STIKET is not null " )
							and SqlFetchNext( hSql(), nFetchRes )
						Set strReport = GetPrnDir() ||'\\'|| strReport
						If SalFileOpen( hFile, strReport, 1 )
							Call SalFileWrite( hFile, sTiket, nSize )
							Call SalFileClose( hFile )
							If SalMessageBox("Бажаєте переглянути ? ",
									   'Файл ' || strReport || ' створено ',
									    MB_IconQuestion | MB_YesNo ) = IDYES
								Call SalLoadApp ( 'START', strReport )
					Else
						Call MessageNoWait("Неможливо знайти файл в архіві ! " ,'',2,1)
						Return FALSE
			Function: F_Bak
				Description:
				Returns
					Boolean:
				Parameters
					String: sTxt
				Static Variables
				Local variables
					Number: Ref_Prot
				Actions
					If SalMessageBox( "УВАГА ! Протокол реф="||Str(REF), sTxt || "?", MB_IconQuestion | MB_YesNo) = IDYES
						If SqlPrepareAndExecute( hSql(),
								  "SELECT ref from enr_prot P 
								   where sos=4 and ref=:REF FOR UPDATE OF sos NOWAIT")
								and SqlFetchNext( hSql(),nFetchRes) and 
								SqlPrepareAndExecute( hSql(),
								  "update enr_prot set sos=0 where ref=:REF " )
							Call SqlCommit(hSql())
							Call MessageNoWait( sTxt || " REF=" || Str(REF),'',2,0)
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
						Else
							Call SqlRollback(hSql())
							Call SalMessageBeep(MB_IconStop)
							Call MessageNoWait( 'Неможливо '||sTxt ,'',2,1)
		Window Parameters
			Number: nMode
			Number: nPar ! =0 -редактировать при nMode = 1 
			String: strPar01
			String: strPar02
		Window Variables
			String: strWhere
			String: aMfo
			Number: MY_KOL
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalSetWindowText( hWndForm, 'Протоколи погодження взаєморозрахункiв' )
				Call SalDisableWindow( pb_Mod )
				Set aMfo = GetBankMfo()
				! Call Debug( aMfo || ' nMode ='||Str(nMode) ||' nPar ='||Str(nPar))
				If nMode = 1  ! Все протоколы в ENR
					Set strWhere = ''
					If nPar = 0 ! c модификацией
						Call SalEnableWindow( pb_Mod )
						Set ENR1.strSqlDelete = "delete from enr_prot where ref=:ENR1.REF and sos=0 "
						Set ENR1.strSqlInsert = 
								"insert into enr_prot (URAD,NKRE,ID,DAT,VZ_S,KR_S,KR_ID,KR_DAT,VZ_KOL,VZ_DAT) 
								 values 
								(:ENR1.URAD,:ENR1.NKRE,:ENR1.ID,:ENR1.DAT,:ENR1.VZ_S,:ENR1.KR_S,:ENR1.KR_ID,:ENR1.KR_DAT,:ENR1.VZ_KOL,:ENR1.VZ_DAT) "
						Set ENR1.strSqlUpdate = 
								"update enr_prot set 
								  URAD=:ENR1.URAD, NKRE=:ENR1.NKRE, ID=:ENR1.ID, DAT=:ENR1.DAT, VZ_S=:ENR1.VZ_S,
								  KR_S=:ENR1.KR_S, KR_ID=:ENR1.KR_ID, KR_DAT=:ENR1.KR_DAT, VZ_KOL=:ENR1.VZ_KOL, VZ_DAT=:ENR1.VZ_DAT  
								 where ref=:ENR1.REF and sos=0 "
				Else If nMode = 0 ! В АБС
					Call SalSetWindowText( hWndForm, 'Поведення взаєморозрахункiв за окремими постановами Уряду (Протоколи)' )
					Set strWhere = ' and enr_prot.sos >= 4 '
				Else If nMode = 5 ! В АБС
					Call SalSetWindowText( hWndForm, 'Файли ВПС по Взаєморозрахункам' )
					Set strWhere = ' and enr_prot.sos >= 5 '
				Else If nMode = 2 ! Некоторые протоколы в ENR - для филиалов
					Set strWhere = ' and enr_prot.REF in (select ref from ENR_UCH where mfo =:ENR1.aMfo) '
				!
				If nPar != 0 OR nMode != 1 
					Set nFlags=GT_NoRet | GT_NoIns | GT_NoDel | GT_NoUpd
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( pb_Run1 )
				!
				Set ENR1.strSqlPopulate =
						"SELECT enr_prot.REF, enr_prot.URAD, enr_prot.NKRE, enr_prot.ID, enr_prot.DAT,
						        enr_prot.VZ_S,enr_prot.KR_S, enr_prot.KR_ID, enr_prot.KR_DAT, 
						        to_char(enr_prot.VZ_KOL), enr_prot.SOS, enr_prot.VZ_DAT, s.name,
						        enr_prot.SPECIFIC
						 INTO :ENR1.REF, :ENR1.URAD, :ENR1.NKRE, :ENR1.ID, :ENR1.DAT, 
						      :ENR1.VZ_S,:ENR1.KR_S, :ENR1.KR_ID,:ENR1.KR_DAT, 
						      :ENR1.VZ_KOL,:ENR1.SOS,:ENR1.VZ_DAT, :ENR1.NAME_SOS, :ENR1.SPECIFIC 
						 FROM enr_prot, enr_sos s
						 WHERE enr_prot.sos =s.sos " || strWhere || " ORDER BY enr_prot.REF desc "
				Call ShowApdVersion('01')
				!
				! ENR_PROT 
				Set ENR1.strFilterTblName = 'ENR_PROT'
				Set ENR1.strPrintFileName = 'ENR_PROT'
				!
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On SAM_DoubleClick
				If REF > 0
					If not IsWindow(hWin2)
						Set hWin2 = SalCreateWindow( ENR2, hWndMDI, 
								nMode, REF, IifN(SOS<4 and nMode = 1 ,nPar, 1 ), 
								ID || ' від ' || SalFmtFormatDateTime( DAT, 'dd/MM/yyyy'), 
								strPar01, strPar02 )
					Else
						Call SalBringWindowToTop ( hWin2 )
			On SAM_FetchRowDone
				If SPECIFIC != STRING_Null
					Set nYES1 = 1
				!
				If SOS = 4 ! Закрито на мод.(дозвiл) - ! зеленый
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen) 
				Else If SOS = 5 ! Проведено - ! серо-зеленій
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,245,240 )) 
				Else If SOS = 6 ! Сформовано Файли ВПС - ! слабо- серый
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray ) 
				Else If SOS = 7 ! Сквитовано Файли ВПС ! сильно- серый
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Gray ) 
				Else If SOS = 0 ! Все введены - готов к закрытию
					If nMode = 2
						If SqlPrepareAndExecute( hSqlAux2(),
								  "SELECT NVL(sum(decode(got,2,1,0)),0),count(*) 
								   into :GOT_KOL,:MY_KOL from enr_uch where ref=:REF and mfo =:ENR1.aMfo")
								and SqlFetchNext( hSqlAux2(), nFetchRes)
						If MY_KOL = GOT_KOL
							Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 )) 
					Else
						If SqlPrepareAndExecute( hSqlAux2(),
								  "SELECT count(*) into :GOT_KOL from enr_uch where ref=:REF and got=2")
								and SqlFetchNext( hSqlAux2(), nFetchRes)
						If VZ_KOL = GOT_KOL
							Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 )) 
			On SAM_TblDoDetails
				If SOS = 5
					Call SalColorSet( pb_Doc, COLOR_IndexWindow, COLOR_LightGray )
				Else If nMode=0 
					Call SalColorSet( pb_Doc, COLOR_IndexWindow, COLOR_LightGreen ) ! зеленый
				If SOS = 4 and nMode = 1 and nPar = 0
					Call SalEnableWindow( pb_Bak )
				Else
					Call SalDisableWindow( pb_Bak )
	Table Window: ENR2		! 01
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Учасники Протоколу погодження взаєморозрахункiв 
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  13.767"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.071"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_UCH()
							Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
				Line
					Resource Id: 54903
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.45"
						Begin Y:  Class Default
						End X:  5.45"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Платіжне доручення учасника Протоколу № ' || strTitle
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54904
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54905
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Doc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\DOCS.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути' || IifS(nMode=0,'/Генерувати','') || 
									' Пл.документи Протоколу № ' || strTitle || IifS(nMode=0," в АБС"," в інф.БД")
						On SAM_Click
							If nMode=0
								If SOS = 4
									If not IsWindow(hWin0)
										Set hWin0 = SalCreateWindow( ENR, hWndMDI, REF, strPar01,strPar02, 
												'Взаєморозрахунок згідно протоколу № ' || strTitle   )
									Else
										Call SalBringWindowToTop ( hWin0 )
								Else If SOS = 5
									Call DocViewListInt( hWndMDI,
											"a.sos>=0 and a.ref in 
											(select ref_ABSd from enr_UCH where ref_ABSd is not null and ref="|| Str(REF) ||"
											 union all 
											 select ref_ABSk from enr_UCH where ref_ABSk is not null and ref="|| Str(REF) ||")",
											strTip )
							Else
								Call DocViewListInt( hWndMDI,
										"a.sos>=0 and a.ref in 
										(select ref_pl from enr_UCH where ref_pl is not null and ref="|| Str(REF) ||")",
										strTip )
						!
				Pushbutton: pb_Close
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.083"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\A_BKLD.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = sClose
						On SAM_Click
							Call F_Close( )
				Pushbutton: pb_Key
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\VIEWKEY.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Перевітири ЕЦП на пл.дорученнях"
						On SAM_Click
							If F_Key()
								Call SalMessageBox( 'Зовнішня ЕЦП вірна на всіх пл.дорученнях', 
										'Перевірка зовнівньої ЕЦП', MB_Ok )
							Else
								Call SalMessageBox( 'Помилка при перевірці ЕЦП на пл.дорученнях ',
										'Ошибка', MB_IconStop | MB_Ok )
				Background Text: ВСЬОГО учасників
					Resource Id: 33836
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.883"
						Top:    0.095"
						Width:  3.033"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: VZ_KOL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.983"
							Top:    0.071"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: ЗАРЕЄСТРОВАНИХ учасників
					Resource Id: 33838
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.883"
						Top:    0.429"
						Width:  3.033"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: KOL1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.983"
							Top:    0.405"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: ГОТОВИХ учасників
					Resource Id: 33837
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.883"
						Top:    0.762"
						Width:  3.033"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: KOL2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.983"
							Top:    0.738"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Data Field: URAD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.783"
							Top:    0.071"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Постанова Уряду')
				Data Field: NKRE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.783"
							Top:    0.405"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Постанова НКРЕУ')
				Data Field: KR_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.583"
							Top:    0.405"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ кред.дог.')
				Data Field: KR_DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.183"
							Top:    0.405"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата кред.дог.')
				Data Field: VZ_S
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.783"
							Top:    0.405"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сума взаєморозрахунку')
				Data Field: KR_S
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.183"
							Top:    0.738"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сума кредиту')
				Data Field: sSOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.405"
							Width:  5.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Стан протоколу')
				Data Field: VZ_DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.083"
							Top:    0.738"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата взаєморозрахунку')
				Data Field: dREF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.738"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Системнмй референс')
				!
				Pushbutton: pb_Run2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    0.071"
						Width:  0.45"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCVIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вигрузка та Перегляд документу-Протоколу з БД'
						On SAM_Click
							If SqlPrepareAndExecute( hSql(), "SELECT F_SIZE into :F_SIZE from enr_body where ref=:REF" )
									and SqlFetchNext( hSql(),nFetchRes) 
								Call ENR1.Exp_File( SPECIFIC, F_SIZE, REF )
		Contents
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If NPP > VZ_KOL
							Call SalMessageBox(  '№ учасника > ВСЬОГО учасників ('||Str(VZ_KOL)||')', 
									"Помилка !", MB_IconStop)
							Return VALIDATE_Cancel
						If NPP = NUMBER_Null or NPP=0
							Call SalMessageBox(  'Не заповнено поле № учасника !', 
									"Помилка !", MB_IconStop)
							Return VALIDATE_Cancel
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Найменування
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  1.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sOld = NAME
					On SAM_Validate
						If NOT F_PROV( sOld, NAME, OKPO, MFO, NLS )
							Set NAME = sOld
							Return VALIDATE_Cancel
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Iд.код
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.133"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sOld = OKPO
					On SAM_Validate
						If NOT F_PROV( sOld, NAME, OKPO, MFO, NLS )
							Set OKPO = sOld
							Return VALIDATE_Cancel
			Column: REG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Регiон
				Visible? No
				Editable? Yes
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО 
						установи банку
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sOld = MFO
					On SAM_Validate
						If NOT F_PROV( sOld, NAME, OKPO, MFO, NLS )
							Set MFO = sOld
							Return VALIDATE_Cancel
					On SAM_DoubleClick
						Call F_Mfo()
						Call SalSendMsg( MFO, SAM_Validate, 0, 0 )
			Column: NB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва 
						установи банку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № рахунку
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sOld = NLS
					On SAM_Validate
						If NOT F_PROV( sOld, NAME, OKPO, MFO, NLS )
							Set NLS = sOld
							Return VALIDATE_Cancel
			Column: GOT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Готовність
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM_GOT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Відкрито 
						для філії
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If GOT = 0
							Set OTM_GOT = 1
							Set GOT = 1
						Else
							Set GOT = 1
			Column: NAME_GOT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Признак готовностi
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF_PL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Референс
						пл.дор
						в інф.БД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM_SIGN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ЕЦП 
						вірна
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If GOT = 0
							Set OTM_GOT = 1
							Set GOT = 1
						Else
							Set GOT = 1
			Column: REFD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Референс
						Деб.пл
						в АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REFK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Референс
						Крд.пл
						в АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: RI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Признак готовностi
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Mfo
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp1
					String: sTmp
				Actions
					If RI = STRING_Null
						Set sTmp = STRING_Null
						! Выбрать значение из фильтрованого справочника
						Call FunNSIGetFiltered("BANKS","NB",
								" mfo in (select val from PARAMS$BASE where par='MFO') and mfoU='"||MfoU||"'", 
								sTmp, sTmp1)
						If sTmp != STRING_Null
							Set MFO = sTmp
							Set NB = sTmp1
							! Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(  hWndForm  ),
									IifN( ID = NUMBER_Null, ROW_New, ROW_Edited ),  TRUE )
							! ! Function: FunNSIGetFiltered
								                                                                                                       Description: Выбрать значение из фильтрованого справочника
								                                                                                                       Returns
									                                                                                                       Number: nRet
								                                                                                                       Parameters
									                                                                                                       String: strNSITblName
									                                                                                                       String: strSKColumn
									                                                                                                       String: strFilter
									                                                                                                       Receive String: strFKReturn
									                                                                                                       Receive String: strSKReturn
								                                                                                                       Static Variables
								                                                                                                       Local variables
									                                                                                                       Number: fReturnResult
									                                                                                                       String: strFKey
									                                                                                                       String: strSKey
								                                                                                                       Actions
									                                                                                                       Call IniNsiApi()
									                                                                                                       Set fReturnResult =  SalModalDialog( dlg_universal_nsi_get, hWndForm,
											    SalStrUpperX( SalStrTrimX( strNSITblName )),
											    '',
											    SalStrUpperX( SalStrTrimX( strSKColumn )),
											    SalStrUpperX( SalStrTrimX( strFilter )),
											    strFKey,
											    strSKey,
											    TRUE )
									                                                                                                       If fReturnResult
										                                                                                                       Set strFKReturn = strFKey
										                                                                                                       Set strSKReturn = strSKey
									                                                                                                       Return fReturnResult
			Function: F_Close
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sErr
					String: sErrT
				Actions
					Set sErr = "Закриття протоколу неможливе !"
					Set sErrT = IifS(GetSignOn() = 0 , "ПЕРЕВІРКА ЕЦП ВІДКЛЮЧЕНА !, ","") 
					Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Set sErrT = sErrT ||'
							Кількість учасників ВСЬОГО = '|| Str(VZ_KOL) || '
							Кількість учасників ЗАРЕЄСТРОВАНИХ = '|| Str(KOL1) || '
							Кількість учасників ГОТОВИХ = '|| Str(KOL2)
					If VZ_KOL <2 OR VZ_KOL != KOL1 OR VZ_KOL != KOL2 OR SOS >=4
						Call SalMessageBox(sErrT,sErr, MB_IconStop)
						Return FALSE
					Else
						If SalMessageBox( sErrT, sClose || "?", MB_IconQuestion | MB_YesNo) = IDYES
							If GetSignOn() = 1   ! ЭЦП включена 
								If NOT F_Key()
									Set sErrT = 'Помилка при перевірці ЕЦП на пл.дорученнях'
									Call SalMessageBox( sErrT,sErr, MB_IconStop)
									Return FALSE 
							If SqlPrepareAndExecute( hSql(),
									  "SELECT ref from enr_prot P 
									   where ref not in (select ref from enr_uch where ref=:REF and got<>2) 
									     and ref=:REF FOR UPDATE OF sos NOWAIT")
									and SqlFetchNext( hSql(),nFetchRes) and 
									SqlPrepareAndExecute( hSql(),
									  "update enr_prot set sos=4 where ref=:REF " )
								Call SqlCommit(hSql())
								Call MessageNoWait( sClose || " REF=" || Str(REF),'',2,0)
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
								Return TRUE 
							Else
								Call SqlRollback(hSql())
								Call SalMessageBeep(MB_IconStop)
								Call MessageNoWait( sErr ,'',2,1)
						Return FALSE 
			Function: F_Kol
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(),  "SELECT count(*) into :KOL1 from enr_uch where ref=:REF" )
							and SqlFetchNext( hSql(),nFetchRes) 
							and SqlPrepareAndExecute( hSql(), "SELECT count(*) into :KOL2 from enr_uch where ref=:REF and got=2 and ref_pl is not null" )
							and SqlFetchNext( hSql(),nFetchRes) 
							and SqlPrepareAndExecute( hSql(), 
							   "SELECT P.sos, P.vz_kol, p.SPECIFIC, p.URAD, p.NKRE, p.VZ_S, p.KR_S, 
							           p.KR_ID, p.KR_DAT, p.VZ_DAT, s.name
							    into :SOS, :VZ_KOL, :SPECIFIC, :URAD, :NKRE, :VZ_S, :KR_S, 
							         :KR_ID,:KR_DAT,:VZ_DAT, :sSOS
							    from enr_prot P, enr_sos s where P.ref=:REF and p.sos=s.sos " )
							and SqlFetchNext( hSql(),nFetchRes) 
						If nPar = 1 OR VZ_KOL <2 OR VZ_KOL != KOL1 OR VZ_KOL != KOL2 OR SOS >=4
							Call SalDisableWindow( pb_Close )
						Else
							Call SalEnableWindow( pb_Close )
						!
						If SPECIFIC != STRING_Null 
							Call SalEnableWindow( pb_Run2 )
						Else
							Call SalDisableWindow( pb_Run2 )
						!
						If SOS = 5
							Call SalColorSet( pb_Doc, COLOR_IndexWindow, COLOR_LightGray )
						Else If nMode=0 
							Call SalColorSet( pb_Doc, COLOR_IndexWindow, COLOR_LightGreen )
			Function: F_PROV
				Description:
				Returns
					Boolean:
				Parameters
					String: sOld
					String: sName
					String: sOkpo
					String: sMfo
					String: sNls
				Static Variables
				Local variables
					String: sErr
					String: sTxt
				Actions
					Set sTxt = "Увага, ПОМИЛКА !"
					Set sErr = STRING_Null
					If sName != STRING_Null AND SalStrLength( sName ) < 3
						Set sErr = sErr || "
								Найменування менше 3-х символів: "||sName 
					If sOkpo != STRING_Null AND ( sOkpo != V_Okpo(sOkpo) OR SalStrLength( sOkpo ) != 8 )
						! Set sErr = sErr || "
								Контрольний розряд Ід.кода "||sOkpo 
					If sNls != STRING_Null AND Subs(sNls,1,4) != '2602' AND Subs(sNls,1,4) != '2603' 
						Set sErr = sErr || "
								Рахунок " || sNls || " НЕ належить списку допустимих Бал.рах( 2602, 2603 ) "
					If sMfo  != STRING_Null 
						If sOld != sMfo
							If SqlPrepareAndExecute( hSql(),
									"select nb into :NB from banks where mfo=:MFO and mfoU=:MfoU" )
									and NOT SqlFetchNext( hSql(),nFetchRes) 
								Set sErr = sErr || "
										МФО " || sMfo || " НЕ належить системному Банку "
						If sNls != STRING_Null AND sNls != KeyAccount( sMfo, sNls)
							Set sErr = sErr || "
									Контрольний розряд рахунку "|| sMfo || "/" || sNls
					If sErr  != STRING_Null
						Call SalMessageBox( sErr, sTxt, MB_IconStop)
						Return FALSE
					Return TRUE
			Function: F_Key
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Boolean: FL_SING
				Actions
					Set nRow = TBL_MinRow
					Set FL_SING = TRUE
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If REF_PL > 0
							If F_Key1(REF_PL) = 0
								Set FL_SING = FALSE
								Set OTM_SIGN = 0
								Call XSalTblSetCellBackColor( REF_PL, SalColorFromRGB( 255,210,250 ) )
							Else
								Set OTM_SIGN = 1
								Call XSalTblSetCellBackColor( REF_PL,COLOR_Sky)
					!
					Return FL_SING
			Function: F_Key1
				Description: Проверка ЭЦП на док.
						+ проверка ЭЦП N-ой визы,
						в зависимости от номера выделенной строки
				Returns
					Number:
				Parameters
					Number: nRef
				Static Variables
				Local variables
				Actions
					If NOT m_Doc.SetDocR( nRef, FALSE )
						Return 0
					! новая внутрення подпись
					If GetGlobalOption('INTSIGN')='2'   
						If NOT m_Doc.cDocInt(0,NUMBER_Null)
							Return 0
						If NOT m_Doc.IsSignExist() 
							Return 0
					! старая внутрення подпись
					Else
						If NOT m_Doc.CheckDocSign('LVL', 0 )
							Return 0
					!
					Return 1
			Function: F_UCH
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sErr
					String: sTxt
					Number: nK
				Actions
					Call SalWaitCursor(TRUE)
					Call SqlPrepare(hSql(), ENR2.strSqlDelete ) 
					Call SalTblDoDeletes(hWndForm, hSql(), ROW_MarkDeleted)
					!
					Call SqlPrepare(hSql(), ENR2.strSqlInsert )
					Call SalTblDoInserts(hWndForm, hSql(), TRUE)
					!
					Call SqlPrepare(hSql(), ENR2.strSqlUpdate )
					Call SalTblDoUpdates(hWndForm, hSql(), TRUE)
					! !!!! Проверки участников
					Set sTxt = "Увага, ПОМИЛКА ! Збереження неможливе !"
					Set sErr = STRING_Null
					! Общее кол-во записей
					If SqlPrepareAndExecute( hSql(),
							  "select count(*) into :nK from enr_uch where ref=:REF ") 
							and SqlFetchNext( hSql(),nFetchRes) 
							and nK > VZ_KOL
						Set sErr = sErr || '
								Кількість записів('||Str(nK)||') > ВСЬОГО учасників ('||Str(VZ_KOL)||')'
					! Двойники 
					If SqlPrepareAndExecute( hSql(),
							  "select npp,count(*) from enr_uch where ref=:REF group by npp having count(*)>1 ") 
							and SqlFetchNext( hSql(),nFetchRes) 
						Set sErr = sErr || '
								Дублі в № учасників '
					! Недопустимые номера
					If SqlPrepareAndExecute( hSql(),
							  "select npp from enr_uch where ref=:REF and NPP>:VZ_KOL ") 
							and SqlFetchNext( hSql(),nFetchRes) 
						Set sErr = sErr || '
								Недопустимі № учасників '
					If sErr  != STRING_Null
						Call SqlRollback( hSql())
						Call SalWaitCursor(FALSE)
						Call SalMessageBox( sErr, sTxt, MB_IconStop)
						Return FALSE
					!
					Call SqlCommit(hSql())
					Call SalWaitCursor(FALSE)
					Return TRUE
		Window Parameters
			Number: nMode
			Number: REF
			Number: nPar
			String: strTitle
			String: strPar01
			String: strPar02
		Window Variables
			Number: nCol2
			Number: nCol_1
			Number: SOS
			! Number: NPP_old
			String: sClose
			String: SPECIFIC
			Number: F_SIZE
			!
			String: sOld
			String: MfoU
			String: aMfo
			!
			: m_Doc
				Class: cDoc
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Set aMfo = GetBankMfo()
				Set sClose = 'Закрити протокол на модифікацію '
				Set dREF = REF
				If GetSignOn() = 0  OR nMode = 0 ! ЭЦП отключена 
					Call SalDisableWindow( pb_Key )
					Set sClose = IifS(GetSignOn() = 0 , "ЕЦП ВІДКЛЮЧЕНА ! , ","") || 'Закрити протокол на модифікацію '
				If nPar = 1 
					Set nFlags=GT_NoRet | GT_NoIns | GT_NoDel | GT_NoUpd
					Call SalDisableWindow( pb_Close )
				Call SalSetWindowText( hWndForm, 'Учасники Протоколу погодження взаєморозрахункiв № ' || strTitle  )
				Set nCol2 = SalColorFromRGB( 230,255,230 )
				Set nCol_1 = SalColorFromRGB( 255,210,250 )
				Call ShowApdVersion('01')
				If SqlPrepareAndExecute( hSql(),"select mfoU into :MfoU from banks where mfo=:aMfo" )
						and SqlFetchNext( hSql(),nFetchRes) 
				!
				Set ENR2.strSqlPopulate =
						"SELECT enr_UCH.NPP, enr_UCH.NAME, enr_UCH.OKPO, enr_UCH.REG,
						        enr_UCH.MFO, enr_UCH.NLS, enr_UCH.GOT, enr_UCH.REF_PL, g.name,
						        enr_UCH.rowid , b.nb, decode(enr_UCH.GOT, 0, 0, 1),
						        enr_UCH.REF_ABSD, enr_UCH.REF_ABSK
						 INTO :ENR2.NPP, :ENR2.NAME,:ENR2.OKPO, :ENR2.REG, 
						      :ENR2.MFO, :ENR2.NLS, :ENR2.GOT,:ENR2.REF_PL,:ENR2.NAME_GOT, 
						      :ENR2.RI, :ENR2.NB, :ENR2.OTM_GOT, :ENR2.REFD,:ENR2.REFK
						 FROM ENR_UCH, enr_got g , banks b
						 WHERE enr_UCH.REF = :ENR2.REF and enr_UCH.GOT = g.got and enr_UCH.MFO=b.MFO 
						 ORDER BY enr_UCH.NPP"
				!
				! Set ENR2.strFilterTblName = 'ENR_UCH'
				Set ENR2.strPrintFileName = 'ENR_UCH'
				If nMode = 1 
					Set ENR2.strSqlDelete = "delete from ENR_UCH where ref=:ENR2.REF and got=0 and rowid=:ENR2.RI"
					Set ENR2.strSqlInsert = 
							"insert into ENR_UCH (ref, NPP,NAME,OKPO,REG,MFO,NLS,KF) values 
							(:ENR2.REF,:ENR2.NPP,:ENR2.NAME,:ENR2.OKPO,:ENR2.REG,:ENR2.MFO,:ENR2.NLS,:ENR2.MFO ) "
					Set ENR2.strSqlUpdate = 
							"update ENR_UCH set 
							  NPP=:ENR2.NPP, NAME=:ENR2.NAME, OKPO=:ENR2.OKPO, REG=:ENR2.REG, MFO=:ENR2.MFO,
							  NLS=:ENR2.NLS, GOT =:ENR2.GOT  
							 where ref=:ENR2.REF and got=0 and rowid=:ENR2.RI "
				Else If nMode = 2 
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( OTM_GOT )
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( pb_Close )
				!
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call SalTblPopulate(hWndForm, hSqlAux2(), ENR2.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call F_Kol()
				Call SalWaitCursor(FALSE)
			! On UM_Update
			On SAM_DoubleClick
				If RI != STRING_Null and NPP != NUMBER_Null and GOT != 0
					If nMode = 1 OR  MFO = GetBankMfo()
						If not IsWindow(hWin3)
							Set hWin3 = SalCreateWindow( ENR3, hWndMDI, nMode, REF, NPP, strTitle, MFO )
						Else
							Call SalBringWindowToTop ( hWin3 )
			On SAM_FetchRowDone
				If GOT = -1 
					Call XSalTblSetRowBackColor( hWndForm, lParam, nCol_1 ) ! розовій - отозван
				Else If GOT = 2
					Call XSalTblSetRowBackColor( hWndForm, lParam, nCol2 ) ! зеленый - готов
				Else If GOT = 5
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray ) ! серый
				If MFO = aMfo
					Call XSalTblSetCellBackColor( NPP,COLOR_Red)
	Form Window: ENR3
		Class:
		Property Template:
		Class DLL Name:
		Title: Повні реквізити платіжного доручення
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.038"
				Top:    0.021"
				Width:  12.667"
				Width Editable? Yes
				Height: 5.821"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: Prot
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    0.155"
						Width:  10.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Протокол')
			Data Field: NAME_GOT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.983"
						Top:    0.571"
						Width:  3.067"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Стан учасника протоколу')
			!
			Frame
				Resource Id: 52338
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.988"
					Width:  11.0"
					Width Editable? Yes
					Height: 0.917"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Data Field: REGA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    1.155"
						Width:  2.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Регіон платника')
			Data Field: MFOA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.983"
						Top:    1.155"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Код МФО банку платника')
			Data Field: NBA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.783"
						Top:    1.155"
						Width:  6.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Назва банку платника')
			Data Field: NPPA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    1.405"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ учаснику по протоколу платника')
			Data Field: OKPOA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    1.405"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ід.код платника')
			Data Field: NLSA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.983"
						Top:    1.405"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рахунок платника')
			Data Field: NAMEA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.783"
						Top:    1.405"
						Width:  6.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Назва платника')
			Data Field: VZ_S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    1.988"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.393"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума взаєморозрахунку')
			Multiline Field: sVZ_S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? No
					Window Location and Size
						Left:   2.733"
						Top:    1.94"
						Width:  8.25"
						Width Editable? Yes
						Height: 0.548"
						Height Editable? Yes
					Visible? Yes
					Font Name: Arial
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Black
					Background Color: 3D Face Color
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума взаєморозрахунку літерами')
			Frame
				Resource Id: 52339
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    2.571"
					Width:  11.0"
					Width Editable? Yes
					Height: 0.917"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Data Field: REGB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.35"
						Top:    2.762"
						Width:  2.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Регіон отримувача')
			Data Field: MFOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.95"
						Top:    2.762"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Код МФО банку отримувача')
			Data Field: NBB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.783"
						Top:    2.738"
						Width:  6.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Назва банку отримувача')
			Data Field: NPPB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.35"
						Top:    3.012"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ учаснику по протоколу отримувача')
			Data Field: OKPOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.15"
						Top:    3.012"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ід.код отримувача')
			Data Field: NLSB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.95"
						Top:    3.012"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рахунок отримувача')
			Data Field: NAMEB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.783"
						Top:    2.988"
						Width:  6.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Назва отримувача')
			!
			Data Field: REF_PL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    3.738"
						Width:  1.867"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф пл.доручення в інф.БД')
			Data Field: REFD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    4.655"
						Width:  1.867"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф Деб.док в АБС')
			Data Field: REFK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    4.655"
						Width:  1.867"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф Крд.док в АБС')
			Data Field: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    3.738"
						Width:  1.867"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ платіжного доручення')
			Data Field: DATD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.983"
						Top:    3.738"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата складання платіжного доручення')
					On SAM_Validate
						Call F_Dat()
			Data Field: DATP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.683"
						Top:    3.738"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата надходження платіжного доручення')
			Data Field: VZ_DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.683"
						Top:    3.738"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.286"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата ВЗАЄМОРОЗРАХУНКУ')
			Multiline Field: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 160
					String Type: String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? No
					Window Location and Size
						Left:   0.2"
						Top:    4.071"
						Width:  10.983"
						Width Editable? Yes
						Height: 0.524"
						Height Editable? Yes
					Visible? Yes
					Font Name: Arial
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Black
					Background Color: Sky
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Призначення платежу')
			Radio Button: rb0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Новий    
				Window Location and Size
					Left:   0.383"
					Top:    0.405"
					Width:  2.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Відкритий для вводу
				Window Location and Size
					Left:   0.383"
					Top:    0.655"
					Width:  2.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call F_GOT()
			Radio Button: rb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Готовий
				Window Location and Size
					Left:   3.383"
					Top:    0.655"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call F_GOT()
			Radio Button: rb_1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Відкликаний
				Window Location and Size
					Left:   5.983"
					Top:    0.655"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call F_GOT()
			Radio Button: rb5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Виконано
				Window Location and Size
					Left:   8.483"
					Top:    0.655"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   7.383"
					Top:    3.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Зберегти платіжне доручення '
					On SAM_Click
						If NOT F_Save()
							Call SqlRollback ( hSql() )
			Pushbutton: pb_Doc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   7.883"
					Top:    3.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\OPEN.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Переглянути та друкувати пл.доручення '
					On SAM_Click
						If REF_PL > 0
							Call DocViewContentsEx(hWndForm, REF_PL )
			Pushbutton: pb_Print
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   8.383"
					Top:    3.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\PRINT.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Друкувати пл.доручення '
					On SAM_Click
						If REF_PL > 0
							Call DocsPrint( REF_PL, 'OPER', PRINT_DOC )
			Pushbutton: pb_Exit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   8.883"
					Top:    3.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Завершити'
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
		Functions
			Function: F_Dat
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If DATD != DATETIME_Null and DATD > VZ_DAT
						Call SalMessageBox(
								'Дата складення більше Дати ВЗАЄМОРОЗРАХУНКУ',
								"Помилка в даті ! ", MB_IconStop)
						Set DATD = DATETIME_Null
					If DATD != DATETIME_Null and VZ_DAT != DATETIME_Null and VZ_DAT - DATD > 8
						Call SalMessageBox(
								'Між Датою складення та Датою ВЗАЄМОРОЗРАХУНКУ більше 8 днів, термін дії закінчився',
								"Помилка в даті ! ", MB_IconStop)
						Set DATD = DATETIME_Null
			Function: F_Doc
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If REF_PL > 0
						Call SalEnableWindow( pb_Doc )
						Call SalEnableWindow( pb_Print )
					Else
						Call SalDisableWindow( pb_Doc )
						Call SalDisableWindow( pb_Print )
			Function: F_plat
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(),
							  "SELECT u.NAME, u.OKPO, U.REG, U.NLS, U.GOT, U.REF_PL, g.name,b.nb, p.VZ_S,
							          u.ref_absD, u.ref_absK, p.VZ_DAT
							   INTO :NAMEA, :OKPOA,:REGA,:NLSA,:GOT, :REF_PL,:NAME_GOT,:NBA,:VZ_S,
							        :REFD, :REFK, :VZ_DAT
							   FROM ENR_UCH u, enr_got g , banks b, enr_prot p
							   WHERE U.REF=:REF and u.NPP=:NPPA and U.GOT = g.got and U.MFO=b.MFO and p.ref=u.ref " ) 
							and NOT SqlFetchNext( hSql(),nFetchRes) 
						Return FALSE
					!
					Set nTmp = VZ_S * 100
					If SqlPrepareAndExecute( hSql(),
							  "SELECT u.NAME, u.OKPO, U.REG, U.MFO, U.NLS, b.nb, 
							          substr(f_sumpr(:nTmp, :n980, 'M', 2 ) , 1, 254 )
							   INTO :NAMEB, :OKPOB, :REGB, :MFOB, :NLSB, :NBB, :sVZ_S
							   FROM ENR_UCH u, banks b WHERE U.REF=:REF and u.NPP=:NPPB and U.MFO=b.MFO " ) 
							and NOT SqlFetchNext( hSql(),nFetchRes) 
						Return FALSE
					!
					If REF_PL != NUMBER_Null
						If SqlPrepareAndExecute( hSql(),
								   "SELECT nd, datd, nazn, datp into :ND, :DATD,:NAZN,:DATP 
								from "||IifS(nMode = 0,"ENR_","")||"oper where ref=:REF_PL" ) 
								and SqlFetchNext( hSql(),nFetchRes) 
					Else
						Call SalDisableWindow( rb2 )
						Call SalDisableWindow( rb_1 )
					Call SalHideWindow( REFD )
					Call SalHideWindow( REFK )
					If GOT = 1
						Set rb1 = TRUE
					Else If GOT = 2
						Set rb2 = TRUE
					Else If GOT = -1
						Set rb_1 = TRUE
					Else If GOT = 5
						Set rb5 = TRUE
						Call SalDisableWindow( rb1 )
						Call SalDisableWindow( rb_1 )
						Call SalDisableWindow( rb2 )
						Call SalShowWindow( REFD )
						Call SalShowWindow( REFK )
					Else
						Set rb0 = TRUE
					Call F_rb()
					Return TRUE
			Function: F_GOT
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: GOT_OLD
					Boolean: FL
				Actions
					Set GOT_OLD = GOT
					If rb1
						Set GOT =  1
					Else If rb2
						Set GOT = 2
					Else If rb_1
						Set GOT = - 1 
					!
					If NOT SqlPrepareAndExecute( hSql(),"UPDATE enr_UCH Set got=:GOT where REF=:REF and NPP=:NPPA " )
						Call SqlRollback( hSql() )
						Set GOT = GOT_OLD
						Set FL = FALSE
					Else
						Call SqlCommit( hSql() )
						Set FL = TRUE
					!
					Call F_rb()
					Call F_Doc()
					Return FL
			Function: F_rb
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If nMode =2 AND rb1
						Call SalEnableWindow( pbOk )
					Else
						Call SalDisableWindow( pbOk )
						If nMode = 1 or nMode = 0
							Call SalDisableWindow( rb1 )
							Call SalDisableWindow( rb_1 )
							Call SalDisableWindow( rb2 )
					Return TRUE
			Function: F_Save
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRef
					Number: nS 
					Number: nUid
					Number: nNull
					Number: nSos
					String: sNull
					String: BRANCH_B
					String: sData
					String: sOperId
					String: sErr
					String: sErrT
				Actions
					Set sErr = "Збереження неможливе !"
					Set sErrT = ''
					If GOT = 1 
						Set nS = VZ_S * 100 
						If ND  = STRING_Null 
							Set sErrT = sErrT || '
									№ док '
						If DATD = DATETIME_Null
							Set sErrT = sErrT || '
									Дата складання '
						If DATP = DATETIME_Null
							Set sErrT = sErrT || '
									Дата надходження '
						If SalStrLength(NAZN )<3 
							Set sErrT = sErrT || '
									Призначення '
						If NBA =STRING_Null
							Set sErrT = sErrT || '
									МФО-А '
						If SalStrLength(OKPOA )<8
							Set sErrT = sErrT || '
									Ід.код-А '
						If SalStrLength(NAMEA )<3 
							Set sErrT = sErrT || '
									Назва-А '
						If SalStrLength(NLSA )<5 OR NLSA != KeyAccount( MFOA, NLSA )
							Set sErrT = sErrT || '
									Рах-А '
						If NBB =STRING_Null
							Set sErrT = sErrT || '
									МФО-Б '
						If SalStrLength(OKPOB )<8
							Set sErrT = sErrT || '
									Ід.код-Б '
						If SalStrLength(NAMEB )<3 
							Set sErrT = sErrT || '
									Назва-Б '
						If SalStrLength(NLSB )<5 OR NLSB != KeyAccount( MFOB, NLSB )
							Set sErrT = sErrT || '
									Рах-Б '
						If nS = NUMBER_Null OR nS <=0 
							Set sErrT = sErrT || '
									Сума '
						!
						If SalStrLength(sErrT ) > 1
							Call SalMessageBox( sErrT,'Помилка в реквізитах платіжного документу ! ', MB_IconStop)
						Else
							Set nNull = NUMBER_Null 
							Set sNull = STRING_Null
							Set nUid = GetUserId()
							Set nSos = 1
							Set sOperId = GetIdOper()
							Set nRef = NUMBER_Null
							Set BRANCH_B = '/' || MFOB || '/'
							! ============================= DATP
							! 1) Вариант через класс ввода cDoc
							Call cDoc.SetDoc( nRef, 'ENR', 3, 1, ND, DATD, dDat, dDat, dDat,
									     NLSA, NAMEA, MFOA,'', n980, nS, OKPOA, NLSB, NAMEB, MFOB,'', n980, nS, OKPOB,
									     NAZN, sNull, sOperId, sNull, nNull, nNull )
							If NOT cDoc.oDoc()
								Return FALSE
							Set nRef = cDoc.m_nRef
							! =============================
							If REF_PL != NUMBER_Null
									and NOT SqlPrepareAndExecute( hSql(),"UPDATE oper set sos=-1 where ref=:REF_PL" )
								Return FALSE
							If NOT SqlPrepareAndExecute( hSql(),
									"UPDATE enr_UCH Set REF_PL =:nRef where REF=:REF and NPP=:NPPA and GOT = 1 " )
								Return FALSE
							If NOT SqlPrepareAndExecute( hSql(),"UPDATE oper Set BRANCH_B =:BRANCH_B  where REF=:nRef " )
								Return FALSE
							Call SqlCommit ( hSql() )
							Set REF_PL = nRef
							Call SalEnableWindow( rb2 )
							Call SalEnableWindow( rb_1 )
							Call F_Doc()
							Return TRUE
					Else
						Call SalMessageBox(
								'Помилка в признаку готовності ! ',sErr, MB_IconStop)
		Window Parameters
			Number: nMode
			Number: REF
			Number: NPP
			String: strProt
			String: MFO
		Window Variables
			Number: nTmp
			Number: GOT
			Number: n980
			Date/Time: dDat
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				If nMode = 2 and MFO != GetBankMfo()
					Call SalDestroyWindow(hWndForm)
				If nMode = 0 
					Call SalHideWindow( pb_Doc )
					Call SalHideWindow( pb_Print )
				Set dDat = GetBankDate()
				! Call Debug ( SalFmtFormatDateTime( dDat, "dd/MM/yyyy" ) )
				Set DATP = dDat
				Set MFOA = MFO 
				Set n980 = GetBaseVal()
				Set Prot = strProt 
				Set NPPA = NPP
				Call SalDisableWindow( rb5 )
			On SAM_CreateComplete
				Set NPPB = NPP + 1
				If NPP != 1 
					If SqlPrepareAndExecute( hSql(),"select max(npp) into :nTmp from enr_UCH where ref=:REF " ) 
							and SqlFetchNext( hSql(),nFetchRes) 
						If nTmp = NPP  
							Set NPPB = 1
				If NOT F_plat()
					Call SalMessageBox('Не знайдено пари учасників !', "Помилка в протоколі ! ", MB_IconStop)
					Call SalDestroyWindow(hWndForm)
	Form Window: ENR4
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.333"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalTblPopulate( ENR4.tbl, hSql(), 
									"SELECT e.URAD, e.NKRE, e.ID, e.DAT, e.VZ_S,e.KR_S, e.KR_ID, e.KR_DAT, 
									        e.VZ_KOL, e.SOS, e.VZ_DAT, s.name, e.SPECIFIC, 
									        e.CHGDATE, e.DONEBY, e.IDUPD, f.fio 
									 INTO :ENR4.tbl.URAD,:ENR4.tbl.NKRE,  :ENR4.tbl.ID,:ENR4.tbl.DAT,:ENR4.tbl.VZ_S,
									      :ENR4.tbl.KR_S,:ENR4.tbl.KR_ID, :ENR4.tbl.KR_DAT,:ENR4.tbl.VZ_KOL,
									      :ENR4.tbl.SOS, :ENR4.tbl.VZ_DAT,:ENR4.tbl.NAME_SOS,:ENR4.tbl.SPECIFIC, 
									      :ENR4.tbl.CHGDATE, :ENR4.tbl.DONEBY, :ENR4.tbl.IDUPD, :ENR4.tbl.FIO
									 FROM ENR_PROT_UPDATE e, staff f, enr_sos s 
									 WHERE e.REF = :REF and e.sos=s.sos and e.DONEBY=f.id (+) 
									 ORDER BY e.IDUPD, e.CHGDATE ", TBL_FillAll )
							Call SalTblSetLockedColumns( ENR4.tbl, 3 )
							! Call Debug('ENR4.tbl')
							!
							Call SalTblPopulate( ENR4.tbl2, hSql(), 
									"SELECT e.NPP, e.NAME, e.OKPO, e.REG, e.MFO, e.NLS, e.GOT, e.REF_PL, g.name,
									        b.nb, decode(e.GOT, 0, 0, 1), e.REF_ABSD, e.REF_ABSK, 
									        e.CHGDATE, e.DONEBY, e.IDUPD, f.FIO        
									 INTO :ENR4.tbl2.NPP :ENR4.tbl2.NAME,:ENR4.tbl2.OKPO, :ENR4.tbl2.REG,:ENR4.tbl2.MFO,
									      :ENR4.tbl2.NLS,:ENR4.tbl2.GOT,:ENR4.tbl2.REF_PL,:ENR4.tbl2.NAME_GOT,
									      :ENR4.tbl2.NB, :ENR4.tbl2.OTM_GOT,:ENR4.tbl2.REFD,:ENR4.tbl2.REFK,
									      :ENR4.tbl2.CHGDATE,:ENR4.tbl2.DONEBY,:ENR4.tbl2.IDUPD,:ENR4.tbl2.FIO  
									 FROM ENR_UCH_UPDATE e, enr_got g , banks b, staff f
									 WHERE e.REF = :REF and e.GOT = g.got and e.MFO=b.MFO and e.DONEBY=f.id (+) 
									 ORDER BY e.IDUPD, e.CHGDATE,e.NPP ", TBL_FillAll )
							Call SalTblSetLockedColumns( ENR4.tbl2, 3 )
							! Call Debug('ENR4.tbl2')
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23505
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.433"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23506
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.067"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23507
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    1.25"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 1000
					Discardable? Class Default
				Contents
					Column: IDUPD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № 
								мод
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: CHGDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата.час
								модиф
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.867"
						Width Editable? Yes
						Format: DateTime
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: FIO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Автор
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.833"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: URAD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Постанова 
								Уряду
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.1"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NKRE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Постанова 
								НКРЕ
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.133"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № 
								протоколу
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.15"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								протоколу
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.233"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VZ_S
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сума 
								взаєморозрахунку
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.5"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KR_S
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сума 
								кредиту
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.083"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KR_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № 
								кред.дог.
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.083"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KR_DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								кред.дог.
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.117"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VZ_KOL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: кiлькiсть 
								учасникiв
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: стан 
								протоколу
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME_SOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: стан 
								протоколу
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: VZ_DAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								взаєморозрахунку
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.117"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SPECIFIC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Спеціифікація
								 файлу
						Visible? Yes
						Editable? No
						Maximum Data Length: 70
						Data Type: String
						Justify: Left
						Width:  1.767"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: DONEBY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								исп мод
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.15"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   -0.1"
						Top:    1.905"
						Width:  11.483"
						Width Editable? Class Default
						Height: 2.869"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 10000
					Discardable? Class Default
				Contents
					Column: IDUPD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № 
								мод
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: CHGDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата.час
								модиф
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.867"
						Width Editable? Yes
						Format: DateTime
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: FIO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Автор
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.883"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: NPP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № пп
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.633"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Найменування
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  1.583"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OKPO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Iд.код
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.217"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: REG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Регiон
						Visible? No
						Editable? Yes
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  1.15"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: MFO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: МФО 
								
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва 
								установи банку
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № рахунку
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.083"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: GOT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Готовність
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OTM_GOT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Відкрито 
								для філії
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME_GOT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Признак готовностi
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.85"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: REF_PL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Референс
								пл.дор
								в інф.БД
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.983"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: REFD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Референс
								Деб.пл
								в АБС
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.983"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: REFK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Референс
								Крд.пл
								в АБС
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.983"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: DONEBY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								исп мод
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.15"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: REF
			Number: nPar
			String: strTitle
			String: strPar01
			String: strPar02
		Window Variables
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalSetWindowText( hWndForm, 'Аудит модифікації Протоколу та його Учасників № ' || strTitle  )
				!
				Call SalSendClassMessage( SAM_Create, 0, 0 )
	Table Window: KOB
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Комiсiя та її розподiл
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.138"
				Top:    0.167"
				Width:  17.167"
				Width Editable? Class Default
				Height: 8.095"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 2000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Добавити нову угоду'
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вилучити угоду'
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23716
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  6.25"
						Begin Y:  0.071"
						End X:  6.25"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути рахунки модуля'
						On SAM_Click
							Set sTmp= " a.acc in 
									(           select acc26 from kob_acc
									  union all select acc35 from kob_acc where acc35 is not null
									  union all select acc   from kob_acc b, accounts a where a.nls=b.NLS6 
									 )"
							Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23717
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.283"
						Begin Y:  Class Default
						End X:  5.283"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23718
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Kart
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCVIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Розібрати НЕ визначені документи по рахунку'
						On SAM_Click
							If SalTblAnyRows(hWndForm, ROW_Selected, 0)
								If KOLN >0 and KOLN != NUMBER_Null
									If IsWindow(hKOB1)
										Call SalBringWindowToTop ( hKOB1 )
									Set hKOB1 = SalCreateWindow( KOB1, hWndMDI, ACC26, KV, NLS26, NMS26 )
				Pushbutton: pb_Narax
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\K.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Нарахування комісії '
						On SAM_Click
							If not IsWindow(hKOB2)
								Set hKOB2 = SalCreateWindow( KOB2, hWndMDI,strTip,NUMBER_Null, NLS6,sTT )
							Else
								Call SalBringWindowToTop ( hKOB2 )
				Pushbutton: pb_Rozpodil
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\RELATION.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Розподіл нарахованої комісії між балансовими установами'
						On SAM_Click
							If not IsWindow(hKOB3)
								Set hKOB3 = SalCreateWindow( KOB3, hWndMDI,strTip,nKodTR, NLS6,sTT )
							Else
								Call SalBringWindowToTop ( hKOB3 )
				! ctb_pbExecute: pb_Nsi
					                                                                              Message Actions
						                                                                              On SAM_Create
							                                                                              Set strTip = 'Генерація документів на сплату комісії'
						                                                                              On SAM_Click
		Contents
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег.№
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № угоди
						з
						клієнтом
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_SetFocus
						                                                                             Set sTmpE = NMS26
					! On SAM_AnyEdit
						                                                                             Set NMS26 = sTmpE
						                                                                             If ACC26 >0
							                                                                             Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: DATND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						угоди
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						рахунку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_SetFocus
						                                                                             Set sTmpE = NMS26
					! On SAM_AnyEdit
						                                                                             Set NMS26 = sTmpE
						                                                                             If ACC26 >0
							                                                                             Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: NLS26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Осн
						Рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLS26
					On SAM_AnyEdit
						Set NLS26 = sTmpE
						If ACC26 >0 and ACC26 != NUMBER_Null
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
						Else
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_New, FALSE )
					On SAM_DoubleClick
						If ACC26 = NUMBER_Null
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered(
									"ACCOUNTS",
									"NMS",
									" ACCOUNTS.KV="||Str(n980)||
									" and ACCOUNTS.DAZS is null " || 
									" and ACCOUNTS.NBS in ('2600','2650') ",
									sTmp,NMS26)
							! Call FunNSIGetFiltered(
									"ACCOUNTS",
									"NMS",
									" ACCOUNTS.KV="||Str(n980)||
									" and ACCOUNTS.DAZS is null " || 
									" and ( ACCOUNTS.NBS in ('2600','2650') " || 
									  " or  ACCOUNTS.TIP='KOB' and ACCOUNTS.NBS in ('2909') " ||
									      ") ",
									sTmp,NMS26)
							If sTmp  != STRING_Null
								Set ACC26 = Val(sTmp)
								If SqlPrepareAndExecute( hSqlAux2(),
										  "SELECT kv,nls,nms,rnk INTO :KV,:NLS26,:NMS26,:RNK FROM accounts WHERE acc=:ACC26 " )
										and SqlFetchNext( hSqlAux2(), nFetchRes)
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Преф.
						прз.пл.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS35
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Нар.ком
						Рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLS35
					On SAM_AnyEdit
						Set NLS35 = sTmpE
						If ACC35 >0 and ACC35 != NUMBER_Null
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
						Else
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_New, FALSE )
					On SAM_DoubleClick
						If ACC35 = NUMBER_Null and RNK != NUMBER_Null and ACC26 != NUMBER_Null
							Set sTmp = STRING_Null
							If Subs(NLS26,1,2) ='26' 
								Call FunNSIGetFiltered
										("ACCOUNTS","NLS",
										" ACCOUNTS.RNK="||Str(RNK)||
										" and ACCOUNTS.KV="||Str(KV)||
										" and ACCOUNTS.DAZS is null and ACCOUNTS.NBS ='3570' ",
										sTmp,NLS35)
							! Else If Subs(NLS26,1,2) ='29' 
								          Call FunNSIGetFiltered
										("ACCOUNTS","NLS",
										" ACCOUNTS.RNK="||Str(RNK)||
										" and ACCOUNTS.KV="||Str(KV)||
										" and ACCOUNTS.DAZS is null "|| 
										" and ACCOUNTS.NBS is null "|| 
										" and ACCOUNTS.NLS like '0570%' "|| 
										" and ACCOUNTS.TIP ='CIN' ",
										sTmp,NLS35)
							If sTmp  != STRING_Null
								Set ACC35 = Val(sTmp)
								Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
			Column: TAR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						тарифу
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAMT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тариф
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If TAR = NUMBER_Null and ACC26 != NUMBER_Null
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered("TARIF","NAME", " TARIF.TIP=1",sTmp,NAMT)
							If sTmp  != STRING_Null
								Set TAR = Val(sTmp)
								Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
			Column: NLS6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Нар.доходи
						Рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLS6
					On SAM_AnyEdit
						Set NLS6 = sTmpE
						If ACC35 >0 and ACC35 != NUMBER_Null
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
						Else
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_New, FALSE )
					On SAM_DoubleClick
						Set sTmp = STRING_Null
						If Subs(NLS26,1,2) ='26' 
							Call FunNSIGetFiltered
									("ACCOUNTS","NLS",
									" ACCOUNTS.KV="||Str(n980)||
									" and ACCOUNTS.DAZS is null and ACCOUNTS.NBS ='6510' ",
									sTmp,NLS6)
						! Else If Subs(NLS26,1,2) ='29' 
							          Call FunNSIGetFiltered
									("ACCOUNTS","NLS",
									" ACCOUNTS.KV="||Str(n980)||
									" and ACCOUNTS.DAZS is null "|| 
									" and ACCOUNTS.NBS is null "|| 
									" and ACCOUNTS.NLS like '0110%' "|| 
									" and ACCOUNTS.TIP ='CIN' ",
									sTmp,NLS6)
						If sTmp  != STRING_Null
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, TRUE )
			Column: DATP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						попер.
						нарахув
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: KOLY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кіл
						НЕобр
						док
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						НЕобр
						док
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.317"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOLN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кіл
						НЕвизн
						док
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						НЕвизн
						док
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.45"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ACC26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC35
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: nKodTR !! код тарифу розплділу
			String: pNLS6 !! Рах.нарахованих доходів в ГОУ
			! String: strPar02
			String: sTT !! Цепочка кодов операции = 'TT0,TTK,TTD'
		Window Variables
			Number: nTmpE
			String: sTmpE
			Date/Time: dTmpE
			!
			String: sSql
			Number: n980
			String: aMfo
			Date/Time: bDat
			String: sTmp
			Number: nTmp
			Number: nRed
		Message Actions
			On SAM_Create
				! Set KOB.fFilterAtStart = 1
				Set KOB.nRed = SalColorFromRGB( 255,210,250 )
				Call SalColorSet( pb_Kart, COLOR_IndexWindow, KOB.nRed )
				Set KOB.sSql =
						"SELECT ACCOUNTS.rnk,ACCOUNTS.acc, ACCOUNTS.nls, ACCOUNTS.kv,ACCOUNTS.nms,
						        nvl(k.KOLY,0),nvl(k.SUMY/100,0),nvl(k.KOLN,0),nvl(k.SUMN/100,0),
						        b.acc35,a35.nls, b.tarif, t.name, b.NLS6, b.nd,b.datp,b.datnd,
						        b.nazn 
						 INTO :KOB.RNK,:KOB.ACC26,:KOB.NLS26,:KOB.KV,:KOB.NMS26,
						      :KOB.KOLY,:KOB.SUMY,:KOB.KOLN,:KOB.SUMN,:KOB.ACC35,:KOB.NLS35,
						      :KOB.TAR,:KOB.NAMT, :KOB.NLS6,:KOB.ND , :KOB.DATP ,:KOB.DATND,
						      :KOB.NAZN
						 FROM ACCOUNTS, kob_acc b, accounts a35, tarif t,
						 (select b.acc,sum(decode(nvl(b.otm,0),0,0,  1)) KOLY,
						               sum(decode(nvl(b.otm,0),0,1,  0)) KOLN,
						               sum(decode(nvl(b.otm,0),0,0,o.s)) SUMY,
						               sum(decode(nvl(b.otm,0),0,o.s,0)) SUMN
						  from kob b, oper o where nvl(b.otm,0)<3 and o.ref=b.ref1 and b.ref2 is null
						  group by b.acc) k
						where ACCOUNTS.acc=b.acc26 and ACCOUNTS.tip='KOB' and ACCOUNTS.acc=k.acc (+) and
						      b.acc35=a35.acc (+) and b.tarif=t.kod (+) "
				Set KOB.strPrintFileName = 'KOB'
				!
				Set KOB.strSqlInsert=
						"Insert into kob_acc(acc26,acc35,tarif,nls6,nd,datp,datnd, nazn ) values
						(:KOB.ACC26,:KOB.ACC35,:KOB.TAR,:KOB.NLS6,:KOB.ND,:KOB.DATP,:KOB.DATND,
						 :KOB.NAZN ) "
				Set KOB.strSqlDelete=
						"delete from kob_acc where acc26=:KOB.ACC26 "
				Set KOB.strSqlUpdate=
						"UPDATE kob_acc set
						   acc35=:KOB.ACC35, tarif=:KOB.TAR, nls6=:KOB.NLS6,
						   nd   =:KOB.ND, datp=:KOB.DATP, datnd=:KOB.DATND,
						   nazn =:KOB.NAZN
						 where acc26=:KOB.ACC26 "
				Set KOB.n980= GetBaseVal()
				Set KOB.bDat= GetBankDate()
				Set KOB.aMfo= GetBankMfo()
				Set KOB.nTabInstance = 1
				Set KOB.strFilterTblName = 'ACCOUNTS'
				Call SalTblSetLockedColumns( hWndForm,12)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call SalTblPopulate(hWndForm, hSql(), KOB.sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				! Call F_Kol()
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If KOLN >0
					Call XSalTblSetRowBackColor( hWndForm, lParam,  nRed )
				If KOB.NLS6 = STRING_Null
					Set KOB.NLS6 = KOB.pNLS6
			On SAM_TblDoDetails
				If KOLN >0 and KOLN != NUMBER_Null
					Call SalEnableWindow( pb_Kart )
				Else
					Call SalDisableWindow( pb_Kart )
	Table Window: KOB1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: НЕ визначені док. по рах.
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  15.983"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 2000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вилучити документ із картотеки'
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23719
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  6.25"
						Begin Y:  0.071"
						End X:  6.25"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути документ'
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23720
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.283"
						Begin Y:  Class Default
						End X:  5.283"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.417"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23721
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dKV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.283"
							Top:    0.071"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dNLS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    0.071"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dNMS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.183"
							Top:    0.071"
							Width:  3.433"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: REF1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						Док
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = REF1
					On SAM_AnyEdit
						Set REF1 = nTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFOA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО-А
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = MFOA
					On SAM_AnyEdit
						Set MFOA = sTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: NBA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва Банку
						платника
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NBA
					On SAM_AnyEdit
						Set NBA = sTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: NLSA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						платника
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLSA
					On SAM_AnyEdit
						Set NLSA = sTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: NAMA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						платника
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NAMA
					On SAM_AnyEdit
						Set NAMA = sTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						документу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.383"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вкл
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = OTM
					On SAM_AnyEdit
						If nTmpE = 0 and OTM = 1
						Else If nTmpE = 1 and OTM = 0
							Call SalTblSetRowFlags( hWndForm, SalTblQueryContext( hWndForm ), ROW_Edited,  FALSE )
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						платника
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  4.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NAZN
					On SAM_AnyEdit
						Set NAZN = sTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			!
		Functions
		Window Parameters
			Number: nACC
			Number: nKV
			String: sNLS
			String: sNMS
		Window Variables
			Number: nTmpE
			String: sTmpE
			Date/Time: dTmpE
			!
			Number: n980
			Date/Time: dDat
			String: sTmp
			Number: nTmp
		Message Actions
			On SAM_Create
				Set KOB1.strPrintFileName = 'KOB1'
				Call SalSetWindowText
						( hWndForm, "НЕ визначені док. по рах. "||Str(nKV)||'/'||sNLS||' '||sNMS )
				Set KOB1.dKV = KOB1.nKV
				Set KOB1.dNLS = KOB1.sNLS
				Set KOB1.dNMS = KOB1.sNMS
				! Set KOB.fFilterAtStart = 1
				Set KOB1.strSqlPopulate =
						"SELECT OPER.ref,OPER.kv,OPER.mfoa,OPER.nlsa,OPER.nam_a,
						        OPER.s/100,OPER.nazn, b.nb
						 INTO :KOB1.REF1,:KOB1.KV,:KOB1.MFOA,:KOB1.NLSA,:KOB1.NAMA,
						      :KOB1.S,:KOB1.NAZN,:KOB1.NBA
						 FROM OPER, kob k, banks b
						 WHERE OPER.ref=k.ref1 and nvl(k.otm,0)=0 and k.acc=:KOB1.nACC
						   and OPER.mfoa=b.mfo
						 Order by k.ref1 "
				Set KOB1.strSqlDelete= "delete from kob where acc=:KOB1.nACC and ref1=:KOB1.REF1 and nvl(otm,0)=0"
				Set KOB1.strSqlUpdate= "update kob set otm=2 where acc=:KOB1.nACC and ref1=:KOB1.REF1 and nvl(otm,0)=0"
				! Set KOB1.n980= GetBaseVal()
				! Set KOB1.dDat = GetBankDate()
				Set KOB1.nTabInstance = 1
				Set KOB1.strFilterTblName = 'OPER'
				Call SalTblSetLockedColumns( hWndForm,7)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_DoubleClick
				If REF1 > 0
					Call DocViewContentsEx(hWndForm, REF1 )
	Table Window: KOB2
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Нарахування комісії
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.7"
				Top:    0.375"
				Width:  14.167"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 5000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.571"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23722
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  7.65"
						Begin Y:  0.071"
						End X:  7.65"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Пергляд первинних документів
									вибраного клієнта'
						On SAM_Click
							If SalTblAnyRows(hWndForm, ROW_Selected, 0)
								If REF2 = NUMBER_Null
									Set sTmp1 = " НЕ обробленних"
									Set sTmp = "a.sos=5 and a.ref in
											(select ref1 from kob where ref2 is null and otm in (1,2) and acc="|| Str(ACC26)||" )"
								Else
									Set sTmp1 = " Oбробленних"
									Set sTmp = "a.sos=5 and a.ref in
											(select ref1 from kob where ref2="|| Str(REF2)||" and acc="|| Str(ACC26)||" )"
								Call DocViewListInt( hWndMDI,sTmp, strTip ||sTmp1  )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23723
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  8.083"
						Begin Y:  0.071"
						End X:  8.083"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.917"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23724
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 
									'Генерація проводок по нарахуванню комісії
									по ВСІМ клієнтам, що є в таблиці'
						On SAM_Click
							If F_Opl(0,strTip)
				Pushbutton: pb_Run1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\SELECT.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 
									'Генерація проводок по нарахуванню комісії
									по ВИБРАНИМ клієнтам '
						On SAM_Click
							If F_Opl(ROW_Selected,strTip)
				Data Field: FDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.883"
							Top:    0.071"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 
									'Дата, по яку нарахувати комісію (включно)')
		Contents
			Column: OKPO35
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						клієтна
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC35
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC35
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS35
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Нар.ком
						Рахунок
						3570
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS35
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						рахунку
						3570
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Нар.дох
						Рахунок
						6110
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						рахунку
						6110
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.05"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кількість
						первин
						док
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.933"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						нарах
						комісії
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.667"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						нового
						док
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REF2 > 0
							Call DocViewContentsEx(hWndForm, REF2 )
					On SAM_SetFocus
						Set nTmpE = REF2
					On SAM_AnyEdit
						Set REF2 = nTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			!
			Column: ACC26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC26
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						попер.
						нарахув
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						угоди
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № угоди
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						2600
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Opl
				Description:
				Returns
				Parameters
					Number: nTipRow
					String: strTip1
				Static Variables
				Local variables
					Number: nRef
					Number: nRow
					Number: nS
					String: sNazn
					Date/Time: dTmp
				Actions
					If SalMessageBox(
							'Виконати 
							'||strTip1||' ? ',
							'У В А Г А !', MB_IconQuestion | MB_YesNo) = IDYES
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, nTipRow, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If REF2 = NUMBER_Null
								Set nRef = NUMBER_Null
								Set nS = S * 100
								! только начислить комис
								! НАРАХУВАННЯ КОМІСІЇ ЗА ДОГОВОРОМ № ___ ВІД ___ ЗА  ___ПЕРІОД____ ЗА РАХУНКОМ 2600___
								Set dTmp = DATP + 1
								! 3. При формировании ордара 
										по начислению комиссии с 3570 на 6110
										в назначении платежа неправильно 
										формулируется период дат: "с" правильно, 
										из поля "дата поперед.нарах.", 
										а значение "по" берется ТЕКУЩАЯ БАНКОВСКАЯ ДАТА, 
										а не дата, по которую задавали начислять. 
										Надо исправить. 
								If dTmp > bDat
									Set dTmp = bDat
								Set sNazn =
										"Нарахування комісії за дог № "|| ND || " вiд "||
										SalFmtFormatDateTime( DATND, "dd/MM/yyyy" ) ||
										" за перiод з " || SalFmtFormatDateTime( dTmp, "dd/MM/yyyy" ) ||
										" по "|| SalFmtFormatDateTime( FDAT, "dd/MM/yyyy" ) ||
										" за рах." || NLS26
								Set sNazn = Subs(sNazn,1,160)
								Call cDoc.SetDoc( nRef, TT1, 1, 6, Str(nRef), bDat, bDat, bDat, bDat,
										     NLS35, NMS35, aMfo,'', KV, nS, OKPO35,
										     NLS6 , NMS6 , aMfo,'',n980,nS, GetBankOkpoS(),
										     sNazn ,'',GetIdOper(),'',NUMBER_Null, 0)
								If not cDoc.oDoc()
									Call SqlRollback( hSql() )
									Return FALSE
								! отметить начисление на документах и на счете 
								Set nRef = cDoc.m_nRef
								If NOT SqlPrepareAndExecute( hSql(),
										"update kob k set k.otm=k.otm+2, k.ref2 =:cDoc.m_nRef
										 where k.ref2 is null and k.otm in (1,2) and k.acc=:ACC26 
										   and EXISTS (select 1 from opldok where ref=k.REF1 and fdat<= :KOB2.FDAT) " )
										OR NOT SqlPrepareAndExecute( hSql(),
										"update kob_acc set dats=datp+1, datp=:KOB2.FDAT where acc26=:ACC26 " )
									Call SqlRollback( hSql() )
									Return FALSE
								Set REF2 = cDoc.m_nRef
								Call XSalTblSetCellBackColor( REF2, COLOR_LightGreen )
								Call SqlCommit( hSql() )
					Return TRUE
		Window Parameters
			String: sTitl
			Number: nRez !! резервний параметр
			String: pNLS6 !! Рах.нарахованих доходів в ГОУ
			String: sTT !! Цепочка кодов операции = 'TT1,TT2'
		Window Variables
			Number: n980
			Date/Time: bDat
			String: sOkpo35
			Number: nKv
			!
			String: sTmp
			String: sTmp1
			String: aMfo
			String: TT1
			String: sSql
			String: F_TARIF !! имя формулы-аналога F_TARIF
			: cDoc
				Class: cDoc
			Number: nTmpE
		Message Actions
			On SAM_Create
				Set KOB2.strPrintFileName = 'KOB2'
				Set KOB2.TT1 = Subs(sTT,1,3)
				Call SalSetWindowText( hWndForm, sTitl )
				Set n980= GetBaseVal()
				Set bDat = GetBankDate()
				Set FDAT = bDat - 1
				Set aMfo = GetBankMfo()
				Set F_TARIF = GetGlobalOption('KOB_TARF') 
				If SalStrLength( F_TARIF ) < 2
					Set F_TARIF = 'F_TARIF' 
				Call SalTblSetLockedColumns( hWndForm,7)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set sSql =
						"select k.acc26,k.acc35, k.nls6,k.datp,k.nd,k.datnd,
						        count(*), sum(" || F_TARIF || "(k.tarif,a.kv,a.nls,o.S,0))/100
						 into :KOB2.ACC26,:KOB2.ACC35,:KOB2.NLS6,:KOB2.DATP,:KOB2.ND,:KOB2.DATND,
						      :KOB2.KOL,:KOB2.S
						 from kob_acc k, accounts a, kob r, oper o
						 where k.acc35 is not null and k.tarif is not null and k.acc26=a.acc
						    and k.acc26=r.acc and r.otm in (1,2)
						    and r.ref2  is null and r.REF1=o.ref  and o.sos=5
						    and k.acc35 is not null 
						    and EXISTS (select 1 from opldok where ref=r.REF1 and fdat<= :KOB2.FDAT)
						 group by k.acc26, k.acc35, k.nls6,k.datp,k.nd,k.datnd
						 order by k.acc35 "
				! Call Debug (sSql)
				Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				! Call F_Kol()
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If KOB2.NLS6 = STRING_Null
					Set KOB2.NLS6 = KOB2.pNLS6
				!
				If SqlPrepareAndExecute( hSqlAux2(),
						"select a.kv,a.nls, a.nms, c.okpo, a6.nms, a2.nls
						 into :KOB2.KV,:KOB2.NLS35,:KOB2.NMS35, :KOB2.OKPO35,:KOB2.NMS6,:KOB2.NLS26
						 from accounts a, customer c, accounts a6, accounts a2
						 where a.rnk=c.rnk and a.acc =:KOB2.ACC35
						   and a6.kv=:n980 and a6.nls=:KOB2.NLS6
						   and a2.acc=:KOB2.ACC26 ")
						and SqlFetchNext( hSqlAux2(), nFetchRes)
			! On SAM_ColumnSelectClick
	Table Window: KOB4
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Перегляд первинних та породжених документів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.175"
				Top:    0.281"
				Width:  17.267"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 5000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23725
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F2
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF2.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Пергляд первинних документів по Реф-2 (Нарахування)'
						On SAM_Click
							If SalTblAnyRows(hWndForm, ROW_Selected, 0)
								If REF2 != NUMBER_Null
									Set sTmp =
											 "a.ref in (select ref1 from kob where ref2=" || Str(REF2) || ")"
									Call DocViewListInt( hWndMDI,sTmp, strTip || ' =  '||Str(REF2)  )
				Pushbutton: pb_Ref4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F4
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF4.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Пергляд первинних документів по Реф-4 (Розподіл)'
						On SAM_Click
							If SalTblAnyRows(hWndForm, ROW_Selected, 0)
								If REF4 != NUMBER_Null
									Set sTmp =
											 "a.ref in (select ref1 from kob where ref4=" || Str(REF4) || ")"
									Call DocViewListInt( hWndMDI,sTmp, strTip || ' =  '||Str(REF4)  )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23726
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23727
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: REF2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф-2
						Нарахування
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REF2 > 0
							Call DocViewContentsEx(hWndForm, REF2 )
					On SAM_SetFocus
						Set nTmpE = REF2
					On SAM_AnyEdit
						Set REF2 = nTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: REF4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф-4
						Розподілу
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REF4 > 0
							Call DocViewContentsEx(hWndForm, REF4 )
					On SAM_SetFocus
						Set nTmpE = REF4
					On SAM_AnyEdit
						Set REF4 = nTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: VDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						проводки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № док
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах_А
						в ГОУ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО-Б 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок-Б 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						Документу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Призначення пл
				Visible? Yes
				Editable? No
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  3.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						Документу
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: nPar 
			String: Str01  
			String: Str02  
		Window Variables
			Number: nTmpE
			String: sTmpE
			String: sTmp
			String: sSql
			Number: nRed
			Number: nZel
		Message Actions
			On SAM_Create
				Set KOB4.strPrintFileName = 'KOB4'
				Set KOB4.nRed = SalColorFromRGB( 255,210,250 )
				Set KOB4.nZel = COLOR_LightGreen
				Set KOB4.strFilterTblName = 'V_KOB'
				Set KOB4.strSqlPopulate  =
						"SELECT REF2, REF4, VDAT, ND, NLSA, MFOB,NLSB, S/100, NAZN,SOS
						 INTO :KOB4.REF2, :KOB4.REF4, :KOB4.VDAT, :KOB4.ND, :KOB4.NLSA, 
						      :KOB4.MFOB, :KOB4.NLSB, :KOB4.S, :KOB4.NAZN,  :KOB4.SOS
						 from V_KOB Order by VDAT, ND " 
				Set KOB4.nTabInstance = 1
				Set KOB4.fFilterAtStart = 1
				Call SalTblSetLockedColumns( hWndForm,2)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If SOS<0
					Call XSalTblSetRowBackColor( hWndForm, lParam,  nRed )
				Else If SOS=1
					Call XSalTblSetRowBackColor( hWndForm, lParam,  nZel )
				!
	Table Window: KOB3
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Розподіл нарахованої комісії між балансовими установами
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.175"
				Top:    0.281"
				Width:  17.267"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 5000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 47334
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Пергляд первинних документів вибраної балансової установи'
						On SAM_Click
							If SalTblAnyRows(hWndForm, ROW_Selected, 0)
								If REF4 = NUMBER_Null
									Set sTmp =
											   "a.sos=5 and a.mfoa='"||MFOA||"' and a.nlsb='"||NLS26||"' 
											and a.ref in (select ref1 from kob where ref2 is NOT null  
											and ref4 is null )"
									Set sTmp1 = " НЕ обробленних"
								Else
									Set sTmp =
											"a.sos=5 and a.ref in (select ref1 from kob where ref4 ="||Str(REF4)||")"
								Call DocViewListInt( hWndMDI,sTmp, strTip ||sTmp1  )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 47335
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 47336
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\EXECUTE.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'ВСІ:Генерація проводок по розподілу нарахованої комісії'
						On SAM_Click
							If F_Opl(0,strTip)
		Contents
			Column: REF4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						нового
						док
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REF4 > 0
							Call DocViewContentsEx(hWndForm, REF4 )
					On SAM_SetFocus
						Set nTmpE = REF4
					On SAM_AnyEdit
						Set REF4 = nTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			!
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № угоди
						з
						клієнтом
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						угоди
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						7180
						в ГОУ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFOA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						балансової
						установи
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS61
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						6180
						в установі
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата нар.
						"З"
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.15"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата нар.
						"По"
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кіл.
						перв.
						док
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.667"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						платежів
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						нарах
						комісії
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S9
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						розпод.
						комісії
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NBA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						балансової
						установи
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва рахунку
						7180
						в ГОУ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ЗКПО
						балансової
						установи
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NLS26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Осн
						Рахунок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Opl
				Description:
				Returns
				Parameters
					Number: nTipRow
					String: strTip1
				Static Variables
				Local variables
					Number: nRef
					Number: nRow
					Number: nS9
					String: sNazn
				Actions
					If SalMessageBox(
							'Виконати 
							'||strTip1||' ? ',
							'У В А Г А !', MB_IconQuestion | MB_YesNo) = IDYES
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, nTipRow, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If REF4 = NUMBER_Null and S9 > 0
								Set nRef = NUMBER_Null
								Set nS9 = S9 * 100
								! поделиться  комиссией c MFOA
								! Set sNazn = "Перерозподіл нарахованої комісії"
								Set sNazn =
										"Розподіл КОМІСІЇ ЗА ДОГОВОРОМ № " || ND || 
										" ВІД " || SalFmtFormatDateTime( DATND, 'dd/MM/yyyy' ) || 
										" ЗА ПЕРІОД з " || SalFmtFormatDateTime( DATS, 'dd/MM/yyyy' ) || 
										" по " ||  SalFmtFormatDateTime( DATP, 'dd/MM/yyyy' )
								Set sNazn = Subs(sNazn,1,160)
								! Реальній платеж
								If MFOA != aMfo
									Call cDoc.SetDoc( nRef, TT2, 1, 6, Str(nRef), bDat, bDat, bDat, bDat,
											     NLS7 , NMS7, aMfo,'', n980, nS9, aOkpo,
											     NLS61, NBA , MFOA,'', n980, nS9, OKPO,
											     sNazn ,'',GetIdOper(),'',NUMBER_Null, 0)
									If not cDoc.oDoc()
										Call SqlRollback( hSql() )
										Return FALSE
								! Инф.док
								Else
									Call Ref(nRef)
									Call cDoc.SetDoc( nRef, TT1, 1, 6, Str(nRef), bDat, bDat, bDat, bDat,
											     NLS7, NMS7, aMfo,'', n980, nS9, aOkpo,
											     NLS61, NBA , MFOA,'', n980, nS9, OKPO,
											     sNazn ,'',GetIdOper(),'',NUMBER_Null, 0)
									If not cDoc.iDoc()
										Call SqlRollback( hSql() )
										Return FALSE
								!
								Set nRef = cDoc.m_nRef
								If NOT SqlPrepareAndExecute( hSql(),
										"update kob k set k.otm=k.otm+2, k.ref4 =:cDoc.m_nRef
										 where k.ref2 is not NULL and k.ref4 is NULL and k.otm in (3,4)  
										   and k.ref1 =
										(select ref from oper where ref=k.ref1 and mfoa=:MFOA and nlsb=:NLS26 )" )
									Call SqlRollback( hSql() )
									Return FALSE
								!
								Set REF4 = cDoc.m_nRef
								Call XSalTblSetCellBackColor( REF4, COLOR_LightGreen )
								Call SqlCommit( hSql() )
					Return TRUE
		Window Parameters
			String: sTitl
			Number: nKodTR !! код тарифу розплділу
			String: pNLS6 !! Рах.нарахованих доходів в ГОУ
			String: sTT !! Цепочка кодов операции = 'TT1,TT2'
		Window Variables
			Number: n980
			Date/Time: bDat
			String: sTmp
			String: sTmp1
			String: sMfoa
			String: sNba
			String: aMfo
			String: aName
			String: aOkpo
			! String: aMfoS
			String: TT2
			String: TT1
			Number: nS
			: cDoc
				Class: cDoc
			Number: nTmpE
			Number: nDel
			String: sNls26
			String: F_TARIF !! имя формулы-аналога F_TARIF
			! Number: nAcc
		Message Actions
			On SAM_Create
				Set KOB3.strPrintFileName = 'KOB3'
				! String: sTT !! Цепочка кодов операции = 'TT1,TT2'
				Set F_TARIF = GetGlobalOption('KOB_TARF') 
				If SalStrLength( F_TARIF ) < 2
					Set F_TARIF = 'F_TARIF' 
				Set KOB3.TT1 = Subs(sTT,1,3)
				Set KOB3.TT2 = Subs(sTT,5,3)
				Set KOB3.aMfo = GetBankMfo()
				Set KOB3.aName= GetBankName()
				Set sNls26 = '***'
				Set aOkpo = GetBankOkpoS()
				Call SalSetWindowText( hWndForm, sTitl )
				Set KOB3.n980= GetBaseVal()
				Set KOB3.bDat = GetBankDate()
				! Set KOB3.aMfoS = GetBankName()
				Call SalTblSetLockedColumns( hWndForm,1)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set KOB3.strSqlPopulate =
						"SELECT ND, DATND, DATS, DATP, MFOA, NLS, SUM(KOL), sum(S)/100, sum(K)/100
						 INTO :KOB3.ND, :KOB3.DATND, :KOB3.DATS, :KOB3.DATP,:KOB3.MFOA,:KOB3.NLS26, 
						      :KOB3.KOL,:KOB3.S0, :KOB3.S 
						 FROM ( select k.ND, k.DATND, k.DATS, K.DATP, o.mfoa, a.NLS,  
						               1 KOL, o.S, " || F_TARIF || "(k.tarif,a.kv,a.nls,o.S,0) K 
						        from kob_acc k, accounts a, kob r, oper o
						        where  k.acc26=a.acc and r.otm in (3,4) and o.sos=5
						          and r.ref2 is not null and r.ref4 is null and r.ref1=o.ref
						          AND r.acc= a.acc 
						        union all 
						        select k.ND, k.DATND, k.DATS, K.DATP, '300465', a.NLS, 0,0,0 
						        from kob_acc k, accounts a where  k.acc26=a.acc)
						 GROUP BY ND, DATND, DATS, DATP, MFOA, NLS 
						 ORDER by ND, DATND, decode(MFOA,'300465','999999',MFOA)"
				! Call Debug(KOB3.strSqlPopulate )
				Call SalTblPopulate(hWndForm, hSql(), KOB3.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If sNls26 != NLS26 
					Set nDel = 0
					Set sNls26= NLS26
				Set nS = S *100
				If MFOA = aMfo 
					Set NLS7 = pNLS6
					Set NMS7 = aName
					Set NLS61= pNLS6
					Set OKPO = aOkpo
					Set NBA  = aName
					Set S9   = S + nDel
					Set nDel = 0
					If S9 = 0
						Call XSalTblSetRowBackColor( hWndForm, lParam,  COLOR_LightGray )
				Else
					If SqlPrepareAndExecute( hSqlAux2(),
							"select a.nls, substr(a.nms,1,38),
							        l.NLS6_MFO_KOB, l.zkpo, substr(l.NAMEUKRB,1,38), " || 
							       F_TARIF || "(:nKodTR,:n980,a.nls, :nS, 0) /100
							 into :NLS7, :NMS7, :NLS61, :OKPO, :NBA, :S9
							 from accounts a, alegro_KOB l
							 where l.NLS7_GOU_KOB is not null
							   and l.NLS6_MFO_KOB is not null
							   and l.mfo=:MFOA and l.NLS7_GOU_KOB=a.nls and a.kv=:n980 ")
							and SqlFetchNext( hSqlAux2(), nFetchRes)
						Set nDel = nDel + (S - S9)
				!
			On SAM_ColumnSelectClick
	Table Window: OB
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Контроль  О Ш И Б О Ч Н Ы Х  спец.параметров  OB22
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  13.95"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16765
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16766
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16767
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: BRANCH
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						исп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.467"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						отк.счета
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № 
						лиц/счета
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						лицевого счета
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущий
						факт.остаток
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OB_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Старый
						OB22
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NM_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						старого OB22
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OB_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Новый
						OB22
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ERR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ошибка 
						старого OB22
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Set sTmp = STRING_Null
						Call FunNSIGetFiltered ("SB_OB22","TXT", 
								"D_OPEN<=gl.BD and (D_CLOSE is null or D_CLOSE>gl.BD) and R020='"||NBS||"'",
								sTmp,sTmp1)
						If sTmp != STRING_Null
							Set OB_NEW= sTmp
							Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm),
									IifN( ERR='NOT', ROW_New, ROW_Edited ),  TRUE )
							Set ERR = sTmp1
						Else
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_New, FALSE )
						! If S67 = 0 
							             If sTmp != STRING_Null
								             Set OB_NEW= sTmp
								             Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm),
										IifN( ERR='NOT', ROW_New, ROW_Edited ),  TRUE )
								             Set ERR = sTmp1
							             Else 
								             Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
								             Call SalTblSetRowFlags( hWndForm, lParam, ROW_New, FALSE )
			Column: NM_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						нового OB22
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S67
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						лицевого счета
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: nRed
			Number: nSer
			Number: n980
			Number: nTmpE
			String: sTmpE
			String: sTmp
			String: sTmp1
			Date/Time: dTmpE
			String: aMfo
			String: sFilter
			Date/Time: bDat
		Message Actions
			On SAM_Create
				Set OB.fFilterAtStart = 1
				! Set OB.nRed = COLOR_Red
				Set OB.nRed = SalColorFromRGB( 255,210,250 )
				Set OB.nSer = COLOR_LightGray 
				Set OB.n980= GetBaseVal()
				Set OB.bDat = GetBankDate()
				Set OB.aMfo = GetBankMfo()
				Set OB.nTabInstance = 1
				Set OB.strFilterTblName = 'ACCOUNTS'
				Set OB.strPrintFileName = 'OB22'
				Call SalTblSetLockedColumns( hWndForm,9)
				!
				Set OB.strSqlUpdate="UPDATE ACCOUNTS set OB22 = :OB.OB_NEW where ACC = :OB.ACC"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Populate
				If OB.fFilterAtStart
					If SetQueryFilter( cF )
						Set OB.fFilterAtStart = NOT OB.fFilterAtStart
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				!
				Call SalWaitCursor(TRUE)
				!
				Set OB.strSqlPopulate =
						"SELECT tobo,NBS,KV,ISP,DAOS,NLS,NMS,OSTc/100,OB22,ACC,decode(substr(NBS,1,1),'6',1,'7',1,0),'ERR' 
						 INTO :OB.BRANCH,:OB.NBS,:OB.KV,:OB.ISP,:OB.DAOS,:OB.NLS,:OB.NMS,:OB.OST,:OB.OB_OLD,:OB.ACC,:OB.S67,:OB.ERR 
						 FROM  accounts 
						 WHERE dazs is null "|| IifS(sFilter = "", "", " and "||sFilter ) ||" 
						   and nbs in (select r020 from sb_ob22 ) 
						   and nbs||Nvl(OB22,'##') NOT in (select r020||ob22 from sb_ob22 where D_CLOSE is null) 
						 ORDER BY 1,2,3,4"
				! Call Debug (OB.strSqlPopulate)
				Call SalTblPopulate(hWndForm, hSql(), OB.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If OB.S67 = 1 
					Call XSalTblSetRowBackColor( hWndForm, lParam,  OB.nSer )
				If ERR != STRING_Null
					Call XSalTblSetCellBackColor( OB.OB_OLD, OB.nRed  )
	Table Window: RES 
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Iдентифiкованi вклади за перiод
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.088"
				Top:    0.073"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.464"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.548"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 22615
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.083"
						Begin Y:  0.012"
						End X:  4.083"
						End Y:  0.476"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 22616
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 22617
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Radio Button: rb0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Разом
					Window Location and Size
						Left:   3.583"
						Top:    0.155"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: по РУ
					Window Location and Size
						Left:   4.883"
						Top:    0.155"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: по МФО
					Window Location and Size
						Left:   5.983"
						Top:    0.155"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: по ТВБВ
					Window Location and Size
						Left:   7.383"
						Top:    0.155"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Check Box: cb0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Тільки HE 0
					Window Location and Size
						Left:   8.783"
						Top:    0.071"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Frame
					Resource Id: 51388
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.483"
						Top:    0.071"
						Width:  5.0"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Picture: picLegend
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   10.35"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Editable? No
					File Name: \Bars98\RESOURCE\BMP\LEGEND.BMP
					Storage: Internal
					Picture Transparent Color: Magenta
					Fit: Scale
					Scaling
						Width:  100
						Height:  100
					Corners: Square
					Border Style: No Border
					Border Thickness: 1
					Tile To Parent? No
					Border Color: Default
					Background Color: 3D Face Color
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Графічно "До сплати"' )
						On SAM_Click
							! If hTK = hWndNULL
								                                                              Set hTK = SalCreateWindow( GRA, hWndForm, hWndForm.RES.nMode )
							If NOT IsWindow( hTK ) 
								Set hTK = SalCreateWindow( GRA, hWndForm, hWndForm, hWndForm.RES.nMode )
							! Call SalCreateWindow( GRA, hWndForm, hWndForm.RES.nMode )
				Data Field: dDat1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Дата "З ..."')
						On SAM_Create
							Set RES.dDat1 = dtD1 !! GetBankDate()-1
				Data Field: dDat2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.783"
							Top:    0.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Дата "... По"')
						On SAM_Create
							Set RES.dDat2 = dtD2 !! GetBankDate()
		Contents
			Column: RU
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: РУ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						установи
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Left
				Width:  1.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва установи
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: YYYY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Рік 
						народж.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: G01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Кількість
						клієнтів
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: %
						кл.
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.683"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: G02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Кількість
						рахунків
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: %
						рах.
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.617"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: G03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сума
						зобов`язань
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.833"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: %
						зоб
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: G04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сума
						до сплати
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: P04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: %
						спл
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.683"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Zag
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set hWndForm.RES.sTtitl = "Iдентиф.вклади за перiод з " ||
							SalFmtFormatDateTime( hWndForm.RES.dDat1,"dd/MM/yyyy" ) || " по " ||
							SalFmtFormatDateTime( hWndForm.RES.dDat2,"dd/MM/yyyy" )
					If hWndForm.RES.rb0
						Call SalHideWindow( hWndForm.RES.RU )
					Else
						Call SalShowWindow( hWndForm.RES.RU )
						Set hWndForm.RES.sTtitl = hWndForm.RES.sTtitl || " Розріз: РУ "
					!
					! If hWndForm.RES.rb0 OR hWndForm.RES.nMode = 23 and hWndForm.RES.rb1
						                                                                   Call SalShowWindow( hWndForm.RES.pbGRA )
					! Else
						                                                                   Call SalHideWindow( hWndForm.RES.pbGRA )
					If hWndForm.RES.rb1 OR hWndForm.RES.rb0 
						Call SalHideWindow( hWndForm.RES.KOD )
						Call SalHideWindow( hWndForm.RES.NAME )
					Else
						Call SalShowWindow( hWndForm.RES.KOD )
						Call SalShowWindow( hWndForm.RES.NAME )
					!
					Set hWndForm.RES.sTtitl = hWndForm.RES.sTtitl  || hWndForm.RES.pNAME
					If hWndForm.RES.rb2 and hWndForm.RES.pAl =""
						Set hWndForm.RES.sTtitl = hWndForm.RES.sTtitl  || " + МФО "
					Else If hWndForm.RES.rb3 and hWndForm.RES.pAl =""
						Set hWndForm.RES.sTtitl = hWndForm.RES.sTtitl  || " + МФО + ТВБВ"
					!
					Call SalSetWindowText( hWndForm, sTtitl)
					!
					Set hWndForm.RES.sSql = ""
					Set hWndForm.RES.I01 =0
					Set hWndForm.RES.I02 =0
					Set hWndForm.RES.I03 =0
					Set hWndForm.RES.I04 =0
			Function: IG
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set I01 = I01 + G01
					Set I02 = I02 + G02
					Set I03 = I03 + G03
					Set I04 = I04 + G04
			Function: IR
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow,  0, 0)
						Call SalTblSetContext(hWndForm, nRow)
						If I01 > 0 and G01 > 0
							Set P01 = G01*100/I01
						If I02 > 0 and G02 > 0
							Set P02 = G02*100/I02
						If I03 > 0 and G03 > 0
							Set P03 = G03*100/I03
						If I04 > 0 and G04 > 0
							Set P04 = G04*100/I04
					!
					Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
					Call SalTblFetchRow(hWndForm, nRow )
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set NAME='Разом'
					Set G01 = I01
					Set G02 = I02
					Set G03 = I03
					Set G04 = I04
					If I01 > 0
						Set P01 = 100
					If I02 > 0
						Set P02 = 100
					If I03 > 0
						Set P03 = 100
					If I04 > 0
						Set P04 = 100
					! Call XSalTblSetRowBackColor( hWndForm, nRow, nCol[3] )
		Window Parameters
			Number: nMode
			String: pAl 
			String: pNAME
			Boolean: b0
			Boolean: b1
			Boolean: b2
			Boolean: b3
			Number: Pcb0
			Date/Time: dtD1
			Date/Time: dtD2
		Window Variables
			String: sSql
			Number: I01
			Number: I02
			Number: I03
			Number: I04
			String: sAcc
			String: sTtitl
			String: sYYYY
			String: sKod
			Number: nCol
			Number: n10
			Number: mCol[2]
			!
		Message Actions
			On SAM_Create
				! Set hWndForm.RES.mCol[0]=  SalColorFromRGB( 255,210,250 )
				! Set hWndForm.RES.mCol[0]= COLOR_White SalColorFromRGB( 255,210,250 )
				! Set hWndForm.RES.mCol[1]= SalColorFromRGB( 250,250,250 )
				If NOT(
						hWndForm.RES.nMode=23 and hWndForm.RES.b1 
						    OR 
						hWndForm.RES.nMode=24 and hWndForm.RES.b0 
						)
					Call SalHideWindow( picLegend )
				Set hWndForm.RES.n10 = 100000
				Set hWndForm.RES.rb0 = hWndForm.RES.b0
				Set hWndForm.RES.rb1 = hWndForm.RES.b1
				Set hWndForm.RES.rb2 = hWndForm.RES.b2
				Set hWndForm.RES.rb3 = hWndForm.RES.b3
				If hWndForm.RES.nMode = 23
					Call SalHideWindow( hWndForm.RES.rb0 )
					Call SalHideWindow( hWndForm.RES.YYYY )
					Set hWndForm.RES.sAcc = 
							" count(*) KOLK, sum(KOLS) KOLS, sum(S9760) S9760, sum(NVYP) NVYP
							FROM (select a.kf,a.branch, a.rnk, 
							 count(*) KOLS, -sum(a.OSTB) S9760, decode(sign(sum(a.OSTB)),-1,0,c.lim) NVYP 
							      from accounts a, customer c
							      where a.tip='DEP' AND a.nbs='9760' and c.rnk=a.rnk and a.ostb<0 
							        and a.daos>= :hWndForm.RES.dDat1 and a.daos<= :hWndForm.RES.dDat2 
							      group by a.kf, a.branch, a.rnk, c.lim ) 
							GROUP BY "
				Else If hWndForm.RES.nMode = 24
					Call SalShowWindow( hWndForm.RES.rb0 )
					Call SalShowWindow( hWndForm.RES.YYYY )
					Set hWndForm.RES.sYYYY = " substr(to_char(bday,'YYYY'),1,3) ||'*' "
					Set hWndForm.RES.sAcc = 
							hWndForm.RES.sYYYY || " YYYY, 
							count(*) KOLK, sum(KOLS) KOLS, sum(S9760) S9760, sum(NVYP) NVYP 
							FROM ( select a.kf, a.branch, a.rnk, p.bday, 
							count(*) KOLS, -sum(a.OSTB) S9760, decode(sign(sum(a.OSTB)),-1,0,c.lim) NVYP 
							       from accounts a, person p, customer c 
							       where p.rnk=a.rnk and a.tip='DEP' AND a.nbs='9760' and a.rnk=c.rnk  
							         and a.ostb<0  
							         and a.daos>= :hWndForm.RES.dDat1 and a.daos<= :hWndForm.RES.dDat2        
							       group by a.kf,a.branch, a.rnk, p.bday,c.lim ) 
							GROUP BY "
				!
				Call SalTblSetLockedColumns(hWndForm, 4)
				Set hWndForm.RES.strPrintFileName = 'CRV'
				Set hWndForm.RES.cb0 = hWndForm.RES.Pcb0
				Call SalSendClassMessage(SAM_Create, 0, 0)
			! On SAM_CreateComplete
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call hWndForm.RES.F_Zag()
				If hWndForm.RES.nMode = 23
					If hWndForm.RES.rb0  !! По ОБ
					Else If hWndForm.RES.rb1  !! По РУ (по наименованию)
						Set hWndForm.RES.sSql ="
								SELECT h.RU, sum(s.KOLK), sum(s.KOLS), sum(s.S9760)/100, sum(s.NVYP)/100
								INTO :hWndForm.RES.RU, :hWndForm.RES.G01, :hWndForm.RES.G02, 
								     :hWndForm.RES.G03,:hWndForm.RES.G04 
								FROM (select branch, nameukrr RU from alegrob ) h,     
								     (SELECT BRANCH," || hWndForm.RES.sAcc || " BRANCH ) s
								WHERE h.BRANCH = s.BRANCH " || 
								IifS(hWndForm.RES.cb0 = 1,"","(+)") || " 
								GROUP BY h.RU ORDER BY h.RU "
						! Call Debug(hWndForm.RES.sSql)
					Else If hWndForm.RES.rb2 !! По MFO (по KF)
						Set hWndForm.RES.sSql ="
								SELECT h.RU, h.MFO, h.fullNAME,  s.KOLK,  s.KOLS,  s.S9760/100, s.NVYP/100 
								INTO :hWndForm.RES.RU,  :hWndForm.RES.KOD, :hWndForm.RES.NAME, 
								     :hWndForm.RES.G01, :hWndForm.RES.G02, :hWndForm.RES.G03, :hWndForm.RES.G04
								FROM (select nameukrr RU, substr(branch,2,6) MFO,fullNAME from alegrob 
								      where LENGTH(BRANCH)=8 " || hWndForm.RES.pAl || ") h, 
								     (SELECT KF, " || hWndForm.RES.sAcc || " KF ) s
								WHERE h.MFO = s.KF " || 
								IifS(hWndForm.RES.cb0 = 1,"","(+)") || " ORDER BY h.RU, h.MFO "
					Else If hWndForm.RES.rb3 !! По TOBO (по BRANCH)
						Set hWndForm.RES.sSql ="
								SELECT h.nameukrr RU, h.BRANCH, h.fullNAME, s.KOLK, s.KOLS, s.S9760/100, s.NVYP/100
								INTO :hWndForm.RES.RU,  :hWndForm.RES.KOD, :hWndForm.RES.NAME, 
								     :hWndForm.RES.G01, :hWndForm.RES.G02, :hWndForm.RES.G03, :hWndForm.RES.G04   
								FROM  alegrob h, (SELECT BRANCH, " || hWndForm.RES.sAcc || " BRANCH ) s
								WHERE h.BRANCH = s.BRANCH " || 
								  IifS(hWndForm.RES.cb0 = 1,"","(+)") || hWndForm.RES.pAl || " 
								ORDER BY h.nameukrr, h.BRANCH "
				Else If hWndForm.RES.nMode = 24
					If hWndForm.RES.rb0  !! По ОБ
						Set hWndForm.RES.sSql ="
								SELECT s.YYYY, s.KOLK, s.KOLS, s.S9760/100, s.NVYP/100  
								INTO :hWndForm.RES.YYYY,:hWndForm.RES.G01, :hWndForm.RES.G02, 
								     :hWndForm.RES.G03 ,:hWndForm.RES.G04 
								FROM (SELECT " || hWndForm.RES.sAcc || hWndForm.RES.sYYYY || " ) s
								ORDER BY s.YYYY "
					Else If hWndForm.RES.rb1  !! По РУ (по наименованию)
						Set hWndForm.RES.sSql ="
								SELECT h.RU, s.YYYY, sum(s.KOLK), sum(s.KOLS), sum(s.S9760)/100, sum(s.NVYP)/100  
								INTO :hWndForm.RES.RU, :hWndForm.RES.YYYY, :hWndForm.RES.G01, 
								     :hWndForm.RES.G02,:hWndForm.RES.G03 , :hWndForm.RES.G04 
								FROM (select branch, nameukrr RU from alegrob ) h,     
								     (SELECT BRANCH," || hWndForm.RES.sAcc || " BRANCH," || hWndForm.RES.sYYYY || " ) s
								WHERE h.BRANCH = s.BRANCH " || 
								IifS(hWndForm.RES.cb0 = 1,"","(+)") || " 
								GROUP BY h.RU,s.YYYY ORDER BY h.RU,s.YYYY "
					Else If hWndForm.RES.rb2 !! По MFO (по KF)
						Set hWndForm.RES.sSql ="
								SELECT h.RU, h.MFO, h.fullNAME, s.YYYY, s.KOLK, s.KOLS, s.S9760/100, s.NVYP/100 
								INTO :hWndForm.RES.RU,  :hWndForm.RES.KOD, :hWndForm.RES.NAME, :hWndForm.RES.YYYY,
								     :hWndForm.RES.G01, :hWndForm.RES.G02, :hWndForm.RES.G03,  :hWndForm.RES.G04     
								FROM (select nameukrr RU, substr(branch,2,6) MFO,fullNAME from alegrob 
								      where LENGTH(BRANCH)=8 " || hWndForm.RES.pAl || ") h, 
								     (SELECT KF, " || hWndForm.RES.sAcc || " KF," || hWndForm.RES.sYYYY || " ) s
								WHERE h.MFO = s.KF " || 
								IifS(hWndForm.RES.cb0 = 1,"","(+)") || " ORDER BY h.RU, h.MFO, s.YYYY "
					Else If hWndForm.RES.rb3 !! По TOBO (по BRANCH)
						Set hWndForm.RES.sSql ="
								SELECT h.nameukrr RU, h.BRANCH, h.fullNAME, s.YYYY, s.KOLK,  s.KOLS, s.S9760/100, s.NVYP/100 
								INTO :hWndForm.RES.RU,  :hWndForm.RES.KOD, :hWndForm.RES.NAME, 
								     :hWndForm.RES.YYYY,:hWndForm.RES.G01, :hWndForm.RES.G02, 
								     :hWndForm.RES.G03 ,:hWndForm.RES.G04   
								FROM  alegrob h, (SELECT BRANCH, " || hWndForm.RES.sAcc || " BRANCH," || hWndForm.RES.sYYYY || " ) s
								WHERE h.BRANCH = s.BRANCH " || 
								  IifS(hWndForm.RES.cb0 = 1,"","(+)") || hWndForm.RES.pAl || " 
								ORDER BY h.nameukrr, h.BRANCH,s.YYYY "
				!
				If hWndForm.RES.sSql != ""
					Set hWndForm.RES.sKod = '*'
					Set hWndForm.RES.nCol = 1
					Call SalTblPopulate(hWndForm, hSql(), hWndForm.RES.sSql,TBL_FillAll  )
					Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
					Call hWndForm.RES.IR()
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Call hWndForm.RES.IG()
				! Call XSalTblSetRowBackColor( hWndForm, lParam, hWndForm.RES.mCol[hWndForm.RES.nCol] )
				! If hWndForm.RES.sKod != hWndForm.RES.KOD
					                                                                   Set hWndForm.RES.sKod = hWndForm.RES.KOD
					                                                                   Set hWndForm.RES.nCol = NOT hWndForm.RES.nCol
			On SAM_DoubleClick
				If hWndForm.RES.rb0
					Call SalCreateWindow( RES, hWndMDI, hWndForm.RES.nMode, 
							"", 
							hWndForm.RES.RU, 
							FALSE, TRUE, FALSE, FALSE, hWndForm.RES.cb0,
							hWndForm.RES.dDat1, hWndForm.RES.dDat2)
				Else If hWndForm.RES.rb1
					Call SalCreateWindow( RES, hWndMDI, hWndForm.RES.nMode, 
							" and nameukrr= '" || hWndForm.RES.RU || "' ", 
							hWndForm.RES.RU, 
							FALSE,FALSE, TRUE, FALSE, hWndForm.RES.cb0,
							hWndForm.RES.dDat1, hWndForm.RES.dDat2)
				Else If hWndForm.RES.rb2
					Call SalCreateWindow( RES, hWndMDI, hWndForm.RES.nMode, 
							"and h.BRANCH like '/"||hWndForm.RES.KOD || "%' ",
							hWndForm.RES.RU || " " || hWndForm.RES.NAME, 
							FALSE,FALSE, FALSE, TRUE, hWndForm.RES.cb0,
							hWndForm.RES.dDat1, hWndForm.RES.dDat2)
	Form Window: GRA
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  12.25"
				Width Editable? Yes
				Height: 5.976"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Custom Control: ccGrafA
.data CLASSPROPSSIZE
0000: 7A19
.enddata
.data CLASSPROPS
0000: 534F555243450004 0074626C00004772 6170685370656300 4C19900100000000
0020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000000200 0000320000000000 0000030000000100
0180: 0000000000000000 0000010000000200 0000030000004172 69616C0000000000
01A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000004172 69616C0000000000 0000000000000000 0000000000000000
0200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000004172 69616C0000000000
0240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000004172 69616C0000000000 0000000000000000 0000000000000000
02A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 000000000000C800 0000960000006400
02E0: 0000B5FFFFFF0000 0000000000000000 0000000000000000 0000060000000000
0300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000000100 0000000000000000 0000000000000000
0360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000000100
0560: 0000010000000000 0000000000000000 0000000000000000 0000000000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0000050000000100 0000000000000000 0000000000000000 0000000000000000
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000003200 0000000000001E00 0000000000000000 0000000000000000
0640: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0000640000000100 0000010000000100 0000030000000100
06A0: 0000000000000000 0000000000000000 0000010000000000 0000000000000000
06C0: 0000000000000000 0000000000000000 0000000000000000 0000000000007462
06E0: 6C00000000000000 0000000000000000 0000000000000000 0000000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000000100 0000414B54310000 0000000000000000
0740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0880: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 0000414B54310000 0000000000000000
0D80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 00004E4E00000000 0000000000000000 0000000000000000 0000000000000000
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0000010000000000 0000000000000000 0000000000000000
14A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 000007000000FFFF FFFFFFFFFFFFFFFF
15A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFF1000 0000100000001000 0000100000001000
15C0: 0000100000001000 0000100000001000 0000100000001000 0000100000001000
15E0: 0000100000000000 0000000000000000 0000000000000000 0000000000000000
1600: 0000000000000100 0000010000000000 0000000000000000 0000000000000000
1620: 0000000000000000 0000FFFFFFFF0000 0000FFFFFFFF0000 0000000000000000
1640: 0000000000000000 0000000000000000 0000000000004752 4150485050522E48
1660: 4C50000000000000 0000000000000000 0000000000000000 0000000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1880: 0000000000000100 0000477261706820 436F6E74726F6C00 0000000000000000
18A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 00000F0000000000 0000080000006400
1940: 0000140000001400 0000000000000000 0000000000000000 0000000000000000
1960: 0000010000000049 54454D000500414B 5431000000000000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQuickGraph
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.267"
						Top:    0.024"
						Width:  11.417"
						Width Editable? Class Default
						Height: 5.214"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: RES1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Default
						Width Editable? Yes
						Height: Default
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: RU
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: YYYY
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: P04
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
		Functions
			Function: Redraw2
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call WaitCursorOn( )
					Set ccGrafA.Graph.DataSource    = "RES1"
					Set ccGrafA.Graph.DataField[0]  = "P04"
					If nMode = 23
						Set ccGrafA.Graph.LegendField   = "RU"
					Else
						Set ccGrafA.Graph.LegendField   = "YYYY"
					Set ccGrafA.Graph.NumDataFields = 1
					Set ccGrafA.Graph.Background[0] = 7
					Set ccGrafA.Graph.Background[1] = 7
					Set ccGrafA.Graph.Background[6] = 7
					Set ccGrafA.Graph.DrawMode = 2
					Call ccGrafA.Draw()
					Call WaitCursorOff( )
			Function: IR
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nRow1
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWnd, nRow,  0, 0)
						Call SalTblSetContext(hWnd, nRow)
						If nMode = 23 and hWnd.RES.RU != STRING_Null 
								OR nMode = 24 and hWnd.RES.YYYY != STRING_Null 
							Set nRow1 = SalTblInsertRow(RES1, TBL_MaxRow )
							Call SalTblFetchRow(RES1, nRow1 )
							Set RES1.P04 = hWnd.RES.P04
							Set RES1.YYYY = hWnd.RES.YYYY
						Set RES1.RU = hWnd.RES.RU
					!
		Window Parameters
			Window Handle: hWnd
			Number: nMode
		Window Variables
		Message Actions
			On SAM_Create
				Call IR()
				Call Redraw2()
			On SAM_Destroy
				Set hTK = hWndNULL
	Table Window: TK
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Розподіл сум для компенсаційних вкладів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.188"
				Top:    0.208"
				Width:  15.45"
				Width Editable? Class Default
				Height: 6.893"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Orchid
					Message Actions
						On SAM_Create
							Set strTip = 'Генерувати проводки по розподілу сум між РУ'
						On SAM_Click
							If SalMessageBox( strTip , 'У В А Г А ! ', MB_YesNo | MB_IconQuestion )=IDYES
								If F_Opl()
									Call SqlCommitEx( hSql(), strTip )
									Call SalWaitCursor( FALSE )
								Else
									Call SqlRollback( hSql() )
									Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Line
					Resource Id: 29056
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29057
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29058
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: NLS_GOU
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.683"
							Top:    0.071"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Загальний Рахунок в ГОУ')
						On SAM_SetFocus
							Set sTmpE = NLS_GOU
						On SAM_AnyEdit
							Set NLS_GOU = sTmpE
				Data Field: OSTC_GOU
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.783"
							Top:    0.071"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Залишок фактичний')
						On SAM_SetFocus
							Set nTmpE = OSTC_GOU
						On SAM_AnyEdit
							Set OSTC_GOU = nTmpE
				Data Field: OSTB_GOU
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   8.883"
							Top:    0.071"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Залишок плановий')
						On SAM_SetFocus
							Set nTmpE = OSTB_GOU
						On SAM_AnyEdit
							Set OSTB_GOU = nTmpE
				Data Field: nDEL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.983"
							Top:    0.071"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Разом перерозподілу')
				!
				Combo Box: cmb_KV
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   1.783"
						Top:    0.071"
						Width:  2.9"
						Width Editable? Yes
						Height: 1.19"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Set nKv = GetBaseVal()
							Call cmb_KV.Init(hWndItem)
							Call cmb_KV.Populate(hSql(),
									"KV"," to_char(KV)||'/'||LCV||'/'||NAME","TABVAL",
									" where kv in (980,840,978) ORDER BY 1 desc ")
							Call SalListSetSelect(cmb_KV,0)
						On SAM_Click
							Set nKv =cmb_KV.GetKey(SalListQuerySelection(hWndItem))
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Column: NMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва
				Visible? Class Default
				Editable? Yes
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Left
				Width:  4.333"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NMS
					On SAM_AnyEdit
						Set NMS = sTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Рахунок
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Left
				Width:  2.117"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLS
					On SAM_AnyEdit
						Set NLS = sTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: OSTC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Фактичний
						залишок
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  2.083"
				Width Editable? Class Default
				Format: ###000
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = OSTC
					On SAM_AnyEdit
						Set OSTC = nTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: OSTB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Плановий
						залишок
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  2.1"
				Width Editable? Class Default
				Format: ###000
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = OSTB
					On SAM_AnyEdit
						Set OSTB = nTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: DEL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: + Добавити 
						- Забрати 
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  2.067"
				Width Editable? Class Default
				Format: ###000
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Validate
						! Set nDEL = SalTblColumnSum( hWndForm, 5,ROW_Edited, 0 ) 
						Set nDEL = SalTblColumnSum( hWndForm, SalTblQueryColumnID( TK.DEL ),ROW_Edited, 0 )
						If nDEL > OSTB_GOU
							Call SalMessageBox("Загальна сума розподілу 
									БІЛЬШЕ
									залишку на рахунку "||NLS_GOU,
									"Увага ! ", MB_IconStop)
							Set DEL = DEL - (nDEL - OSTB_GOU)
							Set nDEL = SalTblColumnSum( hWndForm, SalTblQueryColumnID( TK.DEL ),ROW_Edited, 0 )
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Реф
						операції
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.733"
				Width Editable? Class Default
				Format: #0
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			!
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ОКПО
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Left
				Width:  2.117"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLS
					On SAM_AnyEdit
						Set NLS = sTmpE
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
		Functions
			Function: IZ
				Description: Обнуление итогов
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nKol = 0
					Set nOSTC=0
					Set nOSTB=0
					Set nDEL =0
			Function: IG
				Description: Накопление итогов
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nKol = nKol  + 1
					Set nOSTC= nOSTC + OSTC
					Set nOSTB= nOSTB + OSTB
					! Set nDEL = nDEL  + DEL
			Function: IR
				Description: Итого
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow
				Actions
					! !
					Call SalTblDefineSplitWindow(hWndForm, 1, TRUE)
					Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
					Call SalTblSetContext (hWndForm, nRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Set NMS='Разом'
					Set NLS = Str(nKol)
					Set OSTC = nOSTC
					Set OSTB = nOSTB
					! If I01 > 0
						                                                                 Set P01 = 100
					! If I02 > 0
						                                                                 Set P02 = 100
					! If I03 > 0
						                                                                 Set P03 = 100
					! If I04 > 0
						                                                                 Set P04 = 100
			Function: F_Opl
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nDk
					Number: nS
					Number: nRef
				Actions
					Call SalWaitCursor( TRUE )
					Set nRow = TBL_MinRow
					!
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If DEL !=0 and DEL != NUMBER_Null
							If DEL>0
								Set nDk = 1
								Set nS = DEL * 100
							Else
								Set nDk = 0
								Set nS = - (DEL * 100)
							Set nRef = NUMBER_Null
							Call cDoc.SetDoc( 
									nRef, sTT, nDk, 6,
									STRING_Null, bDat, bDat, bDat, bDat,
									NLS_GOU, NMS_GOU, aMfo, '', nKv, nS, GetBankOkpoS(),
									NLS, NMS, aMfo, '', nKv, nS, OKPO,
									"", '', GetIdOper(), '', NUMBER_Null, 0 )
							If NOT cDoc.oDoc() 
								Return FALSE
							Set REF = cDoc.m_nRef
					!
					Return TRUE
		Window Parameters
			Number: nMode
			Number: nPar
			String: sModeTip
			String: strPar02
		Window Variables
			String: sTip
			String: sTip2
			String: sTT
			Number: aRnk
			Date/Time: bDat
			String: aMfo
			String: sSql
			String: sSql1
			String: NMS_GOU
			Number: nKv
			!
			Number: nKol
			Number: nOSTC
			Number: nOSTB
			!
			: cDoc
				Class: cDoc
			Number: nTmpE
			String: sTmpE
			Date/Time: dTmpE
		Message Actions
			On SAM_Create
				If Len(sModeTip) != 9
					Call SalMessageBox("Неверное значение параметра 'Тиы счетов' для функции!!!", "Внимание", 0)
					Call SalDestroyWindow(hWndForm)
				Else
					Set sTip  = Subs(sModeTip, 1, 3)
					Set sTip2 = Subs(sModeTip, 4, 3)
					Set sTT   = Subs(sModeTip, 7, 3)
					!
					Set TK.aRnk = Val(GetOurRnk())
					Set TK.bDat = GetBankDate()
					Set TK.aMfo = GetBankMfo()
					Set TK.strPrintFileName = 'TK'
					! Set TK.strFilterTblName = 'ACCOUNTS'
					Call SalTblSetLockedColumns(hWndForm, 4)
					!
					Set TK.sSql =
							"SELECT a.NMS, a.NLS, a.OSTC/100, a.OSTB/100, c.OKPO 
							 INTO :TK.NMS,:TK.NLS,:TK.OSTC,:TK.OSTB, :TK.OKPO 
							 FROM ACCOUNTS a, customer c
							 WHERE a.tip=:TK.sTip2 and a.rnk<>:TK.aRnk and a.dazs is null 
							   and a.kv=:TK.nKv and a.rnk=c.rnk 
							 ORDER BY a.rnk "
					Set TK.sSql1 =
							"SELECT NMS, NLS, OSTC/100, OSTB/100
							 INTO :TK.NMS_GOU,:TK.NLS_GOU,:TK.OSTC_GOU,:TK.OSTB_GOU 
							 FROM ACCOUNTS
							 WHERE tip=:TK.sTip and rnk=:TK.aRnk and dazs is null and kv=:TK.nKv "
					!
					Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				If TK.sSql
					Call SalWaitCursor(TRUE)
					If SqlPrepareAndExecute( hSql(), TK.sSql1 ) 
							and NOT SqlFetchNext( hSql(), nFetchRes)
						Set NMS_GOU = STRING_Null
						Set NLS_GOU = STRING_Null
						Set OSTC_GOU = NUMBER_Null
						Set OSTB_GOU = NUMBER_Null
					Call IZ()
					Call SalTblPopulate(hWndForm, hSql(), TK.sSql, TBL_FillAll)
					Call IR()
					Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Call IG()
			On SAM_TblDoDetails
	Table Window: tblView2		! 02
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  15.65"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.65"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9047
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9048
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExecute
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.0"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить процедуру'
						On SAM_Click
							If fCheck()
								Set sProcRunAll       = "ussr_payoff.run_all_kv_like"
								Set sProcRunAllDyings = "ussr_payoff.run_all_dyings"
								Set sExecutedProcedure = IifS(cbDyings, 
										    sProcRunAllDyings || "(dfDat1, dfDat2, dfMfo, sBranch, nPar)", 
										    sProcRunAll       || "(dfDat1, dfDat2, dfMfo, sBranch, nPar, nKv, nLike)")
								Call MessageNoWait("Выполняется процедура." || PutCrLf() || "Это займет некоторое время.", "Информация", 2, 0)
								Call SalWaitCursor(TRUE)
								If SqlPLSQLCommand(hSql(), sExecutedProcedure)
									Call SqlCommitEx(hSql(), "Выполнена процедура " || IifS(cbDyings, sProcRunAllDyings, sProcRunAll))
									Call SalWaitCursor(FALSE)
									Call SalMessageBox("Успешно выполнена процедура " || IifS(cbDyings, sProcRunAllDyings, sProcRunAll), 'Информация', MB_IconAsterisk)
								Else
									Call SqlRollbackEx(hSql(), "Неуспешное выполнение процедуры " || IifS(cbDyings, sProcRunAllDyings, sProcRunAll))
									Call SalWaitCursor(FALSE)
								Call SqlPrepareAndExecute(hSql(), "begin bars_context.set_context; end;")
								Call SalTblReset(hWndForm)
								Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Line
					Resource Id: 9049
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.667"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9050
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  5.2"
						Begin Y:  0.0"
						End X:  5.2"
						End Y:  1.65"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Background Text: Период:
					Resource Id: 9051
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.3"
						Top:    0.15"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Data Field: dfDat1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.6"
							Top:    0.1"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call SalTblReset(hWndForm)
							Return VALIDATE_Ok
				Background Text: -
					Resource Id: 9052
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.9"
						Top:    0.15"
						Width:  0.2"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Data Field: dfDat2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.2"
							Top:    0.1"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call SalTblReset(hWndForm)
							Return VALIDATE_Ok
				Radio Button: rbMfo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Рег. управление
					Window Location and Size
						Left:   5.3"
						Top:    0.45"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set sBranch = STRING_Null
							! Call SalListSetSelect(cmbBranch, -1)
							Call SalEnableWindow(dfMfo)
							Call SalEnableWindow(cmbMfo)
							! Call SalDisableWindow(cmbBranch)
							Call SalDisableWindow(pbBranch)
							Call SalDisableWindow(cbSubTobo)
							Set cbSubTobo = FALSE
							Call SalTblReset(hWndForm)
							Call SalColorSet(rbMfo,     COLOR_IndexWindowText, COLOR_DarkGreen)
							Call SalColorSet(rbBranch,  COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(cbSubTobo, COLOR_IndexWindowText, COLOR_Black)
				Radio Button: rbBranch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Подразделение
					Window Location and Size
						Left:   5.3"
						Top:    0.75"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set dfMfo = STRING_Null
							Call SalListSetSelect(cmbMfo, -1)
							Call SalDisableWindow(dfMfo)
							Call SalDisableWindow(cmbMfo)
							! Call SalEnableWindow(cmbBranch)
							Call SalEnableWindow(pbBranch)
							Call SalEnableWindow(cbSubTobo)
							Call SalTblReset(hWndForm)
							Call SalColorSet(rbBranch, COLOR_IndexWindowText, COLOR_DarkGreen)
							Call SalColorSet(rbMfo, COLOR_IndexWindowText, COLOR_Black)
				Data Field: dfMfo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.6"
							Top:    0.4"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							If SalIsNull(dfMfo)
								Call SalListSetSelect(cmbMfo, -1)
							Else
								Call cmbMfo.SetSelectById(dfMfo)
								If cmbMfo.strCurrentId
								Else
									Call SalMessageBox('Неверный код МФО !', 'Внимание!', MB_IconExclamation)
									Set dfMfo = ''
							Call SalTblReset(hWndForm)
							Return VALIDATE_Ok
				Combo Box: cmbMfo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   8.9"
						Top:    0.4"
						Width:  5.0"
						Width Editable? Class Default
						Height: 7.69"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							If cmbMfo.Init(hWndItem)
								Call cmbMfo.Populate(hSql(), "mfo", "mfo||' '||nb", "banks", " where blk = 0 and kodn = 6 order by mfo")
						On SAM_Click
							Call SalSendClassMessage(SAM_Click, 0, 0)
							Set dfMfo = cmbMfo.strCurrentId
							Call SalTblReset(hWndForm)
				Data Field: dfBranch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.6"
							Top:    0.7"
							Width:  5.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pbBranch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.467"
						Top:    0.7"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\HELP.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выбрать значение из справочника'
						On SAM_Click
							If NOT FunNSIGet('branch', 'name', sBranch, sBranchName)
								Set sBranch = ''
								Set dfBranch = ''
							Else
								Set dfBranch = sBranch || " " || sBranchName
								Call SalTblReset(hWndForm)
				Check Box: cbSubTobo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: в т.ч. по подчиненным ТОБО
					Window Location and Size
						Left:   7.6"
						Top:    1.05"
						Width:  5.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nLike = cbSubTobo
							Call SalColorSet(hWndItem, COLOR_IndexWindowText, IifN(cbSubTobo=TRUE, COLOR_DarkGreen, COLOR_Black))
				Check Box: cbDyings
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Выплаты в связи со смертью вкладчика
					Window Location and Size
						Left:   5.3"
						Top:    1.35"
						Width:  8.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If cbDyings
								Call SalColorSet(cbDyings, COLOR_IndexWindowText, COLOR_DarkGreen)
							Else
								Call SalColorSet(cbDyings, COLOR_IndexWindowText, COLOR_Black)
				Radio Button: rbKv840
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Доллар США
					Window Location and Size
						Left:   0.083"
						Top:    0.45"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nKv = 840
							Call SalColorSet(rbKv840, COLOR_IndexWindowText, COLOR_DarkGreen)
							Call SalColorSet(rbKv978, COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(rbKv0,   COLOR_IndexWindowText, COLOR_Black)
				Radio Button: rbKv978
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: ЕВРО-валюта
					Window Location and Size
						Left:   0.083"
						Top:    0.75"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nKv = 978
							Call SalColorSet(rbKv978, COLOR_IndexWindowText, COLOR_DarkGreen)
							Call SalColorSet(rbKv840, COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(rbKv0,   COLOR_IndexWindowText, COLOR_Black)
				Radio Button: rbKv980
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Гривна Украины
					Window Location and Size
						Left:   0.1"
						Top:    1.05"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nKv = 980
							Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_DarkGreen)
							Call SalColorSet(rbKv840, COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(rbKv978, COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(rbKv0,   COLOR_IndexWindowText, COLOR_Black)
				Radio Button: rbKv0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Все валюты
					Window Location and Size
						Left:   0.1"
						Top:    1.35"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nKv = 0
							Call SalColorSet(rbKv0,   COLOR_IndexWindowText, COLOR_DarkGreen)
							Call SalColorSet(rbKv840, COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(rbKv978, COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_Black)
		Contents
			Column: colBranch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Подразделение
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colBranchName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						подразделения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  6.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDat
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: дата регистрации
						вклада 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  2.0"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCnt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: кол-во вкладов
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOst
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: общая сумма 
						в нац.валюте 
						в копейках
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: fCheck
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If SalIsNull(dfDat1)
						Call SalMessageBox('Не указана начальная дата регистрации компенс.вклада !', 'Внимание!', MB_IconExclamation)
						Call SalSetFocus(dfDat1)
						Return FALSE
					Else If SalIsNull(dfDat2)
						Call SalMessageBox('Не указана конечная дата регистрации компенс.вклада !', 'Внимание!', MB_IconExclamation)
						Call SalSetFocus(dfDat2)
						Return FALSE
					Return TRUE
			! Function: SetParam
				                                                      Description: 
				                                                      Returns 
				                                                      Parameters 
					                                                      String: sView
				                                                      Static Variables 
				                                                      Local variables 
					                                                      String: sSemantic
				                                                      Actions 
					                                                      Call SalTblReset(tblNSI)
					                                                      Call SqlPrepareAndExecute(hSql(), "SELECT semantic INTO :sSemantic FROM meta_tables WHERE tabname=:sView")
					                                                      Call SqlFetchNext(hSql(), nFetchRes)
					                                                      Call SalSetWindowText(hWndForm, sSemantic)
					! Параметры окна
					! strPrintFileName
					                                                      Set hWndForm.tblView.strPrintFileName = SalStrLeftX(sView, 8) || '.ref'
					! nFlags
					                                                      Set hWndForm.tblView.nFlags = GT_ReadOnly
					! Параметры таблицы
					                                                      Set hWndForm.tblView.tblNSI.strNSITableName = sView
					                                                      Set hWndForm.tblView.tblNSI.nNSIMode = 1
					                                                      Set hWndForm.tblView.tblNSI.nNSIModeEdit = 1
					!
					                                                      Call SalSendClassMessage(SAM_Create, 0, 0)
					                                                      Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPar2	! VIEW
		Window Variables
			String: InParam[2]
			String: sViewMfo
			String: sViewBranch
			String: s1
			String: s2
			String: s3
			String: s4
			String: sBranch
			String: sBranchName
			String: sFilter
			Number: nCnt
			Number: nOst
			Number: nIDCnt
			Number: nIDOst
			String: sTxt
			Number: nKv
			Number: nLike
			String: sExecutedProcedure
			String: sProcRunAll
			String: sProcRunAllDyings
		Message Actions
			On SAM_Create
				Call SetWindowFullSize(hWndForm)
				Call SalStrTokenize(SalStrUpperX(sPar2), '', '#', InParam)
				Set sViewMfo    = InParam[0]
				Set sViewBranch = InParam[1]
				Call PrepareWindowEx(hWndForm)
				! МФО
				Set rbMfo = TRUE
				Call SalColorSet(rbMfo, COLOR_IndexWindowText, COLOR_DarkGreen)
				Call SalDisableWindow(pbBranch)
				Call SalDisableWindow(cbSubTobo)
				! Валюта
				Set nKv = 840
				Set rbKv840 = TRUE
				Call SalColorSet(rbKv840, COLOR_IndexWindowText, COLOR_DarkGreen)
				! по подчиненным ТОБО
				Set nLike = 0
				!
				Set hWndForm.tblView2.strPrintFileName = 'view.ref'
				Set hWndForm.tblView2.nFlags = GT_ReadOnly
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				! Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Populate
				If SalMessageBox('Вы действительно хотите выполнить накопление данных?' || PutCrLf() || 
						   'Это займет некоторое время.', 'Вопрос', MB_IconQuestion | MB_YesNo) = IDYES
					! If SalIsNull(dfDat1)
						                                                    Call SalMessageBox('Не указана начальная дата регистрации компенс.вклада !', 'Внимание!', MB_IconExclamation)
						                                                    Call SalSetFocus(dfDat1)
					! Else If SalIsNull(dfDat2)
						                                                    Call SalMessageBox('Не указана конечная дата регистрации компенс.вклада !', 'Внимание!', MB_IconExclamation)
						                                                    Call SalSetFocus(dfDat2)
					If fCheck()
						Set sFilter =  
								    IifS(rbMfo=TRUE, 
								         IifS(dfMfo   != STRING_Null, " and branch = :hWndForm.tblView2.dfMfo ", ""), 
								         IifS(sBranch != STRING_Null and sBranch != '/', " and branch = :hWndForm.tblView2.sBranch ", "") )
						! Call GetSystemStrings(IifS(rbMfo=TRUE,sViewMfo,sViewBranch), s1, s2, s3, s4)
						Set strSqlPopulate = 
								"select branch, name, dat, cnt, ost
								   into :hWndForm.tblView2.colBranch,:hWndForm.tblView2.colBranchName,
								        :hWndForm.tblView2.colDat, :hWndForm.tblView2.colCnt, :hWndForm.tblView2.colOst
								  from " || IifS(dfMfo != STRING_Null, sViewMfo, sViewBranch)||"
								 where dat between :hWndForm.tblView2.dfDat1 and :hWndForm.tblView2.dfDat2 " || sFilter || "
								 order by branch, dat"
						! Call Debug(s1)
						Call ReInitQueryString()
						Set nCnt = 0
						Set nOst = 0
						Call SalSendClassMessage(UM_Populate, wParam, lParam)
						Call SalTblDefineSplitWindow(hWndForm, 3, TBL_Split_Adjustable)
						Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm,TBL_MinSplitRow))
						Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
						! Call SalTblSetColumnText(colBranchName, SalTblQueryColumnID(colBranchName), 'Итого')
						! Call SalTblSetColumnText(colCnt, SalTblQueryColumnID(colCnt), Str(nCnt))
						! Call SalTblSetColumnText(colOst, SalTblQueryColumnID(colOst), Str(nOst))
						Set colBranchName = 'Итого'
						Set colCnt = nCnt
						Set colOst = nOst
						! If smWColumnsS[0] != '' and ( SalGetDataType(hmWColumnsS[0]) = DT_String or SalGetDataType(hmWColumnsS[0]) = DT_LongString )
							                                                      Call SalTblSetColumnText(hWndForm, SalTblQueryColumnID(hmWColumnsS[0]), 'Итого')
						! Call SalTblSetColumnText(hWndForm, nIDCnt, Str(nCnt))
						! Call SalTblSetColumnText(hWndForm, nIDOst, Str(nOst))
			On SAM_FetchRowDone
				Set nCnt = nCnt + colCnt
				Set nOst = nOst + colOst
	Table Window: tblView3		! 03
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.8"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44272
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.217"
						Begin Y:  -0.024"
						End X:  5.217"
						End Y:  0.44"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выбрать файл'
						On SAM_Click
							Call SalTblReset(hWndForm)
							Set nFileId = 0
							If FunNSIGetFiltered('USSR_DBF_FILES', 'FILE_NAME', '', sPK, sSK)
								Set nFileId = Val(sPK)
								Call SalSetWindowText(hWndForm, "Адресные выплаты (файл " || sSK || ")")
								Call SalTblPopulate(hWndForm, hSql(), 
										"select dpt_id, name, icod, n_pasport, nsc, sum_proc, payoff_account, payoff_amount
										   into :hWndForm.tblView3.colDptId, :hWndForm.tblView3.colF_Name, 
										        :hWndForm.tblView3.colF_ICod, :hWndForm.tblView3.colF_Pasport,
										        :hWndForm.tblView3.colF_Nsc, :hWndForm.tblView3.colF_SumProc, 
										        :hWndForm.tblView3.colF_PayoffAccount, :hWndForm.tblView3.colF_PayoffAmount
										   from ussr_dbf_data
										  where file_id=:nFileId
										    and dpt_id is not null
										    and attr in (0, 3, 4)
										  order by id", TBL_FillAll)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.917"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44273
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  3.45"
						Begin Y:  Class Default
						End X:  3.45"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44274
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 44275
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  4.55"
						Begin Y:  0.0"
						End X:  4.55"
						End Y:  0.464"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbPay
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Адресная выплата'
						On SAM_Click
							! Выплаты по файлу по выбранным строкам
							If cbFile
								If nFileId and SalTblAnyRows(hWndForm, ROW_Selected, 0)
									If SalMessageBox("Выполнить адресные выплаты по выбранным строкам?", "Вопрос", MB_IconQuestion | MB_YesNo) = IDYES
										If payFile(ROW_Selected)
											Call MessageNoWait("Выполнена адресная выплата.", "Информация", 2, 0)
							! Адресная выплата
							Else
								If colDptId and not Opl
									If SalMessageBox("Выполнить адресную выплату?" || PutCrLf() || PutCrLf() || 
											   "   " || colNmk, "Вопрос", MB_IconQuestion | MB_YesNo) = IDYES
										If fPay()
											Call MessageNoWait("Успешно выполнена адресная выплата." || PutCrLf() || PutCrLf() || 
													     "   " || colNmk, "Информация", 2, 0)
											Set Opl = 1
											Call XSalTblSetRowBackColor(hWndForm, SalTblQueryContext(hWndForm), SalColorFromRGB(230,255,230))
				Pushbutton: pbPayFile
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.033"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выплаты по всему файлу'
						On SAM_Click
							! Выплаты по всему файлу
							If cbFile and nFileId and SalTblAnyRows(hWndForm, 0, 0)
								If SalMessageBox("Выполнить адресные выплаты по всему файлу?", "Вопрос", MB_IconQuestion | MB_YesNo) = IDYES
									If payFile(0)
										Call MessageNoWait("Выполнена адресная выплата.", "Информация", 2, 0)
				Check Box: cbFile
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: по файлу
					Window Location and Size
						Left:   5.933"
						Top:    0.107"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalTblReset(hWndForm)
							Set nFileId = 0
							If MyValue
								Call setColumns(FALSE)
								Call SalEnableWindow(pbDetails)
								Call SalEnableWindow(pbPayFile)
								Call SalDisableWindow(pbRefresh)
								Call SalDisableWindow(pbFilter)
								Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, FALSE)
							Else
								Call SalSetWindowText(hWndForm, "Адресные выплаты")
								Call setColumns(TRUE)
								Call SalDisableWindow(pbDetails)
								Call SalDisableWindow(pbPayFile)
								Call SalEnableWindow(pbRefresh)
								Call SalEnableWindow(pbFilter)
								Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
				Group Box: Направление выплаты
					Resource Id: 22345
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.1"
						Top:    0.5"
						Width:  4.4"
						Width Editable? Yes
						Height: 1.2"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Radio Button: rbAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Обычные
					Window Location and Size
						Left:   0.3"
						Top:    0.75"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPay = 0
							Call SalColorSet(rbAll,  COLOR_IndexWindowText, COLOR_DarkGreen)
							Call SalColorSet(rbUkrP, COLOR_IndexWindowText, COLOR_Black)
							Set rbKv980 = TRUE
							Call SalSendMsg(rbKv980, SAM_Click, 0, 0)
							Call SalEnableWindow(rbKv980)
							Call SalEnableWindow(rbKv840)
							Call SalEnableWindow(rbKv978)
				Radio Button: rbUkrP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: УкрПочта
					Window Location and Size
						Left:   0.3"
						Top:    1.05"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPay = 980
							Call SalColorSet(rbUkrP, COLOR_IndexWindowText, COLOR_DarkGreen)
							Call SalColorSet(rbAll,  COLOR_IndexWindowText, COLOR_Black)
							Set rbKv980 = TRUE
							Call SalSendMsg(rbKv980, SAM_Click, 0, 0)
							Call SalDisableWindow(rbKv980)
							Call SalDisableWindow(rbKv840)
							Call SalDisableWindow(rbKv978)
				Group Box: Валюта выплаты
					Resource Id: 22346
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.7"
						Top:    0.5"
						Width:  4.4"
						Width Editable? Yes
						Height: 1.2"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Radio Button: rbKv980
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Гривна Украины
					Window Location and Size
						Left:   4.9"
						Top:    0.75"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nKv = 980
							Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_DarkGreen)
							Call SalColorSet(rbKv840, COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(rbKv978, COLOR_IndexWindowText, COLOR_Black)
				Radio Button: rbKv840
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Доллар США
					Window Location and Size
						Left:   4.9"
						Top:    1.05"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nKv = 840
							Call SalColorSet(rbKv840, COLOR_IndexWindowText, COLOR_DarkGreen)
							Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(rbKv978, COLOR_IndexWindowText, COLOR_Black)
				Radio Button: rbKv978
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: ЕВРО-валюта
					Window Location and Size
						Left:   4.9"
						Top:    1.35"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nKv = 978
							Call SalColorSet(rbKv978, COLOR_IndexWindowText, COLOR_DarkGreen)
							Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_Black)
							Call SalColorSet(rbKv840, COLOR_IndexWindowText, COLOR_Black)
		Contents
			Column: colBranch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Подразделение
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colBranchName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						подразделения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDatId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						идент.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDbCode
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: DBCODE
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNls
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNmk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ФИО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSPas
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Серия
						паспорта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNPas
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Номер
						паспорта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDptId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						вклада
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDos
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обороты
						Дебет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKos
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обороты
						Кредит
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOst
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаток
						фактический
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colLim
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Лимит
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colBlkd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						блок.
						Д
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colBlkk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						блок.
						К
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Opl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: colF_Name
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: NAME
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colF_ICod
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ICOD
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colF_Pasport
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: N_PASPORT
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colF_Nsc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: NSC
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colF_SumProc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SUM_PROC
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colF_PayoffAccount
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: PAYOFF_ACCOUNT
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colF_PayoffAmount
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: PAYOFF_AMOUNT
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: setColumns
				Description:
				Returns
				Parameters
					Boolean: bShow
				Static Variables
				Local variables
				Actions
					If bShow
						Call SalShowWindow(colBranch)
						Call SalShowWindow(colBranchName)
						Call SalShowWindow(colDatId)
						Call SalShowWindow(colDbCode)
						Call SalShowWindow(colNls)
						Call SalShowWindow(colNmk)
						Call SalShowWindow(colSPas)
						Call SalShowWindow(colNPas)
						Call SalShowWindow(colDos)
						Call SalShowWindow(colKos)
						Call SalShowWindow(colOst)
						Call SalShowWindow(colLim)
						Call SalShowWindow(colBlkd)
						Call SalShowWindow(colBlkk)
						!
						Call SalHideWindow(colF_Name)
						Call SalHideWindow(colF_ICod)
						Call SalHideWindow(colF_Pasport)
						Call SalHideWindow(colF_Nsc)
						Call SalHideWindow(colF_SumProc)
						Call SalHideWindow(colF_PayoffAccount)
						Call SalHideWindow(colF_PayoffAmount)
					Else
						Call SalHideWindow(colBranch)
						Call SalHideWindow(colBranchName)
						Call SalHideWindow(colDatId)
						Call SalHideWindow(colDbCode)
						Call SalHideWindow(colNls)
						Call SalHideWindow(colNmk)
						Call SalHideWindow(colSPas)
						Call SalHideWindow(colNPas)
						Call SalHideWindow(colDos)
						Call SalHideWindow(colKos)
						Call SalHideWindow(colOst)
						Call SalHideWindow(colLim)
						Call SalHideWindow(colBlkd)
						Call SalHideWindow(colBlkk)
						!
						Call SalShowWindow(colF_Name)
						Call SalShowWindow(colF_ICod)
						Call SalShowWindow(colF_Pasport)
						Call SalShowWindow(colF_Nsc)
						Call SalShowWindow(colF_SumProc)
						Call SalShowWindow(colF_PayoffAccount)
						Call SalShowWindow(colF_PayoffAmount)
			Function: fPay
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If colDptId
						If SqlPLSQLCommand(hSql(), "ussr_payoff.run_one_dpt_id(colDptId, nPay, nKv)")
							Call SqlCommitEx(hSql(), "Выполнена процедура ussr_payoff.run_one_dpt_id (dpt_id="||Str(colDptId)||")")
						Else
							Call SqlRollbackEx(hSql(), "Неуспешное выполнение процедуры ussr_payoff.run_one_dpt_id (dpt_id="||Str(colDptId)||"")
							Return FALSE
					Return TRUE
			Function: payFile
				Description:
				Returns
					Boolean:
				Parameters
					Number: nFlag
				Static Variables
				Local variables
					Number: nRow
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow, nFlag, 0)
						Call SalTblSetContext(hWndForm, nRow)
						If colDptId and not Opl
							If fPay()
								Set Opl = 1
								Call XSalTblSetRowBackColor(hWndForm, SalTblQueryContext(hWndForm), SalColorFromRGB(230,255,230))
					Return TRUE
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPar2
		Window Variables
			String: sPK
			String: sSK
			Number: nFileId
			Number: nPay
			Number: nKv
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, "Адресные выплаты")
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				! Направление выплаты
				Set nPay  = 0
				Set rbAll = TRUE
				Call SalColorSet(rbAll, COLOR_IndexWindowText, COLOR_DarkGreen)
				! Валюта выплаты
				Set nKv     = 980
				Set rbKv980 = TRUE
				Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_DarkGreen)
				!
				Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
				Set hWndForm.tblView3.nFlags = GT_ReadOnly
				Set hWndForm.tblView3.fFilterAtStart = TRUE
				Set hWndForm.tblView3.strFilterTblName = "V_USSR_1"
				Set hWndForm.tblView3.strPrintFileName = "V_USSR_1"
				Set hWndForm.tblView3.strSqlPopulate = 
						"select v_ussr_1.branch, b.name, v_ussr_1.dat_id, 
						        v_ussr_1.dbcode, v_ussr_1.nsc, v_ussr_1.nmk, v_ussr_1.s_pas, v_ussr_1.n_pas, 
						        v_ussr_1.dpt_id, v_ussr_1.dos, v_ussr_1.kos, v_ussr_1.ostc, 
						        v_ussr_1.lim, v_ussr_1.blkd, v_ussr_1.blkk
						   into :hWndForm.tblView3.colBranch, :hWndForm.tblView3.colBranchName, :hWndForm.tblView3.colDatId,
						        :hWndForm.tblView3.colDbCode, :hWndForm.tblView3.colNls,
						        :hWndForm.tblView3.colNmk,    :hWndForm.tblView3.colSPas,
						        :hWndForm.tblView3.colNPas,   :hWndForm.tblView3.colDptId,
						        :hWndForm.tblView3.colDos,    :hWndForm.tblView3.colKos,
						        :hWndForm.tblView3.colOst,    :hWndForm.tblView3.colLim,
						        :hWndForm.tblView3.colBlkd,   :hWndForm.tblView3.colBlkk
						   from v_ussr_1, branch b
						  where v_ussr_1.branch=b.branch
						  order by v_ussr_1.branch, v_ussr_1.dat_id"
				Call SalDisableWindow(pbDetails)
				Call SalDisableWindow(pbPayFile)
				Call setColumns(TRUE)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			! On SAM_CreateComplete
				                                                  If strSqlPopulate != ''
					                                                  If SetQueryFilter(cF) and cF.GetFilterWhereClause(TRUE)
						                                                  Set fFilterAtStart = NOT fFilterAtStart
						                                                  Call SalSendClassMessage(SAM_CreateComplete, 0, 0)
					                                                  Else 
						                                                  Call MessageNoWait("Не установлен фильтр !!!", "Информация", 2, 0)
						                                                  Call SalDestroyWindow(hWndForm)
			On UM_Populate
				If not cbFile
					If cF.GetFilterWhereClause(TRUE)
						Call SalSendClassMessage(UM_Populate, 0, 0)
					Else If not fFilterAtStart
						Call MessageNoWait("Не установлен фильтр !!!", "Информация", 2, 0)
					If fFilterAtStart
						Set fFilterAtStart = not fFilterAtStart
	Form Window: frmView4		! 04
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.5"
				Width Editable? Yes
				Height: 4.5"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.45"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbExecute
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.1"
						Top:    0.07"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить процедуру'
						On SAM_Click
							If fCheck()
								Set sProcRunAll       = "ussr_payoff.run_all_kv_like"
								Set sProcRunAllDyings = "ussr_payoff.run_all_dyings"
								Set sExecutedProcedure = IifS(rbDyings, 
										    sProcRunAllDyings || "(dfDat1, dfDat2, dfMfo, sBranch, nPar)", 
										    sProcRunAll       || "(dfDat1, dfDat2, dfMfo, sBranch, nPar, nPay, nLike, nKv)")
								Call MessageNoWait("Выполняется процедура." || PutCrLf() || "Это займет некоторое время.", "Информация", 2, 0)
								Call SalWaitCursor(TRUE)
								If SqlPLSQLCommand(hSql(), sExecutedProcedure)
									Call SqlCommitEx(hSql(), "Выполнена процедура " || IifS(rbDyings, sProcRunAllDyings, sProcRunAll))
									Call SalWaitCursor(FALSE)
									Call SalMessageBox("Успешно выполнена процедура " || IifS(rbDyings, sProcRunAllDyings, sProcRunAll), 'Информация', MB_IconAsterisk)
								Else
									Call SqlRollbackEx(hSql(), "Неуспешное выполнение процедуры " || IifS(rbDyings, sProcRunAllDyings, sProcRunAll))
									Call SalWaitCursor(FALSE)
								Call SqlPrepareAndExecute(hSql(), "begin bars_context.set_context; end;")
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.85"
						Top:    0.07"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Esc
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выход'
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_Close, 0, 0)
		Contents
			Group Box: Направление выплаты
				Resource Id: 12180
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.1"
					Width:  4.4"
					Width Editable? Yes
					Height: 1.2"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Radio Button: rbAll
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обычные
				Window Location and Size
					Left:   0.4"
					Top:    0.35"
					Width:  3.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nPay = 0
						Call SalColorSet(rbAll,    COLOR_IndexWindowText, COLOR_DarkGreen)
						Call SalColorSet(rbUkrP,   COLOR_IndexWindowText, COLOR_Black)
						Call SalColorSet(rbDyings, COLOR_IndexWindowText, COLOR_Black)
						Set rbKv980 = TRUE
						Call SalSendMsg(rbKv980, SAM_Click, 0, 0)
						Call SalEnableWindow(rbKv980)
						Call SalEnableWindow(rbKv840)
						Call SalEnableWindow(rbKv978)
			Radio Button: rbUkrP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: УкрПочта
				Window Location and Size
					Left:   0.4"
					Top:    0.65"
					Width:  3.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nPay = 980
						Call SalColorSet(rbUkrP,   COLOR_IndexWindowText, COLOR_DarkGreen)
						Call SalColorSet(rbAll,    COLOR_IndexWindowText, COLOR_Black)
						Call SalColorSet(rbDyings, COLOR_IndexWindowText, COLOR_Black)
						Set rbKv980 = TRUE
						Call SalSendMsg(rbKv980, SAM_Click, 0, 0)
						Call SalDisableWindow(rbKv980)
						Call SalDisableWindow(rbKv840)
						Call SalDisableWindow(rbKv978)
			Radio Button: rbDyings
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Умершие
				Window Location and Size
					Left:   0.4"
					Top:    0.95"
					Width:  3.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						! Set nPay = 2
						Call SalColorSet(rbDyings, COLOR_IndexWindowText, COLOR_DarkGreen)
						Call SalColorSet(rbAll,    COLOR_IndexWindowText, COLOR_Black)
						Call SalColorSet(rbUkrP,   COLOR_IndexWindowText, COLOR_Black)
						Set rbKv980 = TRUE
						Call SalSendMsg(rbKv980, SAM_Click, 0, 0)
						Call SalDisableWindow(rbKv980)
						Call SalDisableWindow(rbKv840)
						Call SalDisableWindow(rbKv978)
			!
			Group Box: Валюта выплаты
				Resource Id: 12181
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.8"
					Top:    0.1"
					Width:  4.4"
					Width Editable? Yes
					Height: 1.2"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Radio Button: rbKv980
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Гривна Украины
				Window Location and Size
					Left:   5.0"
					Top:    0.35"
					Width:  3.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nKv = 980
						Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_DarkGreen)
						Call SalColorSet(rbKv840, COLOR_IndexWindowText, COLOR_Black)
						Call SalColorSet(rbKv978, COLOR_IndexWindowText, COLOR_Black)
			Radio Button: rbKv840
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Доллар США
				Window Location and Size
					Left:   5.0"
					Top:    0.65"
					Width:  3.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nKv = 840
						Call SalColorSet(rbKv840, COLOR_IndexWindowText, COLOR_DarkGreen)
						Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_Black)
						Call SalColorSet(rbKv978, COLOR_IndexWindowText, COLOR_Black)
			Radio Button: rbKv978
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ЕВРО-валюта
				Window Location and Size
					Left:   5.0"
					Top:    0.95"
					Width:  3.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nKv = 978
						Call SalColorSet(rbKv978, COLOR_IndexWindowText, COLOR_DarkGreen)
						Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_Black)
						Call SalColorSet(rbKv840, COLOR_IndexWindowText, COLOR_Black)
			!
			Background Text: Период:
				Resource Id: 12178
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    1.6"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfDat1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.7"
						Top:    1.55"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Call SalTblReset(hWndForm)
						Return VALIDATE_Ok
			Background Text: -
				Resource Id: 12179
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.0"
					Top:    1.6"
					Width:  0.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfDat2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.3"
						Top:    1.55"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Call SalTblReset(hWndForm)
						Return VALIDATE_Ok
			Radio Button: rbMfo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег. управление
				Window Location and Size
					Left:   0.4"
					Top:    1.9"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set sBranch = STRING_Null
						! Call SalListSetSelect(cmbBranch, -1)
						Call SalEnableWindow(dfMfo)
						Call SalEnableWindow(cmbMfo)
						! Call SalDisableWindow(cmbBranch)
						Call SalDisableWindow(pbBranch)
						Call SalDisableWindow(cbSubTobo)
						Set cbSubTobo = FALSE
						Call SalTblReset(hWndForm)
						Call SalColorSet(rbMfo,     COLOR_IndexWindowText, COLOR_DarkGreen)
						Call SalColorSet(rbBranch,  COLOR_IndexWindowText, COLOR_Black)
						Call SalColorSet(cbSubTobo, COLOR_IndexWindowText, COLOR_Black)
			Radio Button: rbBranch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Подразделение
				Window Location and Size
					Left:   0.4"
					Top:    2.2"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set dfMfo = STRING_Null
						Call SalListSetSelect(cmbMfo, -1)
						Call SalDisableWindow(dfMfo)
						Call SalDisableWindow(cmbMfo)
						! Call SalEnableWindow(cmbBranch)
						Call SalEnableWindow(pbBranch)
						Call SalEnableWindow(cbSubTobo)
						Call SalTblReset(hWndForm)
						Call SalColorSet(rbBranch, COLOR_IndexWindowText, COLOR_DarkGreen)
						Call SalColorSet(rbMfo, COLOR_IndexWindowText, COLOR_Black)
			Data Field: dfMfo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.7"
						Top:    1.85"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SalIsNull(dfMfo)
							Call SalListSetSelect(cmbMfo, -1)
						Else
							Call cmbMfo.SetSelectById(dfMfo)
							If cmbMfo.strCurrentId
							Else
								Call SalMessageBox('Неверный код МФО !', 'Внимание!', MB_IconExclamation)
								Set dfMfo = ''
						Call SalTblReset(hWndForm)
						Return VALIDATE_Ok
			Combo Box: cmbMfo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.0"
					Top:    1.85"
					Width:  5.0"
					Width Editable? Class Default
					Height: 7.381"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If cmbMfo.Init(hWndItem)
							Call cmbMfo.Populate(hSql(), "mfo", "mfo||' '||nb", "banks", " where blk = 0 and kodn = 6 order by mfo")
					On SAM_Click
						Call SalSendClassMessage(SAM_Click, 0, 0)
						Set dfMfo = cmbMfo.strCurrentId
						Call SalTblReset(hWndForm)
			Data Field: dfBranch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.7"
						Top:    2.15"
						Width:  5.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbBranch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   8.567"
					Top:    2.15"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\HELP.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Выбрать значение из справочника'
					On SAM_Click
						If NOT FunNSIGet('branch', 'name', sBranch, sBranchName)
							Set sBranch = ''
							Set dfBranch = ''
						Else
							Set dfBranch = sBranch || " " || sBranchName
							Call SalTblReset(hWndForm)
			Check Box: cbSubTobo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: в т.ч. по подчиненным ТОБО
				Window Location and Size
					Left:   2.7"
					Top:    2.45"
					Width:  5.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nLike = cbSubTobo
						Call SalColorSet(hWndItem, COLOR_IndexWindowText, IifN(cbSubTobo=TRUE, COLOR_DarkGreen, COLOR_Black))
			Group Box:
				Resource Id: 12182
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    1.35"
					Width:  9.0"
					Width Editable? Yes
					Height: 1.8"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
		Functions
			Function: fCheck
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If SalIsNull(dfDat1)
						Call SalMessageBox('Не указана начальная дата регистрации компенс.вклада !', 'Внимание!', MB_IconExclamation)
						Call SalSetFocus(dfDat1)
						Return FALSE
					Else If SalIsNull(dfDat2)
						Call SalMessageBox('Не указана конечная дата регистрации компенс.вклада !', 'Внимание!', MB_IconExclamation)
						Call SalSetFocus(dfDat2)
						Return FALSE
					Return TRUE
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPar2
		Window Variables
			Number: nPay
			Number: nKv
			String: sBranch
			String: sBranchName
			Number: nLike
			String: sExecutedProcedure
			String: sProcRunAll
			String: sProcRunAllDyings
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				! Направление выплаты
				Set nPay  = 0
				Set rbAll = TRUE
				Call SalColorSet(rbAll, COLOR_IndexWindowText, COLOR_DarkGreen)
				! Валюта выплаты
				Set nKv     = 980
				Set rbKv980 = TRUE
				Call SalColorSet(rbKv980, COLOR_IndexWindowText, COLOR_DarkGreen)
				! МФО
				Set rbMfo = TRUE
				Call SalColorSet(rbMfo, COLOR_IndexWindowText, COLOR_DarkGreen)
				Call SalDisableWindow(pbBranch)
				Call SalDisableWindow(cbSubTobo)
				! по подчиненным ТОБО
				Set nLike = 0
				Call SalSetFocus(pbExit)
	Form Window: frmChangeTobo	! 05
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title: Перевод депозитов
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  16.0"
				Width Editable? Class Default
				Height: 8.667"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить перевод депозитов'
				Line
					Resource Id: 31431
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31432
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31433
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Child Table: tbl
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    1.6"
						Width:  15.667"
						Width Editable? Class Default
						Height: 6.405"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 100000
					Discardable? Class Default
				Contents
					Column: colND
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: №
								договора
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colRnk
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: РНК
								клиента
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNmk
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
								клиента
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  5.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDbCode
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: dbcode
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSer
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Серия
								паспорта
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNumDoc
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: №
								паспорта
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOst		! остаток в копейках
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: sOst
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Остаток
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Right
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDig
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colErrMsg
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Описание ошибки
						Visible? Class Default
						Editable? No
						Maximum Data Length: 2000
						Data Type: Long String
						Justify: Class Default
						Width:  4.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
					Function: AfterPopulate
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalTblDefineSplitWindow(hWndForm, 3, TBL_Split_Adjustable)
							Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm,TBL_MinSplitRow))
							Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
							Set colND  = 'Итого:'
							Set colRnk = nDptCount
							Return TRUE
				Window Variables
					String: sKf
					Number: nDptCount
					Long String: sMsg
				Message Actions
					On UM_Populate
						Call SalTblReset(hWndForm)
						Set sBranchPopulate = ''
						Set frmChangeTobo.strSqlPopulate = ''
						If lParam = 1 and dfBranchOld != ''
								or lParam = 2 and dfBranchNew != ''
							Call SalHideWindow(colErrMsg)
							Set sBranchPopulate = IifS(lParam=1, dfBranchOld, dfBranchNew)
							Call SalSetWindowLabelText(bgDptBranch, "Депозиты подразделения " || sBranchPopulate)
							If SqlPrepareAndExecute(hSql(), "select substr(bars_context.extract_mfo(:sBranchPopulate), 1, 254) into :sKf from dual")
									and SqlFetchNext(hSql(), nFetchRes)
								If SalMessageBox("Показать депозиты подразделения " || sBranchPopulate || "?", "Вопрос", MB_IconQuestion | MB_YesNo) = IDYES
									Set frmChangeTobo.strSqlPopulate = 
											"select nd, rnk, nmk, dbcode, ser, numdoc, ostc, dig
											   into :frmChangeTobo.tbl.colND, :frmChangeTobo.tbl.colRnk, :frmChangeTobo.tbl.colNmk, 
											        :frmChangeTobo.tbl.colDbCode, :frmChangeTobo.tbl.colSer, :frmChangeTobo.tbl.colNumDoc, 
											        :frmChangeTobo.tbl.colOst, :frmChangeTobo.tbl.colDig
											   from v_ussrtransf_dpt
											  where branch = :sBranchPopulate
											    and kf     = :sKf"
								Else
									Call SqlPrepareAndExecute(hSql(),
											"select count(*)
											   into :nDptCount
											   from v_ussrtransf_dpt
											  where branch = :sBranchPopulate
											    and kf     = :sKf")
									Call SqlFetchNext(hSql(), nFetchRes)
									Call AfterPopulate()
						Else If lParam = 3
							Call SalShowWindow(colErrMsg)
							Call SalSetWindowLabelText(bgDptBranch, "Протокол переноса")
							Set frmChangeTobo.strSqlPopulate = 
									"select nd, rnk, nmk, dbcode, ser, numdoc, ostc, dig, substr(err_msg,1,2000) 
									   into :frmChangeTobo.tbl.colND, :frmChangeTobo.tbl.colRnk, :frmChangeTobo.tbl.colNmk, 
									        :frmChangeTobo.tbl.colDbCode, :frmChangeTobo.tbl.colSer, :frmChangeTobo.tbl.colNumDoc, 
									        :frmChangeTobo.tbl.colOst, :frmChangeTobo.tbl.colDig, :frmChangeTobo.tbl.colErrMsg
									   from v_ussrtransf_log"
						If frmChangeTobo.strSqlPopulate
							Call frmChangeTobo.ReInitQueryString()
							Set nDptCount = 0
							Call SqlSetLongBindDatatype(9, 22)
							Call SalSendClassMessage(UM_Populate, 0, 0)
							Call AfterPopulate()
					On SAM_FetchRowDone
						Set sOst = Dig4(Abs(colOst)/100, colDig, nMaxDig)
						Set nDptCount = nDptCount + 1
					On UM_Update
						If dfBranchOld = ''
							Call SalMessageBox("Не заполнен код подразделения-А", "Внимание!", MB_IconStop)
							Return FALSE
						If dfBranchNew = ''
							Call SalMessageBox("Не заполнен код подразделения-Б", "Внимание!", MB_IconStop)
							Return FALSE
						If dfBranchOld = dfBranchNew
							Call SalMessageBox("Неверно заполнены коды подразделений (подразделение-А = подразделение-Б)!", "Внимание!", MB_IconStop)
							Return FALSE
						If dfBranchOld != '' and dfBranchNew != ''
							If SalMessageBox("Выполнить перевод депозитов из подразделения " || dfBranchOld || 
									   " в подразделение " || dfBranchNew || "?", "Внимание!", MB_IconQuestion | MB_YesNo) = IDYES
								Call SalWaitCursor(TRUE)
								If SqlPLSQLCommand(hSql(), "ussr_transfer.run_all(dfBranchOld, dfBranchNew, cbCloseDupl, STRING_Null) ")
									Call SqlCommitEx(hSql(), "CHANGE_TOBO. Выполнена процедура перевода депозитов из подразделения " || dfBranchOld || 
											     " в подразделение " || dfBranchNew)
									Call SalWaitCursor(FALSE)
									Call SqlPrepareAndExecute(hSql(), "select substr(ussr_transfer.get_statistic(:dfBranchOld, :dfBranchNew), 1 ,2000) into :sMsg from dual")
									Call SqlFetchNext(hSql(), nFetchRes)
									If sMsg
										Call SalMessageBox(sMsg, "Сообщение", MB_IconAsterisk)
										Call SaveInfoToLog("CHANGE_TOBO. " || sMsg)
									Call SalSendMsg(hWndForm, UM_Populate, 0, 3)
								Else
									Call SqlRollbackEx(hSql(), "CHANGE_TOBO. Неуспешное выполнение процедуры перевода депозитов из подразделения " || dfBranchOld || 
											     " в подразделение " || dfBranchNew)
									Call SalWaitCursor(FALSE)
					On SAM_RowHeaderClick
						If SalIsWindowVisible(colErrMsg)
							Call XSalTooltipSetColors(COLOR_Black, COLOR_LightGray)
							Call XSalTooltipShow(hWndForm, colErrMsg)
							Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
			Background Text: Перевод депозитов из подразделения
				Resource Id: 31429
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.1"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: в подразделение
				Resource Id: 31430
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.0"
					Top:    0.1"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfBranchOld
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.2"
						Top:    0.35"
						Width:  4.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfBranchNameOld
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.2"
						Top:    0.65"
						Width:  5.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbSearchOld
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSearch
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   4.767"
					Top:    0.274"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If NOT FunNSIGet('branch', 'name', sBranch, sBranchName)
							Set sBranch = ''
						Else
							Set dfBranchOld     = sBranch
							Set dfBranchNameOld = sBranchName
							Call SalSendMsg(pbRefreshOld, SAM_Click, 0 ,0 )
					On SAM_Create
						Set strTip = "Выбрать подразделение"
			Pushbutton: pbRefreshOld
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.267"
					Top:    0.274"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = "Показать депозиты подразделения"
					On SAM_Click
						Call SalSendMsg(tbl, UM_Populate, 0, 1)
			Data Field: dfBranchNew
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.0"
						Top:    0.35"
						Width:  4.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dfBranchNameNew
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.0"
						Top:    0.65"
						Width:  5.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbSearchNew
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSearch
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.567"
					Top:    0.274"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If NOT FunNSIGet('branch', 'name', sBranch, sBranchName)
							Set sBranch = ''
						Else
							Set dfBranchNew     = sBranch
							Set dfBranchNameNew = sBranchName
					On SAM_Create
						Set strTip = "Выбрать подразделение"
			Pushbutton: pbRefreshNew
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   11.067"
					Top:    0.274"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = "Показать депозиты подразделения"
					On SAM_Click
						Call SalSendMsg(tbl, UM_Populate, 0, 2)
			Check Box: cbCloseDupl		! флаг контроля/закрытия дубликатов
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не открывать существующие депозиты
				Window Location and Size
					Left:   6.0"
					Top:    1.0"
					Width:  5.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Background Text: Депозиты подразделения
				Resource Id: 39540
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    1.3"
					Width:  11.3"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgDptBranch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
		Functions
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPa2
		Window Variables
			String: sBranch
			String: sBranchName
			Number: nMaxDig
			String: sBranchPopulate
			!
			Number: nWinX0
			Number: nWinY0
			Number: nWinWidth
			Number: nWinHeigh
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call ShowApdVersion('05')
				Call SetWindowFullSize(hWndForm)
				Set hWndForm.frmChangeTobo.nFlags = GT_NoIns | GT_NoDel
				Set hWndForm.frmChangeTobo.strPrintFileName = 'ReBranch'
				Call SalSendClassMessage(SAM_Create, 0, 0)
				Set cbCloseDupl = FALSE
				Set nMaxDig = DigInit()
				Set nMaxDig = IifN(nMaxDig=-1, 4, nMaxDig)
				Call SalDisableWindow(pbDetails)
				Call SalDisableWindow(pbRefresh)
			On WM_Size
				Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeigh)
				Call SalSetWindowSize(hWndForm.frmChangeTobo.tbl,
						     SalPixelsToFormUnits(hWndForm.frmChangeTobo.tbl, nWinWidth, FALSE),
						     SalPixelsToFormUnits(hWndForm.frmChangeTobo.tbl, nWinHeigh, TRUE)-1.6)
				Call SalInvalidateWindow(hWndForm)
	Form Window: BTI
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Контроль внутрiшн.рахункiв за типами ТВБВ (ЦВ)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.075"
				Top:    0.021"
				Width:  16.967"
				Width Editable? Class Default
				Height: 7.917"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.476"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9621
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  5.383"
						Begin Y:  Class Default
						End X:  5.383"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Фільтр на Верхню таблицю (Бранчі)'
				Pushbutton: pb_Fit_Test
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.283"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FILTER.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Orchid
					Message Actions
						On SAM_Create
							Set strTip = 'Фільтр на Нижню таблицю'
						On SAM_Click
							If SetQueryFilter( cF_TEST )
								Set sF_TEST = cF_TEST.GetFilterWhereClause( FALSE )
							Else
								Set sF_TEST =''
							Call SalSendMsg(BTI.tbl2, UM_Populate, 0, 0)
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Всі рахунки вибраного БРАНЧА (БР)'
						On SAM_Click
							Call ShowAccList ( NUMBER_Null, AVIEW_ALL,  AVIEW_AllOptions, sFiltr_ACC )
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9622
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  7.333"
						Begin Y:  Class Default
						End X:  7.333"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9623
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  8.117"
						Begin Y:  Class Default
						End X:  8.117"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Run_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = '(до)Відкрити ВСІ рахунки та внести їх в параметри БРАНЧА '
						On SAM_Click
							Call F_OPEN(0)
				Pushbutton: pb_Run_Sel
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\SELECT.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = '(до)Відкрити ВИДІЛЕНІ рахунки та внести їх в параметри БРАНЧА '
						On SAM_Click
							Call F_OPEN( 1 )
				Data Field: ISP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.383"
							Top:    0.071"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Виконавець для рах. БРАНЧ ')
						On SAM_Create
							Set ISP = 5
				Data Field: GRP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.183"
							Top:    0.071"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Група дост. для рах. БРАНЧ ')
						On SAM_Create
							Set GRP = 99
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.25"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  15.383"
						Width Editable? Class Default
						Height: 2.25"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Burgundy
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Class Default
				Contents
					Column: BRANCH
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код БРАНЧА
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Left
						Width:  3.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва БРАНЧА
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Left
						Width:  4.183"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: TIP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тип 
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Left
						Width:  0.617"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_TIP()
					Column: RNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Рег.№ 
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Right
						Width:  1.35"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: TIP_NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва Типу
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Left
						Width:  5.083"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_DoubleClick
								Call F_TIP()
				Functions
					Function: F_TIP
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered ("BRANCH_TIP","NAME", " tip is not null " , sTmp, sTmp1)
							If sTmp != STRING_Null
								Set tbl.TIP = sTmp
								Set tbl.TIP_NAME = sTmp1
								Call SalWaitCursor(TRUE)
								Set sBlok = "
										BEGIN
										  UPDATE BRANCH_PARAMETERS SET val='"||tbl.TIP||"' where tag='TIP' and branch='"||tbl.BRANCH||"';
										  IF SQL%rowcount=0 then
										     INSERT INTO BRANCH_PARAMETERS (branch,tag,val) VALUES ('"||tbl.BRANCH||"','TIP','"||tbl.TIP||"');
										  END if;
										 END;"
								If SqlPrepareAndExecute( hSql(),sBlok ) 
										and SqlCommitEx( hSql(), "установка BRANCH="||tbl.BRANCH||" тип="|| tbl.TIP )
								Call SalSendMsg(tbl2, UM_Populate, 0, 0)
							Call SalWaitCursor(FALSE)
				Window Variables
				Message Actions
					On UM_Populate
						If BTI.fFilterAtStart
							Set BTI.fFilterAtStart = NOT BTI.fFilterAtStart
							If NOT SetQueryFilter( cF )
								! Call SalDestroyWindow( hWndForm )
						!
						Set sFilter = ""
						Set sFilter = cF.GetFilterWhereClause( FALSE )
						!
						Call SalWaitCursor(TRUE)
						Set BTI.strSqlPopulate =
								"SELECT BRANCH.branch, BRANCH.name,  BRANCH.DESCRIPTION, q.name, r.rnk 
								 INTO :BTI.tbl.BRANCH,:BTI.tbl.NAME,:BTI.tbl.TIP,:BTI.tbl.TIP_NAME,:BTI.tbl.RNK 
								 FROM BRANCH,  BRANCH_TIP q  ,
								  (select branch,val RNK from BRANCH_PARAMETERS where tag='RNK') r
								 WHERE BRANCH.DESCRIPTION = q.tip (+) 
								   and BRANCH.date_closed is null 
								   and BRANCH.BRANCH = r.BRANCH (+)
								   and BRANCH.BRANCH LIKE SYS_CONTEXT('bars_context','user_branch_mask') 
								    " || IifS(sFilter="", "", " and "||  sFilter ) || " 
								 order by BRANCH.branch  "
						Call SalTblDefineSplitWindow( BTI.tbl, 0, FALSE)
						Call SalTblPopulate( BTI.tbl, hSql(), BTI.strSqlPopulate, TBL_FillAll )
						Set nRow = TBL_MinRow
						If nRow = -1
							Call SalTblSetContext( BTI.tbl, 0 )
						Else
							Call SalTblSetContext ( BTI.tbl, nRow )
							Call SalTblSetRowFlags( BTI.tbl, nRow, ROW_Selected, TRUE )
							Call SalTblSetFocusRow( BTI.tbl, nRow )
						Call SalSendMsg( BTI.tbl, SAM_TblDoDetails, 0, 0 )
						Call SalWaitCursor(FALSE)
					On SAM_TblDoDetails
						Call SalSendMsg( BTI.tbl2, UM_Populate, 0, 0 )
					On SAM_KillFocus
						Set hWndLost = BTI.tbl
						Set sFiltr_ACC =  " a.branch='" || BTI.tbl.BRANCH || "'" 
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   -1.9"
						Top:    2.571"
						Width:  18.083"
						Width Editable? Class Default
						Height: 4.19"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Dark Blue
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Class Default
				Contents
					Column: NBS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: БР
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  0.683"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: OB22
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ОБ_22
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  0.75"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: MASK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реком.маска
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.583"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					!
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Рахунок
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.95"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: KV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.633"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: KOL
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Кіл
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.633"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: RNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Рег №
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: DAOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата відк
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.583"
						Width Editable? Class Default
						Format: Date
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: NMS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва рахунку
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.55"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: NMS2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва пари
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.55"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: DAZS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата закр
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.533"
						Width Editable? Class Default
						Format: Date
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: ACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ACC
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.633"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					String: strSqlPopulate2
					String: strPopulate21
					String: strWhere21
				Message Actions
					On UM_Populate
						If nVxod > 0
							Call SalWaitCursor(TRUE)
							Set sF_TEST = ""
							Set sF_TEST = cF_TEST.GetFilterWhereClause( FALSE )
							Set strSqlPopulate2=
									"SELECT BRANCH_TIP_NLS_V.nbs, 
									        BRANCH_TIP_NLS_V.ob22,
									        BRANCH_TIP_NLS_V.mask, 
									        substr(BRANCH_TIP_NLS_V.txt,1,38)  
									 into :tbl2.NBS,  :tbl2.OB22, :tbl2.MASK , :tbl2.NMS2  
									 from BRANCH_TIP_NLS_V,      ps p 
									 where BRANCH_TIP_NLS_V.tip=:tbl.TIP 
									   and BRANCH_TIP_NLS_V.nbs=p.nbs 
									   and p.d_close is null "
									|| IifS(sF_TEST="", "", " and " || sF_TEST ) ||
									" order by BRANCH_TIP_NLS_V.nbs,
									           BRANCH_TIP_NLS_V.ob22 "
							Call SalTblPopulate( BTI.tbl2, hSql(), strSqlPopulate2, TBL_FillAll)
							Call SalTblDefineSplitWindow( BTI.tbl2, 0, FALSE)
							Call SalWaitCursor(FALSE)
						Set nVxod = 1
					On SAM_KillFocus
						Set hWndLost = BTI.tbl2
						Set sFiltr_ACC = 
								" a.branch='" ||tbl.BRANCH || "' and a.nbs='" || tbl2.NBS || "' #1112111"
					! On SAM_FetchRowDone
						                                     Set strPopulate21 = 
								"select a.acc,a.kv,a.nls,a.nms,a.daos,a.dazs,a.rnk  
								 into :BTI.tbl2.ACC, :BTI.tbl2.KV,  :BTI.tbl2.NLS, :BTI.tbl2.NMS, 
								      :BTI.tbl2.DAOS,:BTI.tbl2.DAZS,:BTI.tbl2.RNK 
								 from accounts a "
						                                     If BTI.tbl2.NBS = '3800'
							                                     Set nKv= 840
						                                     Else 
							                                     Set nKv= n980
						                                     Set strWhere21 = 
								"where a.branch=:BTI.tbl.BRANCH and a.nbs=:BTI.tbl2.NBS and a.kv=:nKv " 
						                                     If BTI.tbl2.OB22 = STRING_Null
							                                     Set strPopulate21 = strPopulate21 || strWhere21
						                                     Else 
							  Set strPopulate21 = strPopulate21 || strWhere21 || 
									" and a.ob22=:BTI.tbl2.OB22"
						                                     If SqlPrepareAndExecute( hSqlAux2(), strPopulate21 ||
								 " order by nvl(a.dazs, :bDat ) desc " ) 
								and SqlFetchNext( hSqlAux2(), nFetchRes )
							                                     If BTI.tbl2.DAZS != DATETIME_Null
								                                     Call XSalTblSetRowBackColor( hWndForm, lParam,  COLOR_Gray )
						                                     Else 
							                                     Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,250 ) )
					On SAM_FetchRowDone
						Set strPopulate21 = 
								"select a.acc,a.kv,a.nls,a.nms,a.daos,a.dazs,a.rnk  
								 into :BTI.tbl2.ACC, :BTI.tbl2.KV,  :BTI.tbl2.NLS, :BTI.tbl2.NMS, 
								      :BTI.tbl2.DAOS,:BTI.tbl2.DAZS,:BTI.tbl2.RNK 
								 from accounts a "
						If BTI.tbl2.NBS = '3800'
							Set nKv= 840
						Else
							Set nKv= n980
						Set strWhere21 = " where a.branch = :BTI.tbl.BRANCH and a.nbs=:BTI.tbl2.NBS and a.kv=:nKv " 
						If BTI.tbl2.OB22 = STRING_Null
							Set strPopulate21 = strPopulate21 || strWhere21
						Else
							Set strPopulate21 = strPopulate21 ||  strWhere21 || "   and a.OB22 = :BTI.tbl2.OB22 "
						If SqlPrepareAndExecute( hSqlAux2(), strPopulate21 || " order by nvl(a.dazs, :bDat ) desc " ) 
								and SqlFetchNext( hSqlAux2(), nFetchRes )
							If BTI.tbl2.DAZS != DATETIME_Null
								Call XSalTblSetRowBackColor( hWndForm, lParam,  COLOR_Gray )
						Else
							Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,250 ) )
						! возможно несколько шт
						If BTI.tbl2.ACC != NUMBER_Null
							If SqlPrepareAndExecute( hSqlAux2(), 
									"select count(*) 
									   into :BTI.tbl2.KOL 
									   from ACCOUNTS a
									  where a.nbs    =:BTI.tbl2.NBS 
									    and a.ob22   =:BTI.tbl2.OB22 
									    and a.branch =:BTI.tbl.BRANCH
									    and a.dazs is Null "  ) 
									And SqlFetchNext( hSqlAux2(), nFetchRes )
					On SAM_DoubleClick
						If BTI.tbl2.ACC != NUMBER_Null
							Call OperWithAccountEx( NUMBER_Null, ACC, RNK, ACCESS_READONLY , hWndMDI, "" )
		Functions
			Function: F_OPEN
				Description:
				Returns
					Boolean:
				Parameters
					Number: nTipStr
				Static Variables
				Local variables
					String: sNls
					String: sNms
					Number: nAcc
					Number: nKv
					String: sRnk
					String: sVopros
				Actions
					If tbl.BRANCH =''
						Call SalMessageBox('НЕ вибрано БРАНЧ !',
								'Помилка ! ', MB_IconStop)
						Return FALSE
					!
					If ISP = NUMBER_Null or GRP = NUMBER_Null 
						Call SalMessageBox('НЕ указано Виконавця/Групу дост рах. БРАНЧ !',
								'Помилка ! ', MB_IconStop)
						Return FALSE
					!
					If tbl.TIP = ''
						Call SalSendMsg( tbl.TIP, SAM_DoubleClick, 0, 0 )
						Return FALSE
					!
					If tbl.RNK ='' and SalStrLength( tbl.BRANCH ) < 15
						Call SalMessageBox('НЕ указано Рег.№ для МФО !',
								'Помилка ! ', MB_IconStop)
						Return FALSE
					!
					If tbl.RNK ='' and SalStrLength( tbl.BRANCH ) >= 15
						Set sVopros = "Авто-рег.кл. для "|| tbl.BRANCH 
						If SalMessageBox( sVopros, 'Внимание !', 
								MB_IconQuestion | MB_YesNo) = IDYES
							If SqlPLSQLCommand( hSql(),
									 "Branch_o ( 1, tbl.BRANCH,  sRnk, ISP, GRP, 
									 STRING_Null, STRING_Null,  STRING_Null, 
									 nKv, sNls, sNms, nAcc)" ) 
									and SqlCommitEx( hSql(), sVopros|| " RNK=" || sRnk )
								Set tbl.RNK = sRnk
								Return TRUE
							Else
								Return FALSE
					!
					Set nRow = TBL_MinRow
					! Все  строчки
					If nTipStr = 0 
						While SalTblFindNextRow( tbl2, nRow, 0, 0)
							Call SalTblSetContext(tbl2, nRow)
							Call Branch_o()
					! только выделенные строчки
					Else
						While SalTblFindNextRow( tbl2, nRow, ROW_Selected, 0)
							Call SalTblSetContext(tbl2, nRow)
							Call Branch_o()
					!
					Call SalWaitCursor(FALSE)
					Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 ) 
			!
			Function: Branch_o
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sNls
					String: sNms
					Number: nAcc
					Number: nKv
					String: sRnk
				Actions
					Call SalWaitCursor(TRUE)
					Call XSalTblSetCellBackColor( tbl2.NBS, SalColorFromRGB( 255,210,250 ) )
					Set sRnk = tbl.RNK
					Set sNms = tbl2.NMS2
					If SqlPLSQLCommand( hSql(),
							 "Branch_o ( 2, tbl.BRANCH,  sRnk, ISP, GRP, 
							 tbl2.NBS, tbl2.OB22,  tbl2.MASK, 
							 nKv, sNls, sNms, nAcc)" ) 
							and SqlCommitEx( hSql(), "Авто-отк."|| sNls || ' для '|| tbl.BRANCH )
						Set tbl2.NLS = sNls
						Set tbl2.NMS = sNms
						Set tbl2.ACC = nAcc
						Set tbl2.KV = nKv
						Call SalWaitCursor(FALSE)
						Return TRUE
					Call SalWaitCursor(FALSE)
					Return FALSE
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Window Handle: hWndLost
			String: sFilter
			Number: nVxod
			Number: n980
			Number: nKv
			Number: nRow
			String: aMfo
			String: sBlok
			String: sTmp
			String: sTmp1
			String: sFiltr_ACC
			Date/Time: bDat
			: cF_TEST
				Class: cGenFilter
			String: sF_TEST
		Message Actions
			On SAM_Create
				Set BTI.strFilterTblName = 'BRANCH'
				Set BTI.fFilterAtStart = 1
				Call cF_TEST.Init('BRANCH_TIP_NLS_V','BRANCH_TIP_NLS_V')
				Set sF_TEST = ""
				Set BTI.n980= GetBaseVal()
				Set BTI.aMfo = GetBankMfo()
				Set BTI.bDat = GetBankDate()
				Call SalTblSetLockedColumns( tbl2, 3 )
				Set nVxod = 0
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Table Window: VVR
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Звiт про операцiї Бранчу-3 за  день
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 500
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.774"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Data Field: BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.783"
							Top:    0.071"
							Width:  4.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_SetFocus
							Set sTmpE = BRANCH
						On SAM_AnyEdit
							Set BRANCH = sTmpE
				Data Field: FDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.883"
							Top:    0.071"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Відкрити вибрану дату'
						! On SAM_Click
							                    Call NASELENIE(  )
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip =  sAvto 
						On SAM_Click
							Call AVTO_OP( sAvto )
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Зберегти дані про "Ручні" операції'
						On SAM_Click
							Call F_SAVE( strTip )
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Data Field: BR_NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.405"
							Width:  11.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.117"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 19147
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.217"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Iсторія вибраного показника'
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 19148
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  7.683"
						Begin Y:  Class Default
						End X:  7.683"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 19149
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbBRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FRCENTER.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати Бранч-3'
							If nLenBr = 22
								Call SalDisableWindow( pbBRANCH )
							Else
								Call SalEnableWindow( pbBRANCH )
						On SAM_Click
							Set sTmpB = STRING_Null
							Call FunNSIGetFiltered
									( "BRANCH" ,"NAME", " length(BRANCH)= 22 ORDER BY BRANCH " , sTmpB ,BR_NAME )
							If sTmpB = aBRANCH
							Else If sTmpB = STRING_Null
								Set BRANCH = aBRANCH
								Set BR_NAME = aBR_NAME
							Else
								Set BRANCH = sTmpB
								Call NASELENIE()
				! Custom Control: cCalendarFrom
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010000
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						DLL Name:
						MS Windows Class Name:
						Style:  0x00000000
						ExStyle:  0x00000000
						Title:
						Window Location and Size
							Left:   Default
							Top:    Default
							Width:  Default
							Width Editable? Yes
							Height: Default
							Height Editable? Yes
						Visible? Yes
						Border? No
						Etched Border? No
						Hollow? No
						Vertical Scroll? No
						Horizontal Scroll? No
						Tab Stop? None
						Tile To Parent? No
						Font Name: Default
						Font Size: 0
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						DLL Settings
.end
					                  Message Actions 
		Contents
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кiлькiсть
						операцiй
						за день
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If ID > 0 and nLenBr = 22
							Set nTmpE = KOL
					On SAM_AnyEdit
						If ID > 0  and nLenBr = 22
							Set KOL = nTmpE 
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
			Column: SEK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						секцiї
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.367"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: GRP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						групи
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.383"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва 
						показника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  8.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOEF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Коефіцієнт
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RKOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Розрахункове
						значення
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ORD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ИД
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_0000
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: NLS_0000
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  8.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: NASELENIE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sSql 
					String: sFilter
				Actions
					If SalStrLength( BRANCH ) != 22
						Call SalMessageBox('Рівень бранчу  НЕ = 3',
								'Увага ! Помилка !', MB_IconStop)
						Return FALSE
					Call SalWaitCursor(TRUE)
					Set NOT_AUTO = FALSE
					Set sFilter = ""
					Set sFilter = cF.GetFilterWhereClause( FALSE )
					Set sSql =
							"SELECT  M.KOL,  BS0.SEK,  BS0.GRP,  decode ( BS0.GRP, 0, upper(BS0.NAME), BS0.NAME),
							        BS0.KOEF,BS0.ORD,  BS0.ID,  M.ACC, m.NLS   
							 into :VVR.KOL, :VVR.SEK, :VVR.GRP, :VVR.NAME, :VVR.KOEF, :VVR.ORD, :VVR.ID, :VVR.ACC,
							      :VVR.NLS_0000 
							 from BS0, 
							     (select A.acc, a.ID, s.kos KOL, a.nls 
							      from (select nls, acc, to_number(substr(nls,10,5)) ID from accounts
							            where branch=:BRANCH and nbs is null and nls like '0000%') a, 
							           (select acc,kos from saldoa where fdat=:FDAT) s 
							      where a.acc=s.acc(+)
							      ) M 
							 Where BS0.nrep=2 and abs(BS0.id) = M.ID (+) " || 
							IifS (sFilter = "","" , " and " || sFilter ) || 
							" order by BS0.SEK,  BS0.GRP "
					! Call Debug (sSql)
					Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll)
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Set aBRANCH = BRANCH
					Set aBR_NAME = BR_NAME
					Set sTitl = 
							' за ' || SalFmtFormatDateTime( FDAT, 'dd.MM.yyyy' ) ||
							' по '|| BRANCH || ' ' || BR_NAME
					Call SalSetWindowText( hWndForm, "Звiт про операцiї " || sTitl )
					Call SalWaitCursor(FALSE)
			Function: AVTO_OP
				Description:
				Returns
				Parameters
					String: strTip1
				Static Variables
				Local variables
					Date/Time: fDat
					String: sBranch
					String: sMess
				Actions
					Call SalWaitCursor(TRUE)
					Set fDat = FDAT
					Set sBranch = BRANCH 
					If SqlPLSQLCommand(hSql(), "ACC_0000 (fDat, sBranch) " )
						Set sMess = strTip1 || sTitl 
						Call SqlCommitEx(hSql(),sMess)
						Call SalWaitCursor(FALSE)
						Call MessageNoWait(sMess,'Повідомлення',3,0)
						Call NASELENIE ()
						Return TRUE
					!
					Return FALSE
			Function: F_SAVE
				Description:
				Returns
				Parameters
					String: strTip1
				Static Variables
				Local variables
					Date/Time: fDat
					String: sBranch
					Number: nRow
					Number: nId
					Number: nKol
					String: sMess
				Actions
					If SalMessageBox( strTip1 ||' ? ', 'У В А Г А !', MB_IconQuestion | MB_YesNo) = IDYES
						Set nRow = TBL_MinRow
						Set fDat = FDAT
						Set sBranch = BRANCH 
						While SalTblFindNextRow(hWndForm, nRow, ROW_Edited , 0)
							Call SalTblSetContext(hWndForm, nRow)
							If ID < 0 or nLenBr < 22
								If KOL = NUMBER_Null
									Set nKol = 0
								Else
									Set nKol = KOL
								Set nId = ID 
								If NOT SqlPLSQLCommand(hSql(), "acc1_0000 ( sBranch, nId, fDat,  nKol ) " )
									Return FALSE
						!
						Set sMess = strTip1 || sTitl
						Call SqlCommitEx(hSql(),sMess)
						Call SalWaitCursor(FALSE)
						Call MessageNoWait(sMess,'Повідомлення',3,0)
						Call NASELENIE ()
					Return TRUE
					!
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sAvto
			Number: nTmpE
			String: sTmpE
			String: sTmpB
			String: aBRANCH
			String: aBR_NAME
			String: sTitl
			Number: nCol [*]
			Number: nCol1
			Number: nLenBr
			Number: n980
			Boolean: NOT_AUTO
		Message Actions
			On SAM_Create
				Set VVR.strFilterTblName = 'BS0'
				Set VVR.strPrintFileName = 'OPERACII'
				Call SalTblSetLockedColumns( hWndForm,1)
				!
				! Set nCol[1]= SalColorFromRGB( 250,180,180 ) ! Каждый
				! Set nCol[2]= SalColorFromRGB( 250,200,010 ) ! Охотник
				! Set nCol[3]= SalColorFromRGB( 255,255,150 ) ! Желает
				! Set nCol[4]= COLOR_LightGreen !!!!!!!!!!!!!!! Знать
				! Set nCol[5]= COLOR_Sky !!!!!!!!!!!!!!!!!!!!!! Где
				! Set nCol[6]= COLOR_LightPeriwinkle !!!!!!!!!! Сидят
				! Set nCol[7]= COLOR_Periwinkle !!!!!!!!!!!!!!! Фазаны 
				!
				! Set nCol[1]= SalColorFromRGB( 220,255,255 ) ! голубой
				! Set nCol[2]= SalColorFromRGB( 255,255,220)  !  желтый
				! Set nCol[3]= SalColorFromRGB( 230,245,240 ) ! бледнофиолет
				! Set nCol[4]= SalColorFromRGB( 230,255,230 ) ! бледнозеленый
				! Set nCol[5]= SalColorFromRGB( 250,250,250 ) ! серый
				! Set nCol[6]= SalColorFromRGB( 255,240,255 )  ! розовый
				!
				Set nCol[1]= SalColorFromRGB( 255,240,255 ) ! Каждый
				Set nCol[2]= SalColorFromRGB( 255,255,150) ! Охотник
				Set nCol[3]= SalColorFromRGB( 255,255,220) ! Желает
				Set nCol[4]= SalColorFromRGB( 230,255,230) ! Знать
				Set nCol[5]= SalColorFromRGB( 220,255,255) ! Где
				Set nCol[6]= SalColorFromRGB( 230,245,240) ! Сидят
				Set nCol[7]= COLOR_LightPeriwinkle !!!!!!!!!!! Фазаны 
				Set sAvto  = 'Наповнити даними з АБС про "автоматичні" операції'
				Set n980 = GetBaseVal()
				!
				If SqlPrepareAndExecute( hSql(),
						"select substr(sys_context('bars_context','user_branch'),1,22) into :aBRANCH from dual ")
						and SqlFetchNext( hSql(), nFetchRes)
					Set nLenBr = SalStrLength( aBRANCH )
					! Call Debug (aBRANCH)
					If nLenBr = 8
						Set aBRANCH = aBRANCH ||'000000/060000/'
					Else If nLenBr = 15
						Set aBRANCH = aBRANCH ||'06'|| SalStrRightX( aBRANCH, 5) 
					Else If nLenBr = 22
					Else
						Call SalDestroyWindow( hWndForm )
					! Call Debug (aBRANCH)
					If SqlPrepareAndExecute( hSql(),
							"select name into :aBR_NAME from branch where branch = :aBRANCH ")
							and SqlFetchNext( hSql(), nFetchRes)
						Set BRANCH = aBRANCH
						Set BR_NAME = aBR_NAME
				Set FDAT = SalDateCurrent(  )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			! On SAM_CreateComplete
				                    Call NASELENIE()
			On UM_Populate
				Call NASELENIE()
				If NOT_AUTO
					If SalMessageBox( sAvto || ' ? ', 'У в а г а !', MB_IconQuestion | MB_YesNo) = IDYES
						Call SalSendMsg( pbIns, SAM_Click, 0, 0 )
			On SAM_FetchRowDone
				Set nCol1 = nCol[ SEK ]
				Call XSalTblSetCellBackColor( SEK, nCol1 )
				Call XSalTblSetCellBackColor( GRP, nCol1 )
				Call XSalTblSetCellBackColor( NAME, nCol1 )
				Call XSalTblSetCellBackColor( KOEF, nCol1 )
				Call XSalTblSetCellBackColor( RKOL, nCol1 )
				If GRP > 0
					Set RKOL = KOL * KOEF
					If ID > 0
						Call XSalTblSetCellBackColor( KOL, COLOR_LightGray )
						If KOL = NUMBER_Null
							Set NOT_AUTO = TRUE
				Else
					Call XSalTblSetCellBackColor( KOL, nCol1 )
			On SAM_DoubleClick
				If GRP >0 
					Call SalCreateWindow 
							(VVV, hWndMDI, VVR.ACC, VVR.SEK, VVR.GRP, VVR.KOEF, VVR.NAME, VVR.BRANCH, VVR.BR_NAME, VVR.FDAT)
	Table Window: VVV
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: iсторiя нарощування показника
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.925"
				Top:    2.406"
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.155"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 5925
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 5926
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 5927
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: Dat1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.071"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Дата "З" ')
				Data Field: Dat2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.583"
							Top:    0.071"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Дата "По" ')
				Data Field: dSEK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.583"
							Top:    0.071"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, '№ секції ')
				Data Field: dGRP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.183"
							Top:    0.071"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, '№ групи ')
				Data Field: dKOEF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.783"
							Top:    0.071"
							Width:  1.3"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Коефіцієнт ')
				Data Field: dNAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.405"
							Width:  8.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Назва показника ')
				Data Field: dBRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.738"
							Width:  4.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Код бранчу ')
				Data Field: dBR_NAM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.783"
							Top:    0.738"
							Width:  4.3"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Назва бранчу ')
		Contents
			Column: DATO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  2.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кiлькiсть 
						Абсолютне значення
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.267"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOLP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кiлькiсть 
						Приведене значення
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.4"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: ACC
			Number: SEK
			Number: GRP 
			Number: KOEF
			String: NAME
			String: BRANCH
			!
			String: BR_NAME
			Date/Time: FDAT
		Window Variables
			String: sSql
			Number: I1
			Number: I2
		Message Actions
			On SAM_Create
				Call SalSetWindowText( VVV, NAME || ' '|| BRANCH )
				!
				Set Dat2 = FDAT
				Set Dat1 = Dat2 - 31
				Set dSEK = SEK
				Set dGRP = GRP
				Set dKOEF = KOEF
				Set dNAME = NAME
				Set dBRANCH = BRANCH
				Set dBR_NAM = BR_NAME
				!
				Set VVV.strPrintFileName = 'IOPERACI'
				Call SalTblSetLockedColumns( hWndForm,1)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set I1 = 0
				Set I2 = 0
				Set sSql = 
						"Select FDAT, kos into :VVV.DATO, :VVV.KOL from saldoa 
						 where acc=:VVV.ACC and fdat >= :VVV.Dat1 and fdat<= :VVV.Dat2 order by fdat desc "
				Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll )
				Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
				! Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
				Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm,TBL_MinSplitRow) )
				Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
				Set KOL = I1
				Set KOLP = I2
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set KOLP = KOL * KOEF
				Set I1 = I1 + KOL
				Set I2 = I2 + KOLP
