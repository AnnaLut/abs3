Application Description: 02-06-2010 Нарахування плати за РКО та постійні доручення
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000001D0100 002C000000020000 0003000000000000 0042020000F8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001D51 3A5C424152533938 5C4C494252415259 5C42415253303135
0020: 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42 4152533031352E61
0040: 706300000101011D 513A5C4241525339 385C4C4942524152 595C424152533031
0060: 352E72756E1D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0080: 646C6C1D513A5C42 41525339385C4C49 42524152595C4241 52533031352E6170
00A0: 6300000101011964 3A5C424152533938 5C42494E5C424152 533030322E617064
00C0: 0E643A5C42415253 39385C42494E5C0E 643A5C4241525339 385C42494E5C0000
00E0: 010101001D513A5C 4241525339385C4C 4942524152595C42 4152533031352E64
0100: 6C6C1D513A5C4241 525339385C4C4942 524152595C424152 533031352E617063
0120: 0000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: Gentbl.apl
		File Include: Genlist.apl
		File Include: GENTBLS.APL
		File Include: GENTBLF.APL
		File Include: vttblwin.apl
		File Include: Docfun6.apl
		File Include: Xsalcpt.apl
		File Include: vtcal.apl
		! File Include: Vtfile.apl
		! File Include: Vtmeter.apl
		! File Include: Vtmsgbox.apl
		! File Include: Vtdos.apl
		Dynalib: Otcn.apd
		Dynalib: Nsiapi.apd
		Dynalib: CustAcnt.apd
		Dynalib: Bars010.apd
		Dynalib: DOCVIEW.APD
		Dynalib: Cc_doc.apd
		Dynalib: ImpExp.apd
		File Include: XSALSPL.APL
		File Include: QCKTABS.APL
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Number: ###0000
			Number: 000000
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				String: ApdNum   =  '02'
				String: ApdVer   =  '08'
				! История изменений: -----------------------------------------------------|
				! 01 13-05-05  MIK     Начало Регулярных платежей                         |
				! 03 27-11-06  MIK     Расширил поло дата начисления                      |
				! 04 31-05-06  MIK     Очищалось поле accd                                |
				! 05 28-01-09  MIK     В РКО nPar 0-всі функції,1-без права коректування сум і дат
				! 06 31-03-09  MIK     В РКО исправил сумировку по 3570 3579
				! 07 07-03-11  MIK     В РКО добавили колл документов
				! 08 19-12-12  MIK     В регулярних обробляємо флаг 56 "Платник-БАНК"
		Resources
		Variables
			Window Handle: h_21
			Window Handle: h_22
			! Window Handle: h_23
			! Window Handle: h_33
			! Window Handle: h_34
			String: gOB22
			!
			Window Handle: h_MA0
			Window Handle: h_MAK 
			Window Handle: h_XM2
			Window Handle: h_MAB
			Boolean: bApdInited
			Number: nHaveTOBO
			Window Handle: hXD0
			Window Handle: hXD1 
			Window Handle: hSEP
			Window Handle: hWin0
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hWin10
			Window Handle: hWin11
			Window Handle: hWin12
			Window Handle: hWin121
			Window Handle: hWin13
			Window Handle: hWin15
			Window Handle: hWin24
			Window Handle: hWin25
			Window Handle: hWin26
			Window Handle: hWin30
			Window Handle: hWin31
			Window Handle: hWin100
			Window Handle: h_DPT
			Window Handle: hGEN
			Number: nFetchRes
			String: aTOBO
			String: sTOBO
			String: sSqlH
		Internal Functions
			Function: Ini002
				Description: инициализация библиотеки
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					String: strFileName
				Actions
					If not bApdInited
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars002.lng"
						If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
							Call CurrentLangTable.Init()
							! ====================================================
							Call CurrentLangTable.AddAtom('cTAt',  'Внимание!')
							Call CurrentLangTable.AddAtom('cTErr', 'Ошибка!')
							Call CurrentLangTable.AddAtom('cTInfo','Информация')
							Call CurrentLangTable.AddAtom('cTQuestion','Вопрос')
							! ====================================================
							! KSTO
							Call CurrentLangTable.AddAtom('KSTO.cTWndTitle','Конструктор схем постійних доручень')
							! pb
							Call CurrentLangTable.AddAtom('KSTO.cBTipGrafic','Переформирование графика')
							! column tbl
							Call CurrentLangTable.AddAtom('KSTO.tbl.RNK','Рег №~поручителя')
							Call CurrentLangTable.AddAtom('KSTO.tbl.NMK','Наименование~поручителя')
							Call CurrentLangTable.AddAtom('KSTO.tbl.colNam','Детали договора')
							Call CurrentLangTable.AddAtom('KSTO.tbl.IDS','Реф~дог')
							Call CurrentLangTable.AddAtom('KSTO.tbl.SDAT','Дата~договора')
							! column tbl2
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colOrd','Порядок~выполнения')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colDat0','Дата~останнього~виконання')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colFreqn','Період')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colFreq','Виконувати')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colDat1','З')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colDat2','По')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.WEND','Ви~хід~ні')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colTT','Код~оп.')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colVob','Вид~Док')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colDk','Д~К')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colKvA','ВАЛ~А')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colNlsA','Рахунок~А')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colMfoB','МФО~Б')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colKvB','ВАЛ~Б')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colNlsB','Рахунок~Б')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colOkpo','ОКПО~Б')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colPolu','Отримувач')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colNazn','Призначення платежу')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colFsum','Формула~суми')
							Call CurrentLangTable.AddAtom('KSTO.tbl2.colIDD','Id')
							! constants
							Call CurrentLangTable.AddAtom('KSTO.cTF4','для вызова справочника')
							! error text
							Call CurrentLangTable.AddAtom('KSTO.cTErrKv','Код валюты')
							Call CurrentLangTable.AddAtom('KSTO.cTErrMfo','Код Банка')
							Call CurrentLangTable.AddAtom('KSTO.cTErrAccNotFound','Отсутствует счет в нашем банке')
							Call CurrentLangTable.AddAtom('KSTO.cTErrKr','Контрольный разряд счета')
							! msg
							Call CurrentLangTable.AddAtom('KSTO.cTMsgGrafic1','Переформировать график для выбранных инструкций?')
							Call CurrentLangTable.AddAtom('KSTO.cTMsgGrafic2','График переформирован!')
							Call CurrentLangTable.AddAtom('KSTO.cTMsgGrafic3','Сформировать график невозможно, договор не подтвержден в бек-офисе')
							! ====================================================
							! ISTO
							Call CurrentLangTable.AddAtom('ISTO.cTWndTitle','Виконання постійних доручень')
							! button strTip
							Call CurrentLangTable.AddAtom('ISTO.cBTipRun','Выполнить проводки')
							! bg
							Call CurrentLangTable.AddAtom('ISTO.bgGroups','Группа:')
							! column
							Call CurrentLangTable.AddAtom('ISTO.colRef','Реф~оп.')
							Call CurrentLangTable.AddAtom('ISTO.colVob','Вид~оп.')
							Call CurrentLangTable.AddAtom('ISTO.colTT','Код~оп.')
							Call CurrentLangTable.AddAtom('ISTO.colNlsA','Счет~А')
							Call CurrentLangTable.AddAtom('ISTO.colKvA','ВАЛ~A')
							Call CurrentLangTable.AddAtom('ISTO.colNlsB','Счет~Б')
							Call CurrentLangTable.AddAtom('ISTO.colKv','ВАЛ~Б')
							Call CurrentLangTable.AddAtom('ISTO.colMfoB','МФО~Б')
							Call CurrentLangTable.AddAtom('ISTO.colDk','Д/К')
							Call CurrentLangTable.AddAtom('ISTO.colfSum','Формула~суммы')
							Call CurrentLangTable.AddAtom('ISTO.colS','Сумма~документа')
							Call CurrentLangTable.AddAtom('ISTO.colPlat','Плательщик')
							Call CurrentLangTable.AddAtom('ISTO.colPolu','Получатель')
							Call CurrentLangTable.AddAtom('ISTO.colNazn','Подробности платежа')
							Call CurrentLangTable.AddAtom('ISTO.colIdd','Внутр.~#схемы')
							Call CurrentLangTable.AddAtom('ISTO.colOkpoA','ОКПО~А')
							Call CurrentLangTable.AddAtom('ISTO.colOkpoB','ОКПО~Б')
							! constants
							Call CurrentLangTable.AddAtom('ISTO.cTInfo1','Виконання постійних доручень група')
							Call CurrentLangTable.AddAtom('ISTO.cTInfo2','проплачено')
							Call CurrentLangTable.AddAtom('ISTO.cTInfo3','документов')
							Call CurrentLangTable.AddAtom('ISTO.cTPrint','Перекриття/розмежування сальдо рахунків')
							Call CurrentLangTable.AddAtom('ISTO.cTOk','Готово.')
							! error text
							Call CurrentLangTable.AddAtom('ISTO.cTErrNazn','Ошибка формирования назначения платежа')
							!
							! dlgCalendar
							Call CurrentLangTable.AddAtom('dlgCalendar.cTWndTitle', 'Календарь выполнения регулярного платежа')
							Call CurrentLangTable.AddAtom('dlgCalendar.pbNew',      'Обновить')
							Call CurrentLangTable.AddAtom('dlgCalendar.pbU',        'Сохранить')
							Call CurrentLangTable.AddAtom('dlgCalendar.MsgDone',    'Выполнено!')
							Call CurrentLangTable.AddAtom('dlgCalendar.MsgInfo',    'Сообщение')
							Call CurrentLangTable.AddAtom('dlgCalendar.AfterWend',  'ПОСЛЕ выходных') 
							Call CurrentLangTable.AddAtom('dlgCalendar.BeforWend',  'ПЕРЕД выходными')
							Call CurrentLangTable.AddAtom('dlgCalendar.Jan',        'январь')
							Call CurrentLangTable.AddAtom('dlgCalendar.Feb',        'февраль')
							Call CurrentLangTable.AddAtom('dlgCalendar.Mar',        'март')
							Call CurrentLangTable.AddAtom('dlgCalendar.Apr',        'апрель')
							Call CurrentLangTable.AddAtom('dlgCalendar.May',        'май')
							Call CurrentLangTable.AddAtom('dlgCalendar.Jun',        'июнь')
							Call CurrentLangTable.AddAtom('dlgCalendar.Jul',        'июль')
							Call CurrentLangTable.AddAtom('dlgCalendar.Aug',        'август')
							Call CurrentLangTable.AddAtom('dlgCalendar.Sep',        'сентябрь')
							Call CurrentLangTable.AddAtom('dlgCalendar.Oct',        'октябрь')
							Call CurrentLangTable.AddAtom('dlgCalendar.Nov',        'ноябрь')
							Call CurrentLangTable.AddAtom('dlgCalendar.Dec',        'декабрь')
							Call CurrentLangTable.AddAtom('dlgCalendar.Mon',        'Пн')
							Call CurrentLangTable.AddAtom('dlgCalendar.Tue',        'Вт')
							Call CurrentLangTable.AddAtom('dlgCalendar.Wed',        'Ср')
							Call CurrentLangTable.AddAtom('dlgCalendar.Thu',        'Чт')
							Call CurrentLangTable.AddAtom('dlgCalendar.Fri',        'Пт')
							Call CurrentLangTable.AddAtom('dlgCalendar.Sat',        'Сб')
							Call CurrentLangTable.AddAtom('dlgCalendar.Sun',        'Вс')
							! ====================================================
						!
						! Call CurrentLangTable.SaveToFile('C:\\TEMP\\tmp.lng','RUS')
						Set bApdInited = TRUE
					Return bApdInited
			! Function: Ins_File
				                                                                                                                            Description: Принять 1 файл  по выбору
				                                                                                                                            Returns 
					                                                                                                                            Boolean: 
				                                                                                                                            Parameters 
					                                                                                                                            String: strTip
					                                                                                                                            Number: nNd
					                                                                                                                            String: sSPECIFIC
					!
				                                                                                                                            Static Variables 
				                                                                                                                            Local variables 
					                                                                                                                            String: sSqlI
					                                                                                                                            String: strFilters[*]
					                                                                                                                            String: strFileName
					                                                                                                                            String: strFilePath
					                                                                                                                            Number: nIndex
					                                                                                                                            Number: nSize
					!
					                                                                                                                            File Handle: inFile
					                                                                                                                            Long String: sTiket
					                                                                                                                            String: sFileM[*]
					                                                                                                                            Number: nNumFiles
					                                                                                                                            Number: nTmp
					! Number: nRet
					                                                                                                                            String: sTxt
				                                                                                                                            Actions 
					                                                                                                                            Set strFilters[0] = strTip
					! Set strFilters[1] = '*.xml'
					                                                                                                                            Set strFilters[1] = '*'||SalStrRightX( SalStrTrimX( sSPECIFIC ) , 5 )
					                                                                                                                            Set nIndex = 1
					! Set nRet = -1
					                                                                                                                            If not SalDlgOpenFile ( hWndForm, 'Вибір електронного документу', strFilters, 2, nIndex, strFileName, sSPECIFIC )
						                                                                                                                            Return FALSE
					! Наташа 
					                                                                                                                            Set sTxt = 'Выполнен импорт+обработка макета файла ' || strFileName
					                                                                                                                            If PutFileToTmpLob( hSql(), strFileName, 'C') 
						                                                                                                                            Call SqlCommit(  hSql() )
						                                                                                                                            If SqlPrepareAndExecute( hSql(), " delete from CCK_AN_TMP  " )
							                                                                                                                            If nAlg = 26 or nAlg = 27 
								                                                                                                                            Set sSqlI = 
										"insert into CCK_AN_TMP (branch,n1) 
										 select BR3_DECODED,  FEE_AMT_A * 100
										 from table(f_get_maket_records) 
										 where BR3_DECODED is not null 
										   and CPS = decode ( :nAlg, 27,'V', 26,'M', '*' )  " 
								                                                                                                                            If SqlPrepareAndExecute( hSql(),  sSqlI )
									                                                                                                                            If SqlCommitEx(  hSql(), sTxt )
										                                                                                                                            Call MessageNoWait( sTxt , 'Информация', 5, 0)
										                                                                                                                            Call F_Rest()
										                                                                                                                            Return TRUE
					! !!!
					                                                                                                                            Call MessageNoWait('HE ' || sTxt, 'Информация', 5, 1)
					                                                                                                                            Return FALSE
			Function: Sel002	! __exported
				Description: Bars002_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
					String: sHelpB
					String: sHelpI
					String: sHelpM
					! Number: nNd
					String: sSPECIFIC
					!
					String: sSqlI
					String: strFilters[*]
					String: strFileName
					String: strFilePath
					Number: nIndex
					Number: nSize
					!
					File Handle: inFile
					Long String: sTiket
					String: sFileM[*]
					Number: nNumFiles
					Number: nTmp
					! Number: nRet
					String: sTxt
				Actions
					Call Ini002()
					Set nHaveTOBO = GetGlobalOptionEx('HAVETOBO')
					Set gOB22     = GetGlobalOption  ('OB22')
					! OPE_LOT:
							
							Отдельная функция
							nMode = 12 LOT->LT1->LT2 = Розрахунки з операторами лотерей: pr1 is NOT null 
							
							Отдельная функция
							nMode = 18 SEP Перерозподiл комiсiї ГОУ за СЕП-платежi : ob22 = SP,  id  =1 
							
							nMode = 19 Макеты разные:
							  nMode = 31 MA0->MAB макеты c ручным делением (% или явно) с поиском счета в доп.таблице MF1:  GRP is NOT Null 
							  nMode = 20 MA0->MAK(для Бранч-2) макеты с подбором счета по БС+об22 :  GRP is Null 
							  nMode = 21 MA0->MAK(для Бранч-3) макеты с подбором счета по БС+об22 :  GRP is Null   ) 
							        c ручным делением (% или явно) alg is null
							        c делением сумм по известным заложенным в программу алгоритмам  ( alg <> 0 ) 
							          Alg = -28 перевод  "Юнистрим "-  макет  -28. Алгоритм : берем проводку В ВАЛ+НАЦ
							          Alg = -9  Комiсiя за переказ по СТП "Швидка копiйка"
							          Alg > 0 - сумми из файла
					If nMode >= 25 
						If nHaveTOBO = 2
							! Set sSqlH = "SYS_CONTEXT('bars_context','user_branch')"
							! If SqlPrepareAndExecute(hSql(),
									 "SELECT Substr(" || sSqlH || " ,1,30) INTO :aTOBO FROM dual")
									and SqlFetchNext(hSql(), nFetchRes)
							! Set sTOBO = " and a.branch like '"||aTOBO||"%' "
							Set sTOBO = " "
						Else
							Set sSqlH = "pul.Get_Mas_Ini_Val('KOD_TOBO')"
							If SqlPrepareAndExecute(hSql(),
									 "SELECT Substr(" || sSqlH || " ,1,30) INTO :aTOBO FROM dual")
									and SqlFetchNext(hSql(), nFetchRes)
							! Call Debug('aTOBO='|| aTOBO )
							Set aTOBO = SalStrTrimX( aTOBO )
							If aTOBO = STRING_Null
								Set aTOBO ='0'
							If nMode = 27 
								Set sTOBO = " and ACCOUNTS.tobo='"|| aTOBO ||"'" 
							Else
								Set sTOBO = IifS( aTOBO ="0" , "", " and ACCOUNTS.tobo='"||aTOBO||"'" )
					Select Case nMode
						!
						Case 35 !! ОБ РУ - XML2 - Розрахунки за послуги ПЦ
							Set strFilters[0] = 'Розрахунки за послуги ПЦ'
							Set strFilters[1] = '*.xml' 
							Set nIndex = 1
							If not SalDlgOpenFile ( hWndForm, 'Вибір електронного документу', strFilters, 2, nIndex, strFileName, sSPECIFIC )
								Return FALSE
							!
							Set sTxt = 
									'Виконано iмпорт файла ' || strFileName || ' 
									з ДоНаповненням довідників'
							If PutFileToTmpLob( hSql(), strFileName, 'C') 
								If SqlPLSQLCommand( hSql(), "xm2.GETX2 (1, 'branch') " ) and 
										   SqlPLSQLCommand( hSql(), "xm2.GETX2 (1, 'docf3c') " )
									Call SqlCommitEx( hSql(),sTxt )
									!
									If SqlPrepareAndExecute( hSql(), 
											"SELECT 'Дозавовнити довiдник БРАНЧІВ' into :sHelpB FROM XML2_BR3 where branch is null " )
											and SqlFetchNext(hSql(), nFetchRes)
									If SqlPrepareAndExecute( hSql(), 
											"SELECT 'Дозавовнити довiдник КОДІВ' into :sHelpI FROM XML2_ID where bm is null ")
											and SqlFetchNext(hSql(), nFetchRes)
									If SqlPrepareAndExecute( hSql(), 
											"SELECT 'Дозавовнити довiдник MFO' into :sHelpM FROM XML2_MFO where nls is null ")
											and SqlFetchNext(hSql(), nFetchRes)
									!
									Call SalWaitCursor(FALSE)
									Call MessageNoWait( sTxt 
											|| " 
											" || sHelpB 
											|| " 
											" || sHelpI
											|| "
											" || sHelpM, 'Добрі новини',10,0)
									Return TRUE
								Else
									Return FALSE
								! Call SqlCommit(  hSql() )
							Else
								Call MessageNoWait('HE ' || sTxt, 'У В А Г А, погані новини ! ', 5, 1)
								Return FALSE
							Break
						Case 36 !! Петрокомерц - импорт XML
							Set strFilters[0] = 'Імпорт XML'
							Set strFilters[1] = '*.xml' 
							Set nIndex = 1
							If not SalDlgOpenFile ( hWndForm, 'Вибір файлу', strFilters, 2, nIndex, strFileName, sSPECIFIC )
								Return FALSE
							!
							Set sTxt = 'Виконано iмпорт файла ' || strFileName
							Call SalWaitCursor(TRUE)
							While TRUE
								If not PutFileToTmpLob( hSql(), strFileName, 'C') 
									Call MessageNoWait('HE ' || sTxt, 'У В А Г А, погані новини ! ', 5, 1)
									Break
								If not SqlPLSQLCommand( hSql(), strPar01 )
									Call SqlRollback(hSql())
									Call MessageNoWait('HE ' || sTxt, 'У В А Г А, погані новини ! ', 5, 1)
									Break
								Call SqlCommitEx( hSql(),sTxt )
								Call MessageNoWait(sTxt, 'Добрі новини', 10, 0)
								Break
							Call SalWaitCursor(FALSE)
							Break
						!
						Case 0 !! Нарахування плати за РКО - Mik
							If not IsWindow(hWin0)
								Set hWin0 = SalCreateWindow( tblRkoLst, hWndParent,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( tblRkoLst )
							Break
						Case 1 !! Конструк рег платежей
							If not IsWindow(hWin1)
								Set hWin1 = SalCreateWindow( KSTO, hWndParent,nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( hWin1 )
							Break
						Case 2 !! Исполнитель рег платежей
							If not IsWindow(hWin2)
								Set hWin2 = SalCreateWindow( ISTO, hWndParent, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( hWin2 )
							Break
						!
						Case 10 !! Управление подотчетниками
							If not IsWindow(hWin10)
								Set hWin10 = SalCreateWindow( U1003, hWndParent,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin10 )
							Break
						Case 11 !! Підкріплення вал поз в РУ ОБ
							If not IsWindow(hWin11)
								Set hWin11 = SalCreateWindow( VP, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin11 )
							Break
						Case 12 !! Розрахунки з операторами лотерей
							If not IsWindow(hWin12)
								Set hWin12= SalCreateWindow( LOT, hWndParent,nMode,nPar, strPar01,strPar02 )
							Break
						Case 13 !! Сховищні операції
							If not IsWindow(hWin13)
								Set hWin13 = SalCreateWindow( SXO, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin13 )
							Break
						Case 14 !! Контрольований Перегляд проводок 
							Call SalCreateWindow( PRV, hWndParent,nMode,nPar, strPar01,strPar02 )
							Break
						Case 15 !! Оприбуткування монет та футлярів згідно накладної
							If not IsWindow(hWin15)
								Set hWin15 = SalCreateWindow( MON, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin15 )
							Break
						Case 16 !! Авто-пополнение вкладов
							If not IsWindow(h_DPT)
								Set h_DPT = SalCreateWindow( DPT, hWndParent, nMode, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( h_DPT )
							Break
						Case 17 !! ХД в РУ Об
							If not IsWindow(hXD0)
								Set hXD0 = SalCreateWindow( XD0, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hXD0 )
							Break
						!
						Case 22 !! Розрахунок просролченого ломбардного кредиту
							If IsWindow( h_22 )
								Call SalDestroyWindow( h_22 )
							Set h_22 = SalCreateWindow( LK2, hWndMDI, nMode, nPar, strPar01, strPar02 )
							Break
						Case 18 !! ОБ РУ - Перерозподiл комiсiї ГОУ за СЕП-платежi
							If not IsWindow(hSEP)
								Set hSEP = SalCreateWindow( SEP, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hSEP )
							Break
						Case 19 !! ОБ РУ - Виконання ВНУТРІШНІ макету проводок по вибору 
							If not IsWindow( h_MA0 )
								Set h_MA0 = SalCreateWindow( MA0, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( h_MA0 )
							Break
						Case 20 !! ОБ РУ - Виконання заданного макету проводок (для Бранч-2)
							If nPar <0 
								If IsWindow( h_MAK )
									Call SalDestroyWindow( h_MAK )
								Set h_MAK = SalCreateWindow( MAK, hWndMDI, nMode, nPar, strPar01, strPar02 )
							Break
						Case 21 !! ОБ РУ - Виконання заданного макету проводок (для Бранч-3)
							If nPar <0 
								If IsWindow( h_MAK )
									Call SalDestroyWindow( h_MAK )
								Set h_MAK = SalCreateWindow( MAK, hWndMDI, nMode, nPar, strPar01, strPar02 )
							Break
						Case 29 !! ОБ РУ - Виконання ВНУТРІШНІ макету проводок  Динамiчний макет
							If not IsWindow( h_MA0 )
								Set h_MA0 = SalCreateWindow( MA0, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( h_MA0 )
							Break
						Case 31 !! ОБ РУ - Виконання заданного макету проводок (для м/б)
							If IsWindow( h_MAB )
								Call SalDestroyWindow( h_MAB )
							Set h_MAB = SalCreateWindow( MAB, hWndMDI, nMode, nPar, strPar01, strPar02 )
							Break
						Case 30 !! ОБ РУ - Виконання оптовой передачи вал.поз(для Бранч-2)
							If IsWindow( h_MAK )
								Call SalDestroyWindow( h_MAK )
							Set h_MAK = SalCreateWindow( MAK, hWndMDI, nMode, nPar, strPar01, strPar02 )
							Break
						!
						! Case 121 !! Заведення нового Ломб.Кредиту
							                                                                                                                                                                                                             If IsWindow( h_21 )
								                                                                                                                                                                                                             Call SalDestroyWindow( h_21 )
							                                                                                                                                                                                                             Set h_21 = SalCreateWindow( LK1, hWndMDI, nMode, nPar, strPar01, strPar02 )
							                                                                                                                                                                                                             Break 
						!
						Case 24 !! Заявка казначейства на ресурсы и его цену по бронированию средств на сч.ХО
							If not IsWindow(hWin24)
								Set hWin24= SalCreateWindow( BRK, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin24 )
							Break
						! Бронирование средств на сч.ХО
						Case 25 !! Управление баз.ставками по бронированию средств на сч.ХО
							If not IsWindow(hWin25)
								Set hWin25 = SalCreateWindow( BR0, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin25 )
							Break
						! Для nMode=26 :Если ТОБО=0 = видят все, иначе только свое ТОБО
						Case 26 !! Бронирование средств на сч.ХО - полный доступ 
							If not IsWindow(hWin26)
								Set hWin26 = SalCreateWindow( BR1, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin26 )
							Break
						! Для nMode=27 :видят только свое ТОБО, даже если ТОБО=0
						Case 27 !! Бронирование средств на сч.ХО - доступ по ТОБО
							If not IsWindow(hWin26)
								Set hWin26 = SalCreateWindow( BR1, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin26 )
							Break
						Case 28 !! Генерация платежей - для ПЕТ
							If IsWindow( hGEN )
								Call SalDestroyWindow( hGEN )
							Set hGEN = SalCreateWindow( GEN, hWndParent,nMode,nPar, strPar01,strPar02 )
							Break
						!
						Case 100 !! Портфель дого оверд в НБУ
							If not IsWindow(hWin100)
								Set hWin100 = SalCreateWindow( OVR, hWndMDI, nMode, nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( OVR )
							Break
						!
					Return TRUE
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbInsert
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	Table Window: tblRkoLst	!! 01
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Нарахування плати за РКО
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.1"
				Top:    1.375"
				Width:  15.233"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description: Нарахування плати за РКО
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32685
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set sFilt = ''
							If SetQueryFilter( cF )
								If cF.GetFilterWhereClause( FALSE )
									Set sFilt = 'AND '|| cF.GetFilterWhereClause( FALSE )
							Call SalSendMsg(hWndForm,UM_Populate,0,0)
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32686
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32687
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: df2dat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 10
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.483"
							Top:    0.131"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Create
							Set df2dat = GetBankDate() - 1
				Background Text: Нарахувати по
					Resource Id: 32688
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.683"
						Top:    0.19"
						Width:  1.733"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Pushbutton: pbAccrue
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.36"
						Top:    0.073"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\CHEKIN.BMP
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Нарахування плати за РКО'
						On SAM_Click
							If SalMessageBox('Нарахувати плату за РКО '||SalFmtFormatDateTime( df2dat, 'dd/MM/yyyy' )||
									IifS(SalStrLength(SalStrTrimX(sFilt)),', використовуючи встановлений фільтр', 'по всіх рахунках')||' ?','РКО',MB_YesNo | MB_IconQuestion )=IDYES
								Call RkoPack(0,'',df2dat,sFiltP||' '||sFilt)
								Call SalSendMsg(hWndForm,UM_Populate,0,0)
				Pushbutton: pbProvodki
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.786"
						Top:    0.073"
						Width:  0.433"
						Width Editable? Yes
						Height: 0.313"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати проводки по РКО'
							Call SalDisableWindow( hWndItem )
						On SAM_Click
							If SalMessageBox('Стягнути плату за РКО '||
									IifS(SalStrLength(SalStrTrimX(sFilt)),', використовуючи встановлений фільтр', 'по всіх рахунках')||' ?','РКО',MB_YesNo | MB_IconQuestion )=IDYES
								Call RkoPack(1,'0123',df2dat,sFiltP||' '||sFilt)
								Call SalSendMsg(hWndForm,UM_Populate,0,0)
				Option Button: obFullShort
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.917"
						Top:    0.095"
						Width:  0.433"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\TUDASUDA.BMP
					Picture Transparent Color: White
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg ( hWndForm, UM_Populate, 0, 0 )
						! On SAM_TooltipSetText
							                                                                                                                                                                                                                                                                                                                                                                                                                  Return XSalTooltipSetText(lParam, IifS(obFullShort, 'Вы', 'В') ||
									       'ключить пересканирование')
						On UM_NoFontChange
							Return TRUE
				Pushbutton: pbMode0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title: 0
					Window Location and Size
						Left:   9.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = '2600->6110'
							If SalStrMidX(sFlags,0,1)='0'
								Call SalDisableWindow( hWndItem )
						On SAM_Click
							If SalMessageBox('Стягнути плату за РКО ?','РКО',MB_YesNo | MB_IconQuestion )=IDYES
								Call RkoPack(1,'0',df2dat,sFiltP||' '||sFilt)
								Call SalSendMsg(hWndForm,UM_Populate,0,0)
				Pushbutton: pbMode1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title: 1
					Window Location and Size
						Left:   9.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = '3570->6110'
							If SalStrMidX(sFlags,1,1)='0'
								Call SalDisableWindow( hWndItem )
						On SAM_Click
							If SalMessageBox('Сформувати борг за РКО ?','РКО',MB_YesNo | MB_IconQuestion )=IDYES
								Call RkoPack(1,'1',df2dat,sFiltP||' '||sFilt)
								Call SalSendMsg(hWndForm,UM_Populate,0,0)
				Pushbutton: pbMode2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title: 2
					Window Location and Size
						Left:   10.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = '2600->3570
									2600->3579'
							If SalStrMidX(sFlags,2,1)='0'
								Call SalDisableWindow( hWndItem )
						On SAM_Click
							If SalMessageBox('Стягнути борг за РКО ?','РКО',MB_YesNo | MB_IconQuestion )=IDYES
								Call RkoPack(1,'2',df2dat,sFiltP||' '||sFilt)
								Call SalSendMsg(hWndForm,UM_Populate,0,0)
				Pushbutton: pbMode3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title: 3
					Window Location and Size
						Left:   10.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = '3570->3579'
							If SalStrMidX(sFlags,3,1)='0'
								Call SalDisableWindow( hWndItem )
						On SAM_Click
							If SalMessageBox('Перенести борг за РКО на прострочку ?','РКО',MB_YesNo | MB_IconQuestion )=IDYES
								Call RkoPack(1,'3',df2dat,sFiltP||' '||sFilt)
								Call SalSendMsg(hWndForm,UM_Populate,0,0)
		Contents
			Column: cNls
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.671"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If cNls and cKv
							Call IfAccExists(cNls,cKv,cAcc)
			Column: cKv
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If cNls and cKv
							Call IfAccExists(cNls,cKv,cAcc)
			Column: cNms
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.314"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cDat0a
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: З
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.017"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cDat0b
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: По
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.017"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cS0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Нараховано
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If not cS0
							Set cS0=0
						Return VALIDATE_Ok
			Column: cKol
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: К-сть
						док.
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cDat1b
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						боргу
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.017"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Борг
						3570
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cDat2b
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						прострочення
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.017"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Прострочений
						борг 3579
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cNlsD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Рахунок
						списання
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.586"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If cNlsD and cKvD
							Call IfAccExists(cNlsD,cKvD,cAccD)
			Column: cKvD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вал
						списання
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If cNlsD and cKvD
							Call IfAccExists(cNlsD,cKvD,cAccD)
			Column: cNMSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование
						счета ДохРас
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.314"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: acc
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cAccD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: acc
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cComm
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Коментар
				Visible? Yes
				Editable? No
				Maximum Data Length: Class Default
				Data Type: String
				Justify: Left
				Width:  2.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cAcc1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cR1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cAcc2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cR2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: SetColorRow
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nInd
				Actions
					Return TRUE
					If cS2 != 0
						Set nInd=COLOR_Red
					Else If cS1 != 0
						Set nInd=COLOR_DarkBlue
					Else
						Set nInd=COLOR_Green
					! Call SalTblSetCellTextColor( cOsts, nInd, FALSE )
					Call SetTblRowColor( hWndForm, nInd )
			Function: RkoPack 			
				Description: Вызов пакеджа РКО
				Returns
					Number:
				Parameters
					Number: nMode      ! 0-начислить, 1-выполнит проводки
					String: sModeList  ! Список флагов для выполнения проводок
							  0 - 2600-6110   1 - 3570-6110   2 - 2600-3570   3 - 3570-3579
							                       
					Date/Time: dDat    ! По
					String: sFilt
				Static Variables
				Local variables
					Number: nInt
					String: sDat1
					String: sDat2
					String: sSql
				Actions
					! Call Debug(sFilt)
					If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
						Call SalWaitCursor(TRUE)
						Set sSql='rko.'||IifS(nMode=0,'acr(sModeList,dDat,sFilt)','pay(sModeList,dDat,sFilt)')
						If SqlPLSQLCommand(hSql(),sSql)
							Call SqlCommitEx(hSql(),  sSql||' - OK' )
							Call SaveInfoToLog( sSql||' - OK' )
							Return TRUE
					! Else
					Call SqlRollback(hSql())
					Return FALSE
			Function: IfAccExists
				Description: Check to see if input account in GL
				Returns
					Boolean:
				Parameters
					String: sNls
					Number: nKv
					Receive Number: nAccN
				Static Variables
				Local variables
				Actions
					Set nAccN=NUMBER_Null
					! если нет этого счета
					If SqlPrepareAndExecute( hSql(),
							  "SELECT acc INTO :nAccN FROM accounts WHERE kv=:nKv AND nls=:sNls" )
							and not SqlFetchNext( hSql(), nFetchRes )
						! согласны на авто-открытие
						! If SalMessageBox('Счет '||sNls||'/'||Str(nKv)||' не открыт.'||PutCrLf()||
								   ' Открыть ?', 'Внимание!', MB_YesNo | MB_IconHand) = IDYES
						Call SalMessageBox('Рахунок '||sNls||'/'||Str(nKv)||' не знайдено ','РКО', MB_IconHand)
						Return FALSE
					Return TRUE
		Window Parameters
			Number: nPar      ! 0 - всі функції, 1 - без права коректування сум і дат
			String: sFlags    ! Флаги
			String: sFiltP    ! Внешний фильтр
		Window Variables
			Number: nS0
			Number: nS1
			Number: nS2
			Number: nRowC
			Number: nTmp
			String: sFilt
			: cF
				Class: cGenFilter
		Message Actions
			On SAM_Create
				Call SetWindowFont( hWndForm )
				Call SetWindowFullSize( hWndForm )
				Call SalSetWindowText( hWndForm, 'Нарахування плати за РКО' )
				Call ShowApdVersion('01')
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				Set tblRkoLst.nTabInstance = 1
				Call cF.Init('ACCOUNTS', 'a')
				Set sFlags=sFlags||'1111111111'
				If nPar=1   ! без права корректировки начисленных сумм и дат
					Call SalDisableWindow ( cNls )
					Call SalDisableWindow ( cKv )
					Call SalDisableWindow ( cDat0a )
					Call SalDisableWindow ( cDat0b )
					Call SalDisableWindow ( cS0 )
					Call SalDisableWindow ( cNlsD )
					Call SalDisableWindow ( cKvD )
					Call SalDisableWindow ( pbIns )
					Call SalDisableWindow ( pbDel )
					Call SalDisableWindow ( pbUpdate )
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On UM_Populate
				Set nRowC=0
				Set nS0=0
				Set nS1=0
				Set nS2=0
				Set strSqlDelete = "DELETE FROM v_rko_lst WHERE acc=:tblRkoLst.cAcc"
				Set strSqlUpdate = "UPDATE v_rko_lst SET dat0a=:tblRkoLst.cDat0a,dat0b=:tblRkoLst.cDat0b,s0=100*:tblRkoLst.cS0,accd=:tblRkoLst.cAccD WHERE acc=:tblRkoLst.cAcc"
				Set strSqlInsert = "INSERT INTO v_rko_lst(acc,accd) VALUES (:tblRkoLst.cAcc,:tblRkoLst.cAccD)"
				Set strSqlPopulate =
						 "SELECT a.acc,a.nls,a.kv,a.nms,r.dat0a,r.dat0b,r.s0/100,r.koldok,dat1b,-a1.ostc/100,dat2b,-a2.ostc/100,NVL(a0.nls,a.nls),NVL(a0.kv,a.kv),r.accd,r.comm,
						         r.acc1, row_number() over (partition by r.acc1 order by r.acc1) r1,
						         r.acc2, row_number() over (partition by r.acc2 order by r.acc2) r2
						    FROM v_rko_lst r,accounts a,accounts a0,accounts a1,accounts a2
						   WHERE r.acc=a.acc AND r.accd=a0.acc(+) AND r.acc1=a1.acc(+) AND r.acc2=a2.acc(+) "||
						   IifS(obFullShort, "AND (r.s0 > 0 OR a1.ostc < 0 OR a2.ostc < 0)","")||sFiltP||" "||sFilt||
						 " ORDER BY SUBSTR(a.nls,1,4)||SUBSTR(a.nls,6),a.kv
						   INTO  :tblRkoLst.cAcc,  :tblRkoLst.cNls, :tblRkoLst.cKv,  :tblRkoLst.cNms,
						         :tblRkoLst.cDat0a,:tblRkoLst.cDat0b,:tblRkoLst.cS0, :tblRkoLst.cKol,
						         :tblRkoLst.cDat1b,:tblRkoLst.cS1,  :tblRkoLst.cDat2b,:tblRkoLst.cS2,
						         :tblRkoLst.cNlsD, :tblRkoLst.cKvD, :tblRkoLst.cAccD, :tblRkoLst.cComm,
						         :tblRkoLst.cAcc1, :tblRkoLst.cR1,  :tblRkoLst.cAcc2, :tblRkoLst.cR2"
				! Call Debug(strSqlPopulate)
				Call SalWaitCursor(TRUE)
				Call SalTblPopulate(hWndForm, cMain.hSql(), T(strSqlPopulate), TBL_FillAll )
				Call SalWaitCursor(FALSE)
				Call SalTblDefineSplitWindow ( tblRkoLst, 1, TRUE )
				Set nTmp=SalTblInsertRow (  tblRkoLst, TBL_MinRow )
				Call SalTblSetContext ( tblRkoLst, nTmp)
				Call SalTblSetRowFlags( tblRkoLst, nTmp, ROW_New, FALSE )
				Set tblRkoLst.cS0 = nS0
				Set tblRkoLst.cS1 = nS1
				Set tblRkoLst.cS2 = nS2
			On SAM_FetchRowDone
				Call SetColorRow()
				Set nS0=nS0 + cS0
				If cAcc1 and cR1=1
					Set nS1=nS1 + cS1
				If cAcc2 and cR2=1
					Set nS2=nS2 + cS2
				Set nRowC=nRowC+1
			On SAM_CreateComplete
				Call SalEnableWindow(pbFilter)
				Call SalSendClassMessage( SAM_CreateComplete, 0, 0 )
	Form Window: KSTO		!! Конструк рег платежей
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Конструктор схем постійних доручень
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Standard
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.038"
				Top:    0.031"
				Width:  12.7"
				Width Editable? Class Default
				Height: 5.583"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Top
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hWndLost, UM_Insert, 0, 0)
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hWndLost, UM_Delete, 0, 0)
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F10
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_Update, 0, 0)
				Line
					Resource Id: 30354
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  2.0"
						Begin Y:  0.0"
						End X:  2.0"
						End Y:  0.5"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30355
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.95"
						Begin Y:  0.0"
						End X:  3.95"
						End Y:  0.5"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.65"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30356
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  4.55"
						Begin Y:  0.0"
						End X:  4.55"
						End Y:  0.5"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Combo Box: cmbGroups
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   5.3"
						Top:    0.131"
						Width:  6.0"
						Width Editable? Class Default
						Height: 2.119"
						Height Editable? Class Default
					Visible? Class Default
					Editable? No
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: System Window Color
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							If cmbGroups.Init(hWndItem)
								Call cmbGroups.Populate(hSql(), "grp_id", "grp_name", "v_stogroups", "order by grp_name")
								If nGrp
									Call cmbGroups.SetSelectById(nGrp)
								Else
									Call SalListSetSelect(hWndItem, 0)
									Call SalSendClassMessage(SAM_Click, 0, 0)
									Set nGrp = cmbGroups.nCurrentId
						On SAM_Click
							Call SalSendClassMessage(SAM_Click, 0, 0)
							Set nGrp = cmbGroups.nCurrentId
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
				Pushbutton: pbGrafic
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.05"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\CHART.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('KSTO.cBTipGrafic')
						On SAM_Click
							If SalTblAnyRows(tbl2, ROW_Selected, 0)
								If tbl2.STATUS_ID = 1
									If SalMessageBox(CurrentLangTable.GetAtomTitle('KSTO.cTMsgGrafic1'), CurrentLangTable.GetAtomTitle('cTQuestion'), MB_IconQuestion | MB_YesNo) = IDYES
									If tbl2.Grafic()
										Call SalMessageBox(CurrentLangTable.GetAtomTitle('KSTO.cTMsgGrafic2'), 
												     CurrentLangTable.GetAtomTitle('cTInfo'), MB_IconAsterisk | MB_Ok)
								Else
									Call SalMessageBox(CurrentLangTable.GetAtomTitle('KSTO.cTMsgGrafic3'), 
											     CurrentLangTable.GetAtomTitle('cTInfo'), MB_IconAsterisk | MB_Ok)
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    -0.762"
						Width:  12.217"
						Width Editable? Class Default
						Height: 3.5"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: System Window Color
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: RNK	! Рег № поручителя
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Рег № 
								поручителя
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 38
						Data Type: Number
						Justify: Left
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								! F4 - для вызова справочника
								Call SalStatusSetText(hWndForm, 'F4 - ' || CurrentLangTable.GetAtomTitle('KSTO.cTF4'))
							On SAM_Validate
								If not SalIsNull(RNK)
									If SqlPrepareAndExecute(hSql(), "select nmk into :NMK from customer where rnk=:RNK")
											and NOT SqlFetchNext(hSql(), nFetchRes)
										Set RNK = NUMBER_Null
										Set NMK = STRING_Null
								Return VALIDATE_Ok
							On VTM_KeyDown
								If wParam = VK_F4
									If FunNSIGetFiltered(sNsiTblName, "nmk", IifS(SalStrUpperX(sNsiTblName)="CUSTOMER", " date_off is null", ""), sRnk, sNmk)
										Set RNK = Val(sRnk)
										Set NMK = sNmk
										Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
									Call SalSetFocus(hWndForm)
									Call SalTblSetFocusRow(hWndForm, nRow)
									Call SalTblSetFocusCell(hWndForm, nRow, RNK, 0, 0)
							On SAM_KillFocus
								Call SalStatusSetText(hWndForm, '')
					Column: NMK	! Наименование поручителя
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование 
								поручителя
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  3.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNam	! Детали договора
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Детали договора
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  4.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SDAT	! Дата договора
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата 
								договора
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.2"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If SDAT = DATETIME_Null
									Set SDAT = GetBankDate()
					Column: IDS	! Реф дог
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Реф
								дог
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nFocusRow
					Number: nCustType
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Set nFocusRow = 0
					On UM_Populate
						Call SalSendClassMessage(UM_Populate, 0, 0)
						Call SalSetFocus(hWndForm)
						Call SalTblSetFocusRow(hWndForm, nFocusRow)
					On SAM_TblDoDetails
						Set nIds = tbl.IDS
						Call SalSendMsg(tbl2, UM_Populate, 0, 0)
					On SAM_DoubleClick
						If RNK
							Call SqlPrepareAndExecute(hSql(), "select custtype into :nCustType from customer where rnk=:RNK")
							Call SqlFetchNext(hSql(), nFetchRes)
							Select Case nCustType
								Case 1
									Call EditCustBanks(RNK, CVIEW_ReadOnly | CVIEW_Accounts |AVIEW_ExistOnly | AVIEW_ReadOnly, hWndForm)
									Break
								Case 2
									Call EditCustCorps(RNK, CVIEW_ReadOnly | CVIEW_Accounts |AVIEW_ExistOnly | AVIEW_ReadOnly, hWndForm)
									Break
								Case 3
									Call EditCustPerson(RNK, CVIEW_ReadOnly | CVIEW_Accounts |AVIEW_ExistOnly | AVIEW_ReadOnly, hWndForm)
									Break
								Default
									Break
					On UM_Insert
						Call SalSendClassMessage(UM_Insert, 0, 0)
						If not tbl.IDS
							Call SqlPrepareAndExecute(hSql(), "SELECT s_cc_deal.NEXTVAL INTO :tbl.IDS FROM dual")
							Call SqlFetchNext(hSql(), nFetchRes)
					On UM_Update
						Set nFocusRow = SalTblQueryContext(hWndForm)
						Call SalSendClassMessage(UM_Update, 0, 0)
					On SAM_KillFocus
						Set hWndLost = hWndForm
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    2.81"
						Width:  12.217"
						Width Editable? Class Default
						Height: 1.571"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: System Window Color
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colOrd		! Порядок выполнения
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Порядок
								выполнения
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFreqn	! Період
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Період
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_FieldEdit
								Set colFreq = colFreqn.GetKey(SalListQuerySelection(colFreqn))
					Column: colFreq		! Виконувати
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Виконувати
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.433"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDat1		! З
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: З
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.2"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If colDat1 = DATETIME_Null
									Set colDat1 = GetBankDate()
					Column: colDat2		! По
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: По
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.2"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
							On SAM_KillFocus
								If colDat1 != DATETIME_Null and colDat1 >= colDat2
									Set colDat2 = DATETIME_Null
					Column: WEND		! Ви~хід~ні
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Ви
								хід
								ні
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 2
						Data Type: Number
						Justify: Center
						Width:  0.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If WEND = NUMBER_Null
									Set WEND = 1
							On SAM_Validate
								If WEND != 1 and WEND !=-1
									Set WEND = 1
								Return VALIDATE_Ok
					Column: colTT		! Код оп.
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								оп.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 3
						Data Type: String
						Justify: Center
						Width:  0.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colVob		! Вид Док
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вид
								Док
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.443"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If colVob = NUMBER_Null
									Set colVob = 1
					Column: colDk		! Д/К
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Д
								К
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 1
						Data Type: Number
						Justify: Center
						Width:  0.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If colDk = NUMBER_Null
									Set colDk = 1
							On SAM_Validate
								If colDk != 1 and colDk != 0
									Set colDk = 1
								Return VALIDATE_Ok
					Column: colKvA		! ВАЛ~А
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ВАЛ
								А
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.6"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If colKvA = NUMBER_Null
									Set colKvA = GetBaseVal()
							On SAM_Validate
								If not F_NLS(colKvA, GetBankMfo(), colNlsA)
									Return VALIDATE_Cancel
								If colKvB = NUMBER_Null
									Set colKvB = colKvA
								Return VALIDATE_Ok
					Column: colNlsA		! Рахунок А
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Рахунок
								А
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 14
						Data Type: String
						Justify: Left
						Width:  1.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If not F_NLS(colKvA, GetBankMfo(), colNlsA)
									Return VALIDATE_Cancel
								Return VALIDATE_Ok
					!
					Column: colMfoB		! МФО Б
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: МФО
								Б
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 9
						Data Type: String
						Justify: Center
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If not F_NLS(colKvB, colMfoB, colNlsB)
									Return VALIDATE_Cancel
								Return VALIDATE_Ok
					Column: colKvB		! ВАЛ Б
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ВАЛ
								Б
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.6"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If colKvB = NUMBER_Null
									Set colKvB = GetBaseVal()
							On SAM_Validate
								If not F_NLS(colKvB, colMfoB, colNlsB)
									Return VALIDATE_Cancel
								If colKvA = NUMBER_Null
									Set colKvA = colKvB
								Return VALIDATE_Ok
					Column: colNlsB		! Рахунок Б
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Рахунок
								Б
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 14
						Data Type: String
						Justify: Left
						Width:  1.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If not F_NLS(colKvB, colMfoB, colNlsB)
									Return VALIDATE_Cancel
								Return VALIDATE_Ok
					Column: colOkpo		! ОКПО Б
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ОКПО
								Б
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colPolu		! Отримувач
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Отримувач
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  2.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNazn		! Призначення платежу
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Призначення платежу
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 160
						Data Type: String
						Justify: Left
						Width:  4.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colFsum		! Формула суми
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Формула
								суми
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDat0		! Дата останнього виконання
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								останнього
								виконання
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.2"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_KillFocus
					Column: IDD		! Id
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Idd
								дет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.657"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Серія
								та номер
								паспорта
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: 9
						Data Type: Class Default
						Justify: Center
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: BRANCH3		! Код Бранч-3 для бюджета 3 рівня
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код Бранчу
								для бюдж
								F4-выбрать
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								! F4 - для вызова справочника
								Call SalStatusSetText(hWndForm, 'F4 - для вызова справочника Бранчей' )
							On SAM_Validate
								If not SalIsNull(BRANCH3)
									If SqlPrepareAndExecute(hSql(), "select name into :NAME3 from tobo where tobo =:BRANCH3 ")
											and NOT SqlFetchNext(hSql(), nFetchRes)
										Set BRANCH3 = STRING_Null
										Set NAME3 = STRING_Null
								Return VALIDATE_Ok
							On VTM_KeyDown
								If wParam = VK_F4
									If FunNSIGetFiltered('TOBO', "NAME", " DATE_CLOSED is null", skBr3, snBr3 )
										Set BRANCH3 = skBr3
										Set NAME3 = snBr3
										Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
									! Call SalSetFocus(hWndForm)
									! Call SalTblSetFocusRow(hWndForm, nRow)
									! Call SalTblSetFocusCell(hWndForm, nRow, RNK, 0, 0)
					Column: NAME3		! Наим Бранч-3 для бюджета 3 рівня
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва Бранчу
								для бюдж
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OPERW
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Открыть
								доп.
								рекв
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.786"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If OPERW = 1 and IDD > 0 
									Set sIdd = Str(IDD )
									If SqlPLSQLCommand(hSql(), "PUL.Set_Mas_Ini( sSto , sIdd, sSto )" ) 
										! Call FunNSIEditFFiltered( sSto, 0, "idd = " || Str(IDD) )
										Call FunNSIEditFFiltered('STO_OPERW^VALUE^OP_TAG_TAB^TAB',0,"idd = " || Str(IDD))
												
												
					Column: USERID_MADE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ПІБ користувача,
								що створив угоду
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.586"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: BRANCH_MADE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Відділення, де
								створена угода
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.471"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: DATETIMESTAMP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата/час
								створення угоди
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  2.214"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: BRANCH_CARD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Відділення, де відкрит
								картковий рахунок
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.157"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: STATUS_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: SID
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  0.543"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: STATUS_NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Статус
								доручення
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.5"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: STATUS_DATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата 
								встановлення 
								статусу
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  2.071"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
					Function: GetFirstEditableColumn
						Description: Получить первую редактируюмую колонку
						Returns
							Window Handle:
						Parameters
							Window Handle: hWndTbl
						Static Variables
						Local variables
							Number: nCol
							Window Handle: hWndCol
						Actions
							Set nCol=1
							Loop
								Set hWndCol = SalTblGetColumnWindow(hWndTbl, nCol, COL_GetPos)
								If hWndCol = hWndNULL
									Break
								If SalTblQueryColumnFlags(hWndCol, COL_Editable) and
										   SalIsWindowVisible(hWndCol)
									Break
								Set nCol = nCol + 1
							Return hWndCol
					Function: F_NLS
						Description:
						Returns
							Boolean:
						Parameters
							Number: nKv
							String: sMfo
							String: sNls
						Static Variables
						Local variables
							String: sTmp
							String: sOkpo
							String: sName
						Actions
							! Валюта
							If nKv != NUMBER_Null and nKv != GetBaseVal() and 
									SqlPrepareAndExecute(hSql(), "SELECT name into :sTmp from tabval where kv=:nKv ")
									and NOT SqlFetchNext(hSql(), nFetchRes)
								! Код вал
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('KSTO.cTErrKv'), 
										     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
								Return FALSE
							! МФО
							If sMfo != STRING_Null and sMfo != GetBankMfo() and 
									SqlPrepareAndExecute(hSql(),"SELECT nb into :sTmp from banks where mfo=:sMfo ")
									and NOT SqlFetchNext(hSql(), nFetchRes)
								! Код Банка
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('KSTO.cTErrMfo'), 
										     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
								Return FALSE
							! Счет
							If sNls != STRING_Null and nKv != NUMBER_Null and sMfo != STRING_Null
								! Наш счет
								If sMfo = GetBankMfo()
									If not bSTOACHK
										If SqlPrepareAndExecute(hSql(),"SELECT nms into :sTmp from accounts where kv=:nKv and nls=:sNls ")
												and NOT SqlFetchNext(hSql(), nFetchRes)
											! Отсутствует счет в нашем банке
											Call SalMessageBox(CurrentLangTable.GetAtomTitle('KSTO.cTErrAccNotFound'), 
													     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
											Return FALSE
								! Счет в др. банке
								Else If sNls != KeyAccount(sMfo, sNls)
									! Контрольный разряд счета
									Call SalMessageBox(CurrentLangTable.GetAtomTitle('KSTO.cTErrKr'), 
											     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
									Return FALSE
								Else
									Call SqlPrepareAndExecute(hSql(), 
											"select okpo, name
											   into :sOkpo, :sName
											   from alien
											  where mfo=:sMfo and nls=:sNls")
									If SqlFetchNext(hSql(), nFetchRes)
										Set colOkpo = sOkpo
										Set colPolu = sName
							!
							Return TRUE
					Function: Grafic
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nRow
							Boolean: bRet
						Actions
							Set bRet = TRUE
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
								Call SalTblSetContext(hWndForm, nRow)
								If not SqlPLSQLCommand(hSql(), " STO_ALL.generate_stoschedules(
										   IDD, colDat0, colDat1, colDat2, colFreq, WEND, STATUS_DATE)")
									Call SqlRollbackEx(hSql(), "KSTO. Неуспешное переформирование графика выполнения рег. платежей для инструкции " || Str(IDD))
									Set bRet = FALSE
									Break
								Else
									Call SqlCommitEx(hSql(), "KSTO. Успешно переформирован график выполнения рег. платежей для инструкции " || Str(IDD))
							Return bRet
				Window Variables
					String: strPopulate	! Строка SQL SELECT                         
					String: strInsert	! Строка SQL INSERT 
					String: strDelete	! Строка SQL DELETE 
					String: strUpdate	! Строка SQL UPDATE 
					String: sTmp
					String: sErrMsg
					String: skBr3
					String: snBr3
					String: sIdd
					String: sSto
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Set sSto = 'STO_OPERW'
						Set strPopulate =
								"SELECT TT, VOB, DK, NLSA, KVA, NLSB, KVB, MFOB, POLU, NAZN, FSUM, OKPO,
								        DAT1, DAT2, FREQ, DAT0, nvl(WEND,1), IDD, ord, DR, BRANCH ,
								 (select name from tobo where tobo = sto_det.branch) ,(select FIO from staff$base where id = USERID_MADE), BRANCH_MADE, to_char(DATETIMESTAMP,'DD.MM.YYYY HH:MI:SS'), BRANCH_CARD, STATUS_ID, 
								to_char(STATUS_DATE,'dd.mm.yyyy'), (select NAME from sto_status where id = STATUS_ID)
								 INTO :colTT, :colVob, :colDk, :colNlsA, :colKvA, :colNlsB, :colKvB, :colMfoB, :colPolu, :colNazn, :colFsum, :colOkpo,
								      :colDat1, :colDat2, :colFreq, :colDat0, :WEND, :IDD, :colOrd, :colDR,
								      :BRANCH3 , :NAME3, :USERID_MADE, :BRANCH_MADE, :DATETIMESTAMP,:BRANCH_CARD,:STATUS_ID,:STATUS_DATE,:STATUS_NAME
								 FROM sto_det
								 WHERE ids = :nIds "
						Set strDelete = "DELETE FROM sto_det WHERE IDD =:IDD"
						Set strInsert =
								"INSERT INTO sto_det
								  ( IDS, ord, tt, vob, dk, nlsa, kva, nlsb, kvb, mfob, polu, nazn, fsum, okpo,
								    DAT1, DAT2, FREQ, DAT0, WEND, DR, branch,USERID_MADE, BRANCH_MADE, DATETIMESTAMP,BRANCH_CARD,STATUS_ID,DISCLAIM_ID )
								 VALUES
								  ( :nIds, :colOrd, :colTT, :colVob, :colDk, :colNlsA, :colKvA, :colNlsB, :colKvB, :colMfoB,
								    :colPolu, :colNazn, :colFsum, :colOkpo,:colDat1, :colDat2, :colFreq, :colDat0, :WEND,
								    :colDR, :BRANCH3,:USERID_MADE, :BRANCH_MADE, :DATETIMESTAMP,:BRANCH_CARD,0,0)"
						Set strUpdate =
								"UPDATE sto_det
								    SET ids = :nIds,    ord = :colOrd, tt  = :colTT,   vob = :colVob,  dk = :colDk, nlsa= :colNlsA, kva = :colKvA,  nlsb= :colNlsB, kvb = :colKvB,  mfob=:colMfoB,
								        polu= :colPolu, nazn= :colNazn, fsum= :colFsum, okpo= :colOkpo, DR = :colDR,
								        DAT1= :colDat1, DAT2= :colDat2, FREQ= :colFreq, DAT0= :colDat0, WEND=:WEND        
								  WHERE IDD = :IDD"
						!
						Call colFreqn.Init(tbl2.colFreqn)
						Call colFreqn.Populate(hSql(), 'freq', 'name', 'freq', 'order by freq')
						! Call colFreqn.Init(tbl2.colFreqn)
						! Call colFreqn.Populate(hSql(), 'freq', 'name', 'freq', 'order by freq')
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), strPopulate, TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_FetchRowDone
						Call colFreqn.SetSelectById(colFreq)
						If tbl2.STATUS_ID = 0
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
						If tbl2.STATUS_ID = 1
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_White )
						If tbl2.STATUS_ID = -1
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Red )
					On SAM_DoubleClick
						If tbl2.IDD != NUMBER_Null and tbl2.STATUS_ID = 1
							Call SalModalDialog(dlgCalendar, hWndForm, tbl.NMK, tbl2.colNlsA,
									     tbl2.IDD, tbl2.colFreq, tbl2.colDat1, tbl2.colDat2, tbl2.WEND, tbl2.colFreqn)
						Else
							If tbl2.STATUS_ID != 1
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('KSTO.cTMsgGrafic3'), 
										     CurrentLangTable.GetAtomTitle('cTInfo'), MB_IconAsterisk | MB_Ok)
					On UM_Insert
						If not SalTblAnyRows(hWndForm, ROW_New, 0)
							Call SalTblDefineSplitWindow(hWndForm, 3, TBL_Split_Adjustable)
						Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
						Call SalTblSetContext(hWndForm, nRow)
						Call SqlPLSQLCommand(hSql(), 
								    " STO_ALL.setdefault_stodetails(nIds, colVob, colDk, colTT, colNlsA, colKvA,
								                           colNlsB, colKvB, colMfoB, colPolu, colNazn,
								                           colFsum, colOkpo, colDat1, colDat2,
								                           colFreq, colDat0, WEND, colOrd)")
						Call SalTblSetFocusCell(hWndForm, nRow, GetFirstEditableColumn(hWndForm), 0, 1)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
								Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
							Else
								Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
					On UM_Update
						Set sErrMsg = ''
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_New | ROW_Edited, 0)
							Call SalTblSetContext(hWndForm, nRow)
							Call SqlPLSQLCommand(hSql(), " STO_ALL.validate_stodetails(
									   nIds, colVob, colDk, colTT, colNlsA, colKvA,
									   colNlsB, colKvB, colMfoB, colPolu, colNazn,
									   colFsum, colOkpo, colDat1, colDat2,
									   colFreq, colDat0, WEND, colOrd, IDD, colDR, sErrMsg )")
							If sErrMsg
								Set bError = TRUE
								Call SalMessageBox(sErrMsg, CurrentLangTable.GetAtomTitle('cTErr'), MB_IconExclamation | MB_Ok)
								Call SalTblSetFocusRow(hWndForm, nRow)
								Call SalTblSetRowFlags(hWndForm, nRow, ROW_Selected, TRUE)
								Break
						If not bError
							Call SalWaitCursor(TRUE)
							! Call SaveInfoToLog(MSG_SaveDataRef() || ' ' || strTitleAux)
							!
							Call SqlPrepare(tbl.cMain.hSql(), strDelete)
							Call SalTblDoDeletes(hWndForm, tbl.cMain.hSql(), ROW_MarkDeleted)
							!
							Call SqlPrepare(tbl.cMain.hSql(), strInsert)
							Call SalTblDoInserts(hWndForm, tbl.cMain.hSql(), TRUE)
							!
							Call SqlPrepare(tbl.cMain.hSql(), strUpdate)
							Call SalTblDoUpdates(hWndForm, tbl.cMain.hSql(), TRUE)
							!
							Call SqlCommit(tbl.cMain.hSql())
							Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
							Call SalWaitCursor(FALSE)
					On SAM_KillFocus
						Set hWndLost = hWndItem
		Functions
		Window Parameters
			Number: pGRP	! NUMBER_Null или 0 - Доступны все группы из справочника sto_GRP
							! >0 - доступна только группа pGRP
			String: sNsiTblName	! имя табл. клиентов
			String: sFilter	! фильтр
		Window Variables
			Boolean: bSTOACHK	! STOACHK- = 1 - не проверять наличие нашего счета у нас
			Number: nGrp
			Window Handle: hWndLost
			Number: nRow
			Number: nIds
			!
			String: sRnk
			String: sNmk
			!
			Boolean: bError
		Message Actions
			On SAM_Create
				! If GetBankMfo()='353575' 
						   AND SalDateCurrent()>=SalDateConstruct( 2006, 5, 15, 0, 0, 0 ) 
					                                                                                                                                                                                                                                                                                                                                                                      Call SalMessageBox("Окончен срок тестового использования модуля 'Регулярные платежи'! Обратитесь к разработчику!" , "В Н И М А Н И Е !", MB_Ok | MB_IconStop)
					                                                                                                                                                                                                                                                                                                                                                                      Call SalDestroyWindow( hWndForm )
				!
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('KSTO.cTWndTitle'))
				Call SalTblSetColumnTitle(hWndForm.KSTO.tbl2.colFreqn, CurrentLangTable.GetAtomTitle('KSTO.tbl2.colFreqn'))
				Call SetWindowFullSize(hWndForm)
				Call ShowApdVersion('05')
				Call PrepareWindowEx(hWndForm)
				Call SalMapEnterToTab(TRUE)
				!
				Set bSTOACHK = GetGlobalOptionEx('STOACHK-') = 1
				If pGRP
					Set nGrp = pGRP
					Call SalDisableWindow(cmbGroups)
				Set sNsiTblName = IifS(SalStrTrimX(sNsiTblName)=STRING_Null, 'customer', SalStrTrimX(sNsiTblName))
				!
				Set hWndForm.KSTO.fFilterAtStart = TRUE
				Set hWndForm.KSTO.strFilterTblName = 'v_stodeals'
				Set hWndForm.KSTO.strPrintFileName = 'stodeal'
				Set hWndForm.KSTO.strSqlPopulate =
						"SELECT deal_id, cust_id, deal_num, deal_dat, cust_name
						   INTO :KSTO.tbl.IDS, :KSTO.tbl.RNK, :KSTO.tbl.colNam, :KSTO.tbl.SDAT, :KSTO.tbl.NMK
						   FROM v_stodeals 
						  WHERE group_id = :KSTO.nGrp " || IifS(SalStrTrimX(sFilter)=STRING_Null, "", " and (" || sFilter || ")") || "
						  ORDER BY deal_id"
				Set hWndForm.KSTO.strSqlInsert =
						"INSERT INTO sto_lst (IDG,IDS,RNK,NAME,SDAT)
						 VALUES ( :KSTO.nGrp, :KSTO.tbl.IDS, :KSTO.tbl.RNK, :KSTO.tbl.colNam, :KSTO.tbl.SDAT)"
				Set hWndForm.KSTO.strSqlUpdate =
						"UPDATE sto_lst 
						    SET name = :KSTO.tbl.colNam,
						        sdat = :KSTO.tbl.SDAT, 
						        rnk  = :KSTO.tbl.RNK 
						  WHERE ids = :KSTO.tbl.IDS"
				Set hWndForm.KSTO.strSqlDelete = "DELETE FROM sto_lst WHERE ids=:KSTO.tbl.IDS"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Update
				Set bError = FALSE
				Call SalSendMsg(hWndLost, UM_Update, 0, 0)
				If not bError
					Call SalSendMsg(tbl, UM_Update, 0, 0)
				If not bError
					Call SalSendMsg(tbl2, UM_Update, 0, 0)
			On UM_Print
				If strPrintFileName
					Call TablePrint(tbl2, Str(tbl.IDS) || ' ' || tbl.colNam || ' ' || tbl.NMK, GetPrnDir() || '\\' || strPrintFileName, '')
			On SAM_Close
				Call SalMapEnterToTab(FALSE)
	Table Window: ISTO
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Виконання постійних доручень
		Icon File:
		Accesories Enabled? Class Default
		Visible? No
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.06"
				Top:    0.567"
				Width:  16.3"
				Width Editable? Class Default
				Height: 5.952"
				Height Editable? Class Default
			Font Name: Default
			Font Size: Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: System Window Color
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? No
		Description: Виконання постійних доручень
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 25423
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 25424
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  11.683"
						Begin Y:  -0.012"
						End X:  11.683"
						End Y:  0.452"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						! On SAM_Click
							                                                                                                                                                                                                                          Set sFilNem = GetFilNem('PRKR'||SalFmtFormatDateTime(GetBankDate(),'ddMM'))
							                                                                                                                                                                                                                          Call TablePrint(ISTO, CurrentLangTable.GetAtomTitle('ISTO.cTPrint'), sFilNem, '')
				Line
					Resource Id: 25425
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 25426
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text: Группа:
					Resource Id: 25427
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.283"
						Top:    0.119"
						Width:  1.35"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Data Field: bgGroups
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cLabelControl
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Default
							Top:    Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Combo Box: cmbGroups
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   6.683"
						Top:    0.095"
						Width:  4.9"
						Width Editable? Class Default
						Height: 5.679"
						Height Editable? Class Default
					Visible? Class Default
					Editable? No
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: System Window Color
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							If cmbGroups.Init(hWndItem)
								Call cmbGroups.Populate(hSql(), "grp_id", "grp_name", "v_stogroups", "order by grp_name")
								If nGrp
									Call cmbGroups.SetSelectById(nGrp)
								Else
									Call SalListSetSelect(hWndItem, 0)
									Call SalSendClassMessage(SAM_Click, 0, 0)
									Set nGrp = cmbGroups.nCurrentId
						On SAM_Click
							Call SalSendClassMessage(SAM_Click, 0, 0)
							Set nGrp = cmbGroups.nCurrentId
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbRun
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.83"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Выполнить проводки
							Set strTip = CurrentLangTable.GetAtomTitle('ISTO.cBTipRun')
						On SAM_Click
							Set nRow = TBL_MinRow
							Set nI = 0
							While SalTblFindNextRow(hWndForm, nRow, 0, 0)
								Call SalTblSetContext(hWndForm, nRow)
								Set dfNrow = nRow
								If colS
									If SqlPrepareAndExecute(hSql(),
											  "SELECT 1 FROM sto_det  WHERE idd = :colIdd AND nvl(dat0, dat1 - 1) < :dDat 
											 FOR UPDATE OF dat0 NOWAIT") 
											and SqlFetchNext(hSql(), nFetchRes)
										Call cDoc.SetDoc(0, colTT, colDk, colVob,'', dDat, dDat, dDat, dDat,
												                 colNlsA, colPlat, GetBankMfo(), '', colKvA, colS, colOkpoA,
												                 colNlsB, colPolu,      colMfoB, '', colKvB, colS, colOkpoB,
												                 colNazn, f_PassP(), GetIdOper(), '', NUMBER_Null, 0)
										If cDoc.oDoc() 
											If SqlPLSQLCommand(hSql(), "STO_ALL.opl1( colIdd, cDoc.m_nRef )" ) 
												Call SqlCommit(hSql())
												Set colRef = cDoc.m_nRef
												Set nI = nI + 1
										Else
											Call SqlRollback(hSql())
							If nI > 0
								! Виконання постійних доручень група ... проплачено .. документов
								Call SaveFInfoToLog(CurrentLangTable.GetAtomTitle('ISTO.cTInfo1') || ' '|| SalNumberToStrX( nGrp, 0) || ' - ' || cmbGroups.GetNameById(nGrp) || ' ' || 
										     CurrentLangTable.GetAtomTitle('ISTO.cTInfo2') || ' ' || SalNumberToStrX( nI, 0) || ' ' || 
										     CurrentLangTable.GetAtomTitle('ISTO.cTInfo3') || ' ' )
								! Готово
								Call MessageInfoEx(CurrentLangTable.GetAtomTitle('ISTO.cTOk'))
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Data Field: dfNrow
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 5
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.971"
							Top:    0.115"
							Width:  0.85"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? No
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold
						Text Color: Default
						Background Color: 3D Face Color
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: colRef
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Реф
						оп.
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colVob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вид
						оп.
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.486"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colTT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						оп.
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Center
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNlsA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Счет
						А
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKvA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ВАЛ
						A
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.6"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNlsB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Счет
						Б
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKvB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ВАЛ
						Б
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.6"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colMfoB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: МФО
						Б
				Visible? Yes
				Editable? No
				Maximum Data Length: 9
				Data Type: String
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Д/К
				Visible? Yes
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Center
				Width:  0.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colfSum
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Формула
						суммы
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.8"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPlat
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Плательщик
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  2.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPolu
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Получатель
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  2.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colNazn
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Подробности платежа
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  4.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colIdd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Внутр.
						#схемы
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOkpoA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ОКПО
						А
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOkpoB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ОКПО
						Б
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colRnk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Rnk
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colDR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Серія
						та номер
						паспорта
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colPaydat
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
			Function: GetFilNem
				Description: Ищет "свободное" имя файла
				Returns
					String:
				Parameters
					String: sFn
				Static Variables
				Local variables
					Number: i
					String: sTmp
					Date/Time: dDatTmp
				Actions
					Set i = 0
					While i <= 999
						Set sTmp = GetPrnDir() || '\\' || sFn || '.' || SalFmtFormatNumber(i, '000')
						If SalFileGetDateTime(sTmp, dDatTmp)
							Set i = i + 1
						Else
							Break
					Return sTmp
			Function: fFormula
				Description:
				Returns
					String:
				Parameters
					String: sInFormula
				Static Variables
				Local variables
					String: sKod
					String: sOutStr
					String: sNbs
					String: sNls
					String: sSum
				Actions
					Set sOutStr = sInFormula
					Set sOutStr = SalStrUpperX(' ' || sOutStr)
					While SalStrScan(sOutStr,'#(NLSB)') > 0
						Set sOutStr = SalStrReplaceX(sOutStr,SalStrScan(sOutStr,'#(NLSB)'),7,"'"||colNlsB||"'")
					While SalStrScan(sOutStr,'#(KVB)') > 0
						Set sOutStr = SalStrReplaceX(sOutStr,SalStrScan(sOutStr,'#(KVA)'),6,Str(colKvB))
					While SalStrScan(sOutStr,'#(NLSA)') > 0
						Set sOutStr = SalStrReplaceX(sOutStr,SalStrScan(sOutStr,'#(NLSA)'),7,"'"||colNlsA||"'")
					While SalStrScan(sOutStr,'#(KVA)') > 0
						Set sOutStr = SalStrReplaceX(sOutStr,SalStrScan(sOutStr,'#(KVA)'),6,Str(colKvA))
					While SalStrScan(sOutStr,'#(MFOB)') > 0
						Set sOutStr = SalStrReplaceX(sOutStr,SalStrScan(sOutStr,'#(MFOB)'),7,"'"||colMfoB||"'")
					While SalStrScan(sOutStr ,'#(TT)') > 0
						Set sOutStr = SalStrReplaceX(sOutStr,SalStrScan(sOutStr,'#(TT)'),5,"'"||colTT||"'")
					If sOutStr
						Call SqlPrepareAndExecute(hSqlAux(), "select " || sOutStr || " into :sOutStr from dual")
						Call SqlFetchNext(hSqlAux(), nFetchRes)
					Return sOutStr
			Function: f_ins_DR_f
				Description: Вствка додаткового параметру [ф] в OPERW
				Returns
					Boolean:
				Parameters
					Number: nREF
				Static Variables
				Local variables
				Actions
					If SalIsNull ( colDR )
						Return TRUE
					Else !!! Якщо поле з паспортними даними не пусте то вставляєм дод.пар.
						If SqlPrepareAndExecute( hSql(), "Insert into OPERW (ref, tag, value) Values ( :nREF, 'ф', :ISTO.colDR ) " )
							Return TRUE
						Else
							Return FALSE
			Function: f_PassP
				Description: !! ф-я повертає паспорт отрмувача якщо код ОКПО = 10 нулів
				Returns
					String:
				Parameters
				Static Variables
				Local variables
				Actions
					If ( (colOkpoB = '0000000000' ) AND NOT ( SalIsNull (colDR) ) )
						Return ( '#ф' || colDR || '#' )
					Else
						Return ''
		Window Parameters
			Number: pGRP
			String: strTabN
			String: strFilter
		Window Variables
			Date/Time: dDat
			Number: n980
			Number: nGrp
			Number: nRow
			: cDoc
				Class: cDoc
			String: ACC
			String: sS
			String: sNlsA
			Number: nKvA
			Number: nColor
			!
			String: sFilNem
			String: sBr3
			Number: nI
			Number: nCustType
			String: sTmp
		Message Actions
			On SAM_Create
				If GetBankMfo()='353575'
						   AND SalDateCurrent()>=SalDateConstruct( 2006, 5, 15, 0, 0, 0 )
					Call SalMessageBox("Окончен срок тестового использования модуля 'Регулярные платежи'! Обратитесь к разработчику!" , "В Н И М А Н И Е !", MB_Ok | MB_IconStop)
					Call SalDestroyWindow( hWndForm )
				!
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('ISTO.cTWndTitle'))
				Call ShowApdVersion('02')
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, FALSE)
				Set dDat = GetBankDate()
				Set n980 = GetBaseVal()
				If pGRP
					Set nGrp = pGRP
					Call SalDisableWindow(cmbGroups)
				!
				Set hWndForm.ISTO.nFlags = GT_NoRet | GT_NoIns
				Set hWndForm.ISTO.fFilterAtStart = TRUE
				Set hWndForm.ISTO.strFilterTblName = 'v_stoschedules'
				Set hWndForm.ISTO.strPrintFileName = 'StOrdrs.' || SalStrRightX('000'||SalNumberToStrX(nGrp,0),3)
				Set hWndForm.ISTO.strSqlPopulate = 
						"select v_stoschedules.recid, v_stoschedules.nlsa, v_stoschedules.kva, v_stoschedules.mfob, 
						        v_stoschedules.nlsb, v_stoschedules.kvb, v_stoschedules.tt, v_stoschedules.vob,
						        v_stoschedules.fsum, 
						        substr(decode(v_stoschedules.mfob, v_stoschedules.mfoa, v_stoschedules.nama, v_stoschedules.cust_name), 1, 38),
						        v_stoschedules.namb, v_stoschedules.nazn, v_stoschedules.cust_code, v_stoschedules.idb, 
						        v_stoschedules.cust_id, v_stoschedules.DR, v_stoschedules.paydat,
						        SUBSTR(tts.flags,57,1)
						     into :hWndForm.ISTO.colIdd,  :hWndForm.ISTO.colNlsA, :hWndForm.ISTO.colKvA, :hWndForm.ISTO.colMfoB,
						          :hWndForm.ISTO.colNlsB, :hWndForm.ISTO.colKvB,  :hWndForm.ISTO.colTT,  :hWndForm.ISTO.colVob,
						          :hWndForm.ISTO.colfSum, :hWndForm.ISTO.colPlat, :hWndForm.ISTO.colPolu,:hWndForm.ISTO.colNazn,
						          :hWndForm.ISTO.colOkpoA,:hWndForm.ISTO.colOkpoB,:hWndForm.ISTO.colRnk, :hWndForm.ISTO.colDR,
						          :hWndForm.ISTO.colPaydat, :hWndForm.ISTO.sTmp
						    from v_stoschedules, tts 
						 where v_stoschedules.group_id  = :hWndForm.ISTO.nGrp and v_stoschedules.tt=tts.tt
						   and v_stoschedules.paydat > (select max(fdat) from fdat where fdat < :hWndForm.ISTO.dDat  )
						   and v_stoschedules.paydat <= :hWndForm.ISTO.dDat 
						   and nvl(v_stoschedules.dat0, v_stoschedules.datbeg - 1) < :hWndForm.ISTO.dDat " ||
						    IifS(SalStrTrimX(strFilter)="", "", " AND (" || strFilter || ")") || "
						 order by v_stoschedules.deal_id, v_stoschedules.ord"
				! Set hWndForm.ISTO.strSqlPopulate = 
						"select recid, nlsa, kva, mfob, nlsb, kvb, tt, vob, fsum,
						        substr(decode(mfob, mfoa, nama, cust_name), 1, 38),
						        namb, nazn, cust_code, idb, cust_id
						   into :hWndForm.ISTO.colIdd,  :hWndForm.ISTO.colNlsA, :hWndForm.ISTO.colKvA, :hWndForm.ISTO.colMfoB,
						        :hWndForm.ISTO.colNlsB, :hWndForm.ISTO.colKvB,  :hWndForm.ISTO.colTT,  :hWndForm.ISTO.colVob,
						        :hWndForm.ISTO.colfSum, :hWndForm.ISTO.colPlat, :hWndForm.ISTO.colPolu,:hWndForm.ISTO.colNazn,
						        :hWndForm.ISTO.colOkpoA,:hWndForm.ISTO.colOkpoB,:hWndForm.ISTO.colRnk
						   from v_stoschedules
						  where group_id  = :hWndForm.ISTO.nGrp 
						    and paydat    = :hWndForm.ISTO.dDat 
						    and nvl(dat0, datbeg - 1) < :hWndForm.ISTO.dDat " || IifS(SalStrTrimX(strFilter)="", "", " AND (" || strFilter || ")") || "
						  order by deal_id, ord"
				Set hWndForm.ISTO.strSqlDelete = "delete from sto_dat where idd = :hWndForm.ISTO.colIdd and dat = :hWndForm.ISTO.colPaydat"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Set dfNrow = 0
				Call SalSendClassMessage(UM_Populate, 0, 0)
			On SAM_FetchRowDone
				Set dfNrow = lParam + 1
				! Сумма
				Set colS   = 0
				If colfSum
					Set colS = Val(fFormula(colfSum))
				Set colDk = IifN(colS>0, 1, 0)
				Set colS  = Abs(colS)
				If sTmp='1'  !-- Встанвелено 56 флаг операції "Платник-Банк"
					Set colPlat=GetBankName()
					Set colOkpoA=GetBankOkpoS()
				! Назначение
				If not cDoc.sTranN(colNazn, colNazn, colTT, colNlsA, GetBankMfo(), colKvA, colS, colNlsB, colMfoB, colKvB, 0, NUMBER_Null, NUMBER_Null,0)
					! Ошибка формирования назначения платежа colNazn
					Call MessageErrorEx(CurrentLangTable.GetAtomTitle('ISTO.cTErrNazn') || ' ' || colNazn)
				! Красим строку
				Set nColor = IifN(colMfoB=GetBankMfo(),
						                 IifN(colKvA=n980 and colKvB=n980,
						                      SalColorFromRGB(230, 255, 230),
						                      SalColorFromRGB(220, 255, 255)),
						                 SalColorFromRGB(255, 240, 255))
				Call XSalTblSetRowBackColor(hWndForm, lParam, nColor)
			On SAM_DoubleClick
				If colRnk
					Call SqlPrepareAndExecute(hSql(), "select custtype into :nCustType from customer where rnk=:colRnk")
					Call SqlFetchNext(hSql(), nFetchRes)
					Select Case nCustType
						Case 1
							Call EditCustBanks(colRnk, CVIEW_ReadOnly | CVIEW_Accounts |AVIEW_ExistOnly | AVIEW_ReadOnly, hWndForm)
							Break
						Case 2
							Call EditCustCorps(colRnk, CVIEW_ReadOnly | CVIEW_Accounts |AVIEW_ExistOnly | AVIEW_ReadOnly, hWndForm)
							Break
						Case 3
							Call EditCustPerson(colRnk, CVIEW_ReadOnly | CVIEW_Accounts |AVIEW_ExistOnly | AVIEW_ReadOnly, hWndForm)
							Break
						Default
							Break
	Form Window: VP		!! Подкрепление вал поз
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Підкріплення Валютних Позицій
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Standard
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.038"
				Top:    0.031"
				Width:  13.45"
				Width Editable? Class Default
				Height: 5.583"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Top
				Visible? Class Default
				Size: 2.44"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Group Box: Торгові рах.
					Resource Id: 34217
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.183"
						Top:    0.155"
						Width:  2.1"
						Width Editable? Yes
						Height: 1.917"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Aqua
					Background Color: Default
				Radio Button: rb_39
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: 390*/33
					Window Location and Size
						Left:   0.383"
						Top:    0.405"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_37
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: 3739/06
					Window Location and Size
						Left:   0.383"
						Top:    0.738"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
				!
				Group Box: Бранч-А
					Resource Id: 40447
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.383"
						Top:    0.155"
						Width:  3.6"
						Width Editable? Yes
						Height: 1.917"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Red
					Background Color: Default
				Pushbutton: pbFilter_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FILTER.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати Бранч-А,
									що віддає Вал.Поз. '
						On SAM_Click
							! Call FunNSIEditF('REP_1003', 2 )
							! Call SalSendMsg( VP.tbl2, UM_Populate, 0, 0 )
							Set sTmp=STRING_Null
							Call FunNSIGetFiltered ("Branch", "NAME",
									" branch in
									 (select aa.branch from accounts aa, vp_list vv where aa.acc=vv.acc3800 and aa.dazs is null )
									order by branch" , sTmp ,sTmp2 )
							If sTmp != STRING_Null
								Set Branch_A = sTmp
								Set Name_A = sTmp2
								Call tbl.Nas1()
				Data Field: Branch_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.983"
							Top:    0.321"
							Width:  2.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: Name_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.483"
							Top:    0.655"
							Width:  3.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: KursAp_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.183"
							Top:    0.988"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Spot-Курс-А')
				Data Field: KursAk_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.483"
							Top:    0.988"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Spot-Курс-А')
				Data Field: Nls_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.483"
							Top:    1.321"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: Ost_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.183"
							Top:    1.321"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: Nms_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.483"
							Top:    1.655"
							Width:  3.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Group Box: Бранч-Б
					Resource Id: 40448
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.083"
						Top:    0.155"
						Width:  3.6"
						Width Editable? Yes
						Height: 1.917"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
				Pushbutton: pbFilter_B
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.183"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FILTER.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Periwinkle
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати Бранч-Б,
									що приймає Вал.Поз. '
						On SAM_Click
							! Call SalSendMsg( VP.tbl, UM_Populate, 0, 0 )
							Set sTmp=STRING_Null
							Call FunNSIGetFiltered ("Branch", "NAME",
									" branch in
									 (select aa.branch from accounts aa, vp_list vv where aa.acc=vv.acc3800 and aa.dazs is null )
									 order by branch" , sTmp ,sTmp2 )
							If sTmp != STRING_Null
								Set Branch_B= sTmp
								Set Name_B = sTmp2
								Call tbl2.Nas2()
				Data Field: Branch_B
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.683"
							Top:    0.321"
							Width:  2.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: Name_B
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.183"
							Top:    0.655"
							Width:  3.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: KursBp_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.883"
							Top:    0.988"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Spot-Курс-Б')
				Data Field: KursBk_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.183"
							Top:    0.988"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Spot-Курс-Б')
				Data Field: Nls_B
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.183"
							Top:    1.321"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: Ost_B
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.883"
							Top:    1.321"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: Nms_B
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.183"
							Top:    1.655"
							Width:  3.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Frame
					Resource Id: 40449
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   9.883"
						Top:    0.238"
						Width:  5.0"
						Width Editable? Yes
						Height: 1.833"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Pushbutton: pb_Val
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.983"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати код валюти'
						On SAM_Click
							! Call FunNSIEditF('REP_1003', 2 )
							! Call SalSendMsg( VP.tbl2, UM_Populate, 0, 0 )
							Set sTmp=STRING_Null
							Call FunNSIGetFiltered ("TABVAL", "NAME"," KV<>"|| Str(n980) || " order by KV DESC" , sTmp ,sTmp2 )
							If sTmp != STRING_Null
								Set Kv = Val(sTmp)
								Set Name_Val = sTmp2
								!
								If SqlPrepareAndExecute( hSql(),
										"select gl.p_icurval(:Kv, 1000000000, :dDat)/1000000000 
										 into :KursO_ from dual " )
										and SqlFetchNext( hSql(), nFetchRes ) 
								Call tbl.Nas1()
								Call tbl2.Nas2()
				Data Field: Kv
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.483"
							Top:    0.321"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: KursO_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.983"
							Top:    0.988"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Курс Офф.')
				Data Field: dS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.983"
							Top:    0.321"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Magenta
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сумма ІНвалюти ')
						On SAM_Validate
							If dS >0 and dS != NUMBER_Null 
								Set Kurs_ = dQ / dS 
				Data Field: Kurs_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   10.483"
							Top:    0.655"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Chartreuse
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Курс передачи Вал.Поз.')
						On SAM_Validate
							If Kurs_ != NUMBER_Null 
								Set dQ = SalNumberRound( dS *100 * Kurs_) / 100
				Data Field: dQ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.983"
							Top:    0.655"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Chartreuse
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сумма НАЦвалюти ')
						On SAM_Validate
							If dS >0 and dS != NUMBER_Null 
								Set Kurs_ = dQ / dS 
				Data Field: Lcv
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.383"
							Top:    0.571"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: Name_Val
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.983"
							Top:    1.655"
							Width:  4.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: nRef1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.983"
							Top:    1.321"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Референс док-1' )
						On SAM_SetFocus
							Set nTmpE = nRef1
						On SAM_AnyEdit
							Set nRef1 = nTmpE
						On VTM_LeftDoubleClick
							If nRef1 >0 
								Call DocViewContentsEx(hWndForm, nRef1 )
				Data Field: nRef2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.983"
							Top:    1.321"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Референс док-2' )
						On SAM_SetFocus
							Set nTmpE = nRef2
						On SAM_AnyEdit
							Set nRef2 = nTmpE
						On VTM_LeftDoubleClick
							If nRef2 >0 
								Call DocViewContentsEx(hWndForm, nRef2 )
				!
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.083"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\ARR1TOR.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Periwinkle
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати операцію підкріплення Вал.поз '
						On SAM_Click
							If Kv != NUMBER_Null 
									and Nls_A != STRING_Null 
									and Nls_B != STRING_Null 
									and Branch_A != STRING_Null 
									and  Branch_B != STRING_Null 
								Set sOk = strTip ||'
										' || Name_Val || '
										 з ' || Branch_A || ' ' ||  Nls_A ||'
										на ' || Branch_B || ' ' || Nls_B 
								If SalMessageBox( sOk ,
										'Увага ! Ви дійсно бажаєте ? ', MB_IconQuestion | MB_YesNo) = IDYES
									Call F_Opl(sOk)
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.983"
						Top:    0.655"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set Ost_A = NUMBER_Null
							Set Ost_B = NUMBER_Null
							Set dS = NUMBER_Null
							Set dQ = NUMBER_Null
							Set Kurs_ = NUMBER_Null
							Set nRef1 = NUMBER_Null
							Set nRef2 = NUMBER_Null
							Set Nls_B = STRING_Null
							Set Nls_A = STRING_Null
							Set Nms_B = STRING_Null
							Set Nms_A = STRING_Null
							Call tbl.Nas1()
							Call tbl2.Nas2()
							Set Nazn1 =  Nazn 
							Call SalEnableWindow( pb_Run )
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.683"
						Top:    1.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.783"
						Top:    1.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.083"
						Top:    0.655"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbIns 
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    1.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: F1
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF1_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
				Pushbutton: pbDel 
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.283"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: F2
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF2_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: F3
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF3_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
				Line
					Resource Id: 30357
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  0.917"
						End X:  Class Default
						End Y:  0.5"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 30358
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  0.833"
						End X:  Class Default
						End Y:  0.417"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 30359
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  0.94"
						End X:  Class Default
						End Y:  0.524"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: Nls_3902
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    1.321"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: Nls_3903
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    1.655"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: Nazn1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 160
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    2.071"
							Width:  14.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.571"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    -0.012"
						Width:  20.95"
						Width Editable? Class Default
						Height: 2.583"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: System Window Color
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: OB22_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код ОБ22
								А
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Right
						Width:  1.029"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Рах.ВП
								А
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  2.057"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMS_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва рах ВП
								А 
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  3.729"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTB_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Плановий зал. ВП
								А
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  2.086"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTC_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Фактичний зал. ВП
								А
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  2.314"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SPM_AK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Спот-Куп.
								 А
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  1.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SPM_AP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Спот-Прод.
								А
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  1.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Фактичний зал. ВП
								А
						Visible? No
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  2.314"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: Nas1
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sSql
						Actions
							If Branch_A != STRING_Null and Kv != NUMBER_Null
								Call SalWaitCursor(TRUE)
								Set sSql =
										"SELECT a.ob22, a.nls, a.nms, a.ostb/100, a.ostc/100, a.acc,p.rate_k, p.rate_p  
										   INTO :OB22_A, :NLS_A, :NMS_A, :OSTB_A, :OSTC_A, :ACC_A, :SPM_AK, :SPM_AP  
										   FROM accounts a, 
										        (select acc, rate_k, rate_p 
										           from spot p1 where p1.vdate=(select max(vdate) from spot where acc=p1.acc) 
										        ) p 
										  WHERE a.kv=:Kv 
										    and a.branch=:Branch_A 
										    and a.acc=p.acc (+)
										    and exists (select 1 from vp_list where acc3800=a.acc)  
										  ORDER BY 1,2 "
								Call SalTblPopulate( VP.tbl, hSql(), sSql, TBL_FillAll )
								Set Nls_A = STRING_Null
								Set Nms_A = STRING_Null
								Call SalWaitCursor(FALSE)
				Window Variables
					! String: strSqlPopulate	! Строка SQL SELECT                         
					! String: strSqlInsert	! Строка SQL INSERT 
					! String: strSqlDelete	! Строка SQL DELETE 
					! String: strSqlUpdate	! Строка SQL UPDATE 
					! String: strTitleAux	
				Message Actions
					On SAM_DoubleClick
						Set Nls_A = NLS_A
						Set Nms_A = NMS_A
						Set Ost_A = OSTB_A
						Set KursAk_ = SPM_AK
						Set KursAp_ = SPM_AP
						Call F_Nazn()
					On SAM_KillFocus
						Set hWndLost=hWndForm
					On SAM_FetchRowDone
						If OSTB_A >0 
							Call XSalTblSetRowBackColor( hWndForm, lParam, nCol2 )
							Set SPM_AP = NUMBER_Null
						Else If OSTB_A < 0 
							Call XSalTblSetRowBackColor( hWndForm, lParam, nCol1 )
							Set SPM_AK = NUMBER_Null
						Else
							Set SPM_AP = NUMBER_Null
							Set SPM_AK = NUMBER_Null
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   8.0"
						Top:    -0.024"
						Width:  16.683"
						Width Editable? Class Default
						Height: 5.095"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: System Window Color
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: OB22_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код ОБ22
								Б
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Right
						Width:  1.029"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Рах.ВП
								Б
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  2.057"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMS_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва рах ВП
								Б 
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  3.729"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTB_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Плановий зал. ВП
								Б
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  2.086"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTC_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Фактичний зал. ВП
								Б
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  2.314"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SPM_BK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Спот-Куп.
								 Б
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  1.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SPM_BP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Спот-Прод.
								Б
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  1.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Фактичний зал. ВП
								А
						Visible? No
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  2.314"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: Nas2
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sSql
						Actions
							If Branch_B != STRING_Null and Kv != NUMBER_Null
								Call SalWaitCursor(TRUE)
								Set sSql =
										"SELECT a.ob22, a.nls, a.nms, a.ostb/100, a.ostc/100, a.acc,p.rate_k, p.rate_p  
										   INTO :OB22_B, :NLS_B, :NMS_B, :OSTB_B, :OSTC_B, :ACC_B, :SPM_BK, :SPM_BP 
										   FROM accounts a, 
										        (select acc, rate_k, rate_p 
										           from spot p1 where p1.vdate=(select max(vdate) from spot where acc=p1.acc) 
										        ) p
										  WHERE a.kv=:Kv 
										    and a.branch=:Branch_B 
										    and a.acc= p.acc(+) 
										    and exists (select 1 from vp_list where acc3800=a.acc)  
										  ORDER BY 1,2 "
								Call SalTblPopulate( VP.tbl2, hSql(), sSql, TBL_FillAll )
								!
								Set Nls_B = STRING_Null
								Set Nms_B = STRING_Null
								Call SalWaitCursor(FALSE)
				Window Variables
					String: strSqlPopulate	! Строка SQL SELECT                         
					String: strSqlInsert	! Строка SQL INSERT 
					String: strSqlDelete	! Строка SQL DELETE 
					String: strSqlUpdate	! Строка SQL UPDATE 
					String: strTitleAux	
					String: sTmp
				Message Actions
					On SAM_DoubleClick
						Set Nls_B = NLS_B
						Set Nms_B = NMS_B
						Set Ost_B = OSTB_B
						Set KursBk_ = SPM_BK
						Set KursBp_ = SPM_BP
						Call F_Nazn()
					On SAM_KillFocus
						Set hWndLost=hWndForm
					On SAM_FetchRowDone
						If OSTB_B >0 
							Call XSalTblSetRowBackColor( hWndForm, lParam, nCol2 )
							Set SPM_BP = NUMBER_Null
						Else If OSTB_B < 0 
							Call XSalTblSetRowBackColor( hWndForm, lParam, nCol1 )
							Set SPM_BK = NUMBER_Null
						Else
							Set SPM_BP = NUMBER_Null
							Set SPM_BK = NUMBER_Null
		Functions
			Function: F_Opl
				Description:
				Returns
				Parameters
					String: pOk
				Static Variables
				Local variables
					! String: Nls_3902
					! String: Nls_3903
					String: Nms_3902
					String: Nms_3903
					Number: nS
					Number: nQ
					String: T_Nbs1
					String: T_Nbs2
					String: T_Ob22
					String: sErr
					String: sBranch
					Number: nR1
					Number: nR2
					Number: nCol
				Actions
					If dS <=0 Or dQ <= 0
						Call SalMessageBox('Не Введено суми вал/грн ',
								'Помилка !', MB_IconStop)
						Return FALSE
					Set sBranch = '/' || aMFO ||'/000000/%'
					If rb_39
						Set T_Nbs1 = '3902'
						Set T_Nbs2 = '3903'
						Set T_Ob22 = '33'
						Set sErr = '3902/33,3903/33'
						! Set nCol = COLOR_DarkGreen
						! Call SalColorSet( pb_3, COLOR_IndexWindow, SalColorFromRGB( 255,220,220) )
					Else If rb_37
						Set T_Nbs1 = '3739'
						Set T_Nbs2 = '3739'
						Set T_Ob22 = '06'
						Set sErr = '3739/06'
						! Set nCol = COLOR_DarkGreen
					If strPar01 = STRING_Null
						If SqlPrepareAndExecute( hSql(),
								"select a.nls, Substr(a.nms,1,38),   b.nls, Substr(b.nms,1,38) 
								into :Nls_3902, :Nms_3902, :Nls_3903, :Nms_3903 
								from accounts a,   accounts b 
								where a.kv = :Kv   and a.nbs = :T_Nbs1 and a.ob22=:T_Ob22  
								  and b.kv = :n980 and b.nbs = :T_Nbs2 and b.ob22=:T_Ob22  
								  and a.branch like :sBranch and a.branch = b.branch 
								  and a.dazs is null and b.dazs is null 
								 ORDER by a.branch " )
								and NOT SqlFetchNext( hSql(), nFetchRes ) 
							Call SalMessageBox('Не відкрито рахунки '||sErr || ' 
									для бранчу ' || sBranch , 
									'Помилка !', MB_IconStop)
							Return FALSE
					Else
						If SqlPrepareAndExecute( hSql(),
								"select a.nls, Substr(a.nms,1,38),b.nls, Substr(b.nms,1,38) 
								 into :Nls_3902, :Nms_3902, :Nls_3903, :Nms_3903 
								 from accounts a,  accounts b 
								 where a.kv = :Kv  and a.nls = :strPar01 and b.kv = :n980 and b.nls = :strPar01  
								  and a.dazs is null and b.dazs is null " )
								and NOT SqlFetchNext( hSql(), nFetchRes ) 
							Call SalMessageBox('Не відкрито рахунки '|| strPar01  , 'Помилка !', MB_IconStop)
							Return FALSE
					! --3902/33 --3903/33
					Set nS = dS *100
					Set nQ = dQ *100
					! Set Nazn1 =  Nazn || Branch_A || "/" || tbl.OB22_A || " -> " || Branch_B || "/" || tbl2.OB22_B
					If SqlPLSQLCommand(hSql(), "PUL.Set_Mas_Ini( 'VP', Nls_A, 'Вал.Поз.' )")
						Call cDoc.SetDoc( 0, '38V', 0, 16, STRING_Null,
								     dDat, dDat, dDat, dDat,
								     Nls_3902, Nms_3902, aMFO,'', Kv, nS, aOKPO,
								     Nls_3903, Nms_3903, aMFO,'', n980, nQ, aOKPO,
								     Nazn1, '', GetIdOper(), '', NUMBER_Null, 0 )
						If NOT cDoc.oDoc()
							Return FALSE
						Set nR1 = cDoc.m_nRef
						If SqlPLSQLCommand(hSql(), "PUL.Set_Mas_Ini( 'VP', Nls_B, 'Вал.Поз.' )")
							Call cDoc.SetDoc( 0, '38V', 1, 16, STRING_Null,
									     dDat, dDat, dDat, dDat,
									     Nls_3902, Nms_3902, aMFO,'', Kv, nS, aOKPO,
									     Nls_3903, Nms_3903, aMFO,'', n980, nQ, aOKPO,
									     Nazn1, '', GetIdOper(), '', NUMBER_Null, 0 )
							If NOT cDoc.oDoc()
								Return FALSE
							Set nR2 = cDoc.m_nRef
					If SqlCommitEx( hSql(), pOk )
						Call SalDisableWindow( pb_Run )
						Set nRef1 = nR1
						Set nRef2 = nR2
						Return TRUE
					Return FALSE
			Function: F_Nazn
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					! String: Nls_3902
					! String: Nls_3903
					String: Nms_3902
					String: Nms_3903
					! String: Nazn1
					Number: nS
					Number: nQ
					String: T_Nbs1
					String: T_Nbs2
					String: T_Ob22
					String: sErr
					String: sBranch
					Number: nR1
					Number: nR2
					Number: nCol
				Actions
					Set Nazn1 =  
							Subs( Nazn || Subs(Branch_A,9,6) || "*" || tbl.OB22_A || " -> " || Subs(Branch_B,9,6) || "*" || tbl2.OB22_B, 1, 160)
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01 
			String: strPar02  
		Window Variables
			Number: nCol1
			Number: nCol2
			Number: n980
			Number: nRow
			String: aMFO
			String: aOKPO
			Date/Time: dDat
			!
			Window Handle: hWndLost
			Number: nTmpE
			String: sTmp
			String: sTmp2
			String: Nazn
			!
			Number: nZ
			Number: nRef
			: cDoc
				Class: cDoc
			!
			String: sOk
			! Number: dVOBn
			! Number: dVOBv
			!
			! String: KKK
			! Number: kVOBn
			! Number: kVOBv
			!
			! String: BBB
			! Number: bVOB
			!
			! String: SSS
			! Number: sVOB
			!
		Message Actions
			On SAM_Create
				Set n980 = GetBaseVal()
				Set dDat = GetBankDate()
				Set aMFO = GetBankMfo()
				Set aOKPO= GetBankOkpoS()
				Set nCol1 = SalColorFromRGB( 255,210,210 ) ! СЛАБО-КРАСНЫЙ
				Set nCol2 = SalColorFromRGB( 220,255,255 ) ! голубой
				Set rb_37 = TRUE
				Set rb_39 = FALSE
				! Call SalDisableWindow( rb_39 )
				!
				Call SalMapEnterToTab( TRUE )
				Call PrepareWindowEx( hWndForm )
				Call SetWindowFullSize( hWndForm )
				Call ShowApdVersion('06')
				Set Nazn =  'Пiдкрiплення Вал.Поз.' 
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			! On UM_Update
				                                                                                                                                                                                                                                                                  Call SalSendMsg( hWndLost, UM_Update, 0, 0 )
				                                                                                                                                                                                                                                                                  Call SalSendMsg( tbl,      UM_Update, 0, 0 )
				                                                                                                                                                                                                                                                                  Call SalSendMsg( tbl2,     UM_Update, 0, 0 )
			! On SAM_Close
				                                                                                                                                                                                                                                                                  Call SalMapEnterToTab( FALSE )
	Form Window: U1003		!! Управление подотчетниками
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Управление подотчетниками (1003)
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Standard
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.038"
				Top:    0.031"
				Width:  12.733"
				Width Editable? Class Default
				Height: 5.583"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Top
				Visible? Class Default
				Size: 0.655"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pb_Get
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить импорт файла REP_1003 '
						On SAM_Click
							Call Imp_Dbf_New(hWndForm,1, 0, 'REP_1003', '' )
							! ! Window Handle: hW ! хандлер вызывающего окна
							! ! Number: nPar1 ! Особенности обработки табл в БД
							! ! Number: nPar2 ! Резерв
							! ! String: sPar1 ! Маска файлов
							! ! String: sPar2 ! Резерв
							Call SalSendMsg( U1003.tbl, UM_Populate, 0, 0 )
				Pushbutton: pb_View
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\VIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить просмотр-корректировку файла REP_1003 '
						On SAM_Click
							Call FunNSIEditF('REP_1003', 2 )
							Call SalSendMsg( U1003.tbl2, UM_Populate, 0, 0 )
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\EXECUTE.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить ВСЕ операции файла REP_1003 '
						On SAM_Click
							Call SalWaitCursor( TRUE )
							Set nZ = TBL_MinRow
							While SalTblFindNextRow(tbl, nZ, 0, 0)
								Call SalTblFetchRow(tbl, nZ )
								If tbl.FA =1
									Call F_DEB()
									Call F_OBM()
									Call F_KRD()
							Call SalSendMsg( U1003.tbl, UM_Populate, 0, 0 )
							Call SalWaitCursor( FALSE )
				Pushbutton: pbIns ! по ПОДКРЕПЛЕНИЮ
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F1
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF1_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить операции по ПОДКРЕПЛЕНИЮ '
						On SAM_Click
							Call F_DEB()
				Pushbutton: pbDel ! по ПОКУПКЕ-ПРОДАЖЕ
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F2
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF2_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить операции по ПОКУПКЕ-ПРОДАЖЕ'
						On SAM_Click
							Call F_OBM()
				Pushbutton: pbUpdate ! по ИЗЪЯТИЮ
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F3
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF3_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить операции по ИЗЪЯТИЮ'
						On SAM_Click
							Call F_KRD()
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40443
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  0.917"
						End X:  Class Default
						End Y:  0.5"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40444
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  0.833"
						End X:  Class Default
						End Y:  0.417"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40445
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  0.94"
						End X:  Class Default
						End Y:  0.524"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: NMS_1001
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.883"
							Top:    0.155"
							Width:  2.733"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: NLS_1001
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.383"
							Top:    0.155"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				! Data Field: NMS_1007
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.583"
							Top:    0.071"
							Width:  2.733"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					                                                                                                                                                                                                                                                                                                                                                                             Message Actions 
				! Data Field: NLS_1007
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.083"
							Top:    0.071"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					                                                                                                                                                                                                                                                                                                                                                                             Message Actions 
				Frame
					Resource Id: 40446
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.283"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    2.571"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  12.217"
						Width Editable? Class Default
						Height: 2.321"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: System Window Color
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: FA
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Файл
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  0.557"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: №
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  0.457"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  1.329"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: П/О 
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  2.429"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: FIO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ФИО 
								подотч.лица
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  2.2"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PASP 
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вид 
								документа
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  1.229"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PASPN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № 
								документа
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  1.3"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ATRT 
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Атрибуты 
								документа
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  1.357"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DT_R
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата 
								рожд
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.057"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ADRES 
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Адрес
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  1.671"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					! String: strSqlPopulate	! Строка SQL SELECT                         
					! String: strSqlInsert	! Строка SQL INSERT 
					! String: strSqlDelete	! Строка SQL DELETE 
					! String: strSqlUpdate	! Строка SQL UPDATE 
					! String: strTitleAux	
				Message Actions
					On SAM_Create
						! Set U1003.strSqlDelete='DELETE FROM sto_lst WHERE ids=:U1003.tbl.IDS '
						! Set U1003.strSqlInsert=
								'INSERT INTO sto_lst (IDG,IDS,RNK,NAME,SDAT)
								 VALUES ( :U1003.nGrp, :U1003.tbl.IDS, :U1003.tbl.RNK, :U1003.tbl.colNam, :U1003.tbl.SDAT)'
						! Set U1003.strSqlUpdate=
								'UPDATE sto_lst 
								 SET name=:U1003.tbl.colNam,SDAT=:U1003.tbl.SDAT, rnk=:U1003.tbl.RNK 
								 WHERE ids=:U1003.tbl.IDS '
						Call SalSendClassMessage(SAM_Create, 0, 0)
					On SAM_CreateComplete
						Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set U1003.strSqlPopulate=
								"SELECT p.ID, p.NLS, p.FIO, p.PASP, p.PASPN, p.ATRT, p.DT_R, p.ADRES,a.nms
								 INTO :U1003.tbl.ID,  :U1003.tbl.NLS,  :U1003.tbl.FIO,
								      :U1003.tbl.PASP,:U1003.tbl.PASPN,:U1003.tbl.ATRT, 
								      :U1003.tbl.DT_R,:U1003.tbl.ADRES,:U1003.tbl.NMS
								 FROM PODOTK p, accounts a 
								 WHERE a.nls like '1003%' and p.nls=a.nls and a.kv=:n980 
								 ORDER BY p.ID "
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblSetLockedColumns( U1003.tbl, 5 )
						Call SalTblPopulate( U1003.tbl, hSql(), U1003.strSqlPopulate, TBL_FillAll )
						Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
						Call SalWaitCursor(FALSE)
					On SAM_TblDoDetails
						! Set nSch=tbl.ID
						Call SalSendMsg( U1003.tbl2, UM_Populate, 0, 0 )
					On SAM_KillFocus
						Set hWndLost=hWndForm
					On SAM_SetFocus
						Call SalDisableWindow( pbIns )
						Call SalDisableWindow( pbDel )
						Call SalDisableWindow( pbUpdate )
						Call SalDisableWindow( pbDetails )
					On SAM_FetchRowDone
						If SqlPrepareAndExecute( hSqlAux2(), "select 1 into :tbl.FA from rep_1003 where op_num=:tbl.ID" ) 
								and not SqlFetchNext( hSqlAux2(), nFetchRes )
							Set tbl.FA =0
					! On UM_Update
						                                                                                                                                                                                                                                                                                                                                                                                 Call SalSendClassMessage( UM_Update, 0, 0 )
					! On UM_Insert
						                                                                                                                                                                                                                                                                                                                                                                                 Call SalSendClassMessage( UM_Insert, 0, 0 )
						                                                                                                                                                                                                                                                                                                                                                                                 If not tbl.IDS
							                                                                                                                                                                                                                                                                                                                                                                                 Call SqlPrepareAndExecute( hSql(),"SELECT s_sto_ids.NEXTVAL INTO :tbl.IDS FROM dual")
							                                                                                                                                                                                                                                                                                                                                                                                 Call SqlFetchNext( hSql(),nFetchRes)
						                                                                                                                                                                                                                                                                                                                                                                                 Set nSch=tbl.IDS
					!
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    2.976"
						Width:  12.217"
						Width Editable? Class Default
						Height: 1.571"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: System Window Color
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: NAMEV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование 
								валюты
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  1.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: LCV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ISO
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  0.543"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код 
								ВАЛ
						Visible? Yes
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.514"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAPP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								движ.
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.1"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_KillFocus
					Column: OSTC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Факт
								остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.943"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: План
								остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.143"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: DEB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Подкрепить
								F1
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KUP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Купить
								F2
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.314"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KUP_EQV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Затраты
								на пок.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.129"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KUP_KURS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								покупки
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.929"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Продать
								F2
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.243"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRD_EQV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Выручка 
								от прод
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.3"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PRD_KURS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Курс
								продажи
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.929"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KRD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Изъять
								F3
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.057"
						Width Editable? Yes
						Format: ###000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					!
					Column: ACC
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC
						Visible? No
						Editable? No
						Maximum Data Length: 3
						Data Type: Number
						Justify: Center
						Width:  0.514"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: GetFirstEditableColumn
						Description: Получить первую редактируюмую колонку
						Returns
							Window Handle:
						Parameters
							Window Handle: hWndTbl
						Static Variables
						Local variables
							Number: nCol
							Window Handle: hWndCol
						Actions
							Set nCol=1
							Loop
								Set hWndCol = SalTblGetColumnWindow(hWndTbl, nCol,
										    COL_GetPos)
								If hWndCol = hWndNULL
									Break
								If SalTblQueryColumnFlags(hWndCol, COL_Editable) and
										   SalIsWindowVisible(hWndCol)
									Break
								Set nCol = nCol + 1
							Return hWndCol
					Function: F_NLS
						Description:
						Returns
						Parameters
							Number: nKv
							String: sMfo
							String: sNls
						Static Variables
						Local variables
							String: sTmp
						Actions
							If nKv != GetBaseVal() and 
									SqlPrepareAndExecute( hSql(),"SELECT name into :sTmp from tabval where kv=:nKv " )
									and NOT SqlFetchNext(  hSql(), nFetchRes )
								Call SalMessageBox("Код вал","Ошибка ! ", MB_IconStop)
								Return FALSE
							!
							If sMfo != STRING_Null and sMfo != GetBankMfo() and 
									SqlPrepareAndExecute( hSql(),"SELECT nb into :sTmp from banks where mfo=:sMfo " )
									and NOT SqlFetchNext(  hSql(), nFetchRes )
								Call SalMessageBox("Код Банка","Ошибка ! ", MB_IconStop)
								Return FALSE
							!
							If sNls != STRING_Null and  nKv != NUMBER_Null and sMfo !=STRING_Null
								If sMfo = GetBankMfo() and 
										SqlPrepareAndExecute( hSql(),"SELECT nms into :sTmp from accounts where kv=:nKv and nls=:sNls " )
										and NOT SqlFetchNext(  hSql(), nFetchRes )
									Call SalMessageBox("Отсутствует счет в нашем банке","Ошибка ! ", MB_IconStop)
									Return FALSE
								Else If sNls != KeyAccount(sMfo, sNls)
									Call SalMessageBox("Контрольный разряд счета","Ошибка ! ", MB_IconStop)
									Return FALSE
							!
							Return TRUE
				Window Variables
					String: strSqlPopulate	! Строка SQL SELECT                         
					String: strSqlInsert	! Строка SQL INSERT 
					String: strSqlDelete	! Строка SQL DELETE 
					String: strSqlUpdate	! Строка SQL UPDATE 
					String: strTitleAux	
					String: sTmp
				Message Actions
					On SAM_Create
						! Set strSqlDelete='DELETE FROM sto_det WHERE IDD =:IDD '
						! Set strSqlInsert='
								 INSERT INTO sto_det
								 (ids,tt,vob,dk,nlsa,kva,nlsb,kvb,mfob,polu,nazn,fsum,okpo, DAT1,DAT2,FREQ, DAT0, WEND)
								  VALUES (:nSch,:colTT,:colVob, :colDk,:colNlsA,:colKvA,:colNlsB,:colKvB,:colMfoB,
								          :colPolu,:colNazn, :colFsum, :colOkpo,:colDat1, :colDat2, :colFreq, 
								          :colDat0,:WEND )'
						! Set strSqlUpdate='
								 UPDATE sto_det 
								 SET ids=:nSch, tt=:colTT,vob=:colVob,dk=:colDk,
								    nlsa=:colNlsA,kva=:colKvA,nlsb=:colNlsB,kvb=:colKvB,mfob=:colMfoB,
								    polu=:colPolu,nazn=:colNazn,fsum=:colFsum,okpo=:colOkpo,
								    DAT1=:colDat1,DAT2=:colDat2,FREQ=:colFreq,DAT0=:colDat0, WEND=:WEND
								  WHERE IDD=:IDD '
						! Set strSqlPopulate=
								"SELECT TT,VOB,DK,NLSA,KVA,NLSB,KVB,MFOB,POLU,NAZN,FSUM,OKPO,
								   DAT1,DAT2,FREQ, DAT0, nvl(WEND,1), IDD
								 INTO :colTT,:colVob, :colDk,:colNlsA,:colKvA,:colNlsB,:colKvB,:colMfoB,
								      :colPolu,:colNazn, :colFsum,:colOkpo,:colDat1, :colDat2, :colFreq, 
								      :colDat0,:WEND, :IDD
								 FROM sto_det WHERE ids=:nSch " 
						!
					On SAM_CreateComplete
						Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set strSqlPopulate=
								"SELECT a.KV, a.DAPP, -a.OSTC/100, -a.OSTB/100, t.lcv, t.name, a.acc 
								 INTO :U1003.tbl2.KV, :U1003.tbl2.DAPP, :U1003.tbl2.OSTC, :U1003.tbl2.OSTB,
								      :U1003.tbl2.LCV,:U1003.tbl2.NAMEV,:U1003.tbl2.ACC 
								 FROM accounts a, tabval t 
								 WHERE a.nls=:U1003.tbl.NLS and a.kv=t.kv 
								 ORDER BY a.kv " 
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), strSqlPopulate,TBL_FillAll)
						Call SalTblSetLockedColumns( U1003.tbl2, 6 )
						Call SalWaitCursor(FALSE)
					On SAM_SetFocus
						Call SalEnableWindow( pbIns )
						Call SalEnableWindow( pbDel )
						Call SalEnableWindow( pbUpdate )
						Call SalEnableWindow( pbDetails )
					On SAM_KillFocus
						Set hWndLost=hWndItem
					On SAM_FetchRowDone
						If OSTC != OSTB
							Call XSalTblSetCellBackColor( OSTB, SalColorFromRGB( 230,255,230 ) )
						If tbl.FA
							If SqlPrepareAndExecute( hSqlAux2(), 
									"select s_out, s_buy, s_sale, s_back, 
									    s_buy_eqv, s_sale_eqv, kurs_buy, kurs_sale
									 into :tbl2.DEB, :tbl2.KUP, :tbl2.PRD, :tbl2.KRD, 
									   :tbl2.KUP_EQV,:tbl2.PRD_EQV, :tbl2.KUP_KURS, :tbl2.PRD_KURS 
									 from rep_1003 where op_num=:tbl.ID and kv=:tbl2.KV" ) 
									and not SqlFetchNext( hSqlAux2(), nFetchRes )
						Call XSalTblSetCellBackColor( DEB, nCol1) 
						Call XSalTblSetCellBackColor( KRD, nCol3 )
						Call XSalTblSetCellBackColor( KUP, nCol2 )
						Call XSalTblSetCellBackColor( KUP_EQV, nCol2 )
						Call XSalTblSetCellBackColor( KUP_KURS,nCol2 )
						Call XSalTblSetCellBackColor( PRD, nCol2 )
						Call XSalTblSetCellBackColor( PRD_EQV, nCol2 )
						Call XSalTblSetCellBackColor( PRD_KURS, nCol2 )
					On SAM_DoubleClick
						Call Show_Sal_Day_P (U1003.tbl2.ACC , U1003.tbl.NLS, U1003.tbl2.KV, dDat-10, dDat)
		Functions
			Function: F_DEB
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(tbl2, nRow, 0, 0)
						Call SalTblFetchRow(tbl2, nRow )
						If tbl2.DEB > 0
							Set nRef = NUMBER_Null
							If tbl.FA=1 and 
									SqlPrepareAndExecute(hSql(),
									"update rep_1003 set s_out=0 where op_num =:tbl.ID and kv=:tbl2.KV" ) 
							Call cDoc.SetDoc
									( nRef, DDD, 1, IifN(tbl2.KV=n980,dVOBn,dVOBv),'', dDat, SalDateCurrent(), dDat, dDat,
									  tbl.NLS, tbl.NMS, aMFO,'', tbl2.KV, tbl2.DEB*100, aOKPO,
									  NLS_1001, NMS_1001, aMFO,'', tbl2.KV, tbl2.DEB*100, aOKPO,
									     "Видача підзвіт "||tbl2.LCV||' '||tbl.FIO, STRING_Null, GetIdOper(),'',66,0 )
							If cDoc.oDoc()
									and SqlPrepareAndExecute(hSql(),
									"insert into operw(ref,tag,value) select :cDoc.m_nRef, tag, val 
									 from PODOTC where val is not null 
									  and id = :tbl.ID and tag in ('FIO','ATRT','PASP','PASPN','DT_R')" ) 
									and SqlCommit(hSql())
								Set tbl2.DEB = 0 
							Else
								Call SqlRollback(hSql())
					Call SalSendMsg( U1003.tbl2, UM_Populate, 0, 0 )
					Call SalWaitCursor( FALSE )
			Function: F_KRD
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(tbl2, nRow, 0, 0)
						Call SalTblFetchRow(tbl2, nRow )
						If tbl2.KRD > 0
							Set nRef = NUMBER_Null
							If tbl.FA=1 and 
									SqlPrepareAndExecute(hSql(),
									"update rep_1003 set s_back=0 where op_num =:tbl.ID and kv=:tbl2.KV" ) 
							Call cDoc.SetDoc
									( nRef, KKK, 0, IifN(tbl2.KV=n980,kVOBn,kVOBv),'', dDat, SalDateCurrent(), dDat, dDat,
									  tbl.NLS, tbl.NMS, aMFO,'', tbl2.KV, tbl2.KRD*100, aOKPO,
									  NLS_1001, NMS_1001, aMFO,'', tbl2.KV, tbl2.KRD*100, aOKPO,
									     "Повернення підзвіту "||tbl2.LCV||' '||tbl.FIO, STRING_Null, GetIdOper(),'',39,0 )
							! If FALSE
								! Number: nRef     !! референс (NUMBER_Null для новых)
								! String: sTT      !! Код операции
								! Number: nDk      !! ДК (0-дебет, 1-кредит)
								! Number: nVob     !! Вид обработки
								! String: sNd      !! № док 
								! Date/Time: dDoc  !! Дата док
								! Date/Time: dPos  !! Дата ввода(поступления в банк)
								! Date/Time: dVal1  !! Дата валютирования основной операции
								! Date/Time: dVal2  !! Дата валютирования связаной операции
								! String: sNls1     !! Счет-А
								! String: sNam1     !! Наим-А
								! String: sBank1    !! МФО-А
								! String: sNb1      !! Наим банка-А(м.б. '')
								! Number: nKv1      !! Код вал-А 
								! Number: nS1       !! Сумма-А
								! String: sOkpo1    !! ОКПО-А 
								! String: sNls2     !! Счет-Б     
								! String: sNam2     !! Наим-Б
								! String: sBank2    !! МФО-Б
								! String: sNb2      !! Наим банка-Б(м.б. '')
								! Number: nKv2      !! Код вал-Б 
								! Number: nS2       !! Сумма-Б
								! String: sOkpo2    !! ОКПО-Б
								! String: sNazn     !! Назначение пл
								! String: sDrec     !! Доп реквизиты
								! String: sOperId   !! Идентификатор ключа опрециониста
								! Long String: lsSign !! ЭЦП опрециониста
								! Number: nSk       !! СКП
								! Number: nPrty     !! Приоритет документа
							If cDoc.oDoc()
									and SqlPrepareAndExecute(hSql(),
									"insert into operw(ref,tag,value) select :cDoc.m_nRef, tag, val 
									 from PODOTC where val is not null 
									  and id = :tbl.ID and tag in ('FIO','ATRT','PASP','PASPN','DT_R')" ) 
									and SqlCommit(hSql())
								Set tbl2.KRD = 0 
							Else
								Call SqlRollback(hSql())
					Call SalSendMsg( U1003.tbl2, UM_Populate, 0, 0 )
					Call SalWaitCursor( FALSE )
			Function: F_OBM
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(tbl2, nRow, 0, 0)
						Call SalTblFetchRow(tbl2, nRow )
						If tbl2.KUP > 0 and tbl2.KUP_EQV 
							Set nRef = NUMBER_Null
							If tbl.FA=1 and 
									SqlPrepareAndExecute(hSql(),
									"update rep_1003 set s_buy=0,s_buy_eqv=0 where op_num =:tbl.ID and kv=:tbl2.KV" ) 
							Call cDoc.SetDoc
									( nRef, BBB, 1, bVOB,'', dDat, SalDateCurrent(), dDat, dDat,
									  tbl.NLS, tbl.NMS, aMFO,'',tbl2.KV,tbl2.KUP*100, aOKPO,
									  tbl.NLS, tbl.NMS, aMFO,'', n980,  tbl2.KUP_EQV*100, aOKPO,
									     "Купіпля валюти через обм.пункт "||tbl2.LCV||' '||tbl.FIO, 
									STRING_Null, GetIdOper(),'',56,0 )
							If cDoc.oDoc()
									and SqlPrepareAndExecute(hSql(),
									"insert into operw(ref,tag,value) values (:cDoc.m_nRef, 'KURS',:tbl2.KUP_KURS)" ) 
									and SqlCommit(hSql())
								Set tbl2.KUP = 0 
								Set tbl2.KUP_EQV = 0 
							Else
								Call SqlRollback(hSql())
						If tbl2.PRD > 0 and tbl2.PRD_EQV 
							Set nRef = NUMBER_Null
							If tbl.FA=1 and 
									SqlPrepareAndExecute(hSql(),
									"update rep_1003 set s_sale=0,s_sale_eqv=0 where op_num =:tbl.ID and kv=:tbl2.KV" ) 
							Call cDoc.SetDoc
									( nRef, SSS, 0, sVOB,'', dDat, SalDateCurrent(), dDat, dDat,
									  tbl.NLS, tbl.NMS, aMFO,'',tbl2.KV,tbl2.PRD*100, aOKPO,
									  tbl.NLS, tbl.NMS, aMFO,'', n980,  tbl2.PRD_EQV*100, aOKPO,
									     "Продаж валюти через обм.пункт "||tbl2.LCV||' '||tbl.FIO, 
									STRING_Null, GetIdOper(),'',30,0 )
							! If FALSE
								! Number: nRef     !! референс (NUMBER_Null для новых)
								! String: sTT      !! Код операции
								! Number: nDk      !! ДК (0-дебет, 1-кредит)
								! Number: nVob     !! Вид обработки
								! String: sNd      !! № док 
								! Date/Time: dDoc  !! Дата док
								! Date/Time: dPos  !! Дата ввода(поступления в банк)
								! Date/Time: dVal1  !! Дата валютирования основной операции
								! Date/Time: dVal2  !! Дата валютирования связаной операции
								! String: sNls1     !! Счет-А
								! String: sNam1     !! Наим-А
								! String: sBank1    !! МФО-А
								! String: sNb1      !! Наим банка-А(м.б. '')
								! Number: nKv1      !! Код вал-А 
								! Number: nS1       !! Сумма-А
								! String: sOkpo1    !! ОКПО-А 
								! String: sNls2     !! Счет-Б     
								! String: sNam2     !! Наим-Б
								! String: sBank2    !! МФО-Б
								! String: sNb2      !! Наим банка-Б(м.б. '')
								! Number: nKv2      !! Код вал-Б 
								! Number: nS2       !! Сумма-Б
								! String: sOkpo2    !! ОКПО-Б
								! String: sNazn     !! Назначение пл
								! String: sDrec     !! Доп реквизиты
								! String: sOperId   !! Идентификатор ключа опрециониста
								! Long String: lsSign !! ЭЦП опрециониста
								! Number: nSk       !! СКП
								! Number: nPrty     !! Приоритет документа
							If cDoc.oDoc()
									and SqlPrepareAndExecute(hSql(),
									"insert into operw(ref,tag,value) values (:cDoc.m_nRef, 'KURS',:tbl2.PRD_KURS)" ) 
									and SqlCommit(hSql())
								Set tbl2.KUP = 0 
								Set tbl2.KUP_EQV = 0 
							Else
								Call SqlRollback(hSql())
					Call SalSendMsg( U1003.tbl2, UM_Populate, 0, 0 )
					Call SalWaitCursor( FALSE )
		Window Parameters
			Number: nPar   
			String: s1001 !! Сч.кассы
			String: strPar02  !! DDDaaabbbKKKcccdddBBBeeeSSSfff
			! 
					DDD - код TT по ПОДКРЕП, aaa - его Vob по грн(3 зн в ведущим 0), bbb - его Vob по вал
					KKK - код TT по ИЗЪЯТИЮ, ccc - его Vob по грн, ddd - его Vob по вал
					BBB - код TT по ПОКУПКЕ, eee - его Vob
					SSS - код TT по ПРОДАЖЕ, fff - его Vob
		Window Variables
			Number: nCol1
			Number: nCol2
			Number: nCol3
			Number: n980
			Number: nRow
			String: aMFO
			String: aOKPO
			Date/Time: dDat
			!
			Window Handle: hWndLost
			Number: nTmp
			String: sTmp
			!
			Number: nZ
			Number: nRef
			: cDoc
				Class: cDoc
			!
			String: DDD
			Number: dVOBn
			Number: dVOBv
			!
			String: KKK
			Number: kVOBn
			Number: kVOBv
			!
			String: BBB
			Number: bVOB
			!
			String: SSS
			Number: sVOB
			!
		Message Actions
			On SAM_Create
				! If GetBankMfo()='353575' AND SalFmtFormatDateTime(GetBankDate(),'ddMMYYYY')>='15042006' 
					                                                                                                                                                                                                                                                                                                                                                                                 Call SalMessageBox("Окончен срок тестового использования модуля 'Регулярные платежи'! Обратитесь к разработчику!" , "В Н И М А Н И Е !", MB_Ok | MB_IconStop)
					                                                                                                                                                                                                                                                                                                                                                                                 Call SalDestroyWindow( hWndForm )
				Set nCol1 = SalColorFromRGB( 255,210,210 ) ! СЛАБО-КРАСНЫЙ
				Call SalColorSet( pbIns, COLOR_IndexWindow, nCol1 )
				!
				Set nCol2 = SalColorFromRGB( 220,255,255 ) ! голубой
				Call SalColorSet( pbDel, COLOR_IndexWindow, nCol2 )
				!
				Set nCol3 = SalColorFromRGB( 255,255,220) ! желтый
				Call SalColorSet( pbUpdate, COLOR_IndexWindow, nCol3 )
				!
				Set nTmp = 0
				Set sTmp = SalStrTrimX(strPar02)
				If Len(sTmp) > 0
					Set DDD = Subs(sTmp,1,3) 
					Set dVOBn=Val(Subs(sTmp,4,3)) 
					Set dVOBv=Val(Subs(sTmp,7,3)) 
					!
					Set KKK = Subs(sTmp,10,3) 
					Set kVOBn=Val(Subs(sTmp,13,3)) 
					Set kVOBv=Val(Subs(sTmp,16,3)) 
					!
					Set BBB = Subs(sTmp,19,3) 
					Set bVOB= Val(Subs(sTmp,22,3)) 
					!
					Set SSS = Subs(sTmp,25,3) 
					Set sVOB= Val(Subs(sTmp,28,3)) 
					!
				If DDD = STRING_Null or dVOBn = NUMBER_Null or dVOBv = NUMBER_Null 
						or KKK = STRING_Null or kVOBn = NUMBER_Null or kVOBv = NUMBER_Null 
						or BBB = STRING_Null or bVOB = NUMBER_Null 
						or SSS = STRING_Null or sVOB = NUMBER_Null 
					Call SalMessageBox('Коды TT и их Vob','Внимание ! Ошибка в параметре вызова strPar02 ', MB_IconStop)
					Call SalDestroyWindow( hWndForm )
				Set n980 = GetBaseVal()
				Set dDat = GetBankDate()
				Set aMFO = GetBankMfo()
				Set aOKPO= GetBankOkpoS()
				Set NLS_1001 = SalStrTrimX( s1001 )
				! Set NLS_1007 = SalStrTrimX( s1007 )
				If SqlPrepareAndExecute( hSql(), 
						"select nms into :NMS_1001 from accounts where nls=:NLS_1001 and kv=:n980 and dazs is null" )
						and not SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не найден сч.1001','Внимание ! Ошибка в параметре вызова strPar01', MB_IconStop)
					Call SalDestroyWindow( hWndForm )
				! If SqlPrepareAndExecute( hSql(), 
						"select a1.nms, a7.nms into :NMS_1001,:NMS_1007 from accounts a1, accounts a7 
						 where a1.nls=:NLS_1001 and a7.nls=:NLS_1007 and a1.kv=:n980 and a7.kv=:n980 and a1.dazs is null and a7.dazs is null " )
						and not SqlFetchNext( hSql(), nFetchRes )
					                                                                                                                                                                                                                                                                                                                                                                             Call SalMessageBox('Не найдены сч.1001 и сч.1007',
							'Внимание ! Ошибка в параметрах вызова ', MB_IconStop)
					                                                                                                                                                                                                                                                                                                                                                                             Call SalDestroyWindow( hWndForm )
				Call SalMapEnterToTab( TRUE )
				Call PrepareWindowEx( hWndForm )
				Call SetWindowFullSize( hWndForm )
				Call ShowApdVersion('05')
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On UM_Update
				Call SalSendMsg( hWndLost, UM_Update, 0, 0 )
				Call SalSendMsg( tbl,      UM_Update, 0, 0 )
				Call SalSendMsg( tbl2,     UM_Update, 0, 0 )
			On SAM_Close
				Call SalMapEnterToTab( FALSE )
	Dialog Box: dlgCalendar
		Class:
		Property Template:
		Class DLL Name:
		Title: Календарь выполнения регулярного платежа
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Standard
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   2.138"
				Top:    1.74"
				Width:  11.417"
				Width Editable? Yes
				Height: 7.0"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Standard
				Location? Top
				Visible? Yes
				Size: 0.595"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbNew
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.183"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Обновить
							Set strTip = CurrentLangTable.GetAtomTitle('dlgCalendar.pbNew')
						On SAM_Click
							If not SalIsNull(dfYear)
								Call uf_Populate()
				Pushbutton: pbU
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.683"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Сохранить календарь выполнения платежей
							Set strTip = CurrentLangTable.GetAtomTitle('dlgCalendar.pbU')
						On SAM_Click
							Call SalWaitCursor(TRUE)
							Set nCurrCode = nKv
							Call SalArrayGetUpperBound(dmDel, 1, nRec)
							Set nI = 0
							While nI <= nRec
								Set dTemp = dmDel[nI]
								If SqlPrepareAndExecute(hSql(),"DELETE FROM STO_DAT WHERE IDD=:IDD and dat=:dTemp")
									Call SqlCommit(hSql())
								Set nI = nI + 1
							!
							Call SalArrayGetUpperBound(dmSpR, 1, nRec)
							Set nI = 0
							Set nL = 0
							While nI <= nRec
								Set dTemp = dmSpR[nI]
								If dTemp != DATETIME_Null
									If SqlPrepareAndExecute(hSql(),"DELETE FROM STO_DAT WHERE IDD=:IDD and dat=:dTemp") 
											and SqlPrepareAndExecute(hSql(),"INSERT INTO STO_DAT (idd,dat) VALUES (:IDD,:dTemp)")
										Call SqlCommit(hSql())
									Else
										Set nL = nL + 1
										Call SqlRollback(hSql())
										Call SalWaitCursor(FALSE)
										Break
								Set nI = nI + 1
							Call SalWaitCursor(FALSE)
							If nL = 0
								Call SalArraySetUpperBound(dmDel, 1, -1)
								! Выполнено сохранение календаря платежей в базе данных
										  Сообщение
								Call MessageNoWait(CurrentLangTable.GetAtomTitle('dlgCalendar.MsgDone'),
										                   CurrentLangTable.GetAtomTitle('dlgCalendar.MsgInfo'), 3, 0)
							Call uf_Populate()
				Background Text: Год:
					Resource Id: 23717
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.983"
						Top:    0.095"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Data Field: dfYear
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 4
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.983"
							Top:    0.321"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.071"
							Width:  5.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dNLS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.321"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dFREQ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.783"
							Top:    0.321"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dWEND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.783"
							Top:    0.071"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dDat1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.383"
							Top:    0.321"
							Width:  1.633"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dDat2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.083"
							Top:    0.321"
							Width:  1.633"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Custom Control: cc1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172001B000100 0000000000010000 0200000001000000
0020: 0001000000000000 000056543A43616C 656E646172436F6D 626F426F78002B00
0040: 0100000001010101 0001020000000001 0101000100000000 000001000000010A
0060: 64642D4D4D2D7979 7979000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.238"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc1.WeekStartSet(2)
						Call cc1.SetMonthText(strMonth)
						Call cc1.SetWeekDayText(strWeekDays)
						Call cc1.SetFocusDate(SalDateConstruct(dfYear, 1, 1, 0, 0,
								     0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc1.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
			Custom Control: cc2
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0001000000000000 01000000010A6464 2D4D4D2D79797979
0040: 000056543A43616C 656E646172001B00 0100000000000001 0000020000000100
0060: 0000000100000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    0.238"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc2.WeekStartSet(2)
						Call cc2.SetMonthText(strMonth)
						Call cc2.SetWeekDayText(strWeekDays)
						Call cc2.SetFocusDate(SalDateConstruct(dfYear, 2, 1, 0, 0,
								     0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc2.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
			Custom Control: cc3
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0001000000000000 01000000010A6464 2D4D4D2D79797979
0040: 000056543A43616C 656E646172001B00 0100000000000001 0000020000000100
0060: 0000000100000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.238"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc3.WeekStartSet(2)
						Call cc3.SetMonthText(strMonth)
						Call cc3.SetWeekDayText(strWeekDays)
						Call cc3.SetFocusDate(SalDateConstruct(dfYear, 3, 1, 0, 0, 0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc3.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
			Custom Control: cc4
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0001000000000000 01000000010A6464 2D4D4D2D79797979
0040: 000056543A43616C 656E646172001B00 0100000000000001 0000020000000100
0060: 0000000100000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   8.483"
						Top:    0.238"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc4.WeekStartSet(2)
						Call cc4.SetMonthText(strMonth)
						Call cc4.SetWeekDayText(strWeekDays)
						Call cc4.SetFocusDate(SalDateConstruct(dfYear, 4, 1, 0, 0, 0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc4.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
			Custom Control: cc5
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0001000000000000 01000000010A6464 2D4D4D2D79797979
0040: 000056543A43616C 656E646172001B00 0100000000000001 0000020000000100
0060: 0000000100000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    2.071"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc5.WeekStartSet(2)
						Call cc5.SetMonthText(strMonth)
						Call cc5.SetWeekDayText(strWeekDays)
						Call cc5.SetFocusDate(SalDateConstruct(dfYear, 5, 1, 0, 0, 0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc5.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
			Custom Control: cc6
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0001000000000000 01000000010A6464 2D4D4D2D79797979
0040: 000056543A43616C 656E646172001B00 0100000000000001 0000020000000100
0060: 0000000100000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    2.071"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc6.WeekStartSet(2)
						Call cc6.SetMonthText(strMonth)
						Call cc6.SetWeekDayText(strWeekDays)
						Call cc6.SetFocusDate(SalDateConstruct(dfYear, 6, 1, 0, 0, 0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc6.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
			Custom Control: cc7
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0001000000000000 01000000010A6464 2D4D4D2D79797979
0040: 000056543A43616C 656E646172001B00 0100000000000001 0000020000000100
0060: 0000000100000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    2.071"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc7.WeekStartSet(2)
						Call cc7.SetMonthText(strMonth)
						Call cc7.SetWeekDayText(strWeekDays)
						Call cc7.SetFocusDate(SalDateConstruct(dfYear, 7, 1, 0, 0, 0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc7.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
			Custom Control: cc8
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0001000000000000 01000000010A6464 2D4D4D2D79797979
0040: 000056543A43616C 656E646172001B00 0100000000000001 0000020000000100
0060: 0000000100000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   8.483"
						Top:    2.071"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc8.WeekStartSet(2)
						Call cc8.SetMonthText(strMonth)
						Call cc8.SetWeekDayText(strWeekDays)
						Call cc8.SetFocusDate(SalDateConstruct(dfYear, 8, 1, 0, 0, 0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc8.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
			Custom Control: cc9
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0001000000000000 01000000010A6464 2D4D4D2D79797979
0040: 000056543A43616C 656E646172001B00 0100000000000001 0000020000000100
0060: 0000000100000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    3.905"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc9.WeekStartSet(2)
						Call cc9.SetMonthText(strMonth)
						Call cc9.SetWeekDayText(strWeekDays)
						Call cc9.SetFocusDate(SalDateConstruct(dfYear, 9, 1, 0, 0, 0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc9.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
			Custom Control: cc10
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0001000000000000 01000000010A6464 2D4D4D2D79797979
0040: 000056543A43616C 656E646172001B00 0100000000000001 0000020000000100
0060: 0000000100000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    3.905"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc10.WeekStartSet(2)
						Call cc10.SetMonthText(strMonth)
						Call cc10.SetWeekDayText(strWeekDays)
						Call cc10.SetFocusDate(SalDateConstruct(dfYear, 10, 1, 0,
								     0, 0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc10.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
			Custom Control: cc11
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172001B000100 0000000000010000 0200000001000000
0020: 0001000000000000 000056543A43616C 656E646172436F6D 626F426F78002B00
0040: 0100000001010101 0001020000000001 0101000100000000 000001000000010A
0060: 64642D4D4D2D7979 7979000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    3.905"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc11.WeekStartSet(2)
						Call cc11.SetMonthText(strMonth)
						Call cc11.SetWeekDayText(strWeekDays)
						Call cc11.SetFocusDate(SalDateConstruct(dfYear, 11, 1, 0,
								     0, 0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc11.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
			Custom Control: cc12
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172001B000100 0000000000010000 0200000001000000
0020: 0001000000000000 000056543A43616C 656E646172436F6D 626F426F78002B00
0040: 0100000001010101 0001020000000001 0101000100000000 000001000000010A
0060: 64642D4D4D2D7979 7979000000000000
.enddata
.data CLASSPROPSSIZE
0000: 7000
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCalendar
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   8.483"
						Top:    3.905"
						Width:  2.8"
						Width Editable? Class Default
						Height: 1.833"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? No
					Hollow? Yes
					Vertical Scroll? No
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Default
					Font Size: Class Default
					Font Enhancement: None
					Text Color: Blue
					Background Color: Blue
					DLL Settings
				Message Actions
					On SAM_Create
						Call cc12.WeekStartSet(2)
						Call cc12.SetMonthText(strMonth)
						Call cc12.SetWeekDayText(strWeekDays)
						Call cc12.SetFocusDate(SalDateConstruct(dfYear, 12, 1, 0,
								     0, 0))
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call cc12.GetFocusDate(dDada)
						Call standat3(dfYear, dDada)
						Call SalWaitCursor(FALSE)
		Functions
			Function: uf_Populate
				Description: Закрасить красным выходные и праздники
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nI
					Number: nFetchRes
					Date/Time: dHoliDay
				Actions
					Call SqlPrepareAndExecute(hSql(), "
							     SELECT holiday
							     INTO :dHoliDay
							     FROM holiday
							     WHERE kv=:nKv and TO_CHAR(holiday,'YYYY')=:dfYear
							     ORDER BY holiday")
					Set nI = 0
					Call SalArraySetUpperBound(dmSp, 1, -1)
					While SqlFetchNext(hSql(), nFetchRes)
						Set dmSp[nI] = dHoliDay
						Set nI = nI + 1
					Call SalArrayGetUpperBound(dmSp, 1, nRec3H)
					Call BeginInit()
					!
					Call uf_PopulateSTO()
			Function: BeginInit
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nY
					Number: nRec
					Date/Time: dBegin
				Actions
					Call SalWaitCursor(TRUE)
					Set nY = dfYear
					Set dBegin = SalDateConstruct(nY, 1, 1, 0, 0, 0)
					Call SalArrayGetUpperBound(dmSp, 1, nRec)
					While nY = dfYear ! в цикле забумбонить все даты Special
						If InArrayDateExist(dmSp, nRec, dBegin)
							! Красный день
							If SalDateMonth(dBegin) = 1
								Call cc1.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
							Else If SalDateMonth(dBegin) = 2
								Call cc2.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
							Else If SalDateMonth(dBegin) = 3
								Call cc3.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
							Else If SalDateMonth(dBegin) = 4
								Call cc4.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
							Else If SalDateMonth(dBegin) = 5
								Call cc5.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
							Else If SalDateMonth(dBegin) = 6
								Call cc6.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
							Else If SalDateMonth(dBegin) = 7
								Call cc7.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
							Else If SalDateMonth(dBegin) = 8
								Call cc8.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
							Else If SalDateMonth(dBegin) = 9
								Call cc9.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
							Else If SalDateMonth(dBegin) = 10
								Call cc10.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
							Else If SalDateMonth(dBegin) = 11
								Call cc11.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
							Else If SalDateMonth(dBegin) = 12
								Call cc12.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Red,
										     TRUE)
						Else
							! Серый день
							If SalDateMonth(dBegin) = 1
								Call cc1.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
							Else If SalDateMonth(dBegin) = 2
								Call cc2.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
							Else If SalDateMonth(dBegin) = 3
								Call cc3.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
							Else If SalDateMonth(dBegin) = 4
								Call cc4.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
							Else If SalDateMonth(dBegin) = 5
								Call cc5.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
							Else If SalDateMonth(dBegin) = 6
								Call cc6.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
							Else If SalDateMonth(dBegin) = 7
								Call cc7.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
							Else If SalDateMonth(dBegin) = 8
								Call cc8.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
							Else If SalDateMonth(dBegin) = 9
								Call cc9.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
							Else If SalDateMonth(dBegin) = 10
								Call cc10.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
							Else If SalDateMonth(dBegin) = 11
								Call cc11.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
							Else If SalDateMonth(dBegin) = 12
								Call cc12.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_Gray,
										     TRUE)
						Set dBegin = dBegin + 1
						Set nY = SalDateYear(dBegin)
					Call cc1.SetFocusDate(SalDateConstruct(dfYear, 1, 1, 0, 0,
							     0))
					Call cc2.SetFocusDate(SalDateConstruct(dfYear, 2, 1, 0, 0,
							     0))
					Call cc3.SetFocusDate(SalDateConstruct(dfYear, 3, 1, 0, 0,
							     0))
					Call cc4.SetFocusDate(SalDateConstruct(dfYear, 4, 1, 0, 0,
							     0))
					Call cc5.SetFocusDate(SalDateConstruct(dfYear, 5, 1, 0, 0,
							     0))
					Call cc6.SetFocusDate(SalDateConstruct(dfYear, 6, 1, 0, 0,
							     0))
					Call cc7.SetFocusDate(SalDateConstruct(dfYear, 7, 1, 0, 0,
							     0))
					Call cc8.SetFocusDate(SalDateConstruct(dfYear, 8, 1, 0, 0,
							     0))
					Call cc9.SetFocusDate(SalDateConstruct(dfYear, 9, 1, 0, 0,
							     0))
					Call cc10.SetFocusDate(SalDateConstruct(dfYear, 10, 1, 0, 0,
							     0))
					Call cc11.SetFocusDate(SalDateConstruct(dfYear, 11, 1, 0, 0,
							     0))
					Call cc12.SetFocusDate(SalDateConstruct(dfYear, 12, 1, 0, 0,
							     0))
					Call SalWaitCursor(FALSE)
			Function: uf_PopulateSTO
				Description: Закрасить синим дни платежей
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nI
					Number: nFetchRes
					Date/Time: dHoliDay
				Actions
					Call SqlPrepareAndExecute(hSql(),
							"SELECT DAT INTO :dHoliDay FROM STO_DAT 
							 WHERE IDD=:IDD and TO_CHAR(DAT,'YYYY')=:dfYear ORDER BY DAT ")
					Set nI = 0
					Call SalArraySetUpperBound(dmSpR, 1, -1)
					While SqlFetchNext(hSql(), nFetchRes)
						Set dmSpR[nI] = dHoliDay
						Set nI = nI + 1
					Call BeginInitSTO()
			Function: BeginInitSTO
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nY
					Number: nRec
					Date/Time: dBegin
					Number: nCol
				Actions
					Call SalWaitCursor(TRUE)
					Set nCol = COLOR_Blue
					Set nY = dfYear
					Set dBegin = SalDateConstruct(nY, 1, 1, 0, 0, 0)
					Call SalArrayGetUpperBound(dmSpR, 1, nRec)
					While nY = dfYear ! в цикле забумбонить все даты Special
						If InArrayDateExist(dmSpR, nRec, dBegin)
							! Синий день
							If SalDateMonth(dBegin) = 1
								Call cc1.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dBegin) = 2
								Call cc2.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dBegin) = 3
								Call cc3.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dBegin) = 4
								Call cc4.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dBegin) = 5
								Call cc5.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dBegin) = 6
								Call cc6.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dBegin) = 7
								Call cc7.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dBegin) = 8
								Call cc8.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dBegin) = 9
								Call cc9.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dBegin) = 10
								Call cc10.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dBegin) = 11
								Call cc11.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dBegin) = 12
								Call cc12.SpecialDate(SPECIAL_OneTime, dBegin,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
						Set dBegin = dBegin + 1
						Set nY = SalDateYear(dBegin)
					Call cc1.SetFocusDate(SalDateConstruct(dfYear, 1, 1, 0, 0,
							     0))
					Call cc2.SetFocusDate(SalDateConstruct(dfYear, 2, 1, 0, 0,
							     0))
					Call cc3.SetFocusDate(SalDateConstruct(dfYear, 3, 1, 0, 0,
							     0))
					Call cc4.SetFocusDate(SalDateConstruct(dfYear, 4, 1, 0, 0,
							     0))
					Call cc5.SetFocusDate(SalDateConstruct(dfYear, 5, 1, 0, 0,
							     0))
					Call cc6.SetFocusDate(SalDateConstruct(dfYear, 6, 1, 0, 0,
							     0))
					Call cc7.SetFocusDate(SalDateConstruct(dfYear, 7, 1, 0, 0,
							     0))
					Call cc8.SetFocusDate(SalDateConstruct(dfYear, 8, 1, 0, 0,
							     0))
					Call cc9.SetFocusDate(SalDateConstruct(dfYear, 9, 1, 0, 0,
							     0))
					Call cc10.SetFocusDate(SalDateConstruct(dfYear, 10, 1, 0, 0,
							     0))
					Call cc11.SetFocusDate(SalDateConstruct(dfYear, 11, 1, 0, 0,
							     0))
					Call cc12.SetFocusDate(SalDateConstruct(dfYear, 12, 1, 0, 0,
							     0))
					Call SalWaitCursor(FALSE)
			!
			Function: standat3
				Description:
				Returns
				Parameters
					Number: dfYearField
					Date/Time: dDada3
				Static Variables
				Local variables
					Number: nI
					Number: nRec3
					Number: nMes
					Number: nCol
					Number: nCol1
					Date/Time: dTemp
				Actions
					If dDada3 < bDat 
							OR InArrayDateExist(dmSp, nRec3H, dDada3) 
							OR dDada3 < Dat1 OR dDada3 > Dat2  
						Return FALSE
					!
					Call SalArrayGetUpperBound(dmSpR, 1, nRec3)
					Set nCol = COLOR_Blue
					If InArrayDateExist(dmSpR, nRec3, dDada3)
						! выкинуть dDada3 из Special и добавить в dmDel
						Set nI = 0
						While nI <= nRec3
							If dmSpR[nI] = dDada3
								Set dmSpR[nI] = DATETIME_Null
								Call SalArrayGetUpperBound(dmDel, 1, nRec3)
								Set dmDel[nRec3+1] = dDada3
								Break
							Set nI = nI + 1
					Else
						! добавить dDada3 в Special
						Set dmSpR[nRec3+1] = dDada3
					!
					Set nMes = SalDateMonth(dDada3)
					If nMes = 1
						Call cc1.ClearSpecials()
					Else If nMes = 2
						Call cc2.ClearSpecials()
					Else If nMes = 3
						Call cc3.ClearSpecials()
					Else If nMes = 4
						Call cc4.ClearSpecials()
					Else If nMes = 5
						Call cc5.ClearSpecials()
					Else If nMes = 6
						Call cc6.ClearSpecials()
					Else If nMes = 7
						Call cc7.ClearSpecials()
					Else If nMes = 8
						Call cc8.ClearSpecials()
					Else If nMes = 9
						Call cc9.ClearSpecials()
					Else If nMes = 10
						Call cc10.ClearSpecials()
					Else If nMes = 11
						Call cc11.ClearSpecials()
					Else If nMes = 12
						Call cc12.ClearSpecials()
					Call SalArrayGetUpperBound(dmSpR, 1, nRec3)
					Set nY = dfYearField
					Set dTemp = SalDateConstruct(nY, nMes, 1, 0, 0, 0)
					While nY = dfYearField and SalDateMonth(dTemp) = nMes
						Set nCol1 = IifN( InArrayDateExist(dmSp, nRec3H, dTemp), COLOR_Red, COLOR_Gray)
						If InArrayDateExist(dmSpR, nRec3, dTemp)
							If SalDateMonth(dTemp) = 1
								Call cc1.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dTemp) = 2
								Call cc2.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dTemp) = 3
								Call cc3.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dTemp) = 4
								Call cc4.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dTemp) = 5
								Call cc5.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dTemp) = 6
								Call cc6.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dTemp) = 7
								Call cc7.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dTemp) = 8
								Call cc8.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dTemp) = 9
								Call cc9.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dTemp) = 10
								Call cc10.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
							Else If SalDateMonth(dTemp) = 11
								Call cc11.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										    TRUE)
							Else If SalDateMonth(dTemp) = 12
								Call cc12.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_White, nCol,
										     TRUE)
						Else
							If SalDateMonth(dTemp) = 1
								Call cc1.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
							Else If SalDateMonth(dTemp) = 2
								Call cc2.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
							Else If SalDateMonth(dTemp) = 3
								Call cc3.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
							Else If SalDateMonth(dTemp) = 4
								Call cc4.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
							Else If SalDateMonth(dTemp) = 5
								Call cc5.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
							Else If SalDateMonth(dTemp) = 6
								Call cc6.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
							Else If SalDateMonth(dTemp) = 7
								Call cc7.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
							Else If SalDateMonth(dTemp) = 8
								Call cc8.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
							Else If SalDateMonth(dTemp) = 9
								Call cc9.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
							Else If SalDateMonth(dTemp) = 10
								Call cc10.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
							Else If SalDateMonth(dTemp) = 11
								Call cc11.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
							Else If SalDateMonth(dTemp) = 12
								Call cc12.SpecialDate(SPECIAL_OneTime, dTemp,
										     DAY_Unset, SEQ_Unset, COLOR_Black, nCol1,
										     TRUE)
						Set dTemp = dTemp + 1
						Set nY = SalDateYear(dTemp)
			Function: InArrayDateExist
				Description:
				Returns
					Boolean:
				Parameters
					Date/Time: dmFind[*]
					Number: nBound
					Date/Time: dValue
				Static Variables
				Local variables
					Number: nI
				Actions
					Set nI = 0
					While nI <= nBound
						If dmFind[nI] = dValue
							Return TRUE
						Set nI = nI + 1
					Return FALSE
		Window Parameters
			String: NMK
			String: NLS
			Number: IDD
			Number: Freq
			Date/Time: Dat1
			Date/Time: Dat2
			Number: WEND
			String: FreqS
		Window Variables
			String: strMessage[*]
			Boolean: b1
			String: strPK
			String: strSK
			Number: nKv
			Number: nRec
			Number: nNewRow
			Number: nFetchRes
			String: strMonth[12]
			String: strWeekDays[7]
			Number: nL
			Number: nY
			Number: nI
			Number: nCurrCode
			Date/Time: dBegin
			Date/Time: dDada
			Date/Time: dmSp[*] !! Массив красных
			Number: nRec3H
			Date/Time: dmSpR[*] !! Массив синих
			Date/Time: dmDel[*] !! Удаленные из массива синих
			Date/Time: dTemp 
			Date/Time: bDat
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				If Freq = 2
					! Индивидуальный график
					Call SalHideWindow( dWEND )
				Else
					! ПОСЛЕ выходных / ДО выходных
					Set dWEND = IifS(WEND > 0, 
							                 CurrentLangTable.GetAtomTitle('dlgCalendar.AfterWend'), 
							                 CurrentLangTable.GetAtomTitle('dlgCalendar.BeforWend'))
					Call SalShowWindow(dWEND)
				Set nKv = GetBaseVal()
				Set bDat = GetBankDate()
				Set dNMK = NMK
				Set dFREQ = FreqS
				Set dNLS = NLS
				Set dDat1 = Dat1
				Set dDat2 = Dat2
				Set dfYear = SalDateYear(SalDateCurrent())
				! Календарь выполнения регулярного платежа
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgCalendar.cTWndTitle'))
				Set strMonth[0] = CurrentLangTable.GetAtomTitle('dlgCalendar.Jan')
				Set strMonth[1] = CurrentLangTable.GetAtomTitle('dlgCalendar.Feb')
				Set strMonth[2] = CurrentLangTable.GetAtomTitle('dlgCalendar.Mar')
				Set strMonth[3] = CurrentLangTable.GetAtomTitle('dlgCalendar.Apr')
				Set strMonth[4] = CurrentLangTable.GetAtomTitle('dlgCalendar.May')
				Set strMonth[5] = CurrentLangTable.GetAtomTitle('dlgCalendar.Jun')
				Set strMonth[6] = CurrentLangTable.GetAtomTitle('dlgCalendar.Jul')
				Set strMonth[7] = CurrentLangTable.GetAtomTitle('dlgCalendar.Aug')
				Set strMonth[8] = CurrentLangTable.GetAtomTitle('dlgCalendar.Sep')
				Set strMonth[9] = CurrentLangTable.GetAtomTitle('dlgCalendar.Oct')
				Set strMonth[10]= CurrentLangTable.GetAtomTitle('dlgCalendar.Nov')
				Set strMonth[11]= CurrentLangTable.GetAtomTitle('dlgCalendar.Dec')
				Set strWeekDays[0] = CurrentLangTable.GetAtomTitle('dlgCalendar.Sun')
				Set strWeekDays[1] = CurrentLangTable.GetAtomTitle('dlgCalendar.Mon')
				Set strWeekDays[2] = CurrentLangTable.GetAtomTitle('dlgCalendar.Tue')
				Set strWeekDays[3] = CurrentLangTable.GetAtomTitle('dlgCalendar.Wed')
				Set strWeekDays[4] = CurrentLangTable.GetAtomTitle('dlgCalendar.Thu')
				Set strWeekDays[5] = CurrentLangTable.GetAtomTitle('dlgCalendar.Fri')
				Set strWeekDays[6] = CurrentLangTable.GetAtomTitle('dlgCalendar.Sat')
				! Set strMonth[0] = 'январь'
				! Set strMonth[1] = 'февраль'
				! Set strMonth[2] = 'март'
				! Set strMonth[3] = 'апрель'
				! Set strMonth[4] = 'май'
				! Set strMonth[5] = 'июнь'
				! Set strMonth[6] = 'июль'
				! Set strMonth[7] = 'август'
				! Set strMonth[8] = 'сентябрь'
				! Set strMonth[9] = 'октябрь'
				! Set strMonth[10] = 'ноябрь'
				! Set strMonth[11] = 'декабрь'
				! Set strWeekDays[0] = 'Вс'
				! Set strWeekDays[1] = 'Пн'
				! Set strWeekDays[2] = 'Вт'
				! Set strWeekDays[3] = 'Ср'
				! Set strWeekDays[4] = 'Чт'
				! Set strWeekDays[5] = 'Пт'
				! Set strWeekDays[6] = 'Сб'
				Call uf_Populate()
				! ReadOnly
				Call SalMapEnterToTab(TRUE)
				Call XSalTooltipSetUserDefault()
	Table Window: OVR
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Портфель договорів Овердрафту
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  13.767"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 25827
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.45"
						Begin Y:  Class Default
						End X:  5.45"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.117"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть счета по договору'
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 25828
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 25829
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dTOBO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.283"
							Top:    0.071"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_SetFocus
							Set sTmpE = dTOBO
						On SAM_AnyEdit
							Set dTOBO = sTmpE
				Data Field: dTOBONAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   8.583"
							Top:    0.071"
							Width:  3.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_SetFocus
							Set sTmpE = dTOBONAME
						On SAM_AnyEdit
							Set dTOBONAME = sTmpE
				Pushbutton: pb_Proc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_PROC.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Нарахувати %% за використаний Овр'
						On SAM_Click
							Set sFilter_Pr = 
									 " AND i.id in (0,2) and s.acc in (select acc from nd_acc ) "
							Call Sel010(hWndMDI, 0, 0, sFilter_Pr, "S" )
				Pushbutton: pb_Finis
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_ACCS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = '
									Процедури ЗАКРИТТЯ дня для вибранного договору : 
									 1.Погашення 2738, 
									 2.Погашення 4735/2, 
									 3.Відновлення ліміту, 
									 4.Перенесення на 4735/2,
									 5.Регулювання 9110
									'
							If nPar = 0
								Call SalDisableWindow( pb_Finis )
						On SAM_Click
							! If not SalIsNull(ND) 
								                                                                                                                                                                                                                                                                                                     Set sTmpE = 'Виконано Процедури ЗАКРИТТЯ дня для ND='|| Str(ND)
								                                                                                                                                                                                                                                                                                                     If SqlPLSQLCommand(hSql(), "mvo_ovr.OVRF( ND, dDat) " )
									                                                                                                                                                                                                                                                                                                     Call SqlCommitEx( hSql(),sTmpE )
									                                                                                                                                                                                                                                                                                                     Call MessageNoWait(sTmpE ,'Повідомлення',2,0)
								                                                                                                                                                                                                                                                                                                     Else 
									                                                                                                                                                                                                                                                                                                     Call SqlRollback(hSql())
									                                                                                                                                                                                                                                                                                                     Call MessageNoWait('НЕ ' || sTmpE, 'Помилка !', 0, 1)
							Set sTmpE = 'Виконано Процедури ЗАКРИТТЯ дня для дог.ОВР'
							If SqlPLSQLCommand(hSql(), "mvo_ovr.OVRF( 0, dDat) " )
								Call SqlCommitEx( hSql(),sTmpE )
								Call MessageNoWait(sTmpE ,'Повідомлення',2,0)
							Else
								Call SqlRollback(hSql())
								Call MessageNoWait('НЕ ' || sTmpE, 'Помилка !', 0, 1)
		Contents
			! Column: SOS
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Уз-
						год-
						жено
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
.end
				                                                                                                                                                                                                                                                                                                           List Values 
				                                                                                                                                                                                                                                                                                                           Message Actions 
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєст
						№ кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_RNK()
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ПІБ
						клієнта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_RNK()
			Column: ND 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						дог
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ід
						договору
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						початку
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.133"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_DAT()
					On SAM_KillFocus
						Call F_DAT()
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						заверш.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.133"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_DAT()
					On SAM_KillFocus
						Call F_DAT()
			Column: LIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Установ.
						ліміт
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						загрузки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If RNK != NUMBER_Null 
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered
									("ACCOUNTS","NLS", 
									" rnk="||Str(RNK)||
									" and dazs is null and tip='LOD' and nvl(lim,0)=0 and tobo='"||aTOBO||"'
									 and acc not in (select acc from nd_acc)",sTmp,NLS)
							Set ACC = NUMBER_Null
							If sTmp != STRING_Null
								Set ACC = Val(sTmp)
								If SqlPrepareAndExecute( hSql(),
										"SELECT  ostc/100, lim/100, mdate
										 into  :OST, :LIM, :MDATE
										 from accounts  where acc=:ACC  ")
										and SqlFetchNext(hSql(), nFetchRes)
								If ND != NUMBER_Null
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE )
							! Call F_NLS()
			Column: LIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Діючий 
						ліміт
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пл.Дата 
						виходу 
						з ОВР
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.133"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Поточний
						залишок 
						ЗАГРУЗКИ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AKC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ресурс :
						Ліміт
						 для АКС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Поточний
						залишок 
						просроч
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Поточний
						залишок 
						нар.%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Поточний
						залишок 
						нар.пені
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.917"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						виконавця
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_RNK
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If ACC = NUMBER_Null 
						Set sTmp = STRING_Null
						Call FunNSIGetFiltered
								("CUSTOMER",
								 "NMK",
								 " tobo='"||aTOBO||"' and rnk in
								(select a.rnk 
								 from accounts a, dpt_deposit d, DPT_VIDD_PARAMS p, accounts b 
								 where a.nls like '4735_______010' and a.tip='LOD' and a.tobo='"||aTOBO||"'  
								   and a.dazs is null 
								   and a.lim=0 
								   and a.acc not in (select acc from nd_acc)
								   and d.acc = a.acc 
								   and d.vidd= p.vidd and p.tag = 'NLS_6099' 
								   and p.val = b.nls  and b.kv  = 980 
								   and b.dazs is null
								 ) ", sTmp, NMK)
						If sTmp != STRING_Null
							Set RNK=Val(sTmp)
							If ND = NUMBER_Null
								Set DAT1= dDat
								Set DAT4= AddMonths( dDat,12)
								Set ISP=GetUserId()
								Set LIMIT = 0
								If SqlPrepareAndExecute( hSql(),
										"SELECT nls, ACC, ostc/100, lim/100, mdate
										 into :NLS, :ACC, :OST, :LIM, :MDATE
										 from accounts 
										 where nls like '4735_______010' and rnk=:RNK and tip='LOD' 
										   and dazs is null 
										   and acc not in (select acc from nd_acc )")
										and SqlFetchNext(hSql(), nFetchRes)
								Else
									Set ACC = NUMBER_Null
							Else
								Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE )
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If DAT4 < DAT1 and DAT1 != DATETIME_Null and DAT4 != DATETIME_Null
						Call SalMessageBox("Дата-начала БОЛЬШЕ Даты-завершения",
								"Внимание, ошибка !", MB_IconStop)
						Set DAT4 = DAT1
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Date/Time: dDat
			Number: n980
			Number: nColK
			Number: nColG
			Number: nColJ
			String: sTmp
			String: sTmpE
			Number: nTmpE
			Date/Time: dTmpE
			String: sFilter_Pr
			String: aMfo
			! Number: nS
			! String: NLSA1
			! cDoc: cDoc
.winattr class :
				Class: cDoc
.end
		Message Actions
			On SAM_Create
				If SqlPrepareAndExecute( hSql(),
						"select name into :dTOBONAME from tobo where tobo=:aTOBO " ) 
						and NOT SqlFetchNext(hSql(), nFetchRes)
					Call SalMessageBox("Помилка в ini-файлі параметра KOD_TOBO  !",
							"Робота неможлива !", MB_IconStop)
					Call SalDestroyWindow(hWndForm)
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 10 )
				Set dTOBO=aTOBO
				! Set nFlags=GT_NoRet | GT_NoIns | GT_NoDel | GT_NoUpd
				! Call SalSetWindowText( hWndForm, 'Платіжні доручення до взаємозаліку' )
				Set dDat = GetBankDate()
				Set n980 = GetBaseVal()
				Set aMfo = GetBankMfo()
				Call ShowApdVersion('01')
				! Красній
				Set nColK = SalColorFromRGB( 255,210,210 )
				! Голубой
				Set nColG = SalColorFromRGB( 220,255,255 ) 
				! Желтый 
				Set nColJ = SalColorFromRGB( 255,255,180) 
				!
				Set OVR.nTabInstance = 1
				Set OVR.strPrintFileName = 'MVO_OVR'
				Set OVR.strFilterTblName = 'V_MVO_OVR'
				!
				Set OVR.strSqlPopulate =
						"SELECT ND, CC_ID, DAT1, DAT4, RNK, NMK, LIMIT, ISP, NLS, LIM, MDATE, OST, acc
						 INTO :OVR.ND, :OVR.CC_ID, :OVR.DAT1,:OVR.DAT4, :OVR.RNK,  :OVR.NMK, 
						   :OVR.LIMIT, :OVR.ISP  , :OVR.NLS, :OVR.LIM,  :OVR.MDATE,:OVR.OST, :OVR.ACC
						 FROM V_MVO_OVR WHERE tobo='"||aTOBO||"' 
						 ORDER BY nd "
				!
				Set OVR.strSqlInsert =
						"insert into V_MVO_OVR(ND,CC_ID,DAT1,DAT4,RNK,LIMIT,ISP, acc)
						  values (:OVR.ND,:OVR.CC_ID,:OVR.DAT1,:OVR.DAT4,:OVR.RNK,:OVR.LIMIT,:OVR.ISP,:OVR.ACC)"
				!
				Set OVR.strSqlUpdate =
						"update V_MVO_OVR 
						    set cc_id=:OVR.CC_ID, dat1=:OVR.DAT1, dat4=:OVR.DAT4, 
						        limit=:OVR.LIMIT, isp=:OVR.ISP 
						   where nd=:OVR.ND and tobo='"||aTOBO||"'"
				!
				Set OVR.strSqlDelete =
						"delete from V_MVO_OVR where nd=:OVR.ND and tobo='"||aTOBO||"'"
				!
				Call SalSendClassMessage( SAM_Create, 0, 0 )
				!
			On SAM_DoubleClick
				If not SalIsNull(ACC) and not SalIsNull(ND) 
					Set sTmp=" a.acc in (select acc from nd_acc where nd=" || Str(ND) || ") "  
					Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
				Else
					Call F_RNK()
			On SAM_FetchRowDone
				If SqlPrepareAndExecute( hSqlAux2(), 
						"select ostc/100 into :OSTN from accounts a, nd_acc n
						 where n.ND=:ND and n.acc=a.acc and a.tip='SN ' " )
						and  SqlFetchNext( hSqlAux2(), nFetchRes) 
				If SqlPrepareAndExecute( hSqlAux2(), 
						"select ostc/100 into :OST8 from accounts a, nd_acc n
						 where n.ND=:ND and n.acc=a.acc and a.tip='SN8' " )
						and  SqlFetchNext( hSqlAux2(), nFetchRes) 
				!
				Set AKC = OST + LIM 
				If SqlPrepareAndExecute( hSqlAux2(), 
						"select ostc/100 into :OSTP from accounts a, nd_acc n
						 where n.ND=:ND and n.acc=a.acc and a.tip='SP ' " )
						and  SqlFetchNext( hSqlAux2(), nFetchRes) 
					Set AKC = AKC + OSTP
				If AKC < 0
					Set AKC = 0
				If MDATE < dDat and MDATE != DATETIME_Null 
					! Розовій - в просроченном ОВР
					Call XSalTblSetRowBackColor(hWndForm, lParam, nColK)
				Else If OST<0 
					Call XSalTblSetRowBackColor(hWndForm, lParam, nColG)
				! Желтій
				Call XSalTblSetCellBackColor( AKC, nColJ )
	Form Window: DPT
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.825"
				Top:    1.031"
				Width:  11.433"
				Width Editable? Yes
				Height: 3.238"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.238"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Реєс.№ клієнта')
			Data Field: KvB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.483"
						Top:    0.238"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Код валюти ')
			Data Field: DPT_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.183"
						Top:    0.238"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Реф деп.договору')
			Data Field: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.883"
						Top:    0.238"
						Width:  4.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Назва клієнта')
			Data Field: Okpo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.883"
						Top:    0.238"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Ід.код клієнта')
			!
			Data Field: Dat0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.738"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Дата останнього поповнення ')
			Combo Box: cmbFreq
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.183"
					Top:    0.655"
					Width:  2.3"
					Width Editable? Class Default
					Height: 3.512"
					Height Editable? Class Default
				Visible? Class Default
				Editable? No
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Bold
				Text Color: Class Default
				Background Color: System Window Color
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If cmbFreq.Init( hWndItem )
							Call cmbFreq.Populate( hSql(), 'freq', 'name', 'freq', '' )
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, 0, 0 )
						Set nFreq = cmbFreq.nCurrentId
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Періодичність поповнення ')
			Data Field: Dat1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.483"
						Top:    0.655"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Почати з ... ')
			Data Field: Dat2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.883"
						Top:    0.655"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Закінчити ... ')
			Data Field: WEND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.083"
						Top:    0.738"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Вихідні дні ')
			Group Box: Платіж у Вихідні дні 
				Resource Id: 23499
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.383"
					Top:    0.488"
					Width:  3.5"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Radio Button: rbD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: До
				Window Location and Size
					Left:   7.583"
					Top:    0.655"
					Width:  0.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rbP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Після
				Window Location and Size
					Left:   9.083"
					Top:    0.655"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Pushbutton: pb_Cal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.883"
					Top:    1.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\CALS.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Уточнити календар платежів'
					On SAM_Click
						If IDD = 0 or IDD = NUMBER_Null 
							Call F_Save()
						If IDD >0 
							Call SalModalDialog(dlgCalendar, hWndForm, NMK, NlsA,
									IDD, nFreq, Dat1, Dat2, WEND, cmbFreq )
			!
			Combo Box: NlsA
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.183"
					Top:    1.071"
					Width:  2.3"
					Width Editable? Yes
					Height: 0.417"
					Height Editable? Yes
				Visible? Yes
				Editable? Yes
				String Type: String
				Maximum Data Length: Default
				Sorted? Yes
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Списати з рахунку ')
			!
			Data Field: MfoB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.517"
						Top:    1.452"
						Width:  1.267"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: KvA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.483"
						Top:    1.405"
						Width:  0.633"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NlsB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.483"
						Top:    1.071"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Зарахувати на  рахунок ')
			Data Field: Polu
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.883"
						Top:    1.071"
						Width:  4.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Отримувач ')
			Data Field: Fsum
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    1.488"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Сума платежу ')
			Pushbutton: pb_Save
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.383"
					Top:    1.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\SAVE_M.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Зберегти зміни'
					On SAM_Click
						Call F_Save()
			Data Field: sNazn
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    1.905"
						Width:  8.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Призначення платежу ')
			!
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.883"
					Top:    1.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Выход из карточки
						Set strTip = "Завершити"
					On SAM_Click
						Call SalDestroyWindow( DPT )
						Return TRUE
		Functions
			Function: NASELENIE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(),
							 "SELECT TT,VOB,DK,NLSA,KVA,NLSB,KVB,MFOB,POLU,NAZN,FSUM,OKPO,
							   DAT1,DAT2,FREQ, DAT0, nvl(WEND,1), IDD
							 INTO :TT,  :Vob, :Dk,  :NlsA,:KvA, :NlsB, :KvB, :MfoB,:Polu,
							      :sNazn,:Str_FSUM,:Okpo,:Dat1,:Dat2,:nFreq,:Dat0,:WEND,:IDD
							 FROM sto_det WHERE ids=:DPT.pDPT_ID" ) 
							and SqlFetchNext( hSql(), nFetchRes )  
						Set rbP = (WEND=1)
						Call cmbFreq.SetSelectById( nFreq )
						Set Fsum = Val(Str_FSUM)/100
						Call SalWaitCursor(FALSE)
						Return TRUE
					Else
						Set IDD = 0
			Function: F_Save
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sSql 
				Actions
					If Fsum = 0 or Fsum = NUMBER_Null
						Call SalMessageBox( "Не задано суму автоматичного поповнення", "Увага ! ", MB_IconStop)
						Return FALSE
					! !!!
					Set Str_FSUM = Str(Fsum *100) 
					If IDD = 0 or IDD = NUMBER_Null 
						If SqlPrepareAndExecute( hSql(),
								"INSERT INTO sto_lst (IDG,IDS,RNK,NAME,SDAT) VALUES 
								(:nMode,:pDPT_ID,:RNK,:NMK,:bDat)")
							Call SqlCommit(hSql() )
						Set sSql = 
								"INSERT INTO sto_det
								 (ids,tt,vob,dk,nlsa,kva,nlsb,kvb,mfob,polu,nazn,okpo,DAT1,DAT2,
								  FREQ,DAT0,WEND,FSUM)   VALUES 
								 (:pDPT_ID, :TT, :Vob, :Dk, :NlsA, :KvB, :NlsB, :KvB, :aMfo,
								  :Polu, :sNazn, :Okpo,:Dat1,:Dat2,:nFreq,:bDat,:WEND,:Str_FSUM )" 
					Else
						Set sSql = 
								"UPDATE sto_det 
								 SET nlsa=:NlsA, fsum=:Str_FSUM, WEND=:WEND, FREQ=:nFreq, 
								     DAT1=:Dat1, DAT2=:Dat2, DAT0=:Dat0
								  WHERE IDD=:IDD " 
					!
					If SqlPrepareAndExecute( hSql(), sSql ) 
						Call SqlCommit(hSql() )
						Call NASELENIE()
						Return TRUE
					Else
						Call SqlRollback( hSql() )
						Return FALSE
		Window Parameters
			Number: nMode
			Number: pDPT_ID
			String: strPar01
			String: strPar02
		Window Variables
			String: aMfo
			String: TT
			! String: sNazn
			Number: nFreq
			Number: Vob
			Number: Dk 
			Number: IDD
			Date/Time: bDat
			String: sTmp
			Number: nTmp
			Number: nAcc
			Number: LIMIT
			String: Str_FSUM
			String: sErr
		Message Actions
			On SAM_Create
				Set DPT_ID = pDPT_ID
				Set aMfo = GetBankMfo()
				Set bDat = GetBankDate()
				Call SalSetWindowText( hWndForm, 'Пл.доручення для поповнення вкладу '|| Str(pDPT_ID)  )
			On SAM_CreateComplete
				Set sNazn = "Автоматичне поповнення депозитного договору"
				Set TT = 'STD'
				Set Vob = 1
				Set Dk = 1
				Set nFreq = 5 
				Set WEND = 1 
				Set rbP = TRUE
				Call cmbFreq.SetSelectById( nFreq )
				Set Dat1 = bDat 
				!
				If SqlPrepareAndExecute( hSql(),
						 "SELECT c.rnk, c.nmk, c.okpo, d.acc, d.dat_end, v.LIMIT 
						  into :RNK,:NMK,:Okpo, :nAcc, :Dat2, :LIMIT
						  FROM customer c, dpt_deposit d, dpt_vidd v
						  WHERE d.deposit_id=:pDPT_ID and c.rnk=d.rnk and d.vidd=v.vidd " ) 
						and NOT SqlFetchNext( hSql(), nFetchRes )  
					Call SalWaitCursor(FALSE)
					Call SalMessageBox( "Не знайдено деп.договору ", "Увага ! ", MB_IconStop)
					Call SalDestroyWindow( DPT )
					Return FALSE
				! !!!!!!!!!!!!!!!!!!
				If SqlPrepareAndExecute( hSql(),
						 "SELECT IDD into :IDD FROM sto_det WHERE ids=:pDPT_ID" ) 
						and NOT SqlFetchNext( hSql(), nFetchRes )  
					!
					If SqlPrepareAndExecute( hSql(),
							"SELECT NLS, KV, substr(nms,1,38)
							 INTO :NlsB,:KvB,:Polu FROM accounts WHERE acc=:nAcc " ) 
							and NOT SqlFetchNext( hSql(), nFetchRes )  
						Call SalWaitCursor(FALSE)
						Call SalMessageBox( "Не знайдено деп.рахунку для зарахування", "Увага ! ", MB_IconStop)
						Call SalDestroyWindow( DPT )
						Return FALSE
					! !!!!!!!!
					Set Fsum =  LIMIT 
					If Dat2 = DATETIME_Null
						Set Dat2 = AddMonths( bDat, 12  )
					!
					Set nTmp = 0
					If SqlPrepareAndExecute(  hSql(),
							"SELECT nls from accounts WHERE dazs is null and rnk=:RNK 
							  and nls <>'"||NlsB ||"' and nbs='2620' and kv ="|| Str(KvB) || 
							" Order by ostc desc  INTO :sTmp " )
						While SqlFetchNext( hSql(), nFetchRes )
							Call SalListAdd( NlsA, sTmp )
							Set nTmp = nTmp + 1
						Set NlsA = sTmp
					If nTmp = 0
						Call SalWaitCursor(FALSE)
						Call SalMessageBox( 
								"Не знайдено жодного рахунку клієнта ('2620*') для списання", "Увага ! ", MB_IconStop)
						Call SalDestroyWindow( DPT )
						Return FALSE
					! !!!!!
				Else
					Call NASELENIE()
	Table Window: MON
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Оприбуткування монет та футлярів згідно накладної
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.013"
				Top:    0.042"
				Width:  16.467"
				Width Editable? Class Default
				Height: 7.44"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 2.488"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				! Шапка накладной
				Frame
					Resource Id: 21958
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.155"
						Width:  15.0"
						Width Editable? Yes
						Height: 1.0"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb_NBU
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Зовнішня (НБУ)
					Window Location and Size
						Left:   0.283"
						Top:    0.238"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Default
					Message Actions
						On SAM_CreateComplete
							Set rb_NBU = TRUE
							Set rb_GOU = TRUE
							Call F_NLS()
						On SAM_Click
							Call F_NLS()
				Radio Button: rb_GOU
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Внутрішня (ГОУ)
					Window Location and Size
						Left:   2.683"
						Top:    0.238"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Call F_NLS()
				Background Text: Накладна № 
					Resource Id: 21959
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.283"
						Top:    0.595"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Arial Greek
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Data Field: N_NAKLAD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.683"
							Top:    0.571"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Накладна № ')
				Background Text: Від 
					Resource Id: 21960
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.083"
						Top:    0.845"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: D_NAKLAD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.683"
							Top:    0.821"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Від ')
				Background Text: Підстава 
					Resource Id: 21961
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.683"
						Top:    0.595"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: P_NAKLAD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    0.571"
							Width:  8.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Підстава ')
				Background Text: Через 
					Resource Id: 21962
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.683"
						Top:    0.845"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: F_NAKLAD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    0.821"
							Width:  3.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Через  ')
				Background Text: Довіреність
					Resource Id: 21963
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   9.983"
						Top:    0.845"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: V_NAKLAD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.383"
							Top:    0.821"
							Width:  3.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Довіреність ')
				! Итоги накладной
				Pushbutton: pb_ITOG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.286"
						Top:    2.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\SUMM.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Розрахувати підсумок'
						On SAM_Click
							Call F_ITOG()
				Pushbutton: pb_Pay
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.786"
						Top:    2.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\EXECUTE.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Cyan
					Message Actions
						On SAM_Create
							Set strTip = 'Генерація проводок'
						On SAM_Click
							If F_PAY()
								Call SqlCommitEx( hSql(),'' )
				Data Field: REF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    1.821"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Референс док' )
						On SAM_SetFocus
							Set nTmpE = REF
						On SAM_AnyEdit
							Set REF = nTmpE
				!
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.286"
						Top:    2.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Aqua
					Message Actions
						On SAM_Create
							Set strTip = 'Роздрукувати тікет операцiї (ордера_'
						On SAM_Click
							If REF != NUMBER_Null 
								Call DocsPrint( REF, 'OPER', 0)
							Call SalWaitCursor(FALSE)
				Background Text: Усього
					Resource Id: 21964
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.283"
						Top:    1.179"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Data Field: I02
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.483"
							Top:    1.155"
							Width:  1.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Усього гр.2 
									"Кількість" ')
				Data Field: I03
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.583"
							Top:    1.155"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Усього гр.3
									 "Сума за номіналом" ')
				Data Field: I05_3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    1.155"
							Width:  1.833"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###0000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Усього гр.5
									"Сума без ПДВ та Ном" ')
				!
				Background Text: у т.ч.
					Resource Id: 21969
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.083"
						Top:    1.429"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Background Text: Разом без ПДВ
					Resource Id: 21968
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.483"
						Top:    1.429"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: I05_2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    1.405"
							Width:  1.833"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'у т.ч.
									"Разом без ПДВ" ')
				!
				Background Text: % ПДВ 
					Resource Id: 21967
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.483"
						Top:    1.679"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: PDV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    1.655"
							Width:  1.833"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'у т.ч.
									"ПДВ 20%" ')
				!
				Background Text: Номінальна вартість
					Resource Id: 21966
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.683"
						Top:    1.929"
						Width:  3.267"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: IT_03
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    1.905"
							Width:  1.833"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Номінальна вартість')
				!
				Background Text: Усього з ПДВ до сплати
					Resource Id: 21965
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.283"
						Top:    2.179"
						Width:  2.667"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: nITOG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.083"
							Top:    2.155"
							Width:  1.833"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Усього з ПДВ до сплати')
				Multiline Field: sITOG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						String Type: String
						Editable? No
					Display Settings
						Border? Yes
						Word Wrap? No
						Vertical Scroll? Yes
						Window Location and Size
							Left:   7.883"
							Top:    1.155"
							Width:  7.1"
							Width Editable? Yes
							Height: 1.25"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Усього на суму (словами)')
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.286"
						Top:    2.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set KOD = STRING_Null
							Set KOL = NUMBER_Null
							Set NAME = STRING_Null
							Set METAL = STRING_Null
							Set NOM = NUMBER_Null
							Set NOM_ITOG = NUMBER_Null
							Set CEN = NUMBER_Null
							Set CEN_ITOG = NUMBER_Null
							Set CEN_NBU = NUMBER_Null
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.786"
						Top:    2.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Нова накладна'
							Call F_Shap_0()
							Call F_ITOG_0()
						On SAM_Click
							Call F_Shap_0()
							Call F_ITOG_0()
							! чистка табл
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 33771
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.85"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If SetQueryFilter( MON.cF )
								! Call F_OPL1()
								Call SalWaitCursor(FALSE)
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.786"
						Top:    2.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Cyan
					Message Actions
						On SAM_Create
							Set strTip = 'Перегляд документу'
						On SAM_Click
							If REF >0 
								Call DocViewContentsEx(hWndForm, REF )
				Line
					Resource Id: 33772
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.683"
						Begin Y:  Class Default
						End X:  2.683"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.286"
						Top:    2.156"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 33773
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  0.7"
						Begin Y:  Class Default
						End X:  0.7"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dPdv
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.283"
							Top:    1.655"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pbF4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.286"
						Top:    2.156"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: F4
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF4.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'F4. Вибрати код виробу з довідника'
						On SAM_Click
							Call V_KOD(KOD)
		Contents
			Column: NPP   !!
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						пп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOD   !! А
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код 
						(F4)
						
						гр.А
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set KOD = SalStrUpperX( KOD )
						Call F_KOD(KOD)
					On SAM_DoubleClick
						Call V_KOD(KOD)
			Column: NAME  !! Б
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						
						
						гр.Б
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: METAL !! В
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Метал
						
						
						гр.В
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.35"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NOM      !! гр.1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Платіжний 
						номінал 1 шт.
						
						гр.1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL      !! гр.2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кількість
						шт
						
						гр.2
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_CENA()
			Column: NOM_ITOG !! гр.3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума за
						номіналом
						гр.3 = 
						гр.1 х гр.2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.543"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CEN      !! гр.4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ціна 1 шт без 
						ПДВ та Ном
						гр.4 = 
						(гр.6-гр.1) / 1.2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.867"
				Width Editable? Yes
				Format: ###0000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_CENA()
			Column: CEN_ITOG !! гр.5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума  без 
						ПДВ та Ном
						гр.5 = 
						гр.4 х гр.2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.883"
				Width Editable? Yes
				Format: ###0000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CEN_NBU  !! гр.6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ціна  з 
						ПДВ  та Ном 
						за 1 шт
						гр.6
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.7"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_CENA()
			!
		Functions
			Function: F_KOD
				Description:
				Returns
					Boolean:
				Parameters
					String: sKod
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(),
							"select  NAMEMONEY, NAMEMETAL, decode(PR_KUPON, null, NOMINAL, 0) 
							 into :MON.NAME, :MON.METAL,  :MON.NOM from SPR_MON
							where kod_money= :sKod " )
							and NOT SqlFetchNext( hSql(), nFetchRes )
						Set NAME = STRING_Null
						Set METAL = STRING_Null
						Set NOM = NUMBER_Null
						Set NOM_ITOG = NUMBER_Null
						Set CEN = NUMBER_Null
						Set CEN_ITOG = NUMBER_Null
						Call SalMessageBox('Неіснуючий код ' || sKod ,
								'Помилка !', MB_IconStop)
						Set KOD = STRING_Null
						Return FALSE
					Call F_CENA()
					Return TRUE
			Function: V_KOD
				Description:
				Returns
					Boolean:
				Parameters
					! Number: nKod
					Receive String: sKod
				Static Variables
				Local variables
					String: sTmp
					String: sTmp1
				Actions
					Set sTmp = STRING_Null
					Call FunNSIGetFiltered ("SPR_MON","NAME_MONEY", " 1=1 " ,sTmp,sTmp1 )
					If sTmp != STRING_Null
						Set sKod = sTmp
						Call F_KOD (sKod)
						Return TRUE
					Return FALSE
			!
			Function: F_CENA
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nCen
				Actions
					! гр.3
					If KOL > 0 and NOM != NUMBER_Null
						Set NOM_ITOG = NOM * KOL
					Else
						Set NOM_ITOG = NUMBER_Null
					! гр.4
					If rb_NBU
						If CEN_NBU > 0 and NOM != NUMBER_Null
							If CEN_NBU <= NOM
								Call SalMessageBox('Гр.6 НЕ може бути меншою за Гр.1 ' ,
										'Помилка !', MB_IconStop)
									Set CEN_NBU = NUMBER_Null
									Return FALSE
							! Set nCen = (CEN_NBU - NOM) / 1.2
							Set nCen = (CEN_NBU - NOM) / ( 1 + dPdv/100 )
							Set CEN = SalNumberRound( nCen*1000) / 1000
						Else
							Set CEN = NUMBER_Null
					Else
						Set nCen = CEN
					! гр.5
					If KOL >0 and CEN != NUMBER_Null
						Set nCen =  nCen * KOL
						Set CEN_ITOG = SalNumberRound( nCen*1000) / 1000
					Else
						Set CEN_ITOG = NUMBER_Null
					Return TRUE
			Function: F_Shap_0
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					! Шапка накладной
					Set N_NAKLAD = STRING_Null
					Set D_NAKLAD = DATETIME_Null
					Set P_NAKLAD = STRING_Null
					Set F_NAKLAD = STRING_Null
					Set V_NAKLAD = STRING_Null
					Set REF = NUMBER_Null
			Function: F_ITOG_0
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					! Итоги накладной
					Set I02 = 0
					Set I03 = 0
					Set I05_3 = 0
					Set I05_2 = 0
					Set PDV = 0
					Set IT_03 = 0
					Set nITOG = 0
					Set sITOG = STRING_Null
					Set nS1 = 0
					Set nS2a = 0
					Set nS2b = 0
					Set nS3 = 0
					Set nS4 = 0
					Call SalDisableWindow( pb_Pay )
					Call SalDisableWindow( pbPrint )
					Call SalEnableWindow( pb_ITOG )
			Function: F_ITOG
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nS
					Number: nRef
					String: NMSD
					String: NMSK
					String: sS
				Actions
					Call SalWaitCursor( TRUE )
					Call F_ITOG_0()
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If KOL > 0 and NOM_ITOG != NUMBER_Null and CEN_ITOG != NUMBER_Null
							Set I02= I02 + KOL
							Set I03= I03 + NOM_ITOG
							Set I05_3 = I05_3 + CEN_ITOG
							If METAL = 'супутня'
								Set nS3 = nS3 + CEN_ITOG * 100
							Else If NOM = 0
								Set nS2b = nS2b + CEN_ITOG * 100
							Else If NOM > 0
								Set nS2a = nS2a + CEN_ITOG * 100
					Set I05_2 = SalNumberRound( I05_3 *100 ) / 100
					Set PDV = SalNumberRound( I05_3 * dPdv ) / 100 
					Set IT_03 = I03
					Set nITOG = I05_2 + PDV + I03
					!
					Set nS1 = IT_03  * 100
					Set nS4 = PDV *100
					!
					Set sITOG = SumPr( nITOG *100, 'F', 'грн', 'коп.' )
					If nITOG > 0
						Call SalEnableWindow( pb_Pay )
					Call SalWaitCursor( FALSE )
					Return TRUE
			Function: F_NLS
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					Set dPdv = IifN( rb_NBU, 20, 0 )
					If SqlPrepareAndExecute( hSql(),
							"select substr(BRANCH_USR.GET_BRANCH_PARAM2('CASHS',0),1,14) ,
							        substr(nbs_ob22 ('3400','19'),1,14), 
							        substr(nbs_ob22 ('3522','51'),1,14),
							        substr(nbs_ob22 ('3500','07'),1,14), 
							        substr(nbs_ob22 ('3400','08'),1,14),
							        sysdate
							into :NLSD1, :NLSD3, :NLSD4, :NLSD2a, :NLSD2b, :DatS  from dual " )
							and NOT SqlFetchNext( hSql(), nFetchRes ) 
						Return FALSE
					If rb_NBU
						If SqlPrepareAndExecute( hSql(),
								"select substr(nbs_ob22 ('1819','03'),1,14) into :NLSK1 from dual " )
								and NOT SqlFetchNext( hSql(), nFetchRes ) 
							Return FALSE
						Set NLSK2 = NLSK1
						Set NLSK3 = NLSK1
						Set NLSK4 = NLSK1
						Call SalShowWindow( CEN_NBU )
						Call SalDisableWindow( CEN )
						Call SalTblSetColumnTitle( CEN, "Ціна 1 шт без 
								ПДВ та Ном
								
								гр.4 = ( 6 - 1) /(1+%)" )
					Else
						Call SalHideWindow( CEN_NBU )
						Call SalEnableWindow( CEN )
						Call SalTblSetColumnTitle( CEN, "Ціна 1 шт без 
								ПДВ та Ном" )
						If SqlPrepareAndExecute( hSql(),
								"select substr(nbs_ob22 ('3906','02'),1,14), 
								        substr(nbs_ob22 ('3902','11'),1,14) 
								 into :NLSK1, :NLSK3  from dual " )
								and NOT SqlFetchNext( hSql(), nFetchRes ) 
							Return FALSE
						Set NLSK2 = NLSK1
						Set NLSK4 = NLSK1
					!
					If SqlPrepareAndExecute( hSql(),
							"select substr(nms,1,38) into :NMSK from accounts where nls=:NLSK1 and kv=:n980 " )
							and NOT SqlFetchNext( hSql(), nFetchRes ) 
						Return FALSE
					Return TRUE
			Function: F_MON
				Description: Обновить свой локальный справочник монет 
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
					String: sNazn
					String: sNazn1
					!
					String: sKod
					Number: nKol
					Number: nNBU
					Number: nNIt
					Number: nCIt
					Number: nNom
					Number: nCen
					Number: nCen0
					String: sName
					String: sMet
				Actions
					Call SalWaitCursor( TRUE )
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						Set sKod = MON.KOD
						Set nKol = MON.KOL
						Set nNBU = MON.CEN_NBU
						Set nNIt = MON.NOM_ITOG
						Set nCIt = MON.CEN_ITOG
						Set nNom = MON.NOM
						Set nCen0= MON.CEN
						Set sName= MON.NAME
						Set sMet = MON.METAL
						!
						If nKol > 0 and nNIt != NUMBER_Null and nCIt != NUMBER_Null
							If rb_NBU
								Set nCen = nNBU * 100 
							Else
								Set nCen =( nCen0 *(1+nPdv) + nNom ) * 100 
							Set sNazn = sName ||' '|| sMet || ' Цiна=' ||  SalNumberToStrX( nCen/100, 2 )
							Set sNazn1= sNazn || ' накл.№ = ' || N_NAKLAD ||' вiд ' || SalFmtFormatDateTime( D_NAKLAD, 'dd/MM/yyyy' )
							Set nNom = nNom * 100 
							If NOT SqlPrepareAndExecute ( hSql(), 
									"insert into BANK_MON
									   (branch, 
									    KOD_NBU, 
									    NAME_MON, 
									    NOM_MON, 
									    CENA_NBU, 
									    NAME_,
									    TYPE, 
									    TYPE_MET, 
									    KOD,
									    CENA_NBU_OTP
									    ) 
									 select substr(SYS_CONTEXT('bars_context','user_branch'),1,8), 
									       :sKod,
									       :sName,
									       :nNom,
									       :nCen, 
									       Substr(:sNazn1, 1,100), 
									       decode(:sMet,'супутня',1,0),
									       0,          
									       (select nvl(max(kod),0) + 1 from BANK_MON),
									       PRICE*100 
									 from spr_mon  
									 where kod_money = :sKod 
									   and not exists (select 1 from BANK_MON where KOD_NBU=:sKod and CENA_NBU=:nCen)" )
								Return FALSE
					Call SalDisableWindow( pb_ITOG )
					Call SalDisableWindow( pb_Pay )
					Return TRUE
			Function: F_DEL
				Description:
				Returns
				Parameters
					Receive Number: nS
					Receive Number: nD
				Static Variables
				Local variables
				Actions
					If nD != 0
						Set nS = nS + nD
						Set nD = 0
			Function: F_PAY
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nS
					Number: nRef
					String: sTmpD
					Number: nDel
				Actions
					!
					If nITOG > 0
						Call F_NLS()
						Set nS = nITOG *100
						Set nDel = nS - nS1 - nS2a - nS2b - nS3 - nS4
						! дата док= системной
						Set NAZN =  NAZN1 || '№ ' || N_NAKLAD || ' Від ' || SalFmtFormatDateTime( D_NAKLAD, 'dd/MM/yyyy' )
						Call cDoc.SetDoc( 0, 'MF1', 1, nVob, Subs(N_NAKLAD,1,10),
								     DatS, DatS, dDat, dDat,
								     NLSD3, 'Монети,Футляри,ПДВ', aMfo,'', n980, nS, aOkpo,
								     NLSK1, NMSK, aMfo,'', n980, nS, aOkpo,
								     NAZN, '', GetIdOper(), '', NUMBER_Null, 0 )
						If NOT cDoc.oDoc()
							Return FALSE
						Set nRef = cDoc.m_nRef
						!
						! !! Проводки
						! M01 : GET_BRANCH_PARAM2('CASHS',   = NLSD1  -- каса - пл.номінал
						If nS1 >0 
							If NOT cDoc.PayV (0,nRef,dDat,'M01',1,n980,NLSD1,nS1,
									                                      n980,NLSK1,nS1)
								Return FALSE
						! M02 : nbs_ob22 ('3500','07'),1,14) = NLSD2a -- розрахунки з купўвлў-продажу ювўлейних монет з без пл.номіналом 
						If nS2a >0 
							Call F_DEL ( nS2a, nDel )
							If NOT cDoc.PayV (0,nRef,dDat,'M02',1,n980,NLSD2a,nS2a,
									                                      n980,NLSK2 ,nS2a)
								Return FALSE
						! M05 : nbs_ob22 ('3400','08'),1,14) = NLSD2b -- ювўлейнў монети без пл.номіналу 
						If nS2b >0 
							Call F_DEL ( nS2b, nDel )
							If NOT cDoc.PayV (0,nRef,dDat,'M05',1,n980,NLSD2b,nS2b,
									                                      n980,NLSK3 ,nS2b)
								Return FALSE
						! M03 : nbs_ob22 ('3400','19'),1,14) = NLSD3  -- футляри для ювўлейних монет
						If nS3 >0 
							Call F_DEL ( nS3, nDel )
							If NOT cDoc.PayV (0,nRef,dDat,'M03',1,n980,NLSD3,nS3,
									                                      n980,NLSK3,nS3)
								Return FALSE
						! M04 : nbs_ob22 ('3522','51'),1,14) = NLSD4  -- ПДВ  
						If nS4 >0 
							If NOT cDoc.PayV (0,nRef,dDat,'M04',1,n980,NLSD4,nS4,
									                                      n980,NLSK4,nS4)
								Return FALSE
						!
						! !! Доп.рекв.
						! VA_NC -> Накладна №  = N_NAKLAD
						Set sTmpD = IifS ( N_NAKLAD = STRING_Null , '__________', N_NAKLAD)
						If NOT SqlPrepareAndExecute(hSql(),"INSERT INTO operw(ref,tag,value ) VALUES (:nRef,'VA_NC',:sTmpD )" )
							Return FALSE
						! OBDT  -> від = D_NAKLAD
						Set sTmpD = IifS ( D_NAKLAD = DATETIME_Null, '__/__/20__', SalFmtFormatDateTime( D_NAKLAD, 'dd/MM/yyyy' ))
						If NOT SqlPrepareAndExecute(hSql(),"INSERT INTO operw(ref,tag,value ) VALUES (:nRef,'OBDT',:sTmpD )" )
							Return FALSE
						! PIDST -> Підстава 
						Set sTmpD = IifS ( P_NAKLAD = STRING_Null , '_______________', P_NAKLAD)
						If NOT SqlPrepareAndExecute(hSql(),"INSERT INTO operw(ref,tag,value ) VALUES (:nRef,'PIDST',:sTmpD )" )
							Return FALSE
						! FIO1  -> Через
						Set sTmpD = IifS ( F_NAKLAD = STRING_Null , '_______________', F_NAKLAD)
						If NOT SqlPrepareAndExecute(hSql(),"INSERT INTO operw(ref,tag,value ) VALUES (:nRef,'FIO1',:sTmpD )" )
							Return FALSE
						! GOLD  -> Довіреність
						Set sTmpD = IifS ( V_NAKLAD = STRING_Null , '_______________', V_NAKLAD)
						If NOT SqlPrepareAndExecute(hSql(),"INSERT INTO operw(ref,tag,value ) VALUES (:nRef,'GOLD',:sTmpD )" )
							Return FALSE
						!
						! !! обновить справочник
						If F_MON()
							Call SqlCommitEx( hSql(), NAZN1 || N_NAKLAD )
							Set REF = nRef
							Call SalEnableWindow( pbPrint )
							Return TRUE
						!
						Return FALSE
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: nId
			Date/Time: dDat
			Number: n980
			Number: nTmpE
			Number: nPdv
			Date/Time: DatS
			!
			String: sTmp
			String: aMfo
			String: aOkpo
			!
			: cDoc
				Class: cDoc
			Number: nVob
			String: NAZN1
			String: NAZN
			!
			String: NLSD1
			String: NLSK1
			String: NMSK
			Number: nS1
			!
			String: NLSD2a
			String: NLSD2b
			String: NLSK2
			Number: nS2a
			Number: nS2b
			!
			String: NLSD3
			String: NLSK3
			Number: nS3
			!
			String: NLSD4
			String: NLSK4
			Number: nS4
		Message Actions
			On SAM_Create
				Set nId  = GetUserId()
				!
				Set rb_NBU = TRUE
				Set dPdv = IifN( rb_NBU, 20, 0 )
				Set nPdv = 20/100
				Set dDat = GetBankDate()
				Set n980 = GetBaseVal()
				Set aMfo = GetBankMfo()
				Set aOkpo= GetBankOkpoS()
				Set MON.nTabInstance = 1
				Call ShowApdVersion('02')
				Call SalMapEnterToTab( TRUE )
				Set NAZN1 = 'Оприбуткування монет та футлярів згідно накладної'
				Set nVob=17
				Call SalDisableWindow( pb_Pay )
				Call SalDisableWindow( pbPrint )
				Call SalSetWindowText( hWndForm, NAZN1 )
				Set MON.strSqlPopulate ="SELECT rownum INTO :MON.NPP FROM ps WHERE rownum<100"
				Call SalTblSetLockedColumns( hWndForm, 1 )
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On UM_Close
				Call SalDestroyWindow(hWndForm)
	Table Window: SXO
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Сховищні операції
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.013"
				Top:    0.042"
				Width:  15.167"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.131"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_HIDE()
							Call SalEnableWindow( cmbAction )
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24734
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.85"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If SetQueryFilter( SXO.cF )
								Call F_OPL1()
								Call SalWaitCursor(FALSE)
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.317"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.75"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24735
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.683"
						Begin Y:  Class Default
						End X:  2.683"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24736
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  0.7"
						Begin Y:  Class Default
						End X:  0.7"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Combo Box: cmbAction
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   4.983"
						Top:    0.071"
						Width:  4.3"
						Width Editable? Yes
						Height: 3.821"
						Height Editable? Yes
					Visible? Yes
					Editable? No
					String Type: String
					Maximum Data Length: Default
					Sorted? Yes
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							Call F_TTS()
						On SAM_Click
							Set sTT = Subs(cmbAction,1,3)
							If F_OPL1()
								Call SalDisableWindow( cmbAction )
							Call SalWaitCursor(FALSE)
				Pushbutton: pbExecute2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати проект проводок вибраної операції'
						On SAM_Click
							If F_OPL2()
								Call SqlCommitEx( hSql(), strTip )
							Else
								Call SqlRollback( hSql() )
							Call SalWaitCursor(FALSE)
				Pushbutton: pbPrint2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\PRINT.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Роздрукувати оплачнні ордера'
						On SAM_Click
							Call F_PRN2()
							Call SalWaitCursor(FALSE)
				Data Field: NMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.483"
							Top:    0.071"
							Width:  3.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: RNK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.071"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Pushbutton: pbFIO1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: (none)
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Custclsd.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Salmon
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати ФО: Хто здає цінності'
						On SAM_Click
							Set sTmp=STRING_Null
							Call FunNSIGetFiltered ("PODOTCH", "FIO", "" , sTmp ,FIO1 )
				Data Field: FIO1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.783"
							Top:    0.405"
							Width:  4.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Pushbutton: pbFIO2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.283"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: (none)
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Custclsd.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати ФО: Хто отримує цінності'
						On SAM_Click
							Set sTmp=STRING_Null
							Call FunNSIGetFiltered ("PODOTCH", "FIO","" , sTmp ,FIO2 )
				Data Field: FIO2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.983"
							Top:    0.405"
							Width:  4.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pbBRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.783"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FRCENTER.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати Бранч-Кореспондент'
							Call SalHideWindow( pbBRANCH )
							Call SalHideWindow( NAME_BRANCH )
							Call SalHideWindow( KOD_BRANCH )
						On SAM_Click
							Set sTmpB=STRING_Null
							Call FunNSIGetFiltered 
									( sBR , 
									"NAME", IifS(sBR="BRANCH"," length(BRANCH)= 15 ","")||
									" ORDER BY " || sBR  , sTmpB ,NAME_BRANCH )
							If sTmpB=STRING_Null
								Set KOD_BRANCH= STRING_Null
								Set NAME_BRANCH= STRING_Null
							Else
								Set KOD_BRANCH = sTmpB
							Call F_OPL1()
							Call SalWaitCursor(FALSE)
				Data Field: NAME_BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.283"
							Top:    0.405"
							Width:  4.433"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: KOD_BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.783"
							Top:    0.071"
							Width:  2.967"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pb_KD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    0.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\K.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Вибрати КД '
						On SAM_Click
							! !
							Set sTmpKD = STRING_Null
							Set sTmpKD2 = STRING_Null
							Call FunNSIGet ( TabName , "NMK" , sTmpKD, sTmpKD2 )
							If sTmpKD != STRING_Null
								If SqlPrepareAndExecute( hSql(),
										"select 'КД № ' || trim(cc_id) || ' вiд ' || to_char(sdate,'dd.mm.yyyy') 
										 into :sTmpKD3 from cc_deal where nd = " || sTmpKD )
										and SqlFetchNext( hSql(), nFetchRes )
									Set sTmpKD2 = sTmpKD3 || ' ' || SalStrTrimX( sTmpKD2 ) || '.'
				Data Field: sTmpKD2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.783"
							Top:    0.738"
							Width:  8.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: OB22
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код 
						цінності
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва  цінності
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кількість
						шт
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.Дебет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План.зал.
						шт -Деб
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.Кредит
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План.зал.
						шт - Крд
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Призначення пл
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  5.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REF > 0
							Call DocViewContentsEx(hWndForm, REF )
		Functions
			Function: F_TTS
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTTX
				Actions
					Call F_HIDE()
					If SqlPrepareAndExecute( hSql(),
							"SELECT  tt||'-'||name, tt  INTO :sTmp, :sTTX FROM tts
							 WHERE ( substr(flags,64,1) = '0'  or tt in ('VSK','VSL') ) and tt like 'VS_' and tt <>'VS*' " )
						While SqlFetchNext( hSql(), nFetchRes )
							If TabName = 'CC_PD9' and 
									( sTTX = 'VS1' or  sTTX = 'VS2' or 
									  sTTX = 'VSK' or  sTTX = 'VSL' )
								Call SalListInsert (cmbAction,0,sTmp )
							Else If TabName != 'CC_PD9' and sTTX != 'VSK' and  sTTX != 'VSL' 
								Call SalListInsert (cmbAction,0,sTmp )
			Function: F_HIDE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalHideWindow( pbFIO1 )
					Call SalHideWindow( FIO1 )
					Call SalHideWindow( pbFIO2 )
					Call SalHideWindow( FIO2 )
					Set FIO1 = STRING_Null
					Set FIO2 = STRING_Null
					!
					Set sTmpKD2 = STRING_Null
					Set sTmpKD3 = STRING_Null
					Set sTmpKD = STRING_Null
					!
					Call SalHideWindow( RNK )
					Call SalHideWindow( NMK )
			Function: F_OPL1
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sSql0
					String: sFilter
					String: sSql2
					String: sNazn1
					String: sNazn
					String: NLS99
					String: NLS989
					String: sSqlV
					! String: NLS98S
				Actions
					Set NLS99 = "Substr(GetAccNumb('NLS_9910'),1,14)"
					Set NLS989 = "substr(VA_989(OB22,:RNK),1,14)"
					! вибрати VOB операції
					If SqlPrepareAndExecute( hSql(),"select vob into :nVob from TTS_VOB where tt=:sTT and rownum=1" )
							and NOT SqlFetchNext( hSql(), nFetchRes )
						Set nVob = 222
					! вибрати "під-звітну особу"
						! 
								VS6-6/Видача цінностей в підзвіт
								VS9-9/Списання цінностей з підзвіту
								VSK-VSK Видача цiнностей КД в пiдзвiт
								VSL-VSL Повернення цiнностей КД з пiдзвiту
								VS5---  Прийняти з підзвіту
					If sTT='VS6' or sTT='VS9' or sTT='VSK' or sTT='VSL' or sTT='VS5' or sTT='VSM' 
						Call SalShowWindow( RNK )
						Call SalShowWindow( NMK )
						Set sTmp = STRING_Null
						Call FunNSIGetFiltered ("PERSON_989","FIO", "",sTmp, NMK )
						If sTmp = STRING_Null
							Return FALSE
						Set RNK= Val(sTmp) 
						If sTT='VS9' or sTT='VSL' or sTT='VS5' 
							Set FIO1 = NMK
						Else If sTT='VS6' or sTT='VSK' or sTT='VSM'
							Set FIO2 = NMK
					! Пропозиція по розширенню функції "Сховище. 
							Операції з цінностями" для centura.
							Для виконання  операцій VS3, VS4, VS6, VS9 
							підкріплення сховищем банку сховищ ТВБВ 2 рівня  
							надати можливість вибору ТВБВ 2 рівня для відповідного 
							визначення рахунків :
							VS3 (9899_ОВ22,9893_ОВ22,9891_ОВ22)   --VS3 Прийняти цінності нові  з дороги 
							VS4 (9899_ОВ22,9893_ОВ22,9891_ОВ22)   --VS4 Видати нові в дорогу
							VS6 (9892_ОВ22_FF,9898_ОВ22,9890_ОВ2) --VS6 Видати нові в підзвіт
							VS9 (9892_ОВ22_FF,9898_ОВ22,9890_ОВ22)--VS9 Списати  з підзвіту на 9910
					! If sTT='VS3' OR sTT='VS4' OR sTT='VS6' OR sTT='VS9'  
					If sTT='VS3' OR sTT='VS4' OR sTT='VSA' OR sTT='VSB'   
						Call SalShowWindow( pbBRANCH )
						Call SalShowWindow( NAME_BRANCH )
						Call SalShowWindow( KOD_BRANCH )
					Else
						Call SalHideWindow( pbBRANCH )
						Call SalHideWindow( NAME_BRANCH )
						Call SalHideWindow( KOD_BRANCH )
					!
					Call SalWaitCursor(TRUE)
					Set sNazn1 = Subs(cmbAction,7,40)
					!
					! VS1 Оприбуткувати цінності з 9910
					If sTT='VS1' 
						Set SXO.strSqlPopulate = "nls_9819 DEB," || NLS99 || " KRD "
						Call SalShowWindow( pbFIO1 )
						Call SalShowWindow( FIO1 )
					!
					! VSK-VSK Видача цiнностей КД в пiдзвiт
					Else If sTT='VSK' 
						Set SXO.strSqlPopulate = NLS989 || " DEB, nls_9819 KRD " 
						! Call SalShowWindow( pbFIO1 )
						Call SalShowWindow( FIO1 )
					!
					! VSL-VSL Повернення цiнностей КД з пiдзвiту
					Else If sTT='VSL' 
						Set SXO.strSqlPopulate = " nls_9819 DEB, " || NLS989 || " KRD " 
						Call SalShowWindow( FIO2 )
					!
					! VS2 Списати цінності на 9910
					Else If sTT='VS2'
						Set SXO.strSqlPopulate = NLS99 || " DEB, nls_9819 KRD "
						Call SalShowWindow( pbFIO2 )
						Call SalShowWindow( FIO2 )
					!
					! VS3 Прийняти цінності нові  з дороги 
					Else If sTT='VS3'
						Set SXO.strSqlPopulate =" nls_9819 DEB, NLS_9899 KRD "
						Call SalShowWindow( pbFIO1 )
						Call SalShowWindow( FIO1 )
						Call SalShowWindow( pbFIO2 )
						Call SalShowWindow( FIO2 )
					!
					! VSA Прийняти сплаченi/використ з дороги 
					Else If sTT='VSA'
						Set SXO.strSqlPopulate =" nls_9812 DEB, nls_9899spl KRD "
						Call SalShowWindow( pbFIO1 )
						Call SalShowWindow( FIO1 )
						Call SalShowWindow( pbFIO2 )
						Call SalShowWindow( FIO2 )
					!
					! VS4 Видати нові в дорогу
					Else If sTT='VS4'
						Set SXO.strSqlPopulate =" NLS_9899 DEB, nls_9819 KRD "
						Call SalShowWindow( pbFIO1 )
						Call SalShowWindow( FIO1 )
						Call SalShowWindow( pbFIO2 )
						Call SalShowWindow( FIO2 )
					!
					! VSB Видати сплаченi/використ в дорогу
					Else If sTT='VSB'
						Set SXO.strSqlPopulate =" nls_9899spl DEB, nls_9812 KRD "
						Call SalShowWindow( pbFIO1 )
						Call SalShowWindow( FIO1 )
						Call SalShowWindow( pbFIO2 )
						Call SalShowWindow( FIO2 )
					!
					! VS6 - 6/Видача цінностей в підзвіт
					Else If sTT='VS6' 		
						Set SXO.strSqlPopulate = NLS989 || " DEB, nls_9819 KRD " 
						Call SalShowWindow( pbFIO1 )
						Call SalShowWindow( FIO1 )
						Call SalShowWindow( pbFIO2 )
						Call SalShowWindow( FIO2 )
					Else If sTT='VSM' 
						Set SXO.strSqlPopulate = NLS99 || " DEB, nls_9819 KRD " 
						Call SalShowWindow( pbFIO1 )
						Call SalShowWindow( FIO1 )
						Call SalShowWindow( pbFIO2 )
						Call SalShowWindow( pbFIO2 )
					! VS5 - 5/повернення цiнностей з пiд-звiту
					Else If sTT='VS5' 
						Set SXO.strSqlPopulate = " nls_9819 DEB, " || NLS989 || " KRD " 
						Call SalShowWindow( pbFIO1 )
						Call SalShowWindow( FIO1 )
						Call SalShowWindow( pbFIO2 )
						Call SalShowWindow( FIO2 )
					!
					! VS9 9/Списання цінностей з підзвіту
					Else If sTT='VS9'
						Set SXO.strSqlPopulate = NLS99 || " DEB, " || NLS989 || " KRD "
						Call SalShowWindow( pbFIO2 )
						Call SalShowWindow( FIO2 )
					!
					! VSC Списання сплаченi/використ на 9910
					Else If sTT='VSC'
						Set SXO.strSqlPopulate = NLS99 || " DEB, nls_9812 KRD "
						Call SalShowWindow( pbFIO2 )
						Call SalShowWindow( FIO2 )
					!
					! !! VSD Видати цінності  з ОПЧ  в підзвіт
					Set sFilter = ""
					Set sFilter = cF.GetFilterWhereClause( FALSE )
					Set sSqlV =
							"(Select ob22, " || SXO.strSqlPopulate || " 
							  from VALUABLES_NLS where ob22 is not null " ||
							  IifS( sFilter="", ""," and " ||sFilter ) || 
							  IifS (strFiltr="", "", " and "|| strFiltr) ||
							") "
					Set sSql0 = 
							"SELECT k.OB22, k.name, v.DEB, v.KRD, Substr( :sNazn1 || '.' || k.NAME, 1,160) 
							 INTO :SXO.OB22,  :SXO.NAME, :SXO.NLSD, :SXO.NLSK, :SXO.NAZN
							 FROM VALUABLES k, " || sSqlV || " v
							 WHERE k.OB22=v.OB22 and v.deb is NOT null and v.krd is NOT null 
							 ORDER BY v.OB22 " 
					!
					Return 
							SalTblPopulate(hWndForm, hSql(), sSql0, TBL_FillAll )
			Function: F_OPL2
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nS
					Number: nRef
					String: NMSD
					String: NMSK
					String: sS
				Actions
					Call SalWaitCursor( TRUE )
					Set nRow = TBL_MinRow
					If TabName = 'CC_PD9' and sTmpKD = STRING_Null
						If sTmpKD = STRING_Null
							Call SalMessageBox('Не вибрано Кредитну справу ! ' ,
									'Увага, помилка !', MB_IconStop)
							Return FALSE
						Else
					! !!!!!
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If KOL != NUMBER_Null and KOL>0 
								and NLSD !=STRING_Null and NLSK !=STRING_Null 
								and REF = NUMBER_Null
							Set nS = KOL *100
							Call SalTblSetRowFlags( hWndForm, nRow, ROW_Edited, FALSE )
							If SqlPrepareAndExecute(hSql(),
									 "select substr(d.nms,1,38),substr(k.nms,1,38) 
									  into :NMSD, :NMSK 
									  from accounts d, accounts k 
									  where d.kv=:n980 and k.kv=:n980 and d.nls=:NLSD and k.nls=:NLSK")
									and SqlFetchNext(hSql(), nFetchRes)
								Call cDoc.SetDoc( 0, sTT, 1, nVob, STRING_Null, tDat, tDat, dDat, dDat,
										     NLSD, NMSD, aMfo,'', n980, nS, aOkpo,
										     NLSK, NMSK, aMfo,'', n980, nS, aOkpo,
										     Subs( sTmpKD2 || NAZN,1,160),
										     '', GetIdOper(), '', NUMBER_Null, 0 )
								If NOT cDoc.oDoc()
									Return FALSE
								Set REF = cDoc.m_nRef
								Set nRef = cDoc.m_nRef
								If TabName = 'CC_PD9' 
									If NOT SqlPrepareAndExecute( hSql(),
											"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'ND ',:sTmpKD )" )
										Return FALSE
								Set sS= SalNumberToStrX( KOL, 2 )
								! 1)Для прих позаб орд Вместо FIO1 -> VLASN, PO_S1 -> SUMGD
								If nVob = 120  ! приходного 
									If NOT
											 (  SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'GOLD ',:NAME )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_K1',:KOL )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_KK',:KOL )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'SUMGD',:sS )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'VLASN',:FIO1 )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'FIO2',:FIO2 )" )
											  )
										Return FALSE
								! 1)Для расх позаб орд Вместо FIO2 -> VLASN, PO_S1 -> SUMGD
								Else If nVob = 121 ! расходного
									If NOT
											 (  SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'GOLD ',:NAME )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_K1',:KOL )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_KK',:KOL )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'SUMGD',:sS )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'FIO1',:FIO1 )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'VLASN',:FIO2 )" )
											  )
										Return FALSE
								Else ! другое как и было
									If NOT
											 (  SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_N1',:NAME )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_K1',:KOL )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_KK',:KOL )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'PO_S1',:sS )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'FIO1',:FIO1 )" )
											and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref, tag,value ) VALUES (:nRef,'FIO2',:FIO2 )" )
											  )
										Return FALSE
					!
					Set sTmpKD = STRING_Null
					Return TRUE
			Function: F_PRN2
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nS
					Number: nRef
					String: NMSD
					String: NMSK
					String: sS
				Actions
					Call SalWaitCursor( TRUE )
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If REF != NUMBER_Null 
							Call DocsPrint( REF, 'OPER', 0)
					!
					Return TRUE
		Window Parameters
			Number: nMode
			Number: nPar
			String: strFiltr1
			String: strPar02 
		Window Variables
			Number: nId
			String: strFiltr
			Date/Time: dDat
			Date/Time: tDat
			Number: n980
			!
			String: sTmpKD
			String: sTmpKD3
			! String: sTmpKD2
			String: sTT
			String: sTmp
			String: sBRANCH
			String: sSqlH
			String: aMfo
			String: aOkpo
			String: sTmpB
			String: sTmpT
			String: sSql1
			String: sBR
			: cDoc
				Class: cDoc
			!
			String: TabName
			Number: nVob
		Message Actions
			On SAM_Create
				Set nId  = GetUserId()
				Set dDat = GetBankDate()
				Set tDat = SalDateCurrent(  )
				Set n980 = GetBaseVal()
				Set aMfo = GetBankMfo()
				Set aOkpo= GetBankOkpoS()
				Set SXO.nTabInstance = 1
				Call ShowApdVersion('01')
				Set strFiltr = SalStrTrimX( strFiltr1 )
				Set SXO.strFilterTblName = 'VALUABLES_NLS'
				!
				Call SalHideWindow( pb_KD )
				Call SalHideWindow( pb_KD )
				Set sTmpKD = STRING_Null
				If nHaveTOBO = 2
					Set sBR = 'BRANCH'
					If SqlPrepareAndExecute(hSql(), "SELECT Substr(SYS_CONTEXT('bars_context','user_branch') ,1,30) INTO :sBRANCH FROM dual")
							and SqlFetchNext(hSql(), nFetchRes)
					Set TabName = SalStrTrimX(strPar02) 
					! ! Кредитні справи  TabName = 'CC_PD9'
					If TabName = 'CC_PD9'
						Call SalShowWindow( pb_KD )
						Call SalShowWindow( sTmpKD2 )
				Else
					Set sBR = 'TOBO'
					Set sBRANCH = SalStrTrimX(strPar02) 
					If sBRANCH = ''
						Set sBRANCH = '0' 
					If SqlPLSQLCommand( hSql(),"PUL.Set_Mas_Ini( 'BRANCH', sBRANCH, 'Код бранчу(ТОБО) для сховища' )" )
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On SAM_FetchRowDone
				If sTmpB != STRING_Null 
						and  ( sTT='VS3' OR sTT='VS4' OR sTT='VSA' OR sTT='VSB' )
					If sTT='VS3' OR  sTT='VSA'
						If SqlPrepareAndExecute( hSqlAux2(),
								"select a.nls 
								   into :NLSK 
								   from accounts a, valuables v 
								 where a." || sBR || " = :sTmpB 
								   and a.ob22=decode(:sTT,'VS3',v.OB22_DOR,v.OB22_DORS) 
								   and a.nbs= decode(substr(v.ob22,1,4), '9821', '9893', '9820','9891','9899') 
								   and v.ob22=:OB22 and a.dazs is null" )
								and NOT SqlFetchNext( hSqlAux2(), nFetchRes )
							Call XSalTblSetCellBackColor( NLSK, SalColorFromRGB( 255,210,210 ) )
							Set NLSK=STRING_Null
					Else If sTT='VS4' OR  sTT='VSB'
						If SqlPrepareAndExecute( hSqlAux2(),
								"select a.nls
								   into :NLSD 
								   from accounts a, valuables v 
								  where a." || sBR || " = :sTmpB 
								    and a.nbs= decode(substr(v.ob22,1,4), '9821', '9893', '9820','9891','9899')
								    and a.ob22=decode(:sTT,'VS4',v.OB22_DOR,v.OB22_DORS) 
								    and v.ob22=:OB22 and a.dazs is null" )
								And NOT SqlFetchNext( hSqlAux2(), nFetchRes )
							Call XSalTblSetCellBackColor( NLSD, SalColorFromRGB( 255,210,210 ) )
							Set NLSD=STRING_Null
				If SqlPrepareAndExecute( hSqlAux2(),
						"select - ostb/100
						 into :OSTD from accounts where kv=:n980 and nls= :NLSD ") 
						and NOT SqlFetchNext( hSqlAux2(), nFetchRes )
				If SqlPrepareAndExecute( hSqlAux2(),
						"select - ostb/100
						 into :OSTK from accounts where kv=:n980 and nls= :NLSK ") 
						and NOT SqlFetchNext( hSqlAux2(), nFetchRes )
	Table Window: BRK
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Заявка казначейства на ресурсы и его цену
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.163"
				Top:    0.479"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.512"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pb_Pred
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\REP_JOIN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Дублировать заявки предыдущего дня'
						On SAM_Click
							If SqlPrepareAndExecute( hSql(), 
									"insert into BR_KAZ( FDAT, KV, S_min, s_max, DNI, IR, pap) 
									   select           :bDat, KV, S_min, s_max, DNI, IR, pap 
									   from BR_KAZ 
									   where FDAT = (select max(FDAT) from BR_KAZ where FDAT < :bDat ) 
									     and (:bDat,KV,DNI,PAP) not in (select FDAT,KV,DNI,PAP from BR_KAZ ) " )
								Call SqlCommit(hSql())
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть договора портфеля выбранной строки'
						On SAM_Click
							Call Sel002(hWndMDI,26,9,
									" and to_char(d.sdate,'yyyyMMdd')='"|| yyyyMMdd ||"' and a.kv="||Str(KV),
									" ")
				Pushbutton: pb_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть все действующие договора портфеля'
						On SAM_Click
							Call Sel002(hWndMDI,26,9," and d.sos<14 "," ")
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Line
					Resource Id: 46027
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.75"
						Begin Y:  -0.012"
						End X:  5.783"
						End Y:  0.405"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 46028
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.183"
						Begin Y:  0.071"
						End X:  4.183"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 46029
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_DAT()
					On SAM_KillFocus
						Call F_DAT()
					On SAM_SetFocus
						If FDAT = DATETIME_Null
							Set FDAT = bDat
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			Column: NAM_VAL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Валюта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			Column: S_MIN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Min
						сумма
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_SUM()
					On SAM_KillFocus
						Call F_SUM()
			Column: S_MAX
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Max
						сумма
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_SUM()
					On SAM_KillFocus
						Call F_SUM()
			Column: DNI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: MAX
						дней
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Max
						% ст
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S_FAKT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						фактич
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_SUM()
					On SAM_KillFocus
						Call F_SUM()
			Column: I_FAKT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.
						взв.
						% ст
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
				! List Values 
				! Message Actions 
			Column: T_FAKT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд-
						взв.
						срок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						дог
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			Column: DKOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						доср.
						расторг.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			!
			Column: RI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Rowid
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			Column: yyyyMMdd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ---
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
		Functions
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If FDAT < bDat 
						Set FDAT = bDat 
			Function: F_KV
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set sTmp = STRING_Null
					Call FunNSIGetFiltered
							("TABVAL","NAME",
							  " D_CLOSE is null ",sTmp,NAM_VAL)
					If sTmp != STRING_Null
						Set KV=Val(sTmp)
			Function: F_SUM
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If S_MIN != NUMBER_Null and  S_MAX != NUMBER_Null and S_MIN>S_MAX
						Call SalMessageBox("Min-Сумма БОЛЬШЕ Max-Суммы",
								"Внимание, ошибка !", MB_IconStop)
						Set S_MAX = S_MIN
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sSql
			String: aMfo
			Number: n980
			Date/Time: bDat
			String: sTmp
			String: sFilter_SOS
			Number: nUser
			Number: ACRA
			String: sFilter
			Number: nMod_Int
			Date/Time: FDAT0
			Number: DNI0
			Number: KV0
		Message Actions
			On SAM_Create
				Set BRK.nTabInstance = 1
				Set BRK.strPrintFileName = 'BRK'
				! Set BRK.strFilterTblName = 'BRK'
				!
				Set aMfo = GetBankMfo()
				Set BRK.bDat = GetBankDate()
				Set n980 = GetBaseVal()
				Set nUser = GetUserId()
				!
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 7 )
				Set BRK.sSql = 
						"select to_char(b.FDAT,'yyyyMMdd'), 
						      b.FDAT, b.KV, b.S_MIN, b.S_MAX, b.DNI, b.IR, t.NAME, b.RI 
						 INTO :BRK.yyyyMMdd, :BRK.FDAT, :BRK.KV, 
						      :BRK.S_MIN, :BRK.S_MAX, :BRK.DNI, :BRK.IR, :BRK.NAM_VAL, :BRK.RI
						 from (SELECT FDAT, KV, S_min, S_max, DNI, IR, rowid RI
						       from BR_KAZ  where pap=2  order by FDAT desc, kv desc, dni) b, 
						       tabval t
						 where B.kv=t.kv and rownum<101 "
				! Set BRK.strSqlPopulate = 
						"SELECT to_char(BR_KAZ.FDAT,'yyyyMMdd'), BR_KAZ.FDAT, BR_KAZ.KV, 
						        BR_KAZ.S_min, BR_KAZ.S_max,  BR_KAZ.DNI, BR_KAZ.IR, 
						        t.name, BR_KAZ.rowid
						 INTO :BRK.yyyyMMdd, :BRK.FDAT, :BRK.KV, 
						      :BRK.S_MIN, :BRK.S_MAX, :BRK.DNI, :BRK.IR, :BRK.NAM_VAL, :BRK.RI
						 from BR_KAZ, tabval t
						 where BR_KAZ.kv=t.kv and BR_KAZ.pap=2    
						 order by BR_KAZ.FDAT desc, BR_KAZ.kv desc, BR_KAZ.dni "
				Set BRK.strSqlInsert =
						"insert into BR_KAZ(FDAT,KV,S_min,s_max, DNI, IR, pap) values 
						   (:BRK.FDAT,:BRK.KV,:BRK.S_MIN,:BRK.S_MAX, :BRK.DNI, :BRK.IR,2)"
				Set BRK.strSqlDelete = 
						"delete from BR_KAZ where fdat>= :BRK.bDat
						  and FDAT=:BRK.FDAT and KV=:BRK.KV and dni=:BRK.DNI and pap=2 "
				Set BRK.strSqlUpdate = 
						"update BR_KAZ set s_min=:BRK.S_MIN, s_max=:BRK.S_MAX, dni=:BRK.DNI, ir=:BRK.IR, kv=:BRK.KV 
						  where fdat>= :BRK.bDat and rowid= :BRK.RI "
				Set FDAT0= bDat-1000
				Set DNI0= 0
				Set KV0=0
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				If nPar = 0
					Call SalHideWindow( BRK.pbIns )
					Call SalHideWindow( BRK.pbUpdate )
					Call SalHideWindow( BRK.pbDel )
					Call SalHideWindow( BRK.pbDetails )
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call SalTblPopulate(hWndForm, hSql(), BRK.sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If BRK.FDAT < bDat
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
				If FDAT0 != FDAT or KV0 != KV
					Set DNI0 = 0
					Set FDAT0 = FDAT 
					Set KV0 = KV
				If SqlPrepareAndExecute( hSqlAux2(), 
						"select Nvl(sum(d.LIMIT),0), count(*), 
						  decode (Nvl(sum(d.limit),0),0,0, 
						          Round(sum(d.limit*d.ir)/sum(d.limit),4)),
						  decode (Nvl(sum(d.limit),0),0,0, 
						          Round(sum(d.limit*(d.wdate-d.sdate))/sum(d.limit),0))  
						 into :S_FAKT, :KOL, :I_FAKT, :T_FAKT
						 from cc_deal d, nd_acc n, accounts a
						 where d.vidd=26 and d.sdate=:FDAT and d.nd=n.nd 
						   and n.acc=a.acc and a.kv=:KV and d.sos<>14 and 
						   (d.wdate-d.sdate) > :DNI0 and (d.wdate-d.sdate) <= :DNI " )
						and  SqlFetchNext( hSqlAux2(), nFetchRes) 
				If SqlPrepareAndExecute( hSqlAux2(), 
						"select count(*) into :DKOL
						 from cc_deal d, nd_acc n, accounts a
						 where d.vidd=26 and d.sdate=:FDAT and d.nd=n.nd 
						   and n.acc=a.acc and a.kv=:KV and d.sos=14 and 
						   (d.wdate-d.sdate) > :DNI0 and (d.wdate-d.sdate) <= :DNI " )
						and  SqlFetchNext( hSqlAux2(), nFetchRes) 
				If DKOL >0
					Call XSalTblSetCellBackColor( DKOL, SalColorFromRGB( 255,210,210 ) )
				!
				Set DNI0 = DNI
	Table Window: BR1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Брон.средств на сч.ХО
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.163"
				Top:    0.479"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.702"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Открыть Новый договор с Клиентом '
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Удалить новый договор с Клиентом '
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть счета по договору'
						On SAM_Click
							If Not SalIsNull( ACC )
								If not SalIsNull(ACRA) 
									Set sTmp=" a.acc in ("||Str(ACC)||","||Str(ACRA) ||")"  
								Else
									Set sTmp=" a.acc ="||Str(ACC)   
								Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
				Pushbutton: pbKAZ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\K.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = "Просмотреть казначейскую заявку"
						On SAM_Click
							If not IsWindow(hWin24)
								Set hWin24 = SalCreateWindow( BRK, hWndMDI,24,0, " "," " )
							Else
								Call SalBringWindowToTop ( hWin24 )
				!
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						! On SAM_Create
							                                                                                                                                                                                                                                                                                                                                         Set strTip = 'Печать договора '
						! On SAM_Click
							! Call PrintFAKTORData()
				Pushbutton: pb_Kli ! Паспорт клиента
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Паспорт Клиента (просмотр)'
						On SAM_Click
							If RNK >0
								Call EditCustCorps( RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
				Pushbutton: pb_PUSTO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Line
					Resource Id: 4408
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.75"
						Begin Y:  -0.012"
						End X:  5.783"
						End Y:  0.405"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 4409
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.183"
						Begin Y:  0.071"
						End X:  4.183"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 4410
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbDoc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Tomail.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Документы договора'
						On SAM_Click
							Call Print_RTF ()
							! Call cdoc_ShowAllDocs(ND, hWndForm)
				Pushbutton: pb_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть архив договоров '
							If nPar = 9
								Call SalHideWindow( pb_All )
						On SAM_Click
							Call SalCreateWindow( BR1, hWndMDI,26,9, "","" )
				! Frame
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.083"
						Top:    0.071"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
.end
				! ctb_pbExecute: pb_Nach
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.283"
						Top:    0.155"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: C:\bars98\RESOURCE\BMP\A_INTS.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Light Green
.end
					                                                                                                                                                                                                                                                                                                                               Message Actions 
				! ctb_pbExecute: pb_Vypl
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.783"
						Top:    0.155"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: C:\bars98\RESOURCE\BMP\A_INTS.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Sky
.end
					                                                                                                                                                                                                                                                                                                                               Message Actions 
						                                                                                                                                                                                                                                                                                                                               On SAM_Create
							                                                                                                                                                                                                                                                                                                                               Set strTip = 
									'Капитализация % за бронь по закрывающимся '|| 
									SalFmtFormatDateTime( bDat, 'dd.MM.yyyy' )|| ' договорам'
							                                                                                                                                                                                                                                                                                                                               If nPar != 4 
								                                                                                                                                                                                                                                                                                                                               Call SalDisableWindow( pb_Vypl )
						                                                                                                                                                                                                                                                                                                                               On SAM_Click
				Frame
					Resource Id: 64564
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.883"
						Top:    0.071"
						Width:  9.3"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Ввод,Корр
					Window Location and Size
						Left:   7.083"
						Top:    0.155"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 1
							Call F_Start ()
				Radio Button: rb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Согласование
					Window Location and Size
						Left:   8.783"
						Top:    0.155"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 2
							Call F_Start ()
				Radio Button: rb3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Активация
					Window Location and Size
						Left:   10.683"
						Top:    0.155"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 3
							Call F_Start ()
				Radio Button: rb4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Сопровожнение
					Window Location and Size
						Left:   12.383"
						Top:    0.155"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 4
							Call F_Start ()
				Radio Button: rb9
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Анализ
					Window Location and Size
						Left:   14.383"
						Top:    0.155"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 9
							Call F_Start ()
		Contents
			Column: TOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Branch
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: INSP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						инсп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						сост
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sSOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сост
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Согл
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If SOS = 0 and nPar=1 and F_VISA2()
						Else If SOS = 2 and nPar=2 and F_VISA6()
						Else If SOS = 6 and nPar=3 and F_VISA10()
						Else If SOS = 10 and nPar=4 and F_VISA15()
						Else
							Set OTM =0 
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
						!
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег№
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_RNK()
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_RNK()
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Идент.
						Договора
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						Дог
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						 Нач
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_DAT()
					On SAM_KillFocus
						Call F_DAT()
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						кон
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_DAT()
					On SAM_KillFocus
						Call F_DAT()
			Column: DNI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дней
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If nPar = 1 and (SOS = NUMBER_Null or SOS = 0) and RNK != NUMBER_Null
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered
									("ACCOUNTS","NLS", 
									" rnk="||Str(RNK)||
									" and dazs is null and pap=2 and nbs in ('2600','2650') and nvl(lim,0)=0 "
									|| sTOBO || 
									" and acc in (select acc from int_accn where id=1) ",sTmp,NLS)
							If sTmp != STRING_Null
								If SqlPrepareAndExecute( hSql(),
										"SELECT tobo, kv, ACC, ostc/100 into :TOBO, :KV, :ACC, :OSTC 
										 from accounts 
										 where acc="|| sTmp )
										and SqlFetchNext(hSql(), nFetchRes)
								If ND != NUMBER_Null
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE )
							! Call F_NLS()
			Column: OSTC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущая
						остаток
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: IR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Согл.
						% ст
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_IR()
					On SAM_KillFocus
						Call F_IR()
			Column: LIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Неснижаемый
						остаток
						по Договору
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If LIMIT = NUMBER_Null
							Set LIMIT = 0
			!
			Column: LIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Неснижаемый
						остаток
						фактический
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If LIMIT = NUMBER_Null
							Set LIMIT = 0
			Column: ACR_DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата, по кот.
						уже начисл.
						%
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_DAT()
					On SAM_KillFocus
						Call F_DAT()
			Column: OSTP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тек.
						остаток
						нач.%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Прогноз
						% за 
						броню
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACRA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACRA
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						нач%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						Капитал
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REF > 0
							Call DocViewContentsEx(hWndForm, REF )
		Functions
			Function: F_RNK
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If nPar = 1 and ( SOS = NUMBER_Null or SOS = 0 )
						Set sTmp = STRING_Null
						Call FunNSIGetFiltered
								("CUSTOMER","NMK",
								 " rnk in (select accounts.rnk from accounts, int_accn i " ||
								" where accounts.acc=i.acc and i.id=1 
								    and accounts.pap=2 and accounts.nbs in ('2600','2650') 
								    and accounts.dazs is null 
								    and nvl(accounts.lim,0)=0 " ||sTOBO || " ) ",sTmp,NMK)
						If sTmp != STRING_Null
							Set RNK=Val(BR1.sTmp)
							If ND = NUMBER_Null
								Set DAT1=BR1.bDat
								Set INSP=BR1.nUser
								Set LIMIT = 0
							Else
								Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE )
						Call F_NLS()
			Function: F_NLS
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SOS = NUMBER_Null or SOS = 0
						Set NLS = SalStrTrimX( NLS )
						If KV != NUMBER_Null and NLS != STRING_Null and RNK != NUMBER_Null
							If SqlPrepareAndExecute( hSql(),
									"SELECT tobo,ACC, ostc/100 into :TOBO,:ACC, :OSTC 
									 from accounts 
									 where kv=:KV and nls=:NLS and dazs is null and rnk=:RNK ")
									and SqlFetchNext(hSql(), nFetchRes)
							Else
								Set ACC = NUMBER_Null
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If DAT4 < DAT1 and DAT1 != DATETIME_Null and DAT4 != DATETIME_Null
						Call SalMessageBox("Дата-начала БОЛЬШЕ Даты-завершения",
								"Внимание, ошибка !", MB_IconStop)
						Set DAT4 = DAT1
					Set DNI = DAT4 - DAT1
			Function: F_IR
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: IRK_
					Number: DNI_
				Actions
					If BR1.SOS=0 or BR1.SOS=2 or BR1.SOS= NUMBER_Null
						If KV = NUMBER_Null OR IR = NUMBER_Null 
								OR DNI = NUMBER_Null OR DNI < 1 
								OR DAT1=DATETIME_Null OR DAT4=DATETIME_Null OR DAT1 >= DAT4 
							Set IR = NUMBER_Null
							Return FALSE
						!
						If SqlPrepareAndExecute( hSql(),
								"select dni, ir into :DNI_,:IRK_ from br_kaz 
								 where kv=:KV and fdat=:bDat and ir is not null and DNI>=:DNI 
								 order by dni" ) 
								and not SqlFetchNext(hSql(), nFetchRes)
							Call SalMessageBox("Ставка Не установлена казначейством ",
									"Внимание, ошибка !", MB_IconStop)
							Set IR = NUMBER_Null
							Return FALSE
						!
						If IR > IRK_ 
							Call SalMessageBox("Ставка="|| Str(IR)|| " 
									БОЛЬШЕ максимально-допустимой=" || Str(IRK_),
									"Внимание, ошибка !", MB_IconStop)
							Set IR = NUMBER_Null
							Return FALSE
					!
					Return TRUE
			Function: F_VISA2
				Description: На согласование. Ничего не происходит, только cc_deal.sos= 2
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nLim
					String: sTxt
				Actions
					Set sTxt = 
							"Передача на согласование неснижаемого остатка по сч." ||NLS||"/"||Str(KV)||
							" на сумму="||SalNumberToStrX( LIMIT, 2 )
					If OTM = 1 
						If SqlPrepareAndExecute( hSql(),
								  "update cc_deal set sos= 2 where nd=:ND " ) 
								and SqlCommitEx(hSql(),sTxt  )
							Return TRUE
						Else
							Call SalMessageBox("Не успешная передача на согласование !",
									"Передача невозможна !", MB_IconStop)
							Call SqlRollback( hSql() )
					!
					Return FALSE
			Function: F_VISA6
				Description: Установка лимита
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nLim
					String: sTxt
				Actions
					Set sTxt = 
							"Установка неснижаемого остатка по сч." ||NLS||"/"||Str(KV)||
							" на сумму="||SalNumberToStrX( LIMIT, 2 )
					If OTM = 1 and LIMIT > 0 and IR > 0
							and SalMessageBox("Внимание ! 
							" || sTxt ,
							"Договор согласован ?", MB_IconQuestion | MB_YesNo) = IDYES
						Set nLim = - LIMIT *100
						If SqlPrepareAndExecute( hSql(),
								  "SELECT ostc/100 into :OSTC from accounts 
								   where ostc+lim/100 >= :LIMIT and acc=:ACC FOR UPDATE OF lim NOWAIT " ) 
								and SqlFetchNext(hSql(), nFetchRes)
								and SqlPrepareAndExecute( hSql(),
								   "update accounts set lim= lim + :nLim where acc=:ACC " ) 
								and SqlPrepareAndExecute( hSql(),
								   "update cc_deal set sos= 6, limit=:LIMIT where nd=:ND " ) 
								and SqlCommitEx(hSql(),sTxt  )
							Return TRUE
						Else
							Call SalMessageBox("Не успешное блокирование счета !",
									"Согласование невозможно !", MB_IconStop)
							Call SqlRollback( hSql() )
					!
					Return FALSE
			Function: F_VISA10
				Description: Установка ставки
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nInt
					! String: sInt
					Number: nBr
					Number: nLim
					Number: nL99
					Number: nIr0
					String: sTxt
					String: sBr
					String: sName
					String: sDetali
					Boolean: FL
					Date/Time: dDat4
				Actions
					Set sTxt = 
							"Установка ставки брони="|| Str(IR)||"% по сч." ||NLS||"/"||Str(KV)
					Set FL = FALSE
					If OTM = 1 and IR != NUMBER_Null  
							and SalMessageBox("Внимание ! 
							" || sTxt ,
							"Окончательный ввод в действие ?", MB_IconQuestion | MB_YesNo) = IDYES
						Set FL = TRUE
						Call SalWaitCursor(TRUE)
						! Поиск свободной БазПроцСт
						Set nLim= LIMIT*100
						Set nL99= 999999999999999
						! Set dDat4 = DAT4 + 1
						Set dDat4 = DAT4 
						! Call Debug('nPorogB = ' || Str(nPorogB) )
						If SqlPrepareAndExecute( hSql(),
								  "select BR into :nBr from BR_Fre 
								   where BR > :nPorogB 
								     and BR not in 
								(select BR_ID from BR_TIER where KV=:KV and BDATE>=:bDat )")
								and NOT SqlFetchNext(hSql(), nFetchRes)
							! Своб.БПС нет - создаем новую в интервале > nPorogB
							! Call Debug('Своб.БПС нет - создаем новую в интервале > nPorogB '  )
							If SqlPrepareAndExecute( hSql(),
									"select min(c.num + :nPorogB) 
									 into :nBr 
									 from conductor c 
									 where (c.num + :nPorogB) not in (select BR_ID from brates) 
									   and c.num > 0 "  ) 
									and SqlFetchNext( hSql(),nFetchRes)
								Set sName = 'БПС Бр.на сч.ХО ' ||Str(nBr)
								! Call Debug('nBr = ' || Str(nBr ) )
								Set FL = 
										SqlPrepareAndExecute( hSql(), "insert into BRATES (BR_ID,BR_TYPE,NAME) values (:nBr,3,:sName)")
						Else
							Set FL = 
									SqlPrepareAndExecute( hSql(),"delete from BR_Fre where br=:nBr ")
						If NOT FL 
							Call SqlRollback( hSql() )
							Call SalWaitCursor(FALSE)
							Call SalMessageBox("Не успешное моделирование баз.ставки !",
									"Ввод в действие невозможен !", MB_IconStop)
							Return FALSE
						!
						Set FL= FALSE
						! Найти значение обычной ставки nIr0
						If SqlPrepareAndExecute( hSql(),
								  "select acrn.fprocn(:ACC,1,:bDat) into :nIr0 from dual")
								and SqlFetchNext( hSql(),nFetchRes)
							! Построить ступенч для брони
							If SqlPrepareAndExecute( hSql(),
									  "INSERT INTO BR_TIER(BR_ID,BDATE,KV,S,RATE) values (:nBr,:bDat,:KV,:nLim,:IR)")
								! Построить ступенч для сверх-брони
								If SqlPrepareAndExecute( hSql(),
										  "INSERT INTO BR_TIER(BR_ID,BDATE,KV,S,RATE) values (:nBr,:bDat,:KV,:nL99,:nIr0)")
									! Заготовить обыч. стаку по счету на после-время дог = ДАТЕ ЗАВЕРШ.ДОГ
									If SqlPrepareAndExecute( hSql(),
											  "delete from int_ratn where acc=:ACC and id=1 and bdat>=:dDat4 " )
											and SqlPrepareAndExecute( hSql(),
											  "INSERT into int_ratn (ACC,ID,BDAT,IR,BR,OP)
											   select ACC,ID,:dDat4,IR,BR,OP from int_ratn 
											   where acc=:ACC and id=1 and bdat=
											    (select max(bdat) from int_ratn where acc=:ACC and id=1 ) ")
										! Заготовить повыш стаку по счету на время дог
										If SqlPrepareAndExecute( hSql(),
												  "delete from int_ratn where acc=:ACC and id=1 and bdat >= :bDat and bdat < :dDat4" )
												and SqlPrepareAndExecute( hSql(),
												  "insert into int_ratn(acc,id,bdat,br) values (:ACC,1,:bDat,:nBr) " )
											! отметить дог и счет 
											If SqlPrepareAndExecute( hSql(),
													 "update cc_deal set sos= 10 where nd=:ND " ) 
													and SqlPrepareAndExecute( hSql(),
													   "update accounts set tip='BRO' where acc=:ACC " ) 
												! Расчитать прогноз-проценты и запомнить их 
												Set nInt =  p_intN (ACC, 1, bDat,dDat4-1,nLim, 0 ) 
												Set nInt = SalNumberRound( nInt )
												Set SUMP = nInt / 100
												Set sInt = Str(nInt)
												Set sBr = Str(nBr)
												If SqlPrepareAndExecute( hSql(),
														  "insert into nd_txt(nd,tag,txt) values (:ND,'KNL', :sInt ) ") 
														and SqlPrepareAndExecute( hSql(),
														  "insert into nd_txt(nd,tag,txt) values (:ND,'KDO', :sBr ) ") 
													Call SqlCommitEx(hSql(),sTxt  )
													Set FL = TRUE
						If NOT FL 
							Call SqlRollback( hSql() )
							Call SalWaitCursor(FALSE)
							Call SalMessageBox("Не успешная Установка баз.ставки ! ",
									"Ввод в действие невозможен !", MB_IconStop)
							Return FALSE
						Else
							Set sDetali = "Cч." ||NLS||"/"||Str(KV) || " присвоен код БПС = "  || Str( nBr)
							Call SqlCommitEx( hSql(), sDetali )
							Call SalWaitCursor(FALSE)
							Call SalMessageBox(sDetali ,"Сообщение !", MB_Ok )
							Return TRUE
						!
					! !! 
					Return FL
			Function: F_VISA15
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nLim
					Number: nBr
					String: sTxt1
					String: sTxt2
					Date/Time: BDAT
					String: sSqli
					Number: nSos
					!
					String: sDetali
					String: sSqld
					!
					Number: n5000
				Actions
					If DAT4 > bDat 
						Set sTxt1 = 
								"Аннулирование БПС и неснижаемого остатка по сч." ||NLS||"/"||Str(KV)
						Set sTxt2 = "Д О С Р О Ч Н О Е ! " 
						Set nSos  = 14
					Else
						! Проверка на начсление %
						If SqlPrepareAndExecute( hSql(),
								"select ACR_DAT into :ACR_DAT from int_accn where id=1 and acc=:ACC ")
								and SqlFetchNext( hSql(),nFetchRes)
							If ACR_DAT < bDat-1
								Set sFilter_Pr = " AND i.id=1 and s.acc=" || Str(ACC)  
								Call Sel010(hWndMDI, 0, 0, sFilter_Pr, "S" )
								Return FALSE
							!
						!
						Set sTxt1 = 
								"Прекращение действия БПС и неснижаемого остатка по сч." ||NLS||"/"||Str(KV)
						Set sTxt2 = "Нормальное" 
						Set nSos  = 15
					!
					If NOT ( OTM = 1  and SalMessageBox("Внимание ! 
							" || sTxt1 ,
							sTxt2||" Завершение действия договора ?", MB_IconQuestion | MB_YesNo) = IDYES )
						Return FALSE
					!
					! !!!!!!!!!!!!
					! Код последней БПС
					If DAT1 <=  SalDateConstruct( 2011, 10, 18, 0, 0, 0 )
						Set n5000 = 50000
					Else
						Set n5000 = nPorogB
					Set sSqld = 
							"SELECT br,bdat  INTO :nBr, :BDAT FROM int_ratn 
							 WHERE acc= :ACC and  id=1  and br > " || Str(n5000) || "  and bdat = 
							  (select max(bdat) from int_ratn  
							   where acc= :ACC and id=1 and br > " || Str(n5000) || "  and bdat <= gl.BD ) "
					If NOT ( SqlPrepareAndExecute( hSql(), sSqld) and SqlFetchNext(hSql(), nFetchRes) )
						Set sDetali = "1) Не найден Код последней БПС:
								 " || sSqld
						Call SqlRollback( hSql() )
						Call SalMessageBox( sDetali ,"Закрытие  невозможено !", MB_IconStop)
						Return FALSE
					! !!!!!!
					! Высвобождение кода БПС
					Set nLim = LIMIT*100
					Set sSqld =  "insert into br_Fre (br) values (" || Str(nBr) || ") "
					If NOT SqlPrepareAndExecute( hSql(),sSqld ) 
						Set sDetali = "2) Высвобождение кода БПС:
								 " || sSqld
						Call SqlRollback( hSql() )
						Call SalMessageBox( sDetali ,"Закрытие  невозможено !", MB_IconStop)
						Return FALSE
					! !!!!!!
					! Oтметка счета
					Set sSqld =  "update accounts set lim= lim + :nLim , tip='ODB' where acc= :ACC "
					If NOT SqlPrepareAndExecute(hSql(), sSqld )
						Set sDetali = "3) Oтметка счета:
								 " || sSqld
						Call SqlRollback( hSql() )
						Call SalMessageBox( sDetali ,"Закрытие  невозможено !", MB_IconStop)
						Return FALSE
					! !!!!!!
					! Закрытие дог 
					Set sSqld =  "update cc_deal set sos= :nSos where nd = :ND "
					If NOT SqlPrepareAndExecute(hSql(),sSqld ) 
						Set sDetali = "4) Закрытие дог:
								 " || sSqld
						Call SqlRollback( hSql() )
						Call SalMessageBox( sDetali ,"Закрытие  невозможено !", MB_IconStop)
						Return FALSE
					! !!!!!!
					! HE Досрочное  = нормальное. Вся история БПС сохраняется
					If DAT4 <= bDat 
						If SqlCommitEx(hSql(),sTxt1  ) 
							Call F_Opl()
							Call SalMessageBox( sTxt1 ,"Договор закрыт !", MB_Ok  )
							Return TRUE
						Else
							Return FALSE
					! !!!!!!
					! Досрочное. Вся история БПС удаляется
					! убрать порожденные БПС из INT_RATN
					Set sSqld =  "delete from INT_RATN where acc= :ACC and id=1 and bdat = :DAT1 " 
					If NOT SqlPrepareAndExecute(hSql(),sSqld  )
						Set sDetali = "6-1) убрать порожденные БПС из INT_RATN :
								 " || sSqld
						Call SalMessageBox( sDetali ,"Закрытие  невозможено !", MB_IconStop)
						Call SqlRollback( hSql() )
						Return FALSE
					! !!!!!!
					! убрать порожденные БПС из BR_TIER 
					Set sSqld = "delete from BR_TIER where br_id= :nBr and bdate=:DAT1 "
					If NOT SqlPrepareAndExecute(hSql(),sSqld ) 
						Set sDetali = "6-2) убрать порожденные БПС из BR_TIER :
								 " || sSqld
						Call SalMessageBox( sDetali ,"Закрытие  невозможено !", MB_IconStop)
						Call SqlRollback( hSql() )
						Return FALSE
					! !!!!!!
					! Изменить даты обычных ставок
					Set sSqld = "update INT_RATN set bdat = :DAT1 where acc = :ACC and id=1 and bdat = :DAT4"
					If NOT SqlPrepareAndExecute(hSql(),sSqld  )
						Set sDetali = "6-3) Изменить даты обычных ставок:
								 " || sSqld
						Call SalMessageBox( sDetali ,"Закрытие  невозможено !", MB_IconStop)
						Call SqlRollback( hSql() )
						Return FALSE
					Else
						If SqlCommitEx(hSql(),sTxt1  ) 
							Call F_Opl()
							Call SalMessageBox( sTxt1 ,"Договор закрыт !", MB_Ok  )
							Return TRUE
						Else
							Return FALSE
					! !!!
			Function: Print_RTF
				Description:
				Returns
					Number:
				Parameters
				Static Variables
				Local variables
					String: sTemplateId
					Long String: sDoc
					: cCnc
						Class: cABSConnect
					: cCnc2
						Class: cABSConnect
				Actions
					If NOT cdoc_SelectDocTemplate( "DOC_SCHEME", "ID", "NAME",
							" ID LIKE 'BRO%' ", sTemplateId )
						Return 0
					If sTemplateId
						Call XConnectGetParams( cCnc )
						If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
							Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), sTemplateId,  ND, 0)
							If sDoc
								Call cdoc_ShowDoc(sDoc,TRUE,FALSE)
							Call cCnc.Disconnect()
							Call cCnc2.Disconnect()
			Function: F_Opl
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRef
					Number: nS
					String: sOkpo
					String: sNms8
					String: sNms
					String: sNazn 
					String: sRKO_N
					String: sRKO_D
					String: sNLSK1
					!
					String: sTTB
					Number: nKVB
					String: sNLSB
					String: sMFOB
					String: sNAMB
					Number: nS2
					Boolean: FL
				Actions
					! If SqlPrepareAndExecute( hSql(),
							  "select ostb into :SUMP from accounts where acc=:ACRA ")
							and SqlFetchNext(hSql(), nFetchRes)
					If DAT4 <= bDat and SUMP > 0 
						Set nS = SUMP * 100
						! Set nS = SalNumberMin( SUMP, OSTP ) * 100
						If SqlPrepareAndExecute( hSql(),
								  "SELECT TTB, KVB, NLSB, MFOB, NAMB, gl.p_icurval(:KV,:nS,:bDat) 
								   INTO :sTTB, :nKVB, :sNLSB, :sMFOB, :sNAMB, :nS2
								   FROM int_accn 
								   WHERE acc=:ACC and id=1 
								     and TTB  is not null and KVB  is not null 
								     and NLSB is not null and MFOB is not null and NAMB is not null ")
								and NOT SqlFetchNext(hSql(), nFetchRes)
							Set sTTB ='PS1'
							Set nKVB = KV
							Set sNLSB= NLS 
							Set sMFOB=aMfo
							Set sNAMB=NMK
							Set nS2  = nS
						If sNLSB != NLS or sMFOB != aMfo or nKVB != KV
							Set FL =  SalModalDialog(BRP, hWndForm, 
									   sTTB, nKVB, sNLSB, sMFOB, sNAMB,nS2, 
									   'PS1',KV  , NLS  , aMfo , NMK , nS ) 
						Else
							If SalMessageBox(" Выполнить капитализацию % за броню в сумме "|| 
									SalNumberToStrX( SUMP, 2 ) || " на счет "|| sNLSB || " ?",
									" Внимание ! Дополнительно: " , MB_IconQuestion | MB_YesNo) = IDYES
								Set FL = TRUE
							Else
								Set FL = FALSE
						!
						If FL 
							If SqlPrepareAndExecute( hSql(),
									  "SELECT c.okpo, substr(a.nms,1,38), substr(b.nms,1,38)
									   INTO :sOkpo, :sNms8, :sNms
									   FROM customer c, accounts a, accounts b
									   WHERE c.rnk = :RNK and a.acc = :ACRA and b.acc = :ACC ")
									and SqlFetchNext(hSql(), nFetchRes)
								If SqlPrepareAndExecute( hSql(), 
										  "select Substr(value,1,100) into :sRKO_D from customerw 
										   where rnk=:RNK and tag='RKO_D' ") 
										and SqlFetchNext(hSql(), nFetchRes)
								If SqlPrepareAndExecute( hSql(), 
										  "select Substr(value,1,100) into :sRKO_N from customerw 
										   where rnk=:RNK and tag='RKO_N' ") 
										and SqlFetchNext(hSql(), nFetchRes)
								Set sNazn =
										"Виплата %% згідно дод. угоди № " || CC_ID ||
										" від " || SalFmtFormatDateTime( DAT1, 'dd.MM.yyyy' ) ||
										" до Дог.банків. рах. № " || sRKO_N || 
										" від " || sRKO_D || " за період " || Str(DNI) || " дн."
								Set nRef = NUMBER_Null
								Call cDoc.SetDoc( 0, sTTB, 1, 6, STRING_Null,
										     bDat, bDat, bDat, bDat,
										     NLS8, sNms8, aMfo, '', KV,  nS, sOkpo,
										     sNLSB,sNAMB, sMFOB,'',nKVB,nS2, sOkpo,
										     sNazn, '', GetIdOper(), '', NUMBER_Null, 0 )
								If NOT cDoc.oDoc()
									Call SqlRollback( hSql() )
									Return FALSE
								!
								Call SqlCommitEx(hSql(),sNazn  )
								Set SUMP=0
								Set REF = cDoc.m_nRef
								Call XSalTblSetCellBackColor( REF, COLOR_LightGreen )
								Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
								Return TRUE
					!
					Return FALSE
			Function: F_Start
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalDisableWindow( BR1.pbIns )
					Call SalDisableWindow( BR1.INSP )
					Call SalDisableWindow( BR1.CC_ID )
					Call SalDisableWindow( BR1.DAT1 )
					Call SalDisableWindow( BR1.DAT4 )
					Call SalDisableWindow( BR1.pbDel )
					Call SalDisableWindow( BR1.pbUpdate )
					If pPar =4
						Call SalEnableWindow( BR1.rb1 )
						Call SalEnableWindow( BR1.rb2 )
						Call SalEnableWindow( BR1.rb3 )
						Call SalEnableWindow( BR1.rb4 )
						Call SalEnableWindow( BR1.rb9 )
					Else
						Call SalDisableWindow( BR1.rb1 )
						Call SalDisableWindow( BR1.rb2 )
						Call SalDisableWindow( BR1.rb3 )
						Call SalDisableWindow( BR1.rb4 )
						Call SalDisableWindow( BR1.rb9 )
					!
					If nPar = 1
						Set sFilter_SOS = strPar01 || " and d.sos>=0  and d.sos < 2  "
						Set BR1.rb1 = TRUE
						Call SalShowWindow( BR1.OTM )
						Set sTitl = "BR1: Брон.средств на сч.ХО: Просмотр,Ввод,Корр" 
						Call SalTblSetColumnTitle( BR1.OTM, "Виза
								1" )
						!
						Call SalEnableWindow( BR1.pbIns )
						Call SalEnableWindow( BR1.INSP )
						Call SalEnableWindow( BR1.CC_ID )
						Call SalEnableWindow( BR1.DAT1 )
						Call SalEnableWindow( BR1.DAT4 )
						Call SalEnableWindow( BR1.pbDel )
						Call SalEnableWindow( BR1.pbUpdate )
					Else If nPar = 2 
						Set sFilter_SOS = strPar01 || " and d.sos>=2  and d.sos < 6  "
						Set BR1.rb2 = TRUE
						Call SalShowWindow( BR1.OTM )
						Call SalTblSetColumnTitle( BR1.OTM, "Согл
								2" )
						Set sTitl = "BR2: Брон.средств на сч.ХО: Просмотр, Согласование"
						!
						Call SalEnableWindow( BR1.pbDel )
						Call SalEnableWindow( BR1.pbUpdate )
					Else If nPar = 3
						Set sFilter_SOS = strPar01 || " and d.sos>=6  and d.sos < 10 "
						Set BR1.rb3 = TRUE
						Call SalShowWindow( BR1.OTM )
						Call SalTblSetColumnTitle( BR1.OTM, "Актив
								3" )
						Call SalEnableWindow( BR1.pbDel )
						Call SalEnableWindow( BR1.pbUpdate )
						Set sTitl = "BR3: Брон.средств на сч.ХО: Просмотр, Активация"
					Else If nPar = 4
						Set sFilter_SOS = "and d.sos>=10 and d.sos < 14 "
						Set BR1.rb4 = TRUE
						Call SalShowWindow( BR1.OTM )
						Call SalTblSetColumnTitle( BR1.OTM, "Завершить
								4" )
						Set sTitl = "BR4: Брон.средств на сч.ХО: Просмотр, Сопровожнение БО" 
					Else If nPar = 9
						Set sFilter_SOS = strPar01 || " and d.sos>=0  and d.sos <=15 "
						Set BR1.rb9 = TRUE
						Call SalHideWindow( BR1.OTM )
						Set sTitl = "BR9: Брон.средств на сч.ХО: Просмотр, Анализ" 
					!
					Call SalSetWindowText( hWndForm, sTitl || '/'|| strPar01 )
					Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
		Window Parameters
			Number: nMode ! 26-полный доступ, 27-доступ по ТОБО
			Number: pPar
			String: strPar01 !! предустановл фильтр
			String: strPar02
		Window Variables
			Number: nPar
			String: aMfo
			Number: n980
			Date/Time: bDat
			Number: nTmp
			String: sTmp
			String: sFilter_SOS
			String: sSql
			Number: nUser
			! Number: ACRA
			String: sFilter
			String: sTitl
			String: sInt 
			String: sFilter_Pr
			Number: nPorogB
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				Set nPar= pPar
				If SalStrTrimX( strPar02 ) = ''
					Set nPorogB = 150000
				Else
					Set nPorogB = Val( SalStrTrimX( strPar02 ))
				! nPar = 
						   1 Просмотр + ввод + коррекция + улаление + виза1
						   2 Просмотр + коррекция (LIM,BR)+ улаление + Согласование(виза2)-Установка accounts.LIM
						   3 Просмотр + Активация-виза3. Установка ставки.
						   4 Просмотр + БЄК-оф функции 
						   9 Просмотр    
				Set aMfo = GetBankMfo()
				Set BR1.nTabInstance = 1
				Set BR1.strPrintFileName = 'BR'||Str(nPar)
				Set BR1.strFilterTblName = 'BR1'
				Set bDat = GetBankDate()
				Set n980 = GetBaseVal()
				!
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 15 )
				Set nUser = GetUserId()
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call F_Start ()
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Set sSql =
						"SELECT BR1.INSP, BR1.SOS, BR1.RNK, BR1.NMK, BR1.CC_ID, BR1.ND, BR1.DAT1, 
						                    BR1.DAT4, BR1.KV,  BR1.NLS, BR1.ACC, BR1.LIMIT, BR1.IR, BR1.OSTC, BR1.TOBO,
						                    BR1.LIM ,  BR1.ACR_DAT,  BR1.ACRA, 
						                    AR.ostc/100, AR.NLS ,   substr(t.txt,1,16), BR1.DNI
						 INTO  :hWndForm.BR1.INSP,:hWndForm.BR1.SOS,    :hWndForm.BR1.RNK,
						       :hWndForm.BR1.NMK, :hWndForm.BR1.CC_ID,  :hWndForm.BR1.ND,
						       :hWndForm.BR1.DAT1,:hWndForm.BR1.DAT4,   :hWndForm.BR1.KV, 
						       :hWndForm.BR1.NLS, :hWndForm.BR1.ACC,    :hWndForm.BR1.LIMIT,
						       :hWndForm.BR1.IR,  :hWndForm.BR1.OSTC,   :hWndForm.BR1.TOBO,
						       :hWndForm.BR1.LIM ,:hWndForm.BR1.ACR_DAT,:hWndForm.BR1.ACRA,
						       :hWndForm.BR1.OSTP,:hWndForm.BR1.NLS8,
						       :hWndForm.BR1.TXT, :hWndForm.BR1.DNI 
						 FROM ( SELECT d.user_id INSP, d.SOS, d.RNK, c.NMK, d.CC_ID, d.ND, 
						                                   d.sdate DAT1, d.wdate DAT4, d.wdate-d.sdate DNI,
						                                   a.KV,  a.NLS,  a.ACC,  d.LIMIT,  a.ostc/100 OSTC, d.IR, a.TOBO, -a.lim/100 LIM, 
						                                   i.ACR_DAT, i.ACRA            
						                    FROM cc_deal d, customer c, accounts a, nd_acc n, int_accn i  
						                WHERE a.acc = i.acc And i.id = 1 And n.nd = d.nd 
						                       AND n.acc = a.acc And d.vidd = 26 And d.rnk=c.rnk " || sFilter_SOS ||  sTOBO || " ) BR1, 
						       accounts AR, nd_txt t
						 WHERE BR1.ND = t.nd (+) and 'KNL' = t.tag (+) and ar.acc=BR1.ACRA " 
						  || IifS (sFilter="", ""," and "|| sFilter ) || "
						 ORDER BY BR1.ND desc "
				Call SalTblPopulate(hWndForm, hSql(), BR1.sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow, 
						 ROW_New | ROW_Edited | ROW_MarkDeleted , 0)
					Call SalTblSetContext(hWndForm, nRow)
					! Insert
					If SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
							 and hWndForm.BR1.ND   = NUMBER_Null
							 and hWndForm.BR1.ACC != NUMBER_Null 
							 and hWndForm.BR1.RNK != NUMBER_Null
						If SqlPrepareAndExecute( hSql(),
								  "SELECT s_cc_deal.NEXTVAL INTO :hWndForm.BR1.ND FROM dual") 
								and SqlFetchNext( hSql(), nFetchRes)
							If SqlPrepareAndExecute( hSql(),  "INSERT into cc_deal
									(nd,user_id,sos,rnk,cc_id ,sdate,wdate,limit,IR,vidd) values 
									(:hWndForm.BR1.ND,   :hWndForm.BR1.INSP,0,:hWndForm.BR1.RNK,
									 :hWndForm.BR1.CC_ID,:hWndForm.BR1.DAT1,  :hWndForm.BR1.DAT4,
									 :hWndForm.BR1.LIMIT,:hWndForm.BR1.IR, 26 )" )
								If SqlPrepareAndExecute( hSql(),
										   "INSERT into nd_acc(nd,acc) values (:BR1.ND,:BR1.ACC)" )
									If SqlCommitEx( hSql(), "Введен Дог на бр.ср "||Str(ND) )
					! Update
					Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_Edited ) 
							and hWndForm.BR1.ND != NUMBER_Null 
							and (hWndForm.BR1.SOS=0 or hWndForm.BR1.SOS=2 ) 
							and hWndForm.BR1.ACC != NUMBER_Null and hWndForm.BR1.RNK != NUMBER_Null
						If SqlPrepareAndExecute( hSql(),
								   "UPDATE cc_deal set 
								      user_id = :hWndForm.BR1.INSP,
								      rnk     = :hWndForm.BR1.RNK,
								      cc_id   = :hWndForm.BR1.CC_ID,
								      sdate   = :hWndForm.BR1.DAT1,
								      wdate   = :hWndForm.BR1.DAT4,
								      limit   = :hWndForm.BR1.LIMIT,
								      IR      = :hWndForm.BR1.IR   where sos in (0,2) and nd= :hWndForm.BR1.ND ") 
								and SqlPrepareAndExecute( hSql(),
								   "update nd_acc set acc = :hWndForm.BR1.ACC where nd=:hWndForm.BR1.ND" )
								and SqlCommitEx( hSql(), "Изменен Дог на бр.ср "||Str(ND) )
					! Delete
					Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_MarkDeleted ) 
						If ND != NUMBER_Null and ( SOS=0 or SOS=2 or SOS=6 ) 
							If SOS=6 and ACC != NUMBER_Null
								Set nTmp = LIMIT * 100
								If SqlPrepareAndExecute( hSql(),
										 "update accounts set lim=lim + :nTmp where acc=:ACC ") 
							!
							If SqlPrepareAndExecute( hSql(), "delete from nd_acc where nd= :ND ")
									and SqlPrepareAndExecute( hSql(),"delete from cc_deal where nd=:ND and sos=:SOS ") 
									and SqlCommitEx( hSql(), "Удален Дог на бр.ср "||Str(ND)  )
				!
				Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
			On SAM_FetchRowDone
				If BR1.DAT4 <= bDat
					Call XSalTblSetCellBackColor( BR1.DAT4, SalColorFromRGB( 255,210,210 ) )
				If OSTC < LIMIT
					! Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Salmon )
					Call XSalTblSetCellBackColor( BR1.OSTC, COLOR_Salmon )
					Call XSalTblSetCellBackColor( BR1.LIMIT, SalColorFromRGB( 230,255,230 ) )
				!
				If SOS = NUMBER_Null or SOS=0
					Set sSOS = "Новый"
				Else If SOS=2
					Set sSOS = "Передан"
				Else If SOS=6
					Set sSOS = "Согласован"
				Else If SOS=10
					Set sSOS = "Активирован"
				Else If SOS=15
					Set sSOS = "Завершен"
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
				Else If SOS=14
					Set sSOS = "Досрочно закр"
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
				Set sSOS = Str(SOS)||' '|| sSOS
				If SOS >= 2 and nPar=1 
						OR SOS >= 6 and nPar=2 
						OR SOS >= 10 and nPar=3 
					Set OTM = 1
				If TXT != STRING_Null
					Set SUMP = Val(TXT)/100
				If SOS=14
					Call XSalTblSetCellBackColor( sSOS, SalColorFromRGB( 255,210,210 ) )
			! On SAM_DoubleClick
			! On UM_CreateDoc
				! Call SalModalDialog( dlg_CreateDoc, hWndForm, BR1.ND, 203 )
			On SAM_TblDoDetails
	Table Window: XD0
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Ввод и авторизация договоров ХД
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.163"
				Top:    0.479"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.702"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Відкрити нову ГУ з Контрагентом '
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Видалити нову ГУ з Контрагентом '
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							! Set strTip = 'Пероеглянути рахунки по ГУ'
							Set strTip = 'Операції по супроводженню ГУ'
						On SAM_Click
							If not SalIsNull(ND) and not SalIsNull(ACC) 
								If not IsWindow(hXD1)
									! Set hXD1 = SalCreateWindow
											( XD1, hWndMDI,ND, Val(NLS), NMK, "Угода № "|| CC_ID || " вiд " || SalFmtFormatDateTime( DAT1, "dd/MM/yyyy" ))
								! Set sTmp=" a.acc in (select acc from nd_acc where nd="||Str(ND)||")" 
								! Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
				!
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pb_Kli ! Паспорт клиента
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Паспорт  Контрагента (перегляд)'
						On SAM_Click
							If RNK >0
								Call EditCustCorps( RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
				Pushbutton: pb_PUSTO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Line
					Resource Id: 3583
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.75"
						Begin Y:  -0.012"
						End X:  5.783"
						End Y:  0.405"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 3584
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.183"
						Begin Y:  0.071"
						End X:  4.183"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 3585
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				! ctb_pbGetValue: pb_All
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.155"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\DOCS.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Sky
.end
					                                                                                                                                                                                                                                             Message Actions 
						                                                                                                                                                                                                                                             On SAM_Create
							                                                                                                                                                                                                                                             Set strTip = 'Перегляд архіву ГУ '
							                                                                                                                                                                                                                                             If nPar = 9
								                                                                                                                                                                                                                                             Call SalHideWindow( pb_All )
						                                                                                                                                                                                                                                             On SAM_Click
							                                                                                                                                                                                                                                             Call SalCreateWindow( XD0, hWndMDI,nMode,9, "","" )
				Frame
					Resource Id: 3586
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.883"
						Top:    0.071"
						Width:  8.1"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Ввод,Корр
					Window Location and Size
						Left:   5.083"
						Top:    0.155"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 1
							Call F_Start ()
				Radio Button: rb3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Активация
					Window Location and Size
						Left:   6.883"
						Top:    0.155"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 3
							Call F_Start ()
				Radio Button: rb4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Сопровожнение
					Window Location and Size
						Left:   8.883"
						Top:    0.155"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 4
							Call F_Start ()
				Radio Button: rb9
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Анализ
					Window Location and Size
						Left:   11.183"
						Top:    0.155"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 9
							Call F_Start ()
		Contents
			Column: DK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 0-Д
						1-К
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If DK != 0 and DK !=1 
							Call SalMessageBox("Вид ГУ !",
									" 0=Дебітор, 1=Кредитор ", MB_IconStop)
							Set DK =0 
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Branch
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: INSP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						викон.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						сост
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sSOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стан
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погодж.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If SOS = 0 and nPar=1 and F_VISA2()
						Else If SOS = 2 and nPar=3 and F_VISA10()
						Else If SOS = 10 and nPar=4 and F_VISA15()
						Else
							Set OTM =0 
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
						!
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег№
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_RNK()
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Найменування 
						контрагенту
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_RNK()
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Идент.
						угоди
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						Угоди
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						 Початку
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_DAT()
					On SAM_KillFocus
						Call F_DAT()
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						Заверш.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_DAT()
					On SAM_KillFocus
						Call F_DAT()
			Column: SDOG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						Угоди
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If nPar = 1 and SOS = 0 and RNK != NUMBER_Null and NLS= STRING_Null
							Set sNBS = Str( 3510 + DK*100)
							If SqlPrepareAndExecute( hSql(),
									"SELECT substr(f_newnls2(null,'XD',:sNBS,:RNK,null,:n980),1,14) 
									 into :NLS from dual ")
									and SqlFetchNext(hSql(), nFetchRes)
								If NLS != STRING_Null
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE )
					On SAM_DoubleClick
						If nPar = 1 and SOS = 0 and RNK != NUMBER_Null
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered ("ACCOUNTS","NLS", 
									" rnk="||Str(RNK)||" and dazs is null ",sTmp,NLS)
							If sTmp != STRING_Null
								If SqlPrepareAndExecute( hSql(),
										"SELECT acc,ostc/100 into :ACC,:OSTC from accounts where acc="|| sTmp )
										and SqlFetchNext(hSql(), nFetchRes)
								If ND != NUMBER_Null
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE )
			Column: OSTC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Поточний 
						залишок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_RNK
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If nPar = 1 and ( SOS = NUMBER_Null or SOS = 0 )
						Set sTmp = STRING_Null
						Call FunNSIGetFiltered
								("CUSTOMER","NMK", " DATE_OFF is null and custtype=2 ",sTmp,NMK)
						If sTmp != STRING_Null
							Set RNK=Val(XD0.sTmp)
							If ND = NUMBER_Null
								Set DAT1= bDat
								Set INSP= nUser
							Else
								Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE )
						Call F_NLS()
			Function: F_NLS
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SOS = NUMBER_Null or SOS = 0
						Set NLS = SalStrTrimX( NLS )
						If NLS != STRING_Null and RNK != NUMBER_Null
							If SqlPrepareAndExecute( hSql(),
									"SELECT ACC, ostc/100 into :ACC, :OSTC from accounts 
									 where kv=:n980 and nls=:NLS and dazs is null and rnk=:RNK ")
									and SqlFetchNext(hSql(), nFetchRes)
							Else
								Set ACC = NUMBER_Null
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If DAT4 < DAT1 and DAT1 != DATETIME_Null and DAT4 != DATETIME_Null
						Call SalMessageBox("Дата-начала БОЛЬШЕ Даты-завершения",
								"Внимание, ошибка !", MB_IconStop)
						Set DAT4 = DATETIME_Null
			Function: F_VISA2
				Description: На активацию. Ничего не происходит, только cc_deal.sos= 2
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTxt
				Actions
					If ACC = NUMBER_Null
						Call SalMessageBox(" Помилка  !",
								 " НЕ відкрито Рахунок !", MB_IconStop)
						Return FALSE
					Set sTxt = "Передача ГУ на Активаію. Рах." ||NLS 
					If OTM = 1 
						If SqlPrepareAndExecute( hSql(),
								  "update cc_deal set sos= 2 where nd=:ND " ) 
								and SqlCommitEx(hSql(),sTxt  )
							Return TRUE
						Else
							Call SalMessageBox("Не успешна передача на Активаію !",
									"Передача неможлива !", MB_IconStop)
							Call SqlRollback( hSql() )
					!
					Return FALSE
			Function: F_VISA10
				Description: Активация
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTxt
				Actions
					Set sTxt = "Активацiя ГУ реф="||Str(ND)||" з " || NMK 
					If OTM = 1 and SalMessageBox( sTxt,"Увага !", MB_IconQuestion | MB_YesNo) = IDYES
						! отметить дог и счет 
						If SqlPrepareAndExecute( hSql(), "update cc_deal set sos= 10 where nd=:ND " ) 
								and SqlPrepareAndExecute( hSql(),"update accounts set tip='XD ' where acc=:ACC " ) 
								and SqlCommitEx(hSql(),sTxt  )
							Return TRUE
					!
					Return FALSE
			Function: F_VISA15
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTxt1
					String: sTxt2
				Actions
					Set sTxt1 = "Закрытие сч." ||NLS
					If OSTC !=0 
						Call SalMessageBox("Не успешнoe завершение договора !",
								sTxt1 || "  невозможено (ост.НЕ=0)!", MB_IconStop)
						Return FALSE
					!
					If DAT4 > bDat 
						Set sTxt2 = "Д О С Р О Ч Н О Е ! " 
					Else
						Set sTxt2 = "Нормальное" 
					!
					If OTM = 1  
							and SalMessageBox("Внимание ! 
							" || sTxt1 ,
							sTxt2||" Завершение действия договора ?", MB_IconQuestion | MB_YesNo) = IDYES
						!
						! Закрытие дог и отметка счета
						If SqlPrepareAndExecute(hSql(),"update accounts set dazs= bDat where acc=:ACC " )
								and SqlPrepareAndExecute(hSql(),"update cc_deal set sos=15 where nd=:ND " ) 
							Return TRUE
						!
						Call SalMessageBox("Не успешнoe завершение договора !",
								"Закрытие  невозможено !", MB_IconStop)
						Call SqlRollback( hSql() )
					!
					Return FALSE
			Function: F_Start
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( INSP )
					Call SalDisableWindow( CC_ID )
					Call SalDisableWindow( DAT1 )
					Call SalDisableWindow( DAT4 )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
					If pPar =4
						Call SalEnableWindow( rb1 )
						Call SalEnableWindow( rb3 )
						Call SalEnableWindow( rb4 )
						Call SalEnableWindow( rb9 )
						Call SalEnableWindow( pbDetails )
					Else
						Call SalDisableWindow( rb1 )
						Call SalDisableWindow( rb3 )
						Call SalDisableWindow( rb4 )
						Call SalDisableWindow( rb9 )
						Call SalDisableWindow( pbDetails )
					!
					If nPar = 1
						Set sFilter_SOS = strPar01 || " and d.sos=0 "
						Set rb1 = TRUE
						Call SalShowWindow( OTM )
						Set sTitl = "XD0: Угоди Госп.Дiяльностi: Ввод,Корекція,Передача на Активацію" 
						Call SalTblSetColumnTitle( OTM, "Передати
								на акт" )
						!
						Call SalEnableWindow( pbIns )
						Call SalEnableWindow( INSP )
						Call SalEnableWindow( CC_ID )
						Call SalEnableWindow( DAT1 )
						Call SalEnableWindow( DAT4 )
						Call SalEnableWindow( pbDel )
						Call SalEnableWindow( pbUpdate )
					Else If nPar = 3
						Set sFilter_SOS = strPar01 || " and d.sos=2 "
						Set rb3 = TRUE
						Call SalShowWindow( OTM )
						Call SalTblSetColumnTitle( OTM, "Акт.
								ГУ" )
						Call SalEnableWindow( pbDel )
						Call SalEnableWindow( pbUpdate )
						Set sTitl = "XD1: Угоди Госп.Дiяльностi: Перегляд, Активація"
					Else If nPar = 4
						Set sFilter_SOS = "and d.sos>=10 and d.sos < 15 "
						Set rb4 = TRUE
						Call SalShowWindow( OTM )
						Call SalTblSetColumnTitle( OTM, "Завершити
								ГУ" )
						Set sTitl = "XD2: Угоди Госп.Дiяльностi: Перегляд, Супроводження" 
					Else If nPar = 9
						Set sFilter_SOS = strPar01 || " and d.sos>=0  and d.sos <=15 "
						Set rb9 = TRUE
						Call SalHideWindow( OTM )
						Set sTitl = "XD3: Угоди Госп.Дiяльностi: Перегляд та Аналіз"
					! Else If nPar = 2 
						                                                                                                                                                                                                                                                Set sFilter_SOS = strPar01 || " and d.sos>=2  and d.sos < 6  "
						                                                                                                                                                                                                                                                Set BR1.rb2 = TRUE
						                                                                                                                                                                                                                                                Call SalShowWindow( BR1.OTM )
						                                                                                                                                                                                                                                                Call SalTblSetColumnTitle( BR1.OTM, "Согл
								2" )
						                                                                                                                                                                                                                                                Set sTitl = "BR2: Брон.средств на сч.ХО: Просмотр, Согласование"
						!
						                                                                                                                                                                                                                                                Call SalEnableWindow( BR1.pbDel )
						                                                                                                                                                                                                                                                Call SalEnableWindow( BR1.pbUpdate )
					!
					Call SalSetWindowText( hWndForm, sTitl || '/'|| strPar01 )
					Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
		Window Parameters
			Number: nMode !
			Number: pPar
			! nPar = 
					   1 Просмотр + ввод + коррекция + улаление + виза1
					   --2 Просмотр + коррекция (LIM,BR)+ улаление + Согласование(виза2)-Установка accounts.LIM
					   3 Просмотр + Активация-виза3.
					   4 Просмотр + БЄК-оф функции 
					   9 Просмотр    
			String: strPar01 !! предустановл фильтр
			String: strPar02
		Window Variables
			Number: nPar
			String: aMfo
			Number: n980
			Date/Time: bDat
			Number: nTmp
			String: sTmp
			String: sFilter_SOS
			String: sNBS
			Number: nUser
			String: sFilter
			String: sTitl
			String: sSql
			String: sFilter_Pr
			Number: nCol[2]
			! Number: nCol1
			! cDoc: cDoc
.winattr class :
				Class: cDoc
.end
		Message Actions
			On SAM_Create
				Set nPar= pPar
				Set aMfo = GetBankMfo()
				Set XD0.nTabInstance = 1
				Set XD0.strPrintFileName = 'XD'||Str(nPar)
				Set XD0.strFilterTblName = 'XD0'
				Set bDat = GetBankDate()
				Set n980 = GetBaseVal()
				Set nCol[0]= SalColorFromRGB( 255,240,255 )  ! розовый
				Set nCol[1]= SalColorFromRGB( 220,255,255 ) ! голубой
				!
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 13 )
				Set nUser = GetUserId()
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call F_Start ()
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Set sSql =
						"SELECT XD0.BRANCH, XD0.INSP, XD0.SOS, XD0.RNK, XD0.NMK, XD0.CC_ID, XD0.ND, 
						        XD0.DAT1, XD0.DAT4, XD0.NLS, XD0.ACC, XD0.SDOG, XD0.OSTC, XD0.DK
						 INTO  :hWndForm.XD0.BRANCH,:hWndForm.XD0.INSP,:hWndForm.XD0.SOS,:hWndForm.XD0.RNK,
						       :hWndForm.XD0.NMK, :hWndForm.XD0.CC_ID, :hWndForm.XD0.ND,
						       :hWndForm.XD0.DAT1,:hWndForm.XD0.DAT4,  :hWndForm.XD0.NLS,:hWndForm.XD0.ACC,  
						       :hWndForm.XD0.SDOG,:hWndForm.XD0.OSTC,  :hWndForm.XD0.DK 
						 FROM (SELECT d.user_id INSP, d.SOS, d.RNK, c.NMK, d.CC_ID, d.ND, 
						              d.sdate DAT1, d.wdate DAT4, a.NLS, a.ACC, d.SDOG,
						              a.ostc/100 OSTC, d.BRANCH , decode(d.vidd,350,0,1) DK           
						       FROM cc_deal d, customer c, accounts a, nd_acc n  
						       WHERE d.nd=n.nd (+) and n.acc=a.acc (+) and d.vidd in (360,350) 
						         and d.rnk=c.rnk " || sFilter_SOS ||  " ) XD0  " || 
						         IifS (sFilter = "", "", " WHERE" || sFilter ) || "
						 ORDER BY XD0.ND desc "
				Call SalTblPopulate(hWndForm, hSql(), XD0.sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Update
				If nPar = 1
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow, 
							 ROW_New | ROW_Edited | ROW_MarkDeleted , 0)
						Call SalTblSetContext(hWndForm, nRow)
						! Insert
						If SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
								 and hWndForm.XD0.ND   = NUMBER_Null 
							! Call Debug ('1')
							If SqlPrepareAndExecute( hSql(),  "INSERT into XD_v0
									( ISP, cc_id, dk, rnk, DAT1, DAT4, nls,  sdog ) 
									 values 
									(:hWndForm.XD0.INSP,:hWndForm.XD0.CC_ID,:hWndForm.XD0.DK,
									 :hWndForm.XD0.RNK, :hWndForm.XD0.DAT1, :hWndForm.XD0.DAT4,
									 :hWndForm.XD0.NLS, :hWndForm.XD0.SDOG)" )
								! Call Debug ('2')
								If SqlCommitEx( hSql(), "Введен ХД "||CC_ID )
								! Call Debug ('3')
						! Update
						Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_Edited ) 
								and hWndForm.XD0.ND != NUMBER_Null and hWndForm.XD0.SOS=0  
							If SqlPrepareAndExecute( hSql(),
									   "UPDATE XD_v0 set 
									      ISP = :hWndForm.XD0.INSP,cc_id = :hWndForm.XD0.CC_ID,
									      dk  = :hWndForm.XD0.DK  ,rnk   = :hWndForm.XD0.RNK,
									      DAT1= :hWndForm.XD0.DAT1,DAT4  = :hWndForm.XD0.DAT4,
									      nls = :hWndForm.XD0.NLS ,sdog  = :hWndForm.XD0.SDOG 
									    where nd= :hWndForm.XD0.ND ") 
									and SqlCommitEx( hSql(), "Изменен Дог XD "||Str(ND) )
						! Delete
						Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_MarkDeleted ) 
							If ND != NUMBER_Null and ( SOS=0 or SOS=2  ) 
								If SqlPrepareAndExecute( hSql(), "delete from nd_acc where nd= :ND ")
										and SqlPrepareAndExecute( hSql(),"delete from cc_deal where nd=:ND ") 
										and SqlCommitEx( hSql(), "Удален Дог XD "||Str(ND)  )
					!
				Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
			On SAM_FetchRowDone
				Call XSalTblSetRowBackColor( hWndForm, lParam, nCol[DK] )
				If XD0.DAT4 <= bDat
					Call XSalTblSetCellBackColor( XD0.DAT4, SalColorFromRGB( 255,210,210 ) )
				If SOS = NUMBER_Null or SOS=0
					Set sSOS = "Новый"
				Else If SOS=2
					Set sSOS = "Передан"
				Else If SOS=10
					Set sSOS = "Активирован"
				Else If SOS=15
					Set sSOS = "Завершен"
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
				Set sSOS = Str(SOS)||' '|| sSOS
				If SOS >= 2 and nPar=1 
						OR SOS >= 10 and nPar=3 
					Set OTM = 1
			On SAM_TblDoDetails
	Dialog Box: BRP
		Class:
		Property Template:
		Class DLL Name:
		Title: Уточнить пл.инструкции для капитализации %% 
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  8.067"
				Width Editable? Yes
				Height: 3.81"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			!
			Radio Button: rb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: На другой счет
				Window Location and Size
					Left:   0.383"
					Top:    0.262"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Radio Button: rb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: На основной счет
				Window Location and Size
					Left:   0.35"
					Top:    1.369"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
			!
			Data Field: KV2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    0.571"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: MFO2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.083"
						Top:    0.571"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NLS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.083"
						Top:    0.571"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: S2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.083"
						Top:    0.571"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NMS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    0.905"
						Width:  6.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Data Field: KV1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.25"
						Top:    1.679"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: MFO1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.05"
						Top:    1.679"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NLS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.05"
						Top:    1.679"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: S1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.05"
						Top:    1.679"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NMS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.25"
						Top:    2.012"
						Width:  6.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Выполнить
				Window Location and Size
					Left:   0.283"
					Top:    2.405"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.476"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If rb1
							Set nKVB = KV
							Set sNLSB= NLS 
							Set sMFOB=aMfo
							Set sNAMB=sNms
							Set nS2  = nS
							Set TT2 = TT1
						Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отказаться
				Window Location and Size
					Left:   1.483"
					Top:    2.405"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.476"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
		Functions
		Window Parameters
			Receive String: TT2
			Receive Number: nKVB
			Receive String: sNLSB
			Receive String: sMFOB
			Receive String: sNAMB
			Receive Number: nS2
			!
			String: TT1 
			Number: KV 
			String: NLS 
			String: aMfo 
			String: sNms
			Number: nS 
			!
		Window Variables
		Message Actions
			On SAM_Create
				Set rb2  = TRUE
				Set rb1  = FALSE
				!
				Set KV2  = nKVB
				Set MFO2 = sMFOB
				Set NLS2 = sNLSB
				Set NMS2 = sNAMB
				Set S2   = nS2/100
				!
				Set KV1  = KV
				Set MFO1 = aMfo
				Set NLS1 = NLS
				Set NMS1 = sNms
				Set S1   = nS/100
				!
				!
				Call SalCenterWindow(hWndForm)
	Form Window: BR0 ! Управление баз.ставками по бронированию средств на сч.ХО
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title: Управление баз.ставками по бронированию средств на сч.ХО
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  16.7"
				Width Editable? Class Default
				Height: 6.31"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Добавить новую запись'
							If nPar = 0
								Call SalDisableWindow( pbIns )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Insert, 0, 0 )
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Пометить/Снять пометку на удаление'
							If nPar = 0
								Call SalDisableWindow( pbDel )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Delete, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Внести изменения в Базу Данных'
							If nPar = 0
								Call SalDisableWindow( pbUpdate )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Update, 0, 0)
				Line
					Resource Id: 10083
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10084
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 10085
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			!
			Child Table: tbl
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  9.017"
						Width Editable? Class Default
						Height: 2.012"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Class Default
				Contents
					Column: BR_ID 
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								баз.ст.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.817"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME  
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование 
								базовой ставки
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.133"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: BR_TYPE 
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								типа.ст.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.9"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If BR_TYPE != 3 and BR_TYPE !=6 OR BR_TYPE=NUMBER_Null
									Set BR_TYPE = nTmp
							On SAM_SetFocus
								If BR_TYPE = NUMBER_Null
									Set BR_TYPE = 3
								Set nTmp = BR_TYPE
					Column: NAME_T
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование 
								типа ставки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Set BR0.strSqlDelete = "delete from BRATES where BR_ID = :BR0.tbl.BR_ID "
						Set BR0.strSqlInsert = "insert into BRATES (BR_ID, BR_TYPE, NAME) values (:BR0.tbl.BR_ID,:BR0.tbl.BR_TYPE,:BR0.tbl.NAME) "
						Set BR0.strSqlUpdate = "update BRATES set NAME = :BR0.tbl.NAME, BR_TYPE = :BR0.tbl.BR_TYPE where BR_ID = :BR0.tbl.BR_ID "
						Call SalSendClassMessage(SAM_Create, 0, 0)
					On SAM_CreateComplete
						If nPar = 0
							Call SalDisableWindow( tbl.NAME )
							Call SalDisableWindow( tbl.BR_TYPE )
						Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set BR0.strSqlPopulate = 
								"SELECT BR_ID, BR_TYPE, NAME 
								 into :BR0.tbl.BR_ID,:BR0.tbl.BR_TYPE,:BR0.tbl.NAME 
								 FROM  BRATES WHERE BR_ID >50000  and BR_TYPE =3 
								 ORDER BY BR_ID "
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), BR0.strSqlPopulate, TBL_FillAll )
						Set nRow = VisTblFindString (tbl, 0, tbl.BR_ID, Str(nSch))
						If nRow=-1
							Call SalTblSetContext( hWndForm, 0 )
						Else
							Call SalTblSetContext ( hWndForm, nRow )
							Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, TRUE )
							Call SalTblSetFocusRow( hWndForm, nRow )
						Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
						Call SalWaitCursor(FALSE)
					On SAM_TblDoDetails
						Set nSch=tbl.BR_ID
						Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
						Call SalSendMsg( tbl3, UM_Populate, 0, 0 )
					On SAM_SetFocus
						If nPar = 1
							Call SalEnableWindow( pbIns )
							Call SalEnableWindow( pbDel )
					On SAM_KillFocus
						Set hWndLost = BR0.tbl
					On UM_Update
						Call SalWaitCursor(TRUE)
						!
						Call SqlPrepare( hSql(), BR0.strSqlDelete)
						Call SalTblDoDeletes( BR0.tbl, hSql(),ROW_MarkDeleted)
						!
						Call SqlPrepare( hSql(), BR0.strSqlInsert)
						Call SalTblDoInserts( BR0.tbl, hSql(), TRUE)
						!
						Call SqlPrepare( hSql(), BR0.strSqlUpdate)
						Call SalTblDoUpdates( BR0.tbl, hSql(), TRUE)
						!
						Call SqlCommit(hSql())
						! Call SalPostMsg( BR0.tbl, UM_Populate, 0, 0)
						Call SalSendMsg(BR0.tbl, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On UM_Insert
						If not SalTblAnyRows( BR0.tbl, ROW_New, 0)
							Call SalTblDefineSplitWindow( BR0.tbl, 1, TBL_Split_Adjustable)
						Set nRow = SalTblInsertRow( BR0.tbl, TBL_MinRow)
						Call SalTblSetContext( BR0.tbl, nRow)
						If SqlPrepareAndExecute( hSql(),
								"select min(c.num) into :tbl.BR_ID from conductor c where c.num not in (select BR_ID from brates)") 
								and SqlFetchNext( hSql(),nFetchRes)
							Set nSch = tbl.BR_ID
						Call SalTblSetFocusCell( BR0.tbl, nRow,  BR0.tbl.NAME, 0, 1)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( BR0.tbl, nRow, ROW_Selected, 0)
							If NOT SalTblQueryRowFlags( BR0.tbl, nRow, ROW_New)
								Call SalTblSetRowFlags(BR0.tbl, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(BR0.tbl, nRow, ROW_MarkDeleted))
							Else
								Call SalTblDeleteRow( BR0.tbl, nRow, TBL_NoAdjust)
			!
			Custom Control: cVSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cHSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			!
			Child Table: tbl2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.133"
						Top:    2.333"
						Width:  9.05"
						Width Editable? Yes
						Height: 2.393"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Yes
				Contents
					Column: BDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата начала 
								действия
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.517"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If BDATE = DATETIME_Null
									Set BDATE = GetBankDate()
					Column: KV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								вал
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.35"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If KV = NUMBER_Null
									Set KV = GetBaseVal()
					Column: S
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма "верхняя",
								включитильно, в "коп"
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  2.4"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If S = NUMBER_Null
									Set S = 999999999999
					Column: RATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Значение проц.
								ставки
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  2.917"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If RATE = NUMBER_Null
									Set RATE = 0
					Column: RI
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: RowID
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  2.917"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If RATE = NUMBER_Null
									Set RATE = 0
				Functions
				Window Variables
					String: strSqlPopulate2
					String: strSqlDelete2
					String: strSqlInsert2
					String: strSqlUpdate2
				Message Actions
					On SAM_Create
						Set strSqlPopulate2=
								"SELECT rowid, BDATE, KV, S, RATE  INTO :RI, :BDATE, :KV, :S, :RATE
								 FROM BR_TIER WHERE BR_ID=:nSch order by BDATE,S,KV " 
						Set strSqlDelete2='DELETE FROM BR_TIER WHERE BR_ID=:nSch and rowid=:RI '
						Set strSqlInsert2='INSERT INTO BR_TIER (BR_ID,BDATE,KV,S,RATE) values (:nSch,:BDATE,:KV,:S,:RATE)' 
						Set strSqlUpdate2='UPDATE BR_TIER 
								    SET RATE=:RATE, s=:S, kv=:KV, BDATE=:BDATE where BR_ID=:nSch and rowid=:RI '
						!
					On SAM_CreateComplete
						If nPar = 0
							Call SalDisableWindow( tbl2.BDATE )
							Call SalDisableWindow( tbl2.KV )
							Call SalDisableWindow( tbl2.S )
							Call SalDisableWindow( tbl2.RATE )
						Call SalSendMsg( BR0.tbl2, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Call SalTblDefineSplitWindow( BR0.tbl2, 0, FALSE)
						Call SalTblPopulate( BR0.tbl2, hSql(), strSqlPopulate2, TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_SetFocus
						If nPar = 1
							Call SalEnableWindow( pbIns )
							Call SalEnableWindow( pbDel )
					On SAM_KillFocus
						Set hWndLost = BR0.tbl2
					On UM_Update
						Call SalWaitCursor(TRUE)
						!
						Call SqlPrepare( hSql(), strSqlDelete2)
						Call SalTblDoDeletes( BR0.tbl2, hSql(),ROW_MarkDeleted)
						!
						Call SqlPrepare( hSql(), strSqlInsert2)
						Call SalTblDoInserts( BR0.tbl2, hSql(), TRUE)
						!
						Call SqlPrepare( hSql(), strSqlUpdate2)
						Call SalTblDoUpdates( BR0.tbl2, hSql(), TRUE)
						!
						Call SqlCommit(hSql())
						! Call SalPostMsg( BR0.tbl2, UM_Populate, 0, 0)
						Call SalSendMsg(BR0.tbl2, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On UM_Insert
						If not SalTblAnyRows( BR0.tbl2, ROW_New, 0)
							Call SalTblDefineSplitWindow( BR0.tbl2, 3, TBL_Split_Adjustable)
						Set nRow = SalTblInsertRow( BR0.tbl2, TBL_MinRow)
						Call SalTblSetContext( BR0.tbl2, nRow)
						Call SalTblSetFocusCell( BR0.tbl2, nRow,  BR0.tbl2.BDATE, 0, 1)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
								Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
							Else
								Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
					! On SAM_FetchRowDone
						                                                                                                                                                                                                                                                                                                                                                             Call tbl2.colFreqn.SetSelectById( tbl2.colFreq )
					! On SAM_DoubleClick
						                                                                                                                                                                                                                                                                                                                                                             If tbl2.IDD != NUMBER_Null
							                                                                                                                                                                                                                                                                                                                                                             Call SalModalDialog(dlgCalendar, hWndForm, tbl.NMK, tbl2.colNlsA,
									tbl2.IDD, tbl2.colFreq, tbl2.colDat1, tbl2.colDat2, tbl2.WEND, tbl2.colFreqn )
			!
			Child Table: tbl3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   9.283"
						Top:    -0.036"
						Width:  5.4"
						Width Editable? Yes
						Height: 4.702"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Yes
				Contents
					Column: BRANCH
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								Branch
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: BRANCH_NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование 
								Branch
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.217"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OTM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Включить/
								Исключить
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: F_UPD
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalWaitCursor( TRUE )
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(BR0.tbl3, nRow, ROW_Edited, 0)
								Call SalTblSetContext(BR0.tbl3, nRow)
								If NOT SqlPrepareAndExecute( hSql(),"delete from br_branch where branch=:BRANCH and BR=:nSch " )
									Return FALSE
								!
								If BR0.tbl3.OTM = 1 
									If NOT SqlPrepareAndExecute( hSql(),"insert into br_branch(branch,br) values (:BRANCH,:nSch) " )
										Return FALSE
							!
							Return TRUE
				Window Variables
					String: strSqlPop
				Message Actions
					On SAM_Create
						! Set strSqlPop =
								"SELECT a.tobo, a.name, decode(b.br,null,0,1) 
								 INTO :BR0.tbl3.BRANCH, :BR0.tbl3.BRANCH_NAME, :BR0.tbl3.OTM 
								 FROM br_branch b, tobo a 
								 WHERE a.tobo=b.branch (+) and :nSch = b.BR (+) "|| sTOBO ||"
								 order by a.tobo" 
						Set strSqlPop =
								"SELECT a.tobo, a.name, decode(b.br,null,0,1) 
								 INTO :BR0.tbl3.BRANCH, :BR0.tbl3.BRANCH_NAME, :BR0.tbl3.OTM 
								 FROM br_branch b, tobo a 
								 WHERE a.tobo=b.branch (+) and :nSch = b.BR (+) "|| 
								IifS (nPar=0," and a.tobo='"||aTOBO ||"'",sTOBO) || "
								 order by a.tobo" 
					On SAM_CreateComplete
						If nPar = 0
							Call SalDisableWindow( tbl3 )
						Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), strSqlPop, TBL_FillAll )
						Call SalWaitCursor(FALSE)
					On SAM_SetFocus
						If nPar = 1
							Call SalDisableWindow( pbIns )
							Call SalDisableWindow( pbDel )
					On SAM_KillFocus
						Set hWndLost = BR0.tbl3
					On UM_Update
						If tbl3.F_UPD()
							Call SqlCommit( hSql())
						Else
							Call SqlRollback( hSql())
						Call SalSendMsg(BR0.tbl3, UM_Populate, 0, 0)
			!
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Window Handle: hWndLost
			Number: nRow
			Number: nSch
			Number: nTmp
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				! Call SetWindowFullSize(hWndForm)
				Call SalShowWindow(cVSpl)
				Call SalShowWindow(cHSpl)
				!
				Call cVSpl.setBarPosition(600)
				Call cVSpl.setLeftFrame(cHSpl)
				Call cVSpl.setRightFrame(tbl3)
				!
				Call cHSpl.setBarPosition(500)
				Call cHSpl.setTopFrame(tbl)
				Call cHSpl.setBottomFrame(tbl2)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Table Window: PRV
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Перегляд проводок
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.163"
				Top:    0.146"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.464"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.131"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перегляд документа в цілому'
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.071"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Green
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата "З" ')
						On SAM_Create
							! Set DAT1 = GetBankDate() -1 
							! Set DAT2 = DAT1
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.083"
							Top:    0.071"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата "По" ')
				!
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Data Field: MASD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.483"
							Top:    0.071"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '"Маска" Дебет ')
				Data Field: MASK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.783"
							Top:    0.071"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '"Маска" Кредит ')
				!
				Frame
					Resource Id: 61147
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.983"
						Top:    0.405"
						Width:  7.1"
						Width Editable? Yes
						Height: 0.667"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rbP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Похож
					Window Location and Size
						Left:   5.083"
						Top:    0.488"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.238"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Green
					Background Color: Default
					Message Actions
				Radio Button: rbN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: НЕ похож
					Window Location and Size
						Left:   7.683"
						Top:    0.488"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.238"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold-Strikeout
					Text Color: Dark Red
					Background Color: Default
					Message Actions
				Data Field: L_NAZN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   5.083"
							Top:    0.738"
							Width:  6.8"
							Width Editable? Yes
							Height: 0.238"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '"Маска" для Признач пл.')
				Data Field: NAM_TAG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.183"
							Top:    0.738"
							Width:  4.433"
							Width Editable? Yes
							Height: 0.238"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва вибраного дод.рекв.')
				Data Field: TAG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   12.683"
							Top:    0.405"
							Width:  3.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Коди(ТЕГи) вибраних дод.рекв.')
				!
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 54876
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 54877
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 54878
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Check Box: cb_Storno
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Тільки "Сторно"
					Window Location and Size
						Left:   0.183"
						Top:    0.405"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Red
					Background Color: Default
					Message Actions
				Check Box: cb_Zo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Тільки "Корр."
					Window Location and Size
						Left:   0.183"
						Top:    0.905"
						Width:  2.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Marigold
					Background Color: Default
					Message Actions
				Check Box: cb_Valuta
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Тільки "Куп/Прод гот вал та БМ"
					Window Location and Size
						Left:   0.183"
						Top:    0.655"
						Width:  3.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Message Actions
				Data Field: Kol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.083"
							Top:    0.071"
							Width:  0.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: Sq
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.683"
							Top:    0.405"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pb_Dop
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.183"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\NOTEPAD.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Periwinkle
					Message Actions
						On SAM_Create
							Set strTip = 'Мають додатковий реквiзит (ТЕГ)'
						On SAM_Click
							Call F_Dop()
		Contents
			Column: PDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата/час вводу 
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.783"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						проводки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Референс
						проводки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TT 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						оп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: String
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNKD 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Pег.№
						Дебет
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OB_D 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ан.
						Дб
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSD 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Pахунок
						Дебет
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMSD 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва Pах.
						Дебет
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNKK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Pег.№
						Кредит
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OB_K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ан.
						Кр
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSK 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Pахунок
						Кредит
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMSK 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва Pах.
						Кредит
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума в 
						номіналі
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SQ 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума в 
						еквіваленті
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Призначення 
						пл.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  4.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRND 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бранч Pах.
						Дебет
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRNK 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бранч Pах.
						Кредит
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOSO 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бранч Pах.
						Кредит
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VOB 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
						оп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Dop
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
					String: sTmp1
				Actions
					Set sTmp = STRING_Null
					Call FunNSIGetFiltered("OP_FIELD","NAME",
							 " name is not null",sTmp, sTmp1 )
					If sTmp != STRING_Null
						Set NAM_TAG = SalStrTrimX( sTmp1 )
						Set TAG = SalStrTrimX( TAG)
						If TAG != STRING_Null
							Set TAG = TAG || ","
						Set TAG = TAG ||"'"||sTmp||"'"
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			! Фильтр на маски счетов
			String: sMaski
			! Доп.фильтр пользователя
			String: sFilter
			! Фильтр на даты
			String: sDAT1
			String: sDAT2
			String: sSqlD
			! Фильтр на СТОРНО
			String: fStorno
			! Фильтр на куп/прож вал +БМ
			String: fValuta
			!
			String: sOpldok
			String: sProvodki
			String: sSql1
			String: sSql
			String: aBranch
			!
		Message Actions
			On SAM_Create
				Set PRV.nTabInstance = 1
				Set PRV.strPrintFileName = 'PROVODKI'
				Set PRV.strFilterTblName = 'PROVODKI'
				Set DAT1 = GetBankDate() - 1
				Set DAT2 = GetBankDate() - 1
				Set cb_Storno = 0
				Set cb_Valuta = 0
				Set cb_Zo = 0
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
				!
			On SAM_CreateComplete
				If gOB22 = "1"
					Call SalShowWindow( hWndForm.PRV.OB_D )
					Call SalShowWindow( hWndForm.PRV.OB_K )
				Else
					Call SalHideWindow( hWndForm.PRV.OB_D )
					Call SalHideWindow( hWndForm.PRV.OB_K )
				Call SalWaitCursor(FALSE)
			On UM_Populate
				If DAT1 = DATETIME_Null OR DAT2 = DATETIME_Null OR DAT1 > DAT2 
					Call SalMessageBox('Не визначено період  !', 'Дати " З <-> По "', MB_IconStop)
					Return FALSE
				!
				If cb_Storno = 0 and cb_Valuta = 0
					If SalStrLength( MASD ) + SalStrLength( MASK ) < 4
						Call SalMessageBox(
								'Маски рахункiв Дб та Кр (заг довжиною не менше 4-х симв.),
								 Маски рахункiв схожі на %...',
								'Недостатньо параметрів фільтру !',
								 MB_IconStop)
						Return FALSE
				If SqlPrepareAndExecute( hSql(),
						 "select Substr(sys_context('bars_context','user_branch') ||'%',1,30)   
						  into :aBranch from dual" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
				! Call Debug(aBranch)
				!
				Call SalWaitCursor(TRUE)
				! Доп.фильтр пользователя
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				! Фильтр на даты
				Set sDAT1 = "to_date('" || SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' ) || "','dd/MM/yyyy') " 
				Set sDAT2 = "to_date('" || SalFmtFormatDateTime( DAT2, 'dd/MM/yyyy' ) || "','dd/MM/yyyy') " 
				Set sSqlD = "where sos>=4 and fdat>=" || sDAT1 || " and fdat <= "|| sDAT2 
				! Фильтр на СТОРНО
				Set fStorno = IifS ( cb_Storno = 0, "",  
						 " and ( tt='BAK' or exists (select 1 from oper where sos<0 and oper.ref=opldok.ref) )" )
				! Из OPLDOK
				Set sOpldok = 
						"(select ref,stmt,fdat,tt,s,sq, sum(decode(dk,0,acc,0)) ACCD,sum(decode(dk,1,acc,0)) ACCk 
						  from opldok " || sSqlD || fStorno|| " 
						  group by ref,stmt,fdat,tt,s,sq ) "
				! !!!!!
				! Фильтр на куп/прож вал +БМ
				Set fValuta =  IifS ( cb_Valuta = 0, "",  
						 " and (ad.nbs in ('1001','1002','1101','1102') and ak.nbs in ('3800','3801') OR 
						        ak.nbs in ('1001','1002','1101','1102') and ad.nbs in ('3800','3801') )" )
				! Фильтр на маски счетов
				Set MASD = SalStrTrimX( MASD )
				Set MASD = VisStrSubstitute( MASD, "*", "%" )
				Set MASD = VisStrSubstitute( MASD, " ", "" )
				!
				Set MASK = SalStrTrimX( MASK )
				Set MASK = VisStrSubstitute( MASK, "*", "%" )
				Set MASK = VisStrSubstitute( MASK, " ", "%" )
				!
				If MASD = STRING_Null
					Set MASD = "%"
				If MASK = STRING_Null
					Set MASK = "%"
				Set sMaski =
						" and ad.nls like replace('"||MASD||"','*','%') and ak.nls like replace('"||MASK||"','*','%') "
				! Результирующий SQL
				! OPLDOK + ACCOUNTS = Provodki
				Set sProvodki = 
						"(SELECT o.FDAT,o.REF,o.TT,ad.KV, ad.rnk RNKD," ||
						 IifS(gOB22 = "1", " ad.ob22 ", "'00'" ) || " OB_D, ad.nls NLSD,ad.nms NMSD, 
						   ak.rnk RNKK," || 
						 IifS(gOB22 = "1", " ak.ob22 ", "'00'" ) || " OB_K, ak.nls NLSK,ak.nms NMSK, 
						         o.S/100 S, o.SQ/100 SQ, ad.BRANCH BRANCH_A, ak.BRANCH BRANCH_B        
						  FROM " || sOpldok || " o, accounts ak,  accounts ad  
						  WHERE (ad.branch like '"||aBranch||"' OR ak.branch like '"||aBranch||"' ) 
						    and ad.acc = o.accD AND ak.acc = o.accK " || fValuta || sMaski || " )"
				Set sSql1 = 
						"SELECT *  FROM " ||sProvodki || " PROVODKI " || IifS ( sFilter != STRING_Null, " where " || sFilter,"") 
				!
				Set sSql  =
						"SELECT n.PDAT,i.FDAT,i.REF,i.TT,i.KV,i.RNKD, i.OB_D, i.NLSD,i.NMSD,
						                               i.RNKK, i.OB_K, i.NLSK,i.NMSK,
						        i.S, i.SQ, i.BRANCH_A, i.BRANCH_B,
						        n.NAZN, n.sos, n.VOB  
						 INTO  :hWndForm.PRV.PDAT, :hWndForm.PRV.FDAT, :hWndForm.PRV.REF,  :hWndForm.PRV.TT,  :hWndForm.PRV.KV,   
						       :hWndForm.PRV.RNKD, :hWndForm.PRV.OB_D, :hWndForm.PRV.NLSD, :hWndForm.PRV.NMSD,
						       :hWndForm.PRV.RNKK, :hWndForm.PRV.OB_K, :hWndForm.PRV.NLSK, :hWndForm.PRV.NMSK, :hWndForm.PRV.S,
						       :hWndForm.PRV.SQ,   :hWndForm.PRV.BRND, :hWndForm.PRV.BRNK, 
						       :hWndForm.PRV.NAZN, :hWndForm.PRV.SOSO, :hWndForm.PRV.VOB 
						 from (" || sSql1 || ") i, oper n where i.ref=n.ref " ||
						 IifS ( cb_Zo = 0, "", " and n.vob in (96,99) ") ||
						 IifS ( L_NAZN = STRING_Null, "",
						"and upper(n.NAZN)" || IifS(rbN, " NOT","" ) || " like replace(upper('" || L_NAZN || "'),'*','%' )" 
						       ) 
				If TAG != STRING_Null
					Set sSql  = sSql || 
							" and exists (select 1 from operw w where w.ref=n.ref and w.tag in ("||TAG||"))"
				! Call Debug( Subs(sSql,0001,400))
				! Call Debug( Subs(sSql,0401,400))
				! Call Debug( Subs(sSql,0801,400))
				! Call Debug( Subs(sSql,1201,400))
				! Call Debug( Subs(sSql,1601,400))
				! Call Debug( Subs(sSql,2001,400))
				! Call Debug( Subs(sSql,2401,400))
				! Call Debug( Subs(sSql,2801,400))
				! Call Debug( Subs(sSql,3201,400))
				Set Kol = 0
				Set Sq = 0
				Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If TT = 'BAK' or SOSO <0
					! розовый СТОРНИРОВАНЫ
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,250 ) )
				Else If VOB = 96 or VOB = 99
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Yellow )
				Set Kol = Kol + 1 
				Set Sq = Sq + SQ
			On SAM_DoubleClick
				Call DocViewContentsEx(hWndForm, REF )
						
	Table Window: LOT
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Розрахунки з операторами лотерей
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.288"
				Top:    1.208"
				Width:  19.9"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24153
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.117"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати Розрахунки з операторами лотерей '
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24154
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.817"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24155
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: OB22
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код 
						ОБ22
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва  оператора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: PR1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума-1
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума-1
						Бал.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OB1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума-1
						ОБ22
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: PR2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума-2
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума-2
						Бал.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OB2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума-2
						ОБ22
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: PR3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума-3
						%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BS3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума-3
						Бал.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OB3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума-3
						ОБ22
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
						Банку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
				Visible? No
				Editable? No
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
				Visible? No
				Editable? No
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						попередньго
						розрахунку
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.367"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_G
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок 
						акумуляції
						коштів
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Призн
						0 sysdate
						1 bankdate
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
		Message Actions
			On SAM_Create
				! Set nId  = GetUserId()
				! Set dDat = GetBankDate()
				! Set n980 = GetBaseVal()
				! Set aMfo = GetBankMfo()
				! Set aOkpo= GetBankOkpoS()
				! Call ShowApdVersion('03')
				! Call SalMapEnterToTab( TRUE )
				Set LOT.strSqlPopulate =
						"SELECT OB22, NAME, OKPO, nls, mfo,
						        max(PR1), max(BS1), max(OB1), 
						        max(PR2), max(BS2), max(OB2), 
						        max(PR3), max(BS3), max(OB3),
						        max(NAZN1), max(NAZN2), max(DATP), max(prz)   
						 into :LOT.OB22, :LOT.NAME, :LOT.OKPO, :LOT.NLS, :LOT.MFO,
						      :LOT.PR1,  :LOT.BS1,  :LOT.OB1,
						      :LOT.PR2,  :LOT.BS2,  :LOT.OB2, 
						      :LOT.PR3,  :LOT.BS3,  :LOT.OB3,
						      :LOT.NAZN1,:LOT.NAZN2,:LOT.DATP, :LOT.PRZ 
						 FROM branch_opelot 
						 group by OB22, NAME, OKPO, nls, mfo 
						 order by 1"
				! Set LOT.strSqlPopulate =
						"SELECT OB22,NAME,PR1,BS1,OB1,PR2,BS2,OB2,PR3,BS3,OB3,OKPO,nls,mfo,
						        NAZN1, NAZN2, DATP  
						 into :LOT.OB22,:LOT.NAME,:LOT.PR1,:LOT.BS1,:LOT.OB1,
						      :LOT.PR2, :LOT.BS2, :LOT.OB2,:LOT.PR3,:LOT.BS3,:LOT.OB3,
						      :LOT.OKPO,:LOT.NLS, :LOT.MFO,:LOT.NAZN1,:LOT.NAZN2,:LOT.DATP
						 FROM ope_lot where id = 0 order by 1"
				Call SalTblSetLockedColumns( hWndForm, 2 )
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On SAM_FetchRowDone
				If SqlPrepareAndExecute( hSqlAux2(), 
						"SELECT nls into :NLS_G FROM accounts  
						 where kv=980 and nbs='2905' and ob22 = :OB22 and dazs is null order by branch " )
						and  SqlFetchNext( hSqlAux2(), nFetchRes) 
			On SAM_DoubleClick
				If MFO != STRING_Null and NLS != STRING_Null and OKPO != STRING_Null and NLS_G != STRING_Null
					Call SalCreateWindow( LT1, hWndMDI,nMode,nPar, 
							OB22, NAME, MFO, NLS, OKPO, NAZN1, NAZN2, DATP, NLS_G, PRZ )
	Table Window: LT1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Розрахунки з операторами лотерей
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.013"
				Top:    0.063"
				Width:  15.883"
				Width Editable? Class Default
				Height: 7.25"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 500
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.548"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Data Field: DATP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.071"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Dark Red
						Background Color: Gray
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата попереднього розрахунку' )
						On SAM_Validate
							If DATP > dDat
								Call SalMessageBox ('Дата попереднього розрахунку не м.б. БІЛЬШЕ поточної' ,
										'Помилка !', MB_IconStop)
								Set DATP = pDATP
				Data Field: dDat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.405"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата ПОТОЧНОГО розрахунку' )
						On SAM_Validate
							If DATP > dDat
								Call SalMessageBox ('Дата попереднього розрахунку не м.б. БІЛЬШЕ поточної' ,
										'Помилка !', MB_IconStop)
								Set dDat = GetBankDate()
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: REF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.283"
							Top:    0.071"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On VTM_LeftDoubleClick
							If REF > 0 
								Call DocViewContentsEx(hWndForm, REF )
						On SAM_SetFocus
							Set nTmpE = REF
						On SAM_AnyEdit
							Set REF = nTmpE
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Референс док-1 (розщеплення)' )
				Data Field: dNLS_G
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   5.083"
							Top:    0.071"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_SetFocus
							Set sTmpE = dNLS_G
						On SAM_AnyEdit
							Set dNLS_G = sTmpE
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок акумуляції коштів' )
				!
				Pushbutton: pb_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\CHILDS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати ' || sTitl
						On SAM_Click
							If SalMessageBox('Ви дiйсно бажаєте
									' || strTip || '
									(розщеплення) ? ',
									'У в а г а ! ', MB_IconQuestion | MB_YesNo) = IDYES
								If Not F_Fun1()
									Call SqlRollback( hSql() )
								Else
									Call SqlCommitEx(  hSql(), strTip || '. Реф='|| Str(nRef))
									Set REF= nRef
				!
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				!
				Data Field: SALDO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.883"
							Top:    0.071"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam,
									 'Сальдо 2905/'|| OB22 || ' для перерахування коштів ' || NAME )
				Data Field: REF2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   12.083"
							Top:    0.071"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Референс док-2 (перерахування коштів)' )
						On VTM_LeftDoubleClick
							If REF2 > 0 
								Call DocViewContentsEx(hWndForm, REF2 )
						On SAM_SetFocus
							Set nTmpE = REF2
						On SAM_AnyEdit
							Set REF2 = nTmpE
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути сформовану операцію на розщеплення'
						On SAM_Click
							If REF > 0 
								Call DocViewContentsEx(hWndForm, REF )
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24159
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24160
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24161
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Reestr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Call SalDisableWindow( pb_Reestr )
							Set strTip = 
									'Переглянути/Роздрукувати сформований реєстр проводок на 
									' || sTitl
						On SAM_Click
							Call SalCreateWindow( LT2, hWndMDI,REF,REF2, sTitl, OB22 )
				Data Field: NAZN1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 160
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.988"
							Width:  14.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Призначення пл. для док-1 (розщеплення)' )
				Data Field: NAZN2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 160
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    1.238"
							Width:  14.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Призначення пл. для док-2(перерахування коштів)' )
				Check Box: cb_Zo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Корр.об.
					Window Location and Size
						Left:   3.583"
						Top:    0.405"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				!
				Data Field: REZ_NLS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   5.083"
							Top:    0.405"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_SetFocus
							Set sTmpE = REZ_NLS
						On SAM_AnyEdit
							Set REZ_NLS = sTmpE
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок постійного залишку (резерв)' )
				Data Field: REZ_OSTd
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.283"
							Top:    0.405"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сальдо рахунку постійного залишку (резерв)' )
				Data Field: REZ_SUMd
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.883"
							Top:    0.405"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Норма рахунку постійного залишку (резерв)' )
				Data Field: REZ_Sd
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.083"
							Top:    0.405"
							Width:  2.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сумма дорезервування ' )
				Radio Button: rb_R
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: На Ранок
					Window Location and Size
						Left:   0.383"
						Top:    0.738"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Radio Button: rb_V
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: На Вечiр
					Window Location and Size
						Left:   2.583"
						Top:    0.738"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
		Contents
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бранч
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS29
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.
						2905/2805
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST29
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залиш-1
						2905/2805
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.
						6119/01
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PR1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						6119/01
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						6119/01
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NLS02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.
						3622/51
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PR2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						3622/51
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						3622/51
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NLS03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.
						6110/60
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PR3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						6110/60
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						6110/60
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OST29_2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залиш-2
						2905/2805
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						3622/51
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Fun1
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sNLS_G
					Number: nS1
					Number: nS2
					Number: nS3
					Number: nS4
					Number: nS5
					Number: nITOG
					String: sNazn1
					String: sNazn2
					!
					String: sBr3
					Number: nBr3
					Number: nBr36
					Number: nBr2
					!
				Actions
					!
					Set nRow = TBL_MinRow
					Set sNLS_G = STRING_Null 
					Set nITOG = 0
					Set sPeriod =  ' Перiод : ' || 
							SalFmtFormatDateTime( DATP + 1, "dd.MM.yyyy" ) || ' - ' || 
							SalFmtFormatDateTime( dDat, "dd.MM.yyyy" )  
					Set sNazn1 =  Subs( NAZN1 || sPeriod,1,160 )
					Set sNazn2 =  Subs( NAZN2 || sPeriod,1,160 )
					If NOT SqlPrepareAndExecute( hSql(),
							"update branch_opelot o 
							 set NAZN1 = :NAZN1, 
							     DATP  = :dDat, 
							     NAZN2 = :NAZN2 
							 where OB22 = :OB22 and " || sAnd )
						Return FALSE
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						! 2905 OTM = 0 ; 2805 OOTM = 1
						If OTM >= 0
							! 2905 - на разніе
							If OTM = 0
								Set nS3 = OST03 * 100
								Set nS2 = OST02 * 100
								Set nS1 = OST01 * 100
								Set nS4 = OST29_2 *100
								Set nITOG = nITOG + nS4
							! 2905 - на 2805
							Else
								Set nS5 = - OST29 * 100
							! Первый док не д.б. на 2805
							If sNLS_G = STRING_Null 
								If OTM =1 
									Return FALSE
								!
								Set sNLS_G = dNLS_G
								Call cDoc.SetDoc( 0, sTT, 1, IifN(cb_Zo = 0, nVob, 96), STRING_Null,
										     dDat, dDat, dDat, dDat,
										     NLS29, NAME, aMfo,'', n980, nS3, aOkpo,
										     NLS03, aName, aMfo,'', n980, nS3, aOkpo,
										     sNazn1, '', GetIdOper(), '', NUMBER_Null, 0 )
								If NOT cDoc.oDoc() 
									Return FALSE
								Set nRef = cDoc.m_nRef
								If NOT F_Fun2(nRef ,"Розщеплення: за наданi послуги ") 
									Return FALSE
								If sNLS_G != NLS29 
									If nS4 >0 
										If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980, NLS29,nS4, n980,sNLS_G,nS4)
											Return FALSE
										If NOT F_Fun2(nRef ,"Акумуляцiя загальної суми")
											Return FALSE
							! Следующие
							Else
								! 2905 - на разніе
								If OTM = 0
									If nS3 >0 
										! Курсор по бранчам -3
										Set nBr2 = nS3 
										! If SqlPrepareAndExecute(hSqlAux2(), 
												"select p.branch,  sum(o.s ) 
												 into :sBr3, :nBr3 
												 from opldok o, oper p, accounts a 
												 where a.kv =:n980 and a.nls = :NLS29 
												   and a.acc= o.acc and o.dk=1 
												   and o.fdat >  :DATP 
												   and o.fdat <= :dDat 
												   and o.ref = p.ref 
												 group by p.branch " )
										If SqlPrepareAndExecute(hSqlAux2(),  sSql_3  )
											While SqlFetchNext( hSqlAux2(), nFetchRes ) 
												Set nBr36 = SalNumberRound( (nS3*nBr3)/(OST29*100) + 0.5 )
												Set nBr36 = SalNumberMin( nBr36, nBr2 )
												If nBr36 > 0
													Set nBr2 = nBr2 - nBr36
													If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980,NLS29,nBr36, n980,NLS03,nBr36)
														Return FALSE
													If NOT F_Fun2(nRef ,sBr3 )
														Return FALSE
									!
									If nS4 >0 
										If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980, NLS29,nS4,n980,sNLS_G,nS4)
											Return FALSE
										If NOT F_Fun2(nRef ,"Акумуляцiя загальної суми")
											Return FALSE
							! 2905 - на разніе
							If OTM = 0 
								If nS1 >0 
									! Курсор по бранчам -3
									Set nBr2 = nS1 
									! If SqlPrepareAndExecute(hSqlAux2(), 
											"select p.branch,  sum(o.s ) 
											 into :sBr3, :nBr3 
											 from opldok o, oper p, accounts a 
											 where a.kv =:n980 and a.nls = :NLS29 
											   and a.acc= o.acc and o.dk=1 
											   and o.fdat > :DATP 
											   and o.fdat <= :dDat 
											   and o.ref = p.ref 
											 group by p.branch " )
									If SqlPrepareAndExecute(hSqlAux2(), sSql_3 )
										While SqlFetchNext( hSqlAux2(), nFetchRes ) 
											Set nBr36 = SalNumberRound( (nS1*nBr3)/(OST29*100) + 0.5 )
											Set nBr36 = SalNumberMin( nBr36, nBr2 )
											If nBr36 > 0
												Set nBr2 = nBr2 - nBr36
												If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980,NLS29,nBr36,n980,NLS01,nBr36 )
													Return FALSE
												If NOT F_Fun2(nRef ,sBr3 )
													Return FALSE
								If nS2 >0 
									If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980,NLS29,nS2,n980,NLS02,nS2)
										Return FALSE
									If NOT F_Fun2(nRef ,"Розщеплення: ПДВ ")
										Return FALSE
							! 2905 - на 2805
							Else
								If nITOG > 0 and nS5 > 0 
									Set nS5 = SalNumberMin( nITOG, nS5 )
									If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980,sNLS_G,nS5,n980,NLS29,nS5)
										Return FALSE
									If NOT F_Fun2(nRef ,"Перекриття сплачених (деб.заборг.)")
										Return FALSE
									Set nITOG = nITOG - nS5
					! Call Debug ( 'nITOG='||Str(nITOG)||' REZ_S='||Str(REZ_S))
					If nITOG > 0  and REZ_S > 0
						Set REZ_S = SalNumberMin( REZ_S, nITOG )
						If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980,sNLS_G , REZ_S,  n980, REZ_NLS, REZ_S )
							Return FALSE
						If NOT F_Fun2(nRef ,"Формування постiйного залишку")
							Return FALSE
						Set nITOG = nITOG - REZ_S
					If nITOG > 0 
						Call cDoc.SetDoc( 
								     0, IifS(aMfo = MFO, sTT, sTT2 ), 1, nVob, STRING_Null,
								     dDat, dDat, dDat, dDat,
								     sNLS_G, aName, aMfo,'', n980, nITOG, aOkpo,
								     NLS  , NAME,  MFO, '', n980, nITOG, OKPO,
								     sNazn2, '', GetIdOper(), '', NUMBER_Null, 0 )
						If NOT cDoc.oDoc()
							Return FALSE
						! Set nRef = cDoc.m_nRef
						Set REF2 = cDoc.m_nRef
						Set SALDO = nITOG /100
						Call SalEnableWindow( pb_Reestr )
					Return TRUE
			! Function: F_Fun1
				                Description: 
				                Returns 
				                Parameters 
				                Static Variables 
				                Local variables 
					                String: sNLS_G
					                Number: nS1
					                Number: nS2
					                Number: nS3
					                Number: nS4
					                Number: nS5
					                Number: nITOG
					                String: sNazn1
					                String: sNazn2
					!
					!
				                Actions 
					!
					                Set nRow = TBL_MinRow
					                Set sNLS_G = STRING_Null 
					                Set nITOG = 0
					                Set sPeriod =  ' Перiод : ' || 
							SalFmtFormatDateTime( DATP + 1, "dd.MM.yyyy" ) || ' - ' || 
							SalFmtFormatDateTime( dDat, "dd.MM.yyyy" )  
					                Set sNazn1 =  Subs( NAZN1 || sPeriod,1,160 )
					                Set sNazn2 =  Subs( NAZN2 || sPeriod,1,160 )
					                If NOT SqlPrepareAndExecute( hSql(),
							"update branch_opelot o 
							 set NAZN1 = :NAZN1, 
							     DATP  = :dDat, 
							     NAZN2 = :NAZN2 
							 where OB22 = :OB22 and " || sAnd )
						                Return FALSE
					                While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						                Call SalTblSetContext( hWndForm, nRow )
						! 2905 OTM = 0 ; 2805 OOTM = 1
						                If OTM >= 0
							! 2905 - на разніе
							                If OTM = 0
								                Set nS3 = OST03 * 100
								                Set nS2 = OST02 * 100
								                Set nS1 = OST01 * 100
								                Set nS4 = OST29_2 *100
								                Set nITOG = nITOG + nS4
							! 2905 - на 2805
							                Else 
								                Set nS5 = - OST29 * 100
							! Первый док не д.б. на 2805
							                If sNLS_G = STRING_Null 
								                If OTM =1 
									                Return FALSE
								!
								                Set sNLS_G = dNLS_G
								                Call cDoc.SetDoc( 0, sTT, 1, IifN(cb_Zo = 0, nVob, 96), STRING_Null,
										     dDat, dDat, dDat, dDat,
										     NLS29, NAME, aMfo,'', n980, nS3, aOkpo,
										     NLS03, aName, aMfo,'', n980, nS3, aOkpo,
										     sNazn1, '', GetIdOper(), '', NUMBER_Null, 0 )
								                If NOT cDoc.oDoc() 
									                Return FALSE
								                Set nRef = cDoc.m_nRef
								                If NOT F_Fun2(nRef ,"Розщеплення: за наданi послуги ") 
									                Return FALSE
								                If sNLS_G != NLS29 
									                If nS4 >0 
										                If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980, NLS29,nS4, n980,sNLS_G,nS4)
											                Return FALSE
										                If NOT F_Fun2(nRef ,"Акумуляцiя загальної суми")
											                Return FALSE
							! Следующие
							                Else 
								! 2905 - на разніе
								                If OTM = 0
									                If nS3 >0 
										                If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980,NLS29,nS3, n980,NLS03,nS3)
											                Return FALSE
										                If NOT F_Fun2(nRef ,"Розщеплення: за наданi послуги ")
											                Return FALSE
									                If nS4 >0 
										                If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980, NLS29,nS4,n980,sNLS_G,nS4)
											                Return FALSE
										                If NOT F_Fun2(nRef ,"Акумуляцiя загальної суми")
											                Return FALSE
							! 2905 - на разніе
							                If OTM = 0 
								                If nS1 >0 
									                If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980,NLS29,nS1,n980,NLS01,nS1)
										                Return FALSE
									                If NOT F_Fun2(nRef ,"Розщеплення: доходи зг.договорiв")
										                Return FALSE
								                If nS2 >0 
									                If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980,NLS29,nS2,n980,NLS02,nS2)
										                Return FALSE
									                If NOT F_Fun2(nRef ,"Розщеплення: ПДВ ")
										                Return FALSE
							! 2905 - на 2805
							                Else 
								                If nITOG > 0 and nS5 > 0 
									                Set nS5 = SalNumberMin( nITOG, nS5 )
									                If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980,sNLS_G,nS5,n980,NLS29,nS5)
										                Return FALSE
									                If NOT F_Fun2(nRef ,"Перекриття сплачених (деб.заборг.)")
										                Return FALSE
									                Set nITOG = nITOG - nS5
					! Call Debug ( 'nITOG='||Str(nITOG)||' REZ_S='||Str(REZ_S))
					                If nITOG > 0  and REZ_S > 0
						                Set REZ_S = SalNumberMin( REZ_S, nITOG )
						                If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980,sNLS_G , REZ_S,  n980, REZ_NLS, REZ_S )
							                Return FALSE
						                If NOT F_Fun2(nRef ,"Формування постiйного залишку")
							                Return FALSE
						                Set nITOG = nITOG - REZ_S
					                If nITOG > 0 
						                Call cDoc.SetDoc( 
								     0, IifS(aMfo = MFO, sTT, sTT2 ), 1, nVob, STRING_Null,
								     dDat, dDat, dDat, dDat,
								     sNLS_G, aName, aMfo,'', n980, nITOG, aOkpo,
								     NLS  , NAME,  MFO, '', n980, nITOG, OKPO,
								     sNazn2, '', GetIdOper(), '', NUMBER_Null, 0 )
						                If NOT cDoc.oDoc()
							                Return FALSE
						! Set nRef = cDoc.m_nRef
						                Set REF2 = cDoc.m_nRef
						                Set SALDO = nITOG /100
						                Call SalEnableWindow( pb_Reestr )
					                Return TRUE
			Function: F_Fun2
				Description:
				Returns
					Boolean:
				Parameters
					Number: nRef
					String: sTxt
				Static Variables
				Local variables
				Actions
					Return SqlPrepareAndExecute( hSql(),
							"begin 
							   update opldok set txt='"||sTxt|| "' 
							   where ref="||Str(nRef) ||" and stmt=gl.aStmt;
							 end; ")
		Window Parameters
			Number: nMode
			Number: nPar
			String: OB22
			String: NAME
			String: MFO
			String: NLS
			String: OKPO 
			String: pNAZN1
			String: pNAZN2 
			Date/Time: pDATP
			String: pNLS_G
			Number: nPrz
		Window Variables
			Number: n980
			Number: nColZ
			Number: nColG
			Number: nColJ
			: cDoc
				Class: cDoc
			Number: nId
			Number: nTmpE
			String: sTmpE
			! Date/Time: dDat
			String: aOkpo
			String: sTT
			String: sTT2
			String: aName
			String: sPeriod
			String: sSql
			String: sAnd
			Number: nRef
			!
			String: aMfo
			String: sTitl
			Number: nRow
			Number: nVob
			Number: I0
			Number: I1
			Number: I2
			Number: I3
			Number: I4
			!
			Number: REZ_SUM
			String: REZ_OB22 
			Number: REZ_OST
			Number: REZ_S
			!
			String: sSql_3
		Message Actions
			On SAM_Create
				Set nId  = GetUserId()
				Set dDat = GetBankDate()
				Set aMfo = GetBankMfo()
				Set aOkpo= GetBankOkpoS()
				Set aName= Subs(GetBankName(),1,38)
				Set nVob = 6
				Set sTT = 'PS1'
				Set sTT2 = 'PS2'
				Set rb_V = nPrz
				Set LT1.strPrintFileName = MFO||'_'||NLS
				! Call ShowApdVersion('03')
				! Call SalMapEnterToTab( TRUE )
				Set n980 = GetBaseVal()
				Set nColZ = COLOR_LightGreen
				Set nColG = COLOR_LightAqua
				Set nColJ =SalColorFromRGB( 255,255,180)
				Set sTitl = 'Розрахунки з ('|| OB22 ||')' || NAME 
				Call SalSetWindowText( hWndForm, sTitl ) 
				Call SalTblSetLockedColumns( hWndForm, 3 )
				Set cb_Zo = 0
				If pNAZN1 != STRING_Null
					Set NAZN1 = pNAZN1
				Else
					Set NAZN1 = 'Розщеплення / '|| OB22 || ' /' || NAME 
				!
				If pNAZN2 != STRING_Null
					Set NAZN2 = pNAZN2
				Else
					Set NAZN2 = 'Розрахунки з ('|| OB22 ||')' || NAME 
				Set DATP = pDATP
				Set dNLS_G = pNLS_G
				Set sAnd = " o.ob22 = '" || OB22 || "' 
						         and o.mfo  = '" || MFO  || "' 
						         and o.nls  = '" || NLS  || "' 
						         and o.okpo = '" || OKPO || "' "
				!
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On UM_Populate
				! Call SalDisableWindow( rb_V )
				! Call SalDisableWindow( rb_R )
				Call SalWaitCursor(TRUE)
				! На вечер
				If nPrz = 1
					Set sSql_3 = 
							"select p.branch,  sum(o.s ) 
							 into :sBr3, :nBr3 
							 from opldok o, oper p, accounts a 
							 where a.kv =:n980 and a.nls = :NLS29 
							   and a.acc= o.acc and o.dk=1 
							   and o.fdat >  :DATP 
							   and o.fdat <= :dDat 
							   and o.ref = p.ref 
							 group by p.branch " 
				! На утро
				Else
					Set sSql_3 =
							"select p.branch,  sum(o.s ) 
							 into :sBr3, :nBr3 
							 from opldok o, oper p, accounts a 
							 where a.kv =:n980 and a.nls = :NLS29 
							   and a.acc= o.acc and o.dk=1 
							   and o.fdat >=  :DATP 
							   and o.fdat <= :dDat 
							   and o.ref = p.ref 
							and p.pdat >=  :DATP 
							 group by p.branch "
				! Обязательный резерв
				Set REZ_SUM = 0
				Set REZ_SUMd = 0
				Set REZ_OB22 = STRING_Null
				Set REZ_NLS = STRING_Null
				Set REZ_OST = 0
				Set REZ_OSTd = 0
				Set REZ_S = 0
				!
				If SqlPrepareAndExecute( hSqlAux2(), 
						"select  nvl(rez_suM,0)*100, rez_ob22
						 into :REZ_SUM, :REZ_OB22 from branch_opelot o  where " || sAnd )  
						and SqlFetchNext( hSqlAux2(), nFetchRes ) 
					! Call Debug ( '1) REZ_SUM='||Str(REZ_SUM)||' REZ_OB22 =' || REZ_OB22 )
					If REZ_SUM > 0 and REZ_OB22 != STRING_Null
						If SqlPrepareAndExecute( hSqlAux2(), 
								"select nls, Fost(acc,:dDat)
								 into  :REZ_NLS, :REZ_OST  from accounts  
								 where kv = :n980 and dazs is null 
								   and nls = substr(nbs_ob22('2905',:REZ_OB22),1,14)" )  
								and SqlFetchNext( hSqlAux2(), nFetchRes ) 
							! Call Debug ( '2) REZ_NLS =' || REZ_NLS )
							If REZ_NLS != STRING_Null 
								Set REZ_S = SalNumberMax( REZ_SUM - REZ_OST, 0 )
								Set REZ_OSTd = REZ_OST / 100
								Set REZ_SUMd = REZ_SUM / 100
								Set REZ_Sd = REZ_S / 100
				!
				Set I0 =0 
				Set I1 =0 
				Set I2 =0 
				Set I3 =0 
				Set I4 =0 
				Set sSql =
						"SELECT 0, a.BRANCH, a.nls, Fost(a.acc,:dDat)/100, 
						    substr(nbs_ob22_null(o.BS1,o.OB1,a.branch),1,14), o.PR1,  
						    substr(nbs_ob22_null(o.BS2,o.OB2,a.branch),1,14), o.PR2,  
						    substr(nbs_ob22_null(o.BS3,o.OB3,a.branch),1,14), o.PR3,  
						    round((Fost(a.acc,:dDat)/100)*o.PR1/100,2), 
						    round((Fost(a.acc,:dDat)/100)*o.PR2/100,2), 
						    round((Fost(a.acc,:dDat)/100)*o.PR3/100,2) 
						 into :LT1.OTM,:LT1.BRANCH,:LT1.NLS29,:LT1.OST29,
						      :LT1.NLS01,:LT1.PR1,:LT1.NLS02,:LT1.PR2,:LT1.NLS03,:LT1.PR3, 
						      :LT1.OST01,:LT1.OST02,:LT1.OST03
						 FROM branch_opelot o, accounts a 
						 where " || sAnd || " and a.branch like o.branch ||'%' 
						   and Fost(a.acc,:dDat) >0 and a.kv=980 and a.nbs='2905' 
						   and a.ob22=o.ob22 
						 union all 
						 SELECT 1, a.BRANCH, a.nls, Fost(a.acc,:dDat) /100, 
						        to_char(null), to_number(null), 
						        to_char(null), to_number(null),
						        to_char(null), to_number(null),
						        to_number(null),
						        to_number(null),
						        to_number(null)
						 FROM branch_opelot o, accounts a 
						 where " || sAnd || "  and a.branch like o.branch ||'%' 
						   and Fost(a.acc,:dDat) < 0 
						   and a.kv=980 and a.nbs='2805' and a.ob22=o.ob22 
						 ORDER BY 1,2 "
				! Call Debug (Subs( sSql, 0001, 1000))
				! Call Debug (Subs( sSql, 1001, 1000))
				! Call Debug (Subs( sSql, 2001, 1000))
				! Call Debug (Subs( sSql, 3001, 1000))
				! Call Debug (Subs( sSql, 4001, 1000))
				! Call Debug (Subs( sSql, 5001, 1000))
				! Call Debug (Subs( sSql, 6001, 1000))
				!
				Call SalWaitCursor(TRUE)
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll )
				! Итог
				Call SalTblDefineSplitWindow (hWndForm, 1, TRUE)
				Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
				Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
				Call SalTblSetContext(hWndForm, nRow)
				Set OST29 = I0 
				Set OST01 = I1 
				Set OST02 = I2 
				Set OST03 = I3 
				Set OST29_2=I4  
				Set OTM = -1
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				! 2905 OTM = 0 
				If OTM = 0 
					Call XSalTblSetCellBackColor( PR1, nColG )
					Call XSalTblSetCellBackColor( NLS01, nColG )
					Call XSalTblSetCellBackColor( OST01, nColG )
					If OST01 != 0 and NLS01 = STRING_Null
						Call XSalTblSetCellBackColor( NLS01, COLOR_Salmon )
					!
					Call XSalTblSetCellBackColor( PR2, nColJ )
					Call XSalTblSetCellBackColor( NLS02, nColJ )
					Call XSalTblSetCellBackColor( OST02, nColJ )
					If OST02 != 0 and NLS02 = STRING_Null
						Call XSalTblSetCellBackColor( NLS02, COLOR_Salmon )
					!
					Call XSalTblSetCellBackColor( PR3, nColZ )
					Call XSalTblSetCellBackColor( NLS03, nColZ )
					Call XSalTblSetCellBackColor( OST03, nColZ )
					If OST03 != 0 and NLS03 = STRING_Null
						Call XSalTblSetCellBackColor( NLS03, COLOR_Salmon )
					!
				! 2805
				Else
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray  )
				!
				Set OST29_2 = OST29 - OST01 - OST02 - OST03
				Set I0 = I0 + OST29
				Set I1 = I1 + OST01
				Set I2 = I2 + OST02
				Set I3 = I3 + OST03
				Set I4 = I4 + OST29_2
	Table Window: LT2
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.075"
				Top:    0.052"
				Width:  16.5"
				Width Editable? Class Default
				Height: 7.476"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.95"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45368
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.35"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45369
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45370
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			! Column: REF
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Осн.
						реф.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                                                                                                                                                                         List Values 
				                                                                                                                                                                                                                                                         Message Actions 
			! Column: STMT
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № 
						п/п
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                                                                                                                                                                         List Values 
				                                                                                                                                                                                                                                                         Message Actions 
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бранч
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.
						Дебет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						Дебет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах
						Кредит
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						Кредит
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Призначення
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nRef1
			Number: nRef2
			String: sTitl
			String: sOB22
		Window Variables
			Number: I_6119
			Number: I_3622
			Number: I_6110
			Number: I_2805
			String: sSql
			! String: aMfo
		Message Actions
			On SAM_Create
				Set LT2.strPrintFileName = 'REE_LOT'
				Call SalSetWindowText( hWndForm, sTitl ) 
				! Set aMfo = GetBankMfo()
				!
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set I_6119 =0 
				Set I_3622 =0 
				Set I_6110 =0 
				Set I_2805 =0 
				Set sSql =
						"SELECT ad.BRANCH, ad.nls, ad.NMS, ak.nls, ak.NMS, o.s/100, o.txt 
						 INTO :LT2.BRANCH,:LT2.NLSD,:LT2.NMSD,:LT2.NLSK,:LT2.NMSK,:LT2.S,:LT2.TXT
						 FROM accounts ad, accounts ak,
						          (SELECT stmt, s, txt, SUM(DECODE (dk,0,acc,0)) aD, SUM(DECODE (dk,1,acc,0)) aK
						           FROM opldok  WHERE sos >= 1 and ref=" || Str(nRef1) || "
						           GROUP BY  stmt, s, txt) o
						 WHERE o.ad = ad.acc AND o.ak = ak.acc  ORDER BY ad.BRANCH, o.stmt" 
				!
				Call SalWaitCursor(TRUE)
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll )
				! Итог
				Call SalTblDefineSplitWindow (hWndForm, 5, TRUE)
				!
				Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
				Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
				Call SalTblSetContext(hWndForm, nRow)
				Set BRANCH = "Разом" 
				Set NMSK = "комісії" 
				Set NLSK = "6119_(01)" 
				Set S = I_6119
				Set TXT = 'Згiдно договорiв iз суб"єктами господарювання'
				!
				Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
				Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
				Call SalTblSetContext(hWndForm, nRow)
				Set BRANCH = "Разом" 
				Set NMSK = "ПДВ" 
				Set NLSK = "3622_(51)" 
				Set S = I_3622
				Set TXT = 'Кредиторська заборгованість за податками'
				!
				Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
				Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
				Call SalTblSetContext(hWndForm, nRow)
				Set BRANCH = "Разом" 
				Set NMSK = "комісії" 
				Set NLSK = "6110_(60)" 
				Set S = I_6110
				Set TXT = 'За наданi послуги з розповсюдження лотерей' 
				!
				Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
				Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
				Call SalTblSetContext(hWndForm, nRow)
				Set BRANCH = "Разом" 
				Set NMSK = "сплачено виграшів"
				Set NLSK = "2805_(" || sOB22 || ")" 
				Set S = I_2805
				Set TXT = 'Дебіторська заборг.за операціями з грошово-речовими лотереями' 
				!
				Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
				Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
				Call SalTblSetContext(hWndForm, nRow)
				If SqlPrepareAndExecute( hSql(),
						"SELECT mfoa, nlsa, NAM_A, MFOB||'/'|| NLSB, NAM_B, s/100, nazn 
						 INTO :LT2.BRANCH,:LT2.NLSD,:LT2.NMSD,:LT2.NLSK,:LT2.NMSK,:LT2.S,:LT2.TXT
						 from oper where ref=:nRef2 " )
						and NOT SqlFetchNext( hSql(), nFetchRes )
				!
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If Subs( NLSK,1,4) ='6519' !! 6119
					Set I_6119 = I_6119 + S 
				Else If Subs( NLSK,1,4) ='3622'
					Set I_3622 = I_3622 + S 
				Else If Subs( NLSK,1,4) ='6510' !! 6110
					Set I_6110 = I_6110 + S 
				Else If Subs( NLSK,1,4) ='2805'
					Set I_2805 = I_2805 + S 
			On SAM_ColumnSelectClick
	Form Window: LK2
		Class: cQuickTabsForm
		Property Template:
		Class DLL Name:
		Title: Закриття просроченого ломбардного кредиту
		Icon File:
		Accesories Enabled? Yes
		Visible? Class Default
		Display Settings
			Display Style? Etched
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  15.35"
				Width Editable? Class Default
				Height: 7.625"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Standard
				Location? Class Default
				Visible? Class Default
				Size: 1.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: 3D Face Color
			Contents
				Background Text: 3409/04 
					Resource Id: 40591
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.783"
						Top:    0.179"
						Width:  0.983"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Light Green
				Data Field: NLS_3409_04
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.783"
							Top:    0.155"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: White
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок обліку виробів та лому із дорогоц.металів' )
						On VTM_LeftDoubleClick
							If ACC_3409_04 > 0 
								Call Show_Sal_Day_P(ACC_3409_04, STRING_Null, NUMBER_Null, dDat-14, dDat )
						On SAM_SetFocus
							Set sTmpE = NLS_3409_04
						On SAM_AnyEdit
							Set NLS_3409_04 = sTmpE
				Data Field: NMS_3409_04
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.883"
							Top:    0.155"
							Width:  6.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва рахунку ' )
				Data Field: OST_3409_04
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.883"
							Top:    0.155"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Фактичний залишок рахунку' )
				Data Field: OST_3409_04b
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.883"
							Top:    0.155"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Плановий залишок рахунку' )
				!
				Background Text: 3407/01 
					Resource Id: 56988
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.783"
						Top:    0.429"
						Width:  0.983"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Sky
				Data Field: NLS_3407_01
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.783"
							Top:    0.405"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: White
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок обліку Дорогоц.металів в дорозі' )
						On VTM_LeftDoubleClick
							If ACC_3407_01 > 0 
								Call Show_Sal_Day_P(ACC_3407_01, STRING_Null, NUMBER_Null, dDat-14, dDat )
						On SAM_SetFocus
							Set sTmpE = NLS_3407_01
						On SAM_AnyEdit
							Set NLS_3407_01 = sTmpE
				Data Field: NMS_3407_01
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.883"
							Top:    0.405"
							Width:  6.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва рахунку ' )
				Data Field: OST_3407_01
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.883"
							Top:    0.405"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Фактичний залишок рахунку' )
				Data Field: OST_3407_01b
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.883"
							Top:    0.405"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Плановий залишок рахунку' )
				!
				Background Text: 3622/52 
					Resource Id: 56989
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.783"
						Top:    0.679"
						Width:  0.983"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Sky
				Data Field: NLS_3622_52
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.783"
							Top:    0.655"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: White
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок обліку податкових зобов`язань з ПДВ' )
						On VTM_LeftDoubleClick
							If ACC_3622_52 > 0 
								Call Show_Sal_Day_P(ACC_3622_52, STRING_Null, NUMBER_Null, dDat-14, dDat )
						On SAM_SetFocus
							Set sTmpE = NLS_3622_52
						On SAM_AnyEdit
							Set NLS_3622_52 = sTmpE
				Data Field: NMS_3622_52
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.883"
							Top:    0.655"
							Width:  6.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва рахунку ' )
				Data Field: OST_3622_52
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.883"
							Top:    0.655"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Фактичний залишок рахунку' )
				Data Field: OST_3622_52b
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.883"
							Top:    0.655"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Плановий залишок рахунку' )
				!
				Background Text: 3519/07 
					Resource Id: 8312
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.783"
						Top:    0.929"
						Width:  0.983"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Maize
				Data Field: NLS_3519_07
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.783"
							Top:    0.905"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: White
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок-Дебитор. Розрахунки з Державною скарбницею за здані ДМ' )
						On VTM_LeftDoubleClick
							If ACC_3519_07 > 0 
								Call Show_Sal_Day_P(ACC_3519_07, STRING_Null, NUMBER_Null, dDat-14, dDat )
						On SAM_SetFocus
							Set sTmpE = NLS_3519_07
						On SAM_AnyEdit
							Set NLS_3519_07 = sTmpE
				Data Field: NMS_3519_07
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.883"
							Top:    0.905"
							Width:  6.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва рахунку ' )
				Data Field: OST_3519_07
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.883"
							Top:    0.905"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam,  'Фактичний залишок рахунку' )
				Data Field: OST_3519_07b
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.883"
							Top:    0.905"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Плановий залишок рахунку' )
				!
				Background Text: 3619/04 
					Resource Id: 24033
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.783"
						Top:    1.179"
						Width:  0.983"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Orchid
				Data Field: NLS_3619_04
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.783"
							Top:    1.155"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: White
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок-Кредитор.Розрахунки з Державною скарбницею за здані ДМ' )
						On VTM_LeftDoubleClick
							If ACC_3619_04 > 0 
								Call Show_Sal_Day_P(ACC_3619_04, STRING_Null, NUMBER_Null, dDat-14, dDat )
						On SAM_SetFocus
							Set sTmpE = NLS_3619_04
						On SAM_AnyEdit
							Set NLS_3619_04 = sTmpE
				Data Field: NMS_3619_04
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.883"
							Top:    1.155"
							Width:  6.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Orchid
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва рахунку' )
				Data Field: OST_3619_04
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.883"
							Top:    1.155"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Orchid
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam,'Фактичний залишок рахунку' )
				Data Field: OST_3619_04b
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.883"
							Top:    1.155"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.226"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: ###000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Orchid
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam,  'Плановий залишок рахунку' )
		Contents
			Picture: picTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000500
0020: 5441423100005461 62426F74746F6D4D 617267696E000200 3000005461625061
0040: 6765436F756E7400 0200310000546162 4C6162656C73008C 00312ECFF0E8E9ED
0060: FFF2F2FF20C4CC20 EDE020E1E0EBE0ED F109322EC2B3E4EF F0E0E2EBE5EDEDFF
0080: 20C4CC20E4EE20D1 EAE0F0E1EDE8F6B3 2009332ECEF2F0E8 ECE0EDEDFF20EFB3
00A0: E4F2E2E5F0E4E6E5 EDEDFF20E2B3E420 D1EAE0F0E1EDE8F6 B32009342EC7E0EA
00C0: F0E8F2F2FF20E4E5 E12E20F2E020EAF0 E5E42E20E7E0E1EE F0E3EEE2E0EDEEF1
00E0: F2E5E92000005461 624E616D65730014 0054414231095441 4232095441423309
0100: 5441423400005461 6252696768744D61 7267696E00020030 0000546162447261
0120: 775374796C65000B 0057696E39355374 796C650000546162 466F726D50616765
0140: 7300040009090900 00546162546F704D 617267696E000200 3000000000000000
0160: 0000000000000000 00000000000000
.enddata
.data CLASSPROPSSIZE
0000: 6F01
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQuickTabsForm
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
			! Закладка -1 
			!
			Background Text: 3739/05
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 40588
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.683"
					Top:    0.595"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: NLS_3739_05
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.883"
						Top:    0.488"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рахунок розрахунків за кредитними операцўями' )
			Data Field: NMS_3739_05
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.883"
						Top:    0.488"
						Width:  9.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Назва рахунку розрахунків за кредитними операцўями' )
			!
			Pushbutton: pb_Kredit
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.483"
					Top:    0.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: F1
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\LOOK.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Знайти просрочений ломб.кредит'
					On SAM_Click
						Call F_POISK()
			Data Field: NAMK
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.883"
						Top:    0.821"
						Width:  7.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Позичальник' )
			Data Field: ND
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.883"
						Top:    0.821"
						Width:  2.033"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Референс КД' )
			!
			Background Text: Сума-1. Разом
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 40590
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.183"
					Top:    1.345"
					Width:  7.7"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Dark Green
				Background Color: Default
			Data Field: Sum1
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.883"
						Top:    1.238"
						Width:  2.033"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Green
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума "Разом" (балансова вартість)' )
			!
			Background Text: 2202
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 44074
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.583"
					Top:    1.679"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: NLS_2202
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.883"
						Top:    1.571"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					! On SAM_Validate
						                                                                                                                                                                                                 If SqlPrepareAndExecute( hSql(), 
								"SELECT daos, nms, -ostc/100,acc  into :DAOS, :NMS_2202, :OST_2202, :ACC_2202
								 FROM accounts where kv=980 and nls=:NLS_2202 and ostc<0" )
								and NOT SqlFetchNext( hSql(), nFetchRes )
							                                                                                                                                                                                                 Call SalMessageBox('Не знайдено заборгованість по кредиту','Увага !', MB_IconStop)
							                                                                                                                                                                                                 Set NLS_2202 = STRING_Null
							                                                                                                                                                                                                 Set NMS_2202 = STRING_Null
							                                                                                                                                                                                                 Set OST_2202 = NUMBER_Null
							                                                                                                                                                                                                 Set ACC_2202 = NUMBER_Null
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Позичковий рахунок' )
			Data Field: NMS_2202
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.883"
						Top:    1.571"
						Width:  5.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Назва Позичкового рахунку' )
			Data Field: OST_2202
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.883"
						Top:    1.571"
						Width:  2.033"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Залишок на Позичковому рахуноку' )
			!
			Background Text: 2208
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 44075
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.583"
					Top:    2.012"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: NLS_2208
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.883"
						Top:    1.905"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					! On SAM_Validate
						                                                                                                                                                                                                 If SqlPrepareAndExecute( hSql(), 
								"SELECT nms, -ostc/100,acc into :NMS_2208, :OST_2208, :ACC_2208 
								 FROM accounts where kv=980 and nls=:NLS_2208 and ostc<0" )
								and NOT SqlFetchNext( hSql(), nFetchRes )
							                                                                                                                                                                                                 Call SalMessageBox('Не знайдено заборгованість по %%','Увага !', MB_IconStop)
							                                                                                                                                                                                                 Set NLS_2208 = STRING_Null
							                                                                                                                                                                                                 Set NMS_2208 = STRING_Null
							                                                                                                                                                                                                 Set OST_2208 = NUMBER_Null
							                                                                                                                                                                                                 Set ACC_2208 = NUMBER_Null
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рахунок нарахованих %%' )
			Data Field: NMS_2208
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.883"
						Top:    1.905"
						Width:  5.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Назва Рахунку нарахованих %%' )
			Data Field: OST_2208
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.883"
						Top:    1.905"
						Width:  2.033"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Залишок на Рахунку нарахованих %%' )
			!
			Background Text: Сума податку з доходів фізичних осіб (15%)
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 40589
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.183"
					Top:    2.345"
					Width:  7.7"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: OST_DOX
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.883"
						Top:    2.238"
						Width:  2.033"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума податку з доходів фізичних осіб (15%)' )
			!
			Background Text: 9900
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 44078
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.683"
					Top:    2.762"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: NLS_9900
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.783"
						Top:    2.655"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SqlPrepareAndExecute( hSql(),
								"SELECT nms, ostc/100,acc into :NMS_9501, :OST_9501, :ACC_9501 
								 FROM accounts where kv=980 and nls=:NLS_9501 and ostc<0" )
								and NOT SqlFetchNext( hSql(), nFetchRes )
							Call SalMessageBox('Не знайдено суму застави','Увага !', MB_IconStop)
							Set NLS_9501 = STRING_Null
							Set NMS_9501 = STRING_Null
							Set OST_9501 = NUMBER_Null
							Set ACC_9501 = NUMBER_Null
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Контр/рах. позабалансу' )
			Data Field: NMS_9900
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.783"
						Top:    2.655"
						Width:  9.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Назва Контр/рах. позабалансу' )
			!
			Background Text: 9501
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 44076
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.683"
					Top:    3.095"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: NLS_9501
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.883"
						Top:    2.988"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					! On SAM_Validate
						                                                                                                                                                                                                 If SqlPrepareAndExecute( hSql(),
								"SELECT DAPP, nms, -ostc/100, acc into :DAPP, :NMS_9501, :OST_9501, :ACC_9501 
								 FROM accounts where kv=980 and nls=:NLS_9501 " )
								and NOT SqlFetchNext( hSql(), nFetchRes )
							                                                                                                                                                                                                 Call SalMessageBox('Не знайдено рахунок застави ','Увага !', MB_IconStop)
							                                                                                                                                                                                                 Set NLS_9501 = STRING_Null
							                                                                                                                                                                                                 Set NMS_9501 = STRING_Null
							                                                                                                                                                                                                 Set OST_9501 = NUMBER_Null
							                                                                                                                                                                                                 Set ACC_9501 = NUMBER_Null
							                                                                                                                                                                                                 Set OST_9501_1k= NUMBER_Null
						                                                                                                                                                                                                 Else 
							                                                                                                                                                                                                 If OST_9501 = 0 
								                                                                                                                                                                                                 If SqlPrepareAndExecute( hSql(),
										"SELECT -fost( :ACC_9501, :DAPP -1 ) into :OST_9501_1k from dual  " )
										and NOT SqlFetchNext( hSql(), nFetchRes )
							                                                                                                                                                                                                 Else 
								                                                                                                                                                                                                 Set OST_9501_1k = - OST_9501
								                                                                                                                                                                                                 Set DAPP = DATETIME_Null
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рахунок застави' )
			Data Field: NMS_9501
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.883"
						Top:    2.988"
						Width:  5.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Назва Рахунку застави' )
			Data Field: OST_9501
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.883"
						Top:    2.988"
						Width:  2.033"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Залишок на Рахунку застави' )
			!
			Data Field: NAZN1
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.083"
						Top:    3.405"
						Width:  11.8"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set NAZN1 ="Прийняття дорогоц.металів на баланс згідно Акту №  ..... від ....."
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Призначення платежу' )
			Pushbutton: pb1
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.483"
					Top:    3.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: F1
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\ARR1TOR.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Закрити просрочений ломб.кредит'
					On SAM_Click
						If F_Opl ( 1, strTip )
							If SqlPrepareAndExecute( hSql(), 
									"SELECT  -ostc/100 , -ostb/100  into :OST_3409_04, :OST_3409_04b 
									 FROM accounts where acc = :ACC_3409_04 " )
									and NOT SqlFetchNext( hSql(), nFetchRes )
							Set Sum2 = Sum1
							Call SalSendMsg( Sum2, SAM_Validate, 0, 0 )
			Data Field: REF1
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.883"
						Top:    3.738"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On VTM_LeftDoubleClick
						If REF1 > 0 
							Call DocViewContentsEx(hWndForm, REF1 )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.документу - 1' )
					On SAM_SetFocus
						Set nTmpE = REF1
					On SAM_AnyEdit
						Set REF1 = nTmpE
			!
			! ! Закладка -2 
			Background Text: Сума-2. Разом
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 8315
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.883"
					Top:    0.595"
					Width:  8.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Blue
				Background Color: Default
			Data Field: Sum2_PDV
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.883"
						Top:    0.571"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Разом з ПДВ' )
			Background Text: Сума-1. Вартість цінностей за ціною Держскарбниці (на дату складання реєстру)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 44071
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.983"
					Top:    1.345"
					Width:  8.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Dark Green
				Background Color: Default
			Data Field: Sum2
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   9.883"
						Top:    1.238"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Green
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вартість цінностей за ціною Держскарбниці (на дату складання реєстру)' )
					On SAM_Validate
						Set OST_PDV = SalNumberRound(Sum2 *20)/100
						Set Sum2_PDV = Sum2 + OST_PDV
			Background Text: Сума податкових зобов`язань з ПДВ(20%)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 8314
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.883"
					Top:    1.012"
					Width:  8.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: OST_PDV
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.883"
						Top:    0.905"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума податкових зобов`язань з ПДВ(20%)' )
			Data Field: NAZN2
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.75"
						Top:    1.595"
						Width:  12.033"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set NAZN2 ="Відправка дорогоц.металів до Державної скарбниці, посилка № ... від ....."
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Призначення платежу' )
			Pushbutton: pb2
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.283"
					Top:    1.905"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F2
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\ARR1TOR.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Sky
				Message Actions
					On SAM_Create
						Set strTip = 'Облік сформованої посилки до Держскарбниці'
					On SAM_Click
						If F_Opl ( 2, strTip )
							If SqlPrepareAndExecute( hSql(), 
									"SELECT  -ostc/100 , -ostb/100  into :OST_3407_01, :OST_3407_01b 
									 FROM accounts where acc = :ACC_3407_01 " )
									and NOT SqlFetchNext( hSql(), nFetchRes )
							If SqlPrepareAndExecute( hSql(), 
									"SELECT  -ostc/100 , -ostb/100  into :OST_3622_52, :OST_3622_52b 
									 FROM accounts where ACC = :ACC_3622_52 " )
									and NOT SqlFetchNext( hSql(), nFetchRes )
							Set Sum3 =  Sum2_PDV
			Data Field: REF2
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.783"
						Top:    1.905"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On VTM_LeftDoubleClick
						If REF2 > 0 
							Call DocViewContentsEx(hWndForm, REF2 )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.документу - 2' )
					On SAM_SetFocus
						Set nTmpE = REF2
					On SAM_AnyEdit
						Set REF2 = nTmpE
			!
			! ! Закладка -3
			Background Text: Сума-2. Сума посилки з ПДВ, про надходження якої отримано підтвердження від Держскарбниці
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 8316
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    0.702"
					Width:  9.667"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Blue
				Background Color: Default
			Data Field: Sum3
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.15"
						Top:    0.571"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума посилки, про надходження якої отримано підтвердження від Держскарбниці' )
			Data Field: NAZN3
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.917"
						Top:    0.952"
						Width:  12.033"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set NAZN3 = 
								"Визнання деб.заборгованості згідно підтв. Держскабниці про надходження посилки з ДМ № ... від ..."
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Призначення платежу' )
			Pushbutton: pb3
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.45"
					Top:    1.262"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F2
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\ARR1TOR.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Maize
				Message Actions
					On SAM_Create
						Set strTip = 'Визнання деб.заборгованості'
					On SAM_Click
						If F_Opl ( 3, strTip )
							If SqlPrepareAndExecute( hSql(), 
									"SELECT  -ostc/100 , -ostb/100  into :OST_3519_07, :OST_3519_07b 
									 FROM accounts where ACC = :ACC_3519_07 " )
									and NOT SqlFetchNext( hSql(), nFetchRes )
							Set Sum31 =  Sum3
							Call SalSendMsg( Sum31, SAM_Validate, 0, 0 )
			Data Field: REF3
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.95"
						Top:    1.262"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On VTM_LeftDoubleClick
						If REF3 > 0 
							Call DocViewContentsEx(hWndForm, REF3 )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.документу - 3' )
					On SAM_SetFocus
						Set nTmpE = REF3
					On SAM_AnyEdit
						Set REF3 = nTmpE
			!
			! ! Закладка -4
			Group Box: Оцінка Банку
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 63833
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    0.405"
					Width:  12.6"
					Width Editable? Yes
					Height: 1.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold-Italic
				Text Color: Blue
				Background Color: Default
			Background Text: Сума-2. Сума посилки з ПДВ на дату відправки
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 63832
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.283"
					Top:    0.726"
					Width:  8.133"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Blue
				Background Color: Default
			Data Field: Sum31
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.483"
						Top:    0.571"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума посилки, про надходження якої отримано підтвердження від Держскарбниці' )
					On SAM_Validate
						Set Sum31p = SalNumberRound(Sum31 * 20*100/120) /100 
						Set Sum31n = Sum31 - Sum31p
						Call F_Del()
			Data Field: Sum31n
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.483"
						Top:    0.905"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'в тч:Вартість цінностей ' )
			Data Field: Sum31p
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.483"
						Top:    1.238"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'в тч:ПДВ' )
			!
			Group Box: Оцінка Держскарбниці
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 544142340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 63836
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    1.655"
					Width:  12.6"
					Width Editable? Yes
					Height: 1.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold-Italic
				Text Color: Magenta
				Background Color: Default
			Background Text: Cума-3. Загальна сума, що надійшла від Держскарбниці 
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 8313
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.483"
					Top:    1.929"
					Width:  5.933"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Magenta
				Background Color: Default
			Data Field: Sum4
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.483"
						Top:    1.821"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Magenta
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Загальна сума, що надійшла від Держскарбниці' )
					On SAM_Validate
						Set Sum4p = SalNumberRound(Sum4 * 20*100/120) /100 
						Set Sum4n = Sum4 - Sum4p
						Call F_Del()
			Data Field: Sum4n
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.483"
						Top:    2.155"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'в тч:Вартість цінностей ' )
			Data Field: Sum4p
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.483"
						Top:    2.488"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'в тч:ПДВ' )
			!
			Group Box: Різниця
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 63835
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.35"
					Top:    2.929"
					Width:  12.6"
					Width Editable? Yes
					Height: 1.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold-Italic
				Text Color: Red
				Background Color: Default
			Background Text: Загальна сума
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 63834
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.45"
					Top:    3.202"
					Width:  5.933"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Red
				Background Color: Default
			Data Field: SumD
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.45"
						Top:    3.095"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Загальна сума' )
			Data Field: SumDn
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.45"
						Top:    3.429"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'в тч:Вартість цінностей ' )
			Data Field: SumDp
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.45"
						Top:    3.762"
						Width:  2.367"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'в тч:ПДВ' )
			!
			Data Field: NAZN4
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.883"
						Top:    4.226"
						Width:  12.033"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set NAZN4 = 
								"Закриття деб.та кред. заборгованості згідно отриманих коштів від Держскабниці, док № ... від ..."
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Призначення платежу' )
			Pushbutton: pb4
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.417"
					Top:    4.536"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F2
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\ARR1TOR.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Orchid
				Message Actions
					On SAM_Create
						Set strTip = 'Закриття деб.та кред. заборгованості'
					On SAM_Click
						If F_Opl ( 4, strTip )
							If SqlPrepareAndExecute( hSql(), 
									"SELECT  -ostc/100 , -ostb/100  into :OST_3519_07, :OST_3519_07b 
									 FROM accounts where ACC = :ACC_3519_07 " )
									and NOT SqlFetchNext( hSql(), nFetchRes )
							If SqlPrepareAndExecute( hSql(), 
									"SELECT  -ostc/100 , -ostb/100  into :OST_3619_04, :OST_3619_04b 
									 FROM accounts where ACC = :ACC_3619_04 " )
									and NOT SqlFetchNext( hSql(), nFetchRes )
			Data Field: REF4
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5441423400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.917"
						Top:    4.536"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On VTM_LeftDoubleClick
						If REF4 > 0 
							Call DocViewContentsEx(hWndForm, REF4)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.документу - 4' )
					On SAM_SetFocus
						Set nTmpE = REF4
					On SAM_AnyEdit
						Set REF4 = nTmpE
		Functions
			Function: F_POISK
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
					String: sTmp1
				Actions
					! ! Call SalWaitCursor( FALSE )
					Set sTmp = STRING_Null
					Set OST_2202 = 0
					Set OST_2208 = 0
					Set OST_DOX  = 0
					Set OST_9501 = 0
					Set Sum1 = 0
					Call FunNSIGetFiltered
							("CC_V","NAMK"," CC_V.PROD='220205' and CC_V.DWDATE < gl.BD", sTmp, sTmp1)
					If sTmp != STRING_Null
						Set NAMK = sTmp1
						Set ND = Val(sTmp)
						If SqlPrepareAndExecute( hSql(), 
								"select a.acc, a.nls, a.nms, -a.ostc /100 
								 into :ACC_2202, :NLS_2202, :NMS_2202, :OST_2202 
								 from accounts a, nd_acc n 
								 where a.acc=n.acc and n.nd =:ND and a.nbs ='2202' and a.kv=980 " ) 
								and SqlFetchNext( hSql(), nFetchRes )
							If SqlPrepareAndExecute( hSql(), 
									"select a.acc, a.nls, a.nms, -a.ostc /100 
									 into :ACC_2208, :NLS_2208, :NMS_2208, :OST_2208 
									 from accounts a, nd_acc n 
									 where a.acc=n.acc and n.nd =:ND and a.nbs ='2208' and a.kv=980 " )
									and SqlFetchNext( hSql(), nFetchRes )
							Set OST_DOX = SalNumberRound( (OST_2202 + OST_2208) *15 )/100
							Set Sum1 =  OST_2202 + OST_2208 + OST_DOX 
							If SqlPrepareAndExecute( hSql(), 
									"select a.acc, a.nls, a.nms, -a.ostc /100 
									 into :ACC_9501, :NLS_9501, :NMS_9501, :OST_9501 
									 from accounts a, cc_accp p 
									 where p.accs = :ACC_2202 and p.acc=a.acc and a.nbs like '950_' and a.kv=980 " )
									and SqlFetchNext( hSql(), nFetchRes )
					Else
						Set NAMK = STRING_Null
			Function: F_Del
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If Sum4 > 0 and Sum31 >0 
						Set SumD = Sum4 - Sum31
						Set SumDn = Sum4n - Sum31n
						Set SumDp = Sum4p - Sum31p
			Function: F_Opl
				Description:
				Returns
				Parameters
					Number: nReg
					String: strTip
				Static Variables
				Local variables
					Number: nRef
					Number: nS
				Actions
					If nReg = 1
						Set nS =  Sum1 * 100
						Call cDoc.SetDoc( 0, sTT, 1, 6, STRING_Null,
								     dDat, dDat, dDat, dDat,
								     NLS_3409_04, NMS_3409_04, aMfo,'', n980, nS, aOkpo,
								     NLS_3739_05, NMS_3739_05, aMfo,'', n980, nS, aOkpo,
								     NAZN1, '', GetIdOper(), '', NUMBER_Null, 0 )
						If NOT cDoc.oDoc()
							Return FALSE
						Set nRef = cDoc.m_nRef
						!
						Set nS =  OST_9501*100
						If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980, NLS_9900,nS,n980,NLS_9501,nS)
							Return FALSE
						!
						Set nS =  OST_2202*100
						If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980, NLS_3739_05,nS,n980,NLS_2202,nS)
							Return FALSE
						!
						Set nS =  OST_2208*100
						If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980, NLS_3739_05,nS,n980,NLS_2208,nS)
							Return FALSE
						!
						Set REF1 = nRef
					Else If nReg = 2
						Set nS =  Sum2 * 100
						Call cDoc.SetDoc( 0, sTT, 0, 6, STRING_Null,
								     dDat, dDat, dDat, dDat,
								     NLS_3409_04, NMS_3409_04, aMfo,'', n980, nS, aOkpo,
								     NLS_3407_01, NMS_3407_01, aMfo,'', n980, nS, aOkpo,
								     NAZN2, '', GetIdOper(), '', NUMBER_Null, 0 )
						If NOT cDoc.oDoc()
							Return FALSE
						Set nRef = cDoc.m_nRef
						!
						Set nS =   OST_PDV *100
						If NOT cDoc.PayV (0,nRef,dDat,sTT,1 ,n980, NLS_3407_01,nS,n980,NLS_3622_52,nS)
							Return FALSE
						!
						Set REF2 = nRef
					Else If nReg = 3
						!
						Set nS =  Sum3 * 100
						Call cDoc.SetDoc( 0, sTT, 1, 6, STRING_Null,
								     dDat, dDat, dDat, dDat,
								     NLS_3519_07, NMS_3519_07, aMfo,'', n980, nS, aOkpo,
								     NLS_3407_01, NMS_3407_01, aMfo,'', n980, nS, aOkpo,
								     NAZN3, '', GetIdOper(), '', NUMBER_Null, 0 )
						If NOT cDoc.oDoc()
							Return FALSE
						Set nRef = cDoc.m_nRef
						Set REF3 = nRef
					Else If nReg = 4
						! ДМ
						Set nS =  Sum31 * 100
						Call cDoc.SetDoc( 0, sTT, 0, 6, STRING_Null,
								     dDat, dDat, dDat, dDat,
								     NLS_3519_07, NMS_3519_07, aMfo,'', n980, nS, aOkpo,
								     NLS_3619_04, NMS_3619_04, aMfo,'', n980, nS, aOkpo,
								     NAZN4, '', GetIdOper(), '', NUMBER_Null, 0 )
						If NOT cDoc.oDoc()
							Return FALSE
						Set nRef = cDoc.m_nRef
						! ПДВ
						Set nS =   Sum31p *100
						If NOT cDoc.PayV (0,nRef,dDat,sTT,1 ,n980, NLS_3622_52,nS,n980,NLS_3622_51,nS)
							Return FALSE
						! Дох + ПДВк
						If SumD >0 
							Set nS =   SumDn *100
							If NOT cDoc.PayV (0,nRef,dDat,sTT,1 ,n980, NLS_3619_04,nS,n980,NLS_6499_01,nS)
								Return FALSE
							!
							Set nS =   SumDp *100
							If NOT cDoc.PayV (0,nRef,dDat,sTT,1 ,n980, NLS_3619_04,nS,n980,NLS_3622_51,nS)
								Return FALSE
						If SumD <0 
							Set nS =   -SumDn *100
							If NOT cDoc.PayV (0,nRef,dDat,sTT,1 ,n980, NLS_7499_17,nS,n980,NLS_3619_04,nS)
								Return FALSE
							!
							Set nS =   - SumDp *100
							If NOT cDoc.PayV (0,nRef,dDat,sTT,1 ,n980, NLS_3622_52,nS,n980,NLS_3622_51,nS)
								Return FALSE
							Set nS =  (Sum31p +SumDp) *100
							If NOT cDoc.PayV (0,nRef,dDat,sTT,1 ,n980, NLS_3622_52,nS,n980,NLS_3519_07,nS)
								Return FALSE
						!
						Set REF4 = nRef
					Call SqlCommitEx( hSql(), strTip )
					Return TRUE
		Window Parameters
			Number: nMode
			Number: nPar
			String: sTT
			String: strPar02
		Window Variables
			Number: ACC_2202
			Number: ACC_2208
			Number: ACC_9501  
			Number: ACC_3409_04 
			Number: ACC_3407_01 
			Number: ACC_3622_52 
			Number: ACC_3519_07
			Number: ACC_3619_04
			Number: n980
			Date/Time: dDat
			String: aMfo
			String: aOkpo
			: cDoc
				Class: cDoc
			Number: nTmpE
			String: sTmpE 
			String: NLS_3622_51
			String: NLS_7499_17
			String: NLS_6499_01
		Message Actions
			On SAM_Create
				! 9900, 
						3409/04 - вироби та лом ўз дорогоцўнних металўв                                   
						3739/05 - розрахунки за кредитними операцўями
						3407/xx(01) -  Дорогоцінні метали в дорозі                           
						3622/52 - ПДВ, термўн сплати якого не настав
						3519/07 - Дебитор.розрахунки з Державною скарбницею за зданў вироби та лом ўз дорогоцўнних металўв
						3619/04 - Кредитор.розрахунки з Державною скарбницею за зданў вироби та лом ўз дорогоцўнних металўв
						!
						3622/51 - ПДВ термўн сплати якого  настав
						7499/17 - ўншў витрати
						6499/01 - ўншў доходи
				! !!!
				! 9900
				If SqlPrepareAndExecute( hSql(), 
						"SELECT nls, nms into :NLS_9900, :NMS_9900
						 FROM accounts where kv=980 and nbs ='9900' and dazs is null order by branch " )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не знайдено рах.9900','Увага !', MB_IconStop)
				! 3409/04 - вироби та лом ўз дорогоцўнних металўв     
				If SqlPrepareAndExecute( hSql(), 
						"SELECT nls, nms, -ostc/100 , -ostb/100 , acc 
						 into :NLS_3409_04, :NMS_3409_04, :OST_3409_04, :OST_3409_04b, :ACC_3409_04
						 FROM accounts where kv=980 and nls = nbs_ob22('3409','04')" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не знайдено рах.3409/04','Увага !', MB_IconStop)
				! 3739/05 - розрахунки за кредитними операцўями
				If SqlPrepareAndExecute( hSql(), 
						"SELECT nls, nms into :NLS_3739_05, :NMS_3739_05
						 FROM accounts where kv=980 and nls = nbs_ob22('3739','05')" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не знайдено рах.3739/05','Увага !', MB_IconStop)
				! 3407/xx(01) -  Дорогоцінні метали в дорозі  
				If SqlPrepareAndExecute( hSql(), 
						"SELECT nls, nms, -ostc/100 , -ostb/100, acc 
						 into :NLS_3407_01, :NMS_3407_01 , :OST_3407_01 , :OST_3407_01b, :ACC_3407_01
						 FROM accounts where kv=980 and nls = nbs_ob22('3407','01')" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не знайдено рах.3407/01','Увага !', MB_IconStop)
				! 3622_52
				If SqlPrepareAndExecute( hSql(), 
						"SELECT nls, nms, -ostc/100 , -ostb/100, acc   
						 into :NLS_3622_52, :NMS_3622_52 , :OST_3622_52 , :OST_3622_52b, :ACC_3622_52
						 FROM accounts where kv=980 and nls = nbs_ob22('3622','52')" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не знайдено рах.3622/52','Увага !', MB_IconStop)
				! 3519_07
				If SqlPrepareAndExecute( hSql(), 
						"SELECT nls, nms, -ostc/100 , -ostb/100, acc   
						 into :NLS_3519_07, :NMS_3519_07, :OST_3519_07, :OST_3519_07b, :ACC_3519_07
						 FROM accounts where kv=980 and nls = nbs_ob22('3519','07')" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не знайдено рах.3519/07','Увага !', MB_IconStop)
				! 3619_04
				If SqlPrepareAndExecute( hSql(), 
						"SELECT nls, nms, -ostc/100 , -ostb/100, acc   
						 into :NLS_3619_04, :NMS_3619_04, :OST_3619_04, :OST_3619_04b, :ACC_3619_04
						 FROM accounts where kv=980 and nls = nbs_ob22('3619','04')" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не знайдено рах.3619/04','Увага !', MB_IconStop)
				! 3622/51 - ПДВ термўн сплати якого  настав
				If SqlPrepareAndExecute( hSql(), 
						"SELECT nls into :NLS_3622_51 FROM accounts where kv=980 and nls = nbs_ob22('3622','51')" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не знайдено рах.3622/51','Увага !', MB_IconStop)
				! 7499/17 - ўншў витрати
				If SqlPrepareAndExecute( hSql(), 
						"SELECT nls into :NLS_7499_17 FROM accounts where kv=980 and nls = nbs_ob22('7499','17')" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не знайдено рах.7499/17','Увага !', MB_IconStop)
				! 6499/01 - ўншў доходи
				If SqlPrepareAndExecute( hSql(), 
						"SELECT nls into :NLS_6499_01 FROM accounts where kv=980 and nls = nbs_ob22('6499','01')" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не знайдено рах.6499/01','Увага !', MB_IconStop)
				Set dDat = GetBankDate()
				Set n980 = GetBaseVal()
				Set aMfo = GetBankMfo()
				Set aOkpo= GetBankOkpoS()
	Form Window: GEN
		Class:
		Property Template:
		Class DLL Name:
		Title: Генерация однотипных документов
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   2.288"
				Top:    2.552"
				Width:  8.65"
				Width Editable? Yes
				Height: 2.488"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			!
			Pushbutton: pb_KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.283"
					Top:    0.071"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Выбрать валюту'
					On SAM_Click
						Set sTmp = STRING_Null
						Call FunNSIGetFiltered("TABVAL","NAME",
								" TABVAL.kv in (840,978,643,756,826) ORDER BY TABVAL.kv ", sTmp, sTmp1)
						If sTmp != STRING_Null
							Set KV = Val(sTmp)
							Set KV_NAME = sTmp1
						Else
							Set KV = NUMBER_Null
							Set KV_NAME = ''
			Data Field: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.783"
						Top:    0.071"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: KV_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.483"
						Top:    0.071"
						Width:  4.6"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Pushbutton: pb_BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.283"
					Top:    0.405"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\CUSTCORP.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Выбрать Бранч'
					On SAM_Click
						Set sTmp = STRING_Null
						Call FunNSIGetFiltered("TOBO","NAME",
								" TOBO.date_closed is null ORDER BY TOBO.TOBO ", sTmp, sTmp1)
						Set USER = NUMBER_Null
						Set USER_NAME = ''
						If sTmp != STRING_Null
							Set BRANCH = sTmp
							Set BRANCH_NAME = sTmp1
						Else
							Set BRANCH = ''
							Set BRANCH_NAME = ''
			Data Field: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.783"
						Top:    0.405"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: BRANCH_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.483"
						Top:    0.405"
						Width:  4.6"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Pushbutton: pb_USER
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.283"
					Top:    0.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\CUSTPERS.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Выбрать пользователя'
					On SAM_Click
						Set sTmp = STRING_Null
						Call FunNSIGetFiltered("STAFF","FIO",
								" STAFF.tobo='"||BRANCH || "' and STAFF.BAX=1 ORDER BY STAFF.FIO ", sTmp, sTmp1)
						If sTmp != STRING_Null
							Set USER = Val(sTmp)
							Set USER_NAME = sTmp1
						Else
							Set USER = NUMBER_Null
							Set USER_NAME = ''
			Data Field: USER
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.783"
						Top:    0.738"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: USER_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.483"
						Top:    0.738"
						Width:  4.6"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Data Field: SUMO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.783"
						Top:    1.071"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Общая сумма в инвалюте')
			!
			Pushbutton: pb_Och
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.983"
					Top:    1.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\COPY.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Yellow
				Message Actions
					On SAM_Create
						Set strTip = 'Сформировать очередь документов'
					On SAM_Click
						Call F_Och()
						Call SalEnableWindow( pb_Och )
			Pushbutton: pb_Opl0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.583"
					Top:    1.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\OK.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Срочно выполнить очередь документов'
					On SAM_Click
						Call F_Opl0()
						Call SalEnableWindow( pb_Opl0 )
			!
			Data Field: PAROL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.783"
						Top:    1.071"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Invisible
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbParol
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.983"
					Top:    1.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Подтвердить пароль'
					On SAM_Click
						If PAROL = SalFmtFormatDateTime( SalDateCurrent(  ), 'MMdd' )
							Call F_Show()
						Else
							Call SalDestroyWindow(hWndForm)
			Frame
				Resource Id: 2689
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.583"
					Top:    1.071"
					Width:  3.9"
					Width Editable? Yes
					Height: 0.417"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Drop-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Radio Button: rb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Продажа
				Window Location and Size
					Left:   2.683"
					Top:    1.155"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Покупка
				Window Location and Size
					Left:   4.25"
					Top:    1.179"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
		Functions
			Function: F_Hide
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalHideWindow( rb1 )
					Call SalHideWindow( rb2 )
					Call SalHideWindow( pb_USER )
					Call SalHideWindow( USER )
					Call SalHideWindow( USER_NAME )
					!
					Call SalHideWindow( pb_BRANCH )
					Call SalHideWindow( BRANCH )
					Call SalHideWindow( BRANCH_NAME )
					!
					Call SalHideWindow( pb_KV )
					Call SalHideWindow( KV )
					Call SalHideWindow( KV_NAME )
					!
					Call SalHideWindow( SUMO )
					Call SalHideWindow( pb_Och )
					Call SalHideWindow( pb_Opl0 )
			Function: F_Show
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalShowWindow( rb1 )
					Call SalShowWindow( rb2 )
					!
					Call SalHideWindow( pbParol )
					Call SalHideWindow( PAROL )
					!
					Call SalShowWindow( pb_USER )
					Call SalShowWindow( USER )
					Call SalShowWindow( USER_NAME )
					!
					Call SalShowWindow( pb_BRANCH )
					Call SalShowWindow( BRANCH )
					Call SalShowWindow( BRANCH_NAME )
					!
					Call SalShowWindow( pb_KV )
					Call SalShowWindow( KV )
					Call SalShowWindow( KV_NAME )
					!
					Call SalShowWindow( SUMO )
					Call SalShowWindow( pb_Och )
					Call SalShowWindow( pb_Opl0 )
			Function: F_Och
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sSoob
					Number: nPR
				Actions
					Call SalDisableWindow( pb_Och )
					!
					Set nPR = IifN(rb1,1,2)
					If KV = NUMBER_Null or BRANCH = STRING_Null or USER = NUMBER_Null
							or SUMO = NUMBER_Null or SUMO <= 0
						Call SalMessageBox ('Не заданы все необходимые параметры ' ,
								'Ошибка !', MB_IconStop)
						Return FALSE
					Set sSoob = 'Выполнена очередь платежей GEN_PL '
					Call SalWaitCursor(TRUE)
					If SqlPLSQLCommand( hSql(), "GEN_PL1 (USER, BRANCH, KV, SUMO, nPR )" )
						Call SqlCommitEx( hSql(),sSoob )
						Call SalWaitCursor(FALSE)
						Call MessageNoWait(sSoob,'Сообщение',3,0)
						Return TRUE
					!
					Call SqlRollback(hSql())
					Call SalWaitCursor(FALSE)
					Call MessageNoWait('Неуспешное выполнение', 'Ошибка', 0, 1)
					Return FALSE
			Function: F_Opl0
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sSoob
				Actions
					!
					Set sSoob = 'Выполнена очередь платежей GEN_PL '
					Call SalWaitCursor(TRUE)
					Call SalDisableWindow( pb_Opl0 )
					If SqlPLSQLCommand( hSql(), "GEN_PL2 ( 0 )" )
						Call SqlCommitEx( hSql(),sSoob )
						Call SalWaitCursor(FALSE)
						Call MessageNoWait(sSoob,'Сообщение',3,0)
						Return TRUE
					!
					Call SqlRollback(hSql())
					Call SalWaitCursor(FALSE)
					Call MessageNoWait('Неуспешное выполнение', 'Ошибка', 0, 1)
					Return FALSE
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sTmp
			String: sTmp1
		Message Actions
			On SAM_Create
				! Set TT = strPar01
				Set rb1 = TRUE
				Set rb2 = FALSE
				Call F_Hide(  )
	! cGenericTable: XD1
.winattr class Table Window:
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Maximized
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.1"
				Top:    1.375"
				Width:  10.914"
				Width Editable? Yes
				Height: 5.781"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? No
.end
		                                                                                                                                                                                                                                                Description: 
		                                                                                                                                                                                                                                                Named Menus 
		                                                                                                                                                                                                                                                Menu 
		                                                                                                                                                                                                                                                Tool Bar 
			                                                                                                                                                                                                                                                Contents 
				                                                                                                                                                                                                                                                Pushbutton: pbIns
					                                                                                                                                                                                                                                                Message Actions 
				                                                                                                                                                                                                                                                Pushbutton: pbDel
					                                                                                                                                                                                                                                                Message Actions 
				                                                                                                                                                                                                                                                Pushbutton: pbRefresh
					                                                                                                                                                                                                                                                Message Actions 
				                                                                                                                                                                                                                                                Pushbutton: pbUpdate
					                                                                                                                                                                                                                                                Message Actions 
				                                                                                                                                                                                                                                                Line 
				                                                                                                                                                                                                                                                Pushbutton: pbSearch
					                                                                                                                                                                                                                                                Message Actions 
				                                                                                                                                                                                                                                                Pushbutton: pbFilter
					                                                                                                                                                                                                                                                Message Actions 
				                                                                                                                                                                                                                                                Pushbutton: pbDetails
					                                                                                                                                                                                                                                                Message Actions 
				                                                                                                                                                                                                                                                Pushbutton: pbPrint
					                                                                                                                                                                                                                                                Message Actions 
				                                                                                                                                                                                                                                                Line 
				                                                                                                                                                                                                                                                Pushbutton: pbExit
					                                                                                                                                                                                                                                                Message Actions 
				                                                                                                                                                                                                                                                Line 
		                                                                                                                                                                                                                                                Contents 
			                                                                                                                                                                                                                                                Column: DK 
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: ND 
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: CC_ID 
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: RNK 
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: BRANCH  
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: DAT1 
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: DAT4 
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: ISP 
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: NLS 
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: OB22
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: SDOG 
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: OSTC 
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                Column: ACC 
				                                                                                                                                                                                                                                                List Values 
				                                                                                                                                                                                                                                                Message Actions 
			!
		                                                                                                                                                                                                                                                Functions 
		                                                                                                                                                                                                                                                Window Parameters 
			                                                                                                                                                                                                                                                Number: nMode
			                                                                                                                                                                                                                                                Number: nPar
			                                                                                                                                                                                                                                                String: strPar01
			                                                                                                                                                                                                                                                String: strPar02
		                                                                                                                                                                                                                                                Window Variables 
		                                                                                                                                                                                                                                                Message Actions 
			                                                                                                                                                                                                                                                On SAM_Create
				                                                                                                                                                                                                                                                Set XD1.strSqlPopulate =
						"SELECT ISP,ND,CC_ID,DK,RNK,DAT1,DAT4,OSTC/100,NLS,OB22,ACC,BRANCH,SDOG
						 into :XD1.ISP,:XD1.ND,:XD1.CC_ID,:XD1.DK,:XD1.RNK,
						      :XD1.DAT1,:XD1.DAT4,:XD1.OSTC,:XD1.NLS,:XD1.OB22,:XD1.ACC,
						      :XD1.BRANCH,:XD1.SDOG 
						 FROM XD_v 
						 order by dk, dat4 desc, nd  "
				! ( sdog)
				! Set nId  = GetUserId()
				! Set dDat = GetBankDate()
				! Set n980 = GetBaseVal()
				! Set aMfo = GetBankMfo()
				! Set aOkpo= GetBankOkpoS()
				! Call ShowApdVersion('03')
				! Call SalMapEnterToTab( TRUE )
				                                                                                                                                                                                                                                                Call SalTblSetLockedColumns( hWndForm, 2 )
				                                                                                                                                                                                                                                                Call SalSendClassMessage( SAM_Create, 0, 0 )
	Table Window: SEP
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Перерозподiл комiсiї ГОУ за СЕП-платежi
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  12.317"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.095"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.783"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати розрахунок сум по перерозподілу (проект проводок)'
						On SAM_Click
							If SUM_3739 = NUMBER_Null or SUM_3739 <= 0
								Call SalMessageBox('Не указано суму для перерозподілу !','Увага !', MB_IconStop)
							Else
								Call NASELENIE ()
				Data Field: NLS_3739
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок для перерозподілу' )
						On SAM_KillFocus
							Call F_3739 (NLS_3739)
				Data Field: SUM_3739
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.283"
							Top:    0.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сума для перерозподілу' )
				Data Field: OST_3739
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.405"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Факт.Зал.нарахунку для перерозподілу' )
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.283"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути історію вибранного рахунку 3739'
						On SAM_Click
							Call Show_Sal_Day_P(nAcc, NLS_3739, n980, dDat -10, dDat )
				Data Field: KOL_ALL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.283"
							Top:    0.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Загальна кількість документів' )
				Data Field: NMS_3739
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.283"
							Top:    0.405"
							Width:  5.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва рахуноку для перерозподілу' )
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.283"
							Top:    0.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата "З" ' )
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.283"
							Top:    0.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата "По" ' )
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.783"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати ' || sTitl
						On SAM_Click
							Set sPeriod =' за період з ' || 
									SalFmtFormatDateTime( DAT1, 'dd.MM.yyyy' ) || ' по ' || 
									SalFmtFormatDateTime( DAT2, 'dd.MM.yyyy' ) 
							If SalMessageBox('Ви дiйсно бажаєте 
									' || strTip  || ' 
									' || sPeriod || ' ? ',
									'У в а г а ! ', MB_IconQuestion | MB_YesNo) = IDYES
								If Not F_Opl(strTip)
									Call SqlRollback( hSql() )
				Data Field: REF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   10.283"
							Top:    0.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On VTM_LeftDoubleClick
							If REF > 0 
								Call DocViewContentsEx(hWndForm, REF )
						On SAM_SetFocus
							Set nTmpE = REF
						On SAM_AnyEdit
							Set REF = nTmpE
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Референс док по перерозподілу' )
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 41724
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.45"
						Top:    0.655"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.283"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 41725
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.483"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Check Box: cb_Zo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Корр.об.
					Window Location and Size
						Left:   10.35"
						Top:    0.429"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Line
					Resource Id: 41726
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: NAZN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 160
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.738"
							Width:  12.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Призначення пл.' )
		Contents
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Бранчу-2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SBRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						Бранчу-2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кiлькiсть
						СЕП док.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.Бранчу
						7100/06
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOEF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: % від
						заг.Суми
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.1"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			!
		Functions
			Function: F_3739
				Description:
				Returns
				Parameters
					String: sNls
				Static Variables
				Local variables
					Number: nOstB
				Actions
					If SqlPrepareAndExecute(hSql(),
							 "SELECT substr(nms,1,38), ostc/100 , acc, ostB/100
							  into :NMS_3739, :OST_3739 , :nAcc , :nOstB
							  from accounts where kv=:n980 and nls= :sNls and dazs is null ") 
							  and SqlFetchNext(hSql(), nFetchRes)
						If OST_3739 >= 0
							Call SalMessageBox('Залишок на рах.' || NLS_3739 || ' НЕ дебетовий','Увага !', MB_IconStop)
							Return FALSE
						If OST_3739 != nOstB
							Call SalMessageBox('Факт.зал. на рах.' || NLS_3739 || ' НЕ = План.зал.','Увага !', MB_IconStop)
							Return FALSE
						!
						Set SUM_3739 = - OST_3739
						Return TRUE
					Else
						Call SalMessageBox('Рах.' || NLS_3739 || ' НЕ знайдено (або Закрито)','Увага !', MB_IconStop)
						Set NLS_3739 = STRING_Null
						Set NMS_3739 = STRING_Null
						Set OST_3739 = 0
						Return FALSE
					!
			Function: NASELENIE
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					! If SUM_3739 <= 0
						                                                                                                                                                                                                                             Call SalMessageBox('Помилка в сумі для перерозподілу !','Увага !', MB_IconStop)
						                                                                                                                                                                                                                             Return FALSE
					Call SalWaitCursor(TRUE)
					Set nS = SUM_3739
					Set nK = 100
					Set sSql = 
							"select b.BRANCH, b.name , o.KOL, o.KOL_ALL ,
							        substr( nbs_ob22_null( :NBS_7100, :OB22_06, b.branch), 1,14) 
							 into :SEP.BRANCH, :SEP.SBRANCH, :SEP.KOL, :SEP.KOL_ALL, :SEP.NLS7
							 from branch b, 
							     (SELECT distinct  substr( branch||'000000/', 1,15) BRANCH , 
							          ( count(*) over (partition by substr( branch||'000000/', 1,15) ) ) KOL, 
							          ( count(*) over ()                                               ) KOL_ALL  
							      from oper 
							      where vdat >= :DAT1 and vdat <= :DAT2 
							        and sos   = 5     and kv    = :n980 
							        and mfoa  = :aMfo and mfob <> mfoa ) o
							 where b.branch = o.branch 
							 ORDER BY BRANCH desc "
					Call SalTblPopulate(hWndForm, hSql(), SEP.sSql, TBL_FillAll)
					Call SalTblSortRows( hWndForm, 1, TBL_SortIncreasing )
					!
					If sNLS7 != STRING_Null 
							and SqlPrepareAndExecute(hSql(),
							 "SELECT Substr(nms,1,38) into :sNMS7 from accounts where kv=:n980 and nls=:sNLS7 ")
							and SqlFetchNext(hSql(), nFetchRes)
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
			Function: F_Opl
				Description:
				Returns
					Boolean:
				Parameters
					String: strTip
				Static Variables
				Local variables
					Number: nn
					Number: nS1
					Number: nRef
					Number: nS4
					Number: nS5
					Number: nITOG
					String: sNazn
					! String: sNazn2
					!
				Actions
					Set nRow = TBL_MinRow
					Set nn = 0
					Set sNazn =  Subs( NAZN || sPeriod,1,160 )
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If nn = 0
							Set nS1 = SUM_3739 * 100
							Call cDoc.SetDoc( 0, sTT, 0, IifN( cb_Zo = 0,nVob,96), STRING_Null,
									     dDat, dDat, dDat, dDat,
									     NLS_3739, NMS_3739, aMfo,'', n980, nS1, aOkpo,
									     NBS_7100||'/'||OB22_06, 'Різні', aMfo,'', n980, nS1, aOkpo,    
									     sNazn, '', GetIdOper(), '', NUMBER_Null, 0 )
							If NOT cDoc.oDoc() 
								Return FALSE
							Set nRef = cDoc.m_nRef
						!
						Set nS1 = S *100
						If NOT cDoc.PayV (0,nRef,dDat,sTT,1,n980, NLS7,nS1,n980,NLS_3739,nS1)
							Return FALSE
						Set nn = nn +1 
					If SqlPrepareAndExecute( hSql(),
							"UPDATE ope_lot set 
							 nazn1 = substr(:NAZN,1,160), 
							 datp = :DAT2, 
							 nls = :NLS_3739 where id = :nIde  " )
						Call SqlCommitEx(  hSql(), strTip || '. Реф='|| Str(nRef))
					Set REF= nRef
					!
					Return TRUE
		Window Parameters
			Number: nMode
			Number: nPar
			String: str_3739
			String: sVob
		Window Variables
			String: sTT
			Number: nId
			Date/Time: dDat
			Date/Time: dDat1
			Date/Time: dDat2
			Number: n980
			String: aMfo
			String: aOkpo
			Number: nS
			Number: nK
			Number: nKoef
			String: sNLS7
			String: sNMS7
			String: mBRANCH
			String: sSql
			String: sTitl
			Number: nTmpE
			String: sPeriod
			Number: nVob
			Number: nRef 
			Number: nAcc
			!
			Number: nIde
			String: NBS_7100
			String: OB22_06
			Date/Time: DATP
			String: sSqlD 
			!
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				Set sTT ='ZMO'
				Set nId  = GetUserId()
				Set dDat = GetBankDate()
				Set n980 = GetBaseVal()
				Set aMfo = GetBankMfo()
				Set nVob = -7
				Set cb_Zo = 0
				! If sVob != STRING_Null
					                                                                                                                                                                                                         Set nVob = Val(sVob)
				Set aOkpo= GetBankOkpoS()
				Set mBRANCH = '/' || aMfo || '/000000/'
				Set sTitl = 'Перерозподiл комiсiї ГОУ за СЕП-платежi' 
				Call SalTblSetLockedColumns( hWndForm, 2 )
				Set SEP.strPrintFileName = 'SEP'
				!
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On SAM_CreateComplete
				If nPar = 0
					Set nIde = 1
				Else
					Set nIde= nPar
				!
				If SqlPrepareAndExecute(hSql(),
						 "SELECT  BS1, OB1, NLS , nazn1, datp 
						  INTO :NBS_7100, :OB22_06, :NLS_3739, :NAZN, :DATP FROM ope_lot where id = :nIde ")
						and SqlFetchNext(hSql(), nFetchRes)
				If NBS_7100 = STRING_Null OR OB22_06 = STRING_Null
					Set NBS_7100 = '7100'
					Set OB22_06 = '06'
				If NLS_3739 = STRING_Null
					Set NLS_3739 = str_3739 
				If NAZN = STRING_Null
					Set NAZN = sTitl
				If DATP != DATETIME_Null
					Set sSqlD = "SELECT add_months( :DATP , 1 ), (:DATP +1 ) "
				Else
					Set sSqlD = "SELECT trunc(gl.BD,'MM') - 1 , trunc( trunc(gl.BD,'MM') -1, 'MM' ) "
				If SqlPrepareAndExecute(hSql(), sSqlD || " INTO :dDat2, :dDat1 FROM dual ")
						and SqlFetchNext(hSql(), nFetchRes)
					Set DAT2 = dDat2
					Set DAT1 = dDat1
				Call F_3739 (NLS_3739) 
				! Call Debug('5) после F_3739...' ) 
			On SAM_FetchRowDone
				Set sNLS7 = NLS7
				If BRANCH = mBRANCH
					Set S =  nS
					Set KOEF = nK  
				Else
					If KOL_ALL > 0
						Set nKoef = KOL/KOL_ALL
						Set S = SalNumberRound( SUM_3739 *100 * nKoef ) /100
						Set KOEF = nKoef *100
						Set nS = nS - S
						Set nK = nK - KOEF
			On SAM_ColumnSelectClick
	Table Window: MA0
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Макети проводок
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.213"
				Top:    -0.01"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.625"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.488"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9398
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.117"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати Розрахунки по макету '
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9399
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9400
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Dbf
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\TOCENTER.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Periwinkle
					Message Actions
						On SAM_Create
							Set strTip = 
									'Прийняти файл сум ISPRO.dbf з "Внутрішньої бухгалтерії" 
									 з ідентифікацією по Бранч-3' 
						On SAM_Click
							Call GeneralImport(hWndForm, 1,110, "","" )
							!
							If SalMessageBox(
									"Ви дiйсно бажаєте ВИКОНАТИ ПРОВОДКИ 
									по прийнятому файлу ISPRO.dbf ? ",
									"У В А Г А !" , MB_IconQuestion | MB_YesNo) = IDYES
								Call SalWaitCursor(TRUE)
								If SqlPLSQLCommand( hSql(), " MAKET( 0, dDat, dDat )" )
									Call SqlCommitEx(  hSql(), strTip ) 
									Call SalWaitCursor(FALSE)
									Call FunNSIEditF("ISPRO",1)
								Call SalWaitCursor(FALSE)
		Contents
			Column: DK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Д/К
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 160
				Data Type: Number
				Justify: Right
				Width:  0.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: GRP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						грп
				Visible? Yes
				Editable? No
				Maximum Data Length: 160
				Data Type: Number
				Justify: Right
				Width:  0.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						макету
				Visible? Yes
				Editable? No
				Maximum Data Length: 160
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва  макету
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						А
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: БалР
						Б
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OB22
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОБ22
						Б
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Попереднє призн.платежу
				Visible? Yes
				Editable? No
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  6.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата поперед.
						виконання
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.433"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ALG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						алг
				Visible? Yes
				Editable? No
				Maximum Data Length: 160
				Data Type: Number
				Justify: Right
				Width:  0.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			! Number: nId
			Date/Time: dDat
			! Number: n980
			! Number: nTmpE
			! Date/Time: DatS
			!
			String: sFilter1
			String: sFilter2
			String: sTmp
			String: sDynM
			! String: aOkpo
			!
			! cDoc: cDoc
			! Number: nVob
		Message Actions
			On SAM_Create
				If SalStrTrimX( strPar01 ) =""
					Set sFilter1 = ""
				Else
					Set sFilter1 = " and id in ( " || strPar01 || " ) "
				!
				If SalStrTrimX( strPar02 ) = ""
					Set sFilter2 = ""
				Else
					Set sFilter2 = " and grp in ( " || strPar02 || " ) "
				!
				Set MA0.strSqlPopulate =
						"SELECT id, NAME, NLS, BS1, OB1,  nazn1, datp, ALG, GRP, dk
						 INTO :MA0.ID,:MA0.NAME,:MA0.NLS,:MA0.NBS,:MA0.OB22,:MA0.NAZN,:MA0.DATP,:MA0.ALG,:MA0.GRP,:MA0.DK 
						 FROM OPE_LOT 
						 where " ||
						IifS(nMode=29,
						" ob22 = '~~' ",
						" ob22 <> '~~' and (id < 0 or grp > 0 ) "|| sFilter1 || sFilter2 ||" order by id desc " )
				Set MA0.nTabInstance = 1
				Set MA0.strFilterTblName = 'OPE_LOT'
				!
				Set dDat = GetBankDate()
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 5 )
				!
				If nMode = 29
					Call SalHideWindow( GRP )
					Call SalHideWindow( ID )
					!
				Else
					Call SalDisableWindow( DK )
					Call SalDisableWindow( NLS )
					Call SalDisableWindow( NBS )
					Call SalDisableWindow( OB22 )
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On SAM_FetchRowDone
				If GRP != NUMBER_Null
					! М/Б
					If DK =0
						Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,250 ) )
					Else
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
					If NLS = STRING_Null
						Call XSalTblSetCellBackColor( MA0.NLS, COLOR_Yellow )
				Else If ALG != 0 and ALG != NUMBER_Null
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen )
					! зеленый суммі поделены по зашитому алгоритму
			On SAM_DoubleClick
				! Натуральній макет (Dyn or  2 или 3)
				If nMode = 29
					If MA0.DK = NUMBER_Null
						Set MA0.DK = 1 
					Set sDynM =  Str( MA0.DK) || MA0.NBS || MA0.OB22
					Call Sel002( hWndMDI, 20 + nPar , NUMBER_Null, sDynM, SalStrTrimX( MA0.NLS ) ) 
				Else If GRP = NUMBER_Null 
					Call Sel002( hWndMDI, 20 + nPar , MA0.ID,      MA0.NBS || MA0.OB22, SalStrTrimX( MA0.NLS ) ) 
				Else
					! Типа перекрітий
					Call Sel002( hWndMDI, 31, MA0.GRP, SalStrTrimX( MA0.NLS ), STRING_Null ) 
	Table Window: MAB
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Виконання макету (М/Б та Вн) по заданим МФО-Б та рах-Б 
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  27.6"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1500
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.536"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: ДТ рах/DK=1,3 
					Window Location and Size
						Left:   0.283"
						Top:    0.071"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Message Actions
				Radio Button: rb0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: КТ рах/DK= 0,2
					Window Location and Size
						Left:   2.383"
						Top:    0.071"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Red
					Background Color: Default
					Message Actions
				Data Field: SUM_0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.383"
							Top:    0.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Загальна Сума для розподілу' )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Очистити таблицю'
						On SAM_Click
							! Set nReg = 0
							Call NASELENIE ()
				Pushbutton: pb_Razbit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_PROC.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Перерозбити суми проводок згідно % долі'
						On SAM_Click
							If PRC_R = 100 and SUM_0 > 0
								Call F_Razbit(strTip)
							Else
								If PRC_R != 100
									! Call SalMessageBox('Загальний % НЕ = 100 '  ,'Увага!', MB_IconStop)
									If SalMessageBox('Загальний % НЕ = 100','Продовжити ?  ', MB_IconQuestion | MB_YesNo) = IDYES
										Call F_Razbit(strTip)
								If SUM_0 <=0 
									! Call SalMessageBox(' Не указана Загальна Сума для розподілу '  ,'Увага!', MB_IconStop)
									If SalMessageBox('Не указана Загальна Сума для розподілу ',
											'Продовжити ?  ', MB_IconQuestion | MB_YesNo) = IDYES
										Call F_Razbit(strTip)
				! ctb_pbExecute: pb_InsF
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.071"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: White
.end
					                                                                                                                                                         Message Actions 
						                                                                                                                                                         On SAM_Create
							                                                                                                                                                         Set strTip = 
									'Прийняти суми з XML (МАSTER CARD, VISA, ...)' 
						                                                                                                                                                         On SAM_Click
							                                                                                                                                                         Call Ins_File(strTip,nPar, '.xml' )
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати проводки згідно макету "' || sTitl || '"'
						On SAM_Click
							If REF > 0
								! Call SalMessageBox(
										'Для продовження цьго макету -
										 дані потрібно поновити !',
										'Оплату уже виконано ! ( див.рeф ' || Str( REF)|| ')' , MB_IconStop)
								Set sUvaga = 'УВАГА ! ПОВТОРНА опл. макету без поновлення інформації !'
							Else
								Set sUvaga = 'Підтвердіть  ! '
							Set sPeriod =' за період з ' ||
									SalFmtFormatDateTime( DAT1, 'dd.MM.yyyy' ) || ' по ' ||
									SalFmtFormatDateTime( DAT2, 'dd.MM.yyyy' )
							If SUM_0 = SUM_R
								If SalMessageBox('Ви дiйсно бажаєте
										' || strTip  || '
										' || sPeriod || ' ? ',
										sUvaga , MB_IconQuestion | MB_YesNo) = IDYES
									If Not F_Opl(strTip)
										Call SqlRollback( hSql() )
							Else
								Call SalMessageBox('Загальна Сума для розподілу ' || Str( SUM_0)  || ' 
										НЕ дорівнює 
										Набрано суму '|| Str( SUM_R) ,'Увага, можлива помилка !', MB_IconStop)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.383"
						Top:    1.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Data Field: REF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   8.083"
							Top:    0.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On VTM_LeftDoubleClick
							If REF > 0
								Call DocViewContentsEx(hWndForm, REF )
						On SAM_SetFocus
							Set nTmpE = REF
						On SAM_AnyEdit
							Set REF = nTmpE
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Референс сформованого Першого документу ' )
				Data Field: PRC_R
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.183"
							Top:    0.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: 000000
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Набрано %' )
				Data Field: SUM_R
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.283"
							Top:    0.071"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Набрано суму' )
				!
				Data Field: NLSA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.383"
							Top:    0.405"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок-А' )
						On SAM_KillFocus
							Call F_NLSA (NLSA)
				Data Field: KVA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 3
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.883"
							Top:    0.405"
							Width:  0.633"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код вал-А' )
						On SAM_KillFocus
							Call F_NLSA (NLSA)
				Data Field: OST_NLSA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.383"
							Top:    0.405"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Факт.Зал.на рахунку-А ' )
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.583"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути історію вибранного рахунку-A'
						On SAM_Click
							Call Show_Sal_Day_P(nAcc, NLSA, n980, dDat -10, dDat )
				Data Field: NMS_NLSA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.083"
							Top:    0.405"
							Width:  6.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва рахуноку-А' )
				!
				Data Field: NAZN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 160
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.738"
							Width:  12.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Призначення пл.' )
				!
				Data Field: ND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 10
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.683"
							Top:    1.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ документу (розпорядження)' )
				Data Field: DATD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.383"
							Top:    1.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата документу (розпорядження)' )
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   5.983"
							Top:    1.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата "З" ' )
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.583"
							Top:    1.071"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата "По" ' )
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.883"
						Top:    1.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				!
				Frame
					Resource Id: 14765
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.383"
						Top:    1.071"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    1.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Добавити нового учасника групи і його пл.реквізити'
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    1.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вилучити учасника групи '
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    1.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Зберегти зміни складу групи'
				!
				Line
					Resource Id: 9401
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.45"
						Top:    0.655"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9402
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 9403
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				! Check Box: cb_Zo
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Корр.об.
					Window Location and Size
						Left:   6.85"
						Top:    0.095"
						Width:  1.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
.end
					                                                                                                                                                         Message Actions 
				Check Box: cb_DK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Інформфційно
					Window Location and Size
						Left:   0.283"
						Top:    0.405"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Check Box: cb_Nazn
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: +  Дати в призн.пл.
					Window Location and Size
						Left:   9.35"
						Top:    1.095"
						Width:  2.933"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
				Check Box: cb_00
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: без 0,00
					Window Location and Size
						Left:   12.417"
						Top:    0.786"
						Width:  1.867"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
		Contents
			Column: KVAA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.533"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSAA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.A
						у нас
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTAA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.A
						Залишок
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.617"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAM_AA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва вiдправника
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  3.067"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: MFOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						МФО-Б
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_KONTROL()
					! On SAM_KillFocus
						                                             Call F_KONTROL()
			Column: NB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						МФО-Б
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.Б
						в МФО-Б
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_KONTROL()
					! On SAM_KillFocus
						                                             Call F_KONTROL()
			Column: NAM_B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва отримувача
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  3.067"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_KONTROL()
					! On SAM_AnyEdit
						                                             Call F_KONTROL()
					! On SAM_SetFocus
						                                             Call F_KONTROL()
			Column: OKPOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ід код 
						Б
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 10
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_KONTROL()
			!
			Column: K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: % від
						заг.суми
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: 000000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_STR (0)
					On SAM_KillFocus
						Call F_STR (0)
			Column: DELTA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: + або -
						Константа
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_Validate
						                                                                                                                                             Call F_STR (1)
					! On SAM_KillFocus
						                                                                                                                                             Call F_STR (1)
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						проводки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.65"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_STR (1)
					On SAM_KillFocus
						Call F_STR (1)
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						проводки
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_STR (1)
					On SAM_KillFocus
						Call F_STR (1)
			Column: REFD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.
						проводки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = REFD
					On SAM_AnyEdit
						Set REFD = nTmpE
					On SAM_DoubleClick
						If REFD != NUMBER_Null and REFD > 0 
							Call DocViewContentsEx(hWndForm, REFD )
			Column: NAZN1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Особливе призначення пл.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  5.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						оп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  0.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ORD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						пп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.571"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_STR (1)
					On SAM_KillFocus
						Call F_STR (1)
			Column: VOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
						док
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.571"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_STR (1)
					On SAM_KillFocus
						Call F_STR (1)
		Functions
			Function: F_NLSA
				Description:
				Returns
				Parameters
					String: sNls
				Static Variables
				Local variables
					Number: nOstB
					String: sSqls
				Actions
					If NLSA = STRING_Null Or KVA = NUMBER_Null
						Return FALSE
					!
					Set sSqls = 
							"SELECT substr(a.nms,1,38), a.ostc/100, a.acc, a.ostB/100, c.okpo
							 into :NMS_NLSA, :OST_NLSA , :nAcc , :nOstB, :aOkpo 
							 from accounts a, customer c 
							 where a.kv=:KVA and a.nls= :sNls and a.dazs is null and a.rnk=c.rnk "
					If SqlPrepareAndExecute(hSql(),sSqls )  and SqlFetchNext(hSql(), nFetchRes)
						If OST_NLSA != nOstB
							Call SalMessageBox('Факт.зал. на рах.' || NLSA || ' НЕ = План.зал.','Увага !', MB_IconStop)
							Return FALSE
						Return TRUE
					!
					Call SalMessageBox('Рах.' || NLSA || '/'|| Str(KVA)|| '
							 НЕ знайдено (або Закрито)','Увага !', MB_IconStop)
					Set NLSA = STRING_Null
					Set NMS_NLSA = STRING_Null
					Set OST_NLSA = 0
					Return FALSE
					!
			Function: NASELENIE
				Description:
				Returns
					Boolean:
				Parameters
					! Number: nReg
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor(TRUE)
					Set SUM_0 = 0
					Set SUM_R = 0
					Set PRC_R = 0
					Set REF = NUMBER_Null
					! C общего счета
					If NLSA != STRING_Null and KVA != NUMBER_Null  and NMS_NLSA != STRING_Null 
						Call SalHideWindow( MAB.NLSAA )
						Call SalHideWindow( MAB.OSTAA )
						Call SalHideWindow( MAB.NAM_AA )
						Set sSql =
								"select :KVA, :NLSA, :NMS_NLSA, MF1.MFOB, b.nb, MF1.NLSB, MF1.NAM_B, MF1.OKPOB,
								        MF1.id, nvl(MF1.prc,0), nazn, nvl(MF1.delta,0),decode(MF1.MFOB, :aMfo, nvl(MF1.TT, 'PS1'), null), 
								        MF1.ORD, nvl(MF1.VOB,6) 
								 into :MAB.KVAA,:MAB.NLSAA, :MAB.NAM_AA, :MAB.MFOB,:MAB.NB,:MAB.NLSB,:MAB.NAM_B,:MAB.OKPOB,
								      :MAB.ID,:MAB.K,:MAB.NAZN1,:MAB.DELTA,:MAB.TT, :MAB.ORD, :MAB.VOB 
								 from banks b, MF1 
								 where MF1.MFOB = b.mfo and MF1.grp=" || Str(nPar) || " ORDER BY MF1.ORD, MF1.MFOB, MF1.NLSB "
					Else
						Call SalShowWindow( MAB.NLSAA )
						Call SalShowWindow( MAB.OSTAA )
						Call SalShowWindow( MAB.NAM_AA )
						Set sSql =
								"select MF1.KVA,  MF1.NLSA, aa.ostB/100, MF1.MFOB, b.nb, MF1.NLSB, MF1.NAM_B, 
								        MF1.OKPOB, MF1.id , nvl(MF1.prc,0), nazn, nvl(MF1.delta,0), 
								        decode( MF1.MFOB, :aMfo, nvl(MF1.TT, 'PS1'),null )  TT ,
								        ABS(aa.ostB)/100 S,  substr(aa.nms,1,38), MF1.ORD , nvl(MF1.VOB,6) 
								 into :MAB.KVAA, :MAB.NLSAA, :MAB.OSTAA, :MAB.MFOB, :MAB.NB, :MAB.NLSB, :MAB.NAM_B,
								      :MAB.OKPOB,:MAB.ID,    :MAB.K,     :MAB.NAZN1,:MAB.DELTA,
								      :MAB.TT  , :MAB.S,     :MAB.NAM_AA,:MAB.ORD,  :MAB.VOB   
								 from banks b, MF1, accounts aa 
								 where aa.kv = nvl( MF1.kva,"||Str(KVA)||") and aa.nls = MF1.nlsa 
								   and MF1.MFOB = b.mfo and MF1.grp  = " || Str(nPar) || " ORDER BY MF1.ORD, MF1.MFOB, MF1.NLSB "
					Call SalEnableWindow( pb_Run )
					Call SalDisableWindow( pbPrint )
					!
					Call SalTblPopulate(hWndForm, hSql(), MAB.sSql, TBL_FillAll)
					Call SalTblSortRows( hWndForm, 1, TBL_SortIncreasing )
					!
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Set SUM_R = 0
					! Set PRC_R = 0
					Set PRC_R = SalTblColumnSum( hWndForm, 10, 0, 0 )
					Set SUM_0 = 0
					Call SalWaitCursor(FALSE)
			Function: F_Opl
				Description:
				Returns
					Boolean:
				Parameters
					String: strTip
				Static Variables
				Local variables
					Number: nn
					Number: nS1
					Number: nRef
					Number: nRef1
					Number: nRef0
					Number: nS4
					Number: nS5
					Number: nITOG
					String: sNazn
					Number: nRow
					Number: DDKK
					String: sNlsB1
					String: sNmsB1
					String: sOkpoA
					String: sNmsa
					!
				Actions
					Call SalWaitCursor(TRUE)
					Set nDk = IifN( rb1, 1,0 )
					Set nVob = VOB 
					Set nRow = TBL_MinRow
					Set nn = 0
					If cb_DK = 1
						Set DDKK = 2
					Else
						Set DDKK = 0
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If S > 0 
							Set nS1 = S *100
							If cb_Nazn = 1
								Set sNazn =  Subs( IifS( NAZN1=STRING_Null,NAZN, NAZN1) || sPeriod,1,160 )
							Else
								Set sNazn =   Subs( IifS( NAZN1=STRING_Null,NAZN, NAZN1),1,160)  
							If aMfo = MFOB 
								Set sTT = TT
							Else If nDk = 1
								Set sTT ='PS2'
							Else
								Set sTT ='PS9'
							If NLSA != STRING_Null
								Set sOkpoA = aOkpo
								Set NAM_AA = NMS_NLSA
								Set NLSAA = NLSA
								Set KVAA = KVA
							Else
								If SqlPrepareAndExecute( hSql(), 
										"SELECT c.okpo, substr(a.nms,1,38) into :sOkpoA, :NAM_AA from accounts a, customer c 
										 where a.kv=:KVA and a.nls= :NLSAA and a.rnk=c.rnk " )  
										and SqlFetchNext(hSql(), nFetchRes)
							Set sNmsa = NAM_AA 
							If aMfo != MFOB 
								If SqlPrepareAndExecute( hSql(), 
										"SELECT  substr(c.nmk,1,38) into :sNmsa
										 from accounts a, customer c 
										 where a.kv=:KVA and a.nls= :NLSAA and a.rnk=c.rnk " )  
										and SqlFetchNext(hSql(), nFetchRes)
							Call cDoc.SetDoc( 0, sTT, nDk+DDKK, nVob, ND,
									     DATD, dDat, dDat, dDat,
									     NLSAA, Subs(sNmsa,1,38),  aMfo, '', KVAA, nS1, sOkpoA,
									     NLSB,  Subs(NAM_B,1,38),  MFOB, '', KVAA, nS1, OKPOB ,
									     sNazn, '', GetIdOper(), '', nSkp, 0 )
							If NOT cDoc.oDoc()
								Return FALSE
							!
							Set nRef = cDoc.m_nRef
							If nn = 0 
								Set nRef0 = nRef
								! Set sTT ='PS+'
							Set nn = nn + 1 
							If nRef1 != NUMBER_Null
								! If SqlPrepareAndExecute( hSql(), "UPDATE oper set REFL = :nRef where ref = :nRef1 " )
							Set nRef1 = nRef
							Set REFD = nRef
						Else
							If cb_00  = 1
								Call SalTblDeleteRow( hWndForm, nRow, TBL_NoAdjust )
								Set nRow = nRow -1 
								! Call SalTblSetRowFlags( hWndForm, nRow , ROW_MarkDeleted,  TRUE )
					If SqlPrepareAndExecute( hSql(),
							"UPDATE ope_lot set
							 nazn1 = substr(:NAZN,1,160), 
							 datp = :DAT2,
							 nls = :NLSA , kv= :KVA where grp = :nPar  " )
						Call SqlCommitEx(  hSql(), strTip || '. Реф='|| Str(nRef))
					Set REF = nRef 
					!
					Call SalDisableWindow( pb_Run )
					Call SalEnableWindow( pbPrint )
					!
					! Call SalTblDefineSplitWindow (hWndForm, 5, TRUE)
					! Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)  
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If REFD = NUMBER_Null
							Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
					! Пусто
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					! Всього
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set MFOB = ''
					Set S = SUM_R
					Set NB = 'Всього'
					! Пусто
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set S = NUMBER_Null
					! Начальник РУ
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set MFOB = 'Начальник РУ'
					Set NB = GetGlobalOption('BOSS')
					! Пусто
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					! Головний бухгалтер
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set MFOB = 'Головний бухгалтер'
					Set NB = GetGlobalOption('ACCMAN')
					! Пусто
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					!
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set MFOB = 'Виконавець'
					Set NB = GetUserRealName()
					Call SalWaitCursor(FALSE)
					!
					Return TRUE
			Function: F_Razbit
				Description:
				Returns
					Boolean:
				Parameters
					String: strTip
				Static Variables
				Local variables
					Number: nn
					Number: nS1
					Number: nS4
					Number: nS5
					Number: nITOG
					!
				Actions
					If SalMessageBox('Ви дiйсно бажаєте 
							' || strTip  || ' ? ',
							'У в а г а ! ', MB_IconQuestion | MB_YesNo) = IDYES
						Set nRow = TBL_MinRow
						Set SUM_R = 0
						While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
							Call SalTblSetContext( hWndForm, nRow )
							Set S = SalNumberRound( SUM_0 * K ) /100 + DELTA
							Set SUM_R = SUM_R + S
						!
					Return TRUE
			Function: F_STR
				Description:
				Returns
				Parameters
					Number: nR
				Static Variables
				Local variables
				Actions
					If NLSB != STRING_Null
						If nR = 1 
							! редакт суммы
							If SUM_0 >0 
								Set K = S * 100 / SUM_0
						Else If nR = 0
							Set S = SalNumberRound( K * SUM_0 ) / 100
					Else
						Set K = 0
						Set S = 0
					!
					Set PRC_R = SalTblColumnSum( hWndForm, 10, 0, 0 )
					Set SUM_R = SalTblColumnSum( hWndForm, 12, 0, 0 )
			Function: F_KONTROL
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sErr
					String: s1
					String: sSql
				Actions
					Set sErr = ''
					Set s1 =
							'
							'
					If MFOB != STRING_Null and  NLSB != STRING_Null and KeyAccount (MFOB,NLSB ) != NLSB
						Set sErr = sErr || 'в контр.розряді Рах.Б ! ' || s1
					!
					If sErr = '' and MFOB  = aMfo and NLSB != STRING_Null 
						Set sSql = 
								"select substr(a.nms,1,38), c.okpo  into :NAM_B, :OKPOB from accounts a, customer c where a.kv = nvl(:KVAA, 980)  and a.nls = :NLSB and a.rnk =c.rnk " 
						If SqlPrepareAndExecute( hSql(),sSql )  and SqlFetchNext( hSql(), nFetchRes)
							Return TRUE 
					!
					If NAM_B != STRING_Null and SalStrLength( NAM_B ) <3 
						Set sErr = sErr || 'в довжині назви-Б ! ' || s1
					If OKPOB != STRING_Null AND V_Okpo(OKPOB) != OKPOB 
						Set sErr = sErr || 'в контр.розряді Iд.код-Б ! ' || s1
					!
					If SalStrLength( sErr ) >2 
						Call SalMessageBox( sErr , 'Увага, можлива Помилка !', MB_IconStop)
			!
		Window Parameters
			Number: nMode
			Number: nPar  ! GRP
			String: p_NLS
			String: strPar02
		Window Variables
			String: sUvaga
			String: sFile
			! Number: nReg
			String: sTT
			Date/Time: dDat
			Number: n980
			Number: nSkp
			! Number: nAlg
			String: aMfo
			String: aOkpo
			Number: nS
			Number: nKoef
			String: sNLSB
			String: sNMSB
			String: sSql
			String: sTitl
			Number: nTmpE
			Number: nAlg
			String: sPeriod
			Number: nVob
			Number: nRef
			Number: nAcc
			Number: nDk
			!
			!
			String: NBSB
			String: OB22B
			!
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				Set dDat = GetBankDate()
				Set n980 = GetBaseVal()
				Set aMfo = GetBankMfo()
				Set aOkpo= GetBankOkpoS()
				Set cb_Nazn = 0
				Set cb_00 = 0
				Call SalTblSetLockedColumns( hWndForm,9 )
				Set MAB.nTabInstance = 1
				Set MAB.strPrintFileName = 'MAB_' ||Str(nPar)
				Set MAB.strSqlDelete = 
						"delete from MF1 where id= :MAB.ID and GRP= "||Str(nPar)
				!
				Set MAB.strSqlInsert =
						"insert into MF1 (MFOB,NLSB,NAM_B,OKPOB,PRC,GRP,NAZN, delta, kva, nlsa, ORD, TT, VOB ) values
						(:MAB.MFOB,:MAB.NLSB,:MAB.NAM_B,:MAB.OKPOB,:MAB.K," || Str(nPar) ||
						 ", :MAB.NAZN1, :MAB.DELTA, :MAB.KVAA, :MAB.NLSAA , :MAB.ORD, :MAB.TT, :MAB.VOB  )"
				Set MAB.strSqlUpdate =
						"update MF1 set
						 MFOB= :MAB.MFOB, NLSB= :MAB.NLSB , NAM_B= :MAB.NAM_B, OKPOB= :MAB.OKPOB,
						 PRC = :MAB.K,    NAZN= :MAB.NAZN1, delta= :MAB.DELTA, VOB  = :MAB.VOB  ,
						 KVA = :MAB.KVAA, NLSA= :MAB.NLSAA, ORD  = :MAB.ORD  , TT   = :MAB.TT 
						where id= :MAB.ID and GRP= "||Str(nPar)
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On SAM_CreateComplete
				Set DATD = dDat 
				If SqlPrepareAndExecute(hSql(),
						 "SELECT  name,  NLS, nvl(KV,:n980),  nazn1, dk, add_months(DATP,1), DATP+ 1, ALG , SKP 
						  INTO :sTitl, :NLSA, :KVA, :NAZN,:nDk, :DAT2, :DAT1 , :nAlg, :nSkp 
						  FROM ope_lot  where grp  = :nPar ")
						and SqlFetchNext(hSql(), nFetchRes)
				Call SalSetWindowText( hWndForm,
						 "Виконання М/Б проводок згiдно макету " || sTitl )
				If DAT1 = DATETIME_Null
					If SqlPrepareAndExecute(hSql(),
							  "SELECT trunc(gl.BD,'MM') - 1 , trunc( trunc(gl.BD,'MM') -1, 'MM' ) 
							   INTO  :DAT2, :DAT1 FROM dual ")
							and SqlFetchNext(hSql(), nFetchRes)
				Set rb1 = TRUE
				Set rb0 = FALSE
				! Call SalDisableWindow( rb0 )
				If nDk = 1
					Call SalDisableWindow( rb0 )
				Else If nDk = 0
					Set rb0 = TRUE
					Set rb1 = FALSE
					Call SalDisableWindow( rb1 )
				!
				Set SUM_0 = 0
				! Set nReg = 0
				Set cb_DK = 0
				If NAZN = STRING_Null
					Set NAZN = sTitl
				Call F_NLSA (NLSA)
				Call NASELENIE ()
			On SAM_FetchRowDone
				Set sNLSB = NLSB
				If KVAA  = NUMBER_Null
					Set KVAA  = KVA
				If NLSAA = STRING_Null
					Set NLSAA = NLSA
				If S > 0 
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen )
			On UM_Populate
				Call NASELENIE ()
			! On SAM_ColumnSelectClick
	Table Window: MAK
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Виконання макету (тільки Вн) по вирахованим рах-Б по БР+Об22 
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  21.5"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1500
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.536"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Деб
					Window Location and Size
						Left:   0.883"
						Top:    0.155"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Marigold
					Background Color: Default
					Message Actions
				Radio Button: rb0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Крд
					Window Location and Size
						Left:   1.983"
						Top:    0.155"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Message Actions
				Data Field: SUM_0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.883"
							Top:    0.155"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Загальна Сума для розподілу' )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Очистити таблицю'
						On SAM_Click
							Set nReg = 0
							Call NASELENIE ()
				Pushbutton: pb_Razbit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_PROC.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Перерозбити суми проводок згідно % долі'
						On SAM_Click
							If PRC_R = 100 and SUM_0 > 0
								Call F_Razbit(strTip)
							Else
								If PRC_R != 100
									Call SalMessageBox('Загальний % НЕ = 100 '  ,'Увага!', MB_IconStop)
								If SUM_0 <=0 
									Call SalMessageBox(' Не указана Загальна Сума для розподілу '  ,'Увага!', MB_IconStop)
				Pushbutton: pb_InsF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 
									'Прийняти суми з XML (МАSTER CARD, VISA, ... )' 
						On SAM_Click
							Call Ins_File(strTip,nPar, '.xml' )
				! ctb_pbExecute: pb_Dbf
.winattr class Pushbutton:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.155"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\TOCENTER.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Light Periwinkle
.end
					                                                          Message Actions 
						                                                          On SAM_Create
							                                                          Set strTip = 
									'Прийняти суми з "Внутрішньої бухгалтерії"' 
						                                                          On SAM_Click
							                                                          Call GeneralImport(hWndForm, 1,110, "","" )
							! If File(sNadraFDir || '\\MFOOUT.DBF')
									
									            >> If ImportDbf(sNadraFDir,
									
									                                                'MFOOUT.DBF',
									
									                                                'S6_NF_MFOOUT',
									
									                                                sKodirowka,
									
									                                                1,
									
									                                                1,
									
									                                                0,
									
									                                                sErrMsg)
									
									                        Set nA = nA + 1
									
									                        Call VisFileSetAttribute(sNadraFArcDir || '\\MFOOUT.dbf', FA_Standard, TRUE)
									
									                        Call VisFileDelete(sNadraFArcDir || '\\MFOOUT.dbf')
									
									                        Call VisFileRename(sNadraFDir || '\\MFOOUT.dbf', sNadraFArcDir || '\\MFOOUT.dbf')
									
									                        >>> If SqlPrepareAndExecute(hSql(), "
									
									                                                  SELECT to_char(mfo)
									
									                                                  INTO   :dfFILIAL
									
									                                                  FROM   S6_NF_MFOOUT
									
									                                                  WHERE  rownum<2") and SqlFetchNext(hSql(), nFetchRes)
									
									                        >>> Else
									
									                                   Set dfFILIAL = STRING_Null
									
									            >> Else
									
									                        Call SaveErrorToLog(tbl1.colErrMask || '(1): Load error MFOOUT.DBF - ' || sErrMsg)
									
									                        Set nE = nE + 1
									
									> Else
									
									            >>>> If not File(sNadraFArcDir || '\\MFOOUT.dbf')
									
									                        Call SaveErrorToLog(tbl1.colErrMask || '(2): Load error MFOOUT.dbf - no file')
									
									                        Set nE = nE + 1
									
				Pushbutton: pb_Formula
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати розрахунок сум по відповідному алгоритму'
						On SAM_Click
							Call F_Formula()
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати проводки згідно макету "' || sTitl ||'"'
						On SAM_Click
							If REF > 0
								Set sUvaga = 'УВАГА ! ПОВТОРНА опл. макету без поновлення інформації !'
							Else
								Set sUvaga = 'Підтвердіть  ! '
							If nMode != 30
								Set sPeriod =' за період з ' ||
										SalFmtFormatDateTime( DAT1, 'dd.MM.yyyy' ) || ' по ' ||
										SalFmtFormatDateTime( DAT2, 'dd.MM.yyyy' )
							If SUM_0 = SUM_R
								If SalMessageBox('Ви дiйсно бажаєте
										' || strTip  || '
										' || sPeriod || ' ? ',
										sUvaga , MB_IconQuestion | MB_YesNo) = IDYES
									If nMode =30
										If Not F_Opl38(strTip)
											Call SqlRollback( hSql() )
									Else
										If Not F_Opl(strTip)
											Call SqlRollback( hSql() )
							Else
								Call SalMessageBox('Загальна Сума для розподілу ' || Str( SUM_0)  || ' 
										НЕ дорівнює 
										Набрано суму '|| Str( SUM_R) ,'Увага, можлива помилка !', MB_IconStop)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.183"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Data Field: REF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   9.183"
							Top:    0.155"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On VTM_LeftDoubleClick
							If REF > 0
								Call DocViewContentsEx(hWndForm, REF )
						On SAM_SetFocus
							Set nTmpE = REF
						On SAM_AnyEdit
							Set REF = nTmpE
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Референс сформованого документу ' )
				Data Field: PRC_R
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.883"
							Top:    0.155"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Набрано %' )
				Data Field: SUM_R
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.583"
							Top:    0.155"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Набрано суму' )
				Data Field: dKol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   13.583"
							Top:    0.155"
							Width:  0.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кількість бранчів' )
				!
				Data Field: dKVA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 3
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.488"
							Width:  0.633"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код вал-А ' )
						On SAM_Create
							If nMode = 30
								Set dKVA = 840
						On SAM_Validate
							If nMode = 30
								Call F_NLSA (NLSA)
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: dOB22
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 2
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.821"
							Width:  0.633"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код аналітики (Об22)' )
						On SAM_Create
							Set dOB22 = '10'
						On SAM_Validate
							If nMode = 30
								Call F_NLSA (NLSA)
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: dKVB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 3
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    1.155"
							Width:  0.633"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код вал-Б ' )
						On SAM_Validate
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: NLSA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.883"
							Top:    0.488"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок-А' )
						On SAM_KillFocus
							Call F_NLSA (NLSA)
				Data Field: OST_NLSA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.883"
							Top:    0.488"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Факт.Зал.на рахунку-А ' )
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.983"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути історію вибранного рахунку-A'
						On SAM_Click
							Call Show_Sal_Day_P(nAcc, NLSA,nKva , dDat -10, dDat )
				Data Field: NMS_NLSA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.483"
							Top:    0.488"
							Width:  9.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва рахунку-А' )
				!
				Data Field: NAZN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 160
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.883"
							Top:    0.821"
							Width:  11.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Призначення пл.' )
				!
				Data Field: ND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 10
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.883"
							Top:    1.155"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ документу (розпорядження)' )
				Data Field: DATD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.883"
							Top:    1.155"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата документу (розпорядження)' )
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.983"
							Top:    1.155"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата "З" ' )
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.983"
							Top:    1.155"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата "По" ' )
				Check Box: cb_Nazn
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: +  Дати в призн.пл.
					Window Location and Size
						Left:   9.083"
						Top:    1.155"
						Width:  2.933"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.783"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 41824
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.45"
						Top:    0.655"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 41825
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 41826
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Check Box: cb_Zo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Корр.об.
					Window Location and Size
						Left:   8.05"
						Top:    0.179"
						Width:  1.133"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set cb_Zo = 0
						On SAM_Click
							If cb_Zo = 1 and 
									SalMessageBox("Увага ! 
									Ви дійсно бажаєте виконати цей макет корригуючими оборотами ? " ,
									"Потрібне Ваше підтвердження !", MB_IconQuestion | MB_YesNo) = IDYES
							Else
								Set cb_Zo = 0
				Data Field: dKurs
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.883"
							Top:    0.821"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал-Б
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.617"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_STR (0)
					On SAM_KillFocus
						Call F_STR (0)
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Бранчу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SBRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						Бранчу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.05"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах.Б
						Бранчу-2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLSB
					On SAM_AnyEdit
						Set NLSB  = sTmpE
			Column: K
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: % від
						заг.суми
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.633"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_STR (0)
					On SAM_KillFocus
						Call F_STR (0)
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						проводки
						в вал-А
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.0"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_STR (1)
					On SAM_KillFocus
						Call F_STR (1)
			Column: S11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						проводки
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.0"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_STR (1)
					On SAM_KillFocus
						Call F_STR (1)
			Column: Q
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						проводки
						в вал Б
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.0"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: К-сть
						рах-Б
						(вибрати тут)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.757"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If KOL > 1 and nMode != 30 
							Call F_NLSB( NBSB, OB22B, BRANCH, KV )
			!
		Functions
			Function: F_NLSA
				Description:
				Returns
				Parameters
					String: sNls
				Static Variables
				Local variables
					Number: nOstB
				Actions
					If nMode = 30 
						If dOB22 != STRING_Null and dKVA != NUMBER_Null
							If SqlPrepareAndExecute(hSql(),
									 "SELECT NLS,gl.p_icurval(Kv,10000000,:dDat)/10000000  INTO :NLSA, :dKurs 
									  FROM accounts 
									  where kv = :dKVA and nls = substr(nbs_ob22('3800', :dOB22),1,14)
									    and branch = :mBRANCH ")
									and SqlFetchNext(hSql(), nFetchRes)
					Else
						If NLSA = STRING_Null
							Return FALSE
						If dKVA = NUMBER_Null 
							Set dKVA = n980
					Set nKva = dKVA
					!
					If SqlPrepareAndExecute(hSql(),
							 "SELECT substr(nms,1,38), ostc/100 , acc, ostB/100
							  into :NMS_NLSA, :OST_NLSA , :nAcc , :nOstB
							  from accounts where kv=:nKva and nls= :NLSA and dazs is null ")
							  and SqlFetchNext(hSql(), nFetchRes)
						If OST_NLSA != nOstB
							Call SalMessageBox('Факт.зал. на рах.' || NLSA || '/' || Str(nKva) || ' НЕ = План.зал.','Увага !', MB_IconStop)
							Return FALSE
						Return TRUE
					!
					Call SalMessageBox('Рах.' || NLSA ||  '/' || Str(nKva) || ' НЕ знайдено (або Закрито)','Увага !', MB_IconStop)
					Set NLSA = STRING_Null
					Set NMS_NLSA = STRING_Null
					Set OST_NLSA = 0
					Return FALSE
					!
			Function: F_NLSB
				Description:
				Returns
				Parameters
					String: sNbs
					String: sOb22
					String: sBranch
					Number: nKv
				Static Variables
				Local variables
					String: sTmp
					String: sTmp1
					String: sFilter
					String: strB
					String: Branch2
					Number: nRow
				Actions
					Set Branch2 = Subs( sBranch,1,15) 
					Set strB = " ACCOUNTS.branch='" || sBranch || "' "
					! nMode = 21 Виконання заданного макету проводок (для Бранч-3)
					If nMode = 21 
						Set strB = " substr(ACCOUNTS.branch,1,15)='" || Branch2 || "' "
					Set sTmp = STRING_Null
					Set sFilter = 
							"ACCOUNTS.dazs is null and  ACCOUNTS.kv=" || Str(nKv) || " and 
							 ACCOUNTS.nbs='"|| sNbs ||"' and ACCOUNTS.ob22='"|| sOb22 || "' and " || strB 
					! Call Debug(sFilter)
					Call FunNSIGetFiltered ("ACCOUNTS ","NLS", sFilter ,sTmp, sTmp1)
					If sTmp != STRING_Null
						Set MAK.NLSB = sTmp1
						Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(  hWndForm  ), ROW_Edited ,  TRUE )
						! nMode = 21 Виконання заданного макету проводок (для Бранч-3)
						! Подгорная Лариса [mailto:PODGORNAYALL@oschadnybank.com] тел. (062) 381-56-30
								Для "Динамичного макета - 3"
								Надо: при исправлении счета-Б на одном из бранч-3,
								      что бы поменялся бы счет для всех строк с бранчам-3 этого же бранчу-2.
								Например: поменяли счет для /302076/000175/000174/ - поменять для всех /302076/000175/%/
						If nMode = 21 
							Call SalWaitCursor(TRUE)
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
								Call SalTblSetContext( hWndForm, nRow )
								If Subs(MAK.BRANCH,1,15)  = Branch2
									Set MAK.NLSB = sTmp1
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(  hWndForm  ), ROW_Edited ,  TRUE )
							Call SalWaitCursor(FALSE)
					!
			Function: NASELENIE
				Description:
				Returns
					Boolean:
				Parameters
					! Number: nReg
				Static Variables
				Local variables
					String: strB
					String: strK
				Actions
					Call SalWaitCursor(TRUE)
					Set SUM_0 = 0
					Set SUM_R = 0
					Set PRC_R = 0
					Set REF = NUMBER_Null
					Call SalEnableWindow( pb_Run )
					Call SalDisableWindow( pbPrint )
					If dKVA = NUMBER_Null
						Set dKVA = IifN( nMode = 30, 840, n980)
					If dKVB = NUMBER_Null
						Set dKVB = dKVA
					Set nKva = dKVA
					Set nKvb = dKVB 
					!
					! nMode = 30 Гуртова  передача вал поз
					If nMode = 30
						Set sSql =
								"select b.BRANCH, b.name, a.nls, a.kv
								 into :MAK.BRANCH, :MAK.SBRANCH, :MAK.NLSB, :MAK.KV
								 from branch b, V_GL a
								 where b.DATE_CLOSED is null  and LENGTH (b.branch) = 15
								   and b.branch not like :mBRANCH  
								   and substr(nbs_ob22_null('3800', :dOB22, b.branch),1,14) = a.nls 
								   and a.kv=" || Str(dKVA) ||
								" ORDER BY b.BRANCH desc "
					! nMode = 20 Виконання заданного макету проводок (для Бранч-2)
					! nMode = 21 Виконання заданного макету проводок (для Бранч-3)
					Else
						If nKva = nKvb 
							Set dKurs = 1
							Call SalHideWindow( dKurs )
						Else
							If SqlPrepareAndExecute(hSql(),
									 "SELECT gl.p_icurval(:nKva,10000000,:dDat)/ gl.p_icurval(:nKvb,10000000,:dDat)
									  into :dKurs from dual ") 
									and SqlFetchNext(hSql(), nFetchRes)
							Call SalShowWindow( dKurs )
						If nReg = 0 
							Set strB = "branch=b.branch"
							! nMode = 21 Виконання заданного макету проводок (для Бранч-3)
							If nMode = 21 
								Set strB = "substr(branch,1,15)=substr(b.branch,1,15)"
							Set strK = 
									"(select count(*) from accounts" || 
									" where dazs is null and nbs= :NBSB and ob22= :OB22B and "||strB||" and kv="||Str(nKvb)||") kol " 
							Set sSql =
									"select b.BRANCH, b.name, a.nls, a.kv," || strK || "  
									 into :MAK.BRANCH, :MAK.SBRANCH, :MAK.NLSB, :MAK.KV, :MAK.KOL 
									 from branch" || Str(nMak) || " b, V_GL a
									 where b.DATE_CLOSED is null and substr(nbs_ob22_null(:NBSB,:OB22B,b.branch),1,14)= a.nls and a.kv=" 
									|| Str(nKvb) || " ORDER BY b.BRANCH desc "
						Else If nReg = 1 
							Set sSql =
									"select b.BRANCH,b.name,a.nls,a.kv,sum(t.n1)/100
									 into :MAK.BRANCH, :MAK.SBRANCH, :MAK.NLSB, :MAK.KV, :MAK.S
									 from branch" || Str(nMak) || " b, V_GL a,
									  (select substr(branch,1," || Str(1+7*nMak) || ") BRANCH, N1 from CCK_AN_TMP) t
									 where substr(nbs_ob22_null(:NBSB,:OB22B,b.branch),1,14)=a.nls and a.kv="||Str(nKvb) ||
									" and b.DATE_CLOSED is null and b.BRANCH= t.BRANCH (+) 
									group by b.BRANCH,b.name,a.nls,a.kv 
									ORDER BY b.BRANCH desc"
					Set dKol= 0
					Call SalTblPopulate(hWndForm, hSql(), MAK.sSql, TBL_FillAll)
					Call SalTblSortRows( hWndForm, 1, TBL_SortIncreasing )
					!
					If sNLSB != STRING_Null
							and SqlPrepareAndExecute(hSql(),
							 "SELECT Substr(nms,1,38) into :sNMSB from accounts where kv=:nKva and nls=:sNLSB ")
							and SqlFetchNext(hSql(), nFetchRes)
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Set SUM_R = 0
					Set PRC_R = 0
					Set SUM_0 = 0
					Call SalWaitCursor(FALSE)
			Function: F_Formula
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nS1
					Number: nRow
					!
				Actions
					Call SalWaitCursor(TRUE)
					If SqlPLSQLCommand( hSql(), "MAKET( nAlg, DAT1, DAT2 )" )
						Call F_Rest()
					!
					Call SalWaitCursor(FALSE)
					Return TRUE
			Function: F_Opl38
				Description:
				Returns
				Parameters
					String: strTip
				Static Variables
				Local variables
					String: sErr
					String: Nlsa
					String: Nmsa
					String: Nlsb
					String: Nmsb
					!
					Number: nS1
					Number: nQ1
					Number: nDk
					String: Nls_3800
					Number: nRef
					Number: nRow
				Actions
					Set sErr = '3739/06'
					If SqlPrepareAndExecute( hSql(),
							"select a.nls, Substr(a.nms,1,38), b.nls, Substr(b.nms,1,38) 
							into :Nlsa, :Nmsa, :Nlsb, :Nmsb 
							from accounts a,  accounts b 
							where a.kv = :dKVA and a.nbs = '3739' and a.ob22 = '06'  
							  and b.kv = :n980 and b.nbs = '3739' and b.ob22 = '06'  
							  and a.branch = :mBRANCH and a.branch = b.branch 
							  and a.dazs is null and b.dazs is null 
							 ORDER by a.branch " )
							and NOT SqlFetchNext( hSql(), nFetchRes ) 
						Call SalMessageBox('Не відкрито рахунки '||sErr || ' 
								для бранчу '|| mBRANCH , 'Помилка !', MB_IconStop)
						Return FALSE
					Set nS1 = SUM_0 *100
					Set nQ1 = nS1 * dKurs
					If rb0
						Set nDk = 1
					Else
						Set nDk = 0
					!
					Set Nls_3800 = NLSA
					If NOT SqlPLSQLCommand(hSql(), "PUL.Set_Mas_Ini( 'VP', Nls_3800, 'Вал.Поз.' )")
						Return FALSE
					If NAZN =STRING_Null
						Set NAZN = sTitl
					Call cDoc.SetDoc( 0, '38V', nDk, 16, STRING_Null,
							     dDat, dDat, dDat, dDat,
							     Nlsa, Nmsa, aMfo,'', dKVA, nS1, aOkpo,
							     Nlsb, Nmsb, aMfo,'', n980, nQ1, aOkpo,
							     NAZN, '', GetIdOper(), '', NUMBER_Null, 0 )
					If NOT cDoc.oDoc()
						Return FALSE
					Set nRef = cDoc.m_nRef
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If S  > 0
							Set Q = S * dKurs
							Set nS1 = S *100
							Set nQ1 = nS1 * dKurs
							Set Nls_3800 = NLSB
							If NOT SqlPLSQLCommand(hSql(), "PUL.Set_Mas_Ini( 'VP', Nls_3800, 'Вал.Поз.' )")
								Return FALSE
							If NOT cDoc.PayV (0,nRef,dDat,'38V',1-nDk,dKVA, Nlsa,nS1,n980,Nlsb, nQ1 ) 
								Return FALSE
					If SqlCommitEx( hSql(), strTip )
						Call SalDisableWindow( pb_Run )
						Set REF  = nRef
						Return TRUE
					Return FALSE
					!
			Function: F_Opl
				Description:
				Returns
					Boolean:
				Parameters
					String: strTip
				Static Variables
				Local variables
					Number: nn
					Number: nS1
					Number: nQ1
					Number: nRef
					Number: nS4
					Number: nS5
					Number: nITOG
					String: sNazn
					Number: nRow
					Number: nVobV
					Date/Time: dDatV
					! String: sNazn2
					String: sNlsB1
					String: sNmsB1
					!
				Actions
					Call SalWaitCursor(TRUE)
					If rb1
						Set nDk = 1
						Set sTT ='SMO'
						Set nVob = -6
					Else
						Set nDk = 0
						Set sTT ='ZMO'
						Set nVob = -7
					Set nRow = TBL_MinRow
					Set nn = 0
					!
					If cb_Nazn = 1
						Set sNazn =  Subs( NAZN || sPeriod,1,160 )
					Else
						Set sNazn =    Subs( NAZN,1,160 )
					!
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If S  > 0
							Set Q = S * dKurs
							If nn = 0
								Set nS1 = SUM_0 *100
								Set nQ1 = nS1 * dKurs
								If cb_Zo = 0
									Set nVobV = nVob
									Set dDatV = dDat
								Else
									Set nVobV = 96
									Set dDatV = Dat31
								Call cDoc.SetDoc( 0, sTT, nDk, nVobV , ND,
										     DATD, dDat, dDatV, dDatV,
										     NLSA, NMS_NLSA, aMfo,'', nKva , nS1, aOkpo,
										     NBSB||'/'||OB22B, 'Різні', aMfo,'', KV, nQ1, aOkpo,
										     sNazn, '', GetIdOper(), '', NUMBER_Null, 0 )
								! Call cDoc.SetDoc( 0, sTT, nDk, IifN(cb_Zo = 0,nVob,96), ND,
										     DATD, dDat, dDat, dDat,
										     NLSA, NMS_NLSA, aMfo,'', nKva , nS1, aOkpo,
										     NBSB||'/'||OB22B, 'Різні', aMfo,'', KV, nQ1, aOkpo,
										     sNazn, '', GetIdOper(), '', NUMBER_Null, 0 )
								If NOT cDoc.oDoc()
									Return FALSE
								Set nRef = cDoc.m_nRef
							Set nS1 = S *100
							Set nQ1 = nS1 * dKurs
							If NOT cDoc.PayV (0,nRef,dDatV,sTT,nDk,nKva, NLSA,nS1,KV,NLSB, nQ1 ) 
									OR NOT SqlPrepareAndExecute( hSql(),
									"begin 
									   update opldok set txt='"|| BRANCH || "' where ref=gl.aRef and stmt=gl.aStmt;
									 end;" )
								Return FALSE
							Set nn = nn +1
					If SqlPrepareAndExecute( hSql(),
							"UPDATE ope_lot set
							 nazn1 = substr(:NAZN,1,160),
							 datp = :DAT2,
							 nls = :NLSA where id = :nPar  " )
					Call SqlCommitEx(  hSql(), strTip || '. Реф='|| Str(nRef))
					Set REF= nRef
					!
					Call SalDisableWindow( pb_Run )
					Call SalEnableWindow( pbPrint )
					!
					! Call SalTblDefineSplitWindow (hWndForm, 5, TRUE)
					! Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)  
					!
					! Пусто
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					! Всього
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set BRANCH = ''
					Set S = SUM_R
					Set Q = S * dKurs
					Set SBRANCH = 'Всього'
					! Пусто
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set S = NUMBER_Null
					! Начальник РУ
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set BRANCH = 'Начальник РУ'
					Set SBRANCH = GetGlobalOption('BOSS')
					! Пусто
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					! Головний бухгалтер
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set BRANCH = 'Головний бухгалтер'
					Set SBRANCH = GetGlobalOption('ACCMAN')
					! Пусто
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					!
					Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set BRANCH = 'Виконавець'
					Set SBRANCH = GetUserRealName()
					Call SalWaitCursor(FALSE)
					!
					Return TRUE
			Function: F_Razbit
				Description:
				Returns
					Boolean:
				Parameters
					String: strTip
				Static Variables
				Local variables
					Number: nn
					Number: nS1
					Number: nS4
					Number: nS5
					Number: nITOG
					!
				Actions
					If SalMessageBox('Ви дiйсно бажаєте 
							' || strTip  || ' ? ',
							'У в а г а ! ', MB_IconQuestion | MB_YesNo) = IDYES
						Set nRow = TBL_MinRow
						Set SUM_R = 0
						While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
							Call SalTblSetContext( hWndForm, nRow )
							Set S = SalNumberRound( SUM_0 * K ) /100
							Set SUM_R = SUM_R + S
						!
					Return TRUE
			Function: F_STR
				Description:
				Returns
				Parameters
					Number: nR
				Static Variables
				Local variables
				Actions
					If NLSB != STRING_Null
						If nR = 1 
							! редакт суммы
							If SUM_0 >0 
								Set K = S * 100 / SUM_0
						Else If nR = 0
							Set S = SalNumberRound( K * SUM_0 ) / 100
					Else
						Set K = 0
						Set S = 0
					!
					Set PRC_R = SalTblColumnSum( hWndForm, 5, 0, 0 )
					Set SUM_R = SalTblColumnSum( hWndForm, 6, 0, 0 )
			!
			Function: Ins_File
				Description: Принять 1 файл  по выбору
				Returns
					Boolean:
				Parameters
					String: strTip
					Number: nNd
					String: sSPECIFIC
					!
				Static Variables
				Local variables
					String: sSqlI
					String: strFilters[*]
					String: strFileName
					String: strFilePath
					Number: nIndex
					Number: nSize
					!
					File Handle: inFile
					Long String: sTiket
					String: sFileM[*]
					Number: nNumFiles
					Number: nTmp
					! Number: nRet
					String: sTxt
				Actions
					Set strFilters[0] = strTip
					! Set strFilters[1] = '*.xml'
					Set strFilters[1] = '*'||SalStrRightX( SalStrTrimX( sSPECIFIC ) , 5 )
					Set nIndex = 1
					! Set nRet = -1
					If not SalDlgOpenFile ( hWndForm, 'Вибір електронного документу', strFilters, 2, nIndex, strFileName, sSPECIFIC )
						Return FALSE
					! Наташа 
					Set sTxt = 'Выполнен импорт+обработка макета файла ' || strFileName
					If PutFileToTmpLob( hSql(), strFileName, 'C') 
						! Call SqlCommit(  hSql() )
						If SqlPrepareAndExecute( hSql(), " delete from CCK_AN_TMP  " )
							If nAlg = 26 or nAlg = 27 
								Set sSqlI = 
										"insert into CCK_AN_TMP (branch,n1) 
										 select BR3_DECODED,  FEE_AMT_A * 100
										 from table(f_get_maket_records) 
										 where BR3_DECODED is not null 
										   and CPS = decode ( :nAlg, 27,'V', 26,'M', '*' )  " 
								If SqlPrepareAndExecute( hSql(),  sSqlI )
									If SqlCommitEx(  hSql(), sTxt )
										Call MessageNoWait( sTxt , 'Информация', 5, 0)
										Call F_Rest()
										Return TRUE
					! !!!
					Call MessageNoWait('HE ' || sTxt, 'Информация', 5, 1)
					Return FALSE
			Function: F_Rest
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nS1
					Number: nRow
				Actions
					Set nReg = 1
					Call NASELENIE()
					!
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						Call F_STR (1)
		Window Parameters
			! nMode = 20 Виконання заданного макету проводок (для Бранч-2)
			! nMode = 21 Виконання заданного макету проводок (для Бранч-3)
			! nMode = 30 Гуртова  передача вал поз
			Number: nMode 
			!
			! nPar = id, или nPar = NUMBER_Null для дин.макета
			Number: nPar
			!
			! MA0.NBS || MA0.OB22,
			String: strPar01
			!
			! SalStrTrimX( MA0.NLS)
			String: strPar02
			! If nMode = 29
				! Call Sel002( hWndMDI, 20 + nPar , NUMBER_Null, MA0.NBS || MA0.OB22, SalStrTrimX( MA0.NLS ) ) 
			! Else If GRP = NUMBER_Null 
				! Call Sel002( hWndMDI, 20 + nPar , MA0.ID,      MA0.NBS || MA0.OB22, SalStrTrimX( MA0.NLS ) ) 
		Window Variables
			String: sUvaga
			String: sTmpE
			String: sFile
			Number: nReg
			String: sTT
			Date/Time: dDat
			Date/Time: Dat31
			Number: n980
			Number: nAlg
			String: aMfo
			String: aOkpo
			Number: nS
			Number: nKoef
			String: sNLSB
			String: sNMSB
			String: mBRANCH
			String: sSql
			String: sTitl
			Number: nTmpE
			String: sPeriod
			Number: nVob
			Number: nRef
			Number: nAcc
			Number: nDk
			!
			Number: nMak
			String: sBrn1
			!
			String: NBSB
			String: OB22B
			Number: nKva
			Number: nKvb
			!
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				Set sTT ='ZMO'
				Set nVob = -7
				Set dDat = GetBankDate()
				Set DATD = dDat 
				Set n980 = GetBaseVal()
				Set aMfo = GetBankMfo()
				Set aOkpo= GetBankOkpoS()
				Set mBRANCH = '/' || aMfo || '/000000/'
				Set cb_Nazn = 0
				Call SalTblSetLockedColumns( hWndForm, 2 )
				Set MAK.strPrintFileName = 'MAK_' ||Str(-nPar)
				Set rb1 = TRUE
				Set rb0 = FALSE
				Set SUM_0 = 0
				Set nReg = 0
				! Set Dat01 = dDat - SalDateDay( dDat ) + 1
				If SqlPrepareAndExecute( hSql(),
						 "SELECT  Dat_last( trunc(gl.bd,'MM') - 4 , trunc(gl.bd,'MM') -1 ) INTO :Dat31  FROM dual" )
						and SqlFetchNext(hSql(), nFetchRes)
				! Гуртова  передача вал поз
				If nMode = 30
					Set sTitl = 'Гуртова передача вал поз'
					Set sPeriod = ''
					Call SalHideWindow( pb_Formula )
					Call SalHideWindow( pb_InsF )
					Call SalHideWindow( dKVB )
					Call SalHideWindow( KV )
					Call SalHideWindow( ND )
					Call SalHideWindow( DATD )
					Call SalHideWindow( DAT1 )
					Call SalHideWindow( DAT2 )
					Call SalHideWindow( cb_Nazn )
					Call SalHideWindow( cb_Zo )
					Call SalDisableWindow( NLSA )
					Call SalEnableWindow( dKurs )
				! Макеты Разные
				Else
					Call SalEnableWindow( NLSA )
					Call SalDisableWindow( dKurs )
					Call SalHideWindow( dOB22 )
					! Динамический макет
					! Call Sel002( hWndMDI, 20 + nPar , NUMBER_Null, MA0.NBS, MA0.OB22 ) 
					If nPar = NUMBER_Null
						Set nDk   = Val( Subs(strPar01,1,1) )
						Set NBSB  = Subs(strPar01,2,4)
						Set OB22B = Subs(strPar01,6,2)
						Set NLSA  = strPar02 
						If SqlPrepareAndExecute(hSql(),
								 "SELECT name, nazn1,  alg, substr(sys_context('bars_context','user_branch'),1,15)  
								  INTO :sTitl, NAZN , :nAlg, :sBrn1 FROM ope_lot   where (ob22='~~' ) ")
								and SqlFetchNext(hSql(), nFetchRes)
						! If SqlPrepareAndExecute(hSql(),
								 "SELECT name, 
								         Substr(:strPar01,1,1), 
								         Substr(:strPar01,2,4), 
								         Substr(:strPar01,6,2), 
								         :strPar02, nazn1, 
								--add_months(DATP,1), DATP+ 1, 
								         alg, substr(sys_context('bars_context','user_branch'),1,15)  
								  INTO :sTitl, :nDk, :NBSB,:OB22B, :NLSA, :NAZN, :DAT2, :DAT1, :nAlg, :sBrn1 
								  FROM ope_lot 
								  where (ob22='~~' ) ")
								and SqlFetchNext(hSql(), nFetchRes)
					Else
						If SqlPrepareAndExecute(hSql(),
								 "SELECT  name, BS1, OB1, NLS, nazn1, dk, add_months(DATP,1), DATP+ 1, 
								         alg, substr(sys_context('bars_context','user_branch'),1,15)  
								  INTO :sTitl,:NBSB,:OB22B,:NLSA,:NAZN,:nDk, :DAT2, :DAT1, :nAlg, :sBrn1 
								  FROM ope_lot 
								  where (id = :nPar) ")
								and SqlFetchNext(hSql(), nFetchRes)
					Set nMak = nMode - 18
					Set sTitl = Str(nMak) ||':'|| sTitl
					If DAT1 = DATETIME_Null
						If SqlPrepareAndExecute(hSql(),
								  "SELECT trunc(gl.BD,'MM') - 1 , trunc( trunc(gl.BD,'MM') -1, 'MM' ) 
								   INTO  :DAT2, :DAT1 FROM dual ")
								and SqlFetchNext(hSql(), nFetchRes)
					!
					Call SalDisableWindow( pb_Formula )
					Call SalDisableWindow( pb_InsF )
					If nAlg >0 
						Call SalEnableWindow( pb_InsF )
					Else If nAlg < 0 
						Call SalEnableWindow( pb_Formula )
					!
					If nDk = 1
						Call SalDisableWindow( rb0 )
					Else If nDk = 0
						Set rb0 = TRUE
						Set rb1 = FALSE
						Call SalDisableWindow( rb1 )
					Else
						Set nDk = 1
					! Корр 
					If SalDateDay( dDat ) <= 10
						Call SalEnableWindow( cb_Zo )
					Else
						Call SalDisableWindow( cb_Zo )
				!
				Call SalSetWindowText( hWndForm, "Макет-" || sTitl )
				Call SalSendClassMessage( SAM_Create, 0, 0 )
			On SAM_CreateComplete
				!
				Call F_NLSA (NLSA)
				If NAZN = STRING_Null
					Set NAZN = sTitl
				Call NASELENIE ()
				!
			On SAM_FetchRowDone
				Set sNLSB = NLSB
				Set K  = 0 
				If nReg= 0
					Set S = 0 
				If S > 0 
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen )
				If dKVA = KV 
					Call XSalTblSetCellBackColor( KV, COLOR_Yellow )
				Else If dKVB = KV  
					Call XSalTblSetCellBackColor( KV, COLOR_Sky )
				Else
					Call XSalTblSetCellBackColor( KV, COLOR_Salmon )
				Set dKol = dKol + 1
			On SAM_ColumnSelectClick
	!
