.head 0 +  Application Description: Депозитный портфель Юр.Лиц
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000003000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000FE0000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFFFEFFFF FFFDFFFFFF0A0400 00C2010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730F6672
0080: 6D5F566964644465 7461696C73000001 8002000200000000 000000000000002C
00A0: 0000000000000001 000000FFFFFFFFFF FFFFFFF8FFFFFFE2 FFFFFF3200000032
00C0: 0000001F0400009D 0200000000000000 000000050000000F 4170706C69636174
00E0: 696F6E4974656D07 57696E646F777308 66726D5F4F70656E 0D4368696C642057
0100: 696E646F77730564 66524E4B00000000
.enddata
.data DT_MAKERUNDLG
0000: 02000000001B443A 5C4241525339385C 42494E5C42415261 72733030362E6170
0020: 6419443A5C424152 5339385C42494E5C 426172733030362E 646C6C19443A5C42
0040: 41525339385C4249 4E5C426172733030 362E617063000001 01011D443A5C4241
0060: 525339385C4C4942 524152595C426172 733030362E72756E 1D443A5C42415253
0080: 39385C4C49425241 52595C4261727330 30362E646C6C1D44 3A5C424152533938
00A0: 5C4C494252415259 5C42617273303036 2E61706300000101 01175C4241525339
00C0: 385C42494E5C4241 52533030362E6170 64175C4241525339 385C42494E5C4261
00E0: 72733030362E646C 6C175C4241525339 385C42494E5C4261 72733030362E6170
0100: 6300000101011D44 3A5C424152533938 5C4C494252415259 5C42617273303036
0120: 2E61706C1D443A5C 4241525339385C4C 4942524152595C42 6172733030362E64
0140: 6C6C1D443A5C4241 525339385C4C4942 524152595C426172 733030362E617063
0160: 0000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Custacnt.apd
.head 2 -  Dynalib: bars010.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: Cc_doc.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: GENTBLS.APL
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: XSALIMG.APL
.head 2 -  File Include: XSALSPL.APL
.head 2 -  ! File Include: Winapi.apl
.head 2 -  File Include: Docwis6.apl
.head 2 -  File Include: Qcktabs.apl
.head 2 -  File Include: Qckdvc.apl
.head 2 -  File Include: VTFILE.APL
.head 2 -  File Include: VTDOS.APL
.head 2 -  Dynalib: OTCN.APD
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Number: #00000
.head 3 -  Date/Time: dd/MM/yyyy
.head 3 -  Date/Time: dd.MM.yyyy
.head 3 -  Number: #000000
.head 3 -  Number: #0000
.head 3 -  Date/Time: dd/mm/yyyy hh:mm AMPM
.head 3 -  Date/Time: dd/mm/yyyy hh:mm
.head 2 +  External Functions
.head 3 +  Library name: frprint.dll
.head 4 +  Function: PrintTemplate
.head 5 -  Description: Функция печати отчета по шаблонв FastReport
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  ! (Server, User, Password, Template)
.head 6 -  String: LPSTR
.head 6 -  String: LPSTR
.head 6 -  String: LPSTR
.head 6 -  String: LPSTR
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  ! << Версія бібліотеки >>
.head 4 -  String: sLibraryVersion =  '2.83 від 13.12.2017'
.head 4 -  Number: nNegativeValue = -1
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 155463563
0000: 1E00000011000000 0000000000000000 02000001000000F7 000000E0010D0000
0020: 00FF3F
.enddata
.head 3 -  Window Handle: hWin0
.head 3 -  Window Handle: hWin1
.head 3 -  Window Handle: hWin2
.head 3 -  Window Handle: hWin3
.head 3 -  Window Handle: hWin4   
.head 3 -  Window Handle: hWin44  !! frm_OpenM(дод.угода) // dlg_Additional_Options
.head 3 -  Window Handle: hWin5   !! frm_OpenM
.head 3 -  Window Handle: hWin6   !! frm_Dog
.head 3 -  Window Handle: hWin7   !! для форми формування "Zvit" файлу
.head 3 -  Window Handle: hWin9   !! DPU_AGREEMENTS_PROCESSING (Перегляд та обробка ДУ до депозитів ЮО)
.head 3 -  Window Handle: hWin10  !! frm_Product_Options (Редагування параметрів продукту (типу договору))
.head 3 -  Window Handle: hWinComb
.head 3 -  Window Handle: hWinW   !! CB_VVOD1
.head 3 -  Window Handle: hWinWW
.head 3 -  Window Handle: hWinPR
.head 3 -  Boolean: bApdInited
.head 3 -  String: sBankType
.head 3 -  String: sDptBankType
.head 3 -  String: sSegmentExists
.head 3 -  Number: nHaveTOBO
.head 2 +  Internal Functions
.head 3 +  Function: Sel006	                  ! __exported
.head 4 -  Description: Bars006_Selector
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! надо вставить инициализацию apd
.head 5 -  Call Ini006()
.head 5 +  Select Case nMode
.head 6 +  ! Case NUMBER_Null !! Показати версію бібліотеки
.head 7 -  Call get_LibraryVersion()
.head 7 -  Break 
.head 6 +  Case 0   !! Настройка видов депозитов
.head 7 +  If not IsWindow(hWin0)
.head 8 -  Set hWin0 = SalCreateWindow( DPU_VIDD, hWndMDI, nPar, strPar01, strPar02 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( DPU_VIDD )
.head 7 -  Break
.head 6 -  ! Депозитний порфель ЮО
.head 6 +  Case 1   !! Депозитный потрфель Юр.Лиц (инспектор)
.head 7 +  If not IsWindow(hWin2)
.head 8 -  Set hWin2 = SalCreateWindow(DPU_DEAL,hWndMDI,nMode,nPar,strPar01,strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( DPU_DEAL )
.head 7 -  Break
.head 6 +  Case 2   !! Депозитный потрфель Юр.Лиц (бухгалтер)
.head 7 +  If not IsWindow(hWin2)
.head 8 -  Set hWin2 = SalCreateWindow(DPU_DEAL,hWndMDI,nMode,nPar,strPar01,strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( DPU_DEAL )
.head 7 -  Break
.head 6 +  Case 3   !! Депозитный потрфель Юр.Лиц ( тільки перегляд )
.head 7 +  If not IsWindow(hWin2)
.head 8 -  Set hWin2 = SalCreateWindow(DPU_DEAL,hWndMDI,nMode,nPar,strPar01,strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( DPU_DEAL )
.head 7 -  Break
.head 6 -  ! АРХИВ Депозитного порфеля ЮО
.head 6 +  Case 4   !! Депозитный потрфель Юр.Лиц АРХИВ
.head 7 +  If not IsWindow(hWin4)
.head 8 -  Set hWin4 = SalCreateWindow(DPU_ARCHIV,hWndMDI,nPar,strPar01,strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( DPU_ARCHIV )
.head 7 -  Break
.head 6 +  Case 5   !! Депозитный потрфель Юр.Лиц ИТОГИ
.head 7 +  If not IsWindow(hWin3)
.head 8 -  Set hWin3 = SalCreateWindow(DPU_ITOG,hWndMDI,nPar,strPar01,strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( DPU_ITOG )
.head 7 -  Break
.head 6 +  Case 6   !! Картотека поступлений на комбинированные договора
.head 7 +  If not IsWindow(hWinComb)
.head 8 -  Set hWinComb = SalCreateWindow(frm_Comb, hWndMDI, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (frm_Comb)
.head 7 -  Break
.head 6 +  Case 7   !! Формування файлу для ПК "Zvit"
.head 7 +  If not IsWindow(hWin7)
.head 8 -  Set hWin7 = SalCreateWindow(DPU_ZvitFiles,hWndMDI)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop (DPU_ZvitFiles)
.head 7 -  Break
.head 6 -  ! Перегляд та обробка ДУ до депозитних договорів ЮО
.head 6 +  Case 9
.head 7 +  If not IsWindow( hWin9 )
.head 8 -  Set hWin9 = SalCreateWindow( DPU_AGREEMENTS_PROCESSING, hWndMDI, nPar )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( DPU_AGREEMENTS_PROCESSING )
.head 7 -  Break
.head 6 -  ! Редагування параметрів продукту (типу договору)
.head 6 +  Case 10
.head 7 +  If not IsWindow( hWin10 )
.head 8 -  Set hWin10 = SalCreateWindow( frm_Product, hWndMDI, nPar )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( frm_Product )
.head 7 -  Break
.head 6 -  ! // Створення файлу мовної підтримки для даної бібліотеки.
.head 6 -  ! \\ Якщо не вказано мову - по замовчуванню створюється для УКРАЇНСЬКОЇ.
.head 6 +  Case 11
.head 7 -  Call GenLangFile()
.head 7 -  Break
.head 6 -  !
.head 6 +  Case 12
.head 7 -  Call ReadLangFile()
.head 7 -  Break
.head 3 +  Function: Ini006
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not bApdInited
.head 6 -  Set nHaveTOBO = GetGlobalOptionEx('HAVETOBO')
.head 6 -  !
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars006.lng"
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 7 -  ! ====================================================
.head 7 -  Call CurrentLangTable.AddAtom('cTAt', 'Внимание!')
.head 7 -  Call CurrentLangTable.AddAtom('cTErr','Ошибка!')
.head 7 -  Call CurrentLangTable.AddAtom('cTInfo','Информация')
.head 7 -  Call CurrentLangTable.AddAtom('cTMessage','Сообщение')
.head 7 -  Call CurrentLangTable.AddAtom('cTVidd','Вид депозита')
.head 7 -  Call CurrentLangTable.AddAtom('cTDepDog','Депозитный договор')
.head 7 -  Call CurrentLangTable.AddAtom('cTDopSogl','Доп.соглашение')
.head 7 -  Call CurrentLangTable.AddAtom('cTDopSogl_','к договору')
.head 7 -  Call CurrentLangTable.AddAtom('cTFilial','Подразделение')
.head 7 -  Call CurrentLangTable.AddAtom('cTBranch','Отделение')
.head 7 -  ! ====================================================
.head 7 -  ! DPU_DEAL
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cTWndTitle','Депозитный портфель Юр.Лиц')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.ISP','Исп')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.DPU_ID','Реф.~деп.~дог.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.DPU_GEN','Реф.~ген.~дог.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.DPU_AD','№~доп.~согл.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.ND','Номер~депоз.~дог.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.RNK','~РНК')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.NMK','~КЛИЕНТ')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.OKPO','Код ОКПО~клиента')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.KV','~Вал')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.ISO','~Вал')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.NAMEV','~Вал')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.NLS','~Депозитный~счет')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.SUM','Общая~сумма~по договору')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.SUMQ','Общая~сумма(Экв)~по договору')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.PROC','%~ставка')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.OST','Cумма~на счете~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.OSTN','Cумма~начисл.~%%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.OST_PL','Cумма~на счете~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.OSTQ','Cумма~на счете(Экв)~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.VIDD','~Вид договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.NAME','Вид~договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.nFREQN','Периодичность~выплаты %%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.FREQN','Периодичность~начисления %%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.nFREQV','Периодичность~погашения')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.FREQV','Периодичность~погашения~%%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.DATZ','Дата~заключения~договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.DATN','Дата~размещения~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.DATO','Дата~окончания~договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.DATV','Дата~возврата~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.MFOP','МФО~перечисл.~%%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.ACCP','Счет для~перечисл.~%%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.NMSP','Наименование получателя %%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.MFOD','МФО~возврата~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.ACCD','Счет~возврата~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.NMSD','Наименование получателя депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.ID_STOP','Код штрафа')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.TERM_MONTHS','Срок~дог.в~мес.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.TERM_DAYS','Срок~дог.в~днях')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cBTipIns','Открыть новый договор')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cBTipDel','Закрыть договор')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cBTipDetails','Параметры договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cBTipSos','Текущее состояние договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cBTipProc','Начислить %% по ВСЕМУ портфелю')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cBTipPAY','Выплатить %% по ВСЕМУ портфелю')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cBTipGraf','Графики')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cTMessOpen','Вы действительно хотите открыть новый договор?')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cTMessVidd','Не выбран вид депозитного договора!')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cTMessClose','Вы действительно хотите закрыть')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cTMessCloseNot','Невозможно закрыть')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cTMessCloseOk', 'Закрытие')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cTMessCloseErr','Ошибка при закрытии')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_DEAL.cTMessCloseProc','Возможно, по договору/доп.соглашению недоначислены проценты! Продолжить?')
.head 7 -  ! ====================================================
.head 7 -  ! DPU_VIDD
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.cTWndTitle','Виды депозитов Юр.Лиц')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colFLAG',     'Флаг~акт.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colVIDD',     'Числ.~код')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colCODE',     'Симв.~код')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colKV',       'Код~вал')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colNAME',     'Наименование~вида договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colSROK',     'Срок')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colKOL',      'Кол-во~дог.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colBSD',      'БС~деп')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colBSN',      'БС~%%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colBRID',     'Базовая~ставка')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colBRATE',    'Базовая~ставка')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colFREQID',   'Период-ть~выплаты %%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colFREQNAME', 'Период-ть~выплаты %%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colCOMPROC',  'Капи-~тализ.%%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colMINSUM',   'Миним.~сумма')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colFLADD',    'Флаг~пополн.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colSTOPID',   'Штраф')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colSTOP',     'Штраф')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colFLAUTOEXT','Авто-~переоф.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colSHABLON',  'Шаблон~договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colCOMMENTS', 'Подробности')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.pbTypes',       'Показать/скрыть инф-цию о типах договоров')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.colTYPEID',     'Тип~№')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.cmbTYPENAME',   'Тип договора~(продукт)')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.InvalidTypeId', 'Тип договора с указанным номером не существует!')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.pbExport',      'Экспорт в SQL-сценарий')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.GenScriptFailed',      'Ошибка экспорта вида договора в сценарий')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.GenScriptFileOpenErr', 'Невозможно создать файл')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_VIDD.GenScriptDone',        'Cценарий сохранен в')
.head 7 -  ! 

.head 7 -  !
.head 7 -  ! ====================================================
.head 7 -  ! DPU_ITOG
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cTWndTitle','Депозитный портфель юр.лиц за период с')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cTWndTitle_','по')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.nISP','ФИО~исполнителя')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.nVID','Вид~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.nKV','Код~ВАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.sISP','ФИО~исполнителя')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.sVID','Вид~вклада')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.sKV','ВАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.nBS','Бал.~счет')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.OST1','Сумма~депозитов~на начало')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.RAT1','Средневзв.~ставка')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.DOS1','Сумма Дт~оборотов~по депозитам')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.KOS1','Сумма Кт~оборотов~по депозитам')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.SAL1','Сумма~депозитов~на конец')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.RAT2','Средневзв.~ставка')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.OST2','Сумма~начисл.%%~на начало')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.DOS2','Сумма Дт~оборотов~по начисл.%%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.KOS2','Сумма Кт~оборотов~по начисл.%%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.SAL2','Сумма~начисл.%%~на конец')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.nKOL1','Кол-во~счетов~на начало')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.nKOL2','Открыто~счетов')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.nKOL3','Закрыто~ счетов')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.nKOL4','Кол-во~счетов~на конец')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.sBRANCH','Код~отделения')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.sSUBBRANCH','Код~подразделения')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cBTipIns','Порядок сортировки')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cBTipVidd','Общие параметры видов депозитов')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cBTipUpdate','Ресурс по срокам погашения')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cBTipDetails','Архив депозитов')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cBTipGraf','Графики')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.bgTbl','Критерии формирования')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.bgDate','Задайте период')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.tbl1.nSORT','Порядок')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.tbl1.sNAME','Разрез')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.tbl1.nFLAG','Отм')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cTOstSal1','Сумма~депозитов на')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cTOstSal2','Сумма~начисл.%% на')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cTKol','Кол-во~счетов на')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cTRat','Средневзв.~ставка на')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cTIsp','Исполнитель')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cTVidd','Вид депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cTKv','Валюта')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ITOG.cTBs','Бал.счет')
.head 7 -  ! ====================================================
.head 7 -  ! DPU_ARCHIV
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.cTWndTitle','Состояние депозитного портфеля Юр.Лиц')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.cTWndTitle_','на')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.cTAllBranch','Все подразделения')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.bgVIDD', 'Вид депозита:')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.bgDAT','Дата:')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.bgBranch','Код отделения:')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.bgSubBranch','Код подразделения:')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.sBRANCH','Код~отделения')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.sSUBBRANCH','Код~подразделения')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.ISP','Исп')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.DPU_ID','Реф.~деп.~дог.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.DPU_GEN','Реф.~ген.~дог.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.DPU_ADD','№~доп.~согл.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.ND','Номер~депоз.~дог.')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.RNK','~РНК')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.NMK','~КЛИЕНТ')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.KV','~Вал')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.ISO','~Вал')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.NLS','~Депозитный~счет')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.nSUMs','Общая~сумма~по договору')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.PROC','%~ставка')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.nOSTs','Cумма~на счете~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.nOSTNs','Cумма~начисл.~%%')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.VIDD','~Вид договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.NAME','Вид~договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.DATZ','Дата~заключения~договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.DATN','Дата~размещения~депозита')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.DATO','Дата~окончания~договора')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.DATV','Дата~возврата~депозита')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.cBTipDetails','Параметры договора')
.head 7 -  ! field strTip
.head 7 -  Call CurrentLangTable.AddAtom('DPU_ARCHIV.cFTipVIDD','Код вида депозита')
.head 7 -  ! ====================================================
.head 7 -  ! DPU_RESURS
.head 7 -  Call CurrentLangTable.AddAtom('DPU_RESURS.cTWndTitle','Привлеченный ресурс по срокам погашения')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('DPU_RESURS.KV','Вал')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_RESURS.LCV','ISO')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_RESURS.MMDD','Год +Мес')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_RESURS.DAT','Дата')
.head 7 -  Call CurrentLangTable.AddAtom('DPU_RESURS.S','Сумма')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('DPU_RESURS.cBTipSynchro','По Дням/Месяцам')
.head 7 -  ! ====================================================
.head 7 -  ! AcrPay
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.cTWndTitle','Выплата %%')
.head 7 -  ! column
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.ID','Реф.~дог.')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.ND','№~договора')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.ND_ADD','№~доп.согл.')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.VOB','Вид~док.')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.TT','Код~оп.')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.NLS','Счет')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.KVA','ВАЛ~А')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.NMS','Отправитель')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.OKPO','ОКПО~отправителя')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.SR','Сумма~документа')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.MFOB','МФО~получат.')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.NLSB','Счет получателя')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.KVB','ВАЛ~Б')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.NMKB','Получатель')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.OKPOB','ОКПО~получат.')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.NAZN','Назначение платежа')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.DK','Д/К')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.SR100','Сумма~документа')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.S','Формула~суммы')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.OSTB','Остаток')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.NMK','Отправитель')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.OSTC','Остаток')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.cBTipDetails','Карточка договора')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.cBTipRun','Выполнить проводки')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.cTNaznDepDog','деп.договору №')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.cTNaznVid','від')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.cTNaznDopUg','дод.угоди №')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.cTNaznNdDepDog','до деп.договору')
.head 7 -  Call CurrentLangTable.AddAtom('AcrPay.cTNaznProc','Сплата відсотків згідно')
.head 7 -  ! ====================================================
.head 7 -  ! CB_VVOD1
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cTWndTitle','Ввод документа')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cTMessOp','Не описана операция')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('CB_VVOD1.cTErrNazn','Ошибка формирования назначения платежа')
.head 7 -  ! ====================================================
.head 7 -  ! dlgPenalty
.head 7 -  Call CurrentLangTable.AddAtom('dlgPenalty.cTWndTitle','Расчет штрафа при досрочном расторжении договора')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlgPenalty.pbExit','Выход')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('dlgPenalty.bgDetails','Подробности расчета штрафа')
.head 7 -  Call CurrentLangTable.AddAtom('dlgPenalty.bgPenyaRate','Штрафная процентная ставка:')
.head 7 -  Call CurrentLangTable.AddAtom('dlgPenalty.bgFactSum','Начислено по договору:')
.head 7 -  Call CurrentLangTable.AddAtom('dlgPenalty.bbgPenyaSum','Начислено по штрафной ставке:')
.head 7 -  Call CurrentLangTable.AddAtom('dlgPenalty.bgDelta','Сумма штрафа:')
.head 7 -  Call CurrentLangTable.AddAtom('dlgPenalty.bgDeltaD','Будет взыскано с депозитного счета:')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('dlgPenalty.cTMessFileWriteErr','Ошибка записи файла')
.head 7 -  Call CurrentLangTable.AddAtom('dlgPenalty.cTMessFileForm','Сформирован файл')
.head 7 -  Call CurrentLangTable.AddAtom('dlgPenalty.cTMessFileNotOpen','Невозможно открыть файл')
.head 7 -  ! ====================================================
.head 7 -  ! frm_Dog
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTWndTitle1','Текущее состояние депозитного договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTWndTitle2','Текущее состояние доп.соглашения №')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.pb0','Размещение')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.pb1','Пополнение')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.pb2','Погашение')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.pb3','Начисление %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.pb4','Выплата начисл.%%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.pb5','Штрафование')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.bgNMK','Клиент:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.bgVIDD','Вид депозита:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.bgKV','Валюта договора:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.bgFREQ','Выплата %%:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.bgACC','Депозитный счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.bgACCN','Счет начисл.%%:')
.head 7 -  ! TB1
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.TB1.DAT','Дата')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.TB1.PRIDs','Приход')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.TB1.RASDs','Расход')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.TB1.ISXDs','Остаток~по вкладу')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.TB1.PROC','%~ставка')
.head 7 -  ! TB2
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.TB2.DAT','Дата')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.TB2.PRIPs','Начис~%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.TB2.RASPs','Выплата~ %')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.TB2.ISXPs','Остаток~по %')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cBTipDetails','Параметры договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cBTipRefresh','Перечитать')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cBTipExit','Выйти')
.head 7 -  ! field strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cFTipNLS','Депозитный счет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cFTipOST_PL','Остаток на депозитном счете')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cFTipNLSN','Счет начисленных %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cFTipOSTN_PL','Остаток на счете начисленных %%')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTNazn0','Зарахування коштів на депозитний рахунок зг.')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTNaznPDV','без ПДВ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTNazn4','Виплата відсотків згідно деп.дог.')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTNazn2','Повернення коштів згідно деп.дог.')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTNAZN','Повернення зайво нарахованих відсотків при достроковому розірванні')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTTitle1','Депозитный договор №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTNazn0_11','деп.договору №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTNazn0_12','від')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTTitle2','Доп.соглашение №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTTitle2_','к договору')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTNazn0_21','доп.угоди №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTNazn0_22','до деп.договору')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTGrn','грн.')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTTitle2G','Доп.соглашения №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTTitle1G','Депозитного договора №')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTMessShtraf','Для расчета штрафа нужно доначислить проценты')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTMessDoc','Есть незавизированные документы по счетам данного договора!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTMessProv','Выполнить проводку на взыскание штрафа на сумму')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTErrAccN',      'Не найден счет начисленных процентов для деп.договора №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTErrAccD',      'Не найден депозитный счет для деп.договора №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTErrAccR',      'Не описан счет расходов для деп.договора №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTErrPay',       'Невозможно оплатить операцию')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTErrSum',       'на сумму')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTErrFAMRT',     'Ошибка при окончат.амортизации счетов дисконта/премии по договору №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Dog.cTErrGetPenalty','Ошибка расчета суммы штрафа по договору №')
.head 7 -  !
.head 7 -  ! ====================================================
.head 7 -  ! frm_Graf
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.cTWndTitle','Депозитный портфель юр. лиц')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.cBTipOk','Построить графики')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.cBTipCancel','Выйти')
.head 7 -  ! tblG
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.tblG.colLCV','Валюта')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.tblG.colS','Сумма')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.tblG.colSQ','Экв')
.head 7 -  ! tblG1
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.tblG1.colSroks','Срок')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.tblG1.colSQ','Экв')
.head 7 -  ! tblG2
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.tblG2.colSroks','Срок')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.tblG2.colS','Сумма')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.cTSrok1','до 1 мес')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.cTSrok2','1-3 мес')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.cTSrok3','3-6 мес')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.cTSrok4','6-12 мес')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Graf.cTSrok5','более года')
.head 7 -  ! ====================================================
.head 7 -  ! frm_Msg
.head 7 -  Call CurrentLangTable.AddAtom('frm_Msg.cTWndTitle','Подождите')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('frm_Msg.bg1','Идет инициализация графического сервера.')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Msg.bg2','Подождите, пожалуйста...')
.head 7 -  ! ====================================================
.head 7 -  ! frm_Open
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTWndTitle','Параметры Депозитного договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTWndTitle1','Депозитный договор №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTWndTitle2','Доп.соглашение №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTWndTitle2_','к договору')
.head 7 -  !
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipUpdate','Сохранить')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipRefresh','Очистить')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipSos','Текущее состояние договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipPrint','Печать договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipCancel','Выйти')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipPasport','Паспорт клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipAccounts','Табличная форма счетов депозита')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipChilds','Открыть доп.соглашение')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipAddOption','Додаткові параметри договору')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipKlient','Поиск клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipIr','Рассчитать индивидуальную % ставку')
.head 7 -  ! field strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipND','№ договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipVIDD','Код вида договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipCmbVIDD','Вид договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipTYPE','Код продукта')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipCmbTYPE','Название продукта')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipSUM','Сумма договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipKV','Код валюты договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipISO','Валюта договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipRNK','Рег.№ клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipOKPO','Код ОКПО клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipNMK','Наименование клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipADRES','Адрес клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipDATZ','Дата Заключения')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipDATN','Дата Начала')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipDATO','Дата Завершения')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipDATV','Дата Возврата')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipFREQ_V','Код периодичности выплаты %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipCmbFREQ_V','Периодичность выплаты %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipMFOP','МФО для перечисления %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipNBP','Банк для перечисления %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipNLSP','Счет для перечисления %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipNMSP','Получатель %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipMFOD','МФО для перечисления депозита')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipNBD','Банк для перечисления депозита')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipNLSD','Счет для перечисления депозита')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipNMSD','Получатель депозита')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipIR','Индивидуальная % ставка')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipOP','Операция')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipBR','Базовая ставка')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipBRDAT','Дата установки ставки')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipMIN_SUM','Неснижаемый остаток')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipID_STOP','Код штрафа за досрочное расторжение договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipSTOP','Штраф за досрочное расторжение договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cFTipCOMMENTS','Комментарий')
.head 7 -  ! BG  
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgNLS',       '№ счета:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgKlient',    'Клиент')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgRNK',       'Рег.№:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgOKPO',      'ОКПО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgNMK',       'Наименование:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgADRES',     'Адрес:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgDealType',  'Вид договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgTYPE',      'Продукт:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgKV',        'Валюта:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgVIDD',      'Вид договора:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgParams',    'Параметры')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgND',        'Номер договора:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgSUM',       'Сумма договора:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgMIN_SUM',   'Неснижаемый остаток:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgFREQ_V',    'Выплата процентов:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgSTOP',      'Штраф:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgDate',      'Даты')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgDATZ',      'Заключения:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgDATN',      'Начала:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgDATO',      'Завершения:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgDATV',      'Возврата:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgRate',      '%% ставка')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgOP',        'опер.')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgReceiverP', 'Выплата процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgMFOP',      'МФО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgNLSP',      'Счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgNAMEP',     'Получатель:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgReceiverD', 'Возврат депозита')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgMFOD',      'МФО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgNLSD',      'Счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgNAMED',     'Получатель:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.bgCOMMENTS',  'Комментарий')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cbCOMPROC',   'капитализация процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cbIR',        'инд.')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cbBR',        'баз.')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTOpenDepDog','Открыт Депозитный договор')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTUpdateDepDog','Изменение параметров Депозитного договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTRate','Процентная ставка')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessSaveDepDog','Cохранение Депозитного договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessOpenQuestion','Вы действительно хотите открыть доп.соглашение по данному договору?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessNotIr','Невозможно рассчитать % ставку')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessNotSaveParams','Неуспешное изменение параметров Депозитного договора')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTErrOpenDepDog','Ошибка при открытии Депозитного договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTErrUpdateSpar','Невозможно изменить спецпараметр')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cUpdDealQuest', 'Сохранить новые параметры договора?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cUpdDealDone',  'Новые параметры договора сохранены!')
.head 7 -  !
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cBTipCombine',           'Измененить вид договора на комбинированный')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessCombineQuestion1', 'Изменить вид договора на комбинированный') 
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessCombineQuestion2', 'и открыть связанный договор до востребования?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTCreateSubDeal1',       'Вид депозитного договора № ') 
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTCreateSubDeal2',       'изменен на комбинированный')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTCreateSubDeal3',       'открыт связанный договор до востребования № ') 
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessCalcRateErr0', 'В спр-ке шкал проц.ставок не найдена ставка для заданных условий договора') 
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessCalcRateErr1', 'Для расчета процентной ставки необходимо указать вид договора') 
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessCalcRateErr2', 'Для расчета процентной ставки необходимо указать сумму договора') 
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessCalcRateErr3', 'Для расчета процентной ставки необходимо указать дату начала действия договора') 
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessCalcRateErr4', 'Для расчета процентной ставки необходимо указать дату окончания действия договора') 
.head 7 -  Call CurrentLangTable.AddAtom('frm_Open.cTMessCheckRateErr', 'Введенная ставка превышает макс.допустимую ставку для договоров данного типа') 
.head 7 -  !
.head 7 -  ! ====================================================
.head 7 -  Call CurrentLangTable.AddAtom('_cTMessAccRnk','Счет открыт на другого клиента! Продолжить?')
.head 7 -  Call CurrentLangTable.AddAtom('_cTMessDopSogl','Введенный номер доп.соглашения УЖЕ существует! Продолжить?')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrNomDopSogl','Номер доп.соглашения НЕ должен содержать символы!')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrDat','Некорректно задана дата!')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrMfo','Не нашли банка с МФО')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrAcc','Ошибка в контрольном разряде счета!')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrAccNotOpen','Счет не открыт!')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrMinSum','Неснижаемый остаток превышает сумму по договору!')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrUpdateDatO','Невозможно изменить дату окончания депозита')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrUpdateDatIr','Не указана дата установки %-ной ставки!')
.head 7 -  Call CurrentLangTable.AddAtom('_cTMessSaveQuestion','Зафиксировать изменение процентной ставки по депозитному договору №')
.head 7 -  Call CurrentLangTable.AddAtom('_cTMessInfoIr','Новая %-ная ставка будет действовать с')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrUpdateNotSaveIr','Невозможно зафиксировать изменение %-ной ставки')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrUpdateNotSaveDepAcc','Невозможно изменить %-ную карточку депозитного счета')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrCheck','Ошибка заполнения реквизитов')
.head 7 -  Call CurrentLangTable.AddAtom('_cTErrRekv','Не заполнен реквизит')
.head 7 -  ! ====================================================
.head 7 -  ! frm_OpenM
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTWndTitle','Карточка депозитного договора')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTabs0','Основные параметры')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTabs1','Подробности')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTabs2','Доп.инф-ция')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTabs3','SWIFT-реквизиты получателя') 
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.pbClient','Поиск')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.pbCustAcc','Спр-к счетов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.pbTrustee','Довер.лица')
.head 7 -  ! button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipUpdate1','Сохранение')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipUpdate2','Сохранить изменения')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipRefresh','Очистка')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipPasport','Паспорт клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipAccounts','Счета по договору')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipSos','Текущее состояние договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipPrint','Печать договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipChilds','Открытие доп.соглашения')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipCancel','Выход')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipClient','Поиск клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipCustAcc','Текущие счета клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipTrustee','Ответственные лица клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cBTipDubl','Пролонгація додаткової угоди')
.head 7 -  ! BG
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgClient','Клиент')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgRNK','Регистр.№:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgOKPO','Код ЕГРПОУ:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgNMK','Наименование:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgVIDD','Вид договора:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgBRANCH','Подразделение:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgND','№:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgIR','Проц.ставка:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgBRDAT','%%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSUM','Сумма:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgKV','Валюта:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgDate','Даты')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgDATZ','Заключения:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgDATN','Поступления:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgDATO','Завершения:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgDATV','Возврата:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgDepAcc','Счета договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgNLSDEP','Депозитный счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgNLSDEN','Процентный счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgNLSDEP2','Депозитный счет (генер.):')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgNLSDEN2','Процентный счет (генер.):')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgDetailsDep','Прием / Возврат депозита')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgMFOD','Банк:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgNLSD','Счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgProc','Выплата процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgMFOP','Банк:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgNLSP','Счет:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgFREQ','Период-ть выплаты %%:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgShtraf','Условия досрочного расторжения вклада')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSTOPID','Штраф:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgMIN_SUM','Неснижаемый остаток:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgTRUSTID','Должностное лицо')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgTRUSTFIO','ФИО:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgTRUSTPOS','Должность:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgTRUSTDOC','Документ:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgCOMMENTS','Комментарий:')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW56','Банк-посредник (56)')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW56_Name','Название')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW56_Adr','Адрес')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW56_Code','SWIFT-код')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW57','Банк-Бенефициар (57)')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW57_Name','Название')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW57_Adr','Адрес')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW57_Code','SWIFT-код')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW57_Acc','Счет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW57_AccDtl','(банка-бенефициара в банке-посреднике)')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW59','Бенефициар (59)')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW59_Name','Название')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW59_Adr','Адрес')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.bgSW59_Acc','Счет')
.head 7 -  ! constants
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTOpenDopSogl','Открыто доп.соглашение №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTOpenDepDog','Открыт депозитный договор №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTNomDog','№ договора:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTDepAcc2','Депозитный счет-2:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTAccN2','Счет начисл.%%-2:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTNomDopSogl','№ доп.согл.:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTDepAcc','Депозитный счет (генер.):')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTAccN','Процентный счет (генер.):')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTSaveDepDog','Изменение параметров Депозитного договора')
.head 7 -  ! message text
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTMessOpenDepSoglQuestion','Открыть доп.соглашение по данному договору?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTMessProlongDepDealQuestion','Виконати пролонгацію поточної угоди?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTMessGetAcc','Выбрать из справочника текущий счет клиента?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTMessSetDep','Занести выбранное значение в параметры для возврата депозита?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTMessSetDen','Занести выбранное значение в параметры для выплаты %%?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTMessNotClient','Не указан клиент!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTMessNotKv','Не указана валюта!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTMessViddNotFound','Не найден вид договора №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTMessSaveOk','Изменения успешно внесены в базу данных!')
.head 7 -  ! error text
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrOpenDopSogl','Ошибка при открытии доп.соглашения №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrOpenDepDog','Ошибка при открытии депозитного договора №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrSrokForVidd','Недопустимая срочность депозита для данного вида договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrListRNK','Не указан клиент')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrListVIDD','Не указан вид депозитного договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrListBRANCH','Не указано подразделение банка')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrListKV','Не указана валюта договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrListSUM','Не указана сумма договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrListDATZ','Не указана дата заключения договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrListDATN','Не указана дата поступления средств')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrListMFOD','Не указаны реквизиты клиента для приема/возврата депозита')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrListFREQV','Не указана периодичность выплаты %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrListIR','Не указана процентная ставка')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrListTRUSTID','Не указано ответ.лицо клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OpenM.cTErrSaveDepDog','Ошибка при изменении параметров депозитного договора!')
.head 7 -  ! ====================================================
.head 7 -  !
.head 7 -  ! frm_ViddDetails
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.dfTITLE',        'Карточка вида депозитного договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.cTabs0',         'Основные параметры')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.cTabs1',         'Параметры начисления процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.pbRefresh',      'Обновить')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.pbUpdate',       'Сохранить')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.pbCancel',       'Завершить')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.Updated',        'Изменены параметры вида депозитного договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.Created',        'Создан вид депозитного договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.ErrUpdate',      'Не удалось изменить параметры вида депозитного договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.ErrGetVidd',     'Не удалось получить код вида депозита!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.ErrCreate',      'Не удалось создать вид депозитного договора!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.ErrBS1',         'Бал.счет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.ErrBS2',         'отсутствует в плане счетов!')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgNAME',         'Наименование вида договора:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgKV',           'Валюта договора:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgMNTHTERM',     'Длительность мес.:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgDAYSTERM',     'дней:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBSD',          'Балансовый счет депозита:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBSN',          'Балансовый счет процентов:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgMINSUM',       'Миним.сумма депозита:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgMAXSUM',       'Макс.сумма депозита:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgMINSUMADD',    'Миним.сумма пополнения:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgSTOP',         'Штраф за досрочное расторжение:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgPENYA',        'Пеня (%):')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgSHABLON',      'Шаблон договора:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBASEY',        'База начисления процентов:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgFREQN',        'Период-ть начисления процентов:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgMETR',         'Метод начисления процентов:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBRID',         'Базовая процентная ставка:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgOST',          'Тип вычисления остатка:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgTT',           'Операция начисления процентов:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgNLS7',         'Счет процентных расходов:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgFREQV',        'Период-ть выплаты процентов:')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.bgCOMMENTS',     'Комментарий:')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.rb1',            'стандарт')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.rb2',            'деп.линия')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.rb3',            'деп.линия на 8 классе')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.chkAdd',         'Пополнение депозита')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.chkComproc',     'Капитализация процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.chkAutoExt',     'Автопереоформление')
.head 7 -  !
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.dfNAME',         'Наименование вида договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.cmbKV',          'Валюта договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.dfBSD',          'Балансовый счет депозита')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.dfBSN',          'Балансовый счет процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.cmbBASEY',       'База начисления процентов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.cmbFREQN',       'Периодичность начисления %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.cmbFREQV',       'Периодичность выплаты %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.cmbMETR',        'Метод начисления %%')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.cmbOST',         'Тип вычисления остатка')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.cmbSTOP',        'Штраф за досрочное расторжение')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.dfTT',           'Операция по начислению %%')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.cmbOST0',        'Исключая последний день')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.cmbOST1',        'Исключая первый и последний дни')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.ErrMinMaxSum',          'Максимальная сумма не может быть меньше минимальной!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_ViddDetails.frm_ViddDetails.ErrKv', 'Неверно указан код валюты!')
.head 7 -  !
.head 7 -  !
.head 7 -  ! ====================================================
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.Title',       'Картотека поступлений на комбинированные договора ЮЛ')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.pbDel',       'Изъять платеж из картотеки')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.pbUpdate',    'Зачислить поступление на счета выбранного договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.pbDetails',   'Просмотреть выбранный платеж')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.Wish2Delete', 'Изъять из картотеки платеж №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.Account',     'по счету')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.Wish2Pay',    'Зачислить сумму')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.Account2',    'на счета')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.InfoMsg',     'Выполнено')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.DocRef',      'Референс документа')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl.colNLS',  'Транзитный~счет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl.colISO',  'Код~вал')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl.colNMS',  'Наименование~транзитного счета')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl.colOSTC', 'Фактический~остаток')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl.colOSTB', 'Плановый~остаток')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl.colREF',  'Референс~платежа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl.colVDAT', 'Дата~платежа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl.colSUM',  'Сумма~платежа')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl.colNAZN', 'Назначение~платежа')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colDPUNUM',      'Номер~договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colDPUDAT',      'Дата~договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colDPUSUM',      'Сумма~договора')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colDPULIMIT',    'Неснижаемый~остаток')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colMAINNLS',     'Депозитный~счет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colMAINOSTC',    'Фактический~остаток')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colMAINOSTB',    'Плановый~остаток')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colMAINSUM2PAY', 'Cумма к~зачислению')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colDMNDNLS',     'Депозитный~счет - 2')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colDMNDOSTC',    'Фактический~остаток - 2')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colDMNDOSTB',    'Плановый~остаток - 2')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colDMNDSUM2PAY', 'Сумма к~зачислению -2')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colCUSTID',      'Регист.№~клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colCUSTNAME',    'Наименование~клиента')
.head 7 -  Call CurrentLangTable.AddAtom('frm_Comb.tbl2.colCUSTCODE',    'Код ОКПО~клиента')
.head 7 -  !
.head 7 -  ! ====================================================
.head 6 -  ! Call CurrentLangTable.SaveToFile('C:\\TEMP\\bars006.lng','RUS')
.head 6 -  Call DocWisInit( 'CB_VVOD1' )
.head 6 -  Call BankType_Init()
.head 6 -  Set bApdInited = TRUE
.head 5 -  Return bApdInited
.head 3 +  Function: CreateDptDoc		
.head 4 -  Description: Изготовление депозитного договора
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  ! ! № договора
.head 5 -  Number: nND
.head 5 -  ! ! Код вида депозита
.head 5 -  Number: nID
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTemplateId
.head 5 -  Long String: sDoc
.head 5 -  Number: nNdAdd
.head 5 -  Number: nKv
.head 5 -  Number: nType
.head 5 -  Number: nExtend
.head 5 -  Number: nFetchRes
.head 5 -  Boolean: fExists
.head 5 -  String: sTmp
.head 5 -  : cCnc
.head 6 -  Class: cABSConnect
.head 5 -  : cCnc2
.head 6 -  Class: cABSConnect
.head 5 -  Number: nADD
.head 5 -  Boolean: bADD
.head 4 +  Actions
.head 5 -  ! Признак доп.соглашения
.head 5 +  If SqlPrepareAndExecute(hSql(), 
   "SELECT nvl(d.dpu_add,0), v.kv, v.type_id, v.fl_extend
           INTO :nNdAdd, :nKv, :nType, :nExtend
      FROM dpu_deal d, dpu_vidd v
     WHERE d.vidd = v.vidd AND d.dpu_id = :nND") 
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return 0
.head 5 +  ! Выбираем вид шаблона
.head 6 -  ! If nID and SqlPrepareAndExecute( hSql(),
    "SELECT v.shablon
     INTO :sTemplateId
     FROM dpt_deposit d, dpt_vidd v
     WHERE d.deposit_id=:nID and v.vidd=d.vidd" )
and SqlFetchNext(hSql(), nFetchRes)
.head 6 +  ! Else
.head 7 -                                                      Return 0
.head 5 +  If nID
.head 6 +  If sBankType = 'PRVX' AND nNdAdd > 0
.head 7 -  Set sTemplateId = IifS(nKv = GetBaseVal(),'DPU_ADD_NC','DPU_ADD_FC')
.head 6 +  Else If sBankType = 'SBER' AND nNdAdd = 0 AND nExtend = 2
.head 7 +  If SqlPrepareAndExecute( hSql(), "SELECT  shablon  INTO  :sTemplateId  FROM dpu_types WHERE type_id = :nType " )
.head 8 +  If (not SqlFetchNext( hSql(), nFetchRes )) or sTemplateId=STRING_Null
.head 9 -  Return 0
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute( hSql(), "SELECT  shablon  INTO  :sTemplateId  FROM dpu_vidd WHERE vidd=:nID " )
.head 8 +  If (not SqlFetchNext( hSql(), nFetchRes )) or sTemplateId=STRING_Null
.head 9 +  If NOT cdoc_SelectDocTemplate("DPT_DOCS","ID","NAME"," TIP=2 ", sTemplateId )
.head 10 -  Return 0
.head 6 -  ! есть шаблон
.head 6 +  If sTemplateId
.head 7 -  ! Получаем документ из шаблона
.head 7 -  Call XConnectGetParams( cCnc )
.head 7 +  If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
.head 8 -  Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), sTemplateId,  nND, 0)
.head 8 +  If sDoc
.head 9 -  ! Показываем документ с редактированием
.head 9 +  If cdoc_ShowDoc( sDoc, TRUE, FALSE )!=3
.head 10 +  ! Сохраняем документ в БД
.head 11 -  ! Set fExists=FALSE
.head 11 +  ! If SqlPrepareAndExecute( hSql(), 'SELECT id INTO :sTmp FROM CC_DOCS WHERE id=:sTemplateId and nd= :nID ' )
.head 12 +                                                      If SqlFetchNext( hSql(), nFetchRes )
.head 13 -                                                      Set fExists=TRUE
.head 11 +  ! If fExists
.head 12 +                                                      If SalMessageBox( 'Текст договора ' || SalNumberToStrX(nID,0) || ' уже существует! Перезаписать?', 'Подтверждение', MB_YesNo | MB_IconQuestion )=IDYES
.head 13 +                                                      If SqlPrepare( hSql(), 'UPDATE CC_DOCS SET TEXT=:sDoc WHERE id=:sTemplateId and nd= :nID' )
.head 14 +                                                      If SqlSetLongBindDatatype( 1, 23 )
.head 15 +                                                      If SqlExecute( hSql() )
.head 16 -                                                      Call SqlCommitEx( hSql(), 'Текст договора № ' || SalNumberToStrX(nID,0) || ' перезаписан в БД!' )
.head 13 -  ! Печатаем документ
.head 13 -  ! Call cdoc_PrintDoc( sDoc )
.head 13 -                                                      Return 1
.head 11 +  ! Else
.head 12 +                                                      If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
 VALUES (:sTemplateId,:nID,:sDoc,0)' )
.head 13 +                                                      If SqlSetLongBindDatatype( 3, 23 )
.head 14 +                                                      If SqlExecute( hSql() )
.head 15 -                                                      Call SqlCommitEx( hSql(), 'Текст договора № ' || SalNumberToStrX(nID,0) || ' сохранен в БД!' )
.head 12 -  ! Печатаем документ
.head 12 -  ! Call cdoc_PrintDoc( sDoc )
.head 12 -                                                      Return 1
.head 10 -  Set bADD=(Subs(sTemplateId,1,7)='DPU_ADD')
.head 10 -  ! Если доп.соглашение - вычисляем его номер
.head 10 +  If bADD
.head 11 +  If SqlPrepareAndExecute( hSql(),
 " SELECT TO_CHAR(NVL(MAX(adds),0)+1) INTO :nADD
   FROM cc_docs WHERE id LIKE 'DPU_ADD%' AND nd=:nND " ) AND
not SqlFetchNext( hSql(), nFetchRes )
.head 12 -  Set nADD=0
.head 11 +  If NOT cdoc_SetDocText(hSql(), TRUE,
  sTemplateId, nND, nADD, DATETIME_Null, sDoc)
.head 12 -  Call SqlRollback(hSql())
.head 11 +  Else
.head 12 -  Call SqlCommitEx(hSql(), 'Текст доп.соглашения № ' || SalNumberToStrX(nID,0) || '/' || SalNumberToStrX(nADD,0) || ' сохранен в БД!')
.head 11 +  ! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
 VALUES (:sTemplateId,:nND,:sDoc,:nADD)' )
.head 12 +  If SqlSetLongBindDatatype( 3, 23 )
.head 13 +  If SqlExecute( hSql() )
.head 14 -  Call SqlCommitEx( hSql(), 'Текст доп.соглашения № ' || SalNumberToStrX(nID,0) ||'/'|| SalNumberToStrX(nADD,0)|| ' сохранен в БД!' )
.head 10 +  Else
.head 11 +  If NOT cdoc_SetDocText(hSql(), TRUE,
  sTemplateId, nND, 0, DATETIME_Null, sDoc)
.head 12 -  Call SqlRollback(hSql())
.head 11 +  Else
.head 12 -  Call SqlCommitEx(hSql(), 'Текст договора № ' || SalNumberToStrX(nID,0) ||' сохранен в БД!')
.head 11 +  ! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
 VALUES (:sTemplateId,:nND,:sDoc,0)' )
.head 12 +  If SqlSetLongBindDatatype( 3, 23 )
.head 13 +  If SqlExecute( hSql() )
.head 14 -  Call SqlCommitEx( hSql(), 'Текст договора № ' || SalNumberToStrX(nID,0) || ' сохранен в БД!' )
.head 8 -  Call cCnc.Disconnect()
.head 8 -  Call cCnc2.Disconnect()
.head 6 +  Else
.head 7 -  Return 0
.head 3 +  Function: GetCloseDate
.head 4 -  Description: Возвращает дату окончания договора
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  Date/Time: dOpenDate !! начальная дата
.head 5 -  Number: nDuration    !! период в мес (в.т.ч. дробных)
.head 5 -  Number: nKV
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dCloseDate
.head 5 -  Number: nMonths
.head 5 -  Number: nDays
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 -  ! Кол-во месяцев
.head 5 +  If ( nDuration = 0 OR nDuration = NUMBER_Null )
.head 6 -  Return DATETIME_Null
.head 5 -  Set nMonths = SalNumberTruncate( nDuration, 3, 0 )
.head 5 -  ! Кол-во дней
.head 5 -  Set nDays = SalNumberRound(SalNumberTruncate(SalNumberMod(nDuration,1),4,4)*10000)
.head 5 -  ! Set nDays = SalNumberRound(SalNumberTruncate(SalNumberMod(Duration,1),3,3)*1000)
.head 5 +  If SqlPrepareAndExecute( hSql(),
"SELECT dpu.f_duration( :dOpenDate, :nMonths, :nDays )
   INTO :dCloseDate
   FROM dual" )
and SqlFetchNext( hSql(),nFetchRes )
.head 6 -  Return dCloseDate
.head 5 +  Else
.head 6 -  Return DATETIME_Null
.head 3 +  Function: F_TT
.head 4 -  Description: Определение операций для депозитов ЮЛ, используя спр-к DPT_OP
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: pOP
.head 5 -  String: pMFO
.head 5 -  String: pNLS
.head 5 -  Number: pKV
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sMFO
.head 5 -  String: sTT
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 -  Set sMFO = IifS(pMFO = STRING_Null, GetBankMfo(), pMFO)
.head 5 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT substr(dpu.get_tt(:pOP, :pKV, :sMFO, :pNLS), 1, 3) 
     INTO :sTT 
     FROM dual") 
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  !
.head 5 +  If sTT = STRING_Null 
.head 6 -  Call SalMessageBox('Не описана операция!', 'Внимание', MB_IconStop)
.head 5 -  Return sTT
.head 3 +  Function: UseDpuLine
.head 4 -  Description: Использование депозитной линии
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetchRes
.head 5 -  String: sType
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute(hSql(), 
   "SELECT decode(count(*), 0, 'K', 'P') 
      INTO :sType 
      FROM dpu_vidd 
     WHERE fl_extend = 2")
AND NOT SqlFetchNext(hSql(), nFetchRes) 
.head 6 -  Set sType = 'K'
.head 5 -  Return sType
.head 3 +  Function: get_OneStringValue
.head 4 -  Description: ф-я повертає результат виконання переданого запиту в строку sResult
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sSqlText
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetchRes
.head 5 -  String: sResult
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), sSqlText ) AND NOT SqlFetchNext(hSql(), nFetchRes) 
.head 6 -  Set sResult = STRING_Null
.head 5 -  Return sResult
.head 3 +  Function: get_LibraryVersion
.head 4 -  Description: Показати версію бібліотеки
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sPackageVersion
.head 4 +  Actions
.head 5 -  Set sPackageVersion = get_OneStringValue( "SELECT SubStr(dpu.header_version, 1, 45) || SubStr(dpu.body_version, 1, 45) INTO :sResult FROM dual" )
.head 5 -  Call SalMessageBox ( 'Модуль: Депозити ЮО' || Chr(10) ||
                     'Версія: '|| sLibraryVersion || Chr(10) ||
                     'Схема банку: ' || sDptBankType || ' (' || sBankType || ')' || Chr(10) ||
                     'Робота з сегментами: ' || sSegmentExists || Chr(10) ||
                     'Робота з деплініями: ' || get_OneStringValue("select decode(VAL,'8','Y','N') INTO :sResult from BARS.PARAMS$GLOBAL where PAR = 'DPULINE8'") || Chr(10) ||
                     'PL/SQL: ' || Chr(10) ||  sPackageVersion,
                     'About', MB_Ok )
.head 3 +  Function: DptCorrectDate
.head 4 -  Description: Вычисление ближайшей рабочей даты в модуле
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  Number: nKV
.head 5 -  Date/Time: dtOldDate
.head 5 -  Date/Time: dtEndDate
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If GetGlobalOptionEx( 'VKL_MASK' ) = 14
.head 6 -  Return dtOldDate
.head 5 +  Else
.head 6 -  Return CorrectDate(nKV,dtOldDate,dtEndDate)
.head 3 +  Function: BankType_Init
.head 4 -  Description: Вычисление типа банка (PRVX или др.)
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetchRes
.head 5 -  Number: nPar
.head 4 +  Actions
.head 5 -  ! Назва схеми банку по роботі з депозитами
.head 5 -  Set sDptBankType = GetGlobalOption( 'DPT_BANK_TYPE' )
.head 5 -  ! Визначення наявності поля SEGMENT -> ( використовується в банку НАДРА )
.head 5 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT count(1)
     INTO :nPar
     FROM ALL_TAB_COLUMNS
    WHERE TABLE_NAME = 'DPU_TYPES'
      AND COLUMN_NAME = 'SEGMENT' ")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If nPar >0 
.head 6 -  Set sSegmentExists = 'Y'
.head 5 +  Else
.head 6 -  Set sSegmentExists = 'N'
.head 5 -  Set sBankType = GetGlobalOption( 'BANKTYPE' )
.head 5 -  Return sBankType
.head 3 +  Function: GenLangFile
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 5 -  Number: nFetchRes 
.head 5 -  File Handle: hFile
.head 5 -  Long String: strText
.head 4 +  Actions
.head 5 -  ! Set strPathToLangResources = GetLangPath()
.head 5 -  ! Set strLangId = GetLang()
.head 5 +  ! If (NOT strLangId)
.head 6 -  Set strLangId = 'UKR'
.head 5 -  ! Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars006.lng"
.head 5 -  Set strFileName = GetPrnDir() || '\\RUS'
.head 5 +  If VisDosExist( strFileName )
.head 6 -  Call SalFileCreateDirectory( strFileName )
.head 5 -  Set strFileName = strFileName || "\\bars006.lng"
.head 5 +  If VisDosExist( strFileName )
.head 6 -  Call VisFileDelete( strFileName )
.head 5 +  If SalMessageBox( 'Create language file?', 'Attention', MB_IconQuestion|MB_YesNo ) = IDYES
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  ! Створення файлу
.head 6 +  If not SalFileOpen(hFile, strFileName, OF_Create | OF_ReadWrite)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalMessageBox( 'Error open file '||strFileName||'!', 'Error', MB_IconStop )
.head 7 -  Return FALSE	
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute( hSql(), 
"SELECT '{'||MSG_CODE||'} {'||UKR_MSG_TEXT||'} {'||RUS_MSG_TEXT||'}'
   INTO :strText
   FROM BARS.DPU_LANGUAGE_MESSAGES
  pivot ( max(MSG_TEXT)   MSG_TEXT 
          for MSG_LANG in ('UKR' as UKR, 'RUS' as RUS) ) ORDER BY MSG_CODE" )
.head 8 -  ! Firt File Line
.head 8 -  Call SalFilePutStr(hFile, 'LangResourceV2RUS')
.head 8 +  While SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SalFilePutStr(hFile, strText)
.head 8 -  Call SalFileClose(hFile)
.head 8 -  Call VisFileSetAttribute(strFileName, FA_ReadOnly, TRUE)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox( 'Creating completed.', 'Attention', MB_IconInformation )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  ! Помилка експорту даних у сценарій
.head 8 -  Call SalFileClose(hFile)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox( 'Error writing to file!', 'Error', MB_IconStop )
.head 8 -  Return FALSE
.head 3 +  Function: ReadLangFile
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFilters
.head 5 -  Number: nIndex
.head 5 -  Number: nRec
.head 5 -  String: sFilters[0:2]
.head 5 -  String: sFileName
.head 5 -  String: sFilePathName
.head 5 -  String: sLine
.head 5 -  String: STR_LIST[*]
.head 5 -  File Handle: hFile
.head 4 +  Actions
.head 5 -  Set sFilters[0] = 'LANG files'
.head 5 -  Set sFilters[1] = 'bars006.lng'
.head 5 -  Set nFilters = 2
.head 5 -  Set nIndex = 1
.head 5 +  If SalDlgOpenFile(hWndForm, 'Open File', sFilters, nFilters, nIndex, sFileName, sFilePathName)
.head 6 +  If VisFileOpen(hFile, sFilePathName, OF_Read) = 0 !! VTERR_Ok
.head 7 -  ! << Імпорт записів із файлу >>
.head 7 -  Call SalWaitCursor( TRUE )
.head 7 +  While VisFileReadString( hFile, sLine ) = 0     !! VTERR_Ok
.head 8 +  If SqlPLSQLCommand(hSql(),'TEST_ARRAY.insert_string(sLine)')
.head 9 -  ! Call SalInvalidateWindow( dlg_ImportCSV )
.head 9 -  ! Call SalUpdateWindow( dfRecN )
.head 8 +  Else
.head 9 -  Call SqlRollback( hSql() )
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Break
.head 7 -  ! ------------------------------------------
.head 7 -  ! Set nRec = 0
.head 7 +  ! While VisFileReadString( hFile, sLine ) = 0     !! VTERR_Ok
.head 8 -  Set STR_LIST[nRec] = sLine
.head 8 -  Set nRec = nRec + 1
.head 7 -  ! Call SaveInfoToLog('TEST_ARRAY.insert_string: Fill Array.' )
.head 7 +  ! If SqlPLSQLCommand(hSql(),'TEST_ARRAY.insert_string(nRec, STR_LIST)')
.head 8 -  ! чистим масив
.head 8 -  ! Call SalArraySetUpperBound( STR_LIST, 1, -1 )
.head 8 -  Call SaveInfoToLog( 'TEST_ARRAY.insert_string: Ok.' )
.head 7 -  ! ------------------------------------------
.head 7 -  Call VisFileClose( hFile )
.head 7 -  Call SqlCommit( hSql() )
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalMessageBox( 'Successfully done!', 'Info', MB_IconStop )
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Незнайдено файл: ' || sFilePathName, 'Увага', MB_IconStop )
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 37876618
0000: 2C03000080010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F61003C00 000B5F005F457272
0040: 6F72426100736556 0100000D003C0000 010DFA0000FF6F0D 00EE0100FF3F1A00
0060: B800000100FFFFE0 2700000001FE00FF 03340000000204F8 000000FF0F380000
0080: 00EE0200FF3F3C00 B800000200FFFF80 40000000030400FE 00FF834400000002
00A0: FB00FF0F48000000 EE0200FF3F4C00B8 00000300FFFFE050 00000003FE00FF83
00C0: 5400000001FB00FF 0F01800D00110001 0000065F005F466C 61671E0000EC0001
00E0: 00D9010D00FF7F01 08801A0000020000 00000B6351756963 6B805461626C6538
0100: 00EC000200D9010D 00FF7F0D73000100 FFFF010180220000 0003000000000A63
0120: 47656E0046696C74 65727400D0000004 00003302040001FA 0000078001000000
0140: FFC60400010DFE00 FF831100000002FB 00FF0F15000000EE 0100FF3F01806622
0160: 0004001A0B474446 697F00F604008E02 000100FE00C98001 0000BF04B100010D
0180: 00FFFFE6110002FE 00FF9B150001FB00 FF0F
.enddata
.head 3 +  Form Window Class: cDocWDpu
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? Class Default
.head 5 -  Initial State: Class Default
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:  
.head 6 -  Top:   
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 78
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: !!!!  m_sTT = 'DU0'
.head 4 +  Derived From
.head 5 -  Class: cDocW
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 +  Contents
.head 6 +  Pushbutton: pbPayDoc
.head 7 -  Class Child Ref Key: 27
.head 7 -  Class ChildKey: 48
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 +  Pushbutton: pbExit
.head 7 -  Class Child Ref Key: 29
.head 7 -  Class ChildKey: 49
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 +  Pushbutton: pbPrtDoc
.head 7 -  Class Child Ref Key: 30
.head 7 -  Class ChildKey: 50
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 -  Line
.head 7 -  Resource Id: 15443
.head 7 -  Class Child Ref Key: 33
.head 7 -  Class ChildKey: 51
.head 7 -  Class: cDocW
.head 7 -  Coordinates
.head 8 -  Begin X:  Class Default
.head 8 -  Begin Y:  Class Default
.head 8 -  End X:  Class Default
.head 8 -  End Y:  Class Default
.head 7 -  Visible? Class Default
.head 7 -  Line Style: Class Default
.head 7 -  Line Thickness: Class Default
.head 7 -  Line Color: Class Default
.head 6 -  Background Text:
.head 7 -  Resource Id: 15444
.head 7 -  Class Child Ref Key: 75
.head 7 -  Class ChildKey: 52
.head 7 -  Class: cDocW
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 6 -  Line
.head 7 -  Resource Id: 15445
.head 7 -  Class Child Ref Key: 34
.head 7 -  Class ChildKey: 53
.head 7 -  Class: cDocW
.head 7 -  Coordinates
.head 8 -  Begin X:  Class Default
.head 8 -  Begin Y:  Class Default
.head 8 -  End X:  Class Default
.head 8 -  End Y:  Class Default
.head 7 -  Visible? Class Default
.head 7 -  Line Style: Class Default
.head 7 -  Line Thickness: Class Default
.head 7 -  Line Color: Class Default
.head 6 -  Line
.head 7 -  Resource Id: 15446
.head 7 -  Class Child Ref Key: 59
.head 7 -  Class ChildKey: 54
.head 7 -  Class: cDocW
.head 7 -  Coordinates
.head 8 -  Begin X:  Class Default
.head 8 -  Begin Y:  Class Default
.head 8 -  End X:  Class Default
.head 8 -  End Y:  Class Default
.head 7 -  Visible? Class Default
.head 7 -  Line Style: Class Default
.head 7 -  Line Thickness: Class Default
.head 7 -  Line Color: Class Default
.head 6 +  Data Field: dfZn
.head 7 -  Class Child Ref Key: 35
.head 7 -  Class ChildKey: 55
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Data
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Class Default
.head 8 -  Editable? Class Default
.head 7 -  Display Settings
.head 8 -  Window Location and Size
.head 9 -  Left:   Class Default
.head 9 -  Top:    Class Default
.head 9 -  Width:  Class Default
.head 9 -  Width Editable? Class Default
.head 9 -  Height: Class Default
.head 9 -  Height Editable? Class Default
.head 8 -  Visible? Class Default
.head 8 -  Border? Class Default
.head 8 -  Justify: Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Font Name: Class Default
.head 8 -  Font Size: Class Default
.head 8 -  Font Enhancement: Class Default
.head 8 -  Text Color: Class Default
.head 8 -  Background Color: Class Default
.head 8 -  Input Mask: Class Default
.head 7 -  Message Actions
.head 6 +  Data Field: dfOst
.head 7 -  Class Child Ref Key: 31
.head 7 -  Class ChildKey: 56
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Data
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Class Default
.head 8 -  Editable? Class Default
.head 7 -  Display Settings
.head 8 -  Window Location and Size
.head 9 -  Left:   Class Default
.head 9 -  Top:    Class Default
.head 9 -  Width:  Class Default
.head 9 -  Width Editable? Class Default
.head 9 -  Height: Class Default
.head 9 -  Height Editable? Class Default
.head 8 -  Visible? Class Default
.head 8 -  Border? Class Default
.head 8 -  Justify: Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Font Name: Class Default
.head 8 -  Font Size: Class Default
.head 8 -  Font Enhancement: Class Default
.head 8 -  Text Color: Class Default
.head 8 -  Background Color: Class Default
.head 8 -  Input Mask: Class Default
.head 7 -  Message Actions
.head 6 +  Pushbutton: pbNewDoc
.head 7 -  Class Child Ref Key: 53
.head 7 -  Class ChildKey: 57
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 +  Pushbutton: pbNewTTs
.head 7 -  Class Child Ref Key: 60
.head 7 -  Class ChildKey: 58
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 +  Pushbutton: pbDocBal
.head 7 -  Class Child Ref Key: 72
.head 7 -  Class ChildKey: 59
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 +  Pushbutton: pbHelp
.head 7 -  Class Child Ref Key: 62
.head 7 -  Class ChildKey: 60
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 +  Pushbutton: pbSaveKor
.head 7 -  Class Child Ref Key: 64
.head 7 -  Class ChildKey: 61
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 +  Pushbutton: pbLocalD
.head 7 -  Class Child Ref Key: 148
.head 7 -  Class ChildKey: 62
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 -  Line
.head 7 -  Resource Id: 15447
.head 7 -  Class Child Ref Key: 77
.head 7 -  Class ChildKey: 63
.head 7 -  Class: cDocW
.head 7 -  Coordinates
.head 8 -  Begin X:  Class Default
.head 8 -  Begin Y:  Class Default
.head 8 -  End X:  Class Default
.head 8 -  End Y:  Class Default
.head 7 -  Visible? Class Default
.head 7 -  Line Style: Class Default
.head 7 -  Line Thickness: Class Default
.head 7 -  Line Color: Class Default
.head 6 +  Pushbutton: pbHotVytyag
.head 7 -  Class Child Ref Key: 138
.head 7 -  Class ChildKey: 64
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 +  Pushbutton: pbHotFio
.head 7 -  Class Child Ref Key: 141
.head 7 -  Class ChildKey: 65
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 +  Pushbutton: pbHotName
.head 7 -  Class Child Ref Key: 137
.head 7 -  Class ChildKey: 66
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 6 +  Pushbutton: pbHotOstat
.head 7 -  Class Child Ref Key: 150
.head 7 -  Class ChildKey: 67
.head 7 -  Class: cDocW
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 4 +  Contents
.head 5 +  Data Field: dfValD1
.head 6 -  Class Child Ref Key: 25
.head 6 -  Class ChildKey: 1
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Combo Box: cmbVob
.head 6 -  Class Child Ref Key: 39
.head 6 -  Class ChildKey: 2
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  String Type: Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Sorted? Class Default
.head 6 -  Always Show List? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  List Initialization
.head 6 -  Message Actions
.head 5 -  Background Text:
.head 6 -  Resource Id: 15440
.head 6 -  Class Child Ref Key: 36
.head 6 -  Class ChildKey: 3
.head 6 -  Class: cDocW
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 +  Data Field: dfNd
.head 6 -  Class Child Ref Key: 23
.head 6 -  Class ChildKey: 4
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfDocD
.head 6 -  Class Child Ref Key: 22
.head 6 -  Class ChildKey: 6
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfBankA
.head 6 -  Class Child Ref Key: 4
.head 6 -  Class ChildKey: 7
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfKvA
.head 6 -  Class Child Ref Key: 50
.head 6 -  Class ChildKey: 8
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfNlsA
.head 6 -  Class Child Ref Key: 2
.head 6 -  Class ChildKey: 9
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfPlat
.head 6 -  Class Child Ref Key: 8
.head 6 -  Class ChildKey: 10
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfNamA
.head 6 -  Class Child Ref Key: 7
.head 6 -  Class ChildKey: 11
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfOkpoA
.head 6 -  Class Child Ref Key: 139
.head 6 -  Class ChildKey: 12
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfPlatB
.head 6 -  Class Child Ref Key: 9
.head 6 -  Class ChildKey: 13
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfNbA
.head 6 -  Class Child Ref Key: 6
.head 6 -  Class ChildKey: 14
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfBankB
.head 6 -  Class Child Ref Key: 13
.head 6 -  Class ChildKey: 15
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfPoluB
.head 6 -  Class Child Ref Key: 18
.head 6 -  Class ChildKey: 16
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfNbB
.head 6 -  Class Child Ref Key: 15
.head 6 -  Class ChildKey: 17
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfKvB
.head 6 -  Class Child Ref Key: 51
.head 6 -  Class ChildKey: 18
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfNlsB
.head 6 -  Class Child Ref Key: 11
.head 6 -  Class ChildKey: 19
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfPolu
.head 6 -  Class Child Ref Key: 17
.head 6 -  Class ChildKey: 20
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfNamB
.head 6 -  Class Child Ref Key: 16
.head 6 -  Class ChildKey: 21
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfOkpoB
.head 6 -  Class Child Ref Key: 140
.head 6 -  Class ChildKey: 22
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfSumNA
.head 6 -  Class Child Ref Key: 135
.head 6 -  Class ChildKey: 23
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfSumA
.head 6 -  Class Child Ref Key: 20
.head 6 -  Class ChildKey: 24
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfSumNB
.head 6 -  Class Child Ref Key: 122
.head 6 -  Class ChildKey: 25
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfSumB
.head 6 -  Class Child Ref Key: 21
.head 6 -  Class ChildKey: 26
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfRatNomN
.head 6 -  Class Child Ref Key: 123
.head 6 -  Class ChildKey: 27
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfRatNom
.head 6 -  Class Child Ref Key: 57
.head 6 -  Class ChildKey: 28
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfSumNC
.head 6 -  Class Child Ref Key: 125
.head 6 -  Class ChildKey: 29
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfSumC
.head 6 -  Class Child Ref Key: 44
.head 6 -  Class ChildKey: 30
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfEquivN
.head 6 -  Class Child Ref Key: 144
.head 6 -  Class ChildKey: 31
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfEquiv
.head 6 -  Class Child Ref Key: 145
.head 6 -  Class ChildKey: 32
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  List Box: lb1
.head 6 -  Class Child Ref Key: 85
.head 6 -  Class ChildKey: 33
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Multiple selection? Class Default
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Horizontal Scroll? Class Default
.head 6 -  List Initialization
.head 6 -  Message Actions
.head 5 +  Multiline Field: dfNazn
.head 6 -  Class Child Ref Key: 24
.head 6 -  Class ChildKey: 34
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  String Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Border? Class Default
.head 7 -  Word Wrap? Class Default
.head 7 -  Vertical Scroll? Class Default
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfSkN
.head 6 -  Class Child Ref Key: 115
.head 6 -  Class ChildKey: 35
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfSk
.head 6 -  Class Child Ref Key: 48
.head 6 -  Class ChildKey: 36
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfValD2N
.head 6 -  Class Child Ref Key: 131
.head 6 -  Class ChildKey: 38
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfValD2
.head 6 -  Class Child Ref Key: 66
.head 6 -  Class ChildKey: 39
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfD
.head 6 -  Class Child Ref Key: 132
.head 6 -  Class ChildKey: 40
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfK
.head 6 -  Class Child Ref Key: 133
.head 6 -  Class ChildKey: 41
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfLocDat
.head 6 -  Class Child Ref Key: 149
.head 6 -  Class ChildKey: 45
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Check Box: cbUgrnt
.head 6 -  Class Child Ref Key: 130
.head 6 -  Class ChildKey: 46
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfVytyagN
.head 6 -  Class Child Ref Key: 142
.head 6 -  Class ChildKey: 47
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfDateFrom
.head 6 -  Class Child Ref Key: 155
.head 6 -  Class ChildKey: 68
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfValD1N
.head 6 -  Class Child Ref Key: 160
.head 6 -  Class ChildKey: 73
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Picture: pic1f
.head 6 -  Class Child Ref Key: 156
.head 6 -  Class ChildKey: 74
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  File Name:
.head 6 -  Storage: Class Default
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Fit: Class Default
.head 6 -  Scaling
.head 7 -  Width:  Class Default
.head 7 -  Height:  Class Default
.head 6 -  Corners: Class Default
.head 6 -  Border Style: Class Default
.head 6 -  Border Thickness: Class Default
.head 6 -  Tile To Parent? Class Default
.head 6 -  Border Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 +  Picture: pic2f
.head 6 -  Class Child Ref Key: 157
.head 6 -  Class ChildKey: 75
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  File Name:
.head 6 -  Storage: Class Default
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Fit: Class Default
.head 6 -  Scaling
.head 7 -  Width:  Class Default
.head 7 -  Height:  Class Default
.head 6 -  Corners: Class Default
.head 6 -  Border Style: Class Default
.head 6 -  Border Thickness: Class Default
.head 6 -  Tile To Parent? Class Default
.head 6 -  Border Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 +  Picture: pic3f
.head 6 -  Class Child Ref Key: 158
.head 6 -  Class ChildKey: 76
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  File Name:
.head 6 -  Storage: Class Default
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Fit: Class Default
.head 6 -  Scaling
.head 7 -  Width:  Class Default
.head 7 -  Height:  Class Default
.head 6 -  Corners: Class Default
.head 6 -  Border Style: Class Default
.head 6 -  Border Thickness: Class Default
.head 6 -  Tile To Parent? Class Default
.head 6 -  Border Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfSub
.head 6 -  Class Child Ref Key: 167
.head 6 -  Class ChildKey: 77
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 5 +  Data Field: dfSubN
.head 6 -  Class Child Ref Key: 166
.head 6 -  Class ChildKey: 78
.head 6 -  Class: cDocW
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Data
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Class Default
.head 7 -  Editable? Class Default
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left:   Class Default
.head 8 -  Top:    Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Border? Class Default
.head 7 -  Justify: Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Input Mask: Class Default
.head 6 -  Message Actions
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sTmpNlsA
.head 5 -  String: sTmpNlsB
.head 5 -  String: sTmpNamA
.head 5 -  String: sTmpNamB
.head 5 -  Number: nKvA_
.head 5 -  Number: nKvB_
.head 5 -  String: sNlsA_
.head 5 -  String: sNlsB_
.head 5 -  String: sNamA_
.head 5 -  String: sNamB_
.head 5 -  ! Номер деп. договору
.head 5 -  Number: nDPUID
.head 4 +  Functions
.head 5 +  Function: oDoc
.head 6 -  Description: Вставить и оплатить документ
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nKvA_ = A.Kv
.head 7 -  Set sTmpNlsA = A.Nls
.head 7 -  Set sTmpNamA = A.Nam
.head 7 -  Set nKvB_ = B.Kv
.head 7 -  Set sTmpNlsB = B.Nls
.head 7 -  Set sTmpNamB = B.Nam
.head 7 +  If NOT f_get_GEN_NLS(dfNlsA, nKvA_, sNlsA_, sNamA_)
.head 8 -  Set sNlsA_ = A.Nls
.head 8 -  Set sNamA_ = A.Nam
.head 7 +  If NOT f_get_GEN_NLS(dfNlsB, nKvB_, sNlsB_, sNamB_)
.head 8 -  Set sNlsB_ = B.Nls
.head 8 -  Set sNamB_ = B.Nam
.head 7 +  ! <<!>>
.head 8 +  ! If NOT SqlPrepareAndExecute(hSql(), "
       SELECT b.nls, substr(c.nmk,1,38) 
         INTO :sNlsA_, :sNamA_ 
         FROM accounts a, accounts b, cust_acc cb, customer c
        WHERE a.nls = :dfNlsA 
          AND a.kv = :nKvA_ 
          AND a.accc = b.acc 
          AND nvl(substr(a.nbs,1,1),0) IN ('0','8')
          AND cb.acc = b.acc 
          AND cb.rnk = c.rnk ")
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sNlsA_ = A.Nls
.head 9 -  Set sNamA_ = A.Nam
.head 8 +  ! If NOT SqlPrepareAndExecute(hSql(), "
       SELECT b.nls, substr(c.nmk,1,38) 
         INTO :sNlsB_, :sNamB_
         FROM accounts a, accounts b, cust_acc cb, customer c
        WHERE a.nls = :dfNlsB 
          AND a.kv = :nKvB_ 
          AND a.accc = b.acc 
          AND nvl(substr(a.nbs,1,1),0) IN ('0','8')
          AND cb.acc = b.acc 
          AND cb.rnk = c.rnk ")
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set sNlsB_ = B.Nls
.head 9 -  Set sNamB_ = B.Nam
.head 7 +  If cDoc.oDoc()
.head 8 -  Call f_set_REF2HISTORY()
.head 8 -  Return TRUE
.head 7 -  Return FALSE
.head 5 +  Function: iDoc
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set A.Nls = sNlsA_
.head 7 -  Set B.Nls = sNlsB_
.head 7 -  Set A.Nam = sNamA_
.head 7 -  Set B.Nam = sNamB_
.head 7 +  ! <<!>>
.head 8 -  ! Set A.Nls = sTmpNlsA
.head 8 -  ! Set B.Nls = sTmpNlsB
.head 8 -  ! Set A.Nam = sTmpNamA
.head 8 -  ! Set B.Nam = sTmpNamB
.head 7 -  Return cDoc.iDoc()
.head 5 +  ! Function: sDoc
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set A.Nls = sNlsA_
.head 7 -  Set B.Nls = sNlsB_
.head 7 -  Set A.Nam = sNamA_
.head 7 -  Set B.Nam = sNamB_
.head 7 +  If NOT cDoc.sDoc()
.head 8 -  Return FALSE
.head 7 -  Set A.Nls = sTmpNlsA
.head 7 -  Set B.Nls = sTmpNlsB
.head 7 -  Set A.Nam = sTmpNamA
.head 7 -  Set B.Nam = sTmpNamB
.head 7 -  Return TRUE
.head 5 +  Function: f_get_GEN_NLS
.head 6 -  Description: Пошук рахунків генерального договору
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sNLS
.head 7 -  Number: nKV
.head 7 -  Receive String: sNLS_GEN
.head 7 -  Receive String: sNMK_GEN
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalStrMidX(sNLS, 0, 1) = '8'
.head 8 +  If NOT SqlPrepareAndExecute( hSql(),
"SELECT  a.nls, substr(c.nmk,1,38)
   INTO  :sNLS_GEN, :sNMK_GEN
   FROM  V_DPU_RELATION_ACC d,  ACCOUNTS a,  CUSTOMER c 
  WHERE  d.DEP_ACC = (SELECT ACC FROM ACCOUNTS WHERE NLS = :sNLS AND KV = :nKV)
    AND  d.gen_acc = a.acc
    AND  a.rnk = c.rnk " )
OR NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Return FALSE
.head 8 +  Else
.head 9 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: f_set_REF2HISTORY
.head 6 -  Description: Запис РЕФ. документа в історію платежів по Депозитному договору
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SqlPLSQLCommand( hSql(), "DPU.FILL_DPU_PAYMENTS( nDPUID, m_nRef )" )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 4 -  Message Actions
.head 3 +  Functional Class: cDocDpu
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cDoc
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sTmpNlsA
.head 5 -  String: sTmpNlsB
.head 5 -  String: sTmpNamA
.head 5 -  String: sTmpNamB
.head 5 -  Number: nKvA_
.head 5 -  Number: nKvB_
.head 5 -  String: sNlsA_
.head 5 -  String: sNlsB_
.head 5 -  String: sNamA_
.head 5 -  String: sNamB_
.head 5 -  ! доп реквизиты
.head 5 -  String: aTag[*]
.head 5 -  String: aVal[*]
.head 5 -  String: aVsp[*]     ! Код вспомогат реквизита в СЕП
.head 5 -  ! Номер деп. договору
.head 5 -  Number: nDPUID
.head 4 +  Functions
.head 5 +  Function: oDoc
.head 6 -  Description: Вставить и оплатить документ
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nKvA_ = A.Kv
.head 7 -  Set sTmpNlsA = A.Nls
.head 7 -  Set sTmpNamA = A.Nam
.head 7 -  Set nKvB_ = B.Kv
.head 7 -  Set sTmpNlsB = B.Nls
.head 7 -  Set sTmpNamB = B.Nam
.head 7 +  If NOT f_get_GEN_NLS( sTmpNlsA, nKvA_, sNlsA_, sNamA_)
.head 8 -  Set sNlsA_ = A.Nls
.head 8 -  Set sNamA_ = A.Nam
.head 7 +  If NOT f_get_GEN_NLS( sTmpNlsB, nKvB_, sNlsB_, sNamB_)
.head 8 -  Set sNlsB_ = B.Nls
.head 8 -  Set sNamB_ = B.Nam
.head 7 +  If cDoc.oDoc()
.head 8 -  Call f_set_REF2HISTORY()
.head 8 -  Return TRUE
.head 7 -  Return FALSE
.head 5 +  Function: iDoc
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set A.Nls = sNlsA_
.head 7 -  Set A.Nam = sNamA_
.head 7 -  Set B.Nls = sNlsB_
.head 7 -  Set B.Nam = sNamB_
.head 7 -  Set m_sDrec = iVspReq()
.head 7 -  Return cDoc.iDoc()
.head 5 +  Function: iDop
.head 6 -  Description: Вставить доп реквизиты
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTmp1
.head 7 -  String: sTmp2
.head 7 -  Number: i
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( aTag )
.head 8 -  Call SalArrayGetUpperBound( aTag, 1, i )
.head 8 +  While i >= 0
.head 9 +  If SalStrTrimX(aVal[i])
.head 10 -  Set sTmp1=aTag[i]
.head 10 -  Set sTmp2=aVal[i]
.head 10 +  If not SqlPrepareAndExecute( hSql(),T("INSERT INTO Operw (ref,tag,value ) VALUES  (:m_nRef, :sTmp1, :sTmp2 ) " )  )
.head 11 -  Return FALSE
.head 9 -  Set i=i-1
.head 7 -  Return TRUE
.head 5 +  Function: iVspReq       ! Создать вспомогат реквизиты СЕП
.head 6 -  Description: Вставить доп реквизиты
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTmp
.head 7 -  String: strMT
.head 6 +  Actions
.head 7 -  Set sTmp=''
.head 7 +  If strMT   ! Default SWIFT MT
.head 8 -  Set sTmp='#f'||SalStrTrimX(strMT)
.head 7 +  If not SalArrayIsEmpty( aTag )
.head 8 -  Call SalArrayGetUpperBound( aTag, 1, i )
.head 8 +  While i>0
.head 9 +  If SalStrTrimX(aVsp[i]) and SalStrTrimX(aVal[i]) and
   SalStrTrimX(aVsp[i])!='F' and SalStrTrimX(aVsp[i])!='П' and SalStrTrimX(aVsp[i])!='C'
.head 10 -  Set sTmp=sTmp||'#'||SalStrLeftX(SalStrTrimX(aVsp[i]),1)||SalStrTrimX(aVal[i])
.head 9 -  Set i=i-1
.head 7 +  If sTmp
.head 8 -  Set sTmp=sTmp||'#'
.head 7 -  Return sTmp
.head 5 +  ! Function: sDoc
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set A.Nls = sNlsA_
.head 7 -  Set A.Nam = sNamA_
.head 7 -  Set B.Nls = sNlsB_
.head 7 -  Set B.Nam = sNamB_
.head 7 +  If NOT cDoc.sDoc()
.head 8 -  Return FALSE
.head 7 -  Set A.Nls = sTmpNlsA
.head 7 -  Set A.Nam = sTmpNamA
.head 7 -  Set B.Nls = sTmpNlsB
.head 7 -  Set B.Nam = sTmpNamB
.head 7 -  Return TRUE
.head 5 +  Function: f_get_GEN_NLS
.head 6 -  Description: Пошук рахунків генерального договору
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sNLS
.head 7 -  Number: nKV
.head 7 -  Receive String: sNLS_GEN
.head 7 -  Receive String: sNMK_GEN
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nFetchRes
.head 6 +  Actions
.head 7 +  If SalStrMidX(sNLS, 0, 1) = '8'
.head 8 -  ! If NOT SqlPrepareAndExecute(hSql(), "
       SELECT b.nls, substr(c.nmk,1,38) 
         INTO :sNlsA_, :sNamA_
         FROM accounts a, accounts b, cust_acc cb, customer c
        WHERE a.nls = :sTmpNlsA 
          AND a.kv = :nKvA_ 
          AND a.accc = b.acc 
          AND nvl(substr(a.nbs,1,1),0) IN ('0','8') 
          AND cb.acc = b.acc 
          AND cb.rnk = c.rnk ")
OR NOT SqlFetchNext(hSql(), nFetchRes)
.head 8 -  ! Старий запит для рахунків зв'язаних по (acc = accc)
.head 8 +  If NOT SqlPrepareAndExecute( hSql(),
"SELECT a.nls, substr(c.nmk,1,38)
   INTO :sNLS_GEN, :sNMK_GEN
   FROM V_DPU_RELATION_ACC d,  ACCOUNTS a,  CUSTOMER c 
  WHERE d.DEP_ACC = (SELECT ACC FROM ACCOUNTS WHERE NLS = :sNLS AND KV = :nKV)
    AND d.gen_acc = a.acc
    AND a.rnk = c.rnk " )
OR NOT SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Return FALSE
.head 8 +  Else
.head 9 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: f_set_REF2HISTORY
.head 6 -  Description: Запис РЕФ. документа в історію платежів по Депозитному договору
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SqlPLSQLCommand( hSql(), "DPU.FILL_DPU_PAYMENTS( nDPUID, m_nRef )" )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 3 +  Functional Class: cDPU
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nDPUID
.head 5 -  Number: nRNK
.head 5 -  Number: nVIDD
.head 5 -  Number: nSUM
.head 5 -  Number: nMINSUM
.head 5 -  Number: nFREQ
.head 5 -  Number: nIR
.head 5 -  Number: nBRID
.head 5 -  Number: nCOMPROC
.head 5 -  Number: nSTOPID
.head 5 -  Number: nTRUST_ID
.head 5 -  Number: nISP
.head 5 -  Number: nDPUGEN
.head 5 -  Number: nDPUADD
.head 5 -  Date/Time: dDATZ         !! dfDATZ
.head 5 -  Date/Time: dDATBEG  !! dfDATN
.head 5 -  Date/Time: dDATEND  !! dfDATO
.head 5 -  Date/Time: dDATRET  !! dfDATV
.head 5 -  String: sND
.head 5 -  String: sBRANCH
.head 5 -  String: sCOMMENT
.head 5 -  : PayDetIINT
.head 6 -  Class: cPaymentDetails
.head 5 -  : PayDetIDEP
.head 6 -  Class: cPaymentDetails
.head 4 +  Functions
.head 5 +  Function: OpenDeal
.head 6 -  Description: Відкриття депозитного договору
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 -  Actions
.head 5 +  Function: UpdateDeal
.head 6 -  Description: Оновлення параметрів депозитного договору
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SqlPLSQLCommand( hSql(), "
   dpu.upd_dealparams ( nDPUID, 
                                                 sND, 
                                                 nSUM * 100,  
                                                 nMINSUM * 100, 
                                                 nFREQ,  
                                                 nSTOPID,  
                                                 dDATZ,           
                                                 dDATBEG, 
                                                 dDATEND, 
                                                 dDATRET,
                                                 PayDetIDEP.MFO,
                                                 PayDetIDEP.NLS,  
                                                 PayDetIDEP.NMS,
                                                 PayDetIINT.MFO,
                                                 PayDetIINT.NLS, 
                                                 PayDetIINT.NMS,
                                                 PayDetIINT.OKPOP,
                                                 nIR, 
                                                 nOPID,  
                                                 nBRID,
                                                 dBRDAT, 
                                                 sBRANCH,  
                                                 nTRUSTID,
                                                 sCOMMENT ) " )
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Open.cUpdDealDone'), 
                                            CurrentLangTable.GetAtomTitle('cTInfo'), 
                                            MB_IconInformation )
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Return FALSE
.head 5 +  Function: PopulateDeal
.head 6 -  Description: Населення параметрами депозитного договору
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 -  Actions
.head 5 -  !
.head 5 -  !
.head 5 +  Function: get_DPUID
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nDPUID
.head 5 +  Function: set_DPUID
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nDPUID = nVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_RNK
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nRNK
.head 5 +  Function: set_RNK
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRNK = nVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_VIDD
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nVIDD
.head 5 +  Function: set_VIDD
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nVIDD = nVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_SUM
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nSUM
.head 5 +  Function: set_SUM
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nSUM = nVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_MINSUM
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nMINSUM
.head 5 +  Function: set_MINSUM
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nMINSUM = nVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_FREQ
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nFREQ
.head 5 +  Function: set_FREQ
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nFREQ = nVAL
.head 7 -  Return TRUE
.head 5 -  ! date
.head 5 +  Function: get_DATZ
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dDATZ
.head 5 +  Function: set_DATZ
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dDATZ = dVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_DATBEG
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dDATBEG
.head 5 +  Function: set_DATBEG
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dDATBEG = dVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_DATEND
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dDATEND
.head 5 +  Function: set_DATEND
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dDATEND = dVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_DATRET
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return dDATRET
.head 5 +  Function: set_DATRET
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Date/Time: dVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set dDATRET = dVAL
.head 7 -  Return TRUE
.head 5 -  ! string
.head 5 +  Function: get_ND
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sND
.head 5 +  Function: set_ND
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sND = sVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_BRANCH
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sBRANCH
.head 5 +  Function: set_BRANCH
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sBRANCH = sVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_COMMENT
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sCOMMENT
.head 5 +  Function: set_COMMENT
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sCOMMENT = sVAL
.head 7 -  Return TRUE
.head 3 +  Functional Class: cPaymentDetails
.head 4 -  Description: Платіжні ревізити (МФО / № рах. / Назва / ОКПО )
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sMFO
.head 5 -  String: sNLS
.head 5 -  String: sNMS
.head 5 -  String: sOKPO
.head 4 +  Functions
.head 5 +  Function: get_MFO
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sMFO
.head 5 +  Function: set_MFO
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sMFO = sVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_NLS
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNLS
.head 5 +  Function: set_NLS
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNLS = sVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_NMS
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sNMS
.head 5 +  Function: set_NMS
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNMS = sVAL
.head 7 -  Return TRUE
.head 5 +  Function: get_OKPO
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sOKPO
.head 5 +  Function: set_OKPO
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sVAL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sOKPO = sVAL
.head 7 -  Return TRUE
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field: cFieldLabel
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbSwitch
.head 3 -  Radio Button: cRadioButtonLabeled
.head 3 -  Option Button:
.head 3 -  Check Box: cCheckBoxLabeled
.head 3 -  Child Table: cQuickTable
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box: cQuickGroupBox
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cQuickGraph
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
.head 1 +  Table Window: DPU_DEAL
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Депозитный портфель Юр.Лиц
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  16.183"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.69"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? No
.head 2 -  Description: Депозитный портфель Юр.Лиц
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Открыть новый договор"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_DEAL.cBTipIns')
.head 6 +  On SAM_Click
.head 7 -  ! If SalMessageBox('Вы действительно хотите открыть новый договор?', 'Внимание', MB_IconQuestion|MB_YesNo) = IDYES
.head 7 +  If sBankType = 'PRVX'
.head 8 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_DEAL.cTMessOpen'), 
                 CurrentLangTable.GetAtomTitle('cTAt'), 
                 MB_IconQuestion|MB_YesNo) = IDYES
.head 9 -  Set sChooseVidD = STRING_Null
.head 9 -  Set sChooseVidN = STRING_Null
.head 9 -  Call FunNSIGetFiltered(
     "DPU_VIDD", 
     "NAME",
     " flag = 1", 
      sChooseVidD, 
      sChooseVidN)
.head 9 +  If sChooseVidD != STRING_Null
.head 10 +  If not IsWindow(hWin4)
.head 11 -  Set hWin4 = SalCreateWindow(frm_OpenM, hWndMDI, hWndForm, 
                            nMode, Val(sChooseVidD), 0, 1,  nISP, nGrp, NUMBER_Null)
.head 10 +  Else
.head 11 -  Call SalBringWindowToTop(frm_OpenM)
.head 9 +  Else
.head 10 -  ! Call SalMessageBox('Не выбран вид депозитного договора!', 'Внимание', MB_IconHand)
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_DEAL.cTMessVidd'), 
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_IconHand)
.head 7 +  Else
.head 8 +  If not IsWindow(hWin4)
.head 9 -  Set hWin4 = SalCreateWindow(frm_Open, hWndMDI, hWndForm, nMode, NUMBER_Null, NUMBER_Null, nISP, nGrp, nSegment)
.head 8 +  Else
.head 9 -  ! Call SalBringWindowToTop(frm_Open)
.head 9 -  Call SalDestroyWindow ( frm_Open )
.head 9 -  Set hWin4 = SalCreateWindow(frm_Open, hWndMDI, hWndForm, nMode, NUMBER_Null, NUMBER_Null, nISP, nGrp, nSegment)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.514"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Закрыть договор"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_DEAL.cBTipDel')
.head 6 +  On SAM_Click
.head 7 -  Call f_closedeal()
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.943"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On VTM_RightClick
.head 7 -  Call XSalTooltipShow( pbRefresh, DPU_DEAL.strFilterTblName )

.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.371"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 38827
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  9.183"
.head 6 -  Begin Y:  0.01"
.head 6 -  End X:  9.183"
.head 6 -  End Y:  0.41"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.043"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.471"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.9"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 38828
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.483"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  3.483"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Параметры договора"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_DEAL.cBTipDetails')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull( DPU_ID )
.head 8 -  ! Правекс
.head 8 +  If sBankType = 'PRVX'
.head 9 +  If not IsWindow(hWin5)
.head 10 -  Set hWin5 = SalCreateWindow( frm_OpenM, hWndMDI, hWndForm, 
                            nMode, VIDD, DPU_ID, 0, nISP, nGrp, IifN(DPU_GEN = DPU_ID, NUMBER_Null, DPU_GEN) )
.head 9 +  Else
.head 10 -  Call SalBringWindowToTop(frm_OpenM)
.head 8 -  ! Ощад / Надра
.head 8 +  ! Else If sBankType = 'SBER'
.head 9 +  If not IsWindow(hWin5)
.head 10 -  Set hWin5 = SalCreateWindow( frm_CreateDeal, hWndMDI, hWndForm, nMode, DPU_ID, DPU_GEN, nISP, nGrp,  nSegment )
.head 9 +  Else 
.head 10 -  Call SalBringWindowToTop( frm_CreateDeal )
.head 8 +  Else
.head 9 +  If not IsWindow(hWin5)
.head 10 -  Set hWin5 = SalCreateWindow( frm_Open, hWndMDI, hWndForm, nMode, DPU_ID, DPU_GEN, nISP, nGrp,  nSegment )
.head 9 +  Else
.head 10 -  Call SalBringWindowToTop(frm_Open)
.head 8 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 6 +  On VTM_RightClick
.head 7 +  If not IsWindow(hWin5)
.head 8 -  Set hWin5 = SalCreateWindow( frm_CreateDeal, hWndMDI, hWndForm, nMode, DPU_ID, DPU_GEN, nISP, nGrp,  nSegment )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( frm_CreateDeal )
.head 4 +  Pushbutton: pbSos
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.15"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Docview.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Текущее состояние договора"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_DEAL.cBTipSos')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull( DPU_ID )
.head 8 +  If not IsWindow(hWin6)   
.head 9 -  Set hWin6= SalCreateWindow(frm_Dog, hWndMDI, nMode,
                           DPU_DEAL.DPU_ID, DPU_DEAL.ND,      
                           DPU_DEAL.DPU_GEN,DPU_DEAL.DPU_AD,
                           DPU_DEAL.NMK,    DPU_DEAL.KV,      DPU_DEAL.NAMEV,
                           DPU_DEAL.FREQV,  DPU_DEAL.VIDD,    DPU_DEAL.NAME,   
                           DPU_DEAL.SUM,    DPU_DEAL.ID_STOP, DPU_DEAL.MIN_SUM, 
                           DPU_DEAL.DATZ,   DPU_DEAL.DATN,
                           DPU_DEAL.DATO,   DPU_DEAL.DATV,
                           DPU_DEAL.MFOD,   DPU_DEAL.ACCD,    DPU_DEAL.NMSD)
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop( frm_Dog )
.head 4 +  Pushbutton: pbProc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.05"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Начислить %% по ВСЕМУ портфелю"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'DPU_DEAL.cBTipProc' )
.head 6 +  On SAM_Click
.head 7 +  If ( SalMessageBox( CurrentLangTable.GetAtomTitle( 'DPU_DEAL.cBTipProc' ) || "?",
                                         CurrentLangTable.GetAtomTitle( 'cTAt' ),
                                         MB_IconQuestion | MB_YesNo) = IDYES )
.head 8 +  ! If (F_GET_BANK_DATE() != DATETIME_Null)
.head 9 -  ! нарахування %% в перший роб. день за остан. роб. день попереднього місяця
.head 9 -  Call SaveInfoToLog( CurrentLangTable.GetAtomTitle( 'DPU_DEAL.cTMessAccrualInterestStart' ) )
.head 8 -  Call SalWaitCursor( TRUE )
.head 8 -  Call SaveInfoToLog( CurrentLangTable.GetAtomTitle( 'DPU_DEAL.cTMessAccrualInterestStart' ) )
.head 8 +  If ( F_ACCRUAL_INTEREST_MONTHLY( F_GET_BANK_DATE() ) )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'DPU_DEAL.cTMessAccrualInterestDone' ), 
                                            CurrentLangTable.GetAtomTitle( 'cTInfo' ), 
                                            MB_IconInformation )
.head 9 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 8 +  Else
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'DPU_DEAL.cTErrAccrualInterest' ), 
                                            CurrentLangTable.GetAtomTitle( 'cTErr' ),
                                            MB_IconStop )
.head 8 -  Call SalWaitCursor( FALSE )
.head 7 +  Else
.head 8 -  Call SaveInfoToLog( CurrentLangTable.GetAtomTitle( 'DPU_DEAL.cTMessAccrualInterestCancel' ) )
.head 7 +  ! << Нарахування %% по старому (центурове вікно) >>
.head 8 -  ! Set sTmp = " AND s.acc IN (SELECT da.accid FROM dpt_u, dpu_accounts da WHERE dpt_u.dpu_id = da.dpuid "
||IifS(UseDpuLine() = 'P',         " AND nvl(dpt_u.dpu_add,99) != 0 ", " ")
||IifS(sFilter     != STRING_Null, "  AND " ||sFilter,             " ")
||IifS(sFlt_Outer  != STRING_Null, "  AND " ||sFlt_Outer,          " ")||" )"
.head 8 -  ! Call Sel010( hWndMDI, 0, 0, sTmp, UseDpuLine() )
.head 4 +  Pushbutton: pbPAY
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSort
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.5"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Currconv.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Выплатить %% по ВСЕМУ портфелю"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_DEAL.cBTipPAY')
.head 6 +  On SAM_Click
.head 7 -  ! Set sTmp = " AND d.acc IN (SELECT acc FROM dpt_u  WHERE nvl(dpu_add,99)<>0 "||
             IifS(   sFilter!=STRING_Null,"  AND " || sFilter,"  " )||
             IifS(sFlt_Outer!=STRING_Null,"  AND " || sFlt_Outer,"  " )||" )"
.head 7 +  If sFilter != STRING_Null OR sFlt_Outer != STRING_Null
.head 8 -  Set sTmp = " AND deal_id IN (SELECT dpu_id FROM dpt_u WHERE "
         ||IifS(sFilter   = STRING_Null, " 1=1 ", sFilter)
         ||IifS(sFlt_Outer = STRING_Null, " ",    " AND "||sFlt_Outer)
         || ")"
.head 7 +  Else
.head 8 -  Set sTmp = STRING_Null
.head 7 -  Call SalCreateWindow(AcrPay, hWndMDI, nMode, 0, sTmp)
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 38829
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.9"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  1.9"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbGraf
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.3"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Chart.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Графики"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_DEAL.cBTipGraf')
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow( frm_Graf, hWndForm )
.head 4 +  Pushbutton: pbAccounts
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSort
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 -  ! Перегляд рахунків договору
.head 6 +  On SAM_Create
.head 7 -  ! Табличная форма счетов депозита
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipAccounts')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(DPU_DEAL.DPU_ID)
.head 8 -  ! Всі рахунки по ГЕНЕРАЛЬНОМУ договору
.head 8 +  If DPU_DEAL.DPU_ID = DPU_DEAL.DPU_GEN
.head 9 -  ! !If wParam=0x2d      ! VK_Insert  !!If KDS_Ctrl = 2
.head 9 -  Call ShowAccList(DPU_DEAL.RNK, 
                 AVIEW_CUST,
                 AVIEW_Financial|
                 AVIEW_Linked   |
                 AVIEW_Limit    |
                 AVIEW_Special  |
                 AVIEW_Blocked  |
                 AVIEW_Interest |
                 AVIEW_ReadOnly,
                 " a.acc in (SELECT accid FROM dpu_accounts WHERE dpuid = " || Str(DPU_DEAL.DPU_ID) ||
                 " OR dpuid IN (select dpu_id from dpu_deal where dpu_gen = " || Str(DPU_DEAL.DPU_ID) || ") )" )
.head 8 -  ! Рахунки поточної угоди
.head 8 +  Else
.head 9 -  Call ShowAccList(DPU_DEAL.RNK, 
                 AVIEW_CUST,
                 AVIEW_Financial|
                 AVIEW_Linked   |
                 AVIEW_Limit    |
                 AVIEW_Special  |
                 AVIEW_Blocked  |
                 AVIEW_Interest |
                 AVIEW_ReadOnly,
                 " a.acc in (SELECT accid FROM dpu_accounts WHERE dpuid = "||Str(DPU_DEAL.DPU_ID)||")")
.head 8 -  ! Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 4 -  Line
.head 5 -  Resource Id: 22464
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  6.1"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  6.1"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 17381
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  8.4"
.head 6 -  Begin Y:  0.01"
.head 6 -  End X:  8.4"
.head 6 -  End Y:  0.42"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbShowClosed
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh 
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.8"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_CLSD.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Periwinkle
.head 5 +  Message Actions
.head 6 +  ! On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Показать Открытые/Закрытые договора КП' )
.head 6 +  On SAM_Create
.head 7 -  ! "Показати зариті угоди"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_DEAL.cBTipShowClosed')
.head 6 +  On SAM_Click
.head 7 +  If bShowClosed = 0
.head 8 -  Set bShowClosed = 1
.head 7 +  Else
.head 8 -  Set bShowClosed = 0
.head 7 -  Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Data Field: dfKtDEAL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.3"
.head 7 -  Top:    0.09"
.head 7 -  Width:  1.483"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Кількість відібраних договорів' )
.head 4 +  Pushbutton: pbShowPledged
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.3"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: D:\BARS98\RESOURCE\BMP\LINKED.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Перегляд депозитів переданих в заставу по кредиту
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'DPU_DEAL.cBTipShowPledged' )
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow( DPU_PLEDGED, hWndMDI, "CRD", NUMBER_Null )
.head 4 +  Pushbutton: pbChkDifBal
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.8"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CHEKIN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Перевірка розходжень у залишках траншів та рах. ген. дог. деп. лінії
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'DPU_DEAL.cBTipChkDifBal' )
.head 6 +  On SAM_Click
.head 7 -  ! Call SalCreateWindow( DPU_PLEDGED, hWndMDI, "CRD", NUMBER_Null )
.head 7 -  Call SalMessageBox ( f_DISCREPANCY_BALANCES(), 'DEBUG ('||sDptBankType||')', MB_Ok )
.head 2 +  Contents
.head 3 +  Column: DPU_GEN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
ген.
дог.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
деп.
дог.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_AD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
доп.
согл.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
депоз.
дог.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
РНК
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
КЛИЕНТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код ОКПО 
клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Вал
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAMEV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Вал
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DIG валюты
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Депозитный
счет
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmp = NLS
.head 5 +  On SAM_AnyEdit
.head 6 -  Set NLS = sTmp
.head 6 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
.head 3 +  Column: SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Общая
сумма
по договору
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUMQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Общая
сумма(Экв)
по договору
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PROC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
ставка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cумма
на счете
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSTN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cумма
начисл.
%%
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OST_PL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cумма
на счете
депозита
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSTQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cумма
на счете(Экв)
депозита
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACCN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DIG валюты
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Вид договора
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nFREQN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Периодичность
выплаты %%
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FREQN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Периодичность
начисления %%
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nFREQV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Периодичность
погашения
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  2.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FREQV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Периодичность
погашения
%%
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заключения
договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
размещения
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd.MM.yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
окончания
договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
возврата
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd.MM.yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TERM_MONTHS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Срок
дог.
в мес.
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: #0
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TERM_DAYS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Срок 
дог.в 
днях
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.683"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: #0
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
підрозділу
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.033"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО 
перечисл.
%%
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исп
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACCP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет для
перечисл.
%%
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование получателя %%
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
возврата
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACCD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
возврата
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование получателя депозита
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FL_ADD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ID_STOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код штрафа
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MIN_SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BLKD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: f_closedeal
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sFullDealNum
.head 5 -  String: sFullDealNumGen
.head 5 -  String: sErrMsg
.head 5 -  Number: nFetchRes
.head 5 -  Number: nMinRow
.head 4 +  Actions
.head 5 -  Set nMinRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(DPU_DEAL, nMinRow, ROW_Selected, 0)
.head 6 -  Call SalTblSetContext(DPU_DEAL, nMinRow) 
.head 6 +  If DPU_DEAL.DPU_AD > 0 
.head 7 -  ! Доп.соглашение № ... к договору №...
.head 7 -  Set sFullDealNum = CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle21')
                 || ' ' || Str(DPU_DEAL.DPU_AD)
                 || ' ' || CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle2_')
                 || ' ' || DPU_DEAL.ND
.head 7 -  ! Доп.соглашения № ... к договору №...
.head 7 -  Set sFullDealNumGen = CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle2G')
                 || ' ' || Str(DPU_DEAL.DPU_AD)
                 || ' ' || CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle2_')
                 || ' ' || DPU_DEAL.ND
.head 6 +  Else
.head 7 -  ! Депозитный договор № .../Депозитний договір №...
.head 7 -  Set sFullDealNum = CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle1')||DPU_DEAL.ND
.head 7 -  ! Депозитного договора №...
.head 7 -  Set sFullDealNumGen = CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle1G')||DPU_DEAL.ND
.head 6 -  ! Вы действительно хотите закрыть sFullDealNum>?
.head 6 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('DPU_DEAL.cTMessClose') || ' ' || sFullDealNum || '?', 
                  CurrentLangTable.GetAtomTitle('cTAt'), 
                  MB_IconQuestion|MB_YesNo ) = IDYES
.head 7 +  If SqlPLSQLCommand(hSql(), "dpu.close_deal( DPU_DEAL.DPU_ID, sErrMsg )" )
.head 8 +  If ( sErrMsg = STRING_Null )
.head 9 -  Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('DPU_DEAL.cTMessCloseOk')||' '||sFullDealNumGen)
.head 8 +  Else
.head 9 -  Call SqlRollbackEx(hSql(), sErrMsg )
.head 9 -  ! Call SalMessageBox( sErrMsg
                  , CurrentLangTable.GetAtomTitle( 'cTErr' )
                  , MB_IconStop )
.head 7 +  Else
.head 8 -  Call SqlRollbackEx(hSql(), CurrentLangTable.GetAtomTitle('DPU_DEAL.cTMessCloseErr')||' '||sFullDealNumGen)
.head 5 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 3 +  Function: f_DISCREPANCY_BALANCES
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Long String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Long String: sText
.head 4 +  Actions
.head 5 -  Call SqlSetLongBindDatatype(1, 22)
.head 5 +  If SqlPrepareAndExecute( hSql(),
"SELECT dpu.get_discrepancy_balances(null)
   INTO :sText
   FROM dual
" ) AND SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If sText != STRING_Null
.head 7 -  Return sText
.head 6 +  Else
.head 7 -  Return 'РОЗБІЖНОСТЕЙ В ЗАЛИШКАХ НЕ ВИЯВЛЕНО !'
.head 5 +  Else
.head 6 -  Return 'ПОШУК НЕВДАВСЯ !'
.head 3 +  Function: F_ACCRUAL_INTEREST_MONTHLY
.head 4 -  Description: Нарахування %% по ДЕПОЗИТНОМУ ПОРТФЕЛЮ в кінці місяця
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Date/Time: dBankDate
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPLSQLCommand( hSql(), "dpu.auto_make_interest( 0, dBankDate )" )
.head 6 -  Call SqlCommit( hSql() )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Call SqlRollback( hSql() )
.head 6 -  Return FALSE
.head 3 +  Function: F_GET_BANK_DATE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSqlText
.head 5 -  Number: nFetchRes
.head 5 -  Date/Time: dResult
.head 4 +  Actions
.head 5 -  Set sSqlText = "select case 
         when ( bars.gl.gbd = BARS.DAT_NEXT_U(trunc(sysdate), 0)   -- first_work_day_cur_mon
            and bars.gl.bd  = BARS.DAT_NEXT_U(trunc(sysdate),-1) ) -- last_work_day_prev_mon
         then bars.gl.bd
         else null
       end as BANK_DT
  into :dResult from dual"
.head 5 +  If SqlPrepareAndExecute( hSql(), sSqlText ) AND NOT SqlFetchNext(hSql(), nFetchRes) 
.head 6 -  Set dResult = DATETIME_Null
.head 5 -  Return dResult
.head 2 +  Window Parameters
.head 3 -  ! nMode=1 - инспектор, nMode=2 - бухгалтер
.head 3 -  Number: nMode
.head 3 -  ! Сегмент бізнесу (для БАНКУ НАДРА)
.head 3 -  Number: nSegment
.head 3 -  ! Группа доступа, в которую попадают открываемые счета
.head 3 -  String: sPar01
.head 3 -  String: sFlt_Outer
.head 2 +  Window Variables
.head 3 -  ! На какого исп.открывать счета
.head 3 -  Number: nISP
.head 3 -  Number: nFetchRes
.head 3 -  String: sTmp
.head 3 -  String: sFilter
.head 3 -  Date/Time: dDATA
.head 3 -  Number: nGrp
.head 3 -  String: sTT
.head 3 -  String: sNAZN
.head 3 -  !
.head 3 -  Number: nColGen !! к-ть генеральних/стандартних договорів
.head 3 -  Number: nColAdd !! к-ть додаткових угод
.head 3 -  Number: nSumQ
.head 3 -  Number: nOstQ
.head 3 -  Number: nSt
.head 3 -  Number: nDID
.head 3 -  String: sChooseVidD
.head 3 -  String: sChooseVidN
.head 3 -  Boolean: bShowClosed
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! По замовчуванню не показуєм закриті договора
.head 4 -  Set bShowClosed = 0
.head 4 -  Call SalHideWindow( pbShowClosed )
.head 4 -  ! <<<< Пошук коду користувача для відкриття рахунків >>>>
.head 4 +  If SqlPrepareAndExecute( hSql(), "SELECT nvl((select ISP from DPT_STAFF where USERID = USER_ID), USER_ID) INTO :nISP FROM DUAL")
.head 5 -  Call SqlFetchNext ( hSql(), nFetchRes )
.head 4 -  ! Запуск з правами бухгалтера
.head 4 +  If nMode=2
.head 5 -  Call SalDisableWindow( pbIns )
.head 5 -  Call SalDisableWindow( pbDel )
.head 5 -  Call SalDisableWindow( pbUpdate )
.head 4 -  ! Запуск з правом лише перегляду
.head 4 +  If nMode = 3
.head 5 -  Call SalDisableWindow( pbIns )
.head 5 -  Call SalDisableWindow( pbDel )
.head 5 -  Call SalDisableWindow( pbUpdate )
.head 5 -  Call SalDisableWindow( pbSos )
.head 5 -  Call SalDisableWindow( pbProc )
.head 5 -  Call SalDisableWindow( pbPAY )
.head 5 -  Call SalDisableWindow( pbShowPledged )
.head 5 -  Call SalShowWindow( pbShowClosed )
.head 4 -  !
.head 4 +  If ( sDptBankType != 'NADRA' )
.head 5 -  Call SalHideWindow( pbShowPledged )
.head 4 -  ! =========
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('DPU_DEAL.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  Set DPU_DEAL.nTabInstance=1
.head 4 -  Set sFlt_Outer=SalStrTrimX( sFlt_Outer )
.head 4 -  Set DPU_DEAL.fFilterAtStart=TRUE
.head 4 -  Set dDATA = GetBankDate()
.head 4 -  ! Група доступу для рахунків
.head 4 -  Set nGrp=SalStrToNumber( sPar01 )
.head 4 -  !
.head 4 -  Set DPU_DEAL.strPrintFileName = 'DPT_UL'
.head 4 -  Set DPU_DEAL.strFilterTblName = 'DPT_U'
.head 4 -  Set DPU_DEAL.strSqlPopulate = 
"SELECT dpt_u.dpu_id, dpt_u.nd, dpt_u.dpu_gen, dpt_u.dpu_add, 
        dpt_u.vidd, dpt_u.name, 
        dpt_u.kv, dpt_u.iso, dpt_u.namev,
        dpt_u.sum/100, gl.p_icurval(dpt_u.kv,dpt_u.sum,bankdate)/100, 
        dpt_u.rnk, dpt_u.nmk, dpt_u.okpo, 
        dpt_u.acc, dpt_u.nls, dpt_u.ostc/100, dpt_u.ostb/100, dpt_u.ostq/100,
        dpt_u.acra, dpt_u.proc, dpt_u.ostn/100,
        dpt_u.freqn, dpt_u.freqv, dpt_u.freq_name, 
        dpt_u.dat_z, dpt_u.dat_n, dpt_u.dat_o, dpt_u.dat_v,
        dpt_u.term_months, dpt_u.term_days,  
        dpt_u.mfod, dpt_u.nlsd, dpt_u.nmsd, 
        dpt_u.mfop, dpt_u.nlsp, dpt_u.nmsd,
        dpt_u.fl_add, dpt_u.id_stop, dpt_u.min_sum/100, dpt_u.user_id, 
        dpt_u.branch, dpt_u.blkd
   INTO :DPU_DEAL.DPU_ID,:DPU_DEAL.ND,:DPU_DEAL.DPU_GEN,:DPU_DEAL.DPU_AD,
        :DPU_DEAL.VIDD,:DPU_DEAL.NAME,
        :DPU_DEAL.KV,:DPU_DEAL.ISO,:DPU_DEAL.NAMEV,
        :DPU_DEAL.SUM,:DPU_DEAL.SUMQ,
        :DPU_DEAL.RNK,:DPU_DEAL.NMK,:DPU_DEAL.OKPO,
        :DPU_DEAL.ACC,:DPU_DEAL.NLS,:DPU_DEAL.OST,:DPU_DEAL.OST_PL,:DPU_DEAL.OSTQ,
        :DPU_DEAL.ACCN,:DPU_DEAL.PROC,:DPU_DEAL.OSTN,  
        :DPU_DEAL.nFREQN,:DPU_DEAL.nFREQV,:DPU_DEAL.FREQV, 
        :DPU_DEAL.DATZ,:DPU_DEAL.DATN,:DPU_DEAL.DATO,:DPU_DEAL.DATV,
        :DPU_DEAL.TERM_MONTHS,:DPU_DEAL.TERM_DAYS,
        :DPU_DEAL.MFOD,:DPU_DEAL.ACCD,:DPU_DEAL.NMSD,
        :DPU_DEAL.MFOP,:DPU_DEAL.ACCP,:DPU_DEAL.NMSP,
        :DPU_DEAL.FL_ADD, :DPU_DEAL.ID_STOP, :DPU_DEAL.MIN_SUM, :DPU_DEAL.ISP,
        :DPU_DEAL.BRANCH, :DPU_DEAL.BLKD
   FROM dpt_u
 WHERE nvl(dpt_u.closed,0) = :bShowClosed " ||
 IifS( ( (sSegmentExists = 'Y') AND ( nSegment != NUMBER_Null ) ), " AND dpt_u.segment = " || Str( nSegment ), " ") ||
 IifS(sFlt_Outer != STRING_Null, " AND "||sFlt_Outer, " ")||
" ORDER BY nvl(dpt_u.dpu_gen,dpt_u.dpu_id) desc, dpt_u.dpu_add"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 +  ! If SqlPrepareAndExecute( hSql(), 
   "SELECT a.ostc/100, a.ostb/100, gl.p_icurval(a.kv,a.ostc,bankdate)/100
    INTO :DPU_DEAL.OST, :DPU_DEAL.OST_PL, :DPU_DEAL.OSTQ
    FROM accounts a, dpu_deal d
    WHERE a.acc=d.acc AND d.dpu_id=:DPU_DEAL.DPU_ID" )
.head 5 +  If not SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Set OST=0
.head 6 -  Set OST_PL=0
.head 6 -  Set OSTQ=0
.head 4 +  If DPU_AD > 0 OR DPU_AD = NUMBER_Null
.head 5 -  Set nSumQ = nSumQ + SUMQ
.head 5 -  Set nOstQ = nOstQ + OSTQ
.head 5 -  Set nSt = nSt + OSTQ*PROC
.head 4 +  If DPU_AD = 0 OR DPU_AD = NUMBER_Null
.head 5 -  Set nColGen = nColGen + 1
.head 4 +  Else
.head 5 -  Set nColAdd = nColAdd + 1
.head 4 -  ! Розмальовка
.head 4 +  If bShowClosed = 0
.head 5 +  If DATO != DATETIME_Null
.head 6 +  If DATO <= dDATA
.head 7 -  Call XSalTblSetCellBackColor( DATZ, COLOR_Salmon )
.head 7 -  Call XSalTblSetCellBackColor( DATN, COLOR_Salmon )
.head 7 -  Call XSalTblSetCellBackColor( DATO, COLOR_Salmon )
.head 7 -  Call XSalTblSetCellBackColor( DATV, COLOR_Salmon )
.head 6 +  Else If DATO <= dDATA+7
.head 7 -  Call XSalTblSetCellBackColor( DATZ, COLOR_LightAqua )
.head 7 -  Call XSalTblSetCellBackColor( DATN, COLOR_LightAqua )
.head 7 -  Call XSalTblSetCellBackColor( DATO, COLOR_LightAqua )
.head 7 -  Call XSalTblSetCellBackColor( DATV, COLOR_LightAqua )
.head 6 +  Else If DATO <= dDATA+30
.head 7 -  Call XSalTblSetCellBackColor( DATZ, COLOR_Gray )
.head 7 -  Call XSalTblSetCellBackColor( DATN, COLOR_Gray )
.head 7 -  Call XSalTblSetCellBackColor( DATO, COLOR_Gray )
.head 7 -  Call XSalTblSetCellBackColor( DATV, COLOR_Gray )
.head 5 +  If ( BLKD > 0 )
.head 6 -  Call SetTblRowColor( hWndForm, COLOR_Purple )
.head 6 -  ! Call SetTblRowColor( hWndForm, COLOR_Marigold )
.head 4 +  Else
.head 5 -  Call SetTblRowColor(hWndForm, COLOR_Red)
.head 4 -  !
.head 4 +  If DPU_AD = 0
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Yellow )
.head 4 +  If DPU_DEAL.DPU_AD > 0
.head 5 -  Call XSalTblSetCellBackColor( DPU_DEAL.DPU_AD, COLOR_Yellow)
.head 3 +  On UM_Populate
.head 4 -  Set nColGen = 0
.head 4 -  Set nColAdd = 0
.head 4 -  Set nSumQ = 0
.head 4 -  Set nOstQ = 0
.head 4 -  Set nSt   = 0
.head 4 -  Set sFilter=cF.GetFilterWhereClause(TRUE)
.head 4 -  Call SalSendClassMessage( UM_Populate, 0, 0)
.head 4 -  Call SalTblDefineSplitWindow( hWndForm, 1, TBL_Split_Adjustable )
.head 4 -  Call SalTblFetchRow( hWndForm, SalTblInsertRow( hWndForm, TBL_MinSplitRow ) )
.head 4 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_New, FALSE, 0, 0 )
.head 4 -  Set dfKtDEAL = Str(nColGen) || IifS( nColAdd > 0, (" / "||Str(nColAdd)), "")
.head 4 -  Set SUM = nSumQ
.head 4 -  Set OST = nOstQ
.head 4 +  If nOstQ = 0
.head 5 -  Set PROC = NUMBER_Null
.head 4 +  Else
.head 5 -  Set PROC = nSt/nOstQ
.head 4 -  Call SalSendMsg( hWndForm, SAM_RowSetContext, 0, 0 )
.head 3 +  On SAM_RowSetContext
.head 4 +  If DPU_AD = 0
.head 5 -  Call SalDisableWindow(pbSos)
.head 4 +  Else
.head 5 -  Call SalEnableWindow(pbSos)
.head 3 +  On SAM_SetFocus
.head 4 +  If DPU_AD = 0
.head 5 -  Call SalDisableWindow(pbSos)
.head 4 +  Else
.head 5 -  Call SalEnableWindow(pbSos)
.head 3 +  On UM_CreateDoc
.head 4 -  Call CreateDptDoc( DPU_DEAL.DPU_ID, DPU_DEAL.VIDD )
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg( pbDetails, SAM_Click, 0, 0 )
.head 3 +  On VTM_KeyDown
.head 4 +  If ( ( wParam = VK_F1 ) AND (VisGetKeyState(VK_Shift) & KS_Down) )
.head 5 -  Call get_LibraryVersion()
.head 4 +  If ( ( wParam = VK_F12 ) AND (VisGetKeyState(VK_Alt) & KS_Down) AND (VisGetKeyState(VK_Control) & KS_Down) )
.head 5 -  Call SalMessageBox ( f_DISCREPANCY_BALANCES(), 'DEBUG ('||sDptBankType||')', MB_Ok )
.head 1 +  Form Window: frm_Comb
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.head 2 -  Class: cGenericTableSpl
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  13.383"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.726"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Изъять платеж из картотеки
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Comb.pbDel')
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Зачислить поступление на счета выбранного договора 
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Comb.pbUpdate')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(frm_Comb.tbl,  UM_Update,   0, 0)
.head 7 -  Call SalSendMsg(frm_Comb.tbl2, UM_Update,   0, 0)
.head 7 -  Call SalPostMsg(frm_Comb,      UM_Populate, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 265
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Просмотреть выбранный платеж
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Comb.pbDetails')
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(frm_Comb.tbl, ROW_Selected, 0)
.head 8 -  Call DocViewContentsEx(hWndMDI, frm_Comb.tbl.colREF)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 266
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 267
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    1.298"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  13.033"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.679"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colACC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ACC
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Транзитный
счет
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
вал
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colISO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
вал
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Center
.head 6 -  Width:  0.517"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNMS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
транзитного счета
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 38
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.783"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOSTC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Фактический
остаток
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOSTB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Плановый
остаток
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colREF
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
платежа
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: #0
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
платежа
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd.MM.yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSUM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
платежа
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение
платежа
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  5.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strSqlPopulate
.head 5 -  String: strSqlDelete
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(frm_Comb.tbl, TBL_Flag_SingleSelection, TRUE)
.head 6 -  !
.head 6 -  Set frm_Comb.tbl.strSqlPopulate =
  "SELECT a.acc, a.nls, a.kv, t.lcv, a.nms, a.ostc/100, a.ostb/100, o.ref, o.vdat, o.s/100, o.nazn
     INTO :frm_Comb.tbl.colACC,
          :frm_Comb.tbl.colNLS,
          :frm_Comb.tbl.colKV,
          :frm_Comb.tbl.colISO,
          :frm_Comb.tbl.colNMS,
          :frm_Comb.tbl.colOSTC,
          :frm_Comb.tbl.colOSTB,
          :frm_Comb.tbl.colREF,
          :frm_Comb.tbl.colVDAT,
          :frm_Comb.tbl.colSUM,
          :frm_Comb.tbl.colNAZN
     FROM nlk_ref n, accounts a, oper o, tabval t
    WHERE o.ref = n.ref1
      AND n.acc = a.acc
      AND a.kv  = t.kv
      AND n.ref2 IS NULL 
      AND o.sos = 5 
      AND a.tip = :sPar2 "
|| IifS (SalStrTrimX(sPar3) = STRING_Null, " ", " AND "||sPar3) 
|| IifS (sBankType = 'SBER', " AND a.branch LIKE sys_context('bars_context','user_branch')||'%' ", " ")
||" ORDER BY a.kv, a.nls, o.vdat, o.ref"
.head 6 -  Set frm_Comb.tbl.strSqlDelete =
   "DELETE FROM nlk_ref 
     WHERE acc  = :frm_Comb.tbl.colACC 
       AND ref1 = :frm_Comb.tbl.colREF"
.head 6 -  !
.head 6 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 6 -  Set nAcc = frm_Comb.tbl.colACC
.head 6 -  Set nRef = frm_Comb.tbl.colREF
.head 6 -  Set nKv  = frm_Comb.tbl.colKV
.head 6 -  Set nSum = frm_Comb.tbl.colSUM
.head 6 -  Set sIso = frm_Comb.tbl.colISO
.head 6 -  Call SalTblPopulate(frm_Comb.tbl, hSql(), frm_Comb.tbl.strSqlPopulate, TBL_FillAll)
.head 6 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_TblDoDetails
.head 6 -  Set nAcc = frm_Comb.tbl.colACC
.head 6 -  Set nRef = frm_Comb.tbl.colREF
.head 6 -  Set nKv  = frm_Comb.tbl.colKV
.head 6 -  Set nSum = frm_Comb.tbl.colSUM
.head 6 -  Set sIso = frm_Comb.tbl.colISO
.head 6 -  Call SalSendMsg(frm_Comb.tbl2, UM_Populate, 0, 0)
.head 5 +  On UM_Update
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(frm_Comb.tbl, nRow, ROW_MarkDeleted, 0)
.head 7 -  Call SalTblSetContext(frm_Comb.tbl, nRow)
.head 7 -  ! Изъять из картотеки платеж № ... по счету ...
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Comb.Wish2Delete')
                 ||' '||Str(frm_Comb.tbl.colREF)||PutCrLf()
                 ||' '||CurrentLangTable.GetAtomTitle('frm_Comb.Account')
                 ||' '||frm_Comb.tbl.colNLS||'/'||frm_Comb.tbl.colISO,
                 CurrentLangTable.GetAtomTitle('cTAt'),
                MB_IconQuestion|MB_YesNo) = IDYES
.head 8 -  Call SqlPrepare(hSql(), strSqlDelete)
.head 8 -  Call SalTblDoDeletes(hWndForm, hSql(), ROW_MarkDeleted)
.head 6 -  Call SqlCommit(hSql())
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 27
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    1.75"
.head 6 -  Width:  13.033"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.119"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colDPUNUM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
договора
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDPUDAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
договора
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd.MM.yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDPUSUM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма 
договора
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDPULIMIT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Неснижаемый 
остаток
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  !
.head 5 +  Column: colMAINDPUID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
договора
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: #0
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMAINACC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: асс
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMAINNLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Депозитный
 счет
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMAINOSTC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Фактический
остаток
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMAINOSTB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Плановый
остаток
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMAINSUM2PAY
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Cумма к
зачислению
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  !
.head 5 +  Column: colDMNDDPUID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
договора
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: #0
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDMNDACC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: асс
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDMNDNLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Депозитный
 счет - 2
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDMNDOSTC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Фактический
остаток - 2
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDMNDOSTB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Плановый
остаток - 2
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDMNDSUM2PAY
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма к
зачислению -2
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  !
.head 5 +  Column: colCUSTID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Регист.№ 
клиента
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: #0
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCUSTNAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
клиента
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.183"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCUSTCODE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код ОКПО
клиента
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strSqlPopulate
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags (frm_Comb.tbl2, TBL_Flag_SingleSelection, TRUE)
.head 6 -  !
.head 6 -  Set frm_Comb.tbl2.strSqlPopulate =
    "SELECT main.nd, main.datz, 
            main.sum/100, nvl(main.min_sum, 0)/100,
            main.dpu_id, accm.acc, accm.nls, accm.ostc/100, accm.ostb/100,
            dmnd.dpu_id, accd.acc, accd.nls, accd.ostc/100, accd.ostb/100,
            cust.rnk, cust.nmk, cust.okpo
      INTO :frm_Comb.tbl2.colDPUNUM,
           :frm_Comb.tbl2.colDPUDAT,
           :frm_Comb.tbl2.colDPUSUM,
           :frm_Comb.tbl2.colDPULIMIT,
           :frm_Comb.tbl2.colMAINDPUID,
           :frm_Comb.tbl2.colMAINACC,
           :frm_Comb.tbl2.colMAINNLS,
           :frm_Comb.tbl2.colMAINOSTC,
           :frm_Comb.tbl2.colMAINOSTB,
           :frm_Comb.tbl2.colDMNDDPUID,
           :frm_Comb.tbl2.colDMNDACC,
           :frm_Comb.tbl2.colDMNDNLS,
           :frm_Comb.tbl2.colDMNDOSTC,
           :frm_Comb.tbl2.colDMNDOSTB,
           :frm_Comb.tbl2.colCUSTID,
           :frm_Comb.tbl2.colCUSTNAME,
           :frm_Comb.tbl2.colCUSTCODE
      FROM dpu_deal      main, 
           dpu_deal      dmnd,
           accounts      accm,
           accounts      accd,
           customer      cust,
           dpu_vidd_comb comb
     WHERE main.vidd = comb.main_vidd
       AND dmnd.vidd = comb.dmnd_vidd
       AND main.rnk  = cust.rnk
       AND main.acc  = accm.acc
       AND dmnd.acc  = accd.acc
       AND accd.kv   = accm.kv
       AND accd.rnk  = accm.rnk
       AND main.dpu_gen = dmnd.dpu_gen
       AND accm.dazs IS NULL
       AND accd.dazs IS NULL
       AND (main.dat_end IS NULL OR main.dat_end > :dBankDate)
       AND (dmnd.dat_end IS NULL OR dmnd.dat_end > :dBankDate)
       AND accm.kv   = :frm_Comb.nKv
     ORDER BY main.dpu_id"
.head 6 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set frm_Comb.tbl2.colMAINSUM2PAY = SalNumberMin(nSum, SalNumberMax(0, frm_Comb.tbl2.colDPULIMIT-frm_Comb.tbl2.colMAINOSTC))           
.head 6 -  Set frm_Comb.tbl2.colDMNDSUM2PAY = SalNumberMax(0, nSum - frm_Comb.tbl2.colMAINSUM2PAY)
.head 6 -  ! раскраска
.head 6 +  If frm_Comb.tbl2.colMAINOSTC != frm_Comb.tbl2.colMAINOSTB
.head 7 -  Call SalTblSetCellTextColor(frm_Comb.tbl2.colMAINOSTC, COLOR_Blue, TRUE)
.head 7 -  Call SalTblSetCellTextColor(frm_Comb.tbl2.colMAINOSTB, COLOR_Blue, TRUE)
.head 6 +  If frm_Comb.tbl2.colDMNDOSTC != frm_Comb.tbl2.colDMNDOSTB
.head 7 -  Call SalTblSetCellTextColor(frm_Comb.tbl2.colDMNDOSTC, COLOR_Blue, TRUE)
.head 7 -  Call SalTblSetCellTextColor(frm_Comb.tbl2.colDMNDOSTB, COLOR_Blue, TRUE)
.head 6 +  If frm_Comb.tbl2.colMAINSUM2PAY > 0
.head 7 -  Call XSalTblSetCellBackColor(frm_Comb.tbl2.colMAINSUM2PAY, COLOR_Sky)
.head 6 +  If frm_Comb.tbl2.colDMNDSUM2PAY > 0
.head 7 -  Call XSalTblSetCellBackColor(frm_Comb.tbl2.colDMNDSUM2PAY, COLOR_LightPeriwinkle)
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 6 -  Call SalTblPopulate(frm_Comb.tbl2, hSql(), frm_Comb.tbl2.strSqlPopulate, TBL_FillAll)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On UM_Update
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(frm_Comb.tbl2, nRow, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext(frm_Comb.tbl2, nRow)
.head 7 -  ! Зачислить сумму на счета?
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Comb.Wish2Pay')
                 ||' '||SalNumberToStrX(nSum, 2)
                 ||' '||sIso
                 ||' '||CurrentLangTable.GetAtomTitle('frm_Comb.Account2')
                 ||' '||frm_Comb.tbl2.colMAINNLS
                 ||','||frm_Comb.tbl2.colDMNDNLS
                 ||'?',
                 CurrentLangTable.GetAtomTitle('cTAt'),
                 MB_IconQuestion|MB_YesNo) = IDYES
.head 8 +  If SqlPLSQLCommand(hSql(), 
   "dpu.breakdown_combinpayments (nRef, 
                                  frm_Comb.tbl2.colMAINDPUID, 
                                  frm_Comb.tbl2.colDMNDDPUID, 
                                  nMainRef, 
                                  nDmndRef)")
.head 9 -  ! Выполнено 
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Comb.InfoMsg')
                  ||IifS (nMainRef > 0, 
                          PutCrLf()
                        ||CurrentLangTable.GetAtomTitle('frm_Comb.DocRef')
                        ||" № "
                        ||SalNumberToStrX(nMainRef, 0),
                          "")
                  ||IifS (nDmndRef > 0,
                          PutCrLf()
                        ||CurrentLangTable.GetAtomTitle('frm_Comb.DocRef')
                        ||" № "
                        ||SalNumberToStrX(nDmndRef, 0),
                          ""), 
                   CurrentLangTable.GetAtomTitle('cTInfo'),
                   MB_IconInformation)
.head 9 -  Call SqlCommit(hSql())
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 6 -  Call SalWaitCursor(FALSE)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar1
.head 3 -  String: sPar2  !! тип транз.счета
.head 3 -  String: sPar3  !! внешний фильтр 
.head 2 +  Window Variables
.head 3 -  Date/Time: dBankDate
.head 3 -  Number: nUserId
.head 3 -  Number: nAcc
.head 3 -  Number: nRef
.head 3 -  Number: nKv
.head 3 -  Number: nSum
.head 3 -  String: sIso
.head 3 -  Number: nFetchRes
.head 3 -  Number: nRow
.head 3 -  Number: nMainRef
.head 3 -  Number: nDmndRef
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Comb.Title'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set nTabInstance1 = 1
.head 4 -  Set nTabInstance2 = 1
.head 4 -  Set nUserId = GetUserId()
.head 4 -  Set dBankDate = GetBankDate()
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Set frm_Comb.strPrintFileName = 'CombDpu'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendMsg(hWndForm.frm_Comb.tbl,  UM_Populate, 0, 0)
.head 4 -  Call SalSendMsg(hWndForm.frm_Comb.tbl2, UM_Populate, 0, 0)
.head 1 +  Form Window: CB_VVOD1
.head 2 -  Class: cDocWDpu
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.583"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.845"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbPayDoc
.head 5 -  Class Child Ref Key: 48
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 49
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrtDoc
.head 5 -  Class Child Ref Key: 50
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 57537
.head 5 -  Class Child Ref Key: 51
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text:
.head 5 -  Resource Id: 57538
.head 5 -  Class Child Ref Key: 52
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 57539
.head 5 -  Class Child Ref Key: 53
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 57540
.head 5 -  Class Child Ref Key: 54
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfZn
.head 5 -  Class Child Ref Key: 55
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfOst
.head 5 -  Class Child Ref Key: 56
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Class Default
.head 7 -  Top:    Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewDoc
.head 5 -  Class Child Ref Key: 57
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbNewTTs
.head 5 -  Class Child Ref Key: 58
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDocBal
.head 5 -  Class Child Ref Key: 59
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHelp
.head 5 -  Class Child Ref Key: 60
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSaveKor
.head 5 -  Class Child Ref Key: 61
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbLocalD
.head 5 -  Class Child Ref Key: 62
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 57541
.head 5 -  Class Child Ref Key: 63
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbHotVytyag
.head 5 -  Class Child Ref Key: 64
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotFio
.head 5 -  Class Child Ref Key: 65
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotName
.head 5 -  Class Child Ref Key: 66
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbHotOstat
.head 5 -  Class Child Ref Key: 67
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cDocWDpu
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Data Field: dfValD1
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVob
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text:
.head 4 -  Resource Id: 57532
.head 4 -  Class Child Ref Key: 3
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfNd
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On VTM_KeyDown
.head 6 +  If ( ( wParam = VK_F5 ) AND (VisGetKeyState(VK_Shift) & KS_Down) )
.head 7 -  ! Call SalMessageBox ( 'dfNd', 'DEBUG', MB_Ok )
.head 7 -  Call SaveInfoToLog( 'Користувач отримав доступ до зміни суми операції по договору №' || Str( nDPT ) )
.head 7 -  Call CB_VVOD1.UnHideIt( dfSumC )
.head 3 +  Data Field: dfDocD
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankA
.head 4 -  Class Child Ref Key: 7
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsA
.head 4 -  Class Child Ref Key: 9
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlat
.head 4 -  Class Child Ref Key: 10
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamA
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoA
.head 4 -  Class Child Ref Key: 12
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPlatB
.head 4 -  Class Child Ref Key: 13
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbA
.head 4 -  Class Child Ref Key: 14
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankB
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPoluB
.head 4 -  Class Child Ref Key: 16
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNbB
.head 4 -  Class Child Ref Key: 17
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.head 4 -  Class Child Ref Key: 18
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNlsB
.head 4 -  Class Child Ref Key: 19
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPolu
.head 4 -  Class Child Ref Key: 20
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNamB
.head 4 -  Class Child Ref Key: 21
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOkpoB
.head 4 -  Class Child Ref Key: 22
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNA
.head 4 -  Class Child Ref Key: 23
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumA
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If NOT SalIsNull( dfSumA ) AND dfSumA != 0
.head 7 +  If SalSendClassMessage( SAM_Validate, 0, 0 )
.head 8 -  Return VALIDATE_Ok
.head 6 -  Return VALIDATE_Cancel
.head 3 +  Data Field: dfSumNB
.head 4 -  Class Child Ref Key: 25
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumB
.head 4 -  Class Child Ref Key: 26
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNomN
.head 4 -  Class Child Ref Key: 27
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRatNom
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumNC
.head 4 -  Class Child Ref Key: 29
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSumC
.head 4 -  Class Child Ref Key: 30
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set CB_VVOD1.dfSumC = nSumFact
.head 6 -  Set CB_VVOD1.nS = nSumFact
.head 6 -  Set CB_VVOD1.dfSumA = dfSumC
.head 6 -  Call SalSendMsg(dfSumA, SAM_Validate, 0, 0)
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 6 -  ! Для Ощада при виплаті депозиту можна міняти суму
.head 6 +  If ( ( sDptBankType = 'SBER' ) AND ( nOpId = 2 ) )
.head 7 -  Call CB_VVOD1.UnHideIt( hWndItem )
.head 6 +  Else
.head 7 +  If ( SalIsNull( dfSumC ) OR dfSumC = 0 )
.head 8 -  Call CB_VVOD1.UnHideIt( hWndItem )
.head 7 +  Else
.head 8 -  Call CB_VVOD1.HideIt( hWndItem )
.head 3 +  Data Field: dfEquivN
.head 4 -  Class Child Ref Key: 31
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfEquiv
.head 4 -  Class Child Ref Key: 32
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  List Box: lb1
.head 4 -  Class Child Ref Key: 33
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Set CB_VVOD1.nPosND = VisArrayFindString( CB_VVOD1.aTag, 'ND' )
.head 6 +  If CB_VVOD1.nPosND > 0
.head 7 -  Set CB_VVOD1.aVal[CB_VVOD1.nPosND] = SalStrTrimX( Str(nDPT) )
.head 6 -  ! << SWIFT start >>
.head 6 +  If ( nKv2 != GetBaseVal() AND s1 != GetBankMfo() )
.head 7 -  Call f_get_swift_details()
.head 7 -  ! 50F
.head 7 -  Set CB_VVOD1.nPosND = VisArrayFindString( CB_VVOD1.aTag, '50F' )
.head 7 +  If CB_VVOD1.nPosND > 0
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.nPosND] = '/' || dfNlsA || PutCrLf() ||
         SalStrMidX( '1/'    || sSwift[4], 0, 35 ) || PutCrLf() ||
         SalStrMidX( '2/'    || sSwift[7], 0, 35 ) || PutCrLf() ||
         SalStrMidX( '3/UA/' || sSwift[6], 0, 35 ) || PutCrLf() || 
                     '6/UA/' || dfOkpoA
.head 7 -  ! 56A
.head 7 -  Set CB_VVOD1.nPosND = VisArrayFindString( CB_VVOD1.aTag, '56A' )
.head 7 +  If CB_VVOD1.nPosND > 0
.head 8 -  ! TAG56_CODE
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.nPosND] = SalStrTrimX( sSwift[1] )
.head 7 -  ! 57A
.head 7 -  Set CB_VVOD1.nPosND = VisArrayFindString( CB_VVOD1.aTag, '57A' )
.head 7 +  If CB_VVOD1.nPosND > 0
.head 8 -  ! TAG57_CODE
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.nPosND] = SalStrTrimX( sSwift[2] )
.head 7 -  ! 59
.head 7 -  Set CB_VVOD1.nPosND = VisArrayFindString( CB_VVOD1.aTag, '59' )
.head 7 +  If CB_VVOD1.nPosND > 0
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.nPosND] = '/' || sSwift[3] || PutCrLf() ||
                       SalStrMidX( sSwift[4], 0, 35 ) || PutCrLf() || 
                       SalStrMidX( sSwift[5], 0, 35 ) 
.head 7 -  ! 70
.head 7 -  Set CB_VVOD1.nPosND = VisArrayFindString( CB_VVOD1.aTag, '70' )
.head 7 +  If CB_VVOD1.nPosND > 0
.head 8 -  Set CB_VVOD1.aVal[CB_VVOD1.nPosND] = SalStrMidX( CB_VVOD1.aVal[CB_VVOD1.nPosND], 0, 35 )
                                     || PutCrLf() || 'IN ACCORD TO CONTRACT'
                                     || PutCrLf() || SalStrMidX( 'N '||sSwift[9], 0, 35 )
                                     || PutCrLf() || 'OF ' || sSwift[10]
.head 6 -  ! < SWIFT finish >
.head 6 -  Call SalListSetSelect( lb1, 0 )
.head 6 -  Call SalSendMsg( hWndItem, SAM_Click, 0, 0 )
.head 3 +  Multiline Field: dfNazn
.head 4 -  Class Child Ref Key: 34
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 6 -  ! Назначение по формуле
.head 6 -  Call SqlPrepareAndExecute(hSql(), "SELECT nazn INTO :sTmpND FROM  tts WHERE tt=:sTT2")
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set nPosND = SalStrScan(sTmpND, '#(ND)')
.head 7 +  While nPosND != -1
.head 8 -  Set sTmpND = SalStrReplaceX(sTmpND, nPosND, 5, Str(nDPT))
.head 8 -  Set nPosND = SalStrScan(sTmpND, '#(ND)')
.head 7 +  If SalStrTrimX(sTmpND)
.head 8 +  If not hWndForm.CB_VVOD1.sTranN(dfNazn, sTmpND, hWndForm.CB_VVOD1.sTT,
  dfNlsA, dfBankA, hWndForm.CB_VVOD1.nKvA, dfSumA*SalNumberPower( 10, hWndForm.CB_VVOD1.nDigA),
  dfNlsB, dfBankB, hWndForm.CB_VVOD1.nKvB, dfSumB*SalNumberPower( 10, hWndForm.CB_VVOD1.nDigB),
  dfSk, dfEquiv*100, NUMBER_Null)
.head 9 -  ! Call MessageErrorEx('Ошибка формирования назначения платежа '|| sTmpND)
.head 9 -  Call MessageErrorEx(CurrentLangTable.GetAtomTitle('CB_VVOD1.cTErrNazn') || ' '|| sTmpND)
.head 7 -  Set dfNazn = SalStrTrimX(dfNazn)
.head 3 +  Data Field: dfSkN
.head 4 -  Class Child Ref Key: 35
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSk
.head 4 -  Class Child Ref Key: 36
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2N
.head 4 -  Class Child Ref Key: 38
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD2
.head 4 -  Class Child Ref Key: 39
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfD
.head 4 -  Class Child Ref Key: 40
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfK
.head 4 -  Class Child Ref Key: 41
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfLocDat
.head 4 -  Class Child Ref Key: 45
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUgrnt
.head 4 -  Class Child Ref Key: 46
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVytyagN
.head 4 -  Class Child Ref Key: 47
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateFrom
.head 4 -  Class Child Ref Key: 68
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfValD1N
.head 4 -  Class Child Ref Key: 73
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1f
.head 4 -  Class Child Ref Key: 74
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic2f
.head 4 -  Class Child Ref Key: 75
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic3f
.head 4 -  Class Child Ref Key: 76
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSub
.head 4 -  Class Child Ref Key: 77
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSubN
.head 4 -  Class Child Ref Key: 78
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cDocWDpu
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: f_get_swift_details
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! SWIFT
.head 5 -  If SqlPrepareAndExecute( hSql(),
"select TAG56_CODE, TAG57_CODE, TAG59_ACC, TAG59_NAME, TAG59_ADR
   into :sSwift[1], :sSwift[2], :sSwift[3], :sSwift[4], :sSwift[5]
   from BARS.DPU_DEAL_SWTAGS
  where DPU_ID = :nDPT
" ) AND SqlFetchNext( hSql(),nFetchRes ) 
.head 5 +  Else
.head 6 +  If SalMessageBox( 'Не вказані SWIFT реквізити для виплати!' || PutCrLf() || 'Бажаєте продовжити?'
                , CurrentLangTable.GetAtomTitle('cTAt')
                , MB_IconQuestion | MB_YesNo) = IDNO
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 6 +  Else
.head 7 -  ! Go on
.head 5 -  ! Contract details
.head 5 +  If SqlPrepareAndExecute( hSql(),
"select d.RNK, d.ND, to_char(d.DATZ,'dd.mm.yyyy')
   into :sSwift[8], :sSwift[9], :sSwift[10]
   from BARS.DPU_DEAL d
  where d.DPU_ID = :nDPT
" ) AND SqlFetchNext( hSql(),nFetchRes ) 
.head 6 -  ! Address
.head 6 +  If NOT SqlPrepareAndExecute( hSql(),
"select SubStr(F_TRANSLATE_KMU(LOCALITY),1,35)
      , SubStr(F_TRANSLATE_KMU(ADDRESS), 1,35)
   into :sSwift[6], :sSwift[7]
   from BARS.CUSTOMER_ADDRESS
  where TYPE_ID = 1
    and RNK = " || sSwift[8]
) OR NOT SqlFetchNext( hSql(),nFetchRes )
.head 7 -  Set sSwift[6] = '___'     !! City
.head 7 -  Set sSwift[7] = sSwift[5] !! Street and House Number
.head 2 +  Window Parameters
.head 3 -  Number: nDPT  !! № депозита
.head 3 -  String: sTT2
.head 3 -  Number: nOpId
.head 3 -  Number: nKv2
.head 3 -  String: sND
.head 3 -  Number: nSumFact
.head 3 -  Number: MINS  !! min\max суммы (>0)
.head 3 -  Number: nS2
.head 3 -  String: sAccA !! Счет А главный
.head 3 -  String: sAccB !! Счет Б главный
.head 3 -  String: s1    !! МФО получателя
.head 3 -  String: s2    !! Счет получателя
.head 3 -  String: s3    !! Наим получателя
.head 3 -  String: nazn  
.head 2 +  Window Variables
.head 3 -  String: sA
.head 3 -  String: sB
.head 3 -  Long String: sErrMsg
.head 3 -  Boolean: bRet
.head 3 -  Number: nKV
.head 3 -  Number: Sum1
.head 3 -  Number: nVIDD
.head 3 -  Number: nFetchRes
.head 3 -  Number: nREF
.head 3 -  String: sT
.head 3 -  Number: nMASKA
.head 3 -  String: sISO
.head 3 -  Number: nPosND
.head 3 -  String: sTmpND
.head 3 -  String: sSwift[1:10]
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE) 
.head 4 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT lcv INTO :sISO FROM tabval WHERE kv = :nKv2")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  Call SalSendClassMessage(SAM_Create,0,0)
.head 3 +  On UM_Choose
.head 4 -  Set CB_VVOD1.sTT = sTT2
.head 4 +  If nOpId = 0
.head 5 -  Set CB_VVOD1.nKvB_TT = nKv2
.head 4 +  Else If (nOpId = 2 OR nOpId = 4)
.head 5 -  Set CB_VVOD1.nKvA_TT = nKv2
.head 4 +  Else
.head 5 -  Set CB_VVOD1.nKvA_TT = nKv2
.head 5 -  Set CB_VVOD1.nKvB_TT = nKv2
.head 4 +  If SqlPrepareAndExecute(hSql(),
  "SELECT name, fli, flv, dk, sk, flags, nlsb, nlsa, mfob
     INTO :CB_VVOD1.sTTN,    :CB_VVOD1.nFli,    :CB_VVOD1.nFlv,
          :CB_VVOD1.nDk,     :CB_VVOD1.nSk_TT,  :CB_VVOD1.sFlags,
          :CB_VVOD1.sNlsB_TT,:CB_VVOD1.sNlsA_TT,:CB_VVOD1.sBankB_TT
     FROM tts  
    WHERE tt = :CB_VVOD1.sTT")
and SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Call Flgs2aFlg(sFlags)
.head 4 -  ! If SqlPrepareAndExecute(hSql(),
  "SELECT name,substr(flags,38,1),substr(flags,10,1),substr(flags,61,1),
          fli,flv,dk,sk,substr(flags,4,1),nlsb,nlsa,mfob,
          substr(flags,59,1),substr(flags,36,1),substr(flags,47,1),
          nazn
     INTO :CB_VVOD1.sTTN, :CB_VVOD1.nFpy,:CB_VVOD1.nFsk,:CB_VVOD1.nFbk,
          :CB_VVOD1.nFli, :CB_VVOD1.nFlv,:CB_VVOD1.nDk, :CB_VVOD1.nSk_TT,
          :CB_VVOD1.nFvD1,:CB_VVOD1.sNlsB_TT,:CB_VVOD1.sNlsA_TT,
          :CB_VVOD1.sBankB_TT,:CB_VVOD1.nFcb,:CB_VVOD1.nFdp,:CB_VVOD1.nFpr,
          :sNazn
     FROM tts  
    WHERE tt = :CB_VVOD1.sTT")
and SqlFetchNext(hSql(),nFetchRes)
.head 4 +  Else
.head 5 -  ! Call SalMessageBox("Не описана операция "||CB_VVOD1.sTT, 'DlgMSG_Error', MB_Ok|MB_IconExclamation)
.head 5 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('CB_VVOD1.cTMessOp') || " " || CB_VVOD1.sTT, 
                   'DlgMSG_Error', 
                   MB_Ok|MB_IconExclamation)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 +  If sAccA != STRING_Null
.head 5 -  Set CB_VVOD1.sNlsA_TT = sAccA
.head 4 +  If sAccB != STRING_Null
.head 5 -  Set CB_VVOD1.sNlsB_TT = sAccB
.head 4 +  If s1 != STRING_Null
.head 5 -  Set CB_VVOD1.sBankB_TT = s1
.head 4 +  If s2 != STRING_Null
.head 5 -  Set CB_VVOD1.sNlsB_TT = s2
.head 4 -  ! Call SalSetWindowText(hWndForm, 'Ввод документа - [ '||CB_VVOD1.sTTN||' ]')
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('CB_VVOD1.cTWndTitle') || ' - [ '||CB_VVOD1.sTTN||' ]')
.head 4 -  Call SalSendClassMessage(UM_Clear, 0, 0)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalMapEnterToTab(FALSE)
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  Call SalSendMsg(frm_Dog.pbRefresh, SAM_Click, 0, 0)
.head 3 +  On SAM_CreateComplete
.head 4 +  If SalIsNull(dfOkpoB)  OR dfOkpoB = '99999' 
.head 5 -  Set dfOkpoB = dfOkpoA
.head 4 +  If SalIsNull(dfNazn)
.head 5 -  Set CB_VVOD1.dfNazn = SalStrTrimX(nazn)
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 +  If s3 != STRING_Null
.head 5 -  Set CB_VVOD1.dfNamB = s3
.head 5 -  Call SalDisableWindow(CB_VVOD1.dfNamB)
.head 4 +  If dfOkpoB !=  STRING_Null
.head 5 -  Call SalDisableWindow(CB_VVOD1.dfOkpoB)
.head 4 -  Set CB_VVOD1.nDPUID = nDPT
.head 4 -  Call SalSendClassMessage(SAM_CreateComplete, 0, 0)
.head 4 -  ! Call SalSendMsg(CB_VVOD1.dfNazn, SAM_SetFocus, 0, 0)
.head 4 -  ! Call SalSendMsg(CB_VVOD1.dfNazn, SAM_Validate, 0, 0)
.head 1 +  Table Window: DPU_VIDD
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Виды депозитов Юр.Лиц
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  18.683"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.607"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Настройка видов депозитных договоров юр.лиц
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nEdit = 1
.head 7 +  If not IsWindow(hWin1)
.head 8 -  Set hWin1 = SalCreateWindow(frm_ViddDetails, hWndMDI, NUMBER_Null, nEdit, hWndForm, sPar01)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin1)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 41675
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 60680
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.183"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  5.183"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If DPU_VIDD.colVIDD != NUMBER_Null
.head 8 +  If DPU_VIDD.colFLAG = 1 OR DPU_VIDD.colKOL > 0 
.head 9 -  Set nEdit = 0
.head 8 +  Else
.head 9 -  Set nEdit = 1
.head 8 +  If not IsWindow(hWin1)
.head 9 -  Set hWin1 = SalCreateWindow(frm_ViddDetails, hWndMDI, colVIDD, nEdit, hWndForm, sPar01)
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop(hWin1)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 41676
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.3"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 41677
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Option Button: pbTypes
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BOOKS.BMP
.head 5 -  Picture Transparent Color: None
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! показать/скрыть инф-цию о типах договоров
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('DPU_VIDD.pbTypes'))
.head 6 +  On SAM_Click
.head 7 -  Set nShowTypeCol = 1 - nShowTypeCol
.head 7 +  If nShowTypeCol = 0
.head 8 -  Call SalHideWindow (colTYPEID)
.head 8 -  Call SalHideWindow (cmbTYPENAME)
.head 7 +  Else
.head 8 -  Call SalShowWindow (colTYPEID)
.head 8 -  Call SalShowWindow (cmbTYPENAME)
.head 4 +  Pushbutton: pbExport
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.667"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\saved.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! экспорт в SQL-сценарий
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('DPU_VIDD.pbExport'))
.head 6 +  On SAM_Click
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(DPU_VIDD, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(DPU_VIDD, nRow)
.head 8 +  If DPU_VIDD.colVIDD != NUMBER_Null
.head 9 -  Call GenScript (colVIDD)
.head 7 -  Call SalTblClearSelection(DPU_VIDD)
.head 2 +  Contents
.head 3 +  Column: colFLAG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Флаг
акт.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Числ.
код
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.583"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCODE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Симв.
код
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Center
.head 4 -  Width:  0.633"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
вида договора
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 50
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTYPEID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
типа
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: #0
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call cmbTYPENAME.SetSelectById(colTYPEID)
.head 6 +  If cmbTYPENAME.nCurrentId >= 0
.head 7 -  Call SalSendMsg(cmbTYPENAME, SAM_Click, 0, 0)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  ! Тип договора с указанным номером не существует!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_VIDD.InvalidTypeId'),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Column: cmbTYPENAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип договора
(продукт)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetColumnTitle(DPU_VIDD.cmbTYPENAME, CurrentLangTable.GetAtomTitle('DPU_VIDD.cmbTYPENAME'))
.head 6 -  Call cmbTYPENAME.Init(hWndItem)
.head 6 -  Call cmbTYPENAME.Populate(hSql(), "TYPE_ID", "TYPE_NAME", "DPU_TYPES", "ORDER BY SORT_ORD")
.head 6 -  Call cmbTYPENAME.SetSelectById(colTYPEID)
.head 6 -  Call SalListSetSelect(hWndItem, 0)
.head 6 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 5 +  On SAM_AnyEdit
.head 6 -  Set colTYPEID = cmbTYPENAME.GetKey(SalListQuerySelection(cmbTYPENAME))
.head 3 +  Column: colDEPLINE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Деп.
лінія
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTermMin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Срок

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTermMax
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Срок

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кол-во
дог.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.833"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: БС
деп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBSN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: БС
%%
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBRID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBRATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Базовая
ставка
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFREQID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFREQNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Период-ть 
выплаты %%
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCOMPROC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Капита-
лиз.%%
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMINSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Миним.
сумма
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: ###000
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFLADD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Флаг
пополн.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.75"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSTOPID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSTOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Штраф
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFLAUTOEXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Авто-
переоф.
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCOMMENTS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Подробности
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSHABLON
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Шаблон
договора
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.771"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIRREVOCABLE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ознака
Безвідкличності
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Center
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: GenScript
.head 4 -  Description: выгрузка вида договора в сценарий
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nVidd
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nExpId
.head 5 -  Number: nLength
.head 5 -  File Handle: hFile
.head 5 -  String: sFileName
.head 5 -  Long String: sText
.head 5 -  Number: i
.head 4 +  Actions
.head 5 +  If NOT SqlPLSQLCommand(hSql(), "dpu_utils.gen_script4vidd(nVidd)")
.head 6 -  ! Ошибка экспорта вида договора в сценарий
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_VIDD.GenScriptFailed'),
                   CurrentLangTable.GetAtomTitle('cTErr'), 
                   MB_IconStop)
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Return FALSE
.head 5 +  If SqlPrepareAndExecute(hSql(),
   "SELECT clobleng
      INTO :nLength
      FROM tmp_expdptype
     WHERE modcode = 'DPU' 
       AND typeid  = to_char(:nVidd)") 
   AND SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If nLength > 0
.head 7 -  Set sFileName = GetPrnDir()
             || IifS(Right(GetPrnDir(), 1) = '\\', '', '\\')
             || 'dputype_'||Str(nVidd)||'.sql'
.head 7 +  If NOT SalFileOpen(hFile, sFileName, OF_Create|OF_Write|OF_Text)
.head 8 -  ! Невозможно создать файл sFileName
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_VIDD.GenScriptFileOpenErr')||' '||sFileName,
                   CurrentLangTable.GetAtomTitle('cTErr'), 
                   MB_IconStop)
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Return FALSE
.head 7 -  Call SqlSetLongBindDatatype(1, 22)
.head 7 -  Set i = 1
.head 7 +  While i <= nLength
.head 8 -  Call SqlPrepareAndExecute(hSql(),
"SELECT dbms_lob.substr((SELECT clobdata 
                           FROM tmp_expdptype 
                          WHERE modcode = 'DPU' 
                            AND typeid  = to_char(:nVidd)), 
                 2000,
                 :i)
   INTO :sText 
   FROM dual")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalFileSeek (hFile, i - 1, FILE_SeekBegin)
.head 8 -  Call SalFileWrite(hFile, sText, Len(sText))
.head 8 -  Set i = i + 2000
.head 7 -  Call SalFileClose(hFile)
.head 7 -  ! Сценарий сохранен в sFileName
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_VIDD.GenScriptDone')||' '||sFileName,
                   CurrentLangTable.GetAtomTitle('cTInfo'), 
                   MB_IconInformation|MB_Ok)
.head 5 -  Call SqlCommit(hSql())
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: sPar01
.head 3 -  String: sPar02
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  Number: nRow
.head 3 -  Number: nEdit
.head 3 -  Number: nShowTypeCol
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('DPU_VIDD.cTWndTitle'))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set DPU_VIDD.strPrintFileName = 'V_DPU_VIDD'
.head 4 -  Set DPU_VIDD.strFilterTblName = 'V_DPU_VIDD'
.head 4 -  Set DPU_VIDD.fFilterAtStart = TRUE
.head 4 -  !
.head 4 -  Set nShowTypeCol = 0
.head 4 -  ! Ховаєм кнопку привязки виду до типу 
.head 4 -  ! (робим це на етапі заведення виду депозиту)
.head 4 -  Call SalHideWindow (pbTypes)
.head 4 -  ! Call SalHideWindow (colTYPEID)
.head 4 -  Call SalHideWindow (cmbTYPENAME)
.head 4 -  ! <<<< >>>>
.head 4 +  If sSegmentExists = 'Y'
.head 5 -  Call SalShowWindow (colDEPLINE)
.head 4 +  Else
.head 5 -  Call SalHideWindow (colDEPLINE)
.head 4 -  !
.head 4 -  Set DPU_VIDD.strSqlPopulate =
"SELECT IS_ACTIVE 
      , VIDD_ID
      , VIDD_NM
      , TYPE_ID
      , TYPE_NM 
      , CCY_CODE 
      , TERM_MIN
      , TERM_MAX
      , R020_DEP 
      , R020_INT 
      , BR_ID
      , BR_NM
      , FREQ_ID 
      , FREQ_NM
      , COMPROC 	
      , AMNT_MIN
      , REPLENISHABLE
      , STOP_ID 
      , STOP_NM
      , PROLONGABLE  
      , TEMPLATE_ID 
      , COMMENTS
      , IS_LINE
      , IRREVOCABLE
      , DEAL_QTY
   INTO :DPU_VIDD.colFLAG,
        :DPU_VIDD.colVIDD,
        :DPU_VIDD.colNAME,
        :DPU_VIDD.colTYPEID,
        :DPU_VIDD.cmbTYPENAME,
        :DPU_VIDD.colKV,
        :DPU_VIDD.colTermMin,
        :DPU_VIDD.colTermMax,
        :DPU_VIDD.colBSD,
        :DPU_VIDD.colBSN,   
        :DPU_VIDD.colBRID,
        :DPU_VIDD.colBRATE,
        :DPU_VIDD.colFREQID,
        :DPU_VIDD.colFREQNAME,
        :DPU_VIDD.colCOMPROC,
        :DPU_VIDD.colMINSUM,
        :DPU_VIDD.colFLADD,
        :DPU_VIDD.colSTOPID,
        :DPU_VIDD.colSTOP,
        :DPU_VIDD.colFLAUTOEXT, 
        :DPU_VIDD.colSHABLON,
        :DPU_VIDD.colCOMMENTS,
        :DPU_VIDD.colDEPLINE,
        :DPU_VIDD.colIRREVOCABLE,
        :DPU_VIDD.colKOL 
   FROM V_DPU_VIDD
" || IifS( ((sSegmentExists='Y') AND (SalStrTrimX(sPar01)!='')), " WHERE segment = " || sPar01, "") || "
  ORDER BY 1, 2"
.head 4 -  !
.head 4 -  Set DPU_VIDD.strSqlDelete = "DELETE FROM dpu_vidd
                              WHERE vidd =  :DPU_VIDD.colVIDD 
                                AND    1 <> :DPU_VIDD.colFLAG    
                                AND    0 =  :DPU_VIDD.colKOL"
.head 4 -  !
.head 4 -  Set DPU_VIDD.strSqlUpdate  = "UPDATE dpu_vidd 
                                 SET flag     = :DPU_VIDD.colFLAG, 
                                     name     = :DPU_VIDD.colNAME,
                               WHERE vidd     = :DPU_VIDD.colVIDD"
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  If SqlPrepareAndExecute(hSql(),
  "SELECT count(*) 
     INTO :DPU_VIDD.colKOL 
     FROM dpu_deal 
    WHERE vidd            = :DPU_VIDD.colVIDD 
      AND nvl(dpu_add, 0) = 0 
      AND nvl(closed, 0)  = 0 ")
AND SqlFetchNext( hSql(), nFetchRes ) 
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg(pbDetails, SAM_Click, 0, 0)
.head 1 +  Form Window: frm_ViddDetails
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  11.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.9"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.417"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Обновить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.pbRefresh')
.head 6 +  On SAM_Click
.head 7 +  If dfVIDD != NUMBER_Null
.head 8 -  Call F_POPULATE()
.head 7 +  Else
.head 8 -  Call F_START()
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.55"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сохранить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.pbUpdate')
.head 6 +  On SAM_Click
.head 7 -  ! Min. Date
.head 7 +  If dfTERM_MIN_M != NUMBER_Null OR dfTERM_MIN_D != NUMBER_Null
.head 8 -  Set nTotalTerm = dfTERM_MIN_M + (dfTERM_MIN_D/100  )
.head 8 -  Set nTermMin   = dfTERM_MIN_M + (dfTERM_MIN_D/10000)
.head 7 +  Else
.head 8 -  Set nTotalTerm = NUMBER_Null
.head 8 -  Set nTermMin   = 0
.head 7 -  ! Max. Date
.head 7 +  If dfTERM_MAX_M > 0 OR dfTERM_MAX_D > 0
.head 8 -  Set nTermMax   = dfTERM_MAX_M + (dfTERM_MAX_D/10000)
.head 7 +  Else
.head 8 -  Set nTermMax   = 0
.head 7 -  !
.head 7 +  If F_CHECKDATA()
.head 8 +  If dfVIDD != NUMBER_Null AND dfVIDD != 0 
.head 9 +  If SqlPrepareAndExecute(hSql(),
   "UPDATE dpu_vidd 
       SET name          = :dfNAME,
           dpu_code      = :dfCODE, 
           kv            = :dfKV,        
           srok          = :nTotalTerm,
           fl_autoextend = :chkAutoExt,
           bsd           = :dfBSD,      
           bsn           = :dfBSN,         
           fl_extend     = :nFlExtend,
           min_summ      = :nMinSum,
           max_summ      = :nMaxSum,    
           limit         = :nMinSumAdd,
           fl_add        = :chkAdd, 
           id_stop       = :dfSTOPID, 
           penya         = :dfPENYA,  
           shablon       = :dfSHABLON, 
           basey         = :dfBASEY,  
           freq_n        = :dfFREQN, 
           metr          = :dfMETR,  
           tip_ost       = :dfOST,
           IRVK          = :dfPeriodType,
           term_type     = :nTermType,
           term_min      = :nTermMin,
           term_max      = :nTermMax,
           br_id         = :dfBRID,  
           tt            = :dfTT, 
           comproc       = :chkComproc, 
           freq_v        = :dfFREQV,   
           comments      = :dfCOMMENTS,
           type_id       = :dfTYPE
     WHERE vidd = :dfVIDD")
and SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('frm_ViddDetails.Updated')||" № "||Str(dfVIDD))
.head 10 -  ! изменены параметры вида депозитного договора
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.Updated')||" № "||Str(dfVIDD),
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_IconExclamation)
.head 10 -  Call F_POPULATE()
.head 9 +  Else
.head 10 -  ! Не удалось изменить параметры вида депозитного договора
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrUpdate'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   0)
.head 8 +  Else
.head 9 +  If SqlPrepareAndExecute(hSql(), "SELECT s_dpu_vidd.nextval INTO :dfVIDD FROM dual")
and not SqlFetchNext(hSql(), nFetchRes)
.head 10 -  ! Не удалось получить код вида депозита
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrGetVidd'), 
                   CurrentLangTable.GetAtomTitle('cTerr'), 
                   MB_IconStop)
.head 9 +  Else
.head 10 +  If SqlPrepareAndExecute( hSql(),
  "INSERT INTO dpu_vidd
     (vidd,      dpu_code, name,     kv, 
      srok,      fl_autoextend,
      bsd,       bsn,      fl_extend, 
      min_summ,  max_summ, limit,    fl_add,
      id_stop,   penya,    shablon,
      basey,     freq_n,   metr,     tip_ost,  IRVK,
      term_type, term_min, term_max,
      br_id,     tt,       acc7,  
      comproc,   freq_v,   comments, flag,  type_id )
   VALUES 
     (:dfVIDD,     :dfCODE,   :dfNAME,     :dfKV, 
      :nTotalTerm, :chkAutoExt, 
      :dfBSD,      :dfBSN,    :nFlExtend,
      :nMinSum,    :nMaxSum,  :nMinSumAdd, :chkAdd,
      :dfSTOPID,   :dfPENYA,  :dfSHABLON,
      :dfBASEY,    :dfFREQN,  :dfMETR,     :dfOST,  :dfPeriodType,
      :nTermType,  :nTermMin, :nTermMax,
      :dfBRID,     :dfTT,     :dfACC7,
      :chkComproc, :dfFREQV,  :dfCOMMENTS, 0, :dfTYPE ) ")
and SqlCommitEx( hSql(),CurrentLangTable.GetAtomTitle('frm_ViddDetails.Created')||' № '||Str(dfVIDD)||' '||dfNAME)
.head 11 -  !
.head 11 -  ! Создан вид депозитного договора
.head 11 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.Created')||' № '||Str(dfVIDD)||' '||dfNAME, 
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_IconExclamation )
.head 11 -  Call F_POPULATE()
.head 10 +  Else
.head 11 -  ! Не удалось создать вид депозитного договора
.head 11 -  Set dfVIDD = NUMBER_Null
.head 11 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrCreate'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   0)
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.017"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Завершить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.pbCancel')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Pushbutton: pbVERSION
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.517"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call get_LibraryVersion()
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 546162546F704D61 7267696E00020030 0000546162466F72 6D50616765730003
0020: 0009090000546162 447261775374796C 65000B0057696E39 355374796C650000
0040: 5461625269676874 4D617267696E0002 003000005461624E 616D6573004600CE
0060: F1EDEEE2EDFBE520 EFE0F0E0ECE5F2F0 FB09CFE0F0E0ECE5 F2F0FB20EDE0F7E8
0080: F1EBE5EDE8FF20EF F0EEF6E5EDF2EEE2 09C4EEE4E0F2EAEE E2B320EFE0F0E0EC
00A0: E5F2F0E800005461 624C6162656C7300 15004C6162656C30 094C6162656C3109
00C0: 4C6162656C320000 5461625061676543 6F756E7400020031 0000546162426F74
00E0: 746F6D4D61726769 6E00020030000054 616243757272656E 74001300CEF1EDEE
0100: E2EDFBE520EFE0F0 E0ECE5F2F0FB0000 5461624C6566744D 617267696E000200
0120: 3000005461624F72 69656E746174696F 6E00010000000000 0000000000000000
0140: 0000000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4C01
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.036"
.head 5 -  Width:  11.15"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 5.821"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Yes
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 6 -  Call picTabs.SetLabel(0, ' ' || CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTabs0') || ' ', TRUE)
.head 6 -  Call picTabs.SetLabel(1, ' ' || CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTabs1') || ' ', TRUE)
.head 6 -  Call picTabs.SetLabel(2, ' ' || CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTabs2') || ' ', TRUE)
.head 5 +  On __TABSM_TabActivate
.head 6 -  Call SalSendClassMessage(__TABSM_TabActivate, 0, 0)
.head 3 -  Background Text: Штраф за досрочное расторжение:
.data CLASSPROPSSIZE
0000: 3200
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 9932
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    3.81"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSTOPID
.data CLASSPROPSSIZE
0000: 3200
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    3.78"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSTOP
.data CLASSPROPSSIZE
0000: 3200
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.2"
.head 5 -  Top:    3.798"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbSTOP.Init(hWndItem)
.head 6 -  Call cmbSTOP.Populate(hSql(), "ID", "NAME", "DPT_STOP", "WHERE MOD_CODE = 'DPU' OR MOD_CODE IS NULL ORDER BY 1")
.head 6 -  Call cmbSTOP.SetSelectById(dfSTOPID)
.head 5 +  On SAM_Click
.head 6 -  Set dfSTOPID = cmbSTOP.GetKey(SalListQuerySelection(cmbSTOP))
.head 3 -  Background Text: Пеня (%):
.data CLASSPROPSSIZE
0000: 3200
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 9933
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    3.33"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfPENYA
.data CLASSPROPSSIZE
0000: 3200
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    3.27"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfPENYA < 0 OR dfPENYA > 100
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  ! Закладка "Основные параметры"
.head 3 +  Data Field: dfTITLE
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.42"
.head 6 -  Width:  9.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold-Underline
.head 5 -  Text Color: Teal
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30939
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.738"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Тип договору:
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 22846
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    0.87"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbTYPE
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.32"
.head 5 -  Top:    0.83"
.head 5 -  Width:  5.68"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.0"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbTYPE.Init(hWndItem)
.head 6 -  Call cmbTYPE.Populate(hSql(),  "TYPE_ID", "TYPE_NAME", "DPU_TYPES", "WHERE fl_active = 1 " || IifS(  ( (sSegmentExists = 'Y') AND ( SalStrTrimX(strParF) != '' ) ), " AND SEGMENT = " || strParF, " " ) || " ORDER BY SORT_ORD")
.head 6 -  Call cmbTYPE.SetSelectById(dfTYPE)
.head 5 +  On SAM_Click
.head 6 -  Set dfTYPE = cmbTYPE.GetKey(SalListQuerySelection(cmbTYPE))
.head 3 +  Data Field: dfVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.267"
.head 6 -  Top:    0.083"
.head 6 -  Width:  0.543"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfCODE
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    1.083"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTYPE
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    0.83"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( dfTYPE )
.head 7 -  Call SalListSetSelect(cmbTYPE, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbTYPE.SetSelectById(dfTYPE)
.head 6 +  If cmbTYPE.nCurrentId
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  ! Неверно указан код валюты!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrTYPE'),
                                 CurrentLangTable.GetAtomTitle('cTErr'),
                                 MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 -  Background Text: Наименование вида договора:
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30936
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    1.119"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNAME
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.3"
.head 6 -  Top:    1.083"
.head 6 -  Width:  5.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Валюта договора:
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30937
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    1.381"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKV
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    1.345"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfKV)
.head 7 -  Call SalListSetSelect(cmbKV, -1)
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbKV.SetSelectById(dfKV)
.head 6 +  If cmbKV.nCurrentId
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  ! Неверно указан код валюты!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrKv'),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Data Field: dfLCV
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.3"
.head 6 -  Top:    1.345"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbKV
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.233"
.head 5 -  Top:    1.35"
.head 5 -  Width:  4.767"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbKV.Init(hWndItem)
.head 6 -  Call cmbKV.Populate(hSql(), "KV", "NAME", "TABVAL",
                            " WHERE (d_close IS NULL OR d_close > bankdate) ORDER BY kv DESC")
.head 6 -  Call cmbKV.SetSelectById(dfKV)
.head 5 +  On SAM_Click
.head 6 -  Set dfKV = cmbKV.GetKey(SalListQuerySelection(cmbKV))
.head 6 +  If SqlPrepareAndExecute(hSql(), "SELECT lcv INTO :dfLCV FROM tabval WHERE kv = :dfKV")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 3 +  Data Field: bgMNTHTERM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: bgDAYSTERM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Балансовый счет депозита:
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30942
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    1.94"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBSD
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    1.9"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Validate
.head 6 +  If dfBSD = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else 
.head 7 +  If SqlPrepareAndExecute(hSql(), "SELECT name INTO :cmbBSDNAME FROM ps WHERE nbs = :dfBSD")
And SqlFetchNext(hSql(), nFetchRes )
.head 8 +  If SqlPrepareAndExecute( hSql(), 
"SELECT  distinct  nbs_int  
   INTO :dfBSN  FROM  dpu_nbs4cust
  WHERE  nbs_dep = :dfBSD AND s181 = :dfPeriodType" ) And SqlFetchNext(hSql(), nFetchRes )
.head 9 -  Call SalSendMsg( dfBSN, SAM_Validate, 0, 0 )
.head 9 -  !
.head 9 +  ! If ( ( GetGlobalOption( 'BANKTYPE' ) != 'SBER' ) AND ( dfACC7 = NUMBER_Null OR dfNLS7 = STRING_Null ) )
.head 10 -  If SqlPrepareAndExecute(hSql(),
   "SELECT a.nls, a.acc, a.nms 
      INTO :dfNLS7, :dfACC7, :dfNMS7   
      FROM proc_dr p, accounts a
     WHERE p.nbs   = :dfBSD 
       AND p.rezid = 0
       AND p.sour  = 4 
       AND a.dazs  IS NULL 
       AND a.kv    = :nBaseCur  
       AND a.nls   = decode(:dfKV, :nBaseCur, p.g67, p.v67)")
and SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Return VALIDATE_Ok
.head 8 +  Else 
.head 9 -  ! бал.рах. не відповідає коду терміну виду депозиту
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrBS1') ||" "|| dfBSD ||" " || 
                   CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrBS3') || " " || Str(dfPeriodType) || "!",
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else 
.head 8 -  ! Бал.счет ... отсутствует в плане счетов
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrBS1') ||" "||dfBSD||" " || 
                   CurrentLangTable.GetAtomTitle( 'frm_ViddDetails.ErrBS2' ),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 8 -  Return VALIDATE_Cancel
.head 3 +  Combo Box: cmbBSDNAME
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.32"
.head 5 -  Top:    1.9"
.head 5 -  Width:  5.68"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.726"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Call SalSendMsg( cmbBSDNAME, SAM_User, 0, 0 )
.head 5 +  On SAM_Click
.head 6 +  If ( dfPeriodType = NUMBER_Null )
.head 7 -  Call SalMessageBox("Не вказано код строку для виду депозиту!",
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 6 +  Else
.head 7 -  Set dfBSD = cmbBSDNAME.GetKey(SalListQuerySelection(cmbBSDNAME))
.head 7 +  If ( dfBSD != STRING_Null )
.head 8 +  If SqlPrepareAndExecute( hSql(), 
"SELECT distinct  nbs_int  
   INTO :dfBSN
   FROM dpu_nbs4cust
  WHERE nbs_dep = :dfBSD
    AND IRVK = :dfPeriodType
") And SqlFetchNext(hSql(), nFetchRes )
.head 9 -  Call SalSendMsg( dfBSN, SAM_Validate, 0, 0 )
.head 5 +  On SAM_User
.head 6 +  If ( dfPeriodType != NUMBER_Null )
.head 7 -  Call cmbBSDNAME.Init(hWndItem)
.head 7 -  Call cmbBSDNAME.Populate(hSql(), "NBS_CODE", "NBS_NAME", "V_DPU_NBS", "where NBS_S181 = " || Str(dfPeriodType) )
.head 7 -  Call cmbBSDNAME.SetSelectById( dfBSD )
.head 3 -  Background Text: Балансовый счет процентов:
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30943
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    2.2"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBSN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBSN
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    2.17"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SqlPrepareAndExecute(hSql(), "SELECT name INTO :dfBSNNAME FROM ps WHERE nbs = :dfBSN")
and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 +  If dfBSN = STRING_Null
.head 8 -  Return VALIDATE_Ok
.head 7 +  Else
.head 8 -  ! Бал.счет ... отсутствует в плане счетов
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrBS1')||" "||dfBSN||" "|| 
                   CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrBS2'),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 8 -  Return VALIDATE_Cancel
.head 3 +  Data Field: dfBSNNAME
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.3"
.head 6 -  Top:    2.17"
.head 6 -  Width:  5.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 35024
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.65"
.head 5 -  Top:    3.417"
.head 5 -  Width:  2.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Миним.сумма депозита:
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 35023
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.167"
.head 5 -  Top:    3.536"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMINSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMINSUM
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    3.5"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfMINSUM <= 0 OR SalIsNull( dfMINSUM )
.head 7 -  ! Мінімальна сума не може бути меншою або рівною нулю
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTErrMinSum'),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If dfMAXSUM > 0 AND dfMINSUM > 0 AND dfMAXSUM < dfMINSUM
.head 7 -  ! Максимальная сумма не может быть меньше минимальной!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrMinMaxSum'),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Set nMinSum = dfMINSUM * 100
.head 3 -  Background Text: Макс.сумма депозита:
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 35022
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.167"
.head 5 -  Top:    3.81"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMAXSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMAXSUM
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    3.774"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfMAXSUM > 0 AND dfMINSUM > 0 AND dfMAXSUM < dfMINSUM
.head 7 -  ! Максимальная сумма не может быть меньше минимальной!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrMinMaxSum'),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Set nMaxSum = dfMAXSUM * 100
.head 3 -  Background Text: Миним.сумма пополнения:
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 35021
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.167"
.head 5 -  Top:    4.083"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMINSUMADD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMINSUMADD
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    4.048"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set nMinSumAdd = dfMINSUMADD * 100
.head 3 +  Check Box: chkAdd
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пополнение депозита
.head 4 -  Window Location and Size
.head 5 -  Left:   5.25"
.head 5 -  Top:    4.048"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If chkAdd = 1
.head 7 -  Call SalEnableWindow(dfMINSUMADD)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(dfMINSUMADD)
.head 7 -  Set dfMINSUMADD = NUMBER_Null
.head 7 -  Set nMinSumAdd  = NUMBER_Null
.head 3 -  !
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30953
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    3.417"
.head 5 -  Width:  7.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rb1
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: стандарт
.head 4 -  Window Location and Size
.head 5 -  Left:   7.7"
.head 5 -  Top:    3.5"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_RADIOBUTTON()
.head 3 +  Radio Button: rb2
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: деп.линия
.head 4 -  Window Location and Size
.head 5 -  Left:   7.7"
.head 5 -  Top:    3.774"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_RADIOBUTTON()
.head 3 +  Radio Button: rb3
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: деп.линия на 8 классе
.head 4 -  Window Location and Size
.head 5 -  Left:   7.7"
.head 5 -  Top:    4.048"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_RADIOBUTTON()
.head 3 -  !
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30951
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.571"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.036"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSTOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: bgPENYA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: bgSHABLON
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  ! Закладка "Параметры начисления" 
.head 3 -  !
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 3200
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 46198
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.643"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: База начисления процентов:
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30945
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.798"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBASEY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBASEY
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.762"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbBASEY
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.2"
.head 5 -  Top:    0.762"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbBASEY.Init(hWndItem)
.head 6 -  Call cmbBASEY.Populate(hSql(), "BASEY", "NAME", "BASEY", "ORDER BY 1")
.head 6 -  Call cmbBASEY.SetSelectById(dfBASEY)
.head 5 +  On SAM_Click
.head 6 -  Set dfBASEY = cmbBASEY.GetKey(SalListQuerySelection(cmbBASEY))
.head 3 -  Background Text: Период-ть начисления процентов:
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30947
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.048"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFREQN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFREQN
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.012"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbFREQN
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.2"
.head 5 -  Top:    1.012"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbFREQN.Init(hWndItem)
.head 6 -  Call cmbFREQN.Populate(hSql(), "FREQ", "NAME", "FREQ", "ORDER BY 1")
.head 6 -  Call cmbFREQN.SetSelectById(dfFREQN)
.head 5 +  On SAM_Click
.head 6 -  Set dfFREQN = cmbFREQN.GetKey(SalListQuerySelection(cmbFREQN))
.head 3 -  Background Text: Метод начисления процентов:
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30948
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.298"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMETR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMETR
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.262"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbMETR
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.2"
.head 5 -  Top:    1.262"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbMETR.Init(hWndItem)
.head 6 -  Call cmbMETR.Populate(hSql(),"METR", "NAME", "INT_METR", "ORDER BY 1")
.head 6 -  Call cmbMETR.SetSelectById(dfMETR)
.head 5 +  On SAM_Click
.head 6 -  Set dfMETR = cmbMETR.GetKey(SalListQuerySelection(cmbMETR))
.head 3 -  Background Text: Тип вычисления остатка:
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30950
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.548"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOST
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.512"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbOST
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.2"
.head 5 -  Top:    1.512"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbOST.Init( hWndItem )
.head 7 -  Call SalListClear(hWndItem)
.head 7 -  ! Исключая последний день
.head 7 -  Call cmbOST.Add(0,CurrentLangTable.GetAtomTitle('frm_ViddDetails.cmbOST0'))
.head 7 -  ! Исключая первый и последний дни
.head 7 -  Call cmbOST.Add(1,CurrentLangTable.GetAtomTitle('frm_ViddDetails.cmbOST1'))
.head 7 -  Call cmbOST.SetSelectById(dfOST)
.head 5 +  On SAM_Click
.head 6 -  Set dfOST = cmbOST.GetKey(SalListQuerySelection(cmbOST))
.head 3 -  Background Text: Базовая процентная ставка:
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30946
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.798"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBRID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBRID
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    1.762"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbBRATE
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.2"
.head 5 -  Top:    1.762"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbBRATE.Init(hWndItem)
.head 6 -  Call cmbBRATE.Populate(hSql(), "BR_ID", "NAME", "BRATES", "ORDER BY 1")
.head 6 -  Call cmbBRATE.Add(NUMBER_Null, '')
.head 6 -  Call cmbBRATE.SetSelectById(NUMBER_Null)
.head 6 -  Call cmbBRATE.SetSelectById(dfBRID)
.head 5 +  On SAM_Click
.head 6 -  Set dfBRID = cmbBRATE.GetKey(SalListQuerySelection(cmbBRATE))
.head 6 +  If cmbBRATE = STRING_Null
.head 7 -  Set dfBRID = NUMBER_Null
.head 3 -  Background Text: Операция для начисления:
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30949
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.048"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTT
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.012"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If NOT SalIsNull(dfTT)
.head 7 +  If SqlPrepareAndExecute(hSql(), "SELECT name INTO :dfTTNAME FROM tts WHERE tt=:dfTT")
.head 8 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfTTNAME
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.2"
.head 6 -  Top:    2.012"
.head 6 -  Width:  5.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Счет процентных расходов:
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30944
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    2.286"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLS7
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfACC7
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.733"
.head 6 -  Top:    2.262"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLS7
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.262"
.head 6 -  Width:  1.767"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Validate
.head 6 +  If NOT SalIsNull(dfNLS7)
.head 7 +  If SqlPrepareAndExecute(hSql(),
   "SELECT acc, nms 
      INTO :dfACC7, :dfNMS7 
      FROM accounts
     WHERE kv  = :nBaseCur
       AND nls = :dfNLS7 
       AND dazs IS NULL")
.head 8 +  If not SqlFetchNext( hSql(), nFetchRes)
.head 9 -  Return VALIDATE_Cancel
.head 6 +  Else 
.head 7 -  Set dfACC7  = NUMBER_Null
.head 7 -  Set dfNMS7 = STRING_Null
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNMS7
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.067"
.head 6 -  Top:    2.262"
.head 6 -  Width:  4.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Check Box: chkComproc
.data CLASSPROPSSIZE
0000: 3200
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Капитализация процентов
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    2.72"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Период-ть выплаты процентов:
.data CLASSPROPSSIZE
0000: 3200
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30952
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    3.036"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFREQV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFREQV
.data CLASSPROPSSIZE
0000: 3200
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    2.99"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbFREQV
.data CLASSPROPSSIZE
0000: 3200
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.2"
.head 5 -  Top:    3.0"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbFREQV.Init(hWndItem)
.head 6 -  Call cmbFREQV.Populate(hSql(),"FREQ", "NAME", "FREQ", "ORDER BY 1")
.head 6 -  Call cmbFREQV.SetSelectById(dfFREQV)
.head 5 +  On SAM_Click
.head 6 -  Set dfFREQV = cmbFREQV.GetKey(SalListQuerySelection(cmbFREQV))
.head 3 -  !
.head 3 +  Data Field: bgCOMMENTS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: bgSHABLON_GEN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: bgMETHOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPeriodType
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    1.62"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( dfPeriodType )
.head 7 -  Call SalListSetSelect( cmbPeriodType, -1 )
.head 7 -  Return VALIDATE_OkClearFlag
.head 6 -  Call cmbPeriodType.SetSelectById( Str( dfPeriodType ) )
.head 6 +  If cmbPeriodType.strCurrentId
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 -  ! Вказано недопустимий код строку!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle( 'frm_ViddDetails.ErrTermType' ),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  Combo Box: cmbPeriodType
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.32"
.head 5 -  Top:    1.62"
.head 5 -  Width:  5.68"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbPeriodType.Init(hWndItem)
.head 6 -  Call cmbPeriodType.Add( "0", "На вимогу (відкличний)" )
.head 6 -  Call cmbPeriodType.Add( "1", "Строковий (безвідкличний)" )
.head 6 -  Call cmbPeriodType.SetSelectById( Str(dfPeriodType) )
.head 5 +  On SAM_Click
.head 6 -  Set dfPeriodType = Val( cmbPeriodType.GetKey( SalListQuerySelection( cmbPeriodType ) ) )
.head 6 -  Call SalSendMsg( cmbBSDNAME, SAM_User, 0, 0 )
.head 6 -  Set dfBSD = STRING_Null
.head 6 -  Set dfBSN = STRING_Null
.head 6 -  Set dfBSNNAME = STRING_Null
.head 6 +  Select Case ( dfPeriodType )
.head 7 +  Case 1
.head 8 -  Set dfTERM_MIN_M = 01
.head 8 -  Set dfTERM_MAX_M = 36
.head 8 -  Break
.head 7 +  ! Case 2
.head 8 -  Set dfTERM_MIN_M = 13
.head 8 -  Set dfTERM_MAX_M = 36
.head 8 -  Break 
.head 7 +  Default
.head 8 -  Set dfTERM_MIN_M = 0 
.head 8 -  Set dfTERM_MAX_M = 0 
.head 6 -  Set dfTERM_MIN_D = 0 
.head 6 -  Set dfTERM_MAX_D = 0 
.head 3 -  Background Text: Строковість депозиту:
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 39018
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    1.67"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: chkIRREVOCABLE
.data CLASSPROPSSIZE
0000: 3000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001F00 CFE0F0E0ECE5F2F0 FB20EDE0F7E8F1EB
0020: E5EDE8FF20EFF0EE F6E5EDF2EEE20000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Безвідкличний 
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    3.55"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If chkIRREVOCABLE = 1
.head 7 -  Set dfSTOPID = -1
.head 7 -  Call frm_ViddDetails.cmbSTOP.SetSelectById( dfSTOPID )
.head 7 -  Call SalDisableWindow( cmbSTOP )
.head 7 -  ! безвідкличні депозити не можуть автолонгуватися
.head 7 -  Set chkAutoExt = 0
.head 7 -  ! Call SalDisableWindow( chkAutoExt )
.head 6 +  Else
.head 7 -  Set cmbSTOP  = STRING_Null
.head 7 -  Set dfSTOPID = NUMBER_Null
.head 7 -  Call SalEnableWindow( cmbSTOP )
.head 7 -  ! Call SalEnableWindow( chkAutoExt )
.head 3 -  Background Text: Комментарий:
.data CLASSPROPSSIZE
0000: 2700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001400 C4EEE4E0F2EAEEE2 B320EFE0F0E0ECE5
0020: F2F0E800000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 1773
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    3.595"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: dfCOMMENTS
.data CLASSPROPSSIZE
0000: 2700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001400 C4EEE4E0F2EAEEE2 B320EFE0F0E0ECE5
0020: F2F0E800000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 128
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.35"
.head 6 -  Top:    3.845"
.head 6 -  Width:  9.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.45"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 2700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001400 C4EEE4E0F2EAEEE2 B320EFE0F0E0ECE5
0020: F2F0E800000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 1776
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.702"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Check Box: chkAutoExt
.data CLASSPROPSSIZE
0000: 2700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001400 C4EEE4E0F2EAEEE2 B320EFE0F0E0ECE5
0020: F2F0E800000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Автопереоформление
.head 4 -  Window Location and Size
.head 5 -  Left:   4.0"
.head 5 -  Top:    0.53"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Min. к-ть Місяців:
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 1775
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    2.8"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTERM_MIN_M
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    2.75"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If ( SalIsNull(dfTERM_MIN_M) OR ( dfTERM_MIN_M < 0 ) )
.head 7 -  Set dfTERM_MIN_M = 0
.head 7 -  Return VALIDATE_Cancel
.head 6 -  ! -
.head 6 +  If ( dfTERM_MIN_M = 0 AND dfTERM_MIN_D = 0 )
.head 7 +  If ( dfPeriodType = 1 )
.head 8 -  Set dfTERM_MIN_D = 3
.head 6 -  ! --
.head 6 +  If ( dfTERM_MIN_M > 0 AND dfTERM_MIN_D > 0 )
.head 7 -  Set dfTERM_MIN_D = 0
.head 7 -  Set dfTERM_MAX_D = 0
.head 7 +  If ( dfTERM_MAX_M = 0 )
.head 8 +  If ( dfPeriodType = 1 )
.head 9 -  Set dfTERM_MAX_M = 36
.head 6 -  ! ---
.head 6 +  If Not F_CHECK_TERM( )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrTerm'),
                    CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Днів:
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 1774
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.1"
.head 5 -  Top:    2.8"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTERM_MIN_D
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.0"
.head 6 -  Top:    2.75"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If ( not SalIsNull(dfTERM_MIN_D) AND dfTERM_MIN_D < 0 )
OR ( dfTERM_MIN_M = 0 AND dfTERM_MIN_D = 0 )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If ( dfTERM_MIN_D > 0 AND dfTERM_MIN_M > 0 )
.head 7 -  Set dfTERM_MIN_M = 0
.head 7 -  Set dfTERM_MAX_M = 0
.head 7 +  If ( dfTERM_MAX_D = 0 )
.head 8 +  If ( dfPeriodType = 1 )
.head 9 -  Set dfTERM_MAX_D = 1095
.head 6 +  If Not F_CHECK_TERM( )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_ViddDetails.ErrTerm' ),
                    CurrentLangTable.GetAtomTitle('cTErr'),  MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Group Box: Термін депозитного договору
.data CLASSPROPSSIZE
0000: 2400
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 1777
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.53"
.head 5 -  Width:  7.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.85"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 1778
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.65"
.head 5 -  Top:    2.63"
.head 5 -  Width:  2.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbTermFixed
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Фіксований
.head 4 -  Window Location and Size
.head 5 -  Left:   7.767"
.head 5 -  Top:    2.73"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Фіксований 
.head 6 -  Call F_CHOICE_TERM( 1 )
.head 3 +  Radio Button: rbTermRange
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Діапазон
.head 4 -  Window Location and Size
.head 5 -  Left:   7.767"
.head 5 -  Top:    3.0"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Діапазон
.head 6 -  Call F_CHOICE_TERM( 2 )
.head 3 -  Background Text: Max. к-ть Місяців:
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 1779
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    3.1"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTERM_MAX_M
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    3.05"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If ( not SalIsNull(dfTERM_MAX_M) AND dfTERM_MAX_M < 0 )
OR ( dfTERM_MAX_M = 0 AND dfTERM_MAX_D = 0 )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If ( dfTERM_MAX_M > 0 AND dfTERM_MAX_D > 0 )
.head 7 -  Set dfTERM_MIN_D = 0
.head 7 -  Set dfTERM_MAX_D = 0
.head 7 +  If ( dfTERM_MIN_M = 0 )
.head 8 +  If ( dfPeriodType = 1 )
.head 9 -  Set dfTERM_MIN_M = 1
.head 6 +  If Not F_CHECK_TERM( )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_ViddDetails.ErrTerm'),
                    CurrentLangTable.GetAtomTitle('cTErr'),  MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Днів:
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 1780
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.1"
.head 5 -  Top:    3.1"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTERM_MAX_D
.data CLASSPROPSSIZE
0000: 2600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001300 CEF1EDEEE2EDFBE5 20EFE0F0E0ECE5F2
0020: F0FB00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.0"
.head 6 -  Top:    3.05"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If ( not SalIsNull(dfTERM_MAX_D) AND dfTERM_MAX_D < 0 )
OR ( dfTERM_MAX_D = 0 AND dfTERM_MAX_M = 0 )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If ( dfTERM_MAX_D > 0 AND dfTERM_MAX_M > 0 )
.head 7 -  Set dfTERM_MIN_M = 0
.head 7 -  Set dfTERM_MAX_M = 0
.head 7 +  If ( dfTERM_MIN_D = 0 )
.head 8 +  If ( dfPeriodType = 1 )
.head 9 -  Set dfTERM_MIN_D = 3
.head 6 +  If Not F_CHECK_TERM( )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_ViddDetails.ErrTerm' ),
                    CurrentLangTable.GetAtomTitle('cTErr'),  MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfSHABLON
.data CLASSPROPSSIZE
0000: 2700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001400 C4EEE4E0F2EAEEE2 B320EFE0F0E0ECE5
0020: F2F0E800000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 35
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.35"
.head 6 -  Top:    3.226"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Group Box: Шаблон договору:
.data CLASSPROPSSIZE
0000: 2500
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001400 C4EEE4E0F2EAEEE2 B320EFE0F0E0ECE5
0020: F2F0E80000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 24399
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.036"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.55"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Combo Box: cmbSHABLON 
.data CLASSPROPSSIZE
0000: 2700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001400 C4EEE4E0F2EAEEE2 B320EFE0F0E0ECE5
0020: F2F0E800000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.0"
.head 5 -  Top:    3.238"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.262"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbSHABLON.Init(hWndItem)
.head 6 -  Call cmbSHABLON.Populate(hSql(), "ID", "NAME", "DOC_SCHEME",
                                 " WHERE id IN 
                                          (SELECT r.id 
                                             FROM doc_root r, cc_vidd v 
                                            WHERE r.vidd     = v.vidd
                                              AND v.custtype = 2 
                                              AND v.tipd     = 2) 
                                   ORDER BY 1")
.head 6 -  !
.head 6 -  Call cmbSHABLON.Add('', '')
.head 6 -  Call cmbSHABLON.SetSelectById('')
.head 6 -  Call cmbSHABLON.SetSelectById(dfSHABLON)
.head 5 +  On SAM_Click
.head 6 -  Set dfSHABLON = cmbSHABLON.GetKey(SalListQuerySelection(cmbSHABLON))
.head 3 +  Data Field: dfMETHOD
.data CLASSPROPSSIZE
0000: 2700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001400 C4EEE4E0F2EAEEE2 B320EFE0F0E0ECE5
0020: F2F0E800000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    0.78"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Метод переоформлення:
.data CLASSPROPSSIZE
0000: 2700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001400 C4EEE4E0F2EAEEE2 B320EFE0F0E0ECE5
0020: F2F0E800000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 24401
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.83"
.head 5 -  Width:  2.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbMETHOD
.data CLASSPROPSSIZE
0000: 2700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001400 C4EEE4E0F2EAEEE2 B320EFE0F0E0ECE5
0020: F2F0E800000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.0"
.head 5 -  Top:    0.8"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.655"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbMETHOD.Init(hWndItem)
.head 6 -  Call cmbMETHOD.Populate(hSql(), "METHOD", "NAME", "DPT_EXTENSION_METHOD", "ORDER BY 1")
.head 6 -  Call cmbMETHOD.SetSelectById( dfMETHOD )
.head 5 +  On SAM_Click
.head 6 -  Set dfMETHOD = cmbMETHOD.GetKey(SalListQuerySelection(cmbMETHOD))
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 2700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573001400 C4EEE4E0F2EAEEE2 B320EFE0F0E0ECE5
0020: F2F0E800000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 24400
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.46"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: F_PREPARE
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalHideWindowAndLabel ( bgNLS7 )
.head 5 -  Call SalHideWindow( dfACC7 )
.head 5 -  Call SalHideWindow( dfNLS7 )
.head 5 -  Call SalHideWindow( dfNMS7 )
.head 5 -  ! вид договора - активный  
.head 5 +  If nEdit = 0
.head 6 -  Call SalDisableWindow(dfTYPE)
.head 6 -  Call SalDisableWindow(cmbTYPE)
.head 6 -  Call SalDisableWindow(dfKV)
.head 6 -  Call SalDisableWindow(cmbKV)
.head 6 -  Call SalDisableWindow(dfPeriodType )
.head 6 -  Call SalDisableWindow(cmbPeriodType )
.head 6 -  Call SalDisableWindow(dfTERM_MIN_M)
.head 6 -  Call SalDisableWindow(dfTERM_MIN_D)
.head 6 -  Call SalDisableWindow(dfBSD)
.head 6 -  Call SalDisableWindow(dfBSN)
.head 6 -  Call SalDisableWindow(rb1)
.head 6 -  Call SalDisableWindow(rb2)
.head 6 -  Call SalDisableWindow(rb3)
.head 6 -  Call SalDisableWindow(chkComproc)
.head 5 -  Call SalDisableWindow( cmbBASEY )
.head 5 -  Call SalDisableWindow( cmbOST )
.head 5 -  !
.head 5 -  Set nBaseCur = GetBaseVal()
.head 5 -  Set dfVIDD = nVidd
.head 5 -  Set dfTITLE = CurrentLangTable.GetAtomTitle('frm_ViddDetails.dfTITLE')
 || IifS(dfVIDD = NUMBER_Null, '', ' № '|| SalNumberToStrX( dfVIDD, 0 ) )
.head 5 -  Call SalSetWindowText(hWndForm, dfTITLE)
.head 5 +  If dfVIDD != NUMBER_Null
.head 6 -  Call F_POPULATE()
.head 5 +  Else
.head 6 -  Call F_START()
.head 3 +  Function: F_START
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dfNAME         = STRING_Null   
.head 5 -  Set dfCODE         = STRING_Null    
.head 5 -  Set dfKV           = NUMBER_Null
.head 5 -  Set dfLCV          = STRING_Null
.head 5 -  Set cmbKV          = STRING_Null
.head 5 -  Set dfTERM_MIN_M   = 0
.head 5 -  Set dfTERM_MIN_D   = 0
.head 5 -  Set rbTermRange    = TRUE
.head 5 -  Set chkAutoExt     = 0           
.head 5 -  Set dfBSD          = STRING_Null
.head 5 -  Set dfBSN          = STRING_Null
.head 5 -  Set cmbBSDNAME     = STRING_Null
.head 5 -  Set dfBSNNAME      = STRING_Null
.head 5 -  Set rb1            = TRUE
.head 5 -  Set chkAdd         = 0
.head 5 -  Set dfMINSUM       = NUMBER_Null 
.head 5 -  Set dfMAXSUM       = NUMBER_Null 
.head 5 -  Set dfMINSUMADD    = NUMBER_Null
.head 5 -  Call SalDisableWindow(dfMINSUMADD)
.head 5 -  Set nMinSum        = NUMBER_Null
.head 5 -  Set nMaxSum        = NUMBER_Null
.head 5 -  Set nMinSumAdd     = NUMBER_Null
.head 5 -  !
.head 5 -  Set dfPeriodType   = 1
.head 5 -  Set dfSTOPID       = NUMBER_Null
.head 5 -  Set cmbSTOP        = STRING_Null
.head 5 -  Set dfPENYA        = NUMBER_Null
.head 5 -  Set dfSHABLON      = STRING_Null
.head 5 -  Set cmbSHABLON     = STRING_Null
.head 5 -  !
.head 5 -  Set chkComproc   = 0
.head 5 -  Set dfBASEY      = 0
.head 5 -  Set dfFREQN      = 1
.head 5 -  Set dfMETR       = 0
.head 5 -  Set dfOST        = 1
.head 5 -  Set dfBRID       = NUMBER_Null
.head 5 -  Set cmbBRATE     = STRING_Null
.head 5 -  Set dfACC7       = NUMBER_Null
.head 5 -  Set dfNLS7       = STRING_Null
.head 5 -  Set dfNMS7       = STRING_Null
.head 5 -  Set dfFREQV      = NUMBER_Null
.head 5 -  Set cmbFREQV     = STRING_Null
.head 5 +  If SqlPrepareAndExecute(hSql(), 
"SELECT tt, name 
   INTO :dfTT, :dfTTNAME
   FROM bars.tts 
  WHERE tt = 'DU%' ")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set dfCOMMENTS  = STRING_Null
.head 5 -  !
.head 5 -  Call F_RADIOBUTTON()
.head 3 +  Function: F_POPULATE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute(hSql(),
"SELECT v.name, v.dpu_code, 
        tbv.kv, tbv.lcv, tbv.name, 
           v.srok, v.fl_autoextend, v.fl_extend,
           v.bsd, psd.name, v.bsn, psn.name, 
           v.min_summ, v.max_summ, v.limit, v.fl_add, 
           stp.id, stp.name, v.penya, 
           doc.id, doc.name,
           bsy.basey, bsy.name, 
           fqn.freq, fqn.name, 
           mtr.metr, mtr.name, nvl(v.tip_ost,0), v.IRVK,
           v.term_type, v.term_min, v.term_max,
           brt.br_id,  brt.name, 
           tts.tt, tts.name, 
           exp.acc, exp.nls, exp.nms, 
           v.comproc, fqv.freq, fqv.name,
           v.comments, v.type_id
      INTO :dfNAME,     :dfCODE, 
           :dfKV,       :dfLCV,      :cmbKV,
           :nTotalTerm, :chkAutoExt, :nFlExtend,
           :dfBSD,      :cmbBSDNAME,  :dfBSN,      :dfBSNNAME,
           :nMinSum,    :nMaxSum,    :nMinSumAdd, :chkAdd,
           :dfSTOPID,   :cmbSTOP,    :dfPENYA,
           :dfSHABLON,  :cmbSHABLON,
           :dfBASEY,    :cmbBASEY,
           :dfFREQN,    :cmbFREQN,
           :dfMETR,     :cmbMETR,    :dfOST,  :dfPeriodType,
           :nTermType,  :nTermMin,   :nTermMax,
           :dfBRID,     :cmbBRATE,   :dfTT,   :dfTTNAME,   
           :dfACC7,     :dfNLS7,     :dfNMS7, 
           :chkComproc, :dfFREQV,    :cmbFREQV,
           :dfCOMMENTS, :dfTYPE
      FROM dpu_vidd    v, 
           tabval      tbv,
           ps          psd,
           ps          psn,  
           dpt_stop    stp,             
           doc_scheme  doc, 
           basey       bsy,
           freq        fqn, 
           int_metr    mtr, 
           brates      brt, 
           tts         tts,
           accounts    exp,
           freq        fqv     
     WHERE v.vidd    = :dfVIDD       
       AND v.kv      = tbv.kv
       AND v.bsd     = psd.nbs
       AND v.bsn     = psn.nbs
       AND v.id_stop = stp.id     
       AND v.shablon = doc.id   (+)       
       AND v.basey   = bsy.basey     
       AND v.freq_n  = fqn.freq    
       AND v.metr    = mtr.metr     
       AND v.br_id   = brt.br_id(+)    
       AND v.tt      = tts.tt   (+) 
       AND v.acc7    = exp.acc  (+)       
       AND v.freq_v  = fqv.freq ")
and SqlFetchNext( hSql(), nFetchRes)
.head 6 -  ! Тип терміну (фіксований/діапазон)
.head 6 +  If ( nTermType != NUMBER_Null )
.head 7 -  Call F_CHOICE_TERM( nTermType )
.head 7 -  Call SalDisableWindow( rbTermFixed )
.head 7 -  Call SalDisableWindow( rbTermRange )
.head 7 -  Set dfTERM_MIN_M = SalNumberTruncate(nTermMin,3,0)
.head 7 -  Set dfTERM_MIN_D = SalNumberRound(SalNumberTruncate(SalNumberMod(nTermMin,1),4,4)*10000)
.head 7 -  Set dfTERM_MAX_M = SalNumberTruncate(nTermMax,3,0)
.head 7 -  Set dfTERM_MAX_D = SalNumberRound(SalNumberTruncate(SalNumberMod(nTermMax,1),4,4)*10000)
.head 6 +  Else
.head 7 -  ! Длительность вида договора (по старому)
.head 7 +  If nTotalTerm != NUMBER_Null 
.head 8 -  Set dfTERM_MIN_M = SalNumberTruncate(nTotalTerm,3,0)
.head 8 -  Set dfTERM_MIN_D = SalNumberRound(SalNumberTruncate(SalNumberMod(nTotalTerm,1),2,2)*100)
.head 7 +  Else
.head 8 -  Set dfTERM_MIN_M = NUMBER_Null
.head 8 -  Set dfTERM_MIN_D = NUMBER_Null
.head 6 -  ! Тип договора (стандарт / деп.линия на 8 классе)
.head 6 +  If nFlExtend = 0
.head 7 -  Set rb1 = TRUE
.head 6 +  Else If nFlExtend = 1
.head 7 -  Set rb2 = TRUE
.head 6 +  Else If nFlExtend = 2
.head 7 -  Set rb3 = TRUE
.head 6 -  ! Граничные суммы 
.head 6 -  Set dfMINSUM     = nMinSum   /100
.head 6 -  Set dfMAXSUM     = nMaxSum   /100
.head 6 -  Set dfMINSUMADD  = nMinSumAdd/100
.head 6 +  If ( chkAdd = 1 )
.head 7 -  Call SalEnableWindow(dfMINSUMADD)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(dfMINSUMADD)
.head 7 -  Set dfMINSUMADD = NUMBER_Null
.head 7 -  Set nMinSumAdd  = NUMBER_Null
.head 6 -  !
.head 6 +  If ( chkIRREVOCABLE = 1 )
.head 7 -  Call SalDisableWindow( cmbSTOP )
.head 7 -  Call SalDisableWindow( chkAutoExt )
.head 6 -  Call F_RADIOBUTTON()
.head 3 +  Function: F_CHECKDATA
.head 4 -  Description: Проверка заполнения обязательных полей
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErrorList
.head 5 -  Number: nErrorCount
.head 4 +  Actions
.head 5 -  Set sErrorList = ''
.head 5 -  Set nErrorCount = 0
.head 5 -  !
.head 5 +  If SalIsNull(dfNAME)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! Не заполнен реквизит <Наименование вида депозитного договора>
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'||CurrentLangTable.GetAtomTitle('frm_ViddDetails.dfNAME')||'>' || PutCrLf()
.head 5 +  If SalIsNull(cmbKV)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! Не заполнен реквизит <Валюта вида депозита>
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'||CurrentLangTable.GetAtomTitle('frm_ViddDetails.cmbKV')||'>' || PutCrLf()
.head 5 +  If SalIsNull( dfPeriodType )
.head 6 -  ! Не вказано код терміну виду депозиту
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') || ' <' || CurrentLangTable.GetAtomTitle( 'frm_ViddDetails.cmbPeriodType' ) || '>' || PutCrLf()
.head 5 +  If SalIsNull(dfBSD)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! Не заполнен реквизит <Бал.счет депозита>
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'||CurrentLangTable.GetAtomTitle('frm_ViddDetails.dfBSD')||'>' || PutCrLf()
.head 5 +  If SalIsNull(dfBSN)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! Не заполнен реквизит <Бал.счет начисл.%%>
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'||CurrentLangTable.GetAtomTitle('frm_ViddDetails.dfBSN')||'>' || PutCrLf()
.head 5 +  If SalIsNull(cmbBASEY)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! Не заполнен реквизит <Базовые параметры>
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'||CurrentLangTable.GetAtomTitle('frm_ViddDetails.cmbBASEY')||'>' || PutCrLf()
.head 5 +  If SalIsNull(cmbFREQN)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! Не заполнен реквизит <Периодичность начисл.%%>
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'||CurrentLangTable.GetAtomTitle('frm_ViddDetails.cmbFREQN')||'>' || PutCrLf()
.head 5 +  If SalIsNull(cmbFREQV)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! Не заполнен реквизит <Периодичность выплаты %%>
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'||CurrentLangTable.GetAtomTitle('frm_ViddDetails.cmbFREQV')||'>' || PutCrLf()
.head 5 +  If SalIsNull(cmbMETR)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! Не заполнен реквизит <Метод начисления %%>
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'||CurrentLangTable.GetAtomTitle('frm_ViddDetails.cmbMETR')||'>' || PutCrLf()
.head 5 +  If SalIsNull(cmbOST)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! Не заполнен реквизит <Тип остатка для начисления %%>
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'||CurrentLangTable.GetAtomTitle('frm_ViddDetails.cmbOST')||'>' || PutCrLf()
.head 5 +  If SalIsNull(cmbSTOP)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! Не заполнен реквизит <Штраф за досрочное расторжение>
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'||CurrentLangTable.GetAtomTitle('frm_ViddDetails.cmbSTOP')||'>' || PutCrLf()
.head 5 +  If SalIsNull(dfTT)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! Не заполнен реквизит <Код операции по начислению %%>
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'||CurrentLangTable.GetAtomTitle('frm_ViddDetails.dfTT')||'>' || PutCrLf()
.head 5 +  If ( nTermType = 2 AND ( nTermMin = 0 OR nTermMax = 0 ) )
.head 6 -  ! Не вказано період дії договору для виду депозиту
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'|| CurrentLangTable.GetAtomTitle('frm_ViddDetails.TermRange') ||'>' || PutCrLf()
.head 5 +  If ( nTermType = 1 AND ( nTermMin = 0 OR nTermMax = 0 ) )
.head 6 -  ! Не вказано термін дії договору для виду депозиту
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'|| CurrentLangTable.GetAtomTitle('frm_ViddDetails.TermFixed') ||'>' || PutCrLf()
.head 5 +  If SalIsNull ( dfSHABLON )
.head 6 -  ! Не вказано шаблон для друку депозитного договору
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'|| CurrentLangTable.GetAtomTitle('frm_ViddDetails.dfSHABLON') ||'>' || PutCrLf()
.head 5 +  If nErrorCount > 0
.head 6 -  ! Ошибка заполнения реквизитов
.head 6 -  Call SalMessageBox( sErrorList, CurrentLangTable.GetAtomTitle('_cTErrCheck'), MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: F_RADIOBUTTON
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nEdit = 1 AND GetGlobalOptionEx('DPULINE8') = 8
.head 6 -  Call SalEnableWindow(rb3)
.head 6 -  Call SalDisableWindow(rb2)
.head 5 +  Else
.head 6 -  Call SalDisableWindow(rb3)
.head 5 -  !
.head 5 +  If rb1
.head 6 -  Set nFlExtend = 0
.head 5 +  Else If rb2
.head 6 -  Set nFlExtend = 1
.head 5 +  Else
.head 6 -  Set nFlExtend = 2
.head 3 +  Function: F_CHECK_TERM
.head 4 -  Description: Перевірка відповідності вказаного терміну Коду строку (S181)
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bRetVal
.head 4 +  Actions
.head 5 -  Set bRetVal = TRUE
.head 5 +  ! If ( ( dfPeriodType = 1 ) AND ( dfTERM_MAX_M >  12 OR dfTERM_MAX_D >  365 ) )
.head 6 -  Set bRetVal = FALSE
.head 5 +  ! If ( ( dfPeriodType = 2 ) AND ( dfTERM_MIN_M <= 12 OR dfTERM_MIN_D <= 365 ) )
.head 6 -  Set bRetVal = FALSE
.head 5 -  Return bRetVal
.head 3 +  Function: F_CHOICE_TERM
.head 4 -  Description: Вибір типу терміну депозитного продукту
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nTerm
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nTermType = nTerm
.head 5 +  If ( nTerm = 1)
.head 6 -  ! << Фіксований >>
.head 6 -  Set rbTermFixed = TRUE
.head 6 -  !
.head 6 -  Set dfTERM_MAX_M = NUMBER_Null
.head 6 -  Set dfTERM_MAX_D = NUMBER_Null
.head 6 -  !
.head 6 -  Call SalDisableWindow( dfTERM_MAX_M )
.head 6 -  Call SalDisableWindow( dfTERM_MAX_D )
.head 5 +  Else
.head 6 -  ! << Діапазон >>
.head 6 -  Set rbTermRange = TRUE
.head 6 +  ! If ( ( dfTERM_MIN_M = 0 ) AND ( dfTERM_MIN_D = 0 ) )
.head 7 -  Set dfTERM_MIN_M = 1
.head 6 +  ! If ( ( dfTERM_MAX_M = 0 ) AND ( dfTERM_MAX_D = 0 ) )
.head 7 -  Set dfTERM_MAX_M = 36
.head 6 -  !
.head 6 -  Call SalEnableWindow( dfTERM_MIN_M )
.head 6 -  Call SalEnableWindow( dfTERM_MIN_D )
.head 6 -  Call SalEnableWindow( dfTERM_MAX_M )
.head 6 -  Call SalEnableWindow( dfTERM_MAX_D )
.head 3 +  Function: F_SYNC_TERM_FIELDS
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 -  Actions
.head 2 +  Window Parameters
.head 3 -  ! вид деп.договора (VIDD = NULL -> открытие)
.head 3 -  Number: nVidd
.head 3 -  ! 1 - неактивный, 0 - работающий
.head 3 -  Number: nEdit
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strParF
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  Number: nFlExtend
.head 3 -  Number: nBaseCur
.head 3 -  Number: nMinSum
.head 3 -  Number: nMaxSum
.head 3 -  Number: nMinSumAdd
.head 3 -  Number: nTotalTerm !!! for column SROK
.head 3 -  Number: nTermType
.head 3 -  Number: nTermMin   
.head 3 -  Number: nTermMax
.head 3 -  ! Window Handle: hWndChild
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_ViddDetails.dfTITLE') || ' ver. ' || sLibraryVersion )
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  Call F_PREPARE()
.head 4 +  If SalStatusSetVisible( hWndForm, TRUE )
.head 5 -  Call SalStatusSetText ( hWndForm, sLibraryVersion )
.head 3 +  On SAM_Destroy
.head 4 +  If hWndParent
.head 5 -  Call SalSendMsg(hWndParent, UM_Populate, 0, 0)
.head 1 +  Form Window: frm_Open
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Параметры Депозитного договора
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   0.39"
.head 4 -  Top:    0.275"
.head 4 -  Width:  15.083"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.155"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.429"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сохранить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipUpdate')
.head 6 +  On SAM_Click
.head 7 -  ! Новий договір
.head 7 +  If SalIsNull(dfDPU_ID)
.head 8 +  If F_VALIDATE ('NumAgreem')
.head 9 -  Set dfDPU_ID = f_createdeal()
.head 9 +  If NOT SalIsNull(dfDPU_ID)
.head 10 -  ! Открыт депозитный договор 
.head 10 -  Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('frm_Open.cTOpenDepDog')||' '||Str(frm_Open.dfDPU_ID))
.head 10 -  ! Cохранение депозитного договора
.head 10 -  Call MessageNoWait( CurrentLangTable.GetAtomTitle('frm_Open.cTMessSaveDepDog')||' '||Str(frm_Open.dfDPU_ID),
                    CurrentLangTable.GetAtomTitle('cTMessage'), 3, 0 )
.head 10 -  Call SalEnableWindow( pbPrint )
.head 10 -  Call SalEnableWindow( pbPasport )
.head 10 -  Call SalEnableWindow( pbAccounts )
.head 10 -  Call SalEnableWindow( pbSos )
.head 10 -  Call SalEnableWindow( pb_AddOption )
.head 10 -  Call SalDisableWindow( pbKlient   )
.head 10 -  Call SalDisableWindow( dfRNK )
.head 10 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 10 -  ! Ошибка при открытии депозитного договора
.head 10 -  Call MessageNoWait( CurrentLangTable.GetAtomTitle('frm_Open.cTErrOpenDepDog')||' '|| sErrMsg, 
                    CurrentLangTable.GetAtomTitle('cTErr'), 0, 1 )
.head 7 -  ! Прологація/корекція параметрів договору
.head 7 +  Else
.head 8 -  ! пролонгція
.head 8 +  If bProl
.head 9 +  If F_PROLONG()
.head 10 -  Set bProl = FALSE
.head 10 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 8 -  ! зміна параметрів
.head 8 +  Else
.head 9 +  If f_updealparams()
.head 10 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Очистить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipRefresh')
.head 6 +  On SAM_Click
.head 7 +  If SalIsNull(dfDPU_ID)
.head 8 +  If pDPU_GEN = NUMBER_Null
.head 9 -  Call F_HIDE_SHOW ('PREPARE')
.head 8 +  Else
.head 9 -  Call f_prepareagr()
.head 7 +  Else
.head 8 -  Call f_populate()
.head 4 +  Pushbutton: pbSos
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Docview.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Текущее состояние договора
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipSos')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(dfDPU_ID)
.head 8 +  If not IsWindow(hWin6)   
.head 9 -  Set hWin6 = SalCreateWindow(frm_Dog, hWndMDI, nMode,
                            frm_Open.dfDPU_ID,   frm_Open.dfND, 
                            frm_Open.pDPU_GEN,   frm_Open.dfDPUADD,
                            frm_Open.dfNMK,      frm_Open.dfKV,      frm_Open.cmbKV,
                            frm_Open.cmbFREQ,    frm_Open.dfVIDD,    frm_Open.cmbVIDD,
                            frm_Open.dfSUM,      frm_Open.dfSTOPID,  frm_Open.dfMIN_SUM,
                            frm_Open.dfDATZ,     frm_Open.dfDATN,
                            frm_Open.dfDATO,     frm_Open.dfDATV,
                            Str(frm_Open.dfMFOD),frm_Open.dfNLSD,    frm_Open.dfNMSD)
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop(frm_Dog)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.25"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Печать договора
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipPrint')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(dfDPU_ID)
.head 8 -  Call cdoc_ShowAllDocs(dfDPU_ID, hWndForm)
.head 4 +  Pushbutton: pbPasport
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Custcorp.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Паспорт клиента
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipPasport')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(dfRNK)
.head 8 -  Call EditCustCorps(frm_Open.dfRNK, CVIEW_ReadOnly|CVIEW_Accounts, hWndMDI)
.head 4 +  Pushbutton: pbAccounts
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSort
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.817"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Табличная форма счетов депозита
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipAccounts')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(dfDPU_ID)
.head 8 +  If nMode = 1 OR (VisGetKeyState(VK_Alt) & KS_Down) AND (VisGetKeyState(VK_Control) & KS_Down)
.head 9 -  Call ShowAccList(dfRNK, 
                 AVIEW_CUST,
                 AVIEW_Financial|
                 AVIEW_Linked   |
                 AVIEW_Limit    |
                 AVIEW_Special  |
                 AVIEW_Blocked  |
                 AVIEW_Interest |
                 AVIEW_NoClose,
                 " a.acc in (SELECT accid FROM dpu_accounts WHERE dpuid = "||Str(dfDPU_ID)||")")
.head 9 -  Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 8 -  ! < тільки перегляд параметрів рахунка >
.head 8 +  Else
.head 9 -  Call ShowAccList( dfRNK,
                 AVIEW_CUST,
                 AVIEW_Financial|
                 AVIEW_Linked   |
                 AVIEW_Limit    |
                 AVIEW_Special  |
                 AVIEW_Blocked  |
                 AVIEW_Interest |
                 AVIEW_ReadOnly,
                 " a.acc in (SELECT accid FROM dpu_accounts WHERE dpuid = "||Str(dfDPU_ID)||")")
.head 4 +  Pushbutton: pbChilds
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Открыть доп.соглашение
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipChilds')
.head 6 +  On SAM_Click
.head 7 -  ! Вы действительно хотите открыть доп.соглашение по данному договору?
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Open.cTMessOpenQuestion'), 
	          CurrentLangTable.GetAtomTitle('cTAt'),
                  MB_IconQuestion|MB_YesNo) = IDYES
.head 8 -  Set pDPU_GEN = dfDPU_ID
.head 8 -  Call f_prepareagr()
.head 4 +  Pushbutton: pbCombine
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.1"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\RELATION.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Изменить вида договора на комбинированный
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipCombine')
.head 6 +  On SAM_Click
.head 7 -  ! Изменить вид договора на комбинированный 
  и открыть связанный договор до востребования?
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Open.cTMessCombineQuestion1')||PutCrLf()||
                  CurrentLangTable.GetAtomTitle('frm_Open.cTMessCombineQuestion2'), 
                  CurrentLangTable.GetAtomTitle('cTAt'), 
                  MB_IconQuestion|MB_YesNo ) = IDYES
.head 8 -  Set nSUBDEALID = f_createsubdeal()
.head 8 +  If nSUBDEALID > 0
.head 9 -  ! Вид депозитного договора № изменен на комбинированный,
  открыт связанный договор до востребования №  
.head 9 -  Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal1')
                         ||' '||Str(frm_Open.dfDPU_ID)
                         ||CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal2')
                         ||', '
                         ||CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal3')
                         ||' '||Str(frm_Open.nSUBDEALID)
                 )
.head 9 -  Call MessageNoWait (CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal1')
                         ||' '||Str(frm_Open.dfDPU_ID)
                         ||CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal2')
                         ||', '
                         ||CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal3')
                         ||' '||Str(frm_Open.nSUBDEALID),
                    CurrentLangTable.GetAtomTitle('cTMessage'),
                    3,
                    0)
.head 9 -  Call SalDisableWindow(pbCombine)
.head 9 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 4 +  Pushbutton: pbDubl
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.55"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\prolong.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Пролонгація депозитного договору
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipDubl')
.head 6 +  On SAM_Click
.head 7 -  Set bProl = TRUE
.head 7 -  !
.head 7 -  Call F_HIDE_SHOW ( 'ReadOnly' )
.head 7 -  ! Депозитні Лінії
.head 7 +  If ( ( nFlExtend = 2 ) AND ( dfDPUADD = 0 ) )
.head 8 -  Set dfDATN = dfDATO
.head 8 +  If ( nPeriodType = 0 )
.head 9 -  Set dfDATO = GetCloseDate(dfDATN, nMaxTerm, dfKV)
.head 8 +  Else
.head 9 +  If ( nMaxTerm > 12 ) OR ( nMaxTerm > 0.0365 AND nMaxTerm < 1)
.head 10 -  Set dfDATO = GetCloseDate(dfDATN, 36, dfKV)
.head 9 +  Else
.head 10 -  Set dfDATO = GetCloseDate(dfDATN, 12, dfKV)
.head 8 -  Set dfDATV = dfDATO
.head 7 +  Else
.head 8 -  ! Дати угоди
.head 8 +  If ( sDptBankType = 'SBER' )
.head 9 -  ! Для Ощадбанку 
.head 9 -  Set dfDATN = dfDATV
.head 9 -  Set dfBRDAT = dfDATV
.head 8 +  Else
.head 9 -  Set dfDATN = dfDATO
.head 9 -  Set dfBRDAT = dfDATO
.head 8 -  Set dfDATO = f_GetNewDateClose( dfDPU_ID )
.head 8 -  Set dfDATV = f_GetDateReturn()
.head 8 -  Set dfKTDAY= F_CALC_KTDAYS()
.head 8 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 8 -  Call SalEnableWindow( pbIR )
.head 8 -  Call SalEnableWindow( dfIR )
.head 8 -  Call SalEnableWindow( dfDATO )
.head 7 -  Call SalDisableWindow( pbRefresh )
.head 7 -  Call SalDisableWindow( pbSos )
.head 7 -  Call SalDisableWindow( pb_AddOption )
.head 7 -  Call SalEnableWindow( pbUpdate )
.head 4 +  Pushbutton: pb_CreateAgreement
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.45"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Agreement.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Додаткові параметри
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipCreateAgreement')
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog( dlg_AgreementCreate, hWndMDI, dfDPU_ID )
.head 4 -  Line
.head 5 -  Resource Id: 22309
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.6"
.head 6 -  Begin Y:  0.071"
.head 6 -  End X:  5.6"
.head 6 -  End Y:  0.381"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.833"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выйти
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipCancel')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Pushbutton: pb_AddOption
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\add.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Додаткові параметри
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipAddOption')
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog( dlg_Additional_Options, hWndMDI,  nMode, frm_Open.dfRNK, sCOMMENT, nTRUSTID )
.head 4 +  Pushbutton: pb_PayOutSwiftDetails
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.9"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SWIFT.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! SWIFT реквізити для виплати
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipPayOutSwiftDetails')
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog( dlg_DealPayOutSwiftDetails, hWndMDI, dfDPU_ID )
.head 2 +  Contents
.head 3 -  ! З А Г О Л О В О К
.head 3 +  Data Field: dfTITLE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.883"
.head 6 -  Top:    0.04"
.head 6 -  Width:  9.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.24"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! Background Text: № счета:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.6"
.head 5 -  Top:    0.333"
.head 5 -  Width:  1.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.end
.head 3 +  ! cLabelControl: bgNLS
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  ! Data Field: dfNLS
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   12.6"
.head 6 -  Top:    0.286"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfDPU_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.733"
.head 6 -  Top:    0.083"
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! К Л И Е Н Т
.head 3 +  Picture: picClient
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.417"
.head 5 -  Width:  6.817"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.05"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Клиент
.head 4 -  Resource Id: 35359
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    0.321"
.head 5 -  Width:  1.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKlient
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Рег.№:
.head 4 -  Resource Id: 41152
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.619"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.25"
.head 6 -  Top:    0.595"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If Not SalIsNull( dfRNK )
.head 7 -  Call f_GetCustParams()
.head 7 -  ! << Якщо в картці клієнта не заповнений параметр К013 >>
.head 7 +  If SalIsNull( frm_Open.dfK013 )
.head 8 -  Call SalMessageBox( "Для вибраного клєнта незаповнено параметр K013 !" || Chr(10) || "Неможливо вибрати вид депозиту !"
                  , CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 7 +  Else
.head 8 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 3 -  Background Text: ЄДРПОУ:
.head 4 -  Resource Id: 41153
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    0.619"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.55"
.head 6 -  Top:    0.595"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Наименование:
.head 4 -  Resource Id: 41154
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.881"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.25"
.head 6 -  Top:    0.869"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Адрес:
.head 4 -  Resource Id: 41155
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.155"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgADRES
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfADRES
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.25"
.head 6 -  Top:    1.131"
.head 6 -  Width:  3.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: K013:
.head 4 -  Resource Id: 2580
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.65"
.head 5 -  Top:    1.167"
.head 5 -  Width:  0.63"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfK013
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.3"
.head 6 -  Top:    1.131"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbKlient
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.3"
.head 5 -  Top:    0.595"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Поиск клиента
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipKlient')
.head 5 +  On SAM_Click
.head 6 -  Set sTmp = STRING_Null
.head 6 +  If ( (sSegmentExists = 'Y') AND ( nSegment != NUMBER_Null ) )
.head 7 -  Call FunNSIGetFiltered( "CUSTOMER", "NMK",
                       " customer.DATE_OFF is NULL 
                          and exists ( select 1 from customerw w where w.rnk = customer.rnk and w.tag = 'SEGM' and SubStr(value, 1, 1) = '" || Str( nSegment ) || "' ) ", 
                       sTmp, dfNMK )
.head 6 +  Else
.head 7 -  Call FunNSIGetFiltered( "CUSTOMER", "NMK",
                        " customer.date_off IS NULL AND (customer.custtype = 2 OR (customer.custtype = 3 AND substr(customer.sed, 1, 2) IN ('91', '34')))", 
                       sTmp, dfNMK )
.head 6 +  If ( sTmp != STRING_Null )
.head 7 -  Set dfRNK = Val( sTmp )
.head 7 -  Call SalSendMsg( dfRNK, SAM_Validate, 0, 0 )
.head 3 -  ! В И Д   Д О Г О В О Р А
.head 3 +  Picture: picType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.0"
.head 5 -  Top:    0.417"
.head 5 -  Width:  7.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.048"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Вид договора
.head 4 -  Resource Id: 10603
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.183"
.head 5 -  Top:    0.321"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDealType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Продукт:
.head 4 -  Resource Id: 63613
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.1"
.head 5 -  Top:    0.619"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTYPEID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.95"
.head 6 -  Top:    0.58"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbTYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.65"
.head 5 -  Top:    0.59"
.head 5 -  Width:  4.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: 35
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If ( cmbTYPE = STRING_Null )
.head 7 -  Call cmbTYPE.Init(hWndItem)
.head 7 -  Call cmbTYPE.Populate( hSql(), 'type_id', 'type_name', 'dpu_types',  'WHERE fl_active = 1 ' || IifS( ( (sSegmentExists = 'Y') AND ( nSegment != NUMBER_Null ) ), " AND segment = " || Str( nSegment ), " ") || ' order by sort_ord')
.head 7 -  Call cmbTYPE.SetSelectById(dfTYPEID)
.head 5 +  On SAM_Click
.head 6 -  Set dfTYPEID = cmbTYPE.GetKey(SalListQuerySelection(cmbTYPE))
.head 6 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 3 -  Background Text: Валюта:
.head 4 -  Resource Id: 41150
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.1"
.head 5 -  Top:    0.881"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.1"
.head 6 -  Top:    0.833"
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfISO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.95"
.head 6 -  Top:    0.85"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.65"
.head 5 -  Top:    0.857"
.head 5 -  Width:  4.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbKV = STRING_Null
.head 7 -  Call cmbKV.Init(hWndItem)
.head 7 -  Call cmbKV.Populate( hSql(), "kv", "name", "tabval", 
                             " where d_close is null and kv in (select distinct kv from dpu_vidd)")
.head 7 -  Call cmbKV.SetSelectById(dfKV)
.head 5 +  On SAM_Click
.head 6 -  Set dfKV = cmbKV.GetKey(SalListQuerySelection(cmbKV))
.head 6 -  ! If SalIsNull(dfISO)
.head 6 -  If SqlPrepareAndExecute(hSql(), 
   "SELECT lcv INTO :dfISO FROM tabval WHERE kv = :dfKV") 
and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 3 -  Background Text: Вид договора:
.head 4 -  Resource Id: 41148
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.1"
.head 5 -  Top:    1.155"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.95"
.head 6 -  Top:    1.12"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.65"
.head 5 -  Top:    1.131"
.head 5 -  Width:  4.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: 35
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! якщо є доступ 
.head 6 +  ! If ( nMode = 1 )
.head 7 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfVIDD = cmbVIDD.nCurrentId
.head 6 +  If ( dfVIDD != NUMBER_Null ) And f_get_viddpar()
.head 7 -  ! << Якщо термін депозиту != 0 >>
.head 7 +  If ( nMaxTerm != 0 )
.head 8 -  Set dfDATO = GetCloseDate(dfDATN, nMaxTerm, dfKV)
.head 8 -  Set dfDATV = f_GetDateReturn()
.head 8 -  Set dfKTDAY= F_CALC_KTDAYS()
.head 8 -  ! фіксований термін депозиту
.head 8 +  If ( nTermType = 1 )
.head 9 -  Call SalDisableWindow( dfDATO )
.head 8 +  Else
.head 9 -  Call SalEnableWindow( dfDATO )
.head 7 -  ! <<<< Якщо генугода >>>>
.head 7 +  If ( nFlExtend = 2 ) AND ( pDPU_GEN = NUMBER_Null )
.head 8 +  If ( nPeriodType = 1 )
.head 9 -  ! Строковий депозит
.head 9 +  If ( nMaxTerm > 12 ) OR ( nMaxTerm > 0.0365 AND nMaxTerm < 1 )
.head 10 -  ! Довгострокова деп. лінія
.head 10 -  Set dfDATO = GetCloseDate(dfDATN, 36, dfKV)
.head 9 +  Else
.head 10 -  ! Короткострокова деп. лінія
.head 10 -  Set dfDATO = GetCloseDate(dfDATN, 12, dfKV)
.head 8 -  Set dfDATV = dfDATO
.head 8 -  Set dfIR = 0
.head 8 -  Set cbIR = 1
.head 8 -  Set cbBR = 0
.head 8 -  Call F_HIDE_SHOW( 'GEN_IR' )
.head 7 +  Else
.head 8 -  Set dfSUM = dfMIN_SUM
.head 8 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 8 -  Call F_HIDE_SHOW('REFRESH_RATES')
.head 5 +  On SAM_User
.head 6 -  Call cmbVIDD.Init(hWndItem)
.head 6 -  Call cmbVIDD.Populate( hSql(), "VIDD", "NAME", "DPU_VIDD", 
" WHERE flag = 1 "
|| IifS(frm_Open.dfTYPEID != NUMBER_Null AND frm_Open.dfTYPEID!= 0, " AND type_id = "||Str(frm_Open.dfTYPEID), "")
|| IifS(frm_Open.dfKV  != NUMBER_Null AND frm_Open.dfKV  != 0, " AND kv  = " || Str(frm_Open.dfKV), "")
|| IifS(frm_Open.nFlExtend = 2 AND frm_Open.pDPU_GEN != NUMBER_Null, " AND irvk = "||Str(frm_Open.nPeriodType), "")
|| " AND bsd IN (SELECT nbs_dep FROM bars.dpu_nbs4cust WHERE k013 = " || IifS(frm_Open.dfK013  = STRING_Null, "0", frm_Open.dfK013) || ")
 ORDER BY vidd ")
.head 6 -  ! If ( nFlExtend = 2 ) AND ( pDPU_GEN = NUMBER_Null )
.head 6 -  ! !!Call cmbVIDD.Populate(hSql(), "VIDD", "NAME", "DPU_VIDD", 
  " WHERE flag = 1 "
||IifS(frm_Open.dfTYPEID!= NUMBER_Null AND frm_Open.dfTYPEID!= 0, " AND type_id = "||Str(frm_Open.dfTYPEID), "")
||IifS(frm_Open.dfKV    != NUMBER_Null AND frm_Open.dfKV    != 0, " AND kv      = "||Str(frm_Open.dfKV),     "")
||IifS(frm_Open.dfK013  != STRING_Null, " AND bsd IN (SELECT nbs FROM dpu_nbs4cust WHERE k013 = "||frm_Open.dfK013||")", "")
||" ORDER BY vidd")
.head 6 -  Call cmbVIDD.SetSelectById(dfVIDD)
.head 3 -  ! П А Р А М Е Т Р Ы
.head 3 +  Picture: picParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.619"
.head 5 -  Width:  6.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.56"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Параметры
.head 4 -  Resource Id: 63617
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    1.512"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Номер договору:
.head 4 -  Resource Id: 41147
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.821"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 35
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.25"
.head 6 -  Top:    1.798"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If pDPU_GEN != NUMBER_Null AND dfDPU_ID = NUMBER_Null AND NOT SalStrToNumber(dfND)
.head 7 -  ! Номер доп.соглашения НЕ должен содержать символы
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrNomDopSogl'), 
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Сумма договора:
.head 4 -  Resource Id: 41149
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.083"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.25"
.head 6 -  Top:    2.06"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If Not SalIsNull( dfSUM )
.head 7 +  If ( dfMIN_SUM > 0 AND dfSUM < dfMIN_SUM )
.head 8 -  ! Сума договору менша мінімально допустимої!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrMinSum'),
                   CurrentLangTable.GetAtomTitle('cTErr'), 
                   MB_IconStop)
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If ( nMaxAmnt > 0 AND dfSUM > nMaxAmnt )
.head 8 -  ! Сума договору більша максимально допустимої!
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrMaxSum')||' ('||Str(nMaxAmnt)||')!',
                    CurrentLangTable.GetAtomTitle('cTErr'),
                    MB_IconStop )
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 +  If dfDPU_ID = NUMBER_Null
.head 8 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 7 -  Return VALIDATE_Ok
.head 3 -  Background Text: Неснижаемый остаток:
.head 4 -  Resource Id: 35362
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.321"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMIN_SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMIN_SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.25"
.head 6 -  Top:    2.321"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfSUM  != NUMBER_Null AND 
dfMIN_SUM != NUMBER_Null AND 
dfMIN_SUM >  dfSUM
.head 7 -  ! Неснижаемый остаток превышает сумму по договору!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrMinSum'),
                   CurrentLangTable.GetAtomTitle('cTErr'), 
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 -  Background Text: Выплата процентов:
.head 4 -  Resource Id: 22308
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.607"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFREQ_V
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFREQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.217"
.head 6 -  Top:    2.607"
.head 6 -  Width:  0.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbFREQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.25"
.head 5 -  Top:    2.583"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Yes
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbFREQ.Init(hWndItem)
.head 6 -  Call cmbFREQ.Populate(hSql(), "FREQ", "NAME", "FREQ", "ORDER BY 1")
.head 6 -  Call cmbFREQ.SetSelectById(dfFREQ)
.head 5 +  On SAM_Click
.head 6 -  Set dfFREQ = cmbFREQ.GetKey( SalListQuerySelection(cmbFREQ))
.head 3 -  Background Text: Штраф:
.head 4 -  Resource Id: 35364
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.845"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSTOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSTOPID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.217"
.head 6 -  Top:    2.857"
.head 6 -  Width:  0.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSTOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.25"
.head 5 -  Top:    2.845"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.0"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbSTOP.Init(hWndItem)
.head 6 -  Call cmbSTOP.Populate(hSql(), "ID", "NAME", "DPT_STOP", "WHERE MOD_CODE = 'DPU' OR MOD_CODE IS NULL ORDER BY 1")
.head 6 -  Call cmbSTOP.SetSelectById(dfSTOPID)
.head 5 +  On SAM_Click
.head 6 -  Set dfSTOPID = cmbSTOP.GetKey(SalListQuerySelection(cmbSTOP))
.head 3 -  ! Д А Т Ы
.head 3 +  Picture: picDates
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.467"
.head 5 -  Top:    1.619"
.head 5 -  Width:  3.167"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.56"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Даты
.head 4 -  Resource Id: 35360
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.6"
.head 5 -  Top:    1.5"
.head 5 -  Width:  0.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Оформления:
.head 4 -  Resource Id: 41157
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    1.762"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.2"
.head 6 -  Top:    1.738"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfDATZ = DptCorrectDate(dfKV, dfDATZ, dfDATZ + 1)
.head 6 -  Set dfBRDAT = dfDATZ
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Начала:
.head 4 -  Resource Id: 41158
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    2.024"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.2"
.head 6 -  Top:    2.012"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfDATN < dfDATZ
.head 7 -  ! Некорректно задана дата!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrDat'), 
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_IconExclamation)
.head 7 -  Set dfDATN = dfDATZ
.head 7 -  Call SalSetFocus(dfDATN)
.head 6 -  Set dfDATN = DptCorrectDate(dfKV, dfDATN, dfDATN + 1)
.head 6 +  If ( nMaxTerm != 0 )
.head 7 -  Set dfDATO = GetCloseDate(dfDATN, nMaxTerm, dfKV)
.head 7 -  Set dfDATV = f_GetDateReturn()
.head 6 +  If dfDPU_ID = NUMBER_Null
.head 7 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Завершения:
.head 4 -  Resource Id: 41159
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    2.286"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.2"
.head 6 -  Top:    2.274"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If NOT SalIsNull( dfDATO )
.head 7 +  If F_VALIDATE( 'DATO' ) 
.head 8 -  Set dfDATV = f_GetDateReturn()
.head 8 -  Set dfKTDAY= F_CALC_KTDAYS()
.head 8 +  If dfDPU_ID = NUMBER_Null
.head 9 -  Set dfIR = f_getscalerate( dfVIDD, dfDATN, dfDATO, dfSUM, FALSE )
.head 8 -  Return VALIDATE_Ok
.head 7 +  Else
.head 8 -  Set dfDATO = GetCloseDate(dfDATN, nMaxTerm, dfKV)
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Cancel
.head 5 +  ! On SAM_KillFocus
.head 6 -  Set dfKTDAY= F_CALC_KTDAYS()
.head 3 -  Background Text: Возврата:
.head 4 -  Resource Id: 41160
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    2.548"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.2"
.head 6 -  Top:    2.548"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If NOT SalIsNull( dfDATV )
.head 7 +  If ( ( dfDATV >= dfDATO ) AND ( dfDATV > dfDATN ) AND ( dfDATV > dfDATZ ) )
.head 8 -  Set dfDATV = f_GetDateReturn()
.head 8 -  Set dfKTDAY= F_CALC_KTDAYS()
.head 8 -  Return VALIDATE_Ok
.head 6 -  ! Некорректно задана дата!
.head 6 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrDat'), CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 6 -  Set dfDATV =dfDATO
.head 6 -  Return VALIDATE_Cancel
.head 3 -  !
.head 3 -  Background Text: к-ть днів:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 38414
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.85"
.head 5 -  Top:    2.833"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Chartreuse
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKTDAY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKTDAY
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.2"
.head 6 -  Top:    2.81"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! К-ть днів за які буде нараховано %%
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_Open.cFTipKTDAY' ) )
.head 3 -  !
.head 3 -  Background Text: К-ть прол.:
.head 4 -  Resource Id: 4584
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   12.183"
.head 5 -  Top:    0.14"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDubl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDubl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   13.65"
.head 6 -  Top:    0.09"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! П Р О Ц Е Н Т Н А Я   С Т А В К А
.head 3 +  Picture: picRate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.683"
.head 5 -  Top:    1.619"
.head 5 -  Width:  4.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.27"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: %% ставка
.head 4 -  Resource Id: 35361
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.933"
.head 5 -  Top:    1.512"
.head 5 -  Width:  1.533"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbCOMPROC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: капитализация процентов
.head 4 -  Window Location and Size
.head 5 -  Left:   9.8"
.head 5 -  Top:    1.7"
.head 5 -  Width:  3.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_HIDE_SHOW( 'COMPROC' )
.head 3 +  Check Box: cbIR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: инд.
.head 4 -  Window Location and Size
.head 5 -  Left:   9.8"
.head 5 -  Top:    2.0"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_HIDE_SHOW ('CLICK_RATES')
.head 3 +  Data Field: dfIR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.23"
.head 6 -  Top:    1.95"
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Индивидуальная % ставка 
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Open.cFTipIR'))
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( dfIR ) OR ( dfIR <= 0 )
.head 7 -  ! ВІДСОТКОВА СТАВКЕ МАЄ БУТИ БІЛЬШЕ НУЛЯ
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrMinRate'),
                   CurrentLangTable.GetAtomTitle('cTErr'), 
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else If ( dfIR >= 100 )
.head 7 -  ! ВІДСОТКОВА СТАВКЕ МАЄ БУТИ МЕНШЕ СТА
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrMaxRate'),
                    CurrentLangTable.GetAtomTitle('cTErr'), 
                    MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfBRDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   12.183"
.head 6 -  Top:    1.95"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата установки ставки 
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Open.cFTipBRDAT'))
.head 3 -  Background Text: опер.
.head 4 -  Resource Id: 63618
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.8"
.head 5 -  Top:    2.3"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfOPID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.2"
.head 6 -  Top:    2.333"
.head 6 -  Width:  0.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: bgOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.76"
.head 5 -  Top:    2.274"
.head 5 -  Width:  2.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbOP.Init(hWndItem)
.head 6 -  Call cmbOP.Populate( hSql(), "OP", "SubStr(SEMANTIC || decode(OP, 1,' (плюс)',2,' (мінус)',3,' (помножено)',4,' (поділено)'),1,30)", "INT_OP", " ORDER BY OP")
.head 6 -  ! Call cmbOP.Populate( hSql(), "OP", "SEMANTIC", "INT_OP", " ORDER BY OP")
.head 6 -  Call cmbOP.SetSelectById(dfOPID)
.head 5 +  On SAM_Click
.head 6 -  Set dfOPID = cmbOP.GetKey(SalListQuerySelection(hWndItem))
.head 3 +  Data Field: dfBRID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.183"
.head 6 -  Top:    1.833"
.head 6 -  Width:  0.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Check Box: cbBR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: баз.
.head 4 -  Window Location and Size
.head 5 -  Left:   9.8"
.head 5 -  Top:    2.55"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_HIDE_SHOW ('CLICK_RATES')
.head 3 +  Combo Box: cmbBR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.767"
.head 5 -  Top:    2.548"
.head 5 -  Width:  3.783"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.0"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbBR.Init(hWndItem)
.head 6 -  Call cmbBR.Populate(hSql(), "BR_ID", "NAME", "BRATES", "ORDER BY 1")
.head 6 -  Call cmbBR.SetSelectById(dfBRID)
.head 5 +  On SAM_Click
.head 6 -  Set dfBRID = cmbBR.GetKey(SalListQuerySelection(cmbBR))
.head 3 +  Pushbutton: pbIR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.76"
.head 5 -  Top:    1.929"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\A_PROC.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Рассчитать индивидуальную % ставку
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipIr')
.head 5 +  On SAM_Click
.head 6 -  Set nTmp = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, TRUE)
.head 6 +  If ( nTmp != NUMBER_Null AND nTmp != 0 )
.head 7 -  ! Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, TRUE)
.head 7 -  Set dfIR = nTmp
.head 3 -  ! В Ы П Л А Т А   П Р О Ц Е Н Т О В
.head 3 +  Picture: picIntPay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    3.345"
.head 5 -  Width:  14.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbCustAcc
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   13.783"
.head 5 -  Top:    4.321"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Текущие счета клиента'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipCustAcc'))
.head 5 +  On SAM_Click
.head 6 +  If dfRNK != NUMBER_Null AND dfKV != NUMBER_Null 
.head 7 -  ! 'Выбрать из справочника текущий счет клиента?'
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessGetAcc'), 
                  CurrentLangTable.GetAtomTitle('cTAt'), 
                  MB_IconQuestion | MB_YesNo ) = IDYES
.head 8 -  Set sTmp = STRING_Null
.head 8 -  Call FunNSIGetFiltered ("ACCOUNTS", "NLS", "RNK = " || Str(dfRNK) ||" and NBS in ('2520','2523','2542','2600','2650') and ACCOUNTS.KV = "||Str(dfKV), sTmp, dfNLSD)
.head 8 -  Set dfMFOP = Val(GetBankMfo())
.head 8 -  ! =====================
.head 8 +  If ( sTmp != STRING_Null )
.head 9 -  If ( NOT cbCOMPROC )
.head 9 -  ! 'Занести выбране значення в параметри для виплаты %% ?'
.head 9 +  If SalMessageBox ( CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessSetDen'), 
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_IconQuestion|MB_YesNo) = IDYES
.head 10 -  Set dfMFOP = frm_Open.dfMFOD
.head 10 -  Set dfNLSP = dfNLSD
.head 10 -  Set dfNMSP = dfNMSD
.head 10 -  Set dfNBP  = dfNBD
.head 6 +  Else
.head 7 -  ! IifS(dfRNK = NUMBER_Null, 'Не указан клиент!', 'Не указана валюта!')
.head 7 -  Call SalMessageBox( IifS(dfRNK = NUMBER_Null, CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessNotClient'), 
                                              CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessNotKv')), 
                    CurrentLangTable.GetAtomTitle('cTAt'),
                    MB_IconExclamation)
.head 3 -  Background Text: Виплата відсотків
.head 4 -  Resource Id: 35363
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    3.238"
.head 5 -  Width:  2.617"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgReceiverP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: МФО:
.head 4 -  Resource Id: 41162
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    3.476"
.head 5 -  Width:  0.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMFOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.24"
.head 6 -  Top:    3.679"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfMFOP = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If NOT SalIsValidNumber( dfMFOP )
.head 7 -  Set dfMFOP = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set dfNLSP = STRING_Null
.head 6 +  If NOT F_VALIDATE('BankCodeP')
.head 7 -  Set dfMFOP = NUMBER_Null
.head 7 -  Set dfNBP = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If dfMFOP != Val(GetBankMfo())
.head 7 -  Call SalEnableWindow(dfNMSP)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Назва банку:
.head 4 -  Resource Id: 34934
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.45"
.head 5 -  Top:    3.476"
.head 5 -  Width:  1.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNBP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.4"
.head 6 -  Top:    3.679"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Рахунок:
.head 4 -  Resource Id: 41636
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.65"
.head 5 -  Top:    3.476"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.6"
.head 6 -  Top:    3.679"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfNLSP != ''
.head 7 +  If Vkrz2(Str(dfMFOP),dfNLSP) != dfNLSP
.head 8 -  ! Ошибка в контрольном разряде счета!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAcc'), 
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_IconExclamation)
.head 8 -  Set dfNLSP = ''
.head 7 +  Else
.head 8 +  If dfMFOP = Val(GetBankMfo())
.head 9 +  If SqlPrepareAndExecute( hSql(),
   "SELECT a.rnk, substr(a.nms, 1, 38) 
      INTO :nTmp, :dfNMSP  
      FROM accounts a
     WHERE a.kv  = :dfKV    
       AND a.nls = :dfNLSP 
       AND a.dazs is null" )
and not SqlFetchNext(hSql(), nFetchRes)
.head 10 -  ! Счет не открыт!
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAccNotOpen'), 
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_IconExclamation )
.head 10 -  Set dfNLSP = ''
.head 9 +  Else
.head 10 -  ! Счет открыт на другого клиента! Продолжить?
.head 10 +  If dfRNK != nTmp AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessAccRnk'),
              CurrentLangTable.GetAtomTitle('cTAt'), 
              MB_IconQuestion|MB_YesNo) = IDNO
.head 11 -  Set dfNLSP = ''
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Отримувач:
.head 4 -  Resource Id: 63616
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.55"
.head 5 -  Top:    3.476"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNAMEP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNMSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.283"
.head 6 -  Top:    3.679"
.head 6 -  Width:  5.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: ЄДРПОУ:
.head 4 -  Resource Id: 34933
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.85"
.head 5 -  Top:    3.476"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOKPOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOKPOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    3.679"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! В О З В Р А Т   Д Е П О З И Т А
.head 3 +  Picture: picDepPay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    4.202"
.head 5 -  Width:  14.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Повернення депозиту
.head 4 -  Resource Id: 63615
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    4.095"
.head 5 -  Width:  2.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgReceiverD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: МФО:
.head 4 -  Resource Id: 41163
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    4.345"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMFOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.24"
.head 6 -  Top:    4.548"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfMFOD = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If NOT SalIsValidNumber(frm_Open.dfMFOD)
.head 7 -  Set dfMFOP = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set dfNLSD = STRING_Null
.head 6 +  If NOT F_VALIDATE('BankCodeD')
.head 7 -  Set dfMFOD = NUMBER_Null
.head 7 -  Set dfNBD = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If dfMFOD != Val(GetBankMfo())
.head 7 -  Call SalEnableWindow(dfNMSD)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Назва банку:
.head 4 -  Resource Id: 34935
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.45"
.head 5 -  Top:    4.345"
.head 5 -  Width:  1.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.4"
.head 6 -  Top:    4.548"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Рахунок:
.head 4 -  Resource Id: 41635
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.65"
.head 5 -  Top:    4.345"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.6"
.head 6 -  Top:    4.548"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfNLSD != ''
.head 7 +  If Vkrz2(Str(frm_Open.dfMFOD),dfNLSD) != dfNLSD
.head 8 -  ! Ошибка в контрольном разряде счета!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAcc'), 
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_IconExclamation)
.head 8 -  Set dfNLSD = ''
.head 7 +  Else
.head 8 +  If dfMFOD = Val(GetBankMfo())
.head 9 +  If SqlPrepareAndExecute( hSql(),
   "SELECT a.rnk, substr(a.nms, 1, 38) 
      INTO :nTmp, :dfNMSD  
      FROM accounts a
     WHERE a.kv  = :dfKV
       AND a.nls = :dfNLSD
       AND a.dazs is null")
and not SqlFetchNext( hSql(), nFetchRes)
.head 10 -  ! Счет не открыт!
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAccNotOpen'), 
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_IconExclamation)
.head 10 -  Set dfNLSD = ''
.head 9 +  Else
.head 10 -  ! Счет открыт на другого клиента! Продолжить?
.head 10 +  If dfRNK != nTmp AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessAccRnk'),
              CurrentLangTable.GetAtomTitle('cTAt'), 
              MB_IconQuestion|MB_YesNo) = IDNO
.head 11 -  Set dfNLSD = ''
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Отримувач:
.head 4 -  Resource Id: 63614
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.55"
.head 5 -  Top:    4.345"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNAMED
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNMSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    4.548"
.head 6 -  Width:  5.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! К О М М Е Н Т А Р И Й
.head 3 +  Data Field: bgCOMMENTS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Data Field: dfBRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.66"
.head 6 -  Top:    2.92"
.head 6 -  Width:  4.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.28"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Brazil
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, sBranchName )
.head 6 -  ! Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('frm_Open.cFTipBranchCode') || sBranchName )
.head 3 +  Data Field: dfDPUGEN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    0.083"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDPUADD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.083"
.head 6 -  Width:  0.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfAMOUNT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.217"
.head 6 -  Top:    0.083"
.head 6 -  Width:  0.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbBranch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   14.2"
.head 5 -  Top:    2.92"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Вибір Бранчу Договору')
.head 6 -  ! Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_Open.cFTipBranchName' ) )
.head 5 +  On SAM_Click
.head 6 +  If NOT FunNSIGet( "OUR_BRANCH", "NAME", dfBRANCH, sBranchName )
.head 7 -  ! << Не вибрано жодного значення з довідника >>
.head 7 -  ! Set dfBRANCH = STRING_Null
.head 7 -  ! Set sBranchName = STRING_Null
.head 2 +  Functions
.head 3 +  Function: f_createdeal
.head 4 -  Description: Открытие депозитного договора (стандарт и депозитная линия)
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: vID
.head 5 -  Number: vIR
.head 5 -  Number: vBR
.head 5 -  Number: vOP
.head 5 -  String: vND
.head 5 -  String: vMFOP
.head 5 -  String: vNLSP
.head 5 -  String: vNMSP
.head 5 -  String: vMFOD
.head 5 -  String: vNLSD
.head 5 -  String: vNMSD
.head 5 -  String: vCOMM
.head 5 -  String: vBRANCH 
.head 5 -  Number: vTRUSTID
.head 5 -  Long String: vERRMSG
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If F_VALIDATE('ALL') 
.head 6 -  Set vBR      = IifN(cbBR AND dfBRID != NUMBER_Null, dfBRID,NUMBER_Null)
.head 6 -  Set vIR      = IifN(cbIR AND dfIR   != NUMBER_Null, dfIR,  NUMBER_Null)
.head 6 -  Set vOP      = IifN(cbIR AND cbBR,                  dfOPID,NUMBER_Null)
.head 6 -  Set vND      = Subs(dfND,        1,  35)
.head 6 -  Set vMFOP    = Subs(Str(dfMFOP), 1,  12)
.head 6 -  Set vNLSP    = Subs(dfNLSP,      1,  15)
.head 6 -  Set vNMSP    = Subs(dfNMSP,      1,  38)
.head 6 -  Set vMFOD    = Subs(Str(dfMFOD), 1,  12)
.head 6 -  Set vNLSD    = Subs(dfNLSD,      1,  15)
.head 6 -  Set vNMSD    = Subs(dfNMSD,      1,  38)
.head 6 -  Set vCOMM    = Subs(sCOMMENT, 1, 128)
.head 6 -  Set vBRANCH  = Subs(dfBRANCH, 1, 30)
.head 6 -  Set vTRUSTID = nTRUSTID
.head 6 -  Set vID      = NUMBER_Null
.head 6 -  !
.head 6 +  If pDPU_GEN = NUMBER_Null
.head 7 +  If NOT SqlPLSQLCommand(hSql(), "bars.dpu.p_open_standart
  (vND,
   dfRNK,
   dfVIDD,
   dfSUM,
   dfDATZ,
   dfDATN,
   dfDATO,
   dfDATV, 
   vMFOP,
   vNLSP,
   vNMSP,
   vMFOD,
   vNLSD,
   vNMSD,
   dfFREQ,
   cbCOMPROC,
   dfSTOPID,
   dfMIN_SUM,
   vIR,
   vBR,
   vOP,
   vCOMM,
   pGRP,
   pISP,
   vBRANCH,
   vTRUSTID,
   vID,
   sErrMsg)")
.head 8 -  Set vID = NUMBER_Null
.head 6 +  Else
.head 7 +  If NOT SqlPLSQLCommand(hSql(), "bars.dpu.p_open_deposit_line
  (vND,
   pDPU_GEN,
   dfRNK,
   dfVIDD,
   dfSUM,
   dfDATZ, dfDATN, dfDATO, dfDATV, 
   vMFOP,  vNLSP,  vNMSP,
   vMFOD,  vNLSD,  vNMSD,
   dfFREQ,
   cbCOMPROC,
   dfSTOPID,
   dfMIN_SUM,
   vIR,
   vBR,
   vOP,
   vCOMM,
   pGRP,
   pISP,
   vTRUSTID,
   NUMBER_Null,
   vID,
   sErrMsg)")
.head 8 -  Set vID = NUMBER_Null
.head 5 +  Else
.head 6 -  Set vID  = NUMBER_Null
.head 5 -  Return vID
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: f_createsubdeal
.head 4 -  Description: Изменение стандартного вида договора на комбинированный
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nMainDpuId
.head 5 -  Number: nDmndDpuId
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set nMainDpuId = dfDPU_ID
.head 5 -  Set nDmndDpuId = NUMBER_Null
.head 5 -  !
.head 5 +  If SqlPLSQLCommand(hSql(), "dpu.create_subdeal (nMainDpuId, nDmndDpuId)")
.head 6 -  Return nDmndDpuId
.head 5 +  Else
.head 6 -  Return -103
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: f_updealparams
.head 4 -  Description: Изменение параметров договора
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bOk
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If F_VALIDATE('ALL') AND SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Open.cUpdDealQuest'), 
                                   CurrentLangTable.GetAtomTitle('cTAt'), 
                                   MB_IconQuestion|MB_YesNo) = IDYES
.head 6 +  If SqlPLSQLCommand(hSql(), "dpu.upd_dealparams (frm_Open.dfDPU_ID, 
                                                frm_Open.dfND, 
                                                frm_Open.dfSUM * 100,  
                                                frm_Open.dfMIN_SUM * 100, 
                                                frm_Open.dfFREQ,  
                                                frm_Open.dfSTOPID,  
                                                frm_Open.dfDATZ,  
                                                frm_Open.dfDATN, 
                                                frm_Open.dfDATO, 
                                                frm_Open.dfDATV,
                                            Str(frm_Open.dfMFOD),
                                                frm_Open.dfNLSD,  
                                                frm_Open.dfNMSD,
                                            Str(frm_Open.dfMFOP),
                                                frm_Open.dfNLSP, 
                                                frm_Open.dfNMSP,
                                                frm_Open.dfOKPOP,
                                                frm_Open.dfIR, 
                                                frm_Open.dfOPID,  
                                                frm_Open.dfBRID,
                                                frm_Open.dfBRDAT, 
                                                frm_Open.dfBRANCH,  
                                                frm_Open.nTRUSTID,
                                                frm_Open.sCOMMENT)")
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Open.cUpdDealDone'), 
                   CurrentLangTable.GetAtomTitle('cTInfo'), 
                   MB_IconInformation)
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Set bOk = TRUE
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Set bOk = FALSE
.head 5 +  Else
.head 6 -  Set bOk = FALSE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return bOk
.head 3 +  Function: f_getscalerate
.head 4 -  Description: Расчет ставки по шкале в зав-ти от условий договора
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: p_vidd
.head 5 -  Date/Time: p_dat_open
.head 5 -  Date/Time: p_dat_clos
.head 5 -  Number: p_sum
.head 5 -  Boolean: p_raise_err
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: n_rate
.head 5 -  String: s_errmsg
.head 4 +  Actions
.head 5 -  Set n_rate   = NUMBER_Null
.head 5 -  Set s_errmsg = STRING_Null
.head 5 -  ! проверка достаточности данных
.head 5 +  If p_vidd = NUMBER_Null
.head 6 -  Set s_errmsg = CurrentLangTable.GetAtomTitle('frm_Open.cTMessCalcRateErr1')
.head 5 +  Else If p_sum = NUMBER_Null 
.head 6 -  Set s_errmsg = CurrentLangTable.GetAtomTitle('frm_Open.cTMessCalcRateErr2')
.head 5 +  Else If p_dat_open = DATETIME_Null
.head 6 -  Set s_errmsg = CurrentLangTable.GetAtomTitle('frm_Open.cTMessCalcRateErr3')
.head 5 +  Else If p_dat_clos = DATETIME_Null
.head 6 -  Set s_errmsg = CurrentLangTable.GetAtomTitle('frm_Open.cTMessCalcRateErr4')
.head 5 +  Else
.head 6 +  If SqlPrepareAndExecute(hSql(),
   "SELECT dpu.f_calc_rate("||
           Str(p_vidd)||","||
           "to_date('"||SalFmtFormatDateTime(p_dat_open,'dd/MM/yyyy')||"','dd/mm/yyyy')"||","||
           "to_date('"||SalFmtFormatDateTime(p_dat_clos,'dd/MM/yyyy')||"','dd/mm/yyyy')"||","||
           Str(p_sum*100)||")
      INTO :n_rate FROM dual")
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set n_rate = NUMBER_Null
.head 6 +  If n_rate = NUMBER_Null
.head 7 -  ! не найдена ставка для заданных условий договора
.head 7 -  Set s_errmsg = CurrentLangTable.GetAtomTitle('frm_Open.cTMessCalcRateErr0')
.head 5 -  ! возвращаем значение ставки или ошибку 
.head 5 +  If p_raise_err and s_errmsg != STRING_Null
.head 6 -  Call SalMessageBox(s_errmsg, CurrentLangTable.GetAtomTitle('cTInfo'), MB_IconAsterisk)
.head 5 +  Else
.head 6 -  Return n_rate
.head 3 +  Function: f_prepareagr
.head 4 -  Description: Підготовка для відкриття додаткової угоди (траншу)
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute(hSql(), 
"SELECT to_char( bars.dpu.f_next_add_number(d.dpu_id) )
   INTO :frm_Open.dfND        
   FROM dpu_deal  d
  WHERE d.dpu_id  = :frm_Open.pDPU_GEN" )
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  !
.head 6 -  Set dfTITLE   = CurrentLangTable.GetAtomTitle('cTDopSogl')
.head 6 -  Set dfDPU_ID  = NUMBER_Null
.head 6 -  ! Set dfSUM     = NUMBER_Null
.head 6 -  ! Set dfMIN_SUM = NUMBER_Null
.head 6 -  Set dfDPUGEN  = NUMBER_Null 
.head 6 -  Set dfDPUADD  = NUMBER_Null
.head 6 -  !
.head 6 -  Set dfDATZ    = GetBankDate()
.head 6 -  Set dfDATN    = GetBankDate()
.head 6 -  !
.head 6 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 6 -  Call SalSendMsg(cmbVIDD, SAM_Click, 0, 0)
.head 6 -  !
.head 6 -  Call F_HIDE_SHOW( 'ADD_DEAL' )
.head 3 +  Function: f_populate
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNdGen
.head 5 -  String: sDatGen
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), "
SELECT c.rnk, c.nmk, c.okpo, c.adr, 
       (select substr(w.value, 1, 1) from customerw w  where w.tag = 'K013' and w.rnk = c.rnk),
       p.type_id, p.type_name, v.vidd, v.name,
       t.kv, t.lcv, t.name, nvl(d.cnt_dubl, 0),
       d.nd, d.sum*power(10,-t.dig), nvl(d.min_sum,0)*power(10,-t.dig), FOST( d.acc, bankdate ),
       f.freq, f.name, s.id, s.name,  
       d.datz, d.dat_begin, d.dat_end, d.datv, 
       d.trustee_id, d.comproc, r.bdat, r.ir, r.op, r.br, 
       d.mfo_d, b1.nb, d.nls_d, d.nms_d, 
       d.mfo_p, b2.nb, d.nls_p, d.nms_p, nvl(d.okpo_p, c.okpo),  
       d.comments, d.branch, b.name, d.dpu_gen, nvl(d.dpu_add, 0),
       v.FL_Extend, v.TERM_MIN, v.IRVK
  INTO :frm_Open.dfRNK,    :frm_Open.dfNMK,     :frm_Open.dfOKPO,     :frm_Open.dfADRES,  :frm_Open.dfK013,
       :frm_Open.dfTYPEID, :frm_Open.cmbTYPE,   :frm_Open.dfVIDD,     :frm_Open.cmbVIDD,
       :frm_Open.dfKV,     :frm_Open.dfISO,     :frm_Open.cmbKV,      :frm_Open.dfDubl,
       :frm_Open.dfND,     :frm_Open.dfSUM,     :frm_Open.dfMIN_SUM,  :frm_Open.dfAMOUNT,
       :frm_Open.dfFREQ,   :frm_Open.cmbFREQ,   :frm_Open.dfSTOPID,   :frm_Open.cmbSTOP,
       :frm_Open.dfDATZ,   :frm_Open.dfDATN,    :frm_Open.dfDATO,     :frm_Open.dfDATV,
       :frm_Open.nTRUSTID, :frm_Open.cbCOMPROC, :frm_Open.dfBRDAT,    :frm_Open.dfIR,     :frm_Open.dfOPID, :frm_Open.dfBRID,
       :frm_Open.dfMFOD,   :frm_Open.dfNBD,     :frm_Open.dfNLSD,     :frm_Open.dfNMSD, 
       :frm_Open.dfMFOP,   :frm_Open.dfNBP,     :frm_Open.dfNLSP,     :frm_Open.dfNMSP,   :frm_Open.dfOKPOP, 
       :frm_Open.sCOMMENT, :frm_Open.dfBRANCH,  :frm_Open.sBranchName,:frm_Open.dfDPUGEN, 
       :frm_Open.dfDPUADD, :frm_Open.nFlExtend, :frm_Open.nMaxTerm,   :frm_Open.nPeriodType
   FROM dpu_deal  d, 
        dpu_vidd  v, 
        customer  c,
        freq      f, 
        dpt_stop  s, 
        tabval    t, 
        dpu_types p,
        int_ratn  r, 
        banks     b1,
        banks     b2,
        branch    b
  WHERE d.vidd    = v.vidd
    AND d.rnk     = c.rnk
    AND d.freqv   = f.freq   
    AND d.id_stop = s.id 
    AND v.kv      = t.kv
    AND v.type_id = p.type_id
    AND d.mfo_d   = b1.mfo(+) 
    AND d.mfo_p   = b2.mfo(+)
    AND d.branch  = b.branch
    AND (r.acc, r.id, r.bdat) = (SELECT r1.acc, r1.id, max(r1.bdat) 
                                   FROM int_ratn r1
                                  WHERE r1.acc   = d.acc 
                                    AND r1.id    = 1 
                                    AND r1.bdat <= greatest( bankdate, d.dat_begin )
                                  GROUP BY r1.acc, r1.id)
    AND d.dpu_id  = :frm_Open.dfDPU_ID")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  !
.head 6 -  Call F_HIDE_SHOW ('RATES')
.head 6 -  ! Управління доступністю полів для вказання отрмувача %%
.head 6 -  Call F_HIDE_SHOW( 'COMPROC' )
.head 6 -  Set dfKTDAY=F_CALC_KTDAYS()
.head 6 -  ! заголовок
.head 6 +  If dfDPUADD = 0
.head 7 -  ! Депозитный договор № dfND (#dfDPU_ID)
.head 7 -  Set dfTITLE = CurrentLangTable.GetAtomTitle('frm_Open.cTWndTitle1') ||
                            SalStrTrimX(dfND) || '(#' || SalNumberToStrX(dfDPU_ID,0) || ')'
.head 7 -  ! Якщо деп.лінія
.head 7 +  If nFlExtend = 2
.head 8 -  Call F_HIDE_SHOW('GEN_IR')
.head 6 +  Else
.head 7 -  ! Доп.соглашение № dfND к договору № sNdGen от sDatGen (#dfDPU_ID)
.head 7 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT trim(nd), to_char(datz,'dd/MM/yyyy') 
     INTO :sNdGen, :sDatGen
     FROM dpu_deal 
    WHERE dpu_id = :frm_Open.dfDPUGEN")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set dfTITLE = CurrentLangTable.GetAtomTitle('frm_Open.cTWndTitle2')
           || dfND
           || ' '
           || CurrentLangTable.GetAtomTitle('frm_Open.cTWndTitle2_')
           || ' '
           || '№'
           || sNdGen
           || ' '
           || CurrentLangTable.GetAtomTitle('AcrPay.cTNaznVid')
           || ' '
           || sDatGen
           || ' '
           || ' (#'||SalNumberToStrX(dfDPU_ID, 0)||')'
.head 6 -  !
.head 6 -  Call SalDisableWindow( pbKlient )
.head 6 -  Call SalDisableWindow( dfDPU_ID )
.head 6 -  Call SalDisableWindow( dfTYPEID )
.head 6 -  Call SalDisableWindow( cmbTYPE  )
.head 6 -  Call SalDisableWindow( cmbKV    )
.head 6 -  Call SalDisableWindow( dfVIDD   )
.head 6 -  Call SalDisableWindow( cmbVIDD  )
.head 6 -  ! -
.head 6 -  Call SalDisableWindow( dfND     )
.head 6 -  Call SalDisableWindow( dfSUM    )
.head 6 -  Call SalDisableWindow( dfMIN_SUM)
.head 6 -  ! -
.head 6 -  Call SalDisableWindow( cmbFREQ  )
.head 6 -  Call SalDisableWindow( cmbSTOP  )
.head 6 -  Call SalDisableWindow( cbCOMPROC)
.head 6 -  ! -
.head 6 -  Call SalDisableWindow( dfDATZ   )
.head 6 -  Call SalDisableWindow( dfDATN   )
.head 6 +  If ( nTermType = 1 )
.head 7 -  ! фіксований термін депозиту
.head 7 -  Call SalDisableWindow( dfDATO )
.head 6 -  Call SalDisableWindow( dfDATV   )
.head 6 -  ! номер доп.соглашения не редактируется
.head 6 +  If dfDPUADD > 0
.head 7 -  Call SalDisableWindow( dfND )
.head 7 -  Call SalDisableWindow( pbBranch )
.head 7 +  If ( dfAMOUNT > 0 )
.head 8 -  ! Якщо на транш вже розміщено кошти то наступні поля не доступні для редагування
.head 8 -  Call SalDisableWindow( dfSUM )
.head 8 -  Call SalDisableWindow( dfDATN )
.head 6 -  !
.head 6 +  If nFlExtend = 2 AND dfDPUADD = 0 AND dfDPUGEN = NUMBER_Null
.head 7 -  Call SalDisableWindow(pbSos)
.head 7 -  Call SalDisableWindow(pb_CreateAgreement)
.head 7 -  Call SalEnableWindow(pbChilds)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(pbSos)
.head 7 -  Call SalEnableWindow(pb_CreateAgreement)
.head 7 -  Call SalDisableWindow(pbChilds)
.head 6 -  !
.head 6 -  Call SalEnableWindow(pbPrint)
.head 6 -  Call SalEnableWindow(pbPasport)
.head 6 -  Call SalEnableWindow(pbAccounts)
.head 6 -  ! < SWIFT >
.head 6 +  If ( dfKV != GetBaseVal() )
.head 7 +  If ( "Y" = get_OneStringValue("SELECT decode(count(1),0,'N','Y') INTO :sResult from DPU_RU where KF = :frm_Open.dfMFOD") )
.head 8 -  ! SWIFT лише для міжбанку
.head 8 -  Call SalEnableWindow( pb_PayOutSwiftDetails )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( pb_PayOutSwiftDetails )
.head 6 -  ! ===============================================
.head 6 -  ! pbCombine
.head 6 -  ! ===============================================
.head 6 +  If SqlPrepareAndExecute (hSql(), "select dpu.subdeal_validation("||Str(frm_Open.dfDPU_ID)||") INTO :nTmp FROM dual") 
And SqlFetchNext(hSql(), nFetchRes) 
And nTmp = 1
.head 7 -  Call SalEnableWindow(pbCombine)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(pbCombine)
.head 6 -  ! ===============================================
.head 6 -  ! < Тільки перегляд >
.head 6 +  If (nMode = 2 or nMode = 3)
.head 7 -  Call F_HIDE_SHOW ('ReadOnly')
.head 6 +  Else
.head 7 -  ! *** < Перевірка на можливість пролонгації договору > ***
.head 7 +  If ( (sDptBankType = 'SBER') AND (dfDPUADD = 0) )
.head 8 -  ! >> Ощад лонгує ген. дог. лінії до його завершення
.head 8 -  Call SalEnableWindow( pbDubl )
.head 7 +  Else
.head 8 +  If ( dfDATO <= GetBankDate() ) AND ( dfDATO != DATETIME_Null ) AND ( dfAMOUNT > 0 )
.head 9 -  Call SalEnableWindow( pbDubl )
.head 8 +  Else
.head 9 -  Call SalDisableWindow( pbDubl )
.head 5 -  Return TRUE
.head 3 -  ! !!!!!< F_PROLONG >!!!!!!
.head 3 +  Function: F_PROLONG
.head 4 -  Description: Пронгація депозитних договорів ЮО
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPLSQLCommand( hSql(), "dpu.deal_prolongation ( DATETIME_Null,  frm_Open.dfDPU_ID,  frm_Open.dfDATO,  frm_Open.dfIR,  0 )" )
.head 6 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Open.cUpdDealDone'), 
                                            CurrentLangTable.GetAtomTitle('cTInfo'), 
                                            MB_IconInformation )
.head 6 -  Call SqlCommit(hSql())
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Return FALSE
.head 3 +  Function: F_HIDE_SHOW
.head 4 -  Description: Управління доступністю компонентів
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sName
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! << Управління доступністю полів для вказання отрмувача %% >>
.head 5 +  If sName = 'COMPROC'
.head 6 +  If nMode = 1 AND cbCOMPROC
.head 7 -  Call SalDisableWindow(dfMFOP)
.head 7 -  Call SalDisableWindow(dfNLSP)
.head 7 -  Call SalDisableWindow(dfOKPOP)
.head 6 +  Else If nMode = 1 AND NOT cbCOMPROC
.head 7 -  Call SalEnableWindow(dfMFOP)
.head 7 -  Call SalEnableWindow(dfNLSP)
.head 7 -  Call SalEnableWindow(dfNMSP)
.head 7 -  Call SalEnableWindow(dfOKPOP)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(cbCOMPROC)
.head 5 -  ! -------------------------------- 
.head 5 -  ! открытие "пустой" карточки договора
.head 5 +  Else If sName = 'PREPARE_RATES'
.head 6 -  Set cbIR    = TRUE
.head 6 -  Set cbBR    = FALSE
.head 6 -  Set dfIR    = NUMBER_Null
.head 6 -  Set dfBRDAT = GetBankDate()
.head 6 -  Set dfBRID  = NUMBER_Null
.head 6 -  Set cmbBR   = STRING_Null
.head 6 -  Set dfOPID  = NUMBER_Null
.head 6 -  Set cmbOP   = STRING_Null
.head 6 -  Call SalEnableWindow(dfIR)
.head 6 -  Call SalEnableWindow(pbIR)
.head 6 -  Call SalDisableWindow(cmbBR)
.head 6 -  Call SalDisableWindow(cmbOP)
.head 5 -  ! -------------------------------- 
.head 5 -  ! после выбора др.вида депозита
.head 5 +  Else If sName = 'REFRESH_RATES'
.head 6 -  Set dfIR    = NUMBER_Null
.head 6 +  If ( dfBRID = NUMBER_Null ) OR ( dfBRID = 0 )
.head 7 -  Set cbIR   = TRUE
.head 7 -  Set cbBR   = FALSE
.head 7 -  Set cmbBR  = STRING_Null
.head 7 -  ! Call SalEnableWindow(dfIR)
.head 7 -  ! Call SalEnableWindow(pbIR)
.head 7 -  ! Call SalDisableWindow(cmbBR)
.head 6 +  Else
.head 7 -  Set cbBR = TRUE
.head 7 -  Set cbIR = FALSE
.head 7 -  Set cmbBR  = STRING_Null
.head 7 -  ! Call SalDisableWindow(dfIR)
.head 7 -  ! Call SalDisableWindow(pbIR)
.head 7 -  ! Call SalEnableWindow(cmbBR)
.head 6 +  If ( sDptBankType = 'SBER' )
.head 7 -  Call SalDisableWindow( dfMIN_SUM )
.head 7 -  Call SalDisableWindow( cmbFREQ   )
.head 7 -  Call SalDisableWindow( cmbSTOP   )
.head 7 -  ! В Ощадбанку капіталізація тільки при щоміс. виплаті %%
.head 7 +  If ( dfFREQ = 5 )
.head 8 -  Call SalEnableWindow( cbCOMPROC )
.head 7 +  Else
.head 8 -  Call SalDisableWindow( cbCOMPROC )
.head 5 -  ! -------------------------------- 
.head 5 -  ! (де)активация флагов "инд.ставка" и "баз.ставка"
.head 5 +  Else If sName = 'CLICK_RATES'
.head 6 +  If cbIR = TRUE
.head 7 -  Call SalEnableWindow(dfIR)
.head 7 -  Call SalEnableWindow(pbIR)
.head 6 +  Else
.head 7 -  Set dfIR = NUMBER_Null
.head 7 -  Call SalDisableWindow(dfIR)
.head 7 -  Call SalDisableWindow(pbIR)
.head 6 -  !
.head 6 +  If cbBR = TRUE
.head 7 -  Call SalEnableWindow(cmbBR)
.head 6 +  Else
.head 7 -  Set dfBRID = NUMBER_Null
.head 7 -  Set cmbBR  = STRING_Null
.head 7 -  Call SalDisableWindow(cmbBR)
.head 6 +  If cbIR and cbBR
.head 7 -  Call SalEnableWindow(cmbOP)
.head 6 +  Else
.head 7 -  Set dfOPID = NUMBER_Null
.head 7 -  Set cmbOP  = STRING_Null
.head 7 -  Call SalDisableWindow(cmbOP)
.head 5 -  ! население карточки договора / ДС
.head 5 +  Else If sName = 'RATES'
.head 6 -  Call SalDisableWindow(cbIR)
.head 6 -  Call SalDisableWindow(cbBR)
.head 6 -  !
.head 6 +  If dfIR = NUMBER_Null
.head 7 -  Set cbIR = FALSE
.head 7 -  Call SalDisableWindow(dfIR)
.head 7 -  Call SalDisableWindow(pbIR)
.head 6 +  Else
.head 7 -  Set cbIR = TRUE
.head 7 -  Call SalEnableWindow(dfIR)
.head 7 -  Call SalEnableWindow(pbIR)
.head 6 -  !
.head 6 +  If ( dfBRID = NUMBER_Null ) OR ( dfBRID = 0 )
.head 7 -  Set cbBR   = FALSE
.head 7 -  Set cmbBR  = STRING_Null
.head 7 -  Call SalDisableWindow(cmbBR)
.head 6 +  Else
.head 7 -  Set cbBR = TRUE
.head 7 -  Call SalEnableWindow(cmbBR)
.head 6 -  !
.head 6 +  If ( dfOPID != NUMBER_Null ) OR ( dfIR > 0 AND dfBRID > 0)
.head 7 -  Call SalEnableWindow(cmbOP)
.head 6 +  Else
.head 7 -  Set cmbOP  = STRING_Null
.head 7 -  Call SalDisableWindow(cmbOP)
.head 5 -  ! --------------------------------
.head 5 -  ! << Управління доступністю полів для ГЕНУГОДИ>>
.head 5 +  Else If sName = 'GEN_IR'
.head 6 -  Call SalDisableWindow( cbCOMPROC )
.head 6 -  Call SalDisableWindow( cbIR      )
.head 6 -  Call SalDisableWindow( dfIR      )
.head 6 -  Call SalDisableWindow( pbIR      )
.head 6 -  Call SalDisableWindow( dfBRDAT   )
.head 6 -  Call SalDisableWindow( cmbOP     )
.head 6 -  Call SalDisableWindow( cbBR      )
.head 6 -  Call SalDisableWindow( cmbBR     )
.head 6 -  !
.head 6 -  Call SalHideWindow           ( dfSUM     )
.head 6 -  Call SalDisableWindowAndLabel( bgSUM     )
.head 6 -  Call SalHideWindow           ( dfMIN_SUM )
.head 6 -  Call SalDisableWindowAndLabel( bgMIN_SUM )
.head 6 -  !
.head 6 -  ! Call SalDisableWindow( cmbFREQ )
.head 6 -  Call SalDisableWindow( cmbSTOP )
.head 6 -  ! < дати >
.head 6 -  ! Call SalHideWindow        ( dfDATN )
.head 6 -  ! Call SalHideWindowAndLabel( bgDATN )
.head 6 -  Call SalDisableWindow     ( dfDATN )
.head 6 -  Call SalDisableWindow     ( dfDATO )
.head 6 -  Call SalHideWindow        ( dfDATV )
.head 6 -  Call SalHideWindowAndLabel( bgDATV )
.head 6 -  !
.head 6 -  ! Call SalHideWindow        ( dfDubl )
.head 6 -  ! Call SalHideWindowAndLabel( bgDubl )
.head 6 -  Call SalHideWindow        ( dfKTDAY )
.head 6 -  Call SalHideWindowAndLabel( bgKTDAY )
.head 5 -  ! -------------------------------- 
.head 5 -  ! << Управління доступністю компонент при створенні ДОД.УГОДИ >>
.head 5 +  Else If sName = 'ADD_DEAL'
.head 6 -  !
.head 6 -  Call SalDisableWindow( pbPrint)
.head 6 -  Call SalDisableWindow( pbSos)
.head 6 -  Call SalDisableWindow( pbPasport)
.head 6 -  Call SalDisableWindow( pbAccounts)
.head 6 -  Call SalDisableWindow( pbChilds)
.head 6 -  Call SalDisableWindow( pbCombine)
.head 6 -  Call SalDisableWindow( pbDubl)
.head 6 -  Call SalDisableWindow( pb_AddOption)
.head 6 -  Call SalDisableWindow( pb_PayOutSwiftDetails )
.head 6 -  !
.head 6 -  Call SalDisableWindow( pbKlient )
.head 6 -  Call SalDisableWindow( cmbTYPE  ) 
.head 6 -  Call SalDisableWindow( cmbKV    )
.head 6 -  Call SalDisableWindow( pbBranch)
.head 6 -  !
.head 6 +  If ( sDptBankType = 'UPB' )
.head 7 -  Call SalDisableWindow( cmbVIDD )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( cmbVIDD )
.head 6 -  !
.head 6 -  Call F_HIDE_SHOW('PREPARE_RATES')
.head 6 -  !
.head 6 -  Call SalEnableWindow(dfND)
.head 6 -  Call SalShowWindow( dfSUM )
.head 6 -  Call SalEnableWindow( dfSUM )
.head 6 -  Call SalEnableWindowAndLabel( bgSUM )
.head 6 -  Call SalShowWindow( dfMIN_SUM )
.head 6 -  Call SalEnableWindowAndLabel( bgMIN_SUM )
.head 6 -  !
.head 6 -  ! Call SalDisableWindow( cmbFREQ )
.head 6 -  Call SalDisableWindow( cmbSTOP )
.head 6 -  ! < дати >
.head 6 -  Call SalShowWindow( dfDATN )
.head 6 -  Call SalShowWindowAndLabel( bgDATN )
.head 6 -  Call SalEnableWindow( dfDATO )
.head 6 -  Call SalShowWindow( dfDATV )
.head 6 -  Call SalShowWindowAndLabel( bgDATV )
.head 6 -  Call SalDisableWindow( dfDATV )
.head 6 -  !
.head 6 -  Call SalShowWindow( dfKTDAY )
.head 6 -  Call SalShowWindowAndLabel( bgKTDAY )
.head 5 -  ! -------------------------------- 
.head 5 -  ! <<  Управління доступністю при створенні СТАНДАР./ ГЕН. ДОГОВОРУ >>
.head 5 +  Else If sName = 'PREPARE'
.head 6 -  Set dfTITLE    = CurrentLangTable.GetAtomTitle('cTDepDog')
.head 6 -  Set dfDPU_ID   = NUMBER_Null
.head 6 -  !
.head 6 -  Set dfRNK      = NUMBER_Null
.head 6 -  Set dfOKPO     = STRING_Null
.head 6 -  Set dfNMK      = STRING_Null
.head 6 -  Set dfADRES    = STRING_Null
.head 6 -  Set dfK013     = STRING_Null
.head 6 -  !
.head 6 -  Set dfTYPEID   = NUMBER_Null
.head 6 -  Set cmbTYPE    = STRING_Null
.head 6 -  Set dfKV       = NUMBER_Null
.head 6 -  Set dfISO      = STRING_Null
.head 6 -  Set cmbKV      = STRING_Null
.head 6 -  Set dfVIDD     = NUMBER_Null
.head 6 -  Set cmbVIDD    = STRING_Null
.head 6 -  !
.head 6 -  Set dfND       = STRING_Null
.head 6 -  Set dfSUM      = 0
.head 6 -  Set dfMIN_SUM  = 0
.head 6 -  Set dfFREQ     = NUMBER_Null
.head 6 -  Set cmbFREQ    = STRING_Null
.head 6 -  Set dfSTOPID   = NUMBER_Null
.head 6 -  Set cmbSTOP    = STRING_Null
.head 6 -  ! < дати >
.head 6 -  Set dfDATZ     = GetBankDate()
.head 6 -  Set dfDATN     = GetBankDate()
.head 6 -  Set dfDATO     = DATETIME_Null
.head 6 -  Set dfDATV     = DATETIME_Null
.head 6 -  !
.head 6 -  Set cbCOMPROC = FALSE
.head 6 -  ! *****************************
.head 6 -  Call F_HIDE_SHOW('PREPARE_RATES')
.head 6 -  ! *************************
.head 6 -  !
.head 6 -  Set dfMFOP    = SalStrToNumber(GetBankMfo())
.head 6 -  Set dfNBP     = GetBankName()
.head 6 -  Set dfNLSP    = STRING_Null
.head 6 -  Set dfNMSP    = STRING_Null
.head 6 -  Set dfMFOD    = SalStrToNumber(GetBankMfo())
.head 6 -  Set dfNBD     = GetBankName()
.head 6 -  Set dfNLSD    = STRING_Null
.head 6 -  Set dfNMSD    = STRING_Null
.head 6 -  !
.head 6 -  Set sCOMMENT  = STRING_Null
.head 6 -  Set dfBRANCH  = get_OneStringValue("SELECT SubStr(sys_context('bars_context','user_branch'),1,30) INTO :sResult FROM dual")
.head 6 -  Set dfDPUGEN  = NUMBER_Null
.head 6 -  Set dfDPUADD  = NUMBER_Null
.head 6 -  Set nMaxTerm  = NUMBER_Null
.head 6 -  !
.head 6 -  Call SalDisableWindow( pbPrint )
.head 6 -  Call SalDisableWindow( pbSos )
.head 6 -  Call SalDisableWindow( pbPasport )
.head 6 -  Call SalDisableWindow( pbAccounts )
.head 6 -  Call SalDisableWindow( pbChilds )
.head 6 -  Call SalDisableWindow( pbCombine )
.head 6 -  Call SalDisableWindow( pbDubl )
.head 6 -  Call SalDisableWindow( pb_AddOption )
.head 6 -  Call SalDisableWindow( pb_CreateAgreement )
.head 6 -  Call SalDisableWindow( pb_PayOutSwiftDetails )
.head 6 -  Call SalEnableWindow( pbKlient)
.head 6 -  Call SalEnableWindow( dfRNK )
.head 5 -  ! -------------------------------- 
.head 5 -  ! << Для режиму тільки перегляд >>
.head 5 +  Else If sName = 'ReadOnly'
.head 6 -  Call SalDisableWindow(pbUpdate)
.head 6 -  Call SalDisableWindow(pbPasport)
.head 6 -  ! Call SalDisableWindow(pbAccounts)
.head 6 -  Call SalDisableWindow(pbPrint)
.head 6 -  Call SalDisableWindow(pbChilds)
.head 6 -  Call SalDisableWindow(pbCombine)
.head 6 -  Call SalDisableWindow(pbDubl)
.head 6 -  !
.head 6 -  Call SalDisableWindow(dfND)
.head 6 -  Call SalDisableWindow(dfSUM)
.head 6 -  Call SalDisableWindow(dfMIN_SUM)
.head 6 -  Call SalDisableWindow(cmbFREQ)
.head 6 -  Call SalDisableWindow(cmbSTOP)
.head 6 -  !
.head 6 -  Call SalDisableWindow(cmbTYPE)
.head 6 -  Call SalDisableWindow(cmbKV)
.head 6 -  Call SalDisableWindow(cmbVIDD)
.head 6 -  !
.head 6 -  Call SalDisableWindow(pbBranch)
.head 6 -  !
.head 6 -  Call SalDisableWindow(dfDATZ)
.head 6 -  Call SalDisableWindow(dfDATN)
.head 6 -  Call SalDisableWindow(dfDATO)
.head 6 -  Call SalDisableWindow(dfDATV)
.head 6 -  !
.head 6 -  Call SalDisableWindow(cbCOMPROC)
.head 6 -  Call SalDisableWindow(cbIR)
.head 6 -  Call SalDisableWindow(cbBR)
.head 6 -  Call SalDisableWindow(dfBRDAT)
.head 6 -  Call SalDisableWindow(dfIR)
.head 6 -  Call SalDisableWindow(cmbOP)
.head 6 -  Call SalDisableWindow(cmbBR)
.head 6 -  Call SalDisableWindow(pbIR)
.head 6 -  !
.head 6 -  Call SalDisableWindow(pbCustAcc)
.head 6 -  Call SalDisableWindow(dfMFOP)
.head 6 -  Call SalDisableWindow(dfNLSP)
.head 6 -  Call SalDisableWindow(dfNMSP)
.head 6 -  Call SalDisableWindow(dfOKPOP)
.head 6 -  Call SalDisableWindow(dfMFOD)
.head 6 -  Call SalDisableWindow(dfNLSD)
.head 6 -  Call SalDisableWindow(dfNMSD)
.head 3 +  Function: F_CALC_KTDAYS
.head 4 -  Description: вирахування к-ті днів угоди за які буде нараховано %%
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  ! Date/Time: p_dat_beg
.head 5 -  ! Date/Time: p_dat_end
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nKtDays
.head 4 +  Actions
.head 5 +  If NOT ( SalIsNull( dfDATN ) OR SalIsNull( dfDATO ) )
.head 6 +  If ( sDptBankType = 'SBER' )
.head 7 -  ! Ощадбанк нараховує по дату ВИПЛАТИ - 1 день
.head 7 -  Set nKtDays = ( dfDATV - dfDATN - IifN(dfDubl>0, 0, 1))
.head 6 +  Else
.head 7 -  Set nKtDays = ( dfDATO - dfDATN - IifN(dfDubl>0, 0, 1))
.head 5 +  Else
.head 6 -  Set nKtDays = NUMBER_Null
.head 5 -  Return nKtDays
.head 3 +  Function: F_VALIDATE
.head 4 -  Description: Преревірка заповнення полів
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sParName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErrorList
.head 5 -  Number: nErrorCount
.head 5 -  !
.head 5 -  Number: l_mnth
.head 5 -  Number: l_days
.head 5 -  Number: l_actrate
.head 5 -  Number: l_maxrate
.head 5 -  Number: l_recid ! temp number variable
.head 5 -  String: l_sTmp
.head 4 +  Actions
.head 5 -  ! < Преревірка заповнення обов'язкових полів >
.head 5 +  If sParName = 'ALL'
.head 6 -  Set sErrorList = ''
.head 6 -  Set nErrorCount = 0
.head 6 -  ! sErrorList = Не заполнен реквизит <...>
.head 6 +  If SalIsNull(dfND)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)   ||': '
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')      ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipND')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfVIDD)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)        ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')           ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipCmbVIDD')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfKV)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)    ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')       ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipISO')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfSUM)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)    ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')       ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipSUM')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfRNK)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)    ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')       ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipRNK')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfDATZ)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)     ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')        ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipDATZ')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfDATN)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)     ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')        ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipDATN')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfFREQ)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')    ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipCmbFREQ_V')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfSTOPID)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)     ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')        ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipSTOP')||'>'||PutCrLf()
.head 6 +  If ( cbIR AND cbBR AND SalIsNull( dfOPID ) )
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)  ||': '
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')     ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cTOpId')||'>'||PutCrLf()
.head 6 +  If ( SalIsNull(dfIR) AND SalIsNull(dfBRID) )
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)  ||': '
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')     ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cTRate')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfMFOD) OR  SalIsNull(dfNLSD) OR SalIsNull(dfNMSD)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  ! 'Не указаны реквизиты клиента для приема/возврата депозита'
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListMFOD') || PutCrLf()
.head 6 +  If nErrorCount > 0
.head 7 -  ! Ошибка заполнения реквизитов
.head 7 -  Call SalMessageBox(sErrorList, 
                   CurrentLangTable.GetAtomTitle('_cTErrCheck'), 
                   MB_Ok)
.head 7 -  Return FALSE
.head 6 -  !
.head 6 +  If NOT F_VALIDATE('MaxRate')
.head 7 -  ! Введенная ставка превышает макс.допустимую ставку для договоров данного типа
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Open.cTMessCheckRateErr'), 
                   CurrentLangTable.GetAtomTitle('cTErr'), 
                   MB_Ok)
.head 7 -  Return FALSE
.head 6 -  Return TRUE
.head 5 -  ! < Перевірка: "ставка <= макс.допустимої ставки" >
.head 5 +  Else If sParName = 'MaxRate'
.head 6 -  Set l_mnth   = NUMBER_Null
.head 6 -  Set l_days   = NUMBER_Null
.head 6 +  If dfVIDD = NUMBER_Null 
OR dfSUM  = NUMBER_Null 
OR dfDATN = DATETIME_Null
OR dfDATO = DATETIME_Null
OR dfIR   = NUMBER_Null 
OR dfIR   = 0 
OR dfBRID > 0
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 +  If SqlPLSQLCommand(hSql(), 
  "dpu.get_scalerate (dfTYPEID,  dfKV,    dfVIDD,
                      dfSUM*100, dfDATN,  dfDATO,
                      l_mnth,    l_days,
                      l_actrate, l_maxrate, l_recid)")
.head 8 +  If l_maxrate > 0 AND dfIR > l_maxrate
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 -  ! < Проверка существования ДС с указанным номером >
.head 5 +  Else If sParName = 'NumAgreem'
.head 6 +  If dfDPU_ID = NUMBER_Null AND pDPU_GEN != NUMBER_Null
.head 7 +  If SqlPrepareAndExecute(hSql(), 
   "SELECT count(*) 
      INTO :l_recid 
      FROM dpu_deal 
     WHERE dpu_gen = :pDPU_GEN 
       AND dpu_add = :dfND") 
AND SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! Введенный номер доп.соглашения УЖЕ существует! Продолжить?
.head 8 +  If l_recid > 0 AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessDopSogl'), 
              CurrentLangTable.GetAtomTitle('cTAt'), 
              MB_IconQuestion|MB_YesNo ) = IDNO 
.head 9 -  Return FALSE
.head 6 -  Return TRUE
.head 5 -  ! < Перевірка введеного МФО банку отримувача ДЕПОЗИТУ >
.head 5 +  Else If sParName = 'BankCodeD'
.head 6 -  Set dfNBD = F_VALIDATE_BANK_CODE(Str(frm_Open.dfMFOD))
.head 6 +  If (dfNBD = STRING_Null)
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Return TRUE
.head 5 -  ! < Перевірка введеного МФО банку отримувача ВІДСОТКІВ >
.head 5 +  Else If sParName = 'BankCodeP'
.head 6 -  Set dfNBP = F_VALIDATE_BANK_CODE(Str(frm_Open.dfMFOP))
.head 6 +  If (dfNBP = STRING_Null)
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Return TRUE
.head 5 -  ! < Перевірка введених дат >
.head 5 +  Else If sParName = 'DATO'
.head 6 +  If ( ( dfDATO <= dfDATN ) OR ( dfDATO <= dfDATZ ) )
.head 7 -  ! Некорректно задана дата закінчення!
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrDat'),
                    CurrentLangTable.GetAtomTitle('cTAt'),
                    MB_IconExclamation )
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute( hSql(), 
"SELECT SubStr(dpu.date_validate(:dfVIDD,:dfDATN,:dfDATO),1,250) INTO :sErrorList FROM dual")
.head 8 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 8 +  If ( sErrorList = STRING_Null )
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Call SalMessageBox( sErrorList,
                    CurrentLangTable.GetAtomTitle('cTAt'),
                    MB_IconExclamation )
.head 7 -  Return FALSE
.head 3 +  Function: f_get_viddpar
.head 4 -  Description: ф-я повертає параметри виду депозитного договору
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), "
SELECT dpu_types.type_id, dpu_types.type_name,
       tabval.kv, tabval.lcv, tabval.name, 
       dpu_vidd.TERM_MIN, dpu_vidd.TERM_MAX, dpu_vidd.COMPROC, nvl(dpu_vidd.FL_EXTEND, 0), 
       nvl(dpu_vidd.MIN_SUMM,0)/100, nvl(dpu_vidd.MAX_SUMM,0)/100,
       dpu_vidd.TERM_TYPE, dpu_vidd.IRVK,
       freq.freq,    freq.Name,
       brates.BR_ID, brates.Name,  
       dpt_stop.id,  dpt_stop.Name
  INTO :dfTYPEID,  :cmbTYPE,   :dfKV,  :dfISO,  :cmbKV, 
       :nMinTerm,  :nMaxTerm,  :cbCOMPROC, :nFlExtend,  
       :dfMIN_SUM, :nMaxAmnt,  :nTermType, :nPeriodType,
       :dfFREQ,    :cmbFREQ, 
       :dfBRID,    :cmbBR,
       :dfSTOPID,  :cmbSTOP     
  FROM dpu_vidd,  dpu_types,
       freq,      dpt_stop,
       tabval,    brates  
 WHERE dpu_vidd.kv      = tabval.kv 
   AND dpu_vidd.freq_v  = freq.freq
   AND dpu_vidd.id_stop = dpt_stop.id
   AND dpu_vidd.type_id = dpu_types.type_id
   AND dpu_vidd.br_id   = brates.br_id(+)
   AND dpu_vidd.vidd    = "||Str(dfVIDD) )
And SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If dfDPU_ID = NUMBER_Null
.head 7 -  Call F_HIDE_SHOW ('REFRESH_RATES')
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: f_GetDateReturn
.head 4 -  Description: Дата повернення коштів по депозитному договору
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: DateClose
.head 4 +  Actions
.head 5 -  Set DateClose = frm_Open.dfDATO
.head 5 +  If ( sDptBankType = 'SBER' )
.head 6 -  ! Для ощадбанку дата повернення = дата завершення + 1 день
.head 6 -  Set DateClose = ( DateClose + 1 )
.head 5 -  Return DptCorrectDate( frm_Open.dfKV, DateClose, DateClose + 1)
.head 3 +  Function: f_GetNewDateClose
.head 4 -  Description: Розрахунок нової дати завершення при пролонгації депозиту
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  Number: nDPU_ID
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dNewDateClose
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), "
SELECT  case 
         when extract(DAY FROM d.dat_begin) = extract(DAY FROM d.dat_end)
         then  ADD_MONTHS(d.dat_end, Months_Between(d.dat_end, d.dat_begin))
         else  d.dat_end + (d.dat_end - d.dat_begin)  end
      INTO  :dNewDateClose
    FROM  bars.dpu_deal d
WHERE  d.dpu_id = " || Str( nDPU_ID ) ) And SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return dNewDateClose
.head 5 +  Else
.head 6 -  Return DATETIME_Null
.head 3 +  Function: f_GetCustParams
.head 4 -  Description: Пошук параметрів клієнта по РНК
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dfOKPO  = STRING_Null
.head 5 -  Set dfNMK   = STRING_Null
.head 5 -  Set dfADRES = STRING_Null
.head 5 -  Set dfK013  = STRING_Null
.head 5 +  If SqlPrepareAndExecute( hSql(),
"select c.OKPO, nvl(c.NMKK,c.NMK), c.ADR,
        ( select substr(w.VALUE, 1, 1) 
            from CUSTOMERW w
           where w.TAG = 'K013'
             and w.RNK = c.RNK )
   into :dfOKPO, :dfNMK, :dfADRES, :dfK013
   from CUSTOMER c
  where c.RNK = :frm_Open.dfRNK" )
.head 6 +  If SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Set dfNMSD = Subs(dfNMK, 1, 38)
.head 7 -  Set dfNMSP = Subs(dfNMK, 1, 38)
.head 7 -  Set dfOKPOP = dfOKPO
.head 7 -  ! "-РРММДД-ЧЧММСС"
.head 7 -  Set dfND = Str(frm_Open.dfRNK)||"-"||SalFmtFormatDateTime( SalDateCurrent(), 'yyMMdd-hhhhmmss' )
.head 3 +  Function: F_VALIDATE_BANK_CODE
.head 4 -  Description: Перевірка МФО банку
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sBankCode
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sBankName
.head 5 -  String: sCondition
.head 5 -  String: sAddErrMsg
.head 4 +  Actions
.head 5 -  Set sCondition = ""
.head 5 -  ! Для депозитів в інвалюті виплата лише в межах свого банку (в т.ч. для SWIFT)
.head 5 +  ! If ( sDptBankType = 'SBER' )
.head 6 +  If ( dfKV != GetBaseVal() AND GetBankMfo() != '300465' )
.head 7 -  Set sCondition = " and MFOU in ( select MFOU from BARS.BANKS$BASE where MFO='"|| GetBankMfo() ||"' )"
.head 7 -  Set sAddErrMsg = ' '||CurrentLangTable.GetAtomTitle('frm_Open.cTErrCurrencyPayout')||' '||Str( dfKV )
.head 5 +  If SqlPrepareAndExecute( hSql(),
"select NB
   into :sBankName
   from BARS.BANKS$BASE
  where BLK = 0
    and SSP = 1
    and MFO = '" || sBankCode || "'" || sCondition
) And SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Return sBankName
.head 5 +  Else
.head 6 -  ! Не знайшли банк з МФО ...
.head 6 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrMfo') ||' '|| sBankCode || sAddErrMsg
                  , CurrentLangTable.GetAtomTitle('cTAt')
                  , MB_IconExclamation )
.head 6 -  Return STRING_Null
.head 2 +  Window Parameters
.head 3 -  Window Handle: hWndParent
.head 3 -  ! nMode = 1 - Повний доступ
.head 3 -  ! nMode = 2 - бухгалтер (без права змінювати параметри договору)
.head 3 -  ! nMode = 3 - ревізор (тільки перегляд)
.head 3 -  Number: nMode
.head 3 -  Number: pDPU_ID
.head 3 -  Number: pDPU_GEN
.head 3 -  Number: pISP
.head 3 -  Number: pGRP
.head 3 -  ! nSegment - сегмент бізнесу
.head 3 -  Number: nSegment
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  Long String: sErrMsg
.head 3 -  ! String: sAccId
.head 3 -  String: sTmp
.head 3 -  String: sCOMMENT
.head 3 -  String: sBranchName
.head 3 -  Number: nTRUSTID
.head 3 -  Number: nTmp
.head 3 -  ! Date/Time: dTmp
.head 3 -  Number: nSUBDEALID
.head 3 -  Number: nFlExtend   !! Лінія     / Стандарт
.head 3 -  Number: nPeriodType !! Строковий / На вимогу
.head 3 -  Number: nTermType   !! фіксованй / Діапазон
.head 3 -  Number: nMaxAmnt    !! Max. сума депозиту
.head 3 -  Number: nMinTerm    !! Min. термін депозиту
.head 3 -  Number: nMaxTerm    !! Max. термін депозиту
.head 3 -  Boolean: bProl      !! прапорець пролонгації вкладу
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Open.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  !
.head 4 -  Set dfDPU_ID = pDPU_ID
.head 4 -  ! << Підготовка форми для створення нової угоди >>
.head 4 +  If pDPU_ID = NUMBER_Null AND pDPU_GEN = NUMBER_Null
.head 5 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 5 -  Call F_HIDE_SHOW ('PREPARE')
.head 4 -  ! << Перегляд угоди >>
.head 4 +  Else
.head 5 -  Call f_populate()
.head 4 -  ! *************************************************************
.head 4 -  Call SalCenterWindow( frm_Open )
.head 4 +  If SalStatusSetVisible( frm_Open, TRUE )
.head 5 -  Call SalStatusSetText ( frm_Open, sLibraryVersion )
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On UM_CreateDoc
.head 4 -  Call CreateDptDoc(frm_Open.dfDPU_ID, frm_Open.dfVIDD)
.head 3 +  On SAM_Destroy
.head 4 +  If nMode = 1
.head 5 -  Call SalSendMsg(DPU_DEAL.pbRefresh, SAM_Click, 0, 0)
.head 1 +  Form Window: frm_Dog
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Текущее состояние депозитного договора
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.229"
.head 4 -  Width:  13.717"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.762"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: sTITLE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    0.095"
.head 6 -  Width:  10.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Times New Roman
.head 5 -  Font Size: 16
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: System Frame Color
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.55"
.head 6 -  Top:    0.036"
.head 6 -  Width:  2.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Times New Roman
.head 5 -  Font Size: 16
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbDetails
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.05"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! "Параметры договора"
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Dog.cBTipDetails')
.head 5 +  On SAM_Click
.head 6 +  If sBankType = 'PRVX'
.head 7 +  If not IsWindow(hWin5)
.head 8 -  Set hWin5 = SalCreateWindow( frm_OpenM, hWndMDI, hWndForm, 
                                                              nMode, VIDD, DPU_ID, 0, 0, 0, DPU_GEN )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_OpenM)
.head 6 +  Else
.head 7 +  If not IsWindow(hWin5)
.head 8 -  Set hWin5 = SalCreateWindow( frm_Open, hWndMDI, hWndForm, 
                                                               nMode, DPU_ID, DPU_GEN, NUMBER_Null, NUMBER_Null, NUMBER_Null)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_Open)
.head 6 -  Call F_POPULATE()
.head 3 +  Pushbutton: pbRefresh
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbRefresh
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    0.05"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! "Перечитать"
.head 6 -  Set strTip =CurrentLangTable.GetAtomTitle('frm_Dog.cBTipRefresh')
.head 5 +  On SAM_Click
.head 6 -  Call F_POPULATE()
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.8"
.head 5 -  Top:    0.05"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! 'Выйти'
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Dog.cBTipExit')
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 40375
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.619"
.head 5 -  Width:  13.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.1"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Вид депозита:
.head 4 -  Resource Id: 40371
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.45"
.head 5 -  Top:    0.57"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    0.55"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Валюта договора:
.head 4 -  Resource Id: 40372
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.45"
.head 5 -  Top:    0.87"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    0.84"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Выплата %%:
.head 4 -  Resource Id: 40373
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    0.57"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFREQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFREQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.3"
.head 6 -  Top:    0.55"
.head 6 -  Width:  3.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Депозитный счет:
.head 4 -  Resource Id: 40368
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.18"
.head 5 -  Width:  2.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    1.13"
.head 6 -  Width:  1.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Депозитный счет'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Dog.cFTipNLS'))
.head 3 +  Data Field: OST_PL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.9"
.head 6 -  Top:    1.13"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Остаток на депозитном счете'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Dog.cFTipOST_PL'))
.head 3 +  Child Table: TB1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    2.75"
.head 6 -  Width:  7.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.357"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: DAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Приход
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.471"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRIDs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Приход
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RASD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Расход
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.371"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RASDs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Расход
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ISXD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
по вкладу
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ISXDs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
по вкладу
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PROC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: %
ставка
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblPopulate(TB1, hSql(), 
    "SELECT fdat, kos/100, dos/100,(ostf-dos+kos)/100, acrn.fprocn(acc,1,fdat)
       INTO :TB1.DAT,:TB1.PRID,:TB1.RASD,:TB1.ISXD,:TB1.PROC
       FROM saldoa 
      WHERE acc = :ACC
      ORDER BY fdat desc", TBL_FillAll )
.head 5 +  On SAM_DoubleClick
.head 6 -  Set sdat = SalFmtFormatDateTime(TB1.DAT,'MM/dd/yyyy')
.head 6 -  Call ShowTurnForAccount(ACC, sdat)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set PRIDs = Dig4(PRID, nDig, nDig)
.head 6 -  Set RASDs = Dig4(RASD, nDig, nDig)
.head 6 -  Set ISXDs = Dig4(ISXD, nDig, nDig)
.head 3 -  !
.head 3 -  Background Text: Счет начисл.%%:
.head 4 -  Resource Id: 40369
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    1.18"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Teal
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgACCN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: NLSN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.3"
.head 6 -  Top:    1.13"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Счет начисленных %%' 
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Dog.cFTipNLSN'))
.head 3 +  Data Field: OSTN_PL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.3"
.head 6 -  Top:    1.13"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Остаток на счете начисленных %%' 
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Dog.cFTipOSTN_PL'))
.head 3 +  Child Table: TB2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.35"
.head 6 -  Top:    2.75"
.head 6 -  Width:  5.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.357"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: DAT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRIP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Начис
%
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.057"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PRIPs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Начис
%
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RASP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выплата
 %
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.014"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RASPs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выплата
 %
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ISXP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
по %
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ISXPs
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Остаток
по %
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblPopulate( TB2, hSql(), 
    "SELECT fdat, kos/100, dos/100,(ostf-dos+kos)/100
       INTO :TB2.DAT,:TB2.PRIP,:TB2.RASP,:TB2.ISXP
       FROM saldoa 
      WHERE acc = :ACCN
      ORDER BY fdat desc", TBL_FillAll )
.head 5 +  On SAM_DoubleClick
.head 6 -  Set sdat = SalFmtFormatDateTime(TB2.DAT,'MM/dd/yyyy')
.head 6 -  Call ShowTurnForAccount(ACCN, sdat)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set PRIPs = Dig4(PRIP, nDig, nDig)
.head 6 -  Set RASPs = Dig4(RASP, nDig, nDig)
.head 6 -  Set ISXPs = Dig4(ISXP, nDig, nDig)
.head 3 -  !
.head 3 -  Line
.head 4 -  Resource Id: 40376
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  1.65"
.head 5 -  Begin Y:  0.45"
.head 5 -  End X:  1.65"
.head 5 -  End Y:  0.01"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 3
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 40374
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.44"
.head 5 -  Width:  13.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.131"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  ! * Прием депозита
.head 3 +  Pushbutton: pb0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Размещение
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.75"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.357"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sTT = F_TT(0, GetBankMfo(), STRING_Null, KV)
.head 6 -  ! Зарахування коштів на депозитний рахунок зг.<sNAZN0> без ПДВ
.head 6 -  Set sNAZN = CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0')||sNAZN0||' '||
            CurrentLangTable.GetAtomTitle('frm_Dog.cTNaznPDV')
.head 6 +  If not IsWindow(hWinW)
.head 7 -  Set hWinW = SalCreateWindow(CB_VVOD1, hWndMDI, 
            frm_Dog.DPU_ID, sTT, 0, 
            frm_Dog.KV, STRING_Null, frm_Dog.SUM, frm_Dog.MIN_SUM, 0, 
            STRING_Null, frm_Dog.NLS,
            GetBankMfo(), STRING_Null, STRING_Null, sNAZN)
.head 3 -  ! Пополнение депозита
.head 3 +  Pushbutton: pb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пополнение
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    2.22"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.357"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sTT = F_TT(1, GetBankMfo(), STRING_Null, KV)
.head 6 -  ! Зарахування коштів на депозитний рахунок зг.<sNAZN0> без ПДВ
.head 6 -  Set sNAZN = CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0')||sNAZN0||' '||
            CurrentLangTable.GetAtomTitle('frm_Dog.cTNaznPDV')
.head 6 +  If not IsWindow(hWinW)
.head 7 -  Set hWinW = SalCreateWindow(CB_VVOD1, hWndMDI, 
            frm_Dog.DPU_ID, sTT, 1, 
            frm_Dog.KV, STRING_Null, 0, 0, 0, 
            STRING_Null, frm_Dog.NLS,
            GetBankMfo(), STRING_Null, STRING_Null, sNAZN)
.head 3 -  ! Начисление процентов
.head 3 +  Pushbutton: pb3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Начисление %%
.head 4 -  Window Location and Size
.head 5 -  Left:   3.5"
.head 5 -  Top:    1.75"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.357"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Нарахування відсотків по депозиту
.head 6 +  If ( SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Dog.cTMessAccrualInterest' ),
                                         CurrentLangTable.GetAtomTitle( 'cTAt' ),
                                         MB_IconQuestion | MB_YesNo) = IDYES )
.head 7 -  Call SalWaitCursor( TRUE )
.head 7 -  Call SaveInfoToLog( CurrentLangTable.GetAtomTitle( 'frm_Dog.cTMessAccrualInterestConfirm' ) || Str(frm_Dog.DPU_ID) )
.head 7 +  If ( F_ACCRUAL_INTEREST() )
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Dog.cAccrualInterestDone' ), 
                                            CurrentLangTable.GetAtomTitle( 'cTInfo' ), 
                                            MB_IconInformation )
.head 8 -  Call F_POPULATE()
.head 7 +  Else
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Dog.cAccrualInterestError' ), 
                                            CurrentLangTable.GetAtomTitle( 'cTErr' ),
                                            MB_IconStop )
.head 7 -  Call SalWaitCursor( FALSE )
.head 6 +  Else
.head 7 -  Call SaveInfoToLog( CurrentLangTable.GetAtomTitle( 'frm_Dog.cTMessAccrualInterestCancel' ) || Str(frm_Dog.DPU_ID) )
.head 6 -  ! Call Sel010( hWndMDI, 0, 0, " AND s.acc IN (SELECT accid FROM dpu_accounts WHERE dpuid = "||Str(frm_Dog.DPU_ID)||")", UseDpuLine() )
.head 3 -  ! Перечисление начисленных %%
.head 3 +  Pushbutton: pb4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выплата начисл.%%
.head 4 -  Window Location and Size
.head 5 -  Left:   3.5"
.head 5 -  Top:    2.22"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.357"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Teal
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If ( ( ( sBankType = 'SBER' ) AND ( ( nPenyaDone > 0 ) OR ( dDATA >= DATV) ) ) OR 
     ( ( VisGetKeyState(VK_Alt) & KS_Down ) AND ( VisGetKeyState(VK_Control) & KS_Down ) ) 
   )  !! Then
.head 7 -  ! Якщо натиснути [F5 + Shift] в полі номер документу стане доступним до редагування поле суми
.head 7 -  Set sNAZN = CurrentLangTable.GetAtomTitle( 'frm_Dog.cTNazn4' ) || ' ' || sNAZN0
.head 7 -  ! Set sNAZN = 'Виплата відсотків згідно деп.дог. '||sNAZN0
.head 7 -  Set sTT = F_TT(4, frm_Dog.sMfoP, frm_Dog.sNlsP, KV)
.head 7 +  If sTT = F_TT(4, frm_Dog.sMfoP, frm_Dog.sNlsP, GetBaseVal())
.head 8 +  If not IsWindow(hWinWW)
.head 9 -  Set hWinWW = SalCreateWindow(CB_VVOD1, hWndMDI, 
            frm_Dog.DPU_ID, sTT, 4, 
            frm_Dog.KV, STRING_Null, frm_Dog.OSTN_PL, 0, 0,  
            frm_Dog.NLSN,  frm_Dog.sNlsP,
            frm_Dog.sMfoP, frm_Dog.sNlsP, frm_Dog.sNmsP, sNAZN)
.head 7 +  Else
.head 8 +  ! If not IsWindow(hWinWW)
.head 9 -  Set hWinWW = SalCreateWindow(CB_VVOD1, hWndMDI, 
            frm_Dog.DPU_ID, sTT, 4, 
            frm_Dog.KV, STRING_Null, frm_Dog.OSTN_PL, 0, 0, 
            frm_Dog.NLSN,  STRING_Null,
            frm_Dog.sMfoP, frm_Dog.sNlsP, frm_Dog.sNmsP, sNAZN)
.head 8 +  If not IsWindow(hWinWW)
.head 9 -  Set hWinWW = SalCreateWindow(CB_VVOD1, hWndMDI, 
            frm_Dog.DPU_ID, sTT, 4, 
            frm_Dog.KV, STRING_Null, frm_Dog.OSTN_PL, 0, 0, 
            frm_Dog.NLSN,  STRING_Null,
            STRING_Null, STRING_Null, STRING_Null, sNAZN )
.head 6 +  Else
.head 7 -  Call SalCreateWindow(AcrPay, hWndMDI, nMode, frm_Dog.DPU_ID, STRING_Null)
.head 3 -  ! Погашение депозита
.head 3 +  Pushbutton: pb_Repayment
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Погашение
.head 4 -  Window Location and Size
.head 5 -  Left:   6.7"
.head 5 -  Top:    1.75"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.357"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If ( F_UNLOCK_DEPOSIT_ACCOUNT( frm_Dog.ACC ) )
.head 7 -  Set sTT = F_TT(2, frm_Dog.MFOD, frm_Dog.ACCD, KV)
.head 7 -  ! Повернення коштів згідно деп.дог. <sNAZN0> без ПДВ
.head 7 -  Set sNAZN = CurrentLangTable.GetAtomTitle( 'frm_Dog.cTNazn2' ) ||' '|| sNAZN0 ||' '||
            CurrentLangTable.GetAtomTitle( 'frm_Dog.cTNaznPDV' )
.head 7 +  If sTT = F_TT(2, frm_Dog.MFOD, frm_Dog.ACCD, GetBaseVal())
.head 8 +  If not IsWindow(hWinW)
.head 9 -  Set hWinW = SalCreateWindow(CB_VVOD1, hWndMDI, 
            frm_Dog.DPU_ID, sTT, 2, 
            frm_Dog.KV, STRING_Null, IifN( ( ID_STOP = 0 ), NUMBER_Null, frm_Dog.OST_PL ), frm_Dog.MIN_SUM, 0,  
            frm_Dog.NLS, frm_Dog.ACCD,
            frm_Dog.MFOD, frm_Dog.ACCD, frm_Dog.NMSD, sNAZN)
.head 7 +  Else
.head 8 +  If not IsWindow( hWinW )
.head 9 +  If ( F_USE_VPS( frm_Dog.MFOD ) )
.head 10 -  ! через ВПС ( для Ощада )
.head 10 -  Set hWinW = SalCreateWindow(CB_VVOD1, hWndMDI, 
            frm_Dog.DPU_ID, sTT, 2, 
            frm_Dog.KV, STRING_Null, frm_Dog.OST_PL, frm_Dog.MIN_SUM, 0,  
            frm_Dog.NLS, frm_Dog.ACCD,
            frm_Dog.MFOD, frm_Dog.ACCD, frm_Dog.NMSD, sNAZN )
.head 9 +  Else
.head 10 -  Set hWinW = SalCreateWindow( CB_VVOD1, hWndMDI, 
            frm_Dog.DPU_ID, sTT, 2, 
            frm_Dog.KV, STRING_Null, frm_Dog.OST_PL, frm_Dog.MIN_SUM, 0, 
            frm_Dog.NLS, STRING_Null,
            STRING_Null, STRING_Null, STRING_Null, sNAZN )
.head 3 -  ! Досрочное разорвание договора
.head 3 +  Pushbutton: pb5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Штрафование
.head 4 -  Window Location and Size
.head 5 -  Left:   9.9"
.head 5 -  Top:    1.75"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.357"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 6 +  If dfAcrDate < dDATA - 1
.head 7 -  ! Для расчета штрафа нужно доначислить проценты
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Dog.cTMessShtraf'), 
                                             CurrentLangTable.GetAtomTitle('cTAt'), 
                                             MB_IconExclamation )
.head 7 -  Call SalSendMsg(pb3, SAM_Click, 0, 0)
.head 6 +  Else
.head 7 +  If not f_get_penya( sErrMsg )
.head 8 -  Call SalMessageBox(sErrMsg, CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop)
.head 3 -  ! Часткове зняття коштів ( інтерфейс вікна )
.head 3 +  Pushbutton: pb6
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Часткова виплата
.head 4 -  Window Location and Size
.head 5 -  Left:   6.7"
.head 5 -  Top:    2.22"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.357"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Magenta
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_HIDE_SHOW( 'HideDefault' )
.head 3 -  ! Перерахунок нарахованих %%
.head 3 +  Pushbutton: pb7
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Перерахунок відсотків
.head 4 -  Window Location and Size
.head 5 -  Left:   9.9"
.head 5 -  Top:    2.22"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.357"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Chartreuse
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Виконати перерахунок нарахованих відсотків?
.head 6 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Dog.cTMessIntRecalc'),
                                       CurrentLangTable.GetAtomTitle('cTAt'), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 7 -  Call SqlSetLongBindDatatype( 2, 22 )
.head 7 +  If SqlPLSQLCommand( hSql(), "DPU.INTEREST_RECALCULATION( frm_Dog.DPU_ID,  frm_Dog.sErrMsg )" )
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Dog.cIntRecalcDone') || Chr(10) || Chr(10) || sErrMsg, 
                                            CurrentLangTable.GetAtomTitle('cTInfo'), 
                                            MB_IconInformation )
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  ! Помилка під час перерахунку відсотків
.head 8 -  Call MessageNoWait( CurrentLangTable.GetAtomTitle('frm_Dog.cTErrIntRecalc'), 
                                             CurrentLangTable.GetAtomTitle('cTErr'),  0,  1)
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 3 +  Data Field: dfAMOUNT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.8"
.head 6 -  Top:    2.25"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! Часткове зняття коштів ( Ok )
.head 3 +  Pushbutton: pbOK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok
.head 4 -  Window Location and Size
.head 5 -  Left:   8.8"
.head 5 -  Top:    2.22"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.357"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Виконати часткову виплату коштів з депозиту?
.head 6 +  If SalIsNull( dfAMOUNT ) OR dfAMOUNT = 0
.head 7 -  Call F_HIDE_SHOW( 'ShowDefault' )
.head 6 +  Else
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Dog.cTMessPartPaym'),
                                       CurrentLangTable.GetAtomTitle('cTAt'), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 8 -  Call F_HIDE_SHOW( 'ShowDefault' )
.head 8 +  If nPartPayOpt = 0
.head 9 -  ! Для зняття без штрафу показуєм вікно вводу документа
.head 9 -  Set sTT = F_TT(2, frm_Dog.MFOD, frm_Dog.ACCD, KV)
.head 9 -  ! Повернення коштів згідно деп.дог. <sNAZN0>
.head 9 -  Set sNAZN = CurrentLangTable.GetAtomTitle( 'frm_Dog.cTNazn3') ||' '|| sNAZN0
.head 9 +  If sTT = F_TT(2, frm_Dog.MFOD, frm_Dog.ACCD, GetBaseVal())
.head 10 +  If not IsWindow(hWinW)
.head 11 -  Set hWinW = SalCreateWindow( CB_VVOD1, hWndMDI, 
            frm_Dog.DPU_ID, sTT, 2, 
            frm_Dog.KV, STRING_Null, frm_Dog.dfAMOUNT, 0, 0,  
            frm_Dog.NLS, frm_Dog.ACCD,
            frm_Dog.MFOD, frm_Dog.ACCD, frm_Dog.NMSD, sNAZN)
.head 11 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 8 +  Else
.head 9 -  ! Для зняття із штрафом автоматично породжуєм всі операції 
.head 9 -  Call SqlSetLongBindDatatype( 4, 22 )
.head 9 +  If SqlPLSQLCommand( hSql(), "DPU.PARTIAL_PAYMENT( frm_Dog.DPU_ID, frm_Dog.dfAMOUNT*SalNumberPower(10,nDig), frm_Dog.nPartPayOpt, frm_Dog.sErrMsg )" )
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Dog.cPartPaymDone') || Chr(10) || Chr(10) || frm_Dog.sErrMsg,
                    CurrentLangTable.GetAtomTitle('cTInfo'), 
                    MB_IconInformation )
.head 9 +  Else
.head 10 -  ! Помилка при частковій виплаті
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Call MessageNoWait( CurrentLangTable.GetAtomTitle('frm_Dog.cTErrPartPaym'), 
                    CurrentLangTable.GetAtomTitle('cTErr'), 0, 1 )
.head 8 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 7 +  Else
.head 8 -  ! Якщо відмовилися від часткового зняття
.head 8 -  Call F_HIDE_SHOW( 'ShowDefault' )
.head 3 +  Radio Button: rb0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: без перерахунку відсотків
.head 4 -  Window Location and Size
.head 5 -  Left:   9.983"
.head 5 -  Top:    1.75"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Часткова виплата без перерахунку відсотків
.head 6 -  Set nPartPayOpt = 0
.head 3 +  Radio Button: rb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: перерахунок на суму зняття
.head 4 -  Window Location and Size
.head 5 -  Left:   9.983"
.head 5 -  Top:    2.05"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Часткова виплата з поверненням нарахованих на суму зняття відсотків
.head 6 -  Set nPartPayOpt = 1
.head 3 +  Radio Button: rb2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: по штрафному алгоритму
.head 4 -  Window Location and Size
.head 5 -  Left:   9.983"
.head 5 -  Top:    2.35"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Red
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Часткова виплата з перерахунком відсотків згідно параметрів штрафу
.head 6 -  Set nPartPayOpt = 2
.head 3 +  Pushbutton: pb_PrintReport
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbPrint
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.1"
.head 5 -  Top:    0.05"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Друк виписки
.head 6 -  Set strTip =CurrentLangTable.GetAtomTitle('frm_Dog.cBTipPrintReport')
.head 5 +  On SAM_Click
.head 6 -  Call F_PRINT_REPORT()
.head 3 -  Background Text: Нараховано по:
.head 4 -  Resource Id: 12598
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    0.87"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAcrDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAcrDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.3"
.head 6 -  Top:    0.84"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_POPULATE
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFL_ADD
.head 5 -  Number: nFL_EXT
.head 4 +  Actions
.head 5 -  Set dfFREQ = FREQ
.head 5 -  Set dfVIDD = VIDDNAME
.head 5 -  Set dfKV = LCV
.head 5 -  Set dfND = ND
.head 5 -  !
.head 5 -  Call SalDisableWindow(pb0)
.head 5 -  Call SalDisableWindow(pb1)
.head 5 -  Call SalDisableWindow(pb_Repayment)
.head 5 -  Call SalDisableWindow(pb3)
.head 5 -  Call SalDisableWindow(pb4)
.head 5 -  Call SalDisableWindow(pb5)
.head 5 -  Call SalDisableWindow(pb6)
.head 5 -  Call SalDisableWindow(pb7)
.head 5 -  !
.head 5 -  Call SalSendMsg(TB1, SAM_Create, 0, 0)
.head 5 -  Call SalSendMsg(TB2, SAM_Create, 0, 0)
.head 5 -  !
.head 5 +  If SqlPrepareAndExecute (hSql (),
  "SELECT a.acc, a.nls, a.ostb, b.acc, b.nls, b.ostb, i.acrb, i.acr_dat, i.stp_dat, 
          d.closed, d.mfo_p, d.nls_p, d.nms_p
     INTO :ACC, :NLS, :OST_PL, :ACCN, :NLSN, :OSTN_PL, :ACC7, :dfAcrDate, :STP_DAT,
          :CLOSED, :sMfoP, :sNlsP, :sNmsP
     FROM accounts a, dpu_deal d, int_accn i, accounts b 
    WHERE d.acc = a.acc 
      AND a.acc = i.acc 
      AND i.id = 1 
      AND i.acra = b.acc 
      AND d.dpu_id = :DPU_ID")
.head 6 +  If SqlFetchNext (hSql(), nFetchRes)
.head 7 -  Set OST_PL = OST_PL*SalNumberPower(10, -nDig)
.head 7 -  Set OSTN_PL = OSTN_PL*SalNumberPower(10, -nDig)
.head 7 +  If (CLOSED != 1 AND nMode != 3)
.head 8 -  ! была ли операция штрафования
.head 8 +  If SqlPrepareAndExecute( hSql(), 
"SELECT  count( o.ref )
   INTO  :nPenyaDone
   FROM  BARS.OPLDOK t
   JOIN  BARS.OPER   o        on (  o.REF    = t.REF )
   JOIN  BARS.DPU_ACCOUNTS da on ( da.ACCID  = t.ACC )
   JOIN  BARS.DPU_PAYMENTS dp on ( dp.DPU_ID = da.DPUID  AND  dp.REF = t.REF )  
  WHERE  t.fdat between :DATN AND greatest(trunc(SYSDATE), bankdate)
    AND  t.dk = 0 
    AND  t.sos > 0
    AND  o.tt IN ( 'DUS', 'DUT' )
    AND  dp.DPU_ID = :DPU_ID ") AND NOT SqlFetchNext(hSql(), nFetchRes )
.head 9 -  Set nPenyaDone = 0
.head 8 -  ! Якщо договір не штрафований
.head 8 +  If nPenyaDone = 0
.head 9 -  ! Нарахувати %%
.head 9 +  If ((dfAcrDate < STP_DAT) OR (STP_DAT = DATETIME_Null))
.head 10 -  Call SalEnableWindow( pb3 )
.head 9 -  ! Розміщення депозиту
.head 9 +  If ( ( OST_PL = 0 ) AND ( DATN <= dDATA  AND DATO > dDATA ) )
.head 10 -  Call SalEnableWindow( pb0 )
.head 9 -  ! Поповнити депозит
.head 9 +  If SqlPrepareAndExecute( hSql(), 
  "SELECT nvl(v.fl_add, 0), nvl(v.fl_extend, 0) 
     INTO :nFL_ADD, :nFL_EXT 
     FROM dpu_vidd v, dpu_deal d 
    WHERE v.vidd = d.vidd 
      AND d.dpu_id = :frm_Dog.DPU_ID" )
.head 10 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If ( nFL_ADD = 1 AND DATZ <= dDATA AND (DATO > dDATA OR DATO = DATETIME_Null) )
.head 10 -  Call SalEnableWindow( pb1 )
.head 8 +  Else
.head 9 -  Call SalDisableWindow( pb0 )
.head 9 -  Call SalDisableWindow( pb1 )
.head 9 -  Call SalDisableWindow( pb3 )
.head 8 -  ! перечислить %%
.head 8 +  If OSTN_PL > 0
.head 9 -  Call SalEnableWindow(pb4)
.head 8 -  ! штрафование
.head 8 +  If ( OST_PL     > 0             AND
     ID_STOP   != NUMBER_Null   AND
     ID_STOP    > 0             AND
     nPenyaDone = 0             AND
     DATN       < dDATA         AND
     DATO      != DATETIME_Null AND
     DATV       > dDATA )
.head 9 -  Call SalEnableWindow(pb5)
.head 8 -  ! погашение депозита
.head 8 +  If ( OST_PL > 0 ) AND 
   ( ID_STOP    = NUMBER_Null   OR 
     ID_STOP    = 0             OR
     nPenyaDone > 0             OR
     DATO       = DATETIME_Null OR 
     DATV      <= dDATA )
.head 9 -  Call SalEnableWindow(pb_Repayment)
.head 8 -  ! << Для Надри + якщо користувач має право виконувати такі операції >>
.head 8 +  If ( sDptBankType = 'NADRA' AND f_check_user_access() )
.head 9 -  ! Часткова виплата
.head 9 +  If OST_PL > 0 
.head 10 -  Call SalEnableWindow(pb6)
.head 9 -  ! Перерахунок відсотків
.head 9 -  Call SalEnableWindow(pb7)
.head 3 +  Function: f_get_penya
.head 4 -  Description: расчет и взыскание штрафа
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Receive Long String: sErrMsg
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nPenyaRate
.head 5 -  Number: nTotalIntNom
.head 5 -  Number: nTotalIntEqv
.head 5 -  Number: nPenyaIntNom
.head 5 -  Number: nPenyaIntEqv
.head 5 -  Number: nIntPayNom
.head 5 -  Number: nIntPayEqv
.head 5 -  Number: nDepPayNom
.head 5 -  Number: nDepPayEqv
.head 5 -  Number: nTaxIncome       ! сума повернення утриманого з нарахованих %% податку на прибуток з ФО
.head 5 -  Number: nTaxMilitary     ! сума повернення утриманого з нарахованих %% військового збору з ФО
.head 5 -  Number: nTaxIncomePay    ! сума утримання податку на прибуток з ФО (з нарахованих %% по штрафній ставці)
.head 5 -  Number: nTaxMilitaryPay  ! сума утримання військового збору з ФО (з нарахованих %% по штрафній ставці)
.head 5 -  Long String: sComment    ! 
.head 5 -  !
.head 5 -  Number: nPenyaAmount
.head 5 -  String: sNLSA
.head 5 -  String: sNMSA
.head 5 -  String: sOKPOA
.head 5 -  Number: nKVA
.head 5 -  String: sNLSB
.head 5 -  String: sNMSB
.head 5 -  String: sOKPOB
.head 5 -  Number: nKVB
.head 5 -  String: sNLSD
.head 5 -  String: sNMSD
.head 5 -  String: sOKPOD
.head 5 -  Number: nKVD
.head 5 -  Number: nVOB
.head 4 +  Actions
.head 5 -  Call SqlSetLongBindDatatype( 16, 22 )
.head 5 +  If SqlPLSQLCommand( hSql(),
"bars.DPU.get_penalty_ex( DPU_ID, dDATA, nTotalIntNom, nTotalIntEqv,
                          nPenyaIntNom,  nPenyaIntEqv, nIntPayNom, nIntPayEqv,
                          nDepPayNom,    nDepPayEqv,   nPenyaRate, 
                          nTaxIncome,    nTaxMilitary, 
                          nTaxIncomePay, nTaxMilitaryPay, sComment )" )
.head 6 +  If SalModalDialog( dlgPenalty, frm_Dog, DPU_ID, OSTN_PL*100, nTotalIntNom, 
                   nPenyaIntNom, nPenyaRate, sComment, f_check_user_access(), nPenyaAmount )
.head 7 -  ! << Сума штрафу повертається з діалогового вікна (може бути зкоригована) >>
.head 7 +  If ( nPenyaAmount > 0 )
.head 8 -  ! Надра, УПБ, договора лінії та договора ФОП через PENALTY_PAYMENT
.head 8 +  If ( sDptBankType = 'NADRA' ) OR ( sDptBankType = 'UPB' ) OR ( DPU_ADD > 0 ) OR ( (nTaxIncome+nTaxMilitary) > 0 )
.head 9 +  If NOT SqlPLSQLCommand(hSql(), "DPU.PENALTY_PAYMENT( DPU_ID, nPenyaAmount, 0, (nTaxIncome-nTaxIncomePay), (nTaxMilitary-nTaxMilitaryPay), 0, 0 )" )
.head 10 -  ! -- При формуванні документів: на повернення нарахованих %% по ставці договору та нарахуванню по штрафній ставці -------
.head 10 -  ! "DPU.PENALTY_PAYMENT( DPU_ID, nPenyaAmount, nPenyaIntNom, nTaxIncome, nTaxMilitary, nTaxIncomePay, nTaxMilitaryPay )" )
.head 10 -  ! -----------------------------------------------------------------------------------------------------------------------
.head 10 -  ! Помилка виконання операцій із стягнення штрафу по договору №...
.head 10 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_Dog.cTErrPaySHTRAF')||Str(DPU_ID)
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  Call SqlCommit( hSql() )
.head 10 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 10 -  ! Виплата депозиту
.head 10 -  Call SalSendMsg(pb_Repayment, SAM_Click, 0, 0)
.head 10 -  ! Виплата відсотків (ЯКЩО Є)
.head 10 +  If OSTN_PL > 0
.head 11 -  Call SalSendMsg(pb4, SAM_Click, 0, 0)
.head 10 -  Return TRUE
.head 8 +  Else
.head 9 -  ! << окончательная амортизация счетов дисконта/премии >>
.head 9 +  If NOT SqlPLSQLCommand(hSql(), "dpu.final_amrt(DPU_ID)")
.head 10 -  ! Ошибка при окончат.амортизации счетов дисконта/премии по договору №...
.head 10 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_Dog.cTErrFAMRT')||Str(DPU_ID)
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Return FALSE
.head 9 -  ! << счет А - счет начисленных процентов >>
.head 9 +  If SqlPrepareAndExecute(hSql(),
"SELECT a.nls, a.kv, substr(a.nms,1,38), c.okpo
   INTO :sNLSA, :nKVA, :sNMSA, :sOKPOA
   FROM accounts a, customer c
  WHERE a.rnk = c.rnk 
    AND a.acc = :ACCN")
AND Not SqlFetchNext(hSql(), nFetchRes) 
.head 10 -  ! Не найден счет начисленных процентов для деп.договора №...
.head 10 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_Dog.cTErrAccN')||Str(DPU_ID)
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Return FALSE
.head 9 -  ! << рахунок Б - рах. зменшення процентних витрат >>
.head 9 +  If SqlPrepareAndExecute( hSql(),
  "SELECT a.nls, a.kv, substr(a.nms,1,38), c.okpo
     INTO :sNLSB, :nKVB, :sNMSB, :sOKPOB
     FROM accounts a, customer c
    WHERE a.RNK = c.rnk  
      AND (a.kf, a.nls, a.kv) in ( select r.KF, r.G67N, 980 
                                     from PROC_DR r, DPU_VIDD v
                                    where v.vidd = :VIDD And r.nbs   = v.bsd
                                      and r.sour = 4     And r.rezid = v.vidd )" )
AND Not SqlFetchNext(hSql(), nFetchRes )
.head 10 -  ! Не описан счет расходов для деп.договора №...
.head 10 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_Dog.cTErrAccRed') || Str(DPU_ID)
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Return FALSE
.head 9 -  ! << депозитний рахунок >>
.head 9 +  If nDepPayNom > 0
.head 10 +  If SqlPrepareAndExecute(hSql(),
  "SELECT a.nls, a.kv, substr(a.nms,1,38), c.okpo
     INTO :sNLSD, :nKVD, :sNMSD, :sOKPOD
     FROM accounts a, customer c
    WHERE a.rnk = c.rnk 
      AND a.acc = :ACC")
AND not SqlFetchNext(hSql(), nFetchRes)
.head 11 -  ! Не найден депозитный счет для деп.договора №...
.head 11 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_Dog.cTErrAccD')||Str(DPU_ID)
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Return FALSE
.head 9 -  ! << вид док-та: для ГРН - это меморд, для ВАЛ - разновалютный ордер >>
.head 9 +  If nKVA != GetBaseVal( )
.head 10 +  If SqlPrepareAndExecute(hSql(),
  "SELECT min(vob) INTO :nVOB 
     FROM tts_vob
    WHERE tt   = 'DUS' 
      AND vob != 6")
AND not SqlFetchNext(hSql(), nFetchRes)
.head 11 -  Set nVOB = 16
.head 9 +  Else
.head 10 -  Set nVOB = 6
.head 9 -  ! назначение платежа 
.head 9 -  Set sNAZN = CurrentLangTable.GetAtomTitle('frm_Dog.cTNAZN')||' '||sNAZN0
.head 9 -  ! списание суммы штрафа с депозитного счета
.head 9 -  Set nRef = NUMBER_Null
.head 9 -  Set cDoc.nDPUID = DPU_ID
.head 9 +  If nDepPayNom > 0
.head 10 -  Call cDoc.SetDoc(nRef, 'DUT', 1, nVOB, STRING_Null,
                 SalDateCurrent(), SalDateCurrent(), GetBankDate(), GetBankDate(),
                 sNLSD, sNMSD, GetBankMfo(), '', nKVD, nDepPayNom,  sOKPOD,
                 sNLSB, sNMSB, GetBankMfo(), '', nKVB, nDepPayEqv, sOKPOB,
                 sNAZN, '',    GetIdOper(),  '', NUMBER_Null, 0)
.head 10 +  If not cDoc.oDoc()
.head 11 -  ! Невозможно оплатить операцию DUT на сумму ...
.head 11 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_Dog.cTErrPay')||' DUT '||
              CurrentLangTable.GetAtomTitle('frm_Dog.cTErrSum')||' '||
              SalNumberToStrX((nDepPayNom)/100,0)||IifS(KV = GetBaseVal(), 
              CurrentLangTable.GetAtomTitle('frm_Dog.cTGrn'), LCV)
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Return FALSE
.head 9 -  ! списание суммы штрафа с процентного счета
.head 9 -  Set nRef = NUMBER_Null
.head 9 -  Set cDoc.nDPUID = DPU_ID
.head 9 -  Call cDoc.SetDoc(nRef, 'DUS', 1, nVOB, STRING_Null,
                 SalDateCurrent(), SalDateCurrent(), dDATA, dDATA,
                 sNLSA, sNMSA, GetBankMfo(), '', nKVA, nIntPayNom, sOKPOA,
                 sNLSB, sNMSB, GetBankMfo(), '', nKVB, nIntPayEqv, sOKPOB,
                 sNAZN,  '',   GetIdOper(),  '', NUMBER_Null, 0)
.head 9 +  If not cDoc.oDoc()
.head 10 -  ! Невозможно оплатить операцию DUS
.head 10 -  Set sErrMsg = CurrentLangTable.GetAtomTitle( 'frm_Dog.cTErrPay' ) || ' DUS'
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Return FALSE
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Set nPenyaDone = 1
.head 9 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 9 -  Call SalSendMsg( pb_Repayment, SAM_Click, 0, 0 )
.head 9 +  If OSTN_PL > 0
.head 10 -  Call SalSendMsg( pb4, SAM_Click, 0, 0)
.head 9 -  Return TRUE
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  ! Якщо сума штрафу рівна нулю - виплачуємо тіло депозиту
.head 8 -  Call SalSendMsg( pb_Repayment, SAM_Click, 0, 0 )
.head 8 -  Return TRUE
.head 6 +  Else
.head 7 -  ! Користувач відмовився від штрафування договору
.head 7 -  Return TRUE
.head 5 +  Else
.head 6 -  ! Ошибка расчета суммы штрафа по договору №...
.head 6 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_Dog.cTErrGetPenalty') || Str(DPU_ID)
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Return FALSE
.head 3 +  Function: F_GETSUMEQV
.head 4 -  Description: Вычисление суммы в валюте Б
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nSum
.head 5 -  Date/Time: dDat
.head 5 -  Number: nKvA
.head 5 -  Number: nKvB
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRatO
.head 5 -  Number: nRatB
.head 5 -  Number: nRatS
.head 5 -  Number: nSumEqv
.head 4 +  Actions
.head 5 +  If nKvA = nKvB
.head 6 -  Return nSum
.head 5 +  Else
.head 6 +  If SqlPLSQLCommand( hSqlAux(),"gl.x_rat(nRatO,nRatB,nRatS,nKvA,nKvB,dDat)")
.head 7 -  Set nSumEqv = nSum * nRatO
.head 7 -  Return nSumEqv
.head 6 +  Else
.head 7 -  Return NUMBER_Null
.head 3 +  Function: f_check_user_access
.head 4 -  Description: перевірка доступу користувача до виконання операцій з VIP депозитами ЮО
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  When SqlError
.head 6 -  ! якщо немає v_dpu_vip_manager
.head 6 -  Return FALSE
.head 5 +  If SqlPrepareAndExecute ( hSql(), "SELECT 1 INTO :nTmp FROM v_dpu_vip_manager WHERE id = USER_ID")
   AND SqlFetchNext ( hSql(), nFetchRes )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: F_HIDE_SHOW
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sName
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If ( sName = 'HideDefault' )
.head 6 -  Call SalDisableWindow(pb0)
.head 6 -  Call SalDisableWindow(pb1)
.head 6 -  Call SalDisableWindow(pb_Repayment)
.head 6 -  Call SalDisableWindow(pb3)
.head 6 -  Call SalDisableWindow(pb4)
.head 6 -  Call SalHideWindow(pb5)
.head 6 -  Call SalHideWindow(pb6)
.head 6 -  Call SalHideWindow(pb7)
.head 6 -  Call SalShowWindow(pbOK)
.head 6 -  Call SalShowWindow(dfAMOUNT)
.head 6 -  Call SalShowWindow( rb0 )
.head 6 -  Call SalShowWindow( rb1 )
.head 6 -  Call SalShowWindow( rb2 )
.head 5 +  Else If ( sName = 'ShowDefault' )
.head 6 -  Call SalHideWindow( pbOK )
.head 6 -  Call SalHideWindow( dfAMOUNT )
.head 6 -  Call SalHideWindow( rb0 )
.head 6 -  Call SalHideWindow( rb1 )
.head 6 -  Call SalHideWindow( rb2 )
.head 6 -  Call SalShowWindow( pb5 )
.head 6 -  Call SalShowWindow( pb6 )
.head 6 -  Call SalShowWindow( pb7 )
.head 3 +  Function: F_PRINT_REPORT
.head 4 -  Description: Друк виписки по дод.угоді ген.договору депозитної лінії
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sFileName
.head 5 -  Number: nFMT
.head 5 -  Number: nKODZ
.head 4 +  Actions
.head 5 -  Call SalMessageBox( "Обраний функціонал ще знаходиться на етапі розробки!", 
                                             CurrentLangTable.GetAtomTitle('cTAt'), 
                                             MB_IconExclamation )
.head 5 -  Return FALSE
.head 5 -  !
.head 5 -  Set sFileName = GetPrnDir() || '\\' || SalStrTrimX( Str(DPU_ID) ) || '.TXT'
.head 5 -  Set nFMT = 3
.head 5 -  Set nKODZ = 375
.head 5 -  Call ExportCatQuery( nKODZ, sFileName, nFMT, ":DPT_ID='" || SalStrTrimX( Str(DPU_ID) ) || "',"||
                    ":sFdat1='" || SalFmtFormatDateTime(  DATN, 'dd/MM/yyyy')|| "',"||
                    ":sFdat2='" || SalFmtFormatDateTime( dDATA, 'dd/MM/yyyy')|| "'", TRUE )
.head 5 +  If sFileName != STRING_Null
.head 6 -  Call DosDirectPrint( sFileName )
.head 3 +  Function: F_ACCRUAL_INTEREST
.head 4 -  Description: Нарахування відсотків по депозитному рахунку
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dBDATE
.head 4 +  Actions
.head 5 -  Set dBDATE = (frm_Dog.dDATA -1)
.head 5 +  If SqlPLSQLCommand( hSql(), "dpu.auto_make_interest( frm_Dog.DPU_ID, dBDATE )" )
.head 6 -  Call SqlCommit( hSql() )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Call SqlRollback( hSql() )
.head 6 -  Return FALSE
.head 3 +  Function: F_UNLOCK_DEPOSIT_ACCOUNT
.head 4 -  Description: Зняття блокування на дебет рах. відкритого пов’язаній особі
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nACC
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call SaveInfoToLog( "UNLOCK_DEPOSIT_ACCOUNT(ACC = " || Str(nACC) || ")" )
.head 5 +  When SqlError
.head 6 -  Call SalMessageBox( "Неможливо зняти влокування з рахунка відкритого пов`язаній особі!", 
                    CurrentLangTable.GetAtomTitle( 'cTErr' ), 
                    MB_IconStop )
.head 6 -  Return FALSE
.head 5 +  If SqlPrepareAndExecute( hSql(), "update BARS.ACCOUNTS set BLKD = 0 where ACC = :nACC and BLKD = 12" )
.head 6 -  Call SqlCommit( hSql() )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Call SaveErrorToLog( "UNLOCK_DEPOSIT_ACCOUNT(ACC = " || Str(nACC) || ")" )
.head 3 +  Function: F_USE_VPS
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sBankCode
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nQty
.head 4 +  Actions
.head 5 +  If ( sDptBankType = 'SBER' )
.head 6 +  If SqlPrepareAndExecute( hSql(),
"select count(1)
   into :nQty
   from BARS.BANKS$BASE
  where MFOU = '300465'
    and MFO = '" || sBankCode || "'
    and BLK  = 0" )
And SqlFetchNext( hSql(), nFetchRes )
And nQty > 0
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  ! nMode = 1 - инспектор, nMode = 2 - бухгалтер, nMode = 3 - тільки перегляд
.head 3 -  Number: nMode
.head 3 -  Number: DPU_ID
.head 3 -  String: ND
.head 3 -  Number: DPU_GEN
.head 3 -  Number: DPU_ADD
.head 3 -  String: NMK
.head 3 -  Number: KV
.head 3 -  String: LCV
.head 3 -  String: FREQ
.head 3 -  Number: VIDD
.head 3 -  String: VIDDNAME
.head 3 -  Number: SUM
.head 3 -  Number: ID_STOP
.head 3 -  Number: MIN_SUM
.head 3 -  Date/Time: DATZ
.head 3 -  Date/Time: DATN
.head 3 -  Date/Time: DATO
.head 3 -  Date/Time: DATV
.head 3 -  String: MFOD
.head 3 -  String: ACCD
.head 3 -  String: NMSD
.head 2 +  Window Variables
.head 3 -  Date/Time: dDATA   !!! Банківська дата
.head 3 -  Date/Time: STP_DAT !!! Стоп дата нарахування відсотків
.head 3 -  Number: nFetchRes
.head 3 -  Number: nTmp
.head 3 -  String: sTT
.head 3 -  String: sNDGEN
.head 3 -  String: sNAZN
.head 3 -  String: sNAZN0
.head 3 -  String: sdat
.head 3 -  Number: nDig
.head 3 -  Number: nRef
.head 3 -  Long String: sErrMsg
.head 3 -  : cDoc
.head 4 -  Class: cDocDpu
.head 3 -  ! Параметры выплаты %%
.head 3 -  String: sMfoP
.head 3 -  String: sNlsP
.head 3 -  String: sNmsP
.head 3 -  ! Штраф
.head 3 -  Number: nPenyaDone
.head 3 -  String: sTmpND
.head 3 -  ! nPartPayOpt -> Вид часткового повернення коштів з договору
.head 3 -  Number: nPartPayOpt
.head 3 -  String: sND
.head 3 -  String: sDATZ
.head 3 -  !
.head 3 -  Number: CLOSED
.head 3 -  Number: ACC
.head 3 -  Number: ACCN
.head 3 -  Number: ACC7
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Dog.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set dDATA = GetBankDate()
.head 4 -  ! Call BankType_Init()
.head 4 -  ! Заголовок окна и заготовка для назначения платежа
.head 4 +  If DPU_ADD > 0
.head 5 -  Call SalEnableWindow( pb_PrintReport )
.head 5 +  If SqlPrepareAndExecute(hSql(), 
    "SELECT trim(nd), to_char(datz,'dd/MM/yyyy') 
       INTO :sND, :sDATZ
       FROM dpu_deal 
      WHERE dpu_id = :frm_Dog.DPU_GEN") 
AND SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! № ... от ...
.head 6 -  Set sNDGEN = '№'||sND||' '||CurrentLangTable.GetAtomTitle('AcrPay.cTNaznVid')||' '||sDATZ
.head 6 -  ! Доп.соглашение № ... к договору ...
.head 6 -  Set sTITLE = CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle2')||Str(DPU_ADD)||' '||
             CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle2_')||' '||sNDGEN
.head 6 -  ! доп.угоди № ... до деп.договору ...
.head 6 -  Set sNAZN0 = CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0_21')||Str(DPU_ADD)||' '||
             CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0_22')||' '||sNDGEN
.head 6 -  ! Текущее состояние доп.соглашения № ... к договору ...
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Dog.cTWndTitle2')||' '||Str(DPU_ADD)||' '||
                                CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle2_')  ||' '||sNDGEN)
.head 4 +  Else
.head 5 -  Call SalDisableWindow( pb_PrintReport )
.head 5 -  ! Депозитный договор № ...
.head 5 -  Set sTITLE = CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle1')||ND
.head 5 -  ! деп.договору № ... від ...
.head 5 -  Set sNAZN0 = CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0_11')||ND ||' '|| 
             CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0_12')||' '||SalFmtFormatDateTime(DATZ, 'dd/MM/yyyy')
.head 5 -  ! Текущее состояние депозитного договора ...
.head 5 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Dog.cTWndTitle1')||' '||ND)
.head 4 -  !
.head 4 +  ! If DPU_ID = DPU_GEN
.head 5 -  ! Депозитный договор № ...
.head 5 -  Set sTITLE = CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle1')||ND
.head 5 -  ! деп.договору № ... від ...
.head 5 -  Set sNAZN0 = CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0_11')||ND||' '||
    CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0_12')||' '||SalFmtFormatDateTime( DATZ, 'dd/MM/yyyy' )
.head 5 -  ! Текущее состояние депозитного договора ...
.head 5 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Dog.cTWndTitle1')||' '||ND)
.head 4 +  ! Else
.head 5 -  Call SqlPrepareAndExecute(hSql(), 
  "SELECT trim(nd), to_char(datz,'dd/MM/yyyy') 
     INTO :sND, :sDATZ
     FROM dpu_deal 
    WHERE dpu_add IS NOT NULL 
      AND dpu_id = :frm_Dog.DPU_GEN") 
.head 5 +  If SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Доп.соглашение № ... к договору ...
.head 6 -  Set sNDGEN = '№'||sND||' '||CurrentLangTable.GetAtomTitle('AcrPay.cTNaznVid')||' '||sDATZ
.head 6 -  Set sTITLE = CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle2')||ND
          ||' '
          ||CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle2_')||' '||sNDGEN
.head 6 -  ! доп.угоди № ... до деп.договору ...
.head 6 -  Set sNAZN0 = CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0_21')||ND||' '||
    CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0_22')||' '||sNDGEN
.head 6 -  ! Текущее состояние доп.соглашения № ... к договору ...
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Dog.cTWndTitle2')||' '||ND||' '||
     CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle2_')||' '||sNDGEN)
.head 5 +  Else 
.head 6 -  Set sTITLE = CurrentLangTable.GetAtomTitle('frm_Dog.cTTitle1')||ND
.head 6 -  Set sNAZN0 = CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0_11')||ND||' '||
             CurrentLangTable.GetAtomTitle('frm_Dog.cTNazn0_12')||' '||SalFmtFormatDateTime( DATZ, 'dd/MM/yyyy' )
.head 6 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Dog.cTWndTitle1')||' '||ND)
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT dig INTO :nDig FROM tabval WHERE kv = :frm_Dog.KV")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  Call F_POPULATE()
.head 1 +  Form Window: frm_OpenM
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Карточка депозитного договора
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   3.55"
.head 4 -  Top:    2.458"
.head 4 -  Width:  10.983"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.56"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.5"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If nReadWrite = 1
.head 8 -  ! "Сохранение"
.head 8 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipUpdate1')
.head 7 +  Else
.head 8 -  ! "Сохранить изменения"
.head 8 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipUpdate2')
.head 6 +  On SAM_Click
.head 7 +  If SalNumberAbs(nReadWrite) = 1
.head 8 +  If F_CHECK_ADD_NUMBER() !! проверка на уникальность № доп.соглашения
.head 9 -  Set dfDPU_ID = F_SAVE(NUMBER_Null)
.head 9 +  If dfDPU_ID > 0
.head 10 -  ! !
.head 10 +  If nReadWrite = -1
.head 11 -  Set sTmp = CurrentLangTable.GetAtomTitle('frm_OpenM.cTProlDopSogl')||frm_OpenM.dfND||" (#"||Str(frm_OpenM.dfDPU_ID)||")"
.head 10 +  Else
.head 11 -  Set sTmp = IifS(sTypeDeal = "ADD", 
    CurrentLangTable.GetAtomTitle('frm_OpenM.cTOpenDopSogl')||frm_OpenM.dfND||" (#"||Str(frm_OpenM.dfDPU_ID)||")",
    CurrentLangTable.GetAtomTitle('frm_OpenM.cTOpenDepDog') ||frm_OpenM.dfND||" (#"||Str(frm_OpenM.dfDPU_ID)||")")
.head 10 -  ! !
.head 10 -  Call SqlCommitEx(hSql(),sTmp)
.head 10 -  Call MessageNoWait(sTmp, "Сообщение", 3, 0)
.head 10 -  Call SalEnableWindow(  pbPrint    )
.head 10 -  Call SalEnableWindow(  pbPasport  )
.head 10 -  Call SalEnableWindow(  pbAccounts )
.head 10 -  Call SalEnableWindow(  pbSos      )
.head 10 -  Call SalDisableWindow( pbClient   )
.head 10 -  Call SalDisableWindow( pbDubl     )
.head 10 -  Set nReadWrite = 0
.head 10 -  Call F_POPULATE()
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 10 +  If nReadWrite = -1
.head 11 -  Set sTmp = CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrProlDopSogl')||frm_OpenM.dfND||" (#"||Str(frm_OpenM.dfDPU_ID)||")"
.head 10 +  Else
.head 11 -  Set sTmp = IifS(sTypeDeal = "ADD", 
    CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrOpenDopSogl')||frm_OpenM.dfND||" (#"||Str(frm_OpenM.dfDPU_ID)||")",
    CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrOpenDepDog') ||frm_OpenM.dfND||" (#"||Str(frm_OpenM.dfDPU_ID)||")")
.head 10 -  Call MessageNoWait(sTmp||" "||sErr, CurrentLangTable.GetAtomTitle('cTAt'), 0, 1)
.head 7 +  Else
.head 8 -  ! Call F_UPDATE()
.head 8 +  If f_updealparams()
.head 9 -  Call F_POPULATE()
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Очистка'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipRefresh')
.head 6 +  On SAM_Click
.head 7 +  If nReadWrite = 1 AND dfDPU_ID <= 0
.head 8 -  Call F_START()
.head 7 +  Else
.head 8 -  Call F_POPULATE()
.head 4 +  Pushbutton: pbPasport
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Custcorp.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Паспорт клиента'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipPasport')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(dfRNK)
.head 8 -  Call EditCustCorps(frm_OpenM.dfRNK,
                   CVIEW_ReadOnly
                  |CVIEW_Accounts,
                   hWndMDI)
.head 4 +  Pushbutton: pbAccounts
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSort
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Счета по договору"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipAccounts')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(dfDPU_ID)
.head 8 -  Call ShowAccList(dfRNK, AVIEW_CUST,
                 AVIEW_Financial
                |AVIEW_Linked
                |AVIEW_Limit
                |AVIEW_Special
                |AVIEW_Blocked
                |AVIEW_Interest
                |AVIEW_NoClose,
" a.acc in (SELECT accid FROM dpu_accounts WHERE dpuid = "||Str(dfDPU_ID)||")")
.head 8 -  Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 4 +  Pushbutton: pbSos
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.817"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Docview.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Текущее состояние договора'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipSos')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(dfDPU_ID)
.head 8 +  If not IsWindow(hWin6)   
.head 9 -  Set hWin6 = SalCreateWindow(frm_Dog, hWndMDI, pMODE,
frm_OpenM.dfDPU_ID,    frm_OpenM.dfND,     
frm_OpenM.pDPU_GEN,    frm_OpenM.nADD,
frm_OpenM.dfNMK,       frm_OpenM.dfKV,     frm_OpenM.dfKVNAME,
frm_OpenM.cmbFREQV,    frm_OpenM.dfVIDD,   frm_OpenM.dfVIDD_NAME,  
frm_OpenM.dfSUM,       frm_OpenM.dfSTOPID, frm_OpenM.dfMIN_SUM, 
frm_OpenM.dfDATZ,      frm_OpenM.dfDATN,      
frm_OpenM.dfDATO,      frm_OpenM.dfDATV,
Str(frm_OpenM.dfMFOD), frm_OpenM.dfNLSD,   frm_OpenM.dfNMSD)
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop(frm_Dog)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Печать договора'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipPrint')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(dfDPU_ID)
.head 8 -  Call cdoc_ShowAllDocs(dfDPU_ID, hWndForm)
.head 4 +  Pushbutton: pbChilds
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.26"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Childs.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Открытие доп.соглашения"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipChilds')
.head 6 +  On SAM_Click
.head 7 -  ! 'Открыть доп.соглашение по данному договору?'
.head 7 +  If SalMessageBox(
   CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessOpenDepSoglQuestion'), 
   CurrentLangTable.GetAtomTitle('cTAt'), 
   MB_IconQuestion|MB_YesNo ) = IDYES
.head 8 -  Set hWin44 = SalCreateWindow(frm_OpenM, hWndMDI, hWndForm, 
                             pMODE, pVIDD, 0, 1, pISP, pGRP, dfDPU_ID)
.head 4 +  Pushbutton: pbDubl
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbEdit
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.133"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: D:\BARS98\RESOURCE\BMP\prolong.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Пролонгація додаткової угоди"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipDubl')
.head 6 +  On SAM_Click
.head 7 -  ! 'Виконати пролонгацію поточної угоди?'
.head 7 +  If SalMessageBox(
   CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessProlongDepDealQuestion'), 
   CurrentLangTable.GetAtomTitle('cTAt'), 
   MB_IconQuestion|MB_YesNo ) = IDYES
.head 8 -  Call F_PROLONG()
.head 4 -  Line
.head 5 -  Resource Id: 57415
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.633"
.head 6 -  Begin Y:  0.071"
.head 6 -  End X:  3.633"
.head 6 -  End Y:  0.381"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.75"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Выход'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipCancel')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000500
0020: 5461623100005461 62426F74746F6D4D 617267696E000200 3000005461625061
0040: 6765436F756E7400 0200310000546162 4C6162656C73003B 00CEF1EDEEE2EDFB
0060: E520EFE0F0E0ECE5 F2F0FB09CFEEE4F0 EEE1EDEEF1F2E809 C4EEEF2EE8EDF42D
0080: F6E8FF0953574946 542DF0E5EAE2E8E7 E8F2FB0000546162 4E616D6573001400
00A0: 5461623109546162 3209546162330954 6162340000546162 52696768744D6172
00C0: 67696E0002003000 0054616244726177 5374796C65000B00 57696E3935537479
00E0: 6C65000054616246 6F726D5061676573 0004000909090000 546162546F704D61
0100: 7267696E00020030 00005461624F7269 656E746174696F6E 0001000000000000
0120: 0000000000000000 0000000000000000 000000
.enddata
.data CLASSPROPSSIZE
0000: 3301
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    2.0"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Yes
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 6 -  ! Основные параметры
.head 6 -  Call picTabs.SetLabel(0, ' ' || CurrentLangTable.GetAtomTitle('frm_OpenM.cTabs0') || ' ', TRUE)
.head 6 -  ! Подробности
.head 6 -  Call picTabs.SetLabel(1, ' ' || CurrentLangTable.GetAtomTitle('frm_OpenM.cTabs1') || ' ', TRUE)
.head 6 -  ! Доп.инф-ция
.head 6 -  Call picTabs.SetLabel(2, ' ' || CurrentLangTable.GetAtomTitle('frm_OpenM.cTabs2') || ' ', TRUE)
.head 6 -  ! SWIFT-реквизиты
.head 6 -  Call picTabs.SetLabel(3, ' ' || CurrentLangTable.GetAtomTitle('frm_OpenM.cTabs3') || ' ', TRUE)
.head 6 -  Call ManageSwTagsButton()
.head 5 +  On __TABSM_TabActivate
.head 6 -  Call SalSendClassMessage(__TABSM_TabActivate, 0, 0)
.head 6 -  Call F_HIDE_SHOW()
.head 3 -  ! Закладка "Основные параметры"
.head 3 +  Data Field: dfTITLE
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.5"
.head 6 -  Width:  8.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Times New Roman
.head 5 -  Font Size: 18
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDPU_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Клиент
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 35365
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.78"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgClient
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbClient
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Поиск
.head 4 -  Window Location and Size
.head 5 -  Left:   8.65"
.head 5 -  Top:    0.964"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.429"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Поиск клиента'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipClient'))
.head 5 +  On SAM_Click
.head 6 -  Set sTmp = STRING_Null
.head 6 -  Call FunNSIGetFiltered(
     "CUSTOMER", 
     "NMK",
     " date_off IS NULL AND 
      (custtype = 2 
       OR 
      (custtype=3 AND nvl(substr(sed,1,2),'00') IN ('91','34')))", 
      sTmp, 
      dfNMK)
.head 6 +  If sTmp != STRING_Null
.head 7 -  Set dfRNK = NUMBER_Null
.head 7 -  Set dfOKPO = STRING_Null
.head 7 +  If SqlPrepareAndExecute(hSql(),
  "SELECT rnk, nmk, okpo 
     INTO :dfRNK,:dfNMK,:dfOKPO
     FROM customer   
    WHERE  to_char(rnk) = "||sTmp)
and SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If SalIsWindowEnabled (dfNLSP) OR cbCOMPROC
.head 9 -  Set dfNMSP = Subs(dfNMK,1,38)
.head 8 +  If SalIsWindowEnabled (dfNLSD)
.head 9 -  Set dfNMSD = Subs(dfNMK,1,38)
.head 7 -  Call GenDealAccNums (dfRNK, dfND, dfBRANCH, sBsd, sBsn, dfNLSDEP, dfNLSDEN)
.head 7 -  ! Комбинированный вклад
.head 7 +  If sDpuCode = 'COMB'
.head 8 -  Call GenCombAccNums (dfRNK, dfVIDD, dfND, dfBRANCH, dfNLSDEP2, dfNLSDEN2)
.head 3 -  Background Text: Регистр.№:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21103
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.167"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRNK
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    1.143"
.head 6 -  Width:  1.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Код ЕГРПОУ:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21104
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.6"
.head 5 -  Top:    1.167"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOKPO
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.7"
.head 6 -  Top:    1.143"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Наименование:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21105
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.44"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNMK
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    1.417"
.head 6 -  Width:  7.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21128
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.85"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Вид договора:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21099
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.964"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    4.274"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfVIDD_NAME
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    1.94"
.head 6 -  Width:  6.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Подразделение:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21125
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    2.214"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbBRANCH
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.0"
.head 5 -  Top:    2.19"
.head 5 -  Width:  6.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.583"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbBRANCH.Init(hWndItem)
.head 7 -  Call cmbBRANCH.Populate(hSql(), 
     "branch", "branch||' '||name", "branch", 
     " WHERE branch like '/'||sys_context('bars_context','user_mfo')||'%'
       ORDER BY branch")
.head 7 -  Call cmbBRANCH.SetSelectById(dfBRANCH)
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfBRANCH = cmbBRANCH.strCurrentId
.head 6 -  Call GenDealAccNums (dfRNK, dfND, dfBRANCH, sBsd, sBsn, dfNLSDEP, dfNLSDEN)
.head 6 -  ! Комбинированный вклад
.head 6 +  If sDpuCode = 'COMB'
.head 7 -  Call GenCombAccNums (dfRNK, dfVIDD, dfND, dfBRANCH, dfNLSDEP2, dfNLSDEN2)
.head 3 -  Background Text: №:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 55182
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    2.476"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfND
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 35
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    2.44"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If nGEN != NUMBER_Null AND 
   dfDPU_ID = 0        AND 
   NOT SalStrToNumber(dfND)
.head 7 -  ! 'Номер доп.соглашения НЕ должен содержать символы!'
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrNomDopSogl'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Call GenDealAccNums (dfRNK, dfND, dfBRANCH, sBsd, sBsn, dfNLSDEP, dfNLSDEN)
.head 7 -  ! Комбинированный вклад
.head 7 +  If sDpuCode = 'COMB'
.head 8 -  Call GenCombAccNums (dfRNK, dfVIDD, dfND, dfBRANCH, dfNLSDEP2, dfNLSDEN2)
.head 7 -  Return VALIDATE_Ok
.head 3 -  Background Text: Проц.ставка:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21127
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.417"
.head 5 -  Top:    2.714"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgIR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfIR
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.15"
.head 6 -  Top:    2.69"
.head 6 -  Width:  1.033"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: %%
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 48052
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.233"
.head 5 -  Top:    2.714"
.head 5 -  Width:  0.483"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBRDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBRDAT
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.8"
.head 6 -  Top:    2.69"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Сумма:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21100
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    2.714"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSUM
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.0"
.head 6 -  Top:    2.69"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfIR = F_CALC_RATE (dfVIDD, dfDATN, dfDATO, dfSUM)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Валюта:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 48051
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.417"
.head 5 -  Top:    2.476"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfKVNAME
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.15"
.head 6 -  Top:    2.44"
.head 6 -  Width:  2.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! Дати
.head 3 -  Group Box: Дати
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 6472
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:   0.317"
.head 5 -  Top:    4.036"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Dark Gray
.head 4 -  Background Color: Class Default
.head 3 -  Background Text: Заключения:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21108
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    4.262"
.head 5 -  Width:  1.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATZ
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    4.238"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Початку дії:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21109
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    4.512"
.head 5 -  Width:  1.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATN
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.3"
.head 6 -  Top:    4.488"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfDATN != DATETIME_Null AND 
 ((dfDATZ != DATETIME_Null AND dfDATN < dfDATZ) 
   OR
  (dfDATO != DATETIME_Null AND dfDATN > dfDATO)
   OR
  (dfDATV != DATETIME_Null AND dfDATN > dfDATV))
.head 7 -  ! 'Некорректно указана дата!'
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrDat'),
     CurrentLangTable.GetAtomTitle('cTAt'),MB_IconHand)
.head 7 -  Set dfDATN = DATETIME_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else If NOT F_CHECK_DATES() 
.head 7 -  Set dfDATN = DATETIME_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else If dfDATN = DATETIME_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 +  If SalIsNull(dfDATO)
.head 8 -  Set dfDATO = F_CALC_DATES(dfDATN, nSrok)
.head 7 +  If SalIsNull(dfDATV) 
.head 8 -  Set dfDATV = CorrectDate(dfKV, dfDATO, dfDATO +1)
.head 7 -  Call SalSendMsg(cmbFREQV, SAM_User, 0, 0)
.head 7 -  Set dfIR = F_CALC_RATE (dfVIDD, dfDATN, dfDATO, dfSUM)
.head 7 -  Return VALIDATE_Ok
.head 3 -  Background Text: Завершения:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21110
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.867"
.head 5 -  Top:    4.262"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATO
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.95"
.head 6 -  Top:    4.238"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfDATO != DATETIME_Null AND  
( (dfDATN != DATETIME_Null AND dfDATO < dfDATN)
   OR
  (dfDATZ != DATETIME_Null AND dfDATO < dfDATZ)
   )
.head 7 -  ! 'Некорректно указана дата!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrDat'),
     CurrentLangTable.GetAtomTitle('cTAt'),MB_IconHand)
.head 7 -  Set dfDATO = DATETIME_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else If NOT F_CHECK_DATES() 
.head 7 -  Set dfDATO = DATETIME_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else If dfDATO = DATETIME_Null
.head 7 -  Set dfDATO = DATETIME_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else
.head 7 +  If SalIsNull(dfDATV) 
.head 8 -  Set dfDATV = CorrectDate(dfKV, dfDATO, dfDATO +1)
.head 7 -  Call SalSendMsg(cmbFREQV, SAM_User, 0, 0)
.head 7 -  Set dfIR = F_CALC_RATE (dfVIDD, dfDATN, dfDATO, dfSUM)
.head 7 -  Set dfKTDAY=F_CALC_KTDAYS(dfDATN, dfDATO)
.head 7 -  Return VALIDATE_Ok
.head 3 -  Background Text: Повернення:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21111
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.867"
.head 5 -  Top:    4.512"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATV
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.95"
.head 6 -  Top:    4.488"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull(dfDATV)
.head 7 -  Return VALIDATE_Ok
.head 6 +  Else If dfDATV != DATETIME_Null AND 
(dfDATV < dfDATO OR 
 dfDATV < dfDATZ OR 
 dfDATV < dfDATN)
.head 7 -  ! 'Некорректно задана дата!'
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrDat'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 7 -  Set dfDATV = DATETIME_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 -  Background Text: к-ть днів:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28861
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.883"
.head 5 -  Top:    4.4"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKTDAY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKTDAY
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.233"
.head 6 -  Top:    4.381"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! Рахунки договору
.head 3 -  Group Box: Рахунки договору
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28860
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    3.06"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.929"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Dark Gray
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: bgDepAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Депозитный счет:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21096
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    3.357"
.head 5 -  Width:  2.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Teal
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLSDEP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLSDEP
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.75"
.head 6 -  Top:    3.345"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Процентный счет:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21122
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    3.595"
.head 5 -  Width:  2.367"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Teal
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLSDEN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLSDEN
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.75"
.head 6 -  Top:    3.595"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Депозитныйсчет(генер.):
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21131
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.833"
.head 5 -  Top:    3.345"
.head 5 -  Width:  3.417"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLSDEP2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLSDEP2
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.25"
.head 6 -  Top:    3.345"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Депозитний рах (генер.):
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21133
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.833"
.head 5 -  Top:    3.595"
.head 5 -  Width:  3.417"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Jade
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLSDEN2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLSDEN2
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.25"
.head 6 -  Top:    3.595"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! Закладка "Подробности"
.head 3 -  Background Text: Прием / Возврат депозита
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 35368
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.48"
.head 5 -  Width:  3.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDetailsDep
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Банк:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21124
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.81"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMFOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFOD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.9"
.head 6 -  Top:    0.786"
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfMFOD = NUMBER_Null OR  NOT SalIsValidNumber( dfMFOD )
.head 7 -  Set dfMFOP = NUMBER_Null
.head 7 -  Set dfNBD = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If NOT SqlPrepareAndExecute( hSql(),
   "SELECT nb INTO :dfNBD FROM banks WHERE mfo=" || Str(dfMFOD))
OR NOT SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Set dfNLSD = STRING_Null
.head 7 -  Set dfMFOD = NUMBER_Null
.head 7 -  Set dfNBD =  STRING_Null
.head 7 -  ! 'Не нашли банка с МФО 
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrMfo') || ' '||Str(dfMFOD), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set dfNLSD = ''
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNBD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.95"
.head 6 -  Top:    0.786"
.head 6 -  Width:  5.583"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Счет:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21123
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.06"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLSD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.9"
.head 6 -  Top:    1.036"
.head 6 -  Width:  1.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfNLSD != ''
.head 7 +  If Vkrz2(Str(dfMFOD),dfNLSD) != dfNLSD
.head 8 -  ! 'Ошибка в контрольном разряде счета!'
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAcc'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 8 -  Set dfNLSD = ''
.head 7 +  Else
.head 8 +  If dfMFOD = Val(GetBankMfo())
.head 9 +  If SqlPrepareAndExecute( hSql(),
   "SELECT ca.rnk, substr(a.nms,1,38) 
      INTO :nTmp, :dfNMSD  
      FROM accounts a, cust_acc ca
     WHERE a.kv=:dfKV    AND a.nls=:dfNLSD AND  
           ca.acc=a.acc AND a.dazs is null" )
and not SqlFetchNext( hSql(), nFetchRes)
.head 10 -  ! 'Счет не открыт!'
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAccNotOpen'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 10 -  Set dfNLSD = ''
.head 9 +  Else
.head 10 -  ! 'Счет открыт на другого клиента! Продолжить?'
.head 10 +  If dfRNK != nTmp AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessAccRnk'),
              CurrentLangTable.GetAtomTitle('cTAt'),
              MB_IconQuestion|MB_YesNo) = IDNO
.head 11 -  Set dfNLSD = ''
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNMSD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.85"
.head 6 -  Top:    1.036"
.head 6 -  Width:  4.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Pushbutton: pbCustAcc
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Спр-к счетов
.head 4 -  Window Location and Size
.head 5 -  Left:   8.7"
.head 5 -  Top:    0.786"
.head 5 -  Width:  1.267"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.488"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Текущие счета клиента'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipCustAcc'))
.head 5 +  On SAM_Click
.head 6 +  If dfRNK != NUMBER_Null AND dfKV != NUMBER_Null 
.head 7 -  ! 'Выбрать из справочника текущий счет клиента?'
.head 7 +  If SalMessageBox(
   CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessGetAcc'), 
   CurrentLangTable.GetAtomTitle('cTAt'), 
   MB_IconQuestion|MB_YesNo) = IDYES
.head 8 -  Set sCorpAccId = STRING_Null
.head 8 -  Call FunNSIGetFiltered(
     "corps_acc", 
     "id",
     " to_char(rnk) = "||Str(dfRNK)||
     " AND to_char(kv) = "||Str(dfKV), 
      sTmp, 
      sCorpAccId)
.head 8 +  If sCorpAccId != STRING_Null AND SqlPrepareAndExecute(hSql(),
  "SELECT ca.mfo, ca.nls, b.nb 
     INTO :nMfoR,:sNlsR,:sNbR 
     FROM corps_acc ca, banks b  
    WHERE ca.mfo = b.mfo AND to_char(ca.id) = "||sCorpAccId)
AND SqlFetchNext(hSql(), nFetchRes)
.head 9 -  ! 'Занести выбранное значение в параметры для возврата депозита?'
.head 9 +  If SalMessageBox(
   CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessSetDep'), 
   CurrentLangTable.GetAtomTitle('cTAt'), 
   MB_IconQuestion|MB_YesNo) = IDYES
.head 10 -  Set dfMFOD = nMfoR
.head 10 -  Set dfNLSD = sNlsR
.head 10 -  Set dfNMSD = Subs(dfNMK,1,38)
.head 10 -  Set dfNBD = sNbR
.head 10 -  ! SWIFT-реквизиты
.head 10 +  If SqlPrepareAndExecute(hSql(), 
     "SELECT sw56_name, sw56_adr, sw56_code,   
             sw57_name, sw57_adr, sw57_code, sw57_acc,   
             sw59_name, sw59_adr, sw59_acc
        INTO :frm_OpenM.dfSW56_Name, 
             :frm_OpenM.dfSW56_Adr, 
             :frm_OpenM.dfSW56_Code,
             :frm_OpenM.dfSW57_Name, 
             :frm_OpenM.dfSW57_Adr, 
             :frm_OpenM.dfSW57_Code, 
             :frm_OpenM.dfSW57_Acc,
             :frm_OpenM.dfSW59_Name, 
             :frm_OpenM.dfSW59_Adr,
             :frm_OpenM.dfSW59_Acc
        FROM corps_acc 
       WHERE id = :sCorpAccId")
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 11 -  Set dfSW56_Name = STRING_Null
.head 11 -  Set dfSW56_Adr  = STRING_Null
.head 11 -  Set dfSW56_Code = STRING_Null
.head 11 -  Set dfSW57_Name = STRING_Null
.head 11 -  Set dfSW57_Adr  = STRING_Null
.head 11 -  Set dfSW57_Code = STRING_Null
.head 11 -  Set dfSW57_Acc  = STRING_Null
.head 11 -  Set dfSW59_Name = STRING_Null
.head 11 -  Set dfSW59_Adr  = STRING_Null
.head 11 -  Set dfSW59_Acc  = STRING_Null
.head 9 +  If sTypeDeal != 'GEN' AND NOT cbCOMPROC
.head 10 -  ! 'Занести выбранное значение в параметры для выплаты %%?'
.head 10 +  If SalMessageBox(
   CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessSetDen'), 
   CurrentLangTable.GetAtomTitle('cTAt'), 
   MB_IconQuestion|MB_YesNo) = IDYES
.head 11 -  Set dfMFOP = nMfoR
.head 11 -  Set dfNLSP = sNlsR
.head 11 -  Set dfNMSP = Subs(dfNMK,1,38)
.head 11 -  Set dfNBP = sNbR
.head 6 +  Else
.head 7 -  ! IifS(dfRNK = NUMBER_Null, 'Не указан клиент!', 'Не указана валюта!')
.head 7 -  Call SalMessageBox
(IifS(dfRNK = NUMBER_Null, 
CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessNotClient'), 
CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessNotKv')), 
CurrentLangTable.GetAtomTitle('cTAt'), 
 MB_IconExclamation)
.head 3 -  !
.head 3 -  Background Text: Выплата процентов
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 35369
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.48"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgProc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Банк:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21129
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.75"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMFOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFOP
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.9"
.head 6 -  Top:    1.726"
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfMFOP = NUMBER_Null OR NOT SalIsValidNumber( dfMFOP )
.head 7 -  Set dfMFOP = NUMBER_Null
.head 7 -  Set dfNBP = STRING_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If NOT SqlPrepareAndExecute( hSql(),
   "SELECT nb INTO :dfNBP FROM banks WHERE mfo=" || Str(dfMFOP))
OR NOT SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Set dfNLSP = STRING_Null
.head 7 -  Set dfMFOP = NUMBER_Null
.head 7 -  Set dfNBP = STRING_Null
.head 7 -  ! 'Не нашли банка с МФО 
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrMfo') || ' '||Str(dfMFOP), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set dfNLSP = ''
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNBP
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.95"
.head 6 -  Top:    1.738"
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Счет:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21115
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    2.024"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLSP
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.9"
.head 6 -  Top:    2.012"
.head 6 -  Width:  1.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfNLSP != ''
.head 7 +  If Vkrz2(Str(dfMFOP),dfNLSP) != dfNLSP
.head 8 -  ! 'Ошибка в контрольном разряде счета!'
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAcc'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 8 -  Set dfNLSP = ''
.head 7 +  Else
.head 8 +  If dfMFOP = Val(GetBankMfo())
.head 9 +  If SqlPrepareAndExecute( hSql(),
   "SELECT ca.rnk, substr(a.nms,1,38) 
      INTO :nTmp, :dfNMSP  
      FROM accounts a, cust_acc ca
     WHERE a.kv=:dfKV    AND a.nls=:dfNLSP AND  
           ca.acc=a.acc AND a.dazs is null" )
and not SqlFetchNext( hSql(), nFetchRes)
.head 10 -  ! 'Счет не открыт!'
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAccNotOpen'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 10 -  Set dfNLSP = ''
.head 9 +  Else
.head 10 -  ! 'Счет открыт на другого клиента! Продолжить?'
.head 10 +  If dfRNK != nTmp AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessAccRnk'),
              CurrentLangTable.GetAtomTitle('cTAt'),
              MB_IconQuestion|MB_YesNo) = IDNO
.head 11 -  Set dfNLSP = ''
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNMSP
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.85"
.head 6 -  Top:    2.0"
.head 6 -  Width:  5.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Background Text: Период-ть выплаты %%:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21113
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    2.512"
.head 5 -  Width:  3.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFREQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFREQV
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.617"
.head 6 -  Top:    0.798"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbFREQV
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.85"
.head 5 -  Top:    2.512"
.head 5 -  Width:  4.683"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_User
.head 6 +  If (dfDATN = DATETIME_Null) 
OR (dfDATO = DATETIME_Null) 
OR (SqlPrepareAndExecute(hSql(),
   "SELECT trunc(months_between(:dfDATO,:dfDATN)) INTO :nMonths FROM dual") 
    AND 
    NOT SqlFetchNext(hSql(), nFetchRes))
.head 7 -  Set nMonths = 0 
.head 6 -  Call cmbFREQV.Init(hWndItem)
.head 6 -  Call cmbFREQV.Populate(hSql(),
    "freq", "name", "freq",
   " WHERE  allow_term >= 0 and allow_term <= "||Str(nMonths)||
   " ORDER BY 1")
.head 6 -  Call cmbFREQV.SetSelectById(dfFREQV)
.head 5 +  On SAM_Click
.head 6 -  Set dfFREQV = cmbFREQV.GetKey(SalListQuerySelection(cmbFREQV))
.head 3 +  Check Box: cbCOMPROC
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Капитализация начисленных процентов на основной счет
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    2.774"
.head 5 -  Width:  6.25"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If nReadWrite = 1 AND cbCOMPROC
.head 7 -  Call SalDisableWindow( dfMFOP )
.head 7 -  Call SalDisableWindow( dfNLSP )
.head 7 -  Call SalDisableWindow( dfNMSP )
.head 7 -  Set dfMFOP = Val(GetBankMfo())
.head 7 -  Set dfNLSP = dfNLSDEP
.head 7 -  Set dfNMSP = Subs(dfNMK,1,38)
.head 6 +  Else If nReadWrite = 1 AND NOT cbCOMPROC
.head 7 -  Call SalEnableWindow( dfMFOP )
.head 7 -  Call SalEnableWindow( dfNLSP )
.head 7 -  Call SalEnableWindow( dfNMSP )
.head 7 -  Set dfMFOP = Val(GetBankMfo())
.head 7 -  Set dfNLSP = STRING_Null
.head 7 -  Set dfNMSP = Subs(dfNMK,1,38)
.head 6 +  Else
.head 7 -  Call SalDisableWindow( cbCOMPROC )
.head 7 +  If cbCOMPROC
.head 8 -  Call SalDisableWindow( dfMFOP )
.head 8 -  Call SalDisableWindow( dfNLSP )
.head 8 -  Call SalDisableWindow( dfNMSP )
.head 7 +  Else
.head 8 -  Call SalEnableWindow( dfMFOP )
.head 8 -  Call SalEnableWindow( dfNLSP )
.head 8 -  Call SalEnableWindow( dfNMSP )
.head 3 -  !
.head 3 -  Background Text: Условия досрочного расторжения вклада
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 35370
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    3.18"
.head 5 -  Width:  4.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgShtraf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Штраф:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21134
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    3.548"
.head 5 -  Width:  1.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSTOPID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSTOPID
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.9"
.head 6 -  Top:    3.536"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSTOP
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.767"
.head 5 -  Top:    3.524"
.head 5 -  Width:  5.767"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.726"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbSTOP.Init(hWndItem)
.head 6 -  Call cmbSTOP.Populate(hSql(),"ID","NAME","DPT_STOP","ORDER BY 1")
.head 6 -  Call cmbSTOP.SetSelectById(dfSTOPID)
.head 5 +  On SAM_Click
.head 6 -  Set dfSTOPID = cmbSTOP.GetKey(SalListQuerySelection(cmbSTOP))
.head 3 -  !
.head 3 -  Background Text: Неснижаемый остаток:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21114
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    4.0"
.head 5 -  Width:  3.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMIN_SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMIN_SUM
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.85"
.head 6 -  Top:    3.976"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfSUM  != NUMBER_Null AND 
dfMIN_SUM != NUMBER_Null AND 
dfMIN_SUM >  dfSUM
.head 7 -  ! 'Неснижаемый остаток превышает сумму по договору!'
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrMinSum'),
                   CurrentLangTable.GetAtomTitle('cTErr'), 
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 -  ! Закладка "Доп.ин-ция"
.head 3 -  Background Text: Должностное лицо
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 2584
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.48"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTRUSTID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTRUSTID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: ФИО:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 46556
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.821"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTRUSTFIO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTRUSTFIO
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.9"
.head 6 -  Top:    0.774"
.head 6 -  Width:  7.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Должность:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 46558
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.083"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTRUSTPOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTRUSTPOS
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.9"
.head 6 -  Top:    1.048"
.head 6 -  Width:  5.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Документ:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 46557
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.345"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTRUSTDOC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTRUSTDOC
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.9"
.head 6 -  Top:    1.31"
.head 6 -  Width:  5.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbTrustee
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledChilds
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Довер.лица
.head 4 -  Window Location and Size
.head 5 -  Left:   8.7"
.head 5 -  Top:    1.048"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.488"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\CUSTPERS.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Ответственные лица клиента'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipTrustee'))
.head 5 +  On SAM_Click
.head 6 +  If dfRNK != NUMBER_Null
.head 7 -  Set sTrustId = STRING_Null
.head 7 -  Call FunNSIGetFiltered(
     "v_trustee_allow2sign", 
     "id",
     " to_char(rnk) = "||Str(dfRNK), 
      sTrustId, 
      sTmp)
.head 7 -  If sTrustId != STRING_Null AND 
SqlPrepareAndExecute(hSql(),
  "SELECT id, fio, position, document 
     INTO :dfTRUSTID,:dfTRUSTFIO,:dfTRUSTPOS,:dfTRUSTDOC 
     FROM v_trustee_allow2sign  
    WHERE to_char(id) = "||sTrustId)
AND SqlFetchNext(hSql(), nFetchRes)
.head 6 +  Else
.head 7 -  ! 'Не указан клиент!'
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessNotClient'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 3 -  Background Text: Комментарий:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 2585
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.88"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgCOMMENTS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: mlCOMMENTS
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 128
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    2.274"
.head 6 -  Width:  9.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.619"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Picture: picClient
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.9"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.85"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: picDep
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.6"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.8"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: picProc
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.6"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Line
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 35371
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.3"
.head 5 -  Begin Y:  2.381"
.head 5 -  End X:  10.2"
.head 5 -  End Y:  2.381"
.head 4 -  Visible? No
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 +  Picture: picshtraf
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    3.3"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Line
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 35372
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.3"
.head 5 -  Begin Y:  3.881"
.head 5 -  End X:  10.2"
.head 5 -  End Y:  3.881"
.head 4 -  Visible? No
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 +  Picture: picLico
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.6"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: picComm
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    2.0"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.1"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  ! Закладка "SWIFT-реквизиты"
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45050
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.6"
.head 5 -  Width:  9.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.726"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Банк-посредник (56)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45048
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.417"
.head 5 -  Top:    0.476"
.head 5 -  Width:  2.817"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.238"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW56
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Название:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45051
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    0.774"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW56_Name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW56_Name
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    0.774"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Адрес:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45052
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    1.036"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW56_Adr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW56_Adr
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    1.036"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: SWIFT-код:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45056
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    1.298"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW56_Code
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW56_Code
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 11
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    1.298"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  !
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45061
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.798"
.head 5 -  Width:  9.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.44"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Банк-Бенефициар (57)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45062
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.417"
.head 5 -  Top:    1.679"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.238"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW57
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Название:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45054
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    2.0"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW57_Name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW57_Name
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    2.0"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Адрес:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45058
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    2.25"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW57_Adr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW57_Adr
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    2.25"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: SWIFT-код:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45049
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    2.5"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW57_Code
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW57_Code
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 11
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    2.5"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Счет:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45053
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    2.75"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW57_Acc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW57_Acc
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    2.75"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: (банка-бенефициара в банке-посреднике)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45063
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.233"
.head 5 -  Top:    2.75"
.head 5 -  Width:  4.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW57_AccDtl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Background Text: Бенефициар (59)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45060
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.417"
.head 5 -  Top:    3.107"
.head 5 -  Width:  2.417"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.238"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW59
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Название:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45059
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    3.429"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW59_Name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW59_Name
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    3.429"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Адрес:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45057
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    3.679"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW59_Adr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW59_Adr
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    3.679"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Счет:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 45055
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    3.929"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSW59_Acc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSW59_Acc
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    3.929"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfOKPOP
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.6"
.head 6 -  Top:    1.738"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfNLSP != ''
.head 7 +  If Vkrz2(Str(dfMFOP),dfNLSP) != dfNLSP
.head 8 -  ! 'Ошибка в контрольном разряде счета!'
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAcc'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 8 -  Set dfNLSP = ''
.head 7 +  Else
.head 8 +  If dfMFOP = Val(GetBankMfo())
.head 9 +  If SqlPrepareAndExecute( hSql(),
   "SELECT ca.rnk, substr(a.nms,1,38) 
      INTO :nTmp, :dfNMSP  
      FROM accounts a, cust_acc ca
     WHERE a.kv=:dfKV    AND a.nls=:dfNLSP AND  
           ca.acc=a.acc AND a.dazs is null" )
and not SqlFetchNext( hSql(), nFetchRes)
.head 10 -  ! 'Счет не открыт!'
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAccNotOpen'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 10 -  Set dfNLSP = ''
.head 9 +  Else
.head 10 -  ! 'Счет открыт на другого клиента! Продолжить?'
.head 10 +  If dfRNK != nTmp AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessAccRnk'),
              CurrentLangTable.GetAtomTitle('cTAt'),
              MB_IconQuestion|MB_YesNo) = IDNO
.head 11 -  Set dfNLSP = ''
.head 6 -  Return VALIDATE_Ok
.head 2 +  Functions
.head 3 +  Function: F_START
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Стартовые настройки для всех
.head 5 -  Call SalDisableWindow(dfDATZ)
.head 5 -  Call SalDisableWindow(dfBRDAT)
.head 5 -  ! открываем закладки
.head 5 -  Call picTabs.Enable(1, TRUE)
.head 5 -  Call picTabs.Enable(2, TRUE)
.head 5 +  If sTypeDeal = 'GEN'
.head 6 -  ! заголовок
.head 6 -  Set dfDPU_ID = NUMBER_Null
.head 6 -  ! Set dfTITLE = 'Депозитный договор'
.head 6 -  Set dfTITLE = CurrentLangTable.GetAtomTitle('cTDepDog')
.head 6 -  ! параметры клиента
.head 6 -  Set dfRNK = NUMBER_Null
.head 6 -  Set dfOKPO = STRING_Null
.head 6 -  Set dfNMK = STRING_Null
.head 6 -  Call SalEnableWindow(pbClient)
.head 6 -  ! параметры вида депозита
.head 6 +  If SqlPrepareAndExecute(hSql(),
  "SELECT v.name, v.srok, v.kv, t.name, 
          v.freq_v, f.name, v.bsd, v.bsn,
          NVL(v.comproc,0), v.id_stop, v.dpu_code
     INTO :dfVIDD_NAME,:nSrok,:dfKV,:dfKVNAME,
          :dfFREQV,:cmbFREQV,:sBsd,:sBsn, 
          :cbCOMPROC,:dfSTOPID,:sDpuCode
     FROM dpu_vidd v, tabval t, freq f
    WHERE v.kv = t.kv 
      AND v.freq_v = f.freq 
      AND to_char(v.vidd) = "||Str(dfVIDD))
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! 'Не найден вид договора №'
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessViddNotFound')||Str(dfVIDD)||'!', 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
.head 6 -  ! подразделение
.head 6 -  Set dfBRANCH = STRING_Null
.head 6 -  Set cmbBRANCH = STRING_Null
.head 6 -  ! Номер договора
.head 6 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT substr(dpu.f_calc_nd(sys_context('bars_context','user_branch')),1,35)
     INTO :dfND 
     FROM dual")
AND NOT SqlFetchNext(hSql(), nFetchRes) 
.head 7 -  Set dfND = STRING_Null
.head 6 +  If dfND != STRING_Null
.head 7 -  Call SalDisableWindow( dfND )
.head 6 -  ! сумма договора
.head 6 -  Set dfSUM = 0
.head 6 -  ! даты договора
.head 6 -  Set dfDATZ = GetBankDate()
.head 6 -  Set dfDATN = GetBankDate()
.head 6 -  Set dfDATO = F_CALC_DATES(dfDATN, nSrok)
.head 6 -  Set dfDATV = CorrectDate(dfKV, dfDATO, dfDATO +1)
.head 6 +  If dfDATO != DATETIME_Null
.head 7 -  Call SalDisableWindow( dfDATO )
.head 6 -  ! процентная ставка
.head 6 -  Set dfIR = 0
.head 6 -  Set dfBRDAT = GetBankDate()
.head 6 -  ! счета
.head 6 -  Call GenDealAccNums (dfRNK, dfND, dfBRANCH, sBsd, sBsn, dfNLSDEP, dfNLSDEN)
.head 6 -  ! параметры возврата депозита
.head 6 -  Set dfMFOD = SalStrToNumber( GetBankMfo())
.head 6 -  Call SalEnableWindow (dfMFOD)
.head 6 -  Set dfNBD = GetBankName()
.head 6 -  Call SalDisableWindow (dfNBD)
.head 6 -  Set dfNLSD = STRING_Null
.head 6 -  Call SalEnableWindow (dfNLSD)
.head 6 -  Set dfNMSD = STRING_Null
.head 6 -  Call SalEnableWindow (dfNMSD)
.head 6 -  ! параметры выплаты процентов
.head 6 -  Set dfMFOP = NUMBER_Null
.head 6 -  Call SalDisableWindow (dfMFOP)
.head 6 -  Set dfNBP = STRING_Null
.head 6 -  Call SalDisableWindow (dfNBP)
.head 6 -  Set dfNLSP = STRING_Null
.head 6 -  Call SalDisableWindow (dfNLSP)
.head 6 -  Set dfNMSP = STRING_Null
.head 6 -  Call SalDisableWindow (dfNMSP)
.head 6 -  ! Периодичность выплаты %%
.head 6 -  Set dfFREQV = 2
.head 6 -  Set cmbFREQV = STRING_Null
.head 6 -  Call SalDisableWindow (cmbFREQV)
.head 6 -  ! Капитализация
.head 6 -  Set cbCOMPROC = 0
.head 6 -  Call SalDisableWindow (cbCOMPROC)
.head 6 -  ! Штраф
.head 6 -  Call cmbSTOP.SetSelectById(dfSTOPID)
.head 6 -  Set dfSTOPID = 0
.head 6 -  Set cmbSTOP = STRING_Null
.head 6 -  Call SalDisableWindow (cmbSTOP)
.head 6 -  ! Мин.сумма
.head 6 -  Set dfMIN_SUM = 0
.head 6 -  Call SalDisableWindow (dfMIN_SUM)
.head 5 +  Else If sTypeDeal = 'STND'
.head 6 -  Set dfDPU_ID = NUMBER_Null
.head 6 -  ! Set dfTITLE = 'Депозитный договор'
.head 6 -  Set dfTITLE = CurrentLangTable.GetAtomTitle('cTDepDog')
.head 6 -  ! параметры клиента
.head 6 -  Set dfRNK = NUMBER_Null
.head 6 -  Set dfOKPO = STRING_Null
.head 6 -  Set dfNMK = STRING_Null
.head 6 -  Call SalEnableWindow(pbClient)
.head 6 -  ! параметры вида депозита
.head 6 +  If SqlPrepareAndExecute(hSql(),
  "SELECT v.name, v.srok, v.kv, t.name, 
          v.freq_v, f.name, v.bsd, v.bsn,
          NVL(v.comproc,0), v.id_stop, v.dpu_code
     INTO :dfVIDD_NAME,:nSrok,:dfKV,:dfKVNAME,
          :dfFREQV,:cmbFREQV,:sBsd,:sBsn, 
          :cbCOMPROC,:dfSTOPID,:sDpuCode
     FROM dpu_vidd v, tabval t, freq f
    WHERE v.kv = t.kv 
      AND v.freq_v = f.freq 
      AND to_char(v.vidd) = "||Str(dfVIDD))
and NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! 'Не найден вид договора №
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessViddNotFound')||Str(dfVIDD)||'!', 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
.head 6 -  ! подразделение
.head 6 -  Set dfBRANCH = STRING_Null
.head 6 -  Set cmbBRANCH = STRING_Null
.head 6 -  ! Номер договора
.head 6 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT substr(dpu.f_calc_nd(sys_context('bars_context','user_branch')),1,35)
     INTO :dfND 
     FROM dual")
AND NOT SqlFetchNext(hSql(), nFetchRes) 
.head 7 -  Set dfND = STRING_Null
.head 6 +  If dfND != STRING_Null
.head 7 -  Call SalDisableWindow( dfND )
.head 6 -  ! сумма договора
.head 6 -  Set dfSUM = 0
.head 6 -  ! даты договора
.head 6 -  Set dfDATZ = GetBankDate()
.head 6 -  Set dfDATN = GetBankDate()
.head 6 -  Set dfDATO = F_CALC_DATES(dfDATN, nSrok)
.head 6 -  Set dfDATV = CorrectDate(dfKV, dfDATO, dfDATO +1)
.head 6 +  If dfDATO != DATETIME_Null
.head 7 -  Call SalDisableWindow( dfDATO )
.head 6 -  ! процентная ставка
.head 6 -  Set dfIR = F_CALC_RATE (dfVIDD, dfDATN, dfDATO, dfSUM)
.head 6 -  Set dfBRDAT = GetBankDate()
.head 6 -  ! счета
.head 6 -  Call GenDealAccNums (dfRNK, dfND, dfBRANCH, sBsd, sBsn, dfNLSDEP, dfNLSDEN)
.head 6 -  ! Комбинированный вклад
.head 6 +  If sDpuCode = 'COMB'
.head 7 -  Call GenCombAccNums (dfRNK, dfVIDD, dfND, dfBRANCH, dfNLSDEP2, dfNLSDEN2)
.head 6 -  ! параметры возврата депозита
.head 6 -  Set dfMFOD = SalStrToNumber( GetBankMfo())
.head 6 -  Call SalEnableWindow (dfMFOP)
.head 6 -  Set dfNBD = GetBankName()
.head 6 -  Call SalDisableWindow (dfMFOP)
.head 6 -  Set dfNLSD = STRING_Null
.head 6 -  Call SalEnableWindow (dfNLSD)
.head 6 -  Set dfNMSD = STRING_Null
.head 6 -  Call SalEnableWindow (dfNMSD)
.head 6 -  ! параметры выплаты процентов
.head 6 -  Set dfMFOP = SalStrToNumber( GetBankMfo())
.head 6 -  Call SalEnableWindow (dfMFOP)
.head 6 -  Set dfNBP = GetBankName()
.head 6 -  Call SalDisableWindow (dfMFOP)
.head 6 -  Set dfNLSP = STRING_Null
.head 6 -  Call SalEnableWindow (dfNLSP)
.head 6 -  Set dfNMSP = STRING_Null
.head 6 -  Call SalEnableWindow (dfNMSP)
.head 6 -  ! Периодичность выплаты %%
.head 6 -  Call SalDisableWindow (cmbFREQV)
.head 6 -  ! Капитализация
.head 6 -  Call SalDisableWindow (cbCOMPROC)
.head 6 -  Call SalSendMsg(cbCOMPROC, SAM_Click, 0, 0)
.head 6 -  ! Штраф
.head 6 -  Call cmbSTOP.SetSelectById(dfSTOPID)
.head 6 -  Call SalDisableWindow (cmbSTOP)
.head 6 -  ! Мин.сумма
.head 6 -  Set dfMIN_SUM = 0
.head 6 -  Call SalDisableWindow (dfMIN_SUM)
.head 5 +  Else ! <'ADD' - додат. угода>
.head 6 -  Set dfDPU_ID = NUMBER_Null
.head 6 -  ! Set dfTITLE = 'Доп.соглашение '
.head 6 -  Set dfTITLE = CurrentLangTable.GetAtomTitle('cTDopSogl') || ' '
.head 6 -  ! Вычитка параметров из родит.договора
.head 6 +  If SqlPrepareAndExecute(hSql(), 
 "SELECT d.rnk, c.nmk, c.okpo, 
         v.vidd, v.name, v.dpu_code, 
         d.branch, b.name, 
         to_char(bars.dpu.f_next_add_number(d.dpu_id)), 
         t.kv, t.name, 
         v.srok, NVL(v.comproc,0), v.id_stop, 
         tas.id, tas.fio, tas.position, tas.document,
         ad.nls, ap.nls 
    INTO :frm_OpenM.dfRNK,     :frm_OpenM.dfNMK,       :frm_OpenM.dfOKPO,
         :frm_OpenM.dfVIDD,    :frm_OpenM.dfVIDD_NAME, :sDpuCode,
         :frm_OpenM.dfBRANCH,  :frm_OpenM.cmbBRANCH,   :frm_OpenM.dfND,         
         :frm_OpenM.dfKV,      :frm_OpenM.dfKVNAME,   :nSrok, 
         :frm_OpenM.cbCOMPROC, :frm_OpenM.dfSTOPID,
         :frm_OpenM.dfTRUSTID, :frm_OpenM.dfTRUSTFIO,
         :frm_OpenM.dfTRUSTPOS,:frm_OpenM.dfTRUSTDOC,
         :frm_OpenM.dfNLSDEP2, :frm_OpenM.dfNLSDEN2         
    FROM dpu_deal d, dpu_vidd v, tabval t, customer c, branch b,
         v_trustee_allow2sign tas, int_accn i, accounts ad, accounts ap
   WHERE d.dpu_id = :frm_OpenM.pDPU_GEN
     AND d.vidd = v.vidd 
     AND v.kv = t.kv   
     AND d.rnk = c.rnk
     AND d.trustee_id = tas.id(+) 
     AND d.branch = b.branch 
     AND d.acc = i.acc AND i.id = 1
     AND d.acc = ad.acc 
     AND i.acra = ap.acc") 
AND SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! параметры клиента
.head 7 -  Call SalDisableWindow(pbClient)
.head 7 -  ! подразделение
.head 7 -  Call SalDisableWindow(cmbBRANCH)
.head 7 -  ! Номер договора
.head 7 -  Call SalEnableWindow( dfND )
.head 7 -  ! сумма договора
.head 7 -  Set dfSUM = NUMBER_Null
.head 7 -  ! даты договора
.head 7 -  Set dfDATZ = GetBankDate()
.head 7 -  Set dfDATN = GetBankDate()
.head 7 -  Set dfDATO = F_CALC_DATES(dfDATN, nSrok)
.head 7 -  Set dfDATV = CorrectDate(dfKV, dfDATO, dfDATO +1)
.head 7 -  Call SalEnableWindow( dfDATO )
.head 7 -  Call SalEnableWindow( dfDATV )
.head 7 -  ! процентная ставка
.head 7 -  Set dfIR = F_CALC_RATE (dfVIDD, dfDATN, dfDATO, dfSUM)
.head 7 -  Set dfBRDAT = GetBankDate()
.head 7 -  ! параметры возврата депозита
.head 7 -  Set dfMFOD = SalStrToNumber( GetBankMfo())
.head 7 -  Call SalEnableWindow  (dfMFOD)
.head 7 -  Set dfNBD = GetBankName()
.head 7 -  Call SalDisableWindow (dfNBD)
.head 7 -  Set dfNLSD = STRING_Null
.head 7 -  Call SalEnableWindow  (dfNLSD)
.head 7 -  Set dfNMSD = Subs(dfNMK,1,38)
.head 7 -  Call SalEnableWindow  (dfNMSD)
.head 7 -  ! параметры выплаты процентов
.head 7 -  Set dfMFOP = SalStrToNumber( GetBankMfo())
.head 7 -  Call SalEnableWindow  (dfMFOP)
.head 7 -  Set dfNBP = GetBankName()
.head 7 -  Call SalDisableWindow  (dfNBP)
.head 7 -  Set dfNLSP = STRING_Null
.head 7 -  Call SalEnableWindow  (dfNLSP)
.head 7 -  Set dfNMSP = Subs(dfNMK,1,38)
.head 7 -  Call SalEnableWindow  (dfNMSP)
.head 7 -  ! Периодичность выплаты %%
.head 7 -  Set dfFREQV = NUMBER_Null
.head 7 -  Set cmbFREQV = STRING_Null
.head 7 -  Call SalEnableWindow  (cmbFREQV)
.head 7 -  Call SalSendMsg(cmbFREQV, SAM_User, 0, 0)
.head 7 -  ! Капитализация
.head 7 -  Call SalEnableWindow(cbCOMPROC)
.head 7 -  Call SalSendMsg(cbCOMPROC, SAM_Click, 0, 0)
.head 7 -  ! Штраф
.head 7 -  Call cmbSTOP.SetSelectById(dfSTOPID)
.head 7 -  Call SalDisableWindow  (cmbSTOP)
.head 7 -  ! Мин.сумма
.head 7 -  Set dfMIN_SUM = NUMBER_Null
.head 7 -  Call SalEnableWindow  (dfMIN_SUM)
.head 5 -  Set nKlDubl = NUMBER_Null
.head 5 -  Set dfKTDAY=F_CALC_KTDAYS(dfDATN, dfDATO)
.head 5 -  ! swift-реквизиты
.head 5 -  Set dfSW56_Name = STRING_Null
.head 5 -  Set dfSW56_Adr  = STRING_Null
.head 5 -  Set dfSW56_Code = STRING_Null
.head 5 -  Set dfSW57_Name = STRING_Null
.head 5 -  Set dfSW57_Adr  = STRING_Null
.head 5 -  Set dfSW57_Code = STRING_Null
.head 5 -  Set dfSW57_Acc  = STRING_Null
.head 5 -  Set dfSW59_Name = STRING_Null
.head 5 -  Set dfSW59_Adr  = STRING_Null
.head 5 -  Set dfSW59_Acc  = STRING_Null
.head 5 -  ! Кнопулички прячем
.head 5 -  Call SalDisableWindow( pbPasport  )
.head 5 -  Call SalDisableWindow( pbAccounts )
.head 5 -  Call SalDisableWindow( pbSos      )
.head 5 -  Call SalDisableWindow( pbPrint    )
.head 5 -  Call SalDisableWindow( pbChilds   )
.head 5 -  Call SalDisableWindow( pbDubl     )
.head 5 -  Call F_HIDE_SHOW ()
.head 3 -  ! !!!!!< F_PROLONG >!!!!!!
.head 3 +  Function: F_PROLONG
.head 4 -  Description: Пролонгація додаткової угоди
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Поля
.head 5 -  Call SalDisableWindow(dfSUM     )
.head 5 -  Call SalDisableWindow(dfBRDAT   )
.head 5 -  Call SalDisableWindow(cmbBRANCH )
.head 5 -  Call SalDisableWindow(cmbSTOP   )
.head 5 -  Call SalDisableWindow(dfMIN_SUM )
.head 5 -  Call SalEnableWindow( dfND      )
.head 5 -  Call SalEnableWindow( dfDATZ    )
.head 5 -  Call SalEnableWindow( cmbFREQV  )
.head 5 -  ! кнопки
.head 5 -  Call SalDisableWindow( pbRefresh  )
.head 5 -  Call SalDisableWindow( pbPasport  )
.head 5 -  Call SalDisableWindow( pbAccounts )
.head 5 -  Call SalDisableWindow( pbSos      )
.head 5 -  Call SalDisableWindow( pbPrint    )
.head 5 -  Call SalDisableWindow( pbChilds   )
.head 5 -  Call SalDisableWindow( pbDubl     )
.head 5 -  Call SalDisableWindow( pbClient   )
.head 5 -  Call SalDisableWindow( cbCOMPROC  )
.head 5 -  !
.head 5 -  Set nKlDubl = dfDPU_ID
.head 5 -  Set nReadWrite = -1
.head 5 -  Set dfNLSDEP=STRING_Null
.head 5 -  Set dfNLSDEN=STRING_Null
.head 5 +  If SqlPrepareAndExecute(hSql(), 
 "SELECT to_char(bars.dpu.f_next_add_number(d.dpu_id)) 
    INTO :frm_OpenM.dfND
    FROM dpu_deal d
   WHERE d.dpu_id = :frm_OpenM.pDPU_GEN")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  ! Дати угоди
.head 5 -  Set dfDATZ = dfDATO
.head 5 -  Set dfDATN = dfDATO
.head 5 -  Set dfBRDAT= dfDATO !!GetBankDate()
.head 5 -  ! Call SalMessageBox ( SalFmtFormatNumber (pDPU_GEN,'#########0'), 'PRAVEX', MB_Ok )
.head 5 -  Set dfDATO = F_CALC_DATES(dfDATN, nSrok)
.head 5 -  Set dfDATV = CorrectDate(dfKV, dfDATO, dfDATO +1)
.head 5 -  Set dfKTDAY=F_CALC_KTDAYS(dfDATN, dfDATO)
.head 5 -  ! відсоткова ставка
.head 5 -  Set dfIR = F_CALC_RATE (dfVIDD, dfDATN, dfDATO, dfSUM)
.head 5 -  Set dfTITLE = CurrentLangTable.GetAtomTitle('cTDopSogl') || ' '
.head 5 -  Return TRUE
.head 5 -  ! < Кінець F_PROLONG >
.head 3 +  Function: F_HIDE_SHOW
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! открываем закладки
.head 5 -  Call picTabs.Enable(1, TRUE)
.head 5 -  Call picTabs.Enable(2, TRUE)
.head 5 -  !
.head 5 -  Call ManageSwTagsButton()
.head 5 -  ! Стартовые настройки для всех
.head 5 +  If picTabs.GetTop() = 0
.head 6 -  Call SalHideWindow (dfSTOPID)
.head 6 -  ! Не показываем счета для комб.договора
.head 6 -  Call SalHideWindow(dfNLSDEP2)
.head 6 -  Call SalHideWindow(dfNLSDEN2)
.head 6 -  Call SalHideWindowAndLabel ( bgNLSDEP2 )
.head 6 -  Call SalHideWindowAndLabel ( bgNLSDEN2 )
.head 5 -  !
.head 5 +  If sTypeDeal = 'GEN'
.head 6 -  ! закладка "Основные параметры"
.head 6 +  If picTabs.GetTop() = 0
.head 7 -  Call SalSetWindowLabelText( bgND, CurrentLangTable.GetAtomTitle('frm_OpenM.cTNomDog'))
.head 7 -  Call SalHideWindow( dfSUM )
.head 7 -  Call SalHideWindowAndLabel ( bgSUM )
.head 7 -  Call SalHideWindow( dfDATN )
.head 7 -  Call SalHideWindowAndLabel ( bgDATN )
.head 7 -  Call SalHideWindow( dfDATV )
.head 7 -  Call SalHideWindowAndLabel ( bgDATV )
.head 7 -  Call SalHideWindow( dfIR )
.head 7 -  Call SalHideWindowAndLabel ( bgIR )
.head 7 -  Call SalHideWindow( dfBRDAT )
.head 7 -  Call SalHideWindowAndLabel ( bgBRDAT )
.head 7 -  Call SalHideWindow( dfKTDAY )
.head 7 -  Call SalHideWindowAndLabel( bgKTDAY )
.head 5 +  Else If sTypeDeal = 'STND'
.head 6 +  If picTabs.GetTop() = 0
.head 7 -  Call SalSetWindowLabelText( bgND, CurrentLangTable.GetAtomTitle('frm_OpenM.cTNomDog'))
.head 7 -  Call SalHideWindow( dfSUM )
.head 7 -  Call SalHideWindowAndLabel ( bgSUM )
.head 7 -  Call SalHideWindow( dfDATN )
.head 7 -  Call SalHideWindowAndLabel ( bgDATN )
.head 7 -  Call SalHideWindow( dfDATV )
.head 7 -  Call SalHideWindowAndLabel ( bgDATV )
.head 7 -  Call SalShowWindow( dfIR )
.head 7 -  Call SalShowWindowAndLabel ( bgIR )
.head 7 -  Call SalShowWindow( dfBRDAT )
.head 7 -  Call SalShowWindowAndLabel ( bgBRDAT )
.head 7 +  If sDpuCode = 'COMB'
.head 8 -  Call SalShowWindow(dfNLSDEP2)
.head 8 -  Call SalShowWindow(dfNLSDEN2)
.head 8 -  Call SalShowWindowAndLabel ( bgNLSDEP2 )
.head 8 -  Call SalShowWindowAndLabel ( bgNLSDEN2 )
.head 8 -  Call SalSetWindowLabelText( bgNLSDEP2, CurrentLangTable.GetAtomTitle('frm_OpenM.cTDepAcc2'))
.head 8 -  Call SalSetWindowLabelText( bgNLSDEN2, CurrentLangTable.GetAtomTitle('frm_OpenM.cTAccN2'))
.head 5 +  Else
.head 6 +  If picTabs.GetTop() = 0
.head 7 -  Call SalSetWindowLabelText( bgND, CurrentLangTable.GetAtomTitle('frm_OpenM.cTNomDopSogl'))
.head 7 -  Call SalShowWindow( dfSUM )
.head 7 -  Call SalShowWindowAndLabel ( bgSUM )
.head 7 -  Call SalShowWindow(dfDATN)
.head 7 -  Call SalShowWindowAndLabel (bgDATN)
.head 7 -  Call SalShowWindow(dfDATV)
.head 7 -  Call SalShowWindowAndLabel (bgDATV)
.head 7 -  Call SalShowWindow( dfIR )
.head 7 -  Call SalShowWindowAndLabel ( bgIR )
.head 7 -  Call SalShowWindow( dfBRDAT )
.head 7 -  Call SalShowWindowAndLabel ( bgBRDAT )
.head 7 -  !
.head 7 -  Call SalShowWindow(dfNLSDEP2)
.head 7 -  Call SalShowWindow(dfNLSDEN2)
.head 7 -  Call SalShowWindowAndLabel ( bgNLSDEP2 )
.head 7 -  Call SalShowWindowAndLabel ( bgNLSDEN2 )
.head 7 -  Call SalSetWindowLabelText( bgNLSDEP2, CurrentLangTable.GetAtomTitle('frm_OpenM.cTDepAcc'))
.head 7 -  Call SalSetWindowLabelText( bgNLSDEN2, CurrentLangTable.GetAtomTitle('frm_OpenM.cTAccN'))
.head 3 +  Function: ManageSwTagsButton
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If dfKV = GetBaseVal() OR dfKV = NUMBER_Null
.head 6 -  Call picTabs.Enable(3, FALSE)
.head 5 +  Else
.head 6 -  Call picTabs.Enable(3, TRUE)
.head 3 +  Function: F_POPULATE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT d.rnk, c.nmk, c.okpo, 
          d.vidd, v.name, v.srok, nvl(d.cnt_dubl,0), 
          d.branch, d.nd,
          r.ir, r.bdat, 
          d.sum*power(10,-t.dig), v.kv, t.name, 
          d.datz, d.dat_begin, d.dat_end,  d.datv,
          d.mfo_d, d.nls_d, d.nms_d, b1.nb,
          d.mfo_p, d.nls_p, d.nms_p, b2.nb, 
          d.freqv, f.name, d.comproc, d.id_stop,
          nvl(d.min_sum,0)*power(10,-t.dig), d.comments,
          d.trustee_id, d.dpu_gen, d.dpu_add, 
          d.acc, ad.nls, i.acra, ap.nls,  d.acc2, v.dpu_code         
   INTO  :frm_OpenM.dfRNK,     :frm_OpenM.dfNMK,     :frm_OpenM.dfOKPO, 
         :frm_OpenM.dfVIDD,    :frm_OpenM.dfVIDD_NAME,         :nSrok,     :nKlDubl,
         :frm_OpenM.dfBRANCH,  :frm_OpenM.dfND,      :frm_OpenM.dfIR,      :frm_OpenM.dfBRDAT,
         :frm_OpenM.dfSUM,     :frm_OpenM.dfKV,      :frm_OpenM.dfKVNAME, 
         :frm_OpenM.dfDATZ,    :frm_OpenM.dfDATN,    :frm_OpenM.dfDATO,    :frm_OpenM.dfDATV,
         :frm_OpenM.dfMFOD,    :frm_OpenM.dfNLSD,    :frm_OpenM.dfNMSD,    :frm_OpenM.dfNBD,
         :frm_OpenM.dfMFOP,    :frm_OpenM.dfNLSP,    :frm_OpenM.dfNMSP,    :frm_OpenM.dfNBP,
         :frm_OpenM.dfFREQV,   :frm_OpenM.cmbFREQV,  :frm_OpenM.cbCOMPROC, :frm_OpenM.dfSTOPID,
         :frm_OpenM.dfMIN_SUM, :frm_OpenM.mlCOMMENTS,
         :frm_OpenM.dfTRUSTID, :frm_OpenM.nGEN,      :frm_OpenM.nADD,      
         :frm_OpenM.nAcc,      :frm_OpenM.dfNLSDEP,  
         :frm_OpenM.nAccn,     :frm_OpenM.dfNLSDEN,
         :frm_OpenM.nAcc2,     :sDpuCode             
    FROM dpu_deal d, 
         dpu_vidd v, 
         tabval   t, 
         customer c,
         accounts ad,
         accounts ap,  
         int_accn i, 
         int_ratn r, 
         banks    b1, 
         banks    b2, 
         freq     f
   WHERE d.dpu_id     = :frm_OpenM.dfDPU_ID
     AND d.vidd       = v.vidd 
     AND v.kv         = t.kv 
     AND d.freqv      = f.freq
     AND d.rnk        = c.rnk
     AND d.acc        = i.acc 
     AND i.id         = 1
     AND d.acc        = r.acc 
     AND r.id         = 1
     AND d.acc        = ad.acc
     AND i.acra       = ap.acc
     AND d.mfo_d      = b1.mfo(+) 
     AND d.mfo_p      = b2.mfo(+) 
     AND r.bdat       = (SELECT max(bdat) 
                           FROM int_ratn 
                          WHERE acc   = d.acc 
                            AND id    = 1 
                            AND bdat <= bankdate)" )
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Определим тип договора
.head 6 +  If nADD = 0 AND nGEN = NUMBER_Null
.head 7 -  Set sTypeDeal = 'GEN'
.head 6 +  Else If nGEN != NUMBER_Null
.head 7 -  Set sTypeDeal = 'ADD'
.head 6 +  Else
.head 7 -  Set sTypeDeal = 'STND'
.head 6 -  !
.head 6 +  If sTypeDeal = 'GEN'
.head 7 -  ! Set dfTITLE = 'Депозитный договор №'||dfND||' (#'||SalNumberToStrX(dfDPU_ID,0)||')'
.head 7 -  Set dfTITLE = CurrentLangTable.GetAtomTitle('cTDepDog') ||' №'||dfND||' (#'||SalNumberToStrX(dfDPU_ID,0)||')'
.head 7 -  Call SalDisableWindow( pbSos    )
.head 7 -  Call SalEnableWindow ( pbChilds )
.head 6 +  Else If sTypeDeal = 'STND'
.head 7 -  ! Set dfTITLE = 'Депозитный договор №'||dfND||' (#'||SalNumberToStrX(dfDPU_ID,0)||')'
.head 7 -  Set dfTITLE = CurrentLangTable.GetAtomTitle('cTDepDog') ||' №'||dfND||' (#'||SalNumberToStrX(dfDPU_ID,0)||')'
.head 7 -  Call SalDisableWindow( pbChilds  )
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT d.nd, ad.nls, ap.nls  
     INTO :sTmp, :dfNLSDEP2, :dfNLSDEN2  
     FROM dpu_deal d, 
          int_accn i, 
          accounts ad, 
          accounts ap 
    WHERE d.acc    = ad.acc 
      AND ad.acc   = i.acc 
      AND i.id     = 1 
      AND i.acra   = ap.acc 
      AND d.dpu_id = :nGEN")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Set dfTITLE = 'Доп.соглашение №'||dfND||' к договору №'||sTmp
.head 7 -  Set dfTITLE = CurrentLangTable.GetAtomTitle('cTDopSogl') ||' №'||dfND||' '||
              CurrentLangTable.GetAtomTitle('cTDopSogl_')||' №'||sTmp
.head 7 -  Call SalDisableWindow( pbChilds  )
.head 6 -  ! ** < Перевірка на можливість пролонгації угоди > **
.head 6 +  If (sTypeDeal != 'GEN'         ) AND (dfDATO != DATETIME_Null) OR
   ( ( dfDATO <= GetBankDate() ) AND (dfDATO >= GetBankDate() + 7) )
.head 7 -  Call SalEnableWindow( pbDubl )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( pbDubl )
.head 6 -  Set dfKTDAY=F_CALC_KTDAYS(dfDATN, dfDATO)
.head 6 -  ! ******************* 
.head 6 -  Call SalDisableWindow(pbClient)
.head 6 -  Call cmbBRANCH.SetSelectById(dfBRANCH)
.head 6 -  Call cmbSTOP.SetSelectById  (dfSTOPID)
.head 6 -  ! данные о довер.лице
.head 6 +  If SqlPrepareAndExecute(hSql(), 
   "SELECT decode(r.rel_intext, 
                  0, 
                 (select c.name from customer_extern c where r.rel_rnk = c.id),
                 (select c.nmk  from customer        c where r.rel_rnk = c.rnk)),
           r.position, 
           d.name||' '||r.document 
      INTO :frm_OpenM.dfTRUSTFIO,:frm_OpenM.dfTRUSTPOS,:frm_OpenM.dfTRUSTDOC
      FROM customer_rel r, trustee_document_type d 
     WHERE r.document_type_id = d.id 
       AND r.rel_id           = 20 
       AND r.sign_privs       = 1 
       AND r.rnk              = :frm_OpenM.dfRNK
       AND r.rel_rnk          = :frm_OpenM.dfTRUSTID")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Счета по договору
.head 6 +  If sDpuCode = 'COMB'
.head 7 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT d.nls, p.nls 
     INTO :dfNLSDEP2,:dfNLSDEN2 
     FROM accounts d, int_accn i, accounts p
    WHERE d.acc = i.acc AND i.id = 1 AND i.acra = p.acc AND d.acc = :nAcc2")
.head 8 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  !
.head 6 -  ! SWIFT-реквизиты получателя (если есть)
.head 6 +  If SqlPrepareAndExecute(hSql(), 
     "SELECT tag56_name, tag56_adr, tag56_code,   
             tag57_name, tag57_adr, tag57_code, tag57_acc,   
             tag59_name, tag59_adr, tag59_acc
        INTO :frm_OpenM.dfSW56_Name, 
             :frm_OpenM.dfSW56_Adr, 
             :frm_OpenM.dfSW56_Code,
             :frm_OpenM.dfSW57_Name, 
             :frm_OpenM.dfSW57_Adr, 
             :frm_OpenM.dfSW57_Code, 
             :frm_OpenM.dfSW57_Acc,
             :frm_OpenM.dfSW59_Name, 
             :frm_OpenM.dfSW59_Adr,
             :frm_OpenM.dfSW59_Acc
        FROM dpu_deal_swtags 
       WHERE dpu_id = :frm_OpenM.dfDPU_ID")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Показываем кнопулечки
.head 6 -  Call SalEnableWindow( pbPrint    )
.head 6 -  ! Call SalEnableWindow( pbSos      )
.head 6 -  Call SalEnableWindow( pbPasport  )
.head 6 -  Call SalEnableWindow( pbAccounts )
.head 6 -  ! Показываем/прячем поля для редактирования
.head 6 -  Call SalDisableWindow(cbCOMPROC)
.head 6 +  If sTypeDeal = 'GEN'
.head 7 -  Call SalDisableWindow(dfMFOP)
.head 7 -  Call SalDisableWindow(dfNBP)
.head 7 -  Call SalDisableWindow(dfNLSP)
.head 7 -  Call SalDisableWindow(dfNMSP)
.head 7 -  Call SalDisableWindow(dfDATO)
.head 7 -  Call SalDisableWindow(dfMIN_SUM)
.head 7 -  Set cmbFREQV = STRING_Null
.head 7 -  Set cmbSTOP = STRING_Null
.head 6 +  Else If sTypeDeal = 'STND'
.head 7 +  If cbCOMPROC
.head 8 -  Call SalDisableWindow( dfMFOP )
.head 8 -  Call SalDisableWindow( dfNLSP )
.head 8 -  Call SalDisableWindow( dfNMSP )
.head 7 +  Else
.head 8 -  Call SalEnableWindow( dfMFOP )
.head 8 -  Call SalEnableWindow( dfNLSP )
.head 8 -  Call SalEnableWindow( dfNMSP )
.head 7 -  Call SalDisableWindow(dfDATO)
.head 6 +  Else
.head 7 +  If cbCOMPROC
.head 8 -  Call SalDisableWindow( dfMFOP )
.head 8 -  Call SalDisableWindow( dfNLSP )
.head 8 -  Call SalDisableWindow( dfNMSP )
.head 7 +  Else
.head 8 -  Call SalEnableWindow( dfMFOP )
.head 8 -  Call SalEnableWindow( dfNLSP )
.head 8 -  Call SalEnableWindow( dfNMSP )
.head 6 -  !
.head 6 -  Call SalDisableWindow(cmbBRANCH)
.head 6 -  Call SalDisableWindow(dfND)
.head 6 -  Call SalDisableWindow(dfDATZ)
.head 6 -  Call SalDisableWindow(dfDATN)
.head 6 -  Call SalDisableWindow(cmbFREQV)
.head 6 -  Call SalDisableWindow(cmbSTOP)
.head 6 -  ! бухгалтер - только просмотр карточки
.head 6 +  If pMODE = 2
.head 7 -  Call SalDisableWindow(pbUpdate)
.head 7 -  Call SalDisableWindow(pbPasport)
.head 7 -  Call SalDisableWindow( pbAccounts )
.head 7 -  Call SalDisableWindow( pbPrint )
.head 7 -  Call SalDisableWindow( pbChilds )
.head 7 -  Call SalDisableWindow( dfND )
.head 7 -  Call SalDisableWindow( dfSUM )
.head 7 -  Call SalDisableWindow( dfMIN_SUM )
.head 7 -  Call SalDisableWindow( dfDATN )
.head 7 -  Call SalDisableWindow( dfDATO )
.head 7 -  Call SalDisableWindow( dfDATV )
.head 7 -  Call SalDisableWindow(cmbFREQV)
.head 7 -  Call SalDisableWindow(cmbSTOP)
.head 7 -  Call SalDisableWindow(dfMFOP)
.head 7 -  Call SalDisableWindow(dfNLSP)
.head 7 -  Call SalDisableWindow(dfMFOD)
.head 7 -  Call SalDisableWindow(dfNLSD)
.head 7 -  Call SalDisableWindow(mlCOMMENTS)
.head 7 -  Call SalDisableWindow(dfBRDAT)
.head 7 -  Call SalDisableWindow(dfIR)
.head 7 -  Call SalDisableWindow(dfNMSD)
.head 7 -  Call SalDisableWindow(dfNMSP)
.head 7 -  Call SalDisableWindow(dfSW56_Name) 
.head 7 -  Call SalDisableWindow(dfSW56_Adr) 
.head 7 -  Call SalDisableWindow(dfSW56_Code)
.head 7 -  Call SalDisableWindow(dfSW57_Name) 
.head 7 -  Call SalDisableWindow(dfSW57_Adr) 
.head 7 -  Call SalDisableWindow(dfSW57_Code) 
.head 7 -  Call SalDisableWindow(dfSW57_Acc)
.head 7 -  Call SalDisableWindow(dfSW59_Name) 
.head 7 -  Call SalDisableWindow(dfSW59_Adr)
.head 7 -  Call SalDisableWindow(dfSW59_Acc)
.head 6 -  Call F_HIDE_SHOW()
.head 5 -  Return TRUE
.head 3 -  !
.head 3 +  Function: GenDealAccNums
.head 4 -  Description: вычисление маски счетов по договороу
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: pCustId
.head 5 -  String: pDealNum
.head 5 -  String: pBranch
.head 5 -  String: pDepBalAcc
.head 5 -  String: pIntBalAcc
.head 5 -  Receive String: pDepAccNum
.head 5 -  Receive String: pIntAccNum
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If pDealNum   = STRING_Null
OR pBranch    = STRING_Null 
OR pDepBalAcc = STRING_Null
OR pIntBalAcc = STRING_Null
.head 6 -  Set pDepAccNum = STRING_Null
.head 6 -  Set pIntAccNum = STRING_Null
.head 5 +  Else
.head 6 +  If NOT SqlPLSQLCommand(hSql(), "bars.dpu.gen_dealaccnums (pCustId, 
                                                            pDealNum, 
                                                            pBranch, 
                                                            pDepBalAcc, 
                                                            pIntBalAcc, 
                                                            pDepAccNum, 
                                                            pIntAccNum)")
.head 7 -  Set pDepAccNum = STRING_Null
.head 7 -  Set pIntAccNum = STRING_Null
.head 6 +  If nReadWrite = 1 AND cbCOMPROC
.head 7 -  Set dfNLSP = dfNLSDEP
.head 3 +  Function: GenCombAccNums
.head 4 -  Description: вычисление масок счетов до востребования для комбинированного договора
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: pCustId
.head 5 -  Number: pTypeId
.head 5 -  String: pDealNum
.head 5 -  String: pBranch
.head 5 -  Receive String: pDepAccNum
.head 5 -  Receive String: pIntAccNum
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sBsd2
.head 5 -  String: sBsn2
.head 4 +  Actions
.head 5 +  If pDealNum    = STRING_Null
OR pBranch     = STRING_Null 
OR pTypeId     = NUMBER_Null
OR sDpuCode   != 'COMB'
.head 6 -  Set pDepAccNum = STRING_Null
.head 6 -  Set pIntAccNum = STRING_Null
.head 5 +  Else
.head 6 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT v.bsd, v.bsn
     INTO :sBsd2, :sBsn2
     FROM dpu_vidd v, dpu_vidd_comb v2
    WHERE v2.dmnd_vidd = v.vidd 
      AND v2.main_vidd = :pTypeId")
AND NOT SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set pDepAccNum = STRING_Null
.head 7 -  Set pIntAccNum = STRING_Null
.head 6 +  Else
.head 7 -  Call GenDealAccNums (pCustId, pDealNum, pBranch, sBsd2, sBsn2, pDepAccNum, pIntAccNum)
.head 3 +  Function: F_CALC_RATE   !! вычисление %-ной ставки по шкале
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: p_vidd
.head 5 -  Date/Time: p_dat_open
.head 5 -  Date/Time: p_dat_clos
.head 5 -  Number: p_sum
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: n_rate
.head 5 -  Number: n_month
.head 5 -  Number: n_days
.head 4 +  Actions
.head 5 +  If p_vidd = NUMBER_Null 
OR p_dat_open = DATETIME_Null
OR p_dat_clos = DATETIME_Null
OR SalNumberAbs(nReadWrite) != 1 
.head 6 -  Return NUMBER_Null
.head 5 +  If SqlPrepareAndExecute(hSql(),
  "SELECT dpu.f_calc_rate("||
           Str(p_vidd)||","||
           "to_date('"||SalFmtFormatDateTime(p_dat_open,'dd/MM/yyyy')||"','dd/mm/yyyy')"||","||
           "to_date('"||SalFmtFormatDateTime(p_dat_clos,'dd/MM/yyyy')||"','dd/mm/yyyy')"||","||
           Str(p_sum*100)||")
      INTO :n_rate 
      FROM dual" )
  AND SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Return n_rate
.head 5 +  Else
.head 6 -  Return NUMBER_Null
.head 3 -  ! !!!!!< F_CALC_KTDAYS (вирахування к-ті днів угоди за які нар.%%) >
.head 3 +  Function: F_CALC_KTDAYS
.head 4 -  Description: вирахування к-ті днів угоди за які буде нараховано %%
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Date/Time: p_dat_beg
.head 5 -  Date/Time: p_dat_end
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nKtDays
.head 4 +  Actions
.head 5 -  Set nKtDays=(p_dat_end - p_dat_beg - IifN(nKlDubl>0, 0, 1))
.head 5 -  Return nKtDays
.head 3 -  !
.head 3 +  Function: F_CALC_DATES  !! вычисление даты окончания договора
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  Date/Time: pOpenDate !! начальная дата
.head 5 -  Number: nDuration    !! период в мес (в.т.ч. дробных)
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dCloseDate
.head 5 -  Number: nMonths
.head 5 -  Number: nDays
.head 4 +  Actions
.head 5 -  ! Кол-во месяцев
.head 5 +  If nDuration = 0 OR nDuration = NUMBER_Null
.head 6 -  Return DATETIME_Null
.head 5 -  Set nMonths = SalNumberRound(nDuration)
.head 5 -  ! Кол-во дней
.head 5 -  Set nDays = SalNumberRound(SalNumberTruncate(SalNumberMod(nDuration,1),2,2)*100)
.head 5 +  If SqlPrepareAndExecute(hSql(),
  "SELECT dpu.f_duration (:pOpenDate, :nMonths, :nDays)
     INTO :dCloseDate
     FROM dual")
and SqlFetchNext(hSql(),nFetchRes)
.head 6 -  Return dCloseDate
.head 5 +  Else
.head 6 -  Return DATETIME_Null
.head 3 +  Function: F_CHECK_DATES !! проверка дат
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nMonthsBetween
.head 5 -  String: sSelectik
.head 4 +  Actions
.head 5 +  If sTypeDeal = 'ADD' 
.head 6 +  If dfDATN != DATETIME_Null AND dfDATO != DATETIME_Null
.head 7 -  Set sSelectik = 
   "SELECT months_between(to_date('"||SalFmtFormatDateTime(dfDATO,'dd/MM/yyyy')||"','dd/MM/yyyy'), 
                          to_date('"||SalFmtFormatDateTime(dfDATN,'dd/MM/yyyy')||"','dd/MM/yyyy')) 
      FROM dual"
.head 7 -  Set nMonthsBetween = Val(GetValueStr(sSelectik))
.head 7 +  If (sDpuCode = 'SHRT' AND nMonthsBetween > 12)
OR 
   (sDpuCode = 'LONG' AND nMonthsBetween <= 12)
.head 8 -  ! 'Недопустимая срочность депозита для данного вида договора'
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrSrokForVidd'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconHand)
.head 8 -  Return FALSE
.head 5 -  Return TRUE
.head 3 -  !
.head 3 +  Function: f_checkdata        !! проверка заполнения обязательных полей
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErrorList
.head 5 -  Number: nErrorCount
.head 4 +  Actions
.head 5 -  Set sErrorList = ''
.head 5 -  Set nErrorCount = 0
.head 5 -  !
.head 5 +  If SalIsNull(dfRNK)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! 'Не указан клиент'
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListRNK') || PutCrLf()
.head 5 +  If SalIsNull(dfVIDD)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! 'Не указан вид депозитного договора'
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListVIDD') || PutCrLf()
.head 5 +  If SalIsNull(dfBRANCH)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! 'Не указано подразделение банка'
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListBRANCH') || PutCrLf()
.head 5 +  If SalIsNull(dfKV)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! 'Не указана валюта договора'
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListKV') || PutCrLf()
.head 5 +  If SalIsNull(dfSUM)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! 'Не указана сумма договора'
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListSUM') || PutCrLf()
.head 5 +  If SalIsNull(dfDATZ)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! 'Не указана дата заключения договора'
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListDATZ') || PutCrLf()
.head 5 +  If SalIsNull(dfDATN)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! 'Не указана дата поступления средств'
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListDATN') || PutCrLf()
.head 5 +  If SalIsNull(dfMFOD) OR  SalIsNull(dfNLSD) OR SalIsNull(dfNMSD)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! 'Не указаны реквизиты клиента для приема/возврата депозита'
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListMFOD') || PutCrLf()
.head 5 +  If SalIsNull(dfFREQV)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! 'Не указана периодичность выплаты %%'
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListFREQV') || PutCrLf()
.head 5 +  If SalIsNull(dfIR)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! 'Не указана процентная ставка'
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListIR') || PutCrLf()
.head 5 +  If SalIsNull(dfTRUSTID)
.head 6 -  Set nErrorCount = nErrorCount + 1
.head 6 -  ! 'Не указано ответ.лицо клиента'
.head 6 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListTRUSTID') || PutCrLf()
.head 5 +  If nErrorCount > 0
.head 6 -  ! Call SalMessageBox( sErrorList, 'Ошибка заполнения реквизитов', MB_Ok )
.head 6 -  Call SalMessageBox( sErrorList, CurrentLangTable.GetAtomTitle('_cTErrCheck'), MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: F_CHECK_ADD_NUMBER !! проверка на уникальность № доп.соглашения
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nAddExist
.head 4 +  Actions
.head 5 +  If sTypeDeal = 'ADD'
.head 6 +  If SqlPrepareAndExecute( hSql(), 
   "SELECT count(*) INTO :nAddExist 
      FROM dpu_deal 
     WHERE dpu_gen = :pDPU_GEN AND dpu_add = :dfND") 
AND SqlFetchNext(hSql(), nFetchRes) 
.head 7 -  ! 'Введенный номер доп.соглашения УЖЕ существует! Продолжить?'
.head 7 +  If nAddExist > 0 AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessDopSogl'), 
              CurrentLangTable.GetAtomTitle('cTAt'), 
              MB_IconQuestion|MB_YesNo ) = IDNO 
.head 8 -  Return FALSE
.head 5 -  Return TRUE
.head 3 -  !
.head 3 +  Function: F_SAVE
.head 4 -  Description: Открытие договора (стандарт и депозитная линия)
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nID
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Long String: sErrMsg
.head 5 -  String: pND
.head 5 -  String: pBRANCH
.head 5 -  String: pMFOP
.head 5 -  String: pNLSP
.head 5 -  String: pNMSP
.head 5 -  String: pMFOD
.head 5 -  String: pNLSD
.head 5 -  String: pNMSD
.head 5 -  String: pCOMM
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If f_checkdata() 
.head 6 -  Set pND = Subs(dfND,1,35)
.head 6 -  Set pBRANCH = Subs(dfBRANCH,1,30)
.head 6 -  Set pMFOP = Subs(Str(dfMFOP),1,12)
.head 6 -  Set pNLSP = Subs(dfNLSP,1,15)
.head 6 -  Set pNMSP = Subs(dfNMSP,1,38)
.head 6 -  Set pMFOD = Subs(Str(dfMFOD),1,12)
.head 6 -  Set pNLSD = Subs(dfNLSD,1,15)
.head 6 -  Set pNMSD = Subs(dfNMSD,1,38)
.head 6 -  Set pCOMM = Subs(mlCOMMENTS,1,128)
.head 6 +  If pDPU_GEN = NUMBER_Null
.head 7 +  If SqlPLSQLCommand(hSql(), "bars.dpu.p_open_standart (
                            pND, dfRNK, dfVIDD, dfSUM,
                            dfDATZ, dfDATN, dfDATO, dfDATV, 
                            pMFOP, pNLSP, pNMSP,
                            pMFOD, pNLSD, pNMSD,
                            dfFREQV, cbCOMPROC, dfSTOPID, dfMIN_SUM,
                            dfIR, NUMBER_Null, NUMBER_Null,
                            pCOMM, pGRP, pISP, pBRANCH, dfTRUSTID,
                            nID, sErrMsg)")
.head 8 -  Set sErr = sErrMsg
.head 7 +  Else
.head 8 -  Set sErr = sErrMsg
.head 8 -  Set nID = -101
.head 6 +  Else
.head 7 +  If SqlPLSQLCommand(hSql(),
   "bars.dpu.p_open_deposit_line (pND, pDPU_GEN, dfRNK, dfVIDD, dfSUM,
    dfDATZ, dfDATN, dfDATO, dfDATV, 
    pMFOP, pNLSP, pNMSP,
    pMFOD, pNLSD, pNMSD,
    dfFREQV, cbCOMPROC, dfSTOPID, dfMIN_SUM, dfIR, NUMBER_Null, NUMBER_Null,
    pCOMM, pGRP, pISP, dfTRUSTID, nKlDubl, nID, sErrMsg)")
.head 8 -  Set sErr = sErrMsg
.head 7 +  Else
.head 8 -  Set sErr = sErrMsg
.head 8 -  Set nID = -102
.head 6 +  If nID > 0 AND dfKV != GetBaseVal() 
.head 7 -  Call SqlPLSQLCommand(hSql(), "dpu.set_dealswtags (nID,
                                                  frm_OpenM.dfSW56_Name, 
                                                  frm_OpenM.dfSW56_Adr, 
                                                  frm_OpenM.dfSW56_Code,
                                                  frm_OpenM.dfSW57_Name, 
                                                  frm_OpenM.dfSW57_Adr, 
                                                  frm_OpenM.dfSW57_Code, 
                                                  frm_OpenM.dfSW57_Acc,
                                                  frm_OpenM.dfSW59_Name, 
                                                  frm_OpenM.dfSW59_Adr, 
                                                  frm_OpenM.dfSW59_Acc,
                                                  frm_OpenM.dfBRANCH)")
.head 5 +  Else
.head 6 -  Set nID = -1
.head 5 -  Return nID
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: f_updealparams
.head 4 -  Description: Изменение параметров договора
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTrustid
.head 5 -  Boolean: bOk
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If f_checkdata() AND SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Open.cUpdDealQuest'), 
                                   CurrentLangTable.GetAtomTitle('cTAt'), 
                                   MB_IconQuestion|MB_YesNo) = IDYES
.head 6 +  If SqlPLSQLCommand(hSql(), "dpu.upd_dealparams (frm_OpenM.dfDPU_ID, 
                                                frm_OpenM.dfND, 
                                                frm_OpenM.dfSUM * 100,  
                                                frm_OpenM.dfMIN_SUM * 100, 
                                                frm_OpenM.dfFREQV,  
                                                frm_OpenM.dfSTOPID,  
                                                frm_OpenM.dfDATZ,  
                                                frm_OpenM.dfDATN, 
                                                frm_OpenM.dfDATO, 
                                                frm_OpenM.dfDATV,
                                                Str(frm_OpenM.dfMFOD),
                                                frm_OpenM.dfNLSD,  
                                                frm_OpenM.dfNMSD,
                                                Str(frm_OpenM.dfMFOP),
                                                frm_OpenM.dfNLSP, 
                                                frm_OpenM.dfNMSP,
                                                frm_OpenM.dfOKPOP,
                                                frm_OpenM.dfIR, 
                                                NUMBER_Null,  
                                                NUMBER_Null,
                                                frm_OpenM.dfBRDAT, 
                                                frm_OpenM.dfBRANCH,  
                                                frm_OpenM.dfTRUSTID,  
                                                frm_OpenM.mlCOMMENTS)")
AND SqlPLSQLCommand(hSql(), "dpu.set_dealswtags (frm_OpenM.dfDPU_ID,
                                                 frm_OpenM.dfSW56_Name, 
                                                 frm_OpenM.dfSW56_Adr, 
                                                 frm_OpenM.dfSW56_Code,
                                                 frm_OpenM.dfSW57_Name, 
                                                 frm_OpenM.dfSW57_Adr, 
                                                 frm_OpenM.dfSW57_Code, 
                                                 frm_OpenM.dfSW57_Acc,
                                                 frm_OpenM.dfSW59_Name, 
                                                 frm_OpenM.dfSW59_Adr, 
                                                 frm_OpenM.dfSW59_Acc, 
                                                 frm_OpenM.dfBRANCH)")
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Open.cUpdDealDone'), 
                   CurrentLangTable.GetAtomTitle('cTInfo'), 
                   MB_IconInformation)
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Set bOk = TRUE
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Set bOk = FALSE
.head 5 +  Else
.head 6 -  Set bOk = FALSE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return bOk
.head 2 +  Window Parameters
.head 3 -  Window Handle: hWndParent
.head 3 -  Number: pMODE      !! 1 - инспектор, 2 - бухгалтер
.head 3 -  Number: pVIDD      !! вид деп.договора  
.head 3 -  Number: pDPU_ID    !! идентификатор договора / доп.соглашения 
.head 3 -  Number: pOPEN      !! 1 - открытие, 0 - просмотр/редактирование, -1 - прологація
.head 3 -  Number: pISP       !! ответ.исп.  
.head 3 -  Number: pGRP       !! группа доступа
.head 3 -  Number: pDPU_GEN   !! идентификатор ген.договора или NULL
.head 2 +  Window Variables
.head 3 -  String: sTypeDeal
.head 3 -  Number: nFetchRes
.head 3 -  Number: nUserId
.head 3 -  Number: nReadWrite
.head 3 -  !
.head 3 -  Number: nTmp
.head 3 -  String: sTmp
.head 3 -  String: sCorpAccId
.head 3 -  Number: nMfoR
.head 3 -  String: sNlsR
.head 3 -  String: sNbR
.head 3 -  String: sTrustId
.head 3 -  Number: nKlDubl  !! референс старої(пролонгуємої) угоди
.head 3 -  ! параметры вида депозита
.head 3 -  Number: nSrok
.head 3 -  String: sDpuCode
.head 3 -  Number: nFlExtend
.head 3 -  String: sBsd
.head 3 -  String: sBsn
.head 3 -  Number: nMonths
.head 3 -  !
.head 3 -  Number: nAcc
.head 3 -  Number: nAccn
.head 3 -  Number: nAcc2
.head 3 -  Number: nADD !! Номер додаткової угоди
.head 3 -  Number: nGEN
.head 3 -  String: sErr
.head 3 -  !
.head 3 -  ! Number: nIR_OLD
.head 3 -  ! Date/Time: dDATO_OLD
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_OpenM.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  Set nUserId = GetUserId()
.head 4 -  Set nReadWrite = pOPEN
.head 4 +  If pVIDD = 0 OR pVIDD = NUMBER_Null
.head 5 -  Call SalSendMsg(hWndForm, SAM_Destroy, 0, 0)
.head 4 +  Else
.head 5 -  Set dfVIDD = pVIDD
.head 4 +  If pDPU_ID != 0
.head 5 -  Set dfDPU_ID = pDPU_ID
.head 4 -  Set nGEN = pDPU_GEN
.head 4 -  ! Определение типа депозита GEN/STND/ADD
.head 4 +  If nGEN != NUMBER_Null
.head 5 -  Set sTypeDeal = 'ADD'
.head 4 +  Else
.head 5 -  If SqlPrepareAndExecute(hSql(), 
  "SELECT NVL(fl_extend,0) 
     INTO :nFlExtend
     FROM dpu_vidd
    WHERE to_char(vidd) = "||Str(dfVIDD)) 
AND SqlFetchNext(hSql(), nFetchRes)
.head 5 -  ! Якщо депозитна лінія
.head 5 +  If nFlExtend = 2
.head 6 -  Set sTypeDeal = 'GEN'
.head 5 +  Else
.head 6 -  Set sTypeDeal = 'STND'
.head 4 -  ! Відкриття / (перегляд/редагування)
.head 4 +  If nReadWrite = 1
.head 5 -  Call F_START()
.head 4 +  Else
.head 5 -  Call F_POPULATE()
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On UM_CreateDoc
.head 4 -  Call CreateDptDoc(frm_OpenM.dfDPU_ID, frm_OpenM.dfVIDD)
.head 3 +  On SAM_Destroy
.head 4 +  If pOPEN != 2
.head 5 -  Call SalSendMsg(DPU_DEAL.pbRefresh, SAM_Click, 0, 0)
.head 4 +  If sTypeDeal = 'ADD' AND pOPEN = 1
.head 5 -  Call SalSendMsg(hWndParent.frm_OpenM.pbCancel, SAM_Click, 0, 0)
.head 1 +  Table Window: AcrPay
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выплата %%
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  17.65"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.774"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 20000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14091
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.667"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  3.667"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.95"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.375"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Карточка договора'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('AcrPay.cBTipDetails')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull(ID)
.head 8 +  If sBankType = 'PRVX'
.head 9 +  If not IsWindow(hWin5)
.head 10 -  Set hWin5 = SalCreateWindow(frm_OpenM, hWndMDI, hWndForm, 
                            nMode, VIDD, ID, 0, 0, 0, NUMBER_Null)
.head 9 +  Else
.head 10 -  Call SalBringWindowToTop(frm_Open)
.head 8 +  Else
.head 9 +  If not IsWindow(hWin5)
.head 10 -  Set hWin5 = SalCreateWindow(frm_Open, hWndMDI, hWndForm, 
                            nMode, ID, DPU_GEN, NUMBER_Null, NUMBER_Null, NUMBER_Null)
.head 9 +  Else
.head 10 -  Call SalBringWindowToTop(frm_Open)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.815"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14092
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.0"
.head 6 -  Begin Y:  -0.048"
.head 6 -  End X:  3.0"
.head 6 -  End Y:  0.417"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14093
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.35"
.head 6 -  Begin Y:  -0.06"
.head 6 -  End X:  2.35"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbRun
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Выполнить проводки'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('AcrPay.cBTipRun')
.head 6 +  On SAM_Click
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(AcrPay, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(AcrPay, nRow)
.head 8 -  Call cDoc.SetDoc (0, TT, DK, VOB, Str(ID), dDATA, dDATA, dDATA, dDATA,
                 NLS,  NMS,  MFOA, '', KVA, SR100, OKPO,
                 NLSB, NMKB, MFOB, '', KVB, SR100, OKPOB,
                 NAZN, '', GetIdOper(), '', NUMBER_Null, 0)
.head 8 -  ! << iDop() >>
.head 8 -  Call SalArraySetUpperBound( cDoc.aTag, 1, -1 )
.head 8 -  Call SalArraySetUpperBound( cDoc.aVal, 1, -1 )
.head 8 -  Set cDoc.aTag[0]= 'ND'
.head 8 -  Set cDoc.aVal[0]= SalNumberToStrX( ID, 0 )
.head 8 -  ! << cDocDpu.f_set_REF2HISTORY() >>
.head 8 -  Set cDoc.nDPUID = AcrPay.ID
.head 8 +  If not cDoc.oDoc()
.head 9 -  Call SqlRollback(hSql())
.head 8 +  Else
.head 9 -  Call SqlCommit(hSql())
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 2 +  Contents
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
дог.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.95"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND_ADD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
доп.согл.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.95"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
оп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
получат.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВАЛ
А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отправитель
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
отправителя
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
документа
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set SR100 = SR*100
.head 3 +  Column: MFOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
получат.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет получателя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВАЛ
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Получатель
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OKPOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОКПО
получат.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назначение платежа
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  11.883"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Д/К
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SR100
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
документа
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_GEN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode    !! nMode  - инспектор(1) или бухгалтер(2)
.head 3 -  Number: nID      !! nID    - идентификатор депозита или 0(все)
.head 3 -  String: sFiltP   !! sFiltP - внешний фильтр
.head 2 +  Window Variables
.head 3 -  Date/Time: dDATA
.head 3 -  Number: nRow
.head 3 -  Number: nCount
.head 3 -  : cDoc
.head 4 -  Class: cDocDpu
.head 3 -  Number: nFetchRes
.head 3 -  String: sCorAcc
.head 3 -  String: sCorNls
.head 3 -  String: sCorNms
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('AcrPay.cTWndTitle'))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  ! Call BankType_Init()
.head 4 -  Set fFilterAtStart = TRUE
.head 4 -  Set AcrPay.strPrintFileName = 'DPU_PAY'
.head 4 -  Set AcrPay.strFilterTblName = 'v_dpu_intpayers'
.head 4 -  Set dDATA    = GetBankDate()
.head 4 -  !
.head 4 -  Set AcrPay.strSqlPopulate =
"SELECT deal_id, deal_num, deal_dat, deal_gen, deal_add, vidd,  
        payer_mfo, payer_acc, payer_curid, payer_name, payer_code,   
        benef_mfo, benef_acc, benef_curid, benef_name, benef_code, 
        amount, amount/100, dk, tt, vob, nazn
  INTO  :AcrPay.ID,   :AcrPay.ND,   :AcrPay.DATZ, :AcrPay.DPU_GEN, :AcrPay.ND_ADD, :AcrPay.VIDD, 
        :AcrPay.MFOA, :AcrPay.NLS,  :AcrPay.KVA,  :AcrPay.NMS,     :AcrPay.OKPO, 
        :AcrPay.MFOB, :AcrPay.NLSB, :AcrPay.KVB,  :AcrPay.NMKB,    :AcrPay.OKPOB, 
        :AcrPay.SR100,:AcrPay.SR,   :AcrPay.DK,   :AcrPay.TT,      :AcrPay.VOB, 
        :AcrPay.NAZN 
   FROM v_dpu_intpayers
  WHERE 1 = 1 "
||IifS(sFiltP = STRING_Null, " ", sFiltP)
||IifS(nID    = 0,           " ", " AND deal_id = "||Str(nID))
||" ORDER BY deal_id"
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  ! Для SWIFT - счет-получатель из карточки операции
.head 4 -  Set sCorAcc = STRING_Null 
.head 4 -  Set sCorNls = STRING_Null 
.head 4 -  Set sCorNms = STRING_Null 
.head 4 +  If AcrPay.KVA != GetBaseVal()
.head 5 -  If SqlPrepareAndExecute(hSql(), 
  "SELECT nlsk INTO :sCorAcc 
     FROM tts 
    WHERE fli = 2 
      AND tt = :AcrPay.TT") AND
SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If sCorAcc != STRING_Null 
.head 6 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT nls, substr(nms,1,38) 
     INTO :sCorNls,:sCorNms 
     FROM accounts 
    WHERE nls = :sCorAcc AND kv = :AcrPay.KVA") AND
SqlFetchNext(hSql(), nFetchRes )
.head 7 -  Set MFOB = GetBankMfo()
.head 7 -  Set NLSB = sCorNls
.head 7 -  Set NMKB = sCorNms
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  Call SalSendClassMessage(SAM_CreateComplete, 0, 0)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg(pbDetails, SAM_Click, 0, 0)
.head 1 +  Form Window: frm_Graf
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Депозитный портфель юр. лиц
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.6"
.head 4 -  Top:    0.125"
.head 4 -  Width:  10.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.0"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.438"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Data Field: dDat
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.1"
.head 7 -  Top:    0.094"
.head 7 -  Width:  1.5"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set dDat = GetBankDate()
.head 7 -  Call SalSendMsg(hWndItem, SAM_Validate, 0, 0)
.head 6 +  On SAM_Validate
.head 7 +  If dDat = DATETIME_Null
.head 8 -  Return VALIDATE_Ok
.head 7 +  If SalIsValidDateTime(dDat)
.head 8 -  Return VALIDATE_Ok
.head 7 -  Return VALIDATE_Cancel
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.914"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Построить графики"
.head 6 +  On SAM_Click
.head 7 -  Call Draw()
.head 7 -  Call DrawVAL()
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.471"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Выйти"
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 546162466F6E7453 697A650001000000 5461624C6566744D 617267696E000200
0020: 3000005461624375 7272656E74000600 4E616D6530000054 6162426F74746F6D
0040: 4D617267696E0002 0030000054616250 616765436F756E74 0002003100005461
0060: 624C6162656C7300 2A00CFEE20E2E0EB FEF2E509CFEE20F1 F0EEEAE0EC2028FD
0080: EAE22909CFEE20F1 F0EEEAE0EC2028ED EEEC290000546162 4E616D6573001200
00A0: 4E616D6530094E61 6D6531094E616D65 3200005461625269 6768744D61726769
00C0: 6E00020030000054 6162447261775374 796C65000B005769 6E39355374796C65
00E0: 0000546162466F72 6D50616765730003 0009090000546162 546F704D61726769
0100: 6E00020030000054 61624F7269656E74 6174696F6E000100 0000546162466F6E
0120: 744E616D65000100 0000546162557365 466F6E7400010000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000
.enddata
.data CLASSPROPSSIZE
0000: 5501
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Yes
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Child Table: tblG
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.214"
.head 6 -  Top:    0.406"
.head 6 -  Width:  10.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colLCV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валюта
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSQ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Экв
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 3 +  Custom Control: cGraf
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000053 4F55524345000500
0020: 74626C4700004772 6170685370656300 4C19900100000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0180: 0000000000000200 0000320000000000 0000030000000100 0000000000000000
01A0: 0000010000000200 0000030000004172 69616C0000000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000000000 0000000000000000 0000000000000000 0000000000004172
0200: 69616C0000000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0240: 0000000000000000 0000000000004172 69616C0000000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000000000 0000000000000000 0000000000000000 0000000000004172
02A0: 69616C0000000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02E0: 0000000000000000 000000000000C800 0000960000006400 0000640000000000
0300: 0000000000000000 0000000000000000 0000060000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0360: 0000000000000100 0000000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0560: 0000000000000000 0000000000000000 0000000000000100 0000010000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0000000000000000 0000000000000000 0000000000000000 0000050000000100
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000000000 0000000000000000 0000000000000000 0000000000003200
0640: 0000000000001E00 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
06A0: 0000640000000100 0000010000000100 0000030000000100 0000000000000000
06C0: 0000000000000000 0000010000000000 0000000000000000 0000000000000000
06E0: 0000000000000000 0000000000000000 0000000000007462 6C47000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0740: 0000000000000100 0000636F6C530000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0880: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D80: 0000000000000000 0000636F6C530000 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 0000000000000000 0000000000000000 0000000000000000 0000636F6C4C4356
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14A0: 0000010000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
15A0: 0000000000000000 000007000000FFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
15C0: FFFFFFFFFFFF1000 0000100000001000 0000100000001000 0000100000001000
15E0: 0000100000001000 0000100000001000 0000100000001000 0000100000000000
1600: 0000000000000000 0000000000000000 0000000000000000 0000000000000100
1620: 0000010000000000 0000000000000000 0000000000000000 0000000000000000
1640: 0000FFFFFFFF0000 0000FFFFFFFF0000 0000000000000000 0000000000000000
1660: 0000000000000000 0000000000004752 4150485050522E48 4C50000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1880: 0000000000000000 0000000000000000 0000000000000000 0000000000000100
18A0: 0000477261706820 436F6E74726F6C00 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1940: 0000000000000000 00000F0000000000 0000080000006400 0000140000001400
1960: 0000000000000000 0000000000000000 0000000000000000 0000010000000049
1980: 54454D000500636F 6C53000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 9419
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGraph
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.214"
.head 6 -  Top:    1.948"
.head 6 -  Width:  10.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.0"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tblG1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.186"
.head 6 -  Top:    0.417"
.head 6 -  Width:  10.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colSrok
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Id
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSroks
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Срок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSQ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Экв
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If colSrok = 1
.head 7 -  ! 'до 1 мес'
.head 7 -  Set colSroks = CurrentLangTable.GetAtomTitle('frm_Graf.cTSrok1')
.head 6 +  Else If colSrok = 2
.head 7 -  ! '1-3 мес'
.head 7 -  Set colSroks = CurrentLangTable.GetAtomTitle('frm_Graf.cTSrok2')
.head 6 +  Else If colSrok = 3
.head 7 -  ! '3-6 мес'
.head 7 -  Set colSroks = CurrentLangTable.GetAtomTitle('frm_Graf.cTSrok3')
.head 6 +  Else If colSrok = 4
.head 7 -  ! '6-12 мес'
.head 7 -  Set colSroks = CurrentLangTable.GetAtomTitle('frm_Graf.cTSrok4')
.head 6 +  Else If colSrok = 5
.head 7 -  ! 'более года'
.head 7 -  Set colSroks = CurrentLangTable.GetAtomTitle('frm_Graf.cTSrok5')
.head 3 +  Custom Control: cGraf1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4954454D00050063 6F6C530000477261 706853706563004C 1990010000000000
0020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000020000 0032000000000000 0003000000010000
0180: 0000000000000000 0001000000020000 0003000000417269 616C000000000000
01A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000417269 616C000000000000 0000000000000000 0000000000000000
0200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000417269 616C000000000000
0240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000417269 616C000000000000 0000000000000000 0000000000000000
02A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 0000000000C80000 0096000000640000
02E0: 0064000000000000 0000000000000000 0000000000000000 0000000000000000
0300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000040000 0000000000000000 0000000000000000
0360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000010000
0560: 0001000000000000 0000000000000000 0000000000000000 0000000000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0005000000010000 0000000000000000 0000000000000000 0000000000000000
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000320000 0000000000160000 0000000000000000 0000000000000000
0640: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0064000000010000 0001000000010000 0003000000020000
06A0: 0000000000000000 0002000000000000 0001000000000000 0000000000000000
06C0: 0000000000000000 0000000000000000 0000000000000000 000000000074626C
06E0: 4700000000000000 0000000000000000 0000000000000000 0000000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000010000 00636F6C53000000 0000000000000000
0740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0880: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 00636F6C53000000 0000000000000000
0D80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 00636F6C4C435600 0000000000000000 0000000000000000 0000000000000000
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0001000000000000 0000000000000000 0000000000000000
14A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 0007000000FFFFFF FFFFFFFFFFFFFFFF
15A0: FFFFFFFFFFFFFFFF FFFFFFFFFF100000 0010000000100000 0010000000100000
15C0: 0010000000100000 0010000000100000 0010000000100000 0010000000100000
15E0: 0010000000000000 0000000000000000 0000000000010000 0000000000000000
1600: 0000000000010000 0001000000000000 0000000000000000 0000000000000000
1620: 0000000000000000 00FFFFFFFF000000 00FFFFFFFF000000 0000000000000000
1640: 0000000000000000 0000000000000000 0000000000475241 50485050522E484C
1660: 5000000000000000 0000000000000000 0000000000000000 0000000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1880: 0000000000010000 0047726170682043 6F6E74726F6C0000 0000000000000000
18A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 000F000000000000 0008000000640000
1940: 0014000000140000 0000000000000000 0000000000000000 0000000000000000
1960: 000100000000534F 5552434500050074 626C470000546162 4368696C644E616D
1980: 65730006004E616D 6531000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 9419
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGraph
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.186"
.head 6 -  Top:    1.969"
.head 6 -  Width:  10.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.0"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tblG2
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.417"
.head 6 -  Width:  6.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colSrok
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Id
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSroks
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Срок
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If colSrok = 1
.head 7 -  ! 'до 1 мес'
.head 7 -  Set colSroks = CurrentLangTable.GetAtomTitle('frm_Graf.cTSrok1')
.head 6 +  Else If colSrok = 2
.head 7 -  ! '1-3 мес'
.head 7 -  Set colSroks = CurrentLangTable.GetAtomTitle('frm_Graf.cTSrok2')
.head 6 +  Else If colSrok = 3
.head 7 -  ! '3-6 мес'
.head 7 -  Set colSroks = CurrentLangTable.GetAtomTitle('frm_Graf.cTSrok3')
.head 6 +  Else If colSrok = 4
.head 7 -  ! '6-12 мес'
.head 7 -  Set colSroks = CurrentLangTable.GetAtomTitle('frm_Graf.cTSrok4')
.head 6 +  Else If colSrok = 5
.head 7 -  ! 'более года'
.head 7 -  Set colSroks = CurrentLangTable.GetAtomTitle('frm_Graf.cTSrok5')
.head 3 +  Custom Control: cGraf2
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4954454D00050063 6F6C530000477261 706853706563004C 1990010000000000
0020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000020000 0032000000000000 0003000000010000
0180: 0000000000000000 0001000000020000 0003000000417269 616C000000000000
01A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000417269 616C000000000000 0000000000000000 0000000000000000
0200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000417269 616C000000000000
0240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000417269 616C000000000000 0000000000000000 0000000000000000
02A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 0000000000C80000 0096000000640000
02E0: 0064000000000000 0000000000000000 0000000000000000 0000000000000000
0300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000040000 0000000000000000 0000000000000000
0360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000010000
0560: 0001000000000000 0000000000000000 0000000000000000 0000000000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0005000000010000 0000000000000000 0000000000000000 0000000000000000
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000320000 0000000000160000 0000000000000000 0000000000000000
0640: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0064000000010000 0001000000010000 0003000000020000
06A0: 0000000000000000 0002000000000000 0001000000000000 0000000000000000
06C0: 0000000000000000 0000000000000000 0000000000000000 000000000074626C
06E0: 4700000000000000 0000000000000000 0000000000000000 0000000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000010000 00636F6C53000000 0000000000000000
0740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0880: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 00636F6C53000000 0000000000000000
0D80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 00636F6C4C435600 0000000000000000 0000000000000000 0000000000000000
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0001000000000000 0000000000000000 0000000000000000
14A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 0007000000FFFFFF FFFFFFFFFFFFFFFF
15A0: FFFFFFFFFFFFFFFF FFFFFFFFFF100000 0010000000100000 0010000000100000
15C0: 0010000000100000 0010000000100000 0010000000100000 0010000000100000
15E0: 0010000000000000 0000000000000000 0000000000010000 0000000000000000
1600: 0000000000010000 0001000000000000 0000000000000000 0000000000000000
1620: 0000000000000000 00FFFFFFFF000000 00FFFFFFFF000000 0000000000000000
1640: 0000000000000000 0000000000000000 0000000000475241 50485050522E484C
1660: 5000000000000000 0000000000000000 0000000000000000 0000000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1880: 0000000000010000 0047726170682043 6F6E74726F6C0000 0000000000000000
18A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 000F000000000000 0008000000640000
1940: 0014000000140000 0000000000000000 0000000000000000 0000000000000000
1960: 000100000000534F 5552434500050074 626C470000546162 4368696C644E616D
1980: 65730006004E616D 6532000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 9419
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGraph
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    1.969"
.head 6 -  Width:  10.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.0"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbKV
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.2"
.head 5 -  Top:    0.417"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.927"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbKV.Init(hWndItem)
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT distinct t.kv, t.name
   INTO :nKV, :sName
   FROM dpu_vidd v, tabval t 
  WHERE v.kv = t.kv")
.head 7 +  While SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call cmbKV.Add(nKV, sName)
.head 5 +  On SAM_Click
.head 6 -  Set KV = cmbKV.GetKey(SalListQuerySelection(hWndItem))
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 2 +  Functions
.head 3 +  Function: Draw
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call WaitCursorOn( )
.head 5 -  !
.head 5 -  Set sSel = 
"SELECT t.lcv, 
        sum(s.ost * power(10, -t.dig)),
        sum(gl.p_icurval(s.kv, s.ost, s.fdat))/100
   INTO :tblG.colLCV,
        :tblG.colS,
        :tblG.colSQ
   FROM dpu_deal d, sal s, tabval t
  WHERE d.acc  = s.acc 
    AND s.fdat = :dDat 
    AND s.kv   = t.kv  
  GROUP BY t.lcv"
.head 5 -  Call SalTblPopulate(tblG, hSql(), sSel, TBL_FillAll)
.head 5 -  Set cGraf.Graph.DataSource = "tblG"
.head 5 -  Set cGraf.Graph.DataField[0] = "colSQ"
.head 5 -  Set cGraf.Graph.LegendField = "colLCV"
.head 5 -  Set cGraf.Graph.NumDataFields = 1
.head 5 -  Set cGraf.Graph.Background[0] = 7
.head 5 -  Set cGraf.Graph.Background[1] = 7
.head 5 -  Set cGraf.Graph.Background[6] = 7
.head 5 -  Set cGraf.Graph.DrawMode = 2
.head 5 -  Call cGraf.Draw()
.head 5 -  !
.head 5 -  ! Set sSel = "SELECT srok, sum(ostq) ostq
              INTO :tblG1.colSrok, :tblG1.colSQ
              FROM 
                  (SELECT to_number(iif_n(m,1,1,1, iif_n(m,3,2,2,
                                    iif_n(m,6,3,3,iif_n(m,12,4,4,5))))) srok,
                                    gl.p_icurval(kv,sum(ost),fdat)/100 ostq
                     FROM 
                         (SELECT s.kv, s.fdat, s.ost ost,
                                 months_between(d.dat_end,d.dat_begin) m
                            FROM dpu_deal d, sal s, tabval t
                           WHERE d.acc=s.acc AND s.kv=t.kv AND s.fdat=:dDat)
                    GROUP BY kv, fdat, m
                    UNION
                   SELECT 1, 0 FROM DUAL UNION 
                   SELECT 2, 0 FROM DUAL UNION
                   SELECT 3, 0 FROM DUAL UNION 
                   SELECT 4, 0 FROM DUAL UNION
                   SELECT 5, 0 FROM DUAL)
             GROUP BY srok"
.head 5 -  Set sSel = 
"SELECT mnth, sum(amnt)/100
   INTO :tblG1.colSrok, :tblG1.colSQ
   FROM
        (
         SELECT (CASE WHEN d.mnth <= 1  THEN 1 
                      WHEN d.mnth <= 3  THEN 2 
                      WHEN d.mnth <= 6  THEN 3 
                      WHEN d.mnth <= 12 THEN 4 
                      ELSE 5 
                  END) mnth, d.amnt
           FROM 
                (SELECT months_between(d.dat_end, d.dat_begin) mnth, 
                        gl.p_icurval(s.kv, s.ost, s.fdat)      amnt
                   FROM dpu_deal d, sal s
                  WHERE d.acc  = s.acc 
                    AND s.fdat = :dDat
                    AND d.dat_end IS NOT NULL) d UNION ALL 
         SELECT 1, 0 FROM dual         UNION ALL 
         SELECT 2, 0 FROM dual         UNION ALL 
         SELECT 3, 0 FROM dual         UNION ALL 
         SELECT 4, 0 FROM dual         UNION ALL 
         SELECT 5, 0 FROM dual
        )
  GROUP BY mnth
  ORDER BY mnth"
.head 5 -  Call SalTblPopulate(tblG1, hSql(), sSel, TBL_FillAll)
.head 5 -  Set cGraf1.Graph.DataSource = "tblG1"
.head 5 -  Set cGraf1.Graph.DataField[0] = "colSQ"
.head 5 -  Set cGraf1.Graph.LegendField = "colSroks"
.head 5 -  Set cGraf1.Graph.NumDataFields = 1
.head 5 -  Set cGraf1.Graph.Background[0] = 7
.head 5 -  Set cGraf1.Graph.Background[1] = 7
.head 5 -  Set cGraf1.Graph.Background[6] = 7
.head 5 -  Set cGraf1.Graph.DrawMode = 2
.head 5 -  Call cGraf1.Draw()
.head 5 -  !
.head 5 -  Call WaitCursorOff( )
.head 3 +  Function: DrawVAL
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call WaitCursorOn( )
.head 5 -  !
.head 5 -  ! Set sSel = "SELECT srok, sum(ost)
              INTO :tblG2.colSrok, :tblG2.colS
              FROM 
                   (SELECT to_number(iif_n(m,1,1,1, iif_n(m,3,2,2,
                           iif_n(m,6,3,3,iif_n(m,12,4,4,5))))) srok,
	                   sum(ost) ost
                      FROM 
                          (SELECT s.ost*power(10,-t.dig) ost, months_between(d.dat_end,d.dat_begin) m
                             FROM dpu_deal d, sal s, tabval t
                            WHERE d.acc=s.acc AND s.kv=t.kv AND s.fdat=:dDat AND s.kv=:KV)
                     GROUP BY m
                     union 
                     select 1, 0 from dual union select 2, 0 from dual union
                     select 3, 0 from dual union select 4, 0 from dual union
                     select 5, 0 from dual )
             GROUP BY srok"
.head 5 -  Set sSel = 
"SELECT mnth, sum(amnt)
   INTO :tblG2.colSrok, :tblG2.colS
   FROM
       (
        SELECT (CASE WHEN d.mnth <= 1  THEN 1 
                     WHEN d.mnth <= 3  THEN 2 
                     WHEN d.mnth <= 6  THEN 3 
                     WHEN d.mnth <= 12 THEN 4 
                     ELSE 5 
                 END) mnth, d.amnt
          FROM 
               (SELECT months_between(d.dat_end, d.dat_begin) mnth, 
                       s.ost * power(10, -t.dig)              amnt
                  FROM dpu_deal d, sal s, tabval t
                 WHERE d.acc  = s.acc 
                   AND s.fdat = :dDat
                   AND s.kv   = t.kv 
                   AND t.kv   = :KV
                   AND d.dat_end IS NOT NULL) d 
                              UNION ALL 
        SELECT 1, 0 FROM dual UNION ALL 
        SELECT 2, 0 FROM dual UNION ALL 
        SELECT 3, 0 FROM dual UNION ALL 
        SELECT 4, 0 FROM dual UNION ALL 
        SELECT 5, 0 FROM dual
       )
  GROUP BY mnth
  ORDER BY mnth"
.head 5 -  Call SalTblPopulate(tblG2, hSql(), sSel, TBL_FillAll)
.head 5 -  Set cGraf2.Graph.DataSource = "tblG2"
.head 5 -  Set cGraf2.Graph.DataField[0] = "colS"
.head 5 -  Set cGraf2.Graph.LegendField = "colSroks"
.head 5 -  Set cGraf2.Graph.NumDataFields = 1
.head 5 -  Set cGraf2.Graph.Background[0] = 7
.head 5 -  Set cGraf2.Graph.Background[1] = 7
.head 5 -  Set cGraf2.Graph.Background[6] = 7
.head 5 -  Set cGraf2.Graph.DrawMode = 2
.head 5 -  Call cGraf2.Draw()
.head 5 -  !
.head 5 -  Call WaitCursorOff( )
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sSel
.head 3 -  Number: nFetchRes
.head 3 -  Number: KV
.head 3 -  Number: nKV
.head 3 -  String: sName
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Graf.cTWndTitle'))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SalCreateWindow(frm_Msg, hWndForm)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsg(frm_Msg.pbClose, SAM_Click, 0, 0)
.head 4 -  Call SalSendMsg(pbOk, SAM_Click, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Form Window: frm_Msg
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Подождите
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? No
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.2"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.6"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbClose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.2"
.head 5 -  Top:    0.948"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 -  Background Text: Идет инициализация графического сервера.
.head 4 -  Resource Id: 34805
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.286"
.head 5 -  Width:  6.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Подождите, пожалуйста...
.head 4 -  Resource Id: 17380
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.45"
.head 5 -  Top:    0.714"
.head 5 -  Width:  3.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bg2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Msg.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 1 +  Table Window: DPU_ITOG
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  14.217"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.8"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BOOKS1.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Порядок сортировки'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_ITOG.cBTipIns')
.head 6 +  On SAM_Click
.head 7 -  Call SalTblSortRows( tbl1, 1, TBL_SortIncreasing )
.head 4 +  Pushbutton: pbVidd
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.48"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BOOK.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Общие параметры видов депозитов"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_ITOG.cBTipVidd')
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWin0)
.head 8 -  Set hWin0 = SalCreateWindow(DPU_VIDD,hWndMDI,0,'','')
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( DPU_VIDD )
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Call ZAGOLOVOK(dfDate1,dfDate2)
.head 7 -  Call SalTblSortRows(tbl1, 1, TBL_SortIncreasing)
.head 7 -  Set SELE = ""
.head 7 -  Set INTO = ""
.head 7 -  Set fKV  = FALSE
.head 7 -  Set nTmp = TBL_MinRow
.head 7 +  Loop
.head 8 +  If SalTblFindNextRow(tbl1, nTmp, 0, 0)
.head 9 -  Call SalTblSetContext(tbl1, nTmp)
.head 9 +  If tbl1.nFLAG = 1
.head 10 -  Set SELE = SELE || tbl1.sSELE
.head 10 -  Set INTO = INTO || tbl1.sINTO
.head 10 +  If tbl1.sSELE = 'tabval.lcv,'
.head 11 -  Set fKV = TRUE
.head 8 +  Else
.head 9 -  Break
.head 7 -  Set ORDE = SalStrTrimX(SELE)
.head 7 +  If Len(ORDE) > 2
.head 8 -  Set ORDE = Left(ORDE, Len(ORDE)-1)
.head 8 -  Set ORDE = " GROUP BY " || ORDE || " ORDER BY " || ORDE
.head 7 +  Else
.head 8 -  Set ORDE = ""
.head 7 -  ! Підсумки депозитного портфелю
.head 7 +  If sBankType = 'PRVX'
.head 8 +  If fKV
.head 9 -  Set DPU_ITOG.strSqlPopulate = 
"SELECT " || SELE || 
        " sum((d.ost + d.dos - d.kos))/100,
          sum( d.dos)/100, 
          sum( d.kos)/100, 
          sum( d.ost)/100,
          sum((fost(i.acra, :DAT2) 
             + fdos(i.acra, :DAT1, :DAT2) 
             - fkos(i.acra, :DAT1, :DAT2)))/100,
          sum(fdos(i.acra, :DAT1, :DAT2))/100,
          sum(fkos(i.acra, :DAT1, :DAT2))/100,
          sum(fost(i.acra, :DAT2)       )/100,
          sum(d.cnt1),
          sum(d.cnt2),
          sum(d.cnt3),
          sum(d.rate1 * (d.ost+d.dos-d.kos))/100,
          sum(d.rate2 * (d.ost            ))/100
   INTO " || INTO || 
        " :DPU_ITOG.OST1, :DPU_ITOG.DOS1,  :DPU_ITOG.KOS1,  :DPU_ITOG.SAL1,
          :DPU_ITOG.OST2, :DPU_ITOG.DOS2,  :DPU_ITOG.KOS2,  :DPU_ITOG.SAL2,
          :DPU_ITOG.nKOL1,:DPU_ITOG.nKOL2, :DPU_ITOG.nKOL3,
          :DPU_ITOG.RAT1, :DPU_ITOG.RAT2         
     FROM dpu_vidd, staff, tabval, ps, int_accn i, 
         (SELECT d.acc, d.vidd, a.isp, a.nbs, a.daos, a.dazs, d.branch,
                 nvl(acrn.fproc(a.acc, :DAT1), 0) rate1,
                 nvl(acrn.fproc(a.acc, :DAT2), 0) rate2,
                 fdos(a.acc, :DAT1, :DAT2) dos,
                 fkos(a.acc, :DAT1, :DAT2) kos,
                 fost(a.acc, :DAT2) ost,
                 (case when a.daos <  :DAT1 then 1 else 0 end) cnt1,
                 (case when a.daos >= :DAT1
                        and a.daos <= :DAT2 then 1 else 0 end) cnt2,
                 (case when a.dazs >= :DAT1 
                        and a.dazs <= :DAT2 then 1 else 0 end) cnt3
            FROM dpu_deal d, accounts a
           WHERE d.acc  = a.acc
             AND (a.dazs IS NULL OR a.dazs >= :DAT1)) d 
    WHERE dpu_vidd.kv   = tabval.kv  
      AND dpu_vidd.vidd = d.vidd 
      AND staff.id      = d.isp
      AND ps.nbs        = d.nbs
      AND d.acc         = i.acc
      AND i.id          = 1      " || ORDE
.head 8 +  Else
.head 9 -  Set DPU_ITOG.strSqlPopulate = 
"SELECT " || SELE ||
        " sum((d.ostQ + d.dosQ - d.kosQ))/100,
          sum( d.dosQ)/100, 
          sum( d.kosQ)/100, 
          sum( d.ostQ)/100,
          sum((gl.p_icurval(d.kv, fost(i.acra, :DAT2),:DAT2) 
                         + fdosN(d.kv, i.acra, :DAT1, :DAT2) 
                         - fkosN(d.kv, i.acra, :DAT1, :DAT2)))/100,
          sum(fdosN(d.kv, i.acra, :DAT1, :DAT2))/100,
          sum(fkosN(d.kv, i.acra, :DAT1, :DAT2))/100,
          sum(gl.p_icurval(d.kv, fost(i.acra, :DAT2), :DAT2))/100,
          sum(d.cnt1),
          sum(d.cnt2),
          sum(d.cnt3),
          sum(d.rate1 * (d.ostQ + d.dosQ - d.kosQ))/100,
          sum(d.rate2 * (d.ostQ                  ))/100
   INTO " || INTO || 
        " :DPU_ITOG.OST1, :DPU_ITOG.DOS1,  :DPU_ITOG.KOS1,  :DPU_ITOG.SAL1,
          :DPU_ITOG.OST2, :DPU_ITOG.DOS2,  :DPU_ITOG.KOS2,  :DPU_ITOG.SAL2,
          :DPU_ITOG.nKOL1,:DPU_ITOG.nKOL2, :DPU_ITOG.nKOL3,
          :DPU_ITOG.RAT1, :DPU_ITOG.RAT2         
     FROM dpu_vidd, staff, tabval, ps, int_accn i, 
         (SELECT d.acc, d.vidd, a.isp, a.nbs, a.kv, a.daos, a.dazs, d.branch,
                 nvl(acrn.fproc(a.acc, :DAT1), 0) rate1,
                 nvl(acrn.fproc(a.acc, :DAT2), 0) rate2,
                 fdosN(a.kv, a.acc, :DAT1, :DAT2) dosq,
                 fkosN(a.kv, a.acc, :DAT1, :DAT2) kosq,
                 gl.p_icurval(a.kv, fost(a.acc, :DAT2), :DAT2) ostq,
                 (case when a.daos <  :DAT1 then 1 else 0 end) cnt1,
                 (case when a.daos >= :DAT1
                        and a.daos <= :DAT2 then 1 else 0 end) cnt2,
                 (case when a.dazs >= :DAT1 
                        and a.dazs <= :DAT2 then 1 else 0 end) cnt3
            FROM dpu_deal d, accounts a
           WHERE d.acc  = a.acc
             AND (a.dazs IS NULL OR a.dazs >= :DAT1)) d 
    WHERE dpu_vidd.kv   = tabval.kv  
      AND dpu_vidd.vidd = d.vidd 
      AND staff.id      = d.isp
      AND ps.nbs        = d.nbs
      AND d.acc         = i.acc
      AND i.id          = 1      " || ORDE
.head 7 +  Else !! Інші банки
.head 8 -  ! Итоги депозитного портфеля с учетом депозитных линий 
.head 8 +  If fKV
.head 9 -  Set DPU_ITOG.strSqlPopulate = 
"SELECT " || SELE || 
        " sum(d.flsum * (d.ost + d.dos - d.kos))/100,
          sum(d.flsum * d.dos)/100, 
          sum(d.flsum * d.kos)/100, 
          sum(d.flsum * d.ost)/100,
          sum(d.flsum * (fost(i.acra, :DAT2) 
                         + fdos(i.acra, :DAT1, :DAT2) 
                         - fkos(i.acra, :DAT1, :DAT2)))/100,
          sum(d.flsum * fdos(i.acra, :DAT1, :DAT2))/100,
          sum(d.flsum * fkos(i.acra, :DAT1, :DAT2))/100,
          sum(d.flsum * fost(i.acra, :DAT2)       )/100,
          sum(d.flcnt * d.cnt1),
          sum(d.flcnt * d.cnt2),
          sum(d.flcnt * d.cnt3),
          sum(d.rate1 * d.flsum * (d.ost+d.dos-d.kos))/100,
          sum(d.rate2 * d.flsum * (d.ost            ))/100
   INTO " || INTO || 
        " :DPU_ITOG.OST1, :DPU_ITOG.DOS1,  :DPU_ITOG.KOS1,  :DPU_ITOG.SAL1,
          :DPU_ITOG.OST2, :DPU_ITOG.DOS2,  :DPU_ITOG.KOS2,  :DPU_ITOG.SAL2,
          :DPU_ITOG.nKOL1,:DPU_ITOG.nKOL2, :DPU_ITOG.nKOL3,
          :DPU_ITOG.RAT1, :DPU_ITOG.RAT2         
     FROM dpu_vidd, staff, tabval, ps, int_accn i, 
         (SELECT d.acc, d.vidd, a.isp, a.nbs, a.daos, a.dazs, d.branch,
                 decode(nvl(d.dpu_add, 1), 0, 0, 1) flsum,
                 decode(nvl(d.dpu_add, 0), 0, 1, 0) flcnt,
                 nvl(acrn.fproc(a.acc, :DAT1), 0) rate1,
                 nvl(acrn.fproc(a.acc, :DAT2), 0) rate2,
                 fdos(a.acc, :DAT1, :DAT2) dos,
                 fkos(a.acc, :DAT1, :DAT2) kos,
                 fost(a.acc, :DAT2) ost,
                 (case when a.daos <  :DAT1 then 1 else 0 end) cnt1,
                 (case when a.daos >= :DAT1
                        and a.daos <= :DAT2 then 1 else 0 end) cnt2,
                 (case when a.dazs >= :DAT1 
                        and a.dazs <= :DAT2 then 1 else 0 end) cnt3
            FROM dpu_deal d, accounts a
           WHERE d.acc  = a.acc
             AND (a.dazs IS NULL OR a.dazs >= :DAT1)) d 
    WHERE dpu_vidd.kv   = tabval.kv  
      AND dpu_vidd.vidd = d.vidd 
      AND staff.id      = d.isp
      AND ps.nbs        = d.nbs
      AND ps.xar        = 22
      AND d.acc         = i.acc
      AND i.id          = 1      " || ORDE
.head 8 +  Else
.head 9 -  Set DPU_ITOG.strSqlPopulate = 
"SELECT " || SELE ||
        " sum(d.flsum * (d.ostQ + d.dosQ - d.kosQ))/100,
          sum(d.flsum * d.dosQ)/100, 
          sum(d.flsum * d.kosQ)/100, 
          sum(d.flsum * d.ostQ)/100,
          sum(d.flsum * (gl.p_icurval(d.kv, fost(i.acra, :DAT2), :DAT2) 
                         + fdosN(d.kv, i.acra, :DAT1, :DAT2) 
                         - fkosN(d.kv, i.acra, :DAT1, :DAT2)))/100,
          sum(d.flsum * fdosN(d.kv, i.acra, :DAT1, :DAT2))/100,
          sum(d.flsum * fkosN(d.kv, i.acra, :DAT1, :DAT2))/100,
          sum(d.flsum * gl.p_icurval(d.kv, fost(i.acra, :DAT2), :DAT2))/100,
          sum(d.flcnt * d.cnt1),
          sum(d.flcnt * d.cnt2),
          sum(d.flcnt * d.cnt3),
          sum(d.rate1 * d.flsum * (d.ostQ + d.dosQ - d.kosQ))/100,
          sum(d.rate2 * d.flsum * (d.ostQ                  ))/100
   INTO " || INTO || 
        " :DPU_ITOG.OST1, :DPU_ITOG.DOS1,  :DPU_ITOG.KOS1,  :DPU_ITOG.SAL1,
          :DPU_ITOG.OST2, :DPU_ITOG.DOS2,  :DPU_ITOG.KOS2,  :DPU_ITOG.SAL2,
          :DPU_ITOG.nKOL1,:DPU_ITOG.nKOL2, :DPU_ITOG.nKOL3,
          :DPU_ITOG.RAT1, :DPU_ITOG.RAT2         
     FROM dpu_vidd, staff, tabval, ps, int_accn i, 
         (SELECT d.acc, d.vidd, a.isp, a.nbs, a.kv, a.daos, a.dazs, d.branch,
                 decode(nvl(d.dpu_add, 1), 0, 0, 1) flsum,
                 decode(nvl(d.dpu_add, 0), 0, 1, 0) flcnt,
                 nvl(acrn.fproc(a.acc, :DAT1), 0) rate1,
                 nvl(acrn.fproc(a.acc, :DAT2), 0) rate2,
                 fdosN(a.kv, a.acc, :DAT1, :DAT2) dosq,
                 fkosN(a.kv, a.acc, :DAT1, :DAT2) kosq,
                 gl.p_icurval(a.kv, fost(a.acc, :DAT2), :DAT2) ostq,
                 (case when a.daos <  :DAT1 then 1 else 0 end) cnt1,
                 (case when a.daos >= :DAT1
                        and a.daos <= :DAT2 then 1 else 0 end) cnt2,
                 (case when a.dazs >= :DAT1 
                        and a.dazs <= :DAT2 then 1 else 0 end) cnt3
            FROM dpu_deal d, accounts a
           WHERE d.acc  = a.acc
             AND (a.dazs IS NULL OR a.dazs >= :DAT1)) d 
    WHERE dpu_vidd.kv   = tabval.kv  
      AND dpu_vidd.vidd = d.vidd 
      AND staff.id      = d.isp
      AND ps.nbs        = d.nbs
      AND d.acc         = i.acc
      AND i.id          = 1      " || ORDE
.head 7 +  ! If fKV
.head 8 -  Set DPU_ITOG.strSqlPopulate = "SELECT " || SELE || "
sum(decode(nvl(d.dpu_add,1),0,0,fdos(d.acc, :DAT1,:DAT2)))/100,
sum(decode(nvl(d.dpu_add,1),0,0,fdos(i.acra,:DAT1,:DAT2)))/100,
sum(decode(nvl(d.dpu_add,1),0,0,fkos(d.acc, :DAT1,:DAT2)))/100,
sum(decode(nvl(d.dpu_add,1),0,0,fkos(i.acra,:DAT1,:DAT2)))/100,
sum(decode(nvl(d.dpu_add,1),0,0,fost(d.acc, :DAT2)      ))/100,
sum(decode(nvl(d.dpu_add,1),0,0,fost(i.acra,:DAT2)      ))/100,
sum(iif_d(a.daos,:DAT1,    iif_d(a.dazs,:DAT1,0,decode(nvl(d.dpu_add,0),0,1,0),decode(nvl(d.dpu_add,0),0,1,0)),0,0)),
sum(iif_d(a.daos,:DAT1,0,1,iif_d(a.daos,:DAT2,  decode(nvl(d.dpu_add,0),0,1,0),decode(nvl(d.dpu_add,0),0,1,0),0))),
sum(iif_d(a.dazs,:DAT1,0,1,iif_d(a.dazs,:DAT2,  decode(nvl(d.dpu_add,0),0,1,0),decode(nvl(d.dpu_add,0),0,1,0),0))),
sum(nvl(acrn.fproc(d.acc,:DAT1),0)*nvl(decode(nvl(d.dpu_add,1), 0, 0, fost(d.acc,:DAT1)),0))/100,
sum(nvl(acrn.fproc(d.acc,:DAT2),0)*nvl(decode(nvl(d.dpu_add,1), 0, 0, fost(d.acc,:DAT2)),0))/100
INTO " || INTO || " :DPU_ITOG.DOS1, :DPU_ITOG.DOS2,
                    :DPU_ITOG.KOS1, :DPU_ITOG.KOS2,
                    :DPU_ITOG.SAL1, :DPU_ITOG.SAL2,
                    :DPU_ITOG.nKOL1,:DPU_ITOG.nKOL2, 
                    :DPU_ITOG.nKOL3,
                    :DPU_ITOG.RAT1, :DPU_ITOG.RAT2 
FROM dpu_vidd, dpu_deal d, accounts a, int_accn i, staff, tabval, ps
WHERE staff.id=a.isp       AND tabval.kv=dpu_vidd.kv AND
      dpu_vidd.vidd=d.vidd AND d.acc=a.acc           AND
      i.acc=a.acc          AND i.id=1                AND
       ps.nbs=a.nbs        " || ORDE
.head 7 +  ! Else
.head 8 -  Set DPU_ITOG.strSqlPopulate = "SELECT " || SELE || "
sum(decode(nvl(d.dpu_add,1),0,0,gl.p_icurval(dpu_vidd.kv,fost(d.acc ,:DAT2)+fdos(d.acc,:DAT1,:DAT2)-fkos(d.acc,:DAT1,:DAT2),:DAT1)))/100,
sum(decode(nvl(d.dpu_add,1),0,0,gl.p_icurval(dpu_vidd.kv,fost(i.acra,:DAT2)+fdos(i.acra,:DAT1,:DAT2)-fkos(i.acra,:DAT1,:DAT2),:DAT1)))/100,
sum(decode(nvl(d.dpu_add,1),0,0,fdosN(dpu_vidd.kv,d.acc, :DAT1,:DAT2)))/100,
sum(decode(nvl(d.dpu_add,1),0,0,fdosN(dpu_vidd.kv,i.acra,:DAT1,:DAT2)))/100,
sum(decode(nvl(d.dpu_add,1),0,0,fkosN(dpu_vidd.kv,d.acc, :DAT1,:DAT2)))/100,
sum(decode(nvl(d.dpu_add,1),0,0,fkosN(dpu_vidd.kv,i.acra,:DAT1,:DAT2)))/100,
sum(decode(nvl(d.dpu_add,1),0,0,gl.p_icurval(dpu_vidd.kv,fost(d.acc ,:DAT2),:DAT2)))/100,
sum(decode(nvl(d.dpu_add,1),0,0,gl.p_icurval(dpu_vidd.kv,fost(i.acra,:DAT2),:DAT2)))/100,
sum(iif_d(a.daos,:DAT1,    iif_d(a.dazs,:DAT1,0,decode(nvl(d.dpu_add,0),0,1,0),decode(nvl(d.dpu_add,0),0,1,0)),0,0)),
sum(iif_d(a.daos,:DAT1,0,1,iif_d(a.daos,:DAT2,  decode(nvl(d.dpu_add,0),0,1,0),decode(nvl(d.dpu_add,0),0,1,0),0))),
sum(iif_d(a.dazs,:DAT1,0,1,iif_d(a.dazs,:DAT2,  decode(nvl(d.dpu_add,0),0,1,0),decode(nvl(d.dpu_add,0),0,1,0),0))),
sum(nvl(acrn.fproc(d.acc,:DAT1),0)*nvl(decode(nvl(d.dpu_add,1), 0, 0, gl.p_icurval(dpu_vidd.kv,fost(d.acc,:DAT1),:DAT1)),0))/100,
sum(nvl(acrn.fproc(d.acc,:DAT2),0)*nvl(decode(nvl(d.dpu_add,1), 0, 0, gl.p_icurval(dpu_vidd.kv,fost(d.acc,:DAT2),:DAT2)),0))/100
INTO " || INTO || " :DPU_ITOG.OST1, :DPU_ITOG.OST2, 
                    :DPU_ITOG.DOS1, :DPU_ITOG.DOS2,
                    :DPU_ITOG.KOS1, :DPU_ITOG.KOS2,
                    :DPU_ITOG.SAL1, :DPU_ITOG.SAL2,
                    :DPU_ITOG.nKOL1,:DPU_ITOG.nKOL2, 
                    :DPU_ITOG.nKOL3,
                    :DPU_ITOG.RAT1, :DPU_ITOG.RAT2 
FROM dpu_vidd, dpu_deal d, accounts a, int_accn i, staff, tabval, ps
WHERE staff.id=a.isp       AND tabval.kv=dpu_vidd.kv AND
      dpu_vidd.vidd=d.vidd AND d.acc=a.acc           AND
      i.acc=a.acc          AND i.id=1                AND 
      ps.nbs=a.nbs         " || ORDE
.head 7 -  Set nTmp = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tbl1, nTmp, 0, 0)
.head 8 -  Call SalTblSetContext(tbl1, nTmp)
.head 8 +  If SalStrScan(tbl1.sINTO, 'nISP') > 0
.head 9 -  Set hColumnHandle = hWndForm.DPU_ITOG.nISP
.head 8 +  Else If SalStrScan(tbl1.sINTO, 'nVID') > 0
.head 9 -  Set hColumnHandle = hWndForm.DPU_ITOG.nVID
.head 8 +  Else If SalStrScan(tbl1.sINTO, 'nKV') > 0
.head 9 -  Set hColumnHandle = hWndForm.DPU_ITOG.nKV
.head 8 +  Else If SalStrScan(tbl1.sINTO, 'nBS') > 0
.head 9 -  Set hColumnHandle = hWndForm.DPU_ITOG.nBS
.head 8 +  Else If SalStrScan(tbl1.sINTO, 'sBRANCH') > 0
.head 9 -  Set hColumnHandle = hWndForm.DPU_ITOG.sBRANCH
.head 8 +  If tbl1.nFLAG = 1
.head 9 -  Call SalShowWindow(hColumnHandle)
.head 8 +  Else
.head 9 -  Call SalHideWindow(hColumnHandle)
.head 7 -  Call SalTblPopulate(hWndForm, hSql(), DPU_ITOG.strSqlPopulate, TBL_FillAll)
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.35"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SORT.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Ресурс по срокам погашения"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_ITOG.cBTipUpdate')
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWinPR)
.head 8 -  Set hWinPR= SalCreateWindow( DPU_RESURS, hWndMDI)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( DPU_RESURS )
.head 4 -  Line
.head 5 -  Resource Id: 33536
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.35"
.head 6 -  Begin Y:  0.238"
.head 6 -  End X:  1.35"
.head 6 -  End Y:  0.702"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.917"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\BOOKS1.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Архив депозитов"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_ITOG.cBTipDetails')
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWin4)
.head 8 -  Set hWin4 = SalCreateWindow(DPU_ARCHIV,hWndMDI,nPar,sPar01,sPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( DPU_ARCHIV )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.22"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 33537
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.083"
.head 6 -  Begin Y:  0.786"
.head 6 -  End X:  1.083"
.head 6 -  End Y:  0.321"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.917"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 33538
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.8"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  2.8"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  ! Group Box: Критерии формирования
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.417"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Courier New Cyr
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.end
.head 4 -  Background Text: Критерии формирования
.head 5 -  Resource Id: 18717
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.7"
.head 6 -  Top:    0.05"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgTbl
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Child Table: tbl1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.7"
.head 7 -  Top:    0.27"
.head 7 -  Width:  4.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 1.4"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  View: Table
.head 6 -  Allow Row Sizing? No
.head 6 -  Lines Per Row: 1
.head 5 -  Memory Settings
.head 6 -  Maximum Rows in Memory: Default
.head 6 -  Discardable? No
.head 5 +  Contents
.head 6 +  Column: nSORT
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class: cColumnLabeled
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Порядок
.head 7 -  Visible? Yes
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: 1
.head 7 -  Data Type: Number
.head 7 -  Justify: Center
.head 7 -  Width:  0.85"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: sSELE
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class: cColumnLabeled
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Visible? No
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Justify: Left
.head 7 -  Width:  Default
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: sINTO
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class: cColumnLabeled
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Visible? No
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Justify: Left
.head 7 -  Width:  Default
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: sNAME
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class: cColumnLabeled
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Разрез
.head 7 -  Visible? Yes
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Justify: Left
.head 7 -  Width:  1.833"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: nFLAG
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class: cColumnLabeled
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Отм
.head 7 -  Visible? Yes
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Justify: Left
.head 7 -  Width:  0.517"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Check Box
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value: 1
.head 9 -  Uncheck Value: 0
.head 9 -  Ignore Case? No
.head 7 -  List Values
.head 7 +  Message Actions
.head 8 +  On SAM_AnyEdit
.head 9 +  If nFLAG != 0
.head 10 -  Set n3 = n3 + 1
.head 10 -  Set colN = n3
.head 10 -  Call SalTblSortRows(tbl1, SalTblQueryColumnID(colN), TBL_SortIncreasing)
.head 10 -  Set nN = 0
.head 10 -  Set nRw = TBL_MinRow
.head 10 +  While SalTblFindNextRow(hWndForm, nRw, 0, 0)
.head 11 -  Call SalTblSetContext(hWndForm, nRw)
.head 11 +  If nFLAG
.head 12 -  Set nN = nN + 1
.head 12 -  Set nSORT = nN
.head 9 +  Else
.head 10 -  Set colN = 0
.head 10 -  Set nSORT = NUMBER_Null
.head 10 -  Set nN = 0
.head 10 -  Call SalTblSortRows(tbl1, SalTblQueryColumnID(colN), TBL_SortIncreasing)
.head 10 -  Set nRw = TBL_MinRow
.head 10 +  While SalTblFindNextRow(hWndForm, nRw, 0, 0)
.head 11 -  Call SalTblSetContext(hWndForm, nRw)
.head 11 +  If nFLAG
.head 12 -  Set nN = nN + 1
.head 12 -  Set nSORT = nN
.head 6 +  Column: colN
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class: cColumnLabeled
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Visible? No
.head 7 -  Editable? No
.head 7 -  Maximum Data Length: Class Default
.head 7 -  Data Type: Number
.head 7 -  Justify: Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Format: Class Default
.head 7 -  Country: Class Default
.head 7 -  Input Mask: Class Default
.head 7 -  Cell Options
.head 8 -  Cell Type? Class Default
.head 8 -  Multiline Cell? Class Default
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Class Default
.head 9 -  Vertical Scroll? Class Default
.head 9 -  Auto Drop Down? Class Default
.head 9 -  Allow Text Editing? Class Default
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Class Default
.head 7 -  List Values
.head 7 -  Message Actions
.head 5 -  Functions
.head 5 +  Window Variables
.head 6 -  Number: nRw
.head 6 -  Number: nN
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 +  On SAM_DoubleClick
.head 7 -  Set nFLAG=1-nFLAG
.head 7 -  Call SalSendMsg( nFLAG,SAM_AnyEdit,0,0)
.head 6 +  On SAM_FetchRowDone
.head 7 -  Set colN = 0
.head 4 -  ! Group Box: Задайте период
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.738"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Courier New Cyr
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.end
.head 4 -  Background Text: Задайте период
.head 5 -  Resource Id: 18716
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.25"
.head 6 -  Top:    1.05"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgDate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfDate1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.3"
.head 7 -  Top:    1.3"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.313"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 +  If SqlPrepareAndExecute( hSql(),
 "SELECT fdat INTO :DAT1 FROM fdat WHERE fdat=:dfDate1" ) AND
NOT SqlFetchNext( hSql(), nFetchRes )
.head 8 -  If SqlPrepareAndExecute( hSql(),
" SELECT min(fdat) INTO :DAT1 FROM fdat WHERE fdat >= :dfDate1" )
AND SqlFetchNext( hSql(), nFetchRes )
.head 4 +  Data Field: dfDate2
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data CLASSPROPSSIZE
0000: 4200
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.85"
.head 7 -  Top:    1.3"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.313"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 +  If SqlPrepareAndExecute( hSql(),
 "SELECT fdat INTO :DAT2 FROM fdat WHERE fdat=:dfDate2" ) AND
NOT SqlFetchNext( hSql(), nFetchRes )
.head 8 -  If SqlPrepareAndExecute( hSql(),
" SELECT max(fdat) INTO :DAT2 FROM fdat WHERE fdat <= :dfDate2" )
AND SqlFetchNext( hSql(), nFetchRes )
.head 4 +  Data Field: DAT1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.483"
.head 7 -  Top:    1.155"
.head 7 -  Width:  1.35"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.313"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: DAT2
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data CLASSPROPSSIZE
0000: 4200
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.983"
.head 7 -  Top:    1.167"
.head 7 -  Width:  1.35"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.313"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbGraf
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Chart.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Графики"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_ITOG.cBTipGraf')
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow( frm_Graf, hWndForm )
.head 4 +  Picture: Label
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.107"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  File Name: \bars98\resource\bmp\D_LABEL7.bmp
.head 5 -  Storage: Internal
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Fit: Scale
.head 5 -  Scaling
.head 6 -  Width:  100
.head 6 -  Height:  100
.head 5 -  Corners: Square
.head 5 -  Border Style: No Border
.head 5 -  Border Thickness: 1
.head 5 -  Tile To Parent? No
.head 5 -  Border Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexTransparent, SalColorFromRGB( 191, 191, 191 ) )
.head 4 +  Picture: pic2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.15"
.head 6 -  Top:    1.15"
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.6"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  File Name:
.head 5 -  Storage: External
.head 5 -  Picture Transparent Color: None
.head 5 -  Fit: Scale
.head 5 -  Scaling
.head 6 -  Width:  100
.head 6 -  Height:  100
.head 5 -  Corners: Square
.head 5 -  Border Style: Etched
.head 5 -  Border Thickness: 1
.head 5 -  Tile To Parent? No
.head 5 -  Border Color: 3D Shadow Color
.head 5 -  Background Color: 3D Face Color
.head 5 -  Message Actions
.head 4 +  Picture: pic3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.6"
.head 6 -  Top:    0.15"
.head 6 -  Width:  4.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.6"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  File Name:
.head 5 -  Storage: External
.head 5 -  Picture Transparent Color: None
.head 5 -  Fit: Scale
.head 5 -  Scaling
.head 6 -  Width:  100
.head 6 -  Height:  100
.head 5 -  Corners: Square
.head 5 -  Border Style: Etched
.head 5 -  Border Thickness: 1
.head 5 -  Tile To Parent? No
.head 5 -  Border Color: 3D Shadow Color
.head 5 -  Background Color: 3D Face Color
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: sBRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
отделения
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ФИО
исполнителя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nVID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ФИО
исполнителя
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.043"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sVID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
вклада
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВАЛ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.829"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nBS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Бал.
счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! !
.head 3 +  Column: OST1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
депозитов
на начало
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RAT1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Средневзв.
ставка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #00000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма Дт
оборотов
по депозитам
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма Кт
оборотов
по депозитам
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SAL1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
депозитов
на конец
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.071"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RAT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Средневзв.
ставка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #00000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OST2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
начисл.%%
на начало
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOS2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма Дт
оборотов
по начисл.%%
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOS2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма Кт
оборотов
по начисл.%%
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.243"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SAL2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
начисл.%%
на конец
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! !
.head 3 +  Column: nKOL1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кол-во
счетов
на начало
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nKOL2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Открыто
счетов
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nKOL3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Закрыто
 счетов
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nKOL4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кол-во
счетов
на конец
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: ZAGOLOVOK
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean: bOK
.head 4 +  Parameters
.head 5 -  Date/Time: DAT1
.head 5 -  Date/Time: DAT2
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call SalSetWindowText( hWndForm, 'Депозитный портфель юр.лиц за период с '|| SalFmtFormatDateTime( DAT1, 'dd-MM-yyyy' ) ||' по '|| SalFmtFormatDateTime( DAT2, 'dd-MM-yyyy' ) )
.head 5 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('DPU_ITOG.cTWndTitle') || ' '|| SalFmtFormatDateTime( DAT1, 'dd-MM-yyyy' ) || ' ' || 
  CurrentLangTable.GetAtomTitle('DPU_ITOG.cTWndTitle_') || ' '|| SalFmtFormatDateTime( DAT2, 'dd-MM-yyyy' ) )
.head 5 -  ! Сумма депозитов на
.head 5 -  Call SalTblSetColumnTitle( DPU_ITOG.OST1,
CurrentLangTable.GetAtomTitle('DPU_ITOG.cTOstSal1')|| '
'||SalFmtFormatDateTime( DAT1, 'dd-MM-yyyy' ))
.head 5 -  ! Сумма депозитов на
.head 5 -  Call SalTblSetColumnTitle( DPU_ITOG.SAL1,
CurrentLangTable.GetAtomTitle('DPU_ITOG.cTOstSal1')|| '
'||SalFmtFormatDateTime( DAT2, 'dd-MM-yyyy' ))
.head 5 -  ! Сумма начисл.%% на
.head 5 -  Call SalTblSetColumnTitle( DPU_ITOG.OST2,
CurrentLangTable.GetAtomTitle('DPU_ITOG.cTOstSal2')|| '
'||SalFmtFormatDateTime( DAT1, 'dd-MM-yyyy' ))
.head 5 -  ! Сумма начисл.%% на
.head 5 -  Call SalTblSetColumnTitle( DPU_ITOG.SAL2,
CurrentLangTable.GetAtomTitle('DPU_ITOG.cTOstSal2')|| '
'||SalFmtFormatDateTime( DAT2, 'dd-MM-yyyy' ))
.head 5 -  ! Кол-во счетов на
.head 5 -  Call SalTblSetColumnTitle( DPU_ITOG.nKOL1,
CurrentLangTable.GetAtomTitle('DPU_ITOG.cTKol')|| '
'||SalFmtFormatDateTime( DAT1, 'dd-MM-yyyy' ))
.head 5 -  ! Кол-во счетов на
.head 5 -  Call SalTblSetColumnTitle( DPU_ITOG.nKOL4,
CurrentLangTable.GetAtomTitle('DPU_ITOG.cTKol')|| '
'||SalFmtFormatDateTime( DAT2, 'dd-MM-yyyy' ))
.head 5 -  ! Средневзв. ставка на
.head 5 -  Call SalTblSetColumnTitle( DPU_ITOG.RAT1,
CurrentLangTable.GetAtomTitle('DPU_ITOG.cTRat')|| '
'||SalFmtFormatDateTime( DAT1, 'dd-MM-yyyy' ))
.head 5 -  ! Средневзв. ставка на
.head 5 -  Call SalTblSetColumnTitle( DPU_ITOG.RAT2,
CurrentLangTable.GetAtomTitle('DPU_ITOG.cTRat')|| '
'||SalFmtFormatDateTime( DAT2, 'dd-MM-yyyy' ))
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: sPar01
.head 3 -  String: sPar02
.head 2 +  Window Variables
.head 3 -  Date/Time: BD
.head 3 -  Number: nTmp
.head 3 -  Number: n3
.head 3 -  Number: nFetchRes
.head 3 -  String: sF
.head 3 -  String: SELE
.head 3 -  String: INTO
.head 3 -  String: ORDE
.head 3 -  Boolean: fKV
.head 3 -  Number: L
.head 3 -  Number: nOrderBy
.head 3 -  Window Handle: hColumn
.head 3 -  Window Handle: hColumnHandle
.head 3 -  Number: nWW
.head 3 -  Number: nWH
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 3 -  Number: nW
.head 3 -  Number: nH
.head 3 -  Number: nCX
.head 3 -  Number: nCY
.head 3 -  Number: nCW
.head 3 -  Number: nCH
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('DPU_ITOG.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Call cCstTab.Init(hWndForm, 1, GetUserLoginName(), NOT fNoReposition)
.head 4 -  ! Call BankType_Init()
.head 4 -  Set dfDate1 = GetBankDate()
.head 4 -  Set dfDate2 = GetBankDate()
.head 4 -  Set DAT1 = GetBankDate()
.head 4 -  Set DAT2 = GetBankDate()
.head 4 +  If nHaveTOBO = 0
.head 5 -  Call SalHideWindow(sBRANCH)
.head 4 +  Else
.head 5 -  ! Код подразделения
.head 5 -  Call SalTblSetColumnTitle(sBRANCH, CurrentLangTable.GetAtomTitle('DPU_ITOG.sSUBBRANCH'))
.head 4 +  ! Else If nHaveTOBO = 2
.head 5 -  ! Код подразделения
.head 5 -  Call SalTblSetColumnTitle(sBRANCH, CurrentLangTable.GetAtomTitle('DPU_ITOG.sSUBBRANCH'))
.head 4 -  Call ZAGOLOVOK(dfDate1,dfDate2)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  Call SalTblPopulate(tbl1, hSql(),
"SELECT 'staff.fio,',':DPU_ITOG.nISP,','"||CurrentLangTable.GetAtomTitle('DPU_ITOG.cTIsp')||"', 0
 INTO :tbl1.sSELE,:tbl1.sINTO,:tbl1.sNAME,:tbl1.nFLAG
 FROM dual
 UNION ALL
 SELECT 'dpu_vidd.name,',':DPU_ITOG.nVID,','"||CurrentLangTable.GetAtomTitle('DPU_ITOG.cTVidd')||"', 0
 FROM dual
 UNION ALL
 SELECT 'tabval.lcv,',':DPU_ITOG.nKV,','"||CurrentLangTable.GetAtomTitle('DPU_ITOG.cTKv')||"',0
 FROM dual
 UNION ALL
 SELECT 'ps.nbs, ',':DPU_ITOG.nBS,','"||CurrentLangTable.GetAtomTitle('DPU_ITOG.cTBs')||"',0
 FROM dual " 
||IifS(nHaveTOBO > 0, 
" UNION ALL 
 SELECT 'd.branch, ',':DPU_ITOG.sBRANCH,','" || CurrentLangTable.GetAtomTitle('cTFilial') || "',0
 FROM dual ", 
" "), 
TBL_FillAll)
.head 4 -  ! Inna Call SalTblPopulate(tbl1, hSql(),
"SELECT 'staff.fio,',':DPU_ITOG.nISP,','"||CurrentLangTable.GetAtomTitle('DPU_ITOG.cTIsp')||"', 0
 INTO :tbl1.sSELE,:tbl1.sINTO,:tbl1.sNAME,:tbl1.nFLAG
 FROM dual
 UNION ALL
 SELECT 'dpu_vidd.name,',':DPU_ITOG.nVID,','"||CurrentLangTable.GetAtomTitle('DPU_ITOG.cTVidd')||"', 0
 FROM dual
 UNION ALL
 SELECT 'tabval.lcv,',':DPU_ITOG.nKV,','"||CurrentLangTable.GetAtomTitle('DPU_ITOG.cTKv')||"',0
 FROM dual
 UNION ALL
 SELECT 'ps.nbs, ',':DPU_ITOG.nBS,','"||CurrentLangTable.GetAtomTitle('DPU_ITOG.cTBs')||"',0
 FROM dual " || IifS(nHaveTOBO=2, "
 UNION ALL 
 SELECT 'd.branch, ',':DPU_ITOG.sBRANCH,','" || CurrentLangTable.GetAtomTitle('cTFilial') || "',0
 FROM dual ", IifS(nHaveTOBO=1, "
 UNION ALL 
 SELECT 'a.tobo, ',':DPU_ITOG.sBRANCH,','" || CurrentLangTable.GetAtomTitle('cTBranch') || "',0
 FROM dual ", "")), TBL_FillAll)
.head 4 -  Set n3 = 0
.head 4 -  Set BD = GetBankDate()
.head 4 -  Set DPU_ITOG.strPrintFileName = 'DPT_UL'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  ! Call SalTblSetLockedColumns( hWndForm,7 )
.head 3 +  On SAM_FetchRowDone
.head 4 +  ! If fKV
.head 5 -  Set DPU_ITOG.OST1=DPU_ITOG.SAL1+DPU_ITOG.DOS1-DPU_ITOG.KOS1
.head 5 -  Set DPU_ITOG.OST2=DPU_ITOG.SAL2+DPU_ITOG.DOS2-DPU_ITOG.KOS2
.head 4 -  Set DPU_ITOG.nKOL4=DPU_ITOG.nKOL1+DPU_ITOG.nKOL2-DPU_ITOG.nKOL3
.head 4 -  !
.head 4 -  ! !
.head 4 +  If DPU_ITOG.OST1 > 0 AND DPU_ITOG.OST1 != NUMBER_Null
.head 5 -  Set DPU_ITOG.RAT1 = DPU_ITOG.RAT1 / DPU_ITOG.OST1
.head 4 +  Else
.head 5 -  Set DPU_ITOG.RAT1 =0
.head 4 -  ! !
.head 4 +  If DPU_ITOG.SAL1 > 0 AND DPU_ITOG.SAL1 != NUMBER_Null
.head 5 -  Set DPU_ITOG.RAT2 = DPU_ITOG.RAT2 / DPU_ITOG.SAL1
.head 4 +  Else
.head 5 -  Set DPU_ITOG.RAT2 =0
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set hColumn = SalNumberToWindowHandle( wParam )
.head 4 -  Set nOrderBy = Not nOrderBy
.head 4 -  Call SalTblSortRows( hWndForm, SalTblQueryColumnID( hColumn ), nOrderBy )
.head 4 -  Call SalTblSetColumnFlags( hColumn, COL_Selected, FALSE )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On WM_Size
.head 4 -  Call SalGetWindowSize( hWndForm, nWW, nWH )
.head 4 +  If nWW >= 12.6
.head 5 +  If nWH < 4.5
.head 6 -  Call SalSetWindowSize( hWndForm, nWW, 4.5 )
.head 4 +  Else
.head 5 +  If nWH < 4.5
.head 6 -  Call SalSetWindowSize( hWndForm, 12.6, 4.5 )
.head 5 +  Else
.head 6 -  Call SalSetWindowSize( hWndForm, 12.6, nWH )
.head 4 -  Call GetClientRect( hWndForm, nX, nY, nW, nH )
.head 4 -  Call SalGetWindowSize( hWndForm.DPU_ITOG.Label, nCW, nCH )
.head 4 -  Call SalGetWindowLoc( hWndForm.DPU_ITOG.Label, nCX, nCY )
.head 4 -  Call SalSetWindowLoc( hWndForm.DPU_ITOG.Label,
        SalPixelsToFormUnits( hWndForm, nW, FALSE )-nCW-0.1, nCY )
.head 4 -  Call SalInvalidateWindow( hWndForm )
.head 1 +  Table Window: DPU_RESURS
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Привлеченный ресурс по срокам погашения
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.583"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.583"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 33541
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.35"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  3.35"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.25"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.12"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 33542
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.683"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  2.683"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.817"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 33543
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.1"
.head 6 -  Begin Y:  -0.095"
.head 6 -  End X:  1.1"
.head 6 -  End Y:  0.369"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSynchro
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.155"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "По Дням/Месяцам"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_RESURS.cBTipSynchro')
.head 6 +  On SAM_Click
.head 7 -  Set FLAG = not FLAG
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0,0)
.head 2 +  Contents
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.757"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: LCV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ISO
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.014"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MMDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Год +Мес
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.014"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.371"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sF1
.head 3 -  String: sF
.head 3 -  Boolean: FLAG
.head 3 -  Number: L
.head 3 -  Number: nOrderBy
.head 3 -  Window Handle: hColumn
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('DPU_RESURS.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Set FLAG=TRUE
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 -  Set DPU_RESURS.strPrintFileName = 'D_RESURS'
.head 4 -  Set DPU_RESURS.strFilterTblName = 'DPT_U'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set hColumn = SalNumberToWindowHandle( wParam )
.head 4 -  Set nOrderBy = Not nOrderBy
.head 4 -  Call SalTblSortRows( hWndForm, SalTblQueryColumnID( hColumn ), nOrderBy )
.head 4 -  Call SalTblSetColumnFlags( hColumn, COL_Selected, FALSE )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set sF = cF.GetFilterWhereClause( FALSE )
.head 4 +  If sF !=""
.head 5 -  Set sF=" and "|| sF
.head 4 +  If FLAG
.head 5 -  Set DPU_RESURS.strSqlPopulate =
"SELECT dpt_u.kv, t.lcv, dpt_u.dat_v, sum(dpt_u.ost)/100
 INTO :DPU_RESURS.KV, :DPU_RESURS.LCV, :DPU_RESURS.DAT, :DPU_RESURS.S
 FROM dpt_u, tabval t 
 WHERE nvl(dpt_u.dpu_add,1)<>0 AND dpt_u.kv=t.kv AND dpt_u.ost<>0 "||sF||"
 GROUP BY dpt_u.kv, t.lcv, dpt_u.dat_v
 ORDER BY dpt_u.kv, dpt_u.dat_v "
.head 4 +  Else
.head 5 -  Set DPU_RESURS.strSqlPopulate =
"SELECT dpt_u.kv, t.lcv, to_char(dpt_u.dat_v,'yyyy-mm'), sum(dpt_u.ost)/100
 INTO :DPU_RESURS.KV, :DPU_RESURS.LCV, :DPU_RESURS.MMDD, :DPU_RESURS.S
 FROM dpt_u, tabval t
 WHERE nvl(dpt_u.dpu_add,1)<>0 AND dpt_u.kv=t.kv AND dpt_u.ost<>0 "||sF||"
 GROUP BY dpt_u.kv, t.lcv,to_char(dpt_u.dat_v,'yyyy-mm')
 ORDER BY dpt_u.kv, to_char(dpt_u.dat_v,'yyyy-mm') "
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), DPU_RESURS.strSqlPopulate, TBL_FillAll)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Table Window: DPU_ARCHIV
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  15.85"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.524"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.68"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 -  Background Text: Вид депозита:
.head 5 -  Resource Id: 60887
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    0.095"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgVIDD
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: nVIDD
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.0"
.head 7 -  Top:    0.07"
.head 7 -  Width:  0.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Blue
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! 'Код вида депозита' 
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('DPU_ARCHIV.cFTipVIDD'))
.head 4 +  Combo Box: cmb_VIDD
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.85"
.head 6 -  Top:    0.07"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.0"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! Вид депозиту
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cTVidd'))
.head 6 +  On SAM_Create
.head 7 -  Call cmb_VIDD.Init(hWndItem)
.head 7 +  If ( (sSegmentExists = 'Y') AND ( nSegment != NUMBER_Null ) )
.head 8 -  Call cmb_VIDD.Populate( hSql(), "VIDD", "NAME", "DPU_VIDD",
"WHERE TYPE_ID in (select TYPE_ID from DPU_TYPES where SEGMENT = " || Str( nSegment ) || ") ORDER BY VIDD" )
.head 7 +  Else
.head 8 -  Call cmb_VIDD.Populate(hSql(),"VIDD","NAME","DPU_VIDD","ORDER BY VIDD")
.head 7 -  Call cmb_VIDD.Add( -1, 'Весь портфель' )
.head 7 -  Call cmb_VIDD.SetSelectById( nVIDD )
.head 6 +  On SAM_Click
.head 7 -  Set nVIDD = cmb_VIDD.GetKey( SalListQuerySelection( cmb_VIDD))
.head 4 -  Background Text: Дата:
.head 5 -  Resource Id: 60888
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.75"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgDAT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfDAT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.8"
.head 7 -  Top:    0.07"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Red
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Код отделения:
.head 5 -  Resource Id: 38884
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    0.385"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgBranch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfBranch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.0"
.head 7 -  Top:    0.37"
.head 7 -  Width:  2.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Combo Box: cmbBranch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_StrId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.1"
.head 6 -  Top:    0.37"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.0"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On UM_ObjActivate
.head 7 +  If cmbBranch.Init(hWndItem)
.head 8 +  If nHaveTOBO = 2
.head 9 -  Call cmbBranch.Populate(hSql(), "branch", "branch||' '||name", "our_branch", "order by branch")
.head 8 +  Else
.head 9 -  Call cmbBranch.Populate(hSql(), "tobo", "tobo||' '||name", "tobo", "order by tobo")
.head 8 -  ! Call cmbBranch.Add('-', 'Все подразделения')
.head 8 -  Call cmbBranch.Add('-', CurrentLangTable.GetAtomTitle('DPU_ARCHIV.cTAllBranch'))
.head 8 -  Call cmbBranch.SetSelectById(dfBranch)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 7 -  Set dfBranch = cmbBranch.GetCurrentKey()
.head 4 -  !
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 60889
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.475"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.915"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.345"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! "Параметры договора"
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_ARCHIV.cBTipDetails')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull( DPU_ID )
.head 8 +  If sBankType = 'PRVX'
.head 9 +  If not IsWindow(hWin5)
.head 10 -  Set hWin5 = SalCreateWindow( frm_OpenM, hWndMDI, hWndForm, 
                            2, VIDD, DPU_ID, 2, 0, 0, NUMBER_Null)
.head 9 +  Else
.head 10 -  Call SalBringWindowToTop(frm_OpenM)
.head 8 +  Else
.head 9 +  If not IsWindow(hWin5)
.head 10 -  Set hWin5 = SalCreateWindow( frm_Open, hWndMDI, hWndForm, 
	3, DPU_ID, DPU_GEN, NUMBER_Null, NUMBER_Null, NUMBER_Null )
.head 9 +  Else
.head 10 -  Call SalBringWindowToTop(frm_Open)
.head 8 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.78"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 60890
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.083"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  3.083"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.517"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 60891
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.383"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  2.383"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: sBRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
отделения
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
деп.
дог.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_GEN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
ген.
дог.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_ADD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
доп.
согл.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
депоз.
дог.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
РНК
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
КЛИЕНТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Вал
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DIG валюты
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Депозитный
счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Общая
сумма
по договору
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nSUMs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Общая
сумма
по договору
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PROC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
ставка
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cумма
на счете
депозита
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nOSTs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cумма
на счете
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSTN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cумма
на счете
депозита
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nOSTNs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cумма
начисл.
%%
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ACCN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DIG валюты
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: VIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Вид договора
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заключения
договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 11
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
размещения
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 11
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
окончания
договора
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 11
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DATV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
возврата
депозита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исп
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DIG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cумма
на счете
депозита
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CLOSED
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cумма
на счете
депозита
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CNT_DUBL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: К-ть
пролонгацій
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: #0
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  ! Сегмент бізнесу ( БАНК НАДРА )
.head 3 -  Number: nSegment
.head 3 -  String: sPar01
.head 3 -  String: sPar02
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  Number: nTmp
.head 3 -  String: sTmp
.head 3 -  String: sF
.head 3 -  ! String: sF1
.head 3 -  ! !
.head 3 -  ! Number: nS1
.head 3 -  ! Number: nS2
.head 3 -  ! Number: nS3
.head 3 -  ! !
.head 3 -  Number: L
.head 3 -  Number: nOrderBy
.head 3 -  Window Handle: hColumn
.head 3 -  ! !
.head 3 -  Number: nMaxDig
.head 3 -  Number: nLastSortRow
.head 3 -  Number: nSortOrder
.head 3 -  !
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 3 -  Window Handle: hWndToolBar
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  ! Call BankType_Init()
.head 4 -  Call SalSetFocus(cmb_VIDD)
.head 4 -  Call SetWindowFullSize(DPU_ARCHIV)
.head 4 -  Set dfDAT = GetBankDate()
.head 4 -  Set dfBranch = '-'
.head 4 +  If nHaveTOBO = 0
.head 5 -  Call SalHideWindow(hWndForm.DPU_ARCHIV.sBRANCH)
.head 5 -  Call SalHideWindow(dfBranch)
.head 5 -  Call SalHideWindow(cmbBranch)
.head 5 -  Call SalHideWindowAndLabel(bgBranch)
.head 5 -  Set hWndToolBar = SalGetFirstChild(hWndForm, TYPE_FormToolBar)
.head 5 -  Call SalGetWindowSize(hWndToolBar, nX, nY)
.head 5 -  Call SalTimerSet(hWndForm, 1, 0.01)
.head 4 +  Else
.head 5 +  If nHaveTOBO = 2
.head 6 -  ! Код подразделения
.head 6 -  Call SalTblSetColumnTitle(sBRANCH, CurrentLangTable.GetAtomTitle('DPU_ARCHIV.sSUBBRANCH'))
.head 6 -  Call SalSetWindowLabelText(bgBranch, CurrentLangTable.GetAtomTitle('DPU_ARCHIV.bgSubBranch') )
.head 5 -  Call SalSendMsg(cmbBranch, UM_ObjActivate, 0, 0)
.head 4 -  Set DPU_ARCHIV.strPrintFileName = 'DPU_ARCH'
.head 4 -  Set DPU_ARCHIV.nTabInstance = 1
.head 4 -  Set DPU_ARCHIV.strFilterTblName = 'DPT_U'
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE )
.head 4 -  Call XSalTooltipSetUserDefault()
.head 4 +  If DigInit() != -1
.head 5 -  Set nMaxDig=DigInit()
.head 4 -  Else
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 -  ! Щоб форма не населялася при відкритті
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  ! Call SalSetWindowText( hWndForm,  'Состояние депозитного портфеля Юр.Лиц'||
     IifS(           dfDAT != DATETIME_Null,' на '|| SalFmtFormatDateTime( dfDAT, 'dd-MM-yyyy' ),'')||
     IifS(DPU_ARCHIV.nVIDD != -1,           '. Вид депозита: '||DPU_ARCHIV.cmb_VIDD,' ' ))
.head 4 -  Call SalSetWindowText( hWndForm, 
     CurrentLangTable.GetAtomTitle( 'DPU_ARCHIV.cTWndTitle') || IifS( dfDAT != DATETIME_Null,' ' ||
     CurrentLangTable.GetAtomTitle( 'DPU_ARCHIV.cTWndTitle_')||' '|| SalFmtFormatDateTime( dfDAT, 'dd-MM-yyyy' ),'')||
     IifS(DPU_ARCHIV.nVIDD != -1, '. ' || CurrentLangTable.GetAtomTitle('cTVidd') || ': ' || DPU_ARCHIV.cmb_VIDD, ' ' ) )
.head 4 -  Set sF = ""
.head 4 -  Set sF = cF.GetFilterWhereClause(FALSE)
.head 4 +  If ( sF != "" )
.head 5 -  Set sF=" AND "|| sF
.head 4 -  !
.head 4 -  Set sF= IifS( DPU_ARCHIV.nVIDD = -1, " ", " AND dpt_u.vidd = :DPU_ARCHIV.nVIDD" ) ||
                IifS(                SalIsNull( dfDAT ), " ", " AND a.daos <= :dfDAT AND (a.dazs IS NULL OR a.dazs > :dfDAT)" ) ||
                IifS(                         dfBranch  = '-', " ", " AND dpt_u.branch = :dfBranch" ) ||
                IifS( ( (sSegmentExists = 'Y') AND ( nSegment != NUMBER_Null ) ), " AND dpt_u.segment = :DPU_ARCHIV.nSegment ", " " ) ||
                sF
.head 4 -  Set DPU_ARCHIV.strSqlPopulate = "SELECT 
                  dpt_u.branch, dpt_u.user_id, dpt_u.dpu_id, dpt_u.dpu_gen, dpt_u.dpu_add,  
                  dpt_u.nd, dpt_u.vidd, dpt_u.name, dpt_u.kv, t.lcv, t.dig,  
                  dpt_u.sum/100, dpt_u.rnk, dpt_u.nmk, dpt_u.acc, dpt_u.nls,  
                  decode(:dfDAT, TO_DATE(NULL), TO_NUMBER(NULL), nvl(fost(dpt_u.acc, :dfDAT),0)/100), 
                  dpt_u.acra,  
                  decode(:dfDAT, TO_DATE(NULL), TO_NUMBER(NULL),nvl(acrn.fproc(dpt_u.acc,:dfDAT),0)), 
                  decode(:dfDAT, TO_DATE(NULL), TO_NUMBER(NULL),nvl(fost(dpt_u.acra,:dfDAT),0)/100), 
                  dpt_u.dat_z, dpt_u.dat_n, dpt_u.dat_o, dpt_u.dat_v, nvl(dpt_u.closed, 0), dpt_u.cnt_dubl
      INTO :DPU_ARCHIV.sBRANCH, :DPU_ARCHIV.ISP, :DPU_ARCHIV.DPU_ID, :DPU_ARCHIV.DPU_GEN, :DPU_ARCHIV.DPU_ADD, 
                  :DPU_ARCHIV.ND, :DPU_ARCHIV.VIDD, :DPU_ARCHIV.NAME, :DPU_ARCHIV.KV, :DPU_ARCHIV.ISO, :DPU_ARCHIV.DIG, 
                  :DPU_ARCHIV.SUM, :DPU_ARCHIV.RNK, :DPU_ARCHIV.NMK, :DPU_ARCHIV.ACC, :DPU_ARCHIV.NLS, 
                  :DPU_ARCHIV.OST, :DPU_ARCHIV.ACCN, :DPU_ARCHIV.PROC, :DPU_ARCHIV.OSTN, 
                  :DPU_ARCHIV.DATZ, :DPU_ARCHIV.DATN, :DPU_ARCHIV.DATO, :DPU_ARCHIV.DATV, 
                  :DPU_ARCHIV.CLOSED, :DPU_ARCHIV.CNT_DUBL
   FROM  accounts a,  dpt_u,  tabval t 
 WHERE dpt_u.acc = a.acc AND t.kv = dpt_u.kv " || sF || "
 ORDER BY dpt_u.vidd, nvl(dpt_u.dpu_gen, dpt_u.dpu_id), dpt_u.dpu_add "
.head 4 -  ! Call cQ.Init( DPU_ARCHIV.strSqlPopulate )
.head 4 -  ! Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call SalTblPopulate( hWndForm, hSql(), DPU_ARCHIV.strSqlPopulate, TBL_FillAll )
.head 4 -  ! Итоговая строка
.head 4 -  Call SalTblDefineSplitWindow(hWndForm, 1 , TRUE)
.head 4 -  Call SalTblSetContext(hWndForm, SalTblInsertRow(hWndForm, TBL_MinRow))
.head 4 +  If SqlPrepareAndExecute( hSqlAux(),
"SELECT to_char(sum(decode(nvl(dpt_u.dpu_add,0),0,1,0) ) ),
                    sum(gl.p_icurval(dpt_u.kv, decode(nvl(dpt_u.dpu_add,1),0,0, fost(dpt_u.acc, :dfDAT)), :dfDAT))/100,
                    sum(gl.p_icurval(dpt_u.kv, decode(nvl(dpt_u.dpu_add,1),0,0, fost(dpt_u.acra, :dfDAT)), :dfDAT))/100
        INTO :DPU_ARCHIV.NLS, :DPU_ARCHIV.OST, :DPU_ARCHIV.OSTN
      FROM accounts a, dpt_u
  WHERE dpt_u.acc = a.acc " || sF 
) And SqlFetchNext( hSqlAux(), nFetchRes )
.head 5 -  Set NLS = 'Всього: ' || NLS
.head 5 +  If ( dfDAT != DATETIME_Null )
.head 6 -  Set nOSTs  = Dig4( OST, 2, 2 )
.head 6 -  Set nOSTNs = Dig4( OSTN, 2, 2 )
.head 5 +  Else
.head 6 -  Set nOSTs  = STRING_Null
.head 6 -  Set nOSTNs = STRING_Null
.head 4 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If SUM != NUMBER_Null
.head 5 -  Set nSUMs  = Dig4(SUM, DIG, DIG)
.head 4 +  If OST != NUMBER_Null
.head 5 -  Set nOSTs = Dig4(OST, DIG, DIG)
.head 4 +  If OSTN!= NUMBER_Null
.head 5 -  Set nOSTNs  = Dig4(OSTN, DIG, DIG)
.head 4 -  ! Раскраска закрытых в архив депозитов
.head 4 +  If CLOSED = 1
.head 5 -  Call SetTblRowColor( DPU_ARCHIV, COLOR_Periwinkle )
.head 4 -  ! Раскраска ген.и доп.соглашений
.head 4 +  If DPU_ARCHIV.DPU_ADD = 0
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Yellow )
.head 4 +  If DPU_ARCHIV.DPU_ADD > 0
.head 5 -  Call XSalTblSetCellBackColor( DPU_ARCHIV.DPU_ADD, COLOR_Yellow)
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor ( TRUE )
.head 4 +  If wParam != nLastSortRow
.head 5 -  Set nLastSortRow = wParam
.head 5 -  Set nSortOrder = TBL_SortIncreasing
.head 4 +  Else
.head 5 -  Set nSortOrder = 1 - nSortOrder
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( DPU_ARCHIV, SalTblQueryColumnID( SUM ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( DPU_ARCHIV, SalTblQueryColumnPos( SUM ), COL_GetID ))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( DPU_ARCHIV, SalTblQueryColumnID( OST ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( DPU_ARCHIV, SalTblQueryColumnPos( OST ), COL_GetID ))
.head 4 +  If SalNumberToWindowHandle(wParam)=SalTblGetColumnWindow( DPU_ARCHIV, SalTblQueryColumnID( OSTN ), COL_GetID )
.head 5 -  Set wParam=SalWindowHandleToNumber( SalTblGetColumnWindow( DPU_ARCHIV, SalTblQueryColumnPos( OSTN ), COL_GetID ))
.head 4 -  !
.head 4 -  Set hColumn = SalNumberToWindowHandle( wParam )
.head 4 -  Call SalTblSetColumnFlags( hColumn, COL_Selected, FALSE )
.head 4 -  Call SalTblSortRows( hWndForm, SalTblQueryColumnID( hColumn ), nSortOrder )
.head 4 -  Call SalSendMsg (hWndForm, SAM_RowSetContext, 0, 0 )
.head 4 -  Call SalWaitCursor ( FALSE )
.head 3 +  On SAM_Timer
.head 4 -  ! Для изменения размера окна ToolBar'а
(размер м. поменять только ПОСЛЕ CreateComplete окна)
.head 4 -  Call SalSetWindowSize(hWndToolBar, nX, 0.4)
.head 4 -  Call SalTimerKill(hWndForm, 1)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg( pbDetails, SAM_Click, 0, 0 )
.head 1 +  Table Window: DPU_ZvitFiles
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.1"
.head 4 -  Top:    1.208"
.head 4 -  Width:  14.133"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.667"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.033"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_ZvitFiles.pbIns')
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_ZvitFiles.CreateZvitQuestion'), 
                 CurrentLangTable.GetAtomTitle('cTAt'), 
                 MB_IconQuestion|MB_YesNo) = IDYES
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 +  If SqlPLSQLCommand(hSql(), "BARS.DPT_ZVIT_FILES.p_set_data2table (DPU_ZvitFiles.dfDtFile, sErr)")
.head 9 +  If sErr != STRING_Null
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_ZvitFiles.crZvitFileFailed')||sErr||"!",
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On VTM_RightClick
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, SalColorFromRGB(255, 255, 200))
.head 7 -  ! назва таблиці
.head 7 -  Call XSalTooltipShow(pbRefresh, DPU_ZvitFiles.strFilterTblName)
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 22401
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.5"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_ZvitFiles.pbPrint')
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_ZvitFiles.ExportZvitQuestion'), 
                 CurrentLangTable.GetAtomTitle('cTAt'), 
                 MB_IconQuestion|MB_YesNo) = IDYES
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 +  If SqlPLSQLCommand(hSql(), "BARS.DPT_ZVIT_FILES.p_make_flzvit (DPU_ZvitFiles.dfDtFile, nCNT, sFileName, sErr)")
   AND sErr = STRING_Null
.head 9 -  ! Створення файлу
.head 9 -  Set sFileName = GetPrnDir(  ) || '\\' || sFileName
.head 9 +  If not SalFileOpen(hFile, sFileName, OF_Create | OF_ReadWrite)
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_ZvitFiles.OpenZvitFileFailed')||sFileName||"!",
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 9 +  Else
.head 10 -  ! інформаційні рядки
.head 10 -  Set nQ = 0
.head 10 +  While nCNT > nQ
.head 11 +  If SqlPrepareAndExecute(hSql(), 
   "SELECT BARS.DPT_ZVIT_FILES.f_getTXT(:DPU_ZvitFiles.nQ)
      INTO :DPU_ZvitFiles.sFileTXT
      FROM dual")
   AND SqlFetchNext(hSql(), nFetchRes)
.head 12 -  Call SalFileWrite(hFile, DPU_ZvitFiles.sFileTXT, 2000)
.head 11 -  Set nQ = nQ + 1
.head 10 -  ! ========================================================================
.head 10 -  ! Set nQ = TBL_MinRow ! АБО nQ = 0
.head 10 +  ! While SalTblFindNextRow(DPU_ZvitFiles, nQ, 0, 0)
.head 11 -  Call SalTblSetContext(DPU_ZvitFiles, nQ)
.head 11 -  Call SalFilePutStr(hFile, PadL(DPU_ZvitFiles.sOKPO,          10) ||
                          PadL(Str(DPU_ZvitFiles.nNLS),      14) ||
                          PadL(Str(DPU_ZvitFiles.nKV),        3) ||
                          PadL(Str(DPU_ZvitFiles.nDOS),      16) ||
                          PadL(Str(DPU_ZvitFiles.nKOS),      16) ||
                          PadL(Str(DPU_ZvitFiles.nOST_D),    16) ||
                          PadL(Str(DPU_ZvitFiles.nOST_K),    16) ||
                          PadL(Str(DPU_ZvitFiles.nEQV_D),    16) ||
                          PadL(Str(DPU_ZvitFiles.nEQV_K),    16) ||
                          PadR(DtoS(DPU_ZvitFiles.dDAT_BEG),  8) ||
                          PadR(DtoS(DPU_ZvitFiles.dDAT_END),  8) ||
                          PadL(Str(DPU_ZvitFiles.nPRC),       8) ||
                          PadR(DPU_ZvitFiles.sS180,           1) ||
                          PadR(DPU_ZvitFiles.sD020,           2))
.head 10 -  ! ========================================================================
.head 10 -  Call SalFileClose(hFile)
.head 10 -  Call SqlCommit(hSql())
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_ZvitFiles.ExportDone')||" "||sFileName||"!",
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconInformation)
.head 8 +  Else
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('DPU_ZvitFiles.crZvitFileFailed')||
                   IifS(sErr != STRING_Null, "("||sErr||")", ""),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 8 -  Call SqlRollback(hSql())
.head 4 -  Line
.head 5 -  Resource Id: 22402
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.817"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 22403
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.2"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  2.2"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text: Дата звіту:
.head 5 -  Resource Id: 22404
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.333"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.238"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfDtFile
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.883"
.head 7 -  Top:    0.06"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.286"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd.MM.yyyy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 +  If SalQueryFieldEdit(hWndItem)
.head 8 -  Call SalDisableWindow ( pbPrint )
.head 2 +  Contents
.head 3 +  Column: nDPU_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: #0
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЕГРПОУ
клієнта
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № особового
рахунку
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
валюти
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nDOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дебетові
обороти
(T050)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: ###000
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nKOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кредитові
обороти
(T060)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: ###000
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nOST_D
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Актив
(Дт залишок)
(T010)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 16
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: ###000
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nOST_K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пасив
(Кт залишок)
(T020)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 16
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: ###000
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nEQV_D
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Гривневий
еквівалент
Дт
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 16
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nEQV_K
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Гривневий
еквівалент
Кт
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 16
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dDAT_BEG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
видачі
(S040)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: dDAT_END
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
повернення
(S050)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.233"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nPRC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: % ставка
(S012)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: #0000
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sS180
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Строковість
S180
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Center
.head 4 -  Width:  0.617"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sD020
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
D020
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Center
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nCNT ! к-ть секцій у файлі по 2000 символів
.head 3 -  Number: nQ
.head 3 -  Number: nFetchRes
.head 3 -  String: sErr
.head 3 -  Long String: sFileTXT
.head 3 -  String: sFileName
.head 3 -  File Handle: hFile
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('DPU_ZvitFiles.WindowTitle'))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  ! Call BankType_Init()
.head 4 -  Call SetWindowFullSize(DPU_ZvitFiles)
.head 4 -  Call SalDisableWindow ( pbPrint )
.head 4 -  Call SalSetFocus(dfDtFile)
.head 4 -  ! !!
.head 4 -  Set dfDtFile = GetBankDate()
.head 4 -  Set hWndForm.DPU_ZvitFiles.strFilterTblName = 'DPU_FLZVIT_DATA'
.head 4 -  Set hWndForm.DPU_ZvitFiles.strSqlPopulate =
" SELECT OKPO, NLS, KV, DOS/100, KOS/100, OST_D/100, OST_K/100, EQV_D/100, EQV_K/100,
         DT_BEG, DT_END, PRC_ST, S180, D020, DPU_ID
    INTO :DPU_ZvitFiles.sOKPO,   :DPU_ZvitFiles.nNLS,   :DPU_ZvitFiles.nKV,    :DPU_ZvitFiles.nDOS, :DPU_ZvitFiles.nKOS,
         :DPU_ZvitFiles.nOST_D,  :DPU_ZvitFiles.nOST_K, :DPU_ZvitFiles.nEQV_D, :DPU_ZvitFiles.nEQV_K,
         :DPU_ZvitFiles.dDAT_BEG,:DPU_ZvitFiles.dDAT_END, :DPU_ZvitFiles.nPRC,   :DPU_ZvitFiles.sS180,
         :DPU_ZvitFiles.sD020,   :DPU_ZvitFiles.nDPU_ID
    FROM DPU_FLZVIT_DATA
   WHERE file_dt = :DPU_ZvitFiles.dfDtFile
   ORDER BY NLS"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_RowHeaderClick
.head 4 -  ! Call XSalTooltipSetColors(COLOR_Blue, COLOR_LightGray)
.head 4 -  ! nRowNum = SalTblSetRow ( hWnd, nRowPos )
.head 4 -  Call XSalTooltipShow(hWndForm, Str(DPU_ZvitFiles.nDPU_ID))
.head 4 -  ! Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If SalTblAnyRows(DPU_ZvitFiles, 0, 0)
.head 5 -  Call SalEnableWindow ( pbPrint )
.head 1 +  Dialog Box: dlgPenalty
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Расчет штрафа при досрочном расторжении договора
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.357"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  ! Group Box: Подробности расчета штрафа
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    1.655"
.head 5 -  Width:  6.183"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.631"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: Подробности расчета штрафа
.head 4 -  Resource Id: 41634
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    1.65"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDetails
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Multiline Field: mlDetails
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2000
.head 5 -  String Type: Long String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.233"
.head 6 -  Top:    2.012"
.head 6 -  Width:  5.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.179"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbPrint
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledPrint
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Друк
.head 4 -  Window Location and Size
.head 5 -  Left:   2.5"
.head 5 -  Top:    4.45"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sFile = GetPrnDir() || IifS(Right(GetPrnDir(),1) = '\\', '', '\\')|| 'Shtf'||Str(nDPU_ID)||'.txt'
.head 6 -  Call SalFileOpen(fH, sFile, OF_Delete)
.head 6 +  If SalFileOpen(fH, sFile, OF_Create|OF_ReadWrite)
.head 7 -  Set sBuffer = mlDetails||PutCrLf(  )
.head 7 +  If SalFileWrite(fH, sBuffer, Len(sBuffer)) != Len(sBuffer)
.head 8 -  Call SalFileClose(fH)
.head 8 -  ! Call SalMessageBox('Ошибка записи файла '||sFile, 'Внимание!', MB_IconStop)
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlgPenalty.cTMessFileWriteErr') || ' ' || sFile, 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 8 -  Return FALSE
.head 7 -  Call SalFileClose(fH)
.head 7 -  ! Call SalMessageBox('Сформирован файл '||sFile, 'Сообщение', MB_IconInformation)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgPenalty.cTMessFileForm') || ' ' || sFile, 
     CurrentLangTable.GetAtomTitle('cTMessage'), MB_IconInformation)
.head 7 -  Call DosDirectPrint(sFile)
.head 6 +  Else
.head 7 -  ! Call SalMessageBox('Невозможно открыть файл '||sFile, 'Внимание!', MB_IconStop)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlgPenalty.cTMessFileNotOpen') || ' ' || sFile, 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop)
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Друк інформації по утриманню штрафу для клієнта' )
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Закрити
.head 4 -  Window Location and Size
.head 5 -  Left:   4.5"
.head 5 -  Top:    4.45"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgPenalty, 0 )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Відмовитися від утримання штрафу' )
.head 3 -  Background Text: Штрафная процентная ставка:
.head 4 -  Resource Id: 13177
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    0.19"
.head 5 -  Width:  4.117"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPenyaRate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPenyaRate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.2"
.head 6 -  Top:    0.167"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #00000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Начислено по договору:
.head 4 -  Resource Id: 13178
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    0.452"
.head 5 -  Width:  4.117"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFactSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFactSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.2"
.head 6 -  Top:    0.429"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Начислено по штрафной ставке:
.head 4 -  Resource Id: 13179
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    0.714"
.head 5 -  Width:  4.117"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPenyaSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPenyaSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.2"
.head 6 -  Top:    0.69"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Сумма штрафа:
.head 4 -  Resource Id: 13180
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    0.964"
.head 5 -  Width:  4.117"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDelta
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDelta
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.2"
.head 6 -  Top:    0.94"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfDeltaD = Max(0, dfDelta - nOSTN_PL/100)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Будет взыскано с депозитного счета:
.head 4 -  Resource Id: 28660
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    1.214"
.head 5 -  Width:  4.117"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDeltaD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDeltaD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.2"
.head 6 -  Top:    1.19"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Picture: picDetails
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    1.75"
.head 5 -  Width:  6.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.524"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Check Box: cbAutoShtraf
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Автоматичний розрахунок суми штрафу
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.42"
.head 5 -  Width:  5.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cbAutoShtraf
.head 7 -  Set dfDelta = ( nFACTSUM /100 - nPENYASUM / 100 )
.head 7 -  Call SalDisableWindow( dfDelta )
.head 6 +  Else
.head 7 -  Call SalEnableWindow( dfDelta )
.head 3 +  Pushbutton: pbPenalty
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Штрафувати
.head 4 -  Window Location and Size
.head 5 -  Left:   0.5"
.head 5 -  Top:    4.45"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nPenalty = ( dfDelta * 100 )
.head 6 +  If nPenalty != (nFACTSUM - nPENYASUM)
.head 7 -  Call SaveFInfoToLog( 'Змінено суму штрафу по депозитному договору ' || Str( nDPU_ID ) || ' на ' || SalNumberToStrX( dfDelta, 2 ) )
.head 6 +  If ( nPenalty > 0 )
.head 7 -  ! Выполнить проводку на взыскание штрафа на сумму ...?  
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Dog.cTMessProv' ) || " "
                || SalNumberToStrX( nPenalty/100, 2 )
                || IifS( frm_Dog.KV = GetBaseVal(), CurrentLangTable.GetAtomTitle( 'frm_Dog.cTGrn' ), frm_Dog.LCV) || " ?", 
                CurrentLangTable.GetAtomTitle( 'cTAt' ), MB_YesNo|MB_IconQuestion ) = IDYES
.head 8 -  Call SalEndDialog( dlgPenalty, 1 )
.head 6 +  Else
.head 7 -  ! Для випадків коли сума штрафу рівна нулю
.head 7 -  Call SalEndDialog( dlgPenalty, 1 )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Виконати проводки по утриманню штрафу' )
.head 6 -  ! Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'dlgPenalty.cBTipPenalty' ) )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nDPU_ID
.head 3 -  Number: nOSTN_PL
.head 3 -  Number: nFACTSUM           !! frm_Dog.nTotalIntNom
.head 3 -  Number: nPENYASUM          !! frm_Dog.nPenyaIntNom
.head 3 -  Number: nPENYARATE         !! frm_Dog.nPenyaRate
.head 3 -  Long String: sDETAILS      !! 
.head 3 -  Boolean: bChangeShtraf     !!
.head 3 -  Receive Number: nPenalty   !! frm_Dog.nPenyaAmount
.head 2 +  Window Variables
.head 3 -  String: sFile
.head 3 -  File Handle: fH
.head 3 -  String: sBuffer
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlgPenalty.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set mlDetails = sDETAILS
.head 4 -  Set dfPenyaRate = nPENYARATE
.head 4 -  Set dfFactSum = nFACTSUM / 100
.head 4 -  Set dfPenyaSum = nPENYASUM / 100
.head 4 -  Set dfDelta = nFACTSUM /100 - nPENYASUM / 100
.head 4 -  Set dfDeltaD = Max(0, dfDelta - nOSTN_PL/100)
.head 4 -  ! << >>
.head 4 -  Set cbAutoShtraf = TRUE
.head 4 +  If bChangeShtraf
.head 5 -  Call SalEnableWindow( cbAutoShtraf )
.head 4 +  Else
.head 5 -  Call SalDisableWindow( cbAutoShtraf )
.head 4 -  !
.head 4 -  Call SalSetFocus( pbPrint )
.head 3 +  On SAM_Close
.head 4 -  Return FALSE
.head 1 +  Form Window: frm_CreateDeal
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.317"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.417"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Заключення договору (Тестова версія!!!)
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Bottom
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.905"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.35"
.head 6 -  Top:    0.262"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Сохранить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle(' frm_CreateDeal.cBTipUpdate')
.head 6 +  On SAM_Click
.head 7 +  If frm_CreateDeal.nDPU_ID = NUMBER_Null
.head 8 +  If F_VALIDATE ('NumAgreem')
.head 9 -  Set frm_CreateDeal.nDPU_ID = frm_CreateDeal.f_createdeal()
.head 9 +  If frm_CreateDeal.nDPU_ID != NUMBER_Null
.head 10 -  ! Открыт депозитный договор 
.head 10 -  Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle( 'frm_CreateDeal.cTOpenDepDog')||' '||Str( frm_CreateDeal.nDPU_ID))
.head 10 -  ! Cохранение депозитного договора
.head 10 -  Call MessageNoWait(CurrentLangTable.GetAtomTitle( 'frm_CreateDeal.cTMessSaveDepDog')||' '||Str( frm_CreateDeal.nDPU_ID),
                   CurrentLangTable.GetAtomTitle('cTMessage'),
                   3,
                   0)
.head 10 -  Call SalEnableWindow ( frm_CreateDeal.pbPrint    )
.head 10 -  Call SalEnableWindow ( frm_CreateDeal.pbPasport  )
.head 10 -  Call SalEnableWindow ( frm_CreateDeal.pbAccounts )
.head 10 -  Call SalEnableWindow ( frm_CreateDeal.pbSos      )
.head 10 -  Call SalDisableWindow( dlg_DealGeneralParams.pbKlient   )
.head 10 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 10 -  ! Ошибка при открытии депозитного договора
.head 10 -  Call MessageNoWait(CurrentLangTable.GetAtomTitle( 'frm_CreateDeal.cTErrOpenDepDog')||' '|| frm_CreateDeal.sErrMsg, 
                   CurrentLangTable.GetAtomTitle('cTErr'), 
                   0, 
                   1)
.head 7 +  Else
.head 8 +  If frm_CreateDeal.f_updealparams()
.head 9 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 8 -  ! Якщо пролонгція
.head 8 -  ! If bProl
.head 8 -  ! Інакше зміна параметрів договру
.head 8 -  ! Else 
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.783"
.head 6 -  Top:    0.262"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Очистить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_CreateDeal.cBTipRefresh')
.head 6 +  On SAM_Click
.head 7 +  If frm_CreateDeal.nDPU_ID != NUMBER_Null
.head 8 +  If pDPU_GEN = NUMBER_Null
.head 9 -  Call F_HIDE_SHOW ('PREPARE')
.head 8 +  Else
.head 9 -  Call frm_CreateDeal.f_prepareagr()
.head 7 +  Else
.head 8 -  Call dlg_DealGeneralParams.f_populate()
.head 4 +  Pushbutton: pbSos
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    0.262"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Docview.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Текущее состояние договора
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_CreateDeal.cBTipSos')
.head 6 +  On SAM_Click
.head 7 +  If frm_CreateDeal.nDPU_ID != NUMBER_Null
.head 8 +  If not IsWindow(hWin6)   
.head 9 -  Set hWin6 = SalCreateWindow(frm_Dog, hWndMDI, nMode,
                            frm_CreateDeal.nDPU_ID,   frm_Open.dfND, 
                            frm_Open.pDPU_GEN,   frm_Open.dfDPUADD,
                            frm_Open.dfNMK,      frm_Open.dfKV,      frm_Open.cmbKV,
                            frm_Open.cmbFREQ,    frm_Open.dfVIDD,    frm_Open.cmbVIDD,
                            frm_Open.dfSUM,      frm_Open.dfSTOPID,  frm_Open.dfMIN_SUM,
                            frm_Open.dfDATZ,     frm_Open.dfDATN,
                            frm_Open.dfDATO,     frm_Open.dfDATV,
                            Str(frm_Open.dfMFOD),frm_Open.dfNLSD,    frm_Open.dfNMSD)
.head 8 +  Else
.head 9 -  Call SalBringWindowToTop(frm_Dog)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.517"
.head 6 -  Top:    0.262"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Печать договора
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_CreateDeal.cBTipPrint')
.head 6 +  On SAM_Click
.head 7 +  If frm_CreateDeal.nDPU_ID != NUMBER_Null
.head 8 -  Call cdoc_ShowAllDocs( frm_CreateDeal.nDPU_ID, hWndForm)
.head 4 +  Pushbutton: pbPasport
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbGetValue
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.217"
.head 6 -  Top:    0.262"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Custcorp.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Паспорт клиента
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_CreateDeal.cBTipPasport')
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull( dlg_DealGeneralParams.dfRNK)
.head 8 -  Call EditCustCorps(dlg_DealGeneralParams.dfRNK, CVIEW_ReadOnly|CVIEW_Accounts, hWndMDI)
.head 4 +  Pushbutton: pbAccounts
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSort
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    0.262"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Табличная форма счетов депозита
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_CreateDeal.cBTipAccounts')
.head 6 +  On SAM_Click
.head 7 +  If frm_CreateDeal.nDPU_ID != NUMBER_Null
.head 8 -  Call ShowAccList( dlg_DealGeneralParams.dfRNK, 
                 AVIEW_CUST,
                 AVIEW_Financial|
                 AVIEW_Linked   |
                 AVIEW_Limit    |
                 AVIEW_Special  |
                 AVIEW_Blocked  |
                 AVIEW_Interest |
                 AVIEW_NoClose,
                 " a.acc in (SELECT accid FROM dpu_accounts WHERE dpuid = "||Str( frm_CreateDeal.nDPU_ID)||")")
.head 8 -  Call SalSendMsg(pbRefresh, SAM_Click, wParam, lParam)
.head 4 +  Pushbutton: pbChilds
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.95"
.head 6 -  Top:    0.262"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Открыть доп.соглашение
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_CreateDeal.cBTipChilds')
.head 6 +  On SAM_Click
.head 7 -  ! Вы действительно хотите открыть доп.соглашение по данному договору?
.head 7 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Open.cTMessOpenQuestion'), 
                 CurrentLangTable.GetAtomTitle('cTAt'), 
                 MB_IconQuestion|MB_YesNo) = IDYES
.head 8 -  Set pDPU_GEN = frm_CreateDeal.nDPU_ID
.head 8 -  Call frm_CreateDeal.f_prepareagr()
.head 4 +  Pushbutton: pbCombine
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSwitch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.367"
.head 6 -  Top:    0.262"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\RELATION.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Изменить вида договора на комбинированный
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipCombine')
.head 6 +  On SAM_Click
.head 7 -  ! Изменить вид договора на комбинированный 
  и открыть связанный договор до востребования?
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('frm_Open.cTMessCombineQuestion1')||PutCrLf()||
                  CurrentLangTable.GetAtomTitle('frm_Open.cTMessCombineQuestion2'), 
                  CurrentLangTable.GetAtomTitle('cTAt'), 
                  MB_IconQuestion|MB_YesNo ) = IDYES
.head 8 -  Set frm_CreateDeal.nSUBDEALID =  frm_CreateDeal.f_createsubdeal()
.head 8 +  If frm_CreateDeal.nSUBDEALID > 0
.head 9 -  ! Вид депозитного договора № изменен на комбинированный,
  открыт связанный договор до востребования №  
.head 9 -  Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal1')
                         ||' '||Str( frm_CreateDeal.nDPU_ID)
                         ||CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal2')
                         ||', '
                         ||CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal3')
                         ||' '||Str( frm_CreateDeal.nSUBDEALID)
                 )
.head 9 -  Call MessageNoWait (CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal1')
                         ||' '||Str( frm_CreateDeal.nDPU_ID)
                         ||CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal2')
                         ||', '
                         ||CurrentLangTable.GetAtomTitle('frm_Open.cTCreateSubDeal3')
                         ||' '||Str( frm_CreateDeal.nSUBDEALID),
                    CurrentLangTable.GetAtomTitle('cTMessage'),
                    3,
                    0)
.head 9 -  Call SalDisableWindow(pbCombine)
.head 9 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 4 +  Pushbutton: pbDubl
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.817"
.head 6 -  Top:    0.262"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\prolong.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Пролонгація депозитного договору
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipDubl')
.head 6 +  On SAM_Click
.head 7 -  Set frm_CreateDeal.bProl = TRUE
.head 7 -  ! Дати угоди
.head 7 -  Set dlg_DealGeneralParams.dfDATN = dlg_DealGeneralParams.dfDATO
.head 7 -  Set dlg_DealGeneralParams.dfBRDAT = dlg_DealGeneralParams.dfDATO
.head 7 -  Set dlg_DealGeneralParams.dfDATO = GetCloseDate( dlg_DealGeneralParams.dfDATN, dlg_DealGeneralParams.dfTERM, dlg_DealGeneralParams.dfKV)
.head 7 -  Set dlg_DealGeneralParams.dfDATV = DptCorrectDate( dlg_DealGeneralParams.dfKV, dlg_DealGeneralParams.dfDATO, dlg_DealGeneralParams.dfDATO + 1)
.head 7 -  Set dlg_DealGeneralParams.dfKTDAY=  dlg_DealGeneralParams.F_CALC_KTDAYS(dlg_DealGeneralParams.dfDATN, dlg_DealGeneralParams.dfDATO)
.head 7 -  Set dlg_DealGeneralParams.dfIR = dlg_DealGeneralParams.f_getscalerate(dlg_DealGeneralParams.dfVIDD, dlg_DealGeneralParams.dfDATN, dlg_DealGeneralParams.dfDATO, dlg_DealGeneralParams.dfSUM, FALSE)
.head 7 -  !
.head 7 -  Call F_HIDE_SHOW ( 'ReadOnly' )
.head 7 -  Call SalDisableWindow( pbRefresh )
.head 7 -  Call SalDisableWindow( pbSos       )
.head 7 -  Call SalEnableWindow( pbUpdate  )
.head 7 -  Call SalEnableWindow(  dlg_DealGeneralParams.dfDATO     )
.head 7 -  Call SalEnableWindow( dlg_DealGeneralParams.dfDATV     )
.head 7 -  Call SalEnableWindow( dlg_DealGeneralParams.dfIR           )
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.5"
.head 6 -  Top:    0.262"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Выйти
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipCancel')
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000100
0020: 0000546162426F74 746F6D4D61726769 6E00020030000054 616250616765436F
0040: 756E740002003100 005461624C616265 6C73000100000054 61624E616D657300
0060: 0100000054616252 696768744D617267 696E000200300000 5461624472617753
0080: 74796C65000B0057 696E39355374796C 650000546162466F 726D506167657300
00A0: 0100000054616254 6F704D617267696E 0002003000005461 624F7269656E7461
00C0: 74696F6E00010000 0000000000000000 0000000000000000 00000000000000
.enddata
.data CLASSPROPSSIZE
0000: DF00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Yes
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 6 -  Set nTabNum = 0
.head 6 -  ! << Праметри угоди >>
.head 6 -  Call Create_Tab( 'tabAgreement', 'Параметри депозиту', 'dlg_DealGeneralParams' )
.head 6 -  ! << Додаткові параметри >>
.head 6 -  Call Create_Tab( 'tabAdditional', 'Додаткові параметри', 'dlg_Additional_Options' )
.head 6 -  ! ! Удаляем последнюю пустую закладку
.head 6 -  Call picTabs.Delete(nTabNum, TRUE)
.head 6 -  ! ! Показываем первую закладку
.head 6 -  ! Call GetName(nTabCurrent, sGetName)
.head 6 -  Call picTabs.BringToTop(nTabCurrent,TRUE)
.head 2 +  Functions
.head 3 +  Function: Create_Tab
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: tabName
.head 5 -  String: tabLabel
.head 5 -  String: dlgName
.head 5 -  ! cAccTab: AccTab
.head 5 -  ! Boolean: bDisableTab	! Насильно закрыть закладку для редактирования (напр., при рег. нового клиента)
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call picTabs.Insert(nTabNum, TRUE)
.head 5 -  Call picTabs.SetLabel(nTabNum, tabLabel, TRUE)
.head 5 -  Call picTabs.SetName(nTabNum, tabName)
.head 5 -  Call picTabs.CreatePage( tabName )
.head 5 -  ! Set AccTab.TabNum = nTabNum
.head 5 -  Set nTabNum = nTabNum + 1
.head 5 -  Call picTabs.AddPage( tabName, dlgName, hWndNULL)
.head 5 -  Return TRUE
.head 3 +  Function: F_HIDE_SHOW
.head 4 -  Description: Управління доступністю компонентів
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sName
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! << Управління доступністю полів для вказання отрмувача %% >>
.head 5 +  If sName = 'COMPROC'
.head 6 +  If frm_CreateDeal.nMode = 1 AND dlg_DealGeneralParams.cbCOMPROC
.head 7 -  Call SalDisableWindow( dlg_DealPayoutDetails.dfMFOP)
.head 7 -  Call SalDisableWindow( dlg_DealPayoutDetails.dfNLSP)
.head 7 -  Call SalDisableWindow( dlg_DealPayoutDetails.dfOKPOP)
.head 6 +  Else If nMode = 1 AND NOT dlg_DealGeneralParams.cbCOMPROC
.head 7 -  Call SalEnableWindow( dlg_DealPayoutDetails.dfMFOP)
.head 7 -  Call SalEnableWindow( dlg_DealPayoutDetails.dfNLSP)
.head 7 -  Call SalEnableWindow( dlg_DealPayoutDetails.dfNMSP)
.head 7 -  Call SalEnableWindow( dlg_DealPayoutDetails.dfOKPOP)
.head 6 +  Else
.head 7 -  Call SalDisableWindow( dlg_DealGeneralParams.cbCOMPROC)
.head 5 -  !
.head 5 -  ! -------------------------------- 
.head 5 -  ! открытие "пустой" карточки договора
.head 5 +  Else If sName = 'PREPARE_RATES'
.head 6 -  Set dlg_DealGeneralParams.cbIR    = TRUE
.head 6 -  Set dlg_DealGeneralParams.cbBR    = FALSE
.head 6 -  Set dlg_DealGeneralParams.dfIR    = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.dfBRDAT = GetBankDate()
.head 6 -  Set dlg_DealGeneralParams.dfBRID  = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.cmbBR   = STRING_Null
.head 6 -  Set dlg_DealGeneralParams.dfOPID  = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.cmbOP   = STRING_Null
.head 6 -  Call SalEnableWindow( dlg_DealGeneralParams.dfIR)
.head 6 -  Call SalEnableWindow( dlg_DealGeneralParams.pbIR)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbBR)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbOP)
.head 5 -  ! после выбора др.вида депозита
.head 5 +  Else If sName = 'REFRESH_RATES'
.head 6 -  ! Set dfIR    = NUMBER_Null
.head 6 -  ! Set dfBRDAT = GetBankDate()
.head 6 +  If ( dlg_DealGeneralParams.dfBRID = NUMBER_Null ) OR ( dlg_DealGeneralParams.dfBRID = 0 )
.head 7 -  Set dlg_DealGeneralParams.cbIR   = TRUE
.head 7 -  Set dlg_DealGeneralParams.cbBR   = FALSE
.head 7 -  Set dlg_DealGeneralParams.cmbBR  = STRING_Null
.head 7 -  ! Call SalEnableWindow(dfIR)
.head 7 -  ! Call SalEnableWindow(pbIR)
.head 7 -  ! Call SalDisableWindow(cmbBR)
.head 6 +  Else
.head 7 -  Set dlg_DealGeneralParams.cbBR = TRUE
.head 7 -  Set dlg_DealGeneralParams.cbIR = FALSE
.head 7 -  Set dlg_DealGeneralParams.cmbBR  = STRING_Null
.head 7 -  ! Call SalDisableWindow(dfIR)
.head 7 -  ! Call SalDisableWindow(pbIR)
.head 7 -  ! Call SalEnableWindow(cmbBR)
.head 6 -  ! Set dfOPID = NUMBER_Null
.head 6 -  ! Set cmbOP  = STRING_Null
.head 6 -  ! Call SalDisableWindow(cmbOP)
.head 5 -  ! (де)активация флагов "инд.ставка" и "баз.ставка"
.head 5 +  Else If sName = 'CLICK_RATES'
.head 6 +  If dlg_DealGeneralParams.cbIR = TRUE
.head 7 -  Call SalEnableWindow( dlg_DealGeneralParams.dfIR)
.head 7 -  Call SalEnableWindow( dlg_DealGeneralParams.pbIR)
.head 6 +  Else
.head 7 -  Set dlg_DealGeneralParams.dfIR = NUMBER_Null
.head 7 -  Call SalDisableWindow( dlg_DealGeneralParams.dfIR)
.head 7 -  Call SalDisableWindow( dlg_DealGeneralParams.pbIR)
.head 6 -  !
.head 6 +  If dlg_DealGeneralParams.cbBR = TRUE
.head 7 -  Call SalEnableWindow( dlg_DealGeneralParams.cmbBR)
.head 6 +  Else
.head 7 -  Set dlg_DealGeneralParams.dfBRID = NUMBER_Null
.head 7 -  Set dlg_DealGeneralParams.cmbBR  = STRING_Null
.head 7 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbBR)
.head 6 +  If dlg_DealGeneralParams.cbIR and dlg_DealGeneralParams.cbBR
.head 7 -  Call SalEnableWindow( dlg_DealGeneralParams.cmbOP)
.head 6 +  Else
.head 7 -  Set dlg_DealGeneralParams.dfOPID = NUMBER_Null
.head 7 -  Set dlg_DealGeneralParams.cmbOP  = STRING_Null
.head 7 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbOP)
.head 5 -  ! население карточки договора / ДС
.head 5 +  Else If sName = 'RATES'
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbIR)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbBR)
.head 6 -  !
.head 6 +  If dlg_DealGeneralParams.dfIR = NUMBER_Null
.head 7 -  Set dlg_DealGeneralParams.cbIR = FALSE
.head 7 -  Call SalDisableWindow( dlg_DealGeneralParams.dfIR)
.head 7 -  Call SalDisableWindow( dlg_DealGeneralParams.pbIR)
.head 6 +  Else
.head 7 -  Set dlg_DealGeneralParams.cbIR = TRUE
.head 7 -  Call SalEnableWindow( dlg_DealGeneralParams.dfIR)
.head 7 -  Call SalEnableWindow( dlg_DealGeneralParams.pbIR)
.head 6 -  !
.head 6 +  If ( dlg_DealGeneralParams.dfBRID = NUMBER_Null ) OR ( dlg_DealGeneralParams.dfBRID = 0 )
.head 7 -  Set dlg_DealGeneralParams.cbBR   = FALSE
.head 7 -  Set dlg_DealGeneralParams.cmbBR  = STRING_Null
.head 7 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbBR)
.head 6 +  Else
.head 7 -  Set dlg_DealGeneralParams.cbBR = TRUE
.head 7 -  Call SalEnableWindow( dlg_DealGeneralParams.cmbBR)
.head 6 -  !
.head 6 +  If dlg_DealGeneralParams.dfOPID != NUMBER_Null
.head 7 -  Call SalEnableWindow( dlg_DealGeneralParams.cmbOP)
.head 6 +  Else
.head 7 -  Set dlg_DealGeneralParams.cmbOP  = STRING_Null
.head 7 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbOP)
.head 5 -  ! -------------------------------
.head 5 -  !
.head 5 -  ! << Управління доступністю компонент для ГЕНУГОДИ>>
.head 5 +  Else If sName = 'GEN_IR'
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbCOMPROC)
.head 6 -  Set dlg_DealGeneralParams.dfIR = 0
.head 6 -  Set dlg_DealGeneralParams.cbIR = 1
.head 6 -  Set dlg_DealGeneralParams.cbBR = 0
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbIR      )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfIR      )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.pbIR      )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfBRDAT   )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbOP     )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbBR      )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbBR     )
.head 6 -  !
.head 6 -  Call SalHideWindow            ( dlg_DealGeneralParams.dfSUM     )
.head 6 -  Call SalDisableWindowAndLabel ( dlg_DealGeneralParams.bgSUM     )
.head 6 -  Call SalHideWindow            ( dlg_DealGeneralParams.dfMIN_SUM )
.head 6 -  Call SalDisableWindowAndLabel ( dlg_DealGeneralParams.bgMIN_SUM )
.head 6 -  !
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbFREQ   )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbSTOP   )
.head 6 -  ! < дати >
.head 6 -  Call SalHideWindow         ( dlg_DealGeneralParams.dfDATN )
.head 6 -  Call SalHideWindowAndLabel ( dlg_DealGeneralParams.bgDATN )
.head 6 -  Call SalHideWindow         ( dlg_DealGeneralParams.dfDATV )
.head 6 -  Call SalHideWindowAndLabel ( dlg_DealGeneralParams.bgDATV )
.head 6 -  !
.head 6 -  Call SalHideWindow         ( dlg_DealGeneralParams.dfDubl )
.head 6 -  Call SalHideWindowAndLabel ( dlg_DealGeneralParams.bgDubl )
.head 6 -  Call SalHideWindow         ( dlg_DealGeneralParams.dfKTDAY )
.head 6 -  Call SalHideWindowAndLabel ( dlg_DealGeneralParams.bgKTDAY )
.head 5 -  ! << Управління доступністю компонент при створенні ДОД.УГОДИ >>
.head 5 +  Else If sName = 'ADD_DEAL'
.head 6 -  !
.head 6 -  Call SalDisableWindow( pbPrint )
.head 6 -  Call SalDisableWindow( frm_CreateDeal.pbSos)
.head 6 -  Call SalDisableWindow( frm_CreateDeal.pbPasport)
.head 6 -  Call SalDisableWindow( frm_CreateDeal.pbAccounts)
.head 6 -  Call SalDisableWindow( frm_CreateDeal.pbChilds)
.head 6 -  Call SalDisableWindow( frm_CreateDeal.pbCombine)
.head 6 -  Call SalDisableWindow( frm_CreateDeal.pbDubl)
.head 6 -  !
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.pbKlient)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbTYPE) 
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbKV)
.head 6 -  !
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbCOMPROC)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbIR )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfIR )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.pbIR )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfBRDAT )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbOP )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbBR )
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbBR )
.head 6 -  !
.head 6 -  Call SalShowWindow                  ( dlg_DealGeneralParams.dfSUM     )
.head 6 -  Call SalEnableWindowAndLabel ( dlg_DealGeneralParams.bgSUM     )
.head 6 -  Call SalShowWindow                  ( dlg_DealGeneralParams.dfMIN_SUM )
.head 6 -  Call SalEnableWindowAndLabel ( dlg_DealGeneralParams.bgMIN_SUM )
.head 6 -  !
.head 6 -  Call SalDisableWindow   ( dlg_DealGeneralParams.cmbFREQ   )
.head 6 -  Call SalDisableWindow   ( dlg_DealGeneralParams.cmbSTOP   )
.head 6 -  ! < дати >
.head 6 -  Call SalShowWindow                ( dlg_DealGeneralParams.dfDATN )
.head 6 -  Call SalShowWindowAndLabel ( dlg_DealGeneralParams.bgDATN )
.head 6 -  Call SalShowWindow                ( dlg_DealGeneralParams.dfDATV )
.head 6 -  Call SalShowWindowAndLabel ( dlg_DealGeneralParams.bgDATV )
.head 6 -  !
.head 6 -  Call SalShowWindow                ( dlg_DealGeneralParams.dfKTDAY )
.head 6 -  Call SalShowWindowAndLabel ( dlg_DealGeneralParams.bgKTDAY )
.head 5 -  ! << >>
.head 5 +  Else If sName = 'PREPARE'
.head 6 -  Set dlg_DealGeneralParams.dfTITLE    = CurrentLangTable.GetAtomTitle('cTDepDog')
.head 6 -  Set frm_CreateDeal.nDPU_ID   = NUMBER_Null
.head 6 -  !
.head 6 -  Set dlg_DealGeneralParams.dfRNK      = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.dfOKPO     = STRING_Null
.head 6 -  Set dlg_DealGeneralParams.dfNMK      = STRING_Null
.head 6 -  Set dlg_DealGeneralParams.dfK013     = STRING_Null
.head 6 -  !
.head 6 -  Set dlg_DealGeneralParams.dfTYPEID   = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.cmbTYPE    = STRING_Null
.head 6 -  Set dlg_DealGeneralParams.dfKV       = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.dfISO      = STRING_Null
.head 6 -  Set dlg_DealGeneralParams.cmbKV      = STRING_Null
.head 6 -  Set dlg_DealGeneralParams.dfVIDD     = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.cmbVIDD    = STRING_Null
.head 6 -  !
.head 6 -  Set dlg_DealGeneralParams.dfND       = STRING_Null
.head 6 -  Set dlg_DealGeneralParams.dfSUM      = 0
.head 6 -  Set dlg_DealGeneralParams.dfMIN_SUM  = 0
.head 6 -  Set dlg_DealGeneralParams.dfFREQ     = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.cmbFREQ    = STRING_Null
.head 6 -  Set dlg_DealGeneralParams.dfSTOPID   = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.cmbSTOP    = STRING_Null
.head 6 -  !
.head 6 -  Set dlg_DealGeneralParams.dfDATZ = GetBankDate()
.head 6 -  Set dlg_DealGeneralParams.dfDATN = GetBankDate()
.head 6 -  Set dlg_DealGeneralParams.dfDATO = DATETIME_Null
.head 6 -  Set dlg_DealGeneralParams.dfDATV = DATETIME_Null
.head 6 -  !
.head 6 -  Set dlg_DealGeneralParams.cbCOMPROC  = FALSE
.head 6 -  ! *****************************
.head 6 -  Call F_HIDE_SHOW('PREPARE_RATES')
.head 6 -  ! *************************
.head 6 -  !
.head 6 -  Set dlg_DealPayoutDetails.dfMFOP     = SalStrToNumber(GetBankMfo())
.head 6 -  Set dlg_DealPayoutDetails.dfNBP      = GetBankName()
.head 6 -  Set dlg_DealPayoutDetails.dfNLSP     = STRING_Null
.head 6 -  Set dlg_DealPayoutDetails.dfNMSP     = STRING_Null
.head 6 -  Set dlg_DealPayoutDetails.dfMFOD     = SalStrToNumber(GetBankMfo())
.head 6 -  Set dlg_DealPayoutDetails.dfNBD      = GetBankName()
.head 6 -  Set dlg_DealPayoutDetails.dfNLSD     = STRING_Null
.head 6 -  Set dlg_DealPayoutDetails.dfNMSD     = STRING_Null
.head 6 -  !
.head 6 -  Set dlg_DealGeneralParams.dfBRANCH   = STRING_Null
.head 6 -  Set frm_CreateDeal.nDPU_GEN   = NUMBER_Null
.head 6 -  Set frm_CreateDeal.nDPU_ADD   = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.dfTERM     = NUMBER_Null
.head 6 -  !
.head 6 -  Call SalDisableWindow(pbPrint)
.head 6 -  Call SalDisableWindow(pbSos)
.head 6 -  Call SalDisableWindow(pbPasport)
.head 6 -  Call SalDisableWindow( pbAccounts)
.head 6 -  Call SalDisableWindow( pbChilds)
.head 6 -  Call SalDisableWindow( pbCombine)
.head 6 -  Call SalDisableWindow( pbDubl)
.head 6 -  Call SalEnableWindow( dlg_DealGeneralParams.pbKlient)
.head 6 -  !
.head 6 -  Call SalSendMsg( dlg_DealGeneralParams.cmbVIDD, SAM_User, 0, 0)
.head 5 -  ! << Для режиму тільки перегляд >>
.head 5 +  Else If sName = 'ReadOnly'
.head 6 -  Call SalDisableWindow(pbUpdate)
.head 6 -  Call SalDisableWindow(pbPasport)
.head 6 -  Call SalDisableWindow(pbAccounts)
.head 6 -  Call SalDisableWindow(pbPrint)
.head 6 -  Call SalDisableWindow(pbChilds)
.head 6 -  Call SalDisableWindow(pbCombine)
.head 6 -  Call SalDisableWindow(pbDubl)
.head 6 -  !
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfND)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfSUM)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfMIN_SUM)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbFREQ)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbSTOP)
.head 6 -  !
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbTYPE)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbKV)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbVIDD)
.head 6 -  !
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfDATZ)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfDATN)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfDATO)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfDATV)
.head 6 -  !
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbCOMPROC)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbIR)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbBR)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfBRDAT)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfIR)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbOP)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbBR)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.pbIR)
.head 6 -  !
.head 6 -  Call SalDisableWindow( dlg_DealPayoutDetails.pbCustAcc)
.head 6 -  Call SalDisableWindow( dlg_DealPayoutDetails.dfMFOP)
.head 6 -  Call SalDisableWindow( dlg_DealPayoutDetails.dfNLSP)
.head 6 -  Call SalDisableWindow( dlg_DealPayoutDetails.dfNMSP)
.head 6 -  Call SalDisableWindow( dlg_DealPayoutDetails.dfOKPOP)
.head 6 -  Call SalDisableWindow( dlg_DealPayoutDetails.dfMFOD)
.head 6 -  Call SalDisableWindow( dlg_DealPayoutDetails.dfNLSD)
.head 6 -  Call SalDisableWindow( dlg_DealPayoutDetails.dfNMSD)
.head 3 +  Function: F_VALIDATE
.head 4 -  Description: Преревірка заповнення полів
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sParName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErrorList
.head 5 -  Number: nErrorCount
.head 5 -  !
.head 5 -  Number: l_mnth
.head 5 -  Number: l_days
.head 5 -  Number: l_actrate
.head 5 -  Number: l_maxrate
.head 5 -  Number: l_recid
.head 4 +  Actions
.head 5 -  ! < Преревірка заповнення обов'язкових полів >
.head 5 +  If sParName = 'ALL'
.head 6 -  Set sErrorList = ''
.head 6 -  Set nErrorCount = 0
.head 6 -  ! sErrorList = Не заполнен реквизит <...>
.head 6 +  If SalIsNull( dlg_DealGeneralParams.dfND)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)   ||': '
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')      ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipND')||'>'||PutCrLf()
.head 6 +  If SalIsNull( dlg_DealGeneralParams.dfVIDD)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)        ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')           ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipCmbVIDD')||'>'||PutCrLf()
.head 6 +  If SalIsNull( dlg_DealGeneralParams.dfKV)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)    ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')       ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipISO')||'>'||PutCrLf()
.head 6 +  If SalIsNull( dlg_DealGeneralParams.dfSUM)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)    ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')       ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipSUM')||'>'||PutCrLf()
.head 6 +  If SalIsNull( dlg_DealGeneralParams.dfRNK)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)    ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')       ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipRNK')||'>'||PutCrLf()
.head 6 +  If SalIsNull( dlg_DealGeneralParams.dfDATZ)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)     ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')        ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipDATZ')||'>'||PutCrLf()
.head 6 +  If SalIsNull( dlg_DealGeneralParams.dfDATN)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)     ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')        ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipDATN')||'>'||PutCrLf()
.head 6 +  If SalIsNull( dlg_DealGeneralParams.dfFREQ)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')    ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipCmbFREQ_V')||'>'||PutCrLf()
.head 6 +  If SalIsNull( dlg_DealGeneralParams.dfSTOPID)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)     ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')        ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipSTOP')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dlg_DealGeneralParams.dfIR)   AND SalIsNull(dlg_DealGeneralParams.dfBRID)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)  ||': '
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')     ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cTRate')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dlg_DealPayoutDetails.dfMFOD) OR SalIsNull(dlg_DealPayoutDetails.dfNLSD) OR SalIsNull(dlg_DealPayoutDetails.dfNMSD)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  ! 'Не указаны реквизиты клиента для приема/возврата депозита'
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('frm_OpenM.cTErrListMFOD') || PutCrLf()
.head 6 +  If nErrorCount > 0
.head 7 -  ! Ошибка заполнения реквизитов
.head 7 -  Call SalMessageBox(sErrorList, 
                   CurrentLangTable.GetAtomTitle('_cTErrCheck'), 
                   MB_Ok)
.head 7 -  Return FALSE
.head 6 -  !
.head 6 +  If NOT F_VALIDATE('MaxRate')
.head 7 -  ! Введенная ставка превышает макс.допустимую ставку для договоров данного типа
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Open.cTMessCheckRateErr'), 
                   CurrentLangTable.GetAtomTitle('cTErr'), 
                   MB_Ok)
.head 7 -  Return FALSE
.head 6 -  Return TRUE
.head 5 -  ! < Перевірка: "ставка <= макс.допустимої ставки" >
.head 5 +  Else If sParName = 'MaxRate'
.head 6 -  Set l_mnth   = NUMBER_Null
.head 6 -  Set l_days   = NUMBER_Null
.head 6 +  If dlg_DealGeneralParams.dfVIDD = NUMBER_Null 
OR dlg_DealGeneralParams.dfSUM  = NUMBER_Null 
OR dlg_DealGeneralParams. dfDATN = DATETIME_Null
OR dlg_DealGeneralParams.dfDATO = DATETIME_Null
OR dlg_DealGeneralParams.dfIR   = NUMBER_Null 
OR dlg_DealGeneralParams.dfIR   = 0 
OR dlg_DealGeneralParams.dfBRID > 0
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 +  If SqlPLSQLCommand(hSql(), 
  "dpu.get_scalerate (dlg_DealGeneralParams.dfTYPEID, dlg_DealGeneralParams.dfKV, dlg_DealGeneralParams.dfVIDD,
                      dlg_DealGeneralParams.dfSUM*100, dlg_DealGeneralParams.dfDATN, dlg_DealGeneralParams.dfDATO,
                      l_mnth,    l_days,
                      l_actrate, l_maxrate, l_recid)")
.head 8 +  If l_maxrate > 0 AND dlg_DealGeneralParams.dfIR > l_maxrate
.head 9 -  Return FALSE
.head 7 -  Return TRUE
.head 5 -  ! < Проверка существования ДС с указанным номером >
.head 5 +  Else If sParName = 'NumAgreem'
.head 6 +  If frm_CreateDeal.nDPU_ID = NUMBER_Null AND pDPU_GEN != NUMBER_Null
.head 7 +  If SqlPrepareAndExecute(hSql(), 
   "SELECT count(*) 
      INTO :l_recid 
      FROM dpu_deal 
     WHERE dpu_gen = :pDPU_GEN 
       AND dpu_add = :dfND") 
AND SqlFetchNext(hSql(), nFetchRes) 
.head 8 -  ! Введенный номер доп.соглашения УЖЕ существует! Продолжить?
.head 8 +  If l_recid > 0 AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessDopSogl'), 
              CurrentLangTable.GetAtomTitle('cTAt'), 
              MB_IconQuestion|MB_YesNo ) = IDNO 
.head 9 -  Return FALSE
.head 6 -  Return TRUE
.head 5 -  ! < Перевірка введених дат >
.head 5 +  Else If sParName = 'DATO'
.head 6 +  If dlg_DealGeneralParams.dfDATO <= dlg_DealGeneralParams.dfDATN OR dlg_DealGeneralParams.dfDATO <= dlg_DealGeneralParams.dfDATZ
.head 7 -  Return FALSE
.head 6 +  ! Else If GetCloseDate(dfDATN, dfTERM, dfKV) < dfDATO
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute (hSql(), 
"SELECT dpu.date_validate ( :dlg_DealGeneralParams.dfVIDD, :dlg_DealGeneralParams.dfDATN, :dlg_DealGeneralParams.dfDATO ) INTO :nTmp FROM dual ") 
And SqlFetchNext(hSql(), nFetchRes) 
And nTmp = 1
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  ! If SqlPrepareAndExecute (hSql(), 
  "select add_months(trunc(dfDATN, 'MM'), abs(trunc(dfTERM))) + (dfDATN - trunc(dfDATN, 'MM')) + mod(dfTERM, trunc(dfTERM))*100
     into :dTmp
     from dual") 
and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  If dTmp != DATETIME_Null or dTmp >= dfDATO
.head 3 +  Function: f_createdeal
.head 4 -  Description: Открытие депозитного договора (стандарт и депозитная линия)
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: vID
.head 5 -  Number: vIR
.head 5 -  Number: vBR
.head 5 -  Number: vOP
.head 5 -  String: vND
.head 5 -  String: vMFOP
.head 5 -  String: vNLSP
.head 5 -  String: vNMSP
.head 5 -  String: vMFOD
.head 5 -  String: vNLSD
.head 5 -  String: vNMSD
.head 5 -  String: vCOMM
.head 5 -  String: vBRANCH 
.head 5 -  Number: vTRUSTID
.head 5 -  Long String: vERRMSG
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If F_VALIDATE('ALL') 
.head 6 -  Set vBR      = IifN( dlg_DealGeneralParams.cbBR AND dlg_DealGeneralParams.dfBRID != NUMBER_Null, dlg_DealGeneralParams.dfBRID, NUMBER_Null)
.head 6 -  Set vIR      = IifN( dlg_DealGeneralParams.cbIR AND dlg_DealGeneralParams.dfIR   != NUMBER_Null, dlg_DealGeneralParams.dfIR,  NUMBER_Null)
.head 6 -  Set vOP      = IifN( dlg_DealGeneralParams.cbIR AND dlg_DealGeneralParams.cbBR, dlg_DealGeneralParams. dfOPID, NUMBER_Null)
.head 6 -  Set vND      = Subs( dlg_DealGeneralParams.dfND,        1,  35)
.head 6 -  Set vMFOP    = Subs( Str( dlg_DealPayoutDetails.dfMFOP), 1, 12)
.head 6 -  Set vNLSP    = Subs( dlg_DealPayoutDetails.dfNLSP,       1, 15)
.head 6 -  Set vNMSP    = Subs( dlg_DealPayoutDetails.dfNMSP,       1, 38)
.head 6 -  Set vMFOD    = Subs( Str( dlg_DealPayoutDetails.dfMFOD), 1, 12)
.head 6 -  Set vNLSD    = Subs( dlg_DealPayoutDetails.dfNLSD,       1, 15)
.head 6 -  Set vNMSD    = Subs( dlg_DealPayoutDetails.dfNMSD,       1, 38)
.head 6 -  ! Set vCOMM    = Subs( dlg_DealPayoutDetails.dfCOMMENTS,  1, 128)
.head 6 -  Set vBRANCH  = STRING_Null
.head 6 -  Set vTRUSTID = NUMBER_Null
.head 6 -  Set vID      = NUMBER_Null
.head 6 -  !
.head 6 +  If pDPU_GEN = NUMBER_Null
.head 7 +  If NOT SqlPLSQLCommand(hSql(), "bars.dpu.p_open_standart
  (vND,
   dfRNK,
   dfVIDD,
   dfSUM,
   dfDATZ,
   dfDATN,
   dfDATO,
   dfDATV, 
   vMFOP,
   vNLSP,
   vNMSP,
   vMFOD,
   vNLSD,
   vNMSD,
   dfFREQ,
   cbCOMPROC,
   dfSTOPID,
   dfMIN_SUM,
   vIR,
   vBR,
   vOP,
   vCOMM,
   pGRP,
   pISP,
   vBRANCH,
   vTRUSTID,
   vID,
   sErrMsg)")
.head 8 -  Set vID = NUMBER_Null
.head 6 +  Else
.head 7 +  If NOT SqlPLSQLCommand(hSql(), "bars.dpu.p_open_deposit_line
  (vND,
   pDPU_GEN,
   dfRNK,
   dfVIDD,
   dfSUM,
   dfDATZ, dfDATN, dfDATO, dfDATV, 
   vMFOP,  vNLSP,  vNMSP,
   vMFOD,  vNLSD,  vNMSD,
   dfFREQ,
   cbCOMPROC,
   dfSTOPID,
   dfMIN_SUM,
   vIR,
   vBR,
   vOP,
   vCOMM,
   pGRP,
   pISP,
   vTRUSTID,
   NUMBER_Null,
   vID,
   sErrMsg)")
.head 8 -  Set vID = NUMBER_Null
.head 5 +  Else
.head 6 -  Set vID  = NUMBER_Null
.head 5 -  Return vID
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: f_updealparams
.head 4 -  Description: Изменение параметров договора
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTrustid
.head 5 -  Boolean: bOk
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If F_VALIDATE('ALL') AND SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Open.cUpdDealQuest'), 
                                   CurrentLangTable.GetAtomTitle('cTAt'), 
                                   MB_IconQuestion|MB_YesNo) = IDYES
.head 6 +  If SqlPLSQLCommand(hSql(), "dpu.upd_dealparams ( frm_CreateDeal.nDPU_ID, 
                                                frm_Open.dfND, 
                                                frm_Open.dfSUM * 100,  
                                                frm_Open.dfMIN_SUM * 100, 
                                                frm_Open.dfFREQ,  
                                                frm_Open.dfSTOPID,  
                                                frm_Open.dfDATZ,  
                                                frm_Open.dfDATN, 
                                                frm_Open.dfDATO, 
                                                frm_Open.dfDATV,
                                            Str(frm_Open.dfMFOD),
                                                frm_Open.dfNLSD,  
                                                frm_Open.dfNMSD,
                                            Str(frm_Open.dfMFOP),
                                                frm_Open.dfNLSP, 
                                                frm_Open.dfNMSP,
                                                frm_Open.dfOKPOP,
                                                frm_Open.dfIR, 
                                                frm_Open.dfOPID,  
                                                frm_Open.dfBRID,
                                                frm_Open.dfBRDAT, 
                                                frm_Open.dfBRANCH,  
                                                nTrustid,  
                                                frm_Open.dfCOMMENTS)")
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Open.cUpdDealDone'), 
                   CurrentLangTable.GetAtomTitle('cTInfo'), 
                   MB_IconInformation)
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Set bOk = TRUE
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Set bOk = FALSE
.head 5 +  Else
.head 6 -  Set bOk = FALSE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return bOk
.head 3 +  Function: f_prepareagr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT to_char( bars.dpu.f_next_add_number(d.dpu_id) )
       INTO :frm_Open.dfND        
     FROM dpu_deal  d
  WHERE d.dpu_id  = :frm_Open.pDPU_GEN")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  !
.head 6 -  Set dlg_DealGeneralParams.dfTITLE  = CurrentLangTable.GetAtomTitle('cTDopSogl')
.head 6 -  ! Set dfNLS           = STRING_Null
.head 6 -  Set frm_CreateDeal.nDPU_ID     = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.dfSUM          = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.dfMIN_SUM = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.dfBRANCH   = STRING_Null
.head 6 -  Set frm_CreateDeal.nDPU_GEN   = NUMBER_Null 
.head 6 -  Set frm_CreateDeal.nDPU_ADD   = NUMBER_Null
.head 6 -  Set dlg_DealGeneralParams.dfTERM        = NUMBER_Null
.head 6 -  !
.head 6 -  Set dlg_DealGeneralParams.dfDATZ    = GetBankDate()
.head 6 -  Set dlg_DealGeneralParams.dfDATN    = GetBankDate()
.head 6 -  !
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  !
.head 6 -  Call SalSendMsg( dlg_DealGeneralParams.cmbVIDD,  SAM_Click, 0, 0)
.head 6 -  !
.head 6 +  If sSegmentExists = 'Y'
.head 7 -  Call SalEnableWindow( dlg_DealGeneralParams.cmbVIDD        )
.head 7 -  Call F_HIDE_SHOW('ADD_DEAL')
.head 6 +  Else
.head 7 -  Call F_HIDE_SHOW('PREPARE_RATES')
.head 3 +  Function: f_createsubdeal
.head 4 -  Description: Изменение стандартного вида договора на комбинированный
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nMainDpuId
.head 5 -  Number: nDmndDpuId
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set nMainDpuId =  frm_CreateDeal.nDPU_ID
.head 5 -  Set nDmndDpuId = NUMBER_Null
.head 5 -  !
.head 5 +  If SqlPLSQLCommand(hSql(), "dpu.create_subdeal (nMainDpuId, nDmndDpuId)")
.head 6 -  Return nDmndDpuId
.head 5 +  Else
.head 6 -  Return -103
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: f_HideFields
.head 4 -  Description: ф-я для "Приховування" компонентів форми
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nTypeMask
.head 5 -  Number: nDataType
.head 5 -  ! nDataType може бути: [ DT_Number, DT_String, ...]
.head 5 -  ! nType           може бути: [TYPE_DataField | TYPE_ComboBox | TYPE_CheckBox ... ]
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndChild
.head 5 -  Number: nType
.head 4 +  Actions
.head 5 -  Set hWndChild = SalGetFirstChild ( hWndParent, nTypeMask )
.head 5 +  Loop
.head 6 +  If hWndChild = hWndNULL
.head 7 -  ! No more children to process
.head 7 -  Break
.head 6 -  Set nType = SalGetType ( hWndChild )
.head 6 +  If nType = TYPE_DataField
.head 7 -  ! Якщо не вказано тип даних то приховуємо компоненти усіх типів даних
.head 7 +  If ( ( nDataType = SalGetDataType ( hWndChild ) ) OR ( nDataType = NUMBER_Null ) )
.head 8 -  Call SalHideWindow ( hWndChild )
.head 6 -  Set hWndChild = SalGetNextChild ( hWndChild, nTypeMask )
.head 2 +  Window Parameters
.head 3 -  Window Handle: hWndParent
.head 3 -  ! nMode = 1 - инспектор (полный доступ)
.head 3 -  ! nMode = 2 - бухгалтер (только просмотр)
.head 3 -  Number: nMode
.head 3 -  Number: pDPU_ID
.head 3 -  Number: pDPU_GEN
.head 3 -  Number: pISP
.head 3 -  Number: pGRP
.head 3 -  ! pSegment - сегмент бізнесу
.head 3 -  Number: pSegment
.head 2 +  Window Variables
.head 3 -  Number: nTabNum !! << лічильник вкладок форми >>
.head 3 -  ! Number: nTabCount
.head 3 -  Number: nTabCurrent
.head 3 -  ! Number: nActivTab
.head 3 -  ! ==================
.head 3 -  String: sTmp
.head 3 -  String: sTrustId
.head 3 -  Number: nTmp
.head 3 -  Number: nFetchRes
.head 3 -  Long String: sErrMsg
.head 3 -  Boolean: bProl    !! прапорець пролонгації вкладу
.head 3 -  ! ==================
.head 3 -  Number: nDPU_ID
.head 3 -  Number: nDPU_GEN
.head 3 -  Number: nDPU_ADD
.head 3 -  Number: nSUBDEALID
.head 3 -  Number: nFlExtend !! лінія /стандарт
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle(' frm_CreateDeal.cTWndTitle'))
.head 4 -  Call PrepareWindowEx( hWndForm)
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  ! << Закладки >.
.head 4 -  Set nTabCurrent = 0
.head 4 -  !
.head 4 -  Set nDPU_ID = pDPU_ID
.head 4 -  !
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On UM_CreateDoc
.head 4 -  Call CreateDptDoc( frm_CreateDeal.nDPU_ID,  dlg_DealGeneralParams.dfVIDD)
.head 3 +  On SAM_Destroy
.head 4 +  If nMode = 1
.head 5 -  Call SalSendMsg(DPU_DEAL.pbRefresh, SAM_Click, 0, 0)
.head 1 +  Dialog Box: dlg_DealGeneralParams
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.667"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Створення додаткової угоди про зміну умов договору
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  ! ! З А Г О Л О В О К
.head 3 +  Data Field: dfTITLE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.283"
.head 6 -  Top:    0.238"
.head 6 -  Width:  9.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.24"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: bgNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  ! ! К Л И Е Н Т
.head 3 +  Picture: picClient
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.583"
.head 5 -  Width:  6.817"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.05"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Клиент
.head 4 -  Resource Id: 25711
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    0.488"
.head 5 -  Width:  1.017"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKlient
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Рег.№:
.head 4 -  Resource Id: 25712
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    0.786"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.25"
.head 6 -  Top:    0.762"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: ЄДРПОУ:
.head 4 -  Resource Id: 25713
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.3"
.head 5 -  Top:    0.786"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.55"
.head 6 -  Top:    0.762"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Наименование:
.head 4 -  Resource Id: 25714
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.048"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.25"
.head 6 -  Top:    1.036"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  ! cLabelControl: bgADRES
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  Background Text: K013:
.head 4 -  Resource Id: 25716
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.133"
.head 5 -  Top:    1.333"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfK013
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.75"
.head 6 -  Top:    1.298"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbKlient
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbFilter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.3"
.head 5 -  Top:    0.762"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.774"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Look.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Поиск клиента
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipKlient')
.head 5 +  On SAM_Click
.head 6 -  Set frm_CreateDeal.sTmp = STRING_Null
.head 6 +  If ( (sSegmentExists = 'Y') AND ( frm_CreateDeal.pSegment != NUMBER_Null ) )
.head 7 -  Call FunNSIGetFiltered("CUSTOMER",
                       "NMK",
                       " customer.DATE_OFF is NULL
                          and exists ( select 1 from customerw w where w.rnk = customer.rnk and w.tag = 'SEGM' and SubStr(value, 1, 1) = '" || Str( frm_CreateDeal.pSegment ) || "' ) ",
                       frm_CreateDeal.sTmp,
                       dfNMK)
.head 6 +  Else
.head 7 -  Call FunNSIGetFiltered("CUSTOMER",
                       "NMK",
                       " customer.date_off IS NULL AND (customer.custtype = 2 OR (customer.custtype = 3 AND substr(customer.sed, 1, 2) IN ('91', '34')))",
                       frm_CreateDeal.sTmp,
                       dfNMK)
.head 6 +  If frm_CreateDeal.sTmp != STRING_Null
.head 7 -  Set dfRNK   = NUMBER_Null
.head 7 -  Set dfOKPO  = STRING_Null
.head 7 -  Set dfK013  = STRING_Null
.head 7 +  If SqlPrepareAndExecute(hSql(),
  "SELECT c.rnk, c.okpo,
         (SELECT substr(w.value, 1, 1)
            FROM customerw w
           WHERE w.tag = 'K013'
             AND w.rnk = c.rnk)
     INTO :dfRNK, :dfOKPO, :dfK013
     FROM customer c
    WHERE c.rnk = "||frm_CreateDeal.sTmp)
and SqlFetchNext(hSql(), frm_CreateDeal.nFetchRes)
.head 8 -  Set dlg_DealPayoutDetails.dfNMSP = Subs(dfNMK, 1, 38)
.head 8 -  Set dlg_DealPayoutDetails.dfNMSD = Subs(dfNMK, 1, 38)
.head 7 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 7 -  ! ! << Якщо в картці клієнта не заповнений параметр К013 >>
.head 7 +  If SalIsNull ( dlg_DealGeneralParams.dfK013)
.head 8 -  Call SalMessageBox( "Для вибраного клєнта незаповнено параметр K013 !" || Chr(10) || "Неможливо вибрати вид депозиту !" , CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )  !! MB_OK
.head 3 -  ! ! В И Д   Д О Г О В О Р А
.head 3 +  Picture: picType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    3.667"
.head 5 -  Width:  7.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.048"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Вид договора
.head 4 -  Resource Id: 25717
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    3.571"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDealType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Продукт:
.head 4 -  Resource Id: 25718
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    3.869"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgTYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfTYPEID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.25"
.head 6 -  Top:    3.845"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbTYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.867"
.head 5 -  Top:    3.845"
.head 5 -  Width:  4.983"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: 35
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbTYPE = STRING_Null
.head 7 -  Call cmbTYPE.Init(hWndItem)
.head 7 -  Call cmbTYPE.Populate( hSql(), 'type_id', 'type_name', 'dpu_types',  'WHERE fl_active = 1 ' || IifS( ( (sSegmentExists = 'Y') AND ( frm_CreateDeal.pSegment != NUMBER_Null ) ), " AND segment = " || Str( frm_CreateDeal.pSegment ), " ") || ' order by sort_ord')
.head 7 -  Call cmbTYPE.SetSelectById(dfTYPEID)
.head 5 +  On SAM_Click
.head 6 -  Set dfTYPEID = cmbTYPE.GetKey(SalListQuerySelection(cmbTYPE))
.head 6 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 3 -  Background Text: Валюта:
.head 4 -  Resource Id: 25719
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    4.131"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.1"
.head 6 -  Top:    1.0"
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfISO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.25"
.head 6 -  Top:    4.119"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.867"
.head 5 -  Top:    4.107"
.head 5 -  Width:  4.983"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbKV = STRING_Null
.head 7 -  Call cmbKV.Init(hWndItem)
.head 7 -  Call cmbKV.Populate( hSql(), "kv", "name", "tabval",
                             " where d_close is null and kv in (select distinct kv from dpu_vidd)")
.head 7 -  Call cmbKV.SetSelectById(dfKV)
.head 5 +  On SAM_Click
.head 6 -  Set dfKV = cmbKV.GetKey(SalListQuerySelection(cmbKV))
.head 6 +  If SalIsNull(dfISO)
.head 7 -  If SqlPrepareAndExecute(hSql(),
   "SELECT lcv INTO :dfISO FROM tabval WHERE kv = :dfKV")
and SqlFetchNext(hSql(), frm_CreateDeal.nFetchRes)
.head 6 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 3 -  Background Text: Вид договора:
.head 4 -  Resource Id: 25720
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    4.405"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.25"
.head 6 -  Top:    4.381"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbVIDD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.867"
.head 5 -  Top:    4.381"
.head 5 -  Width:  4.983"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: 35
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set dfVIDD = cmbVIDD.nCurrentId
.head 6 +  If ( dfVIDD != NUMBER_Null ) And f_get_viddpar()
.head 7 -  ! << Якщо термін депозиту != 0 >>
.head 7 +  If dfTERM != 0
.head 8 -  Set dfDATO = GetCloseDate(dfDATN, dfTERM, dfKV)
.head 8 -  Set dfDATV = DptCorrectDate(dfKV, dfDATO, dfDATO + 1)
.head 8 -  Set dfKTDAY= F_CALC_KTDAYS(dfDATN, dfDATO)
.head 7 -  ! <<<< Якщо генугода >>>>
.head 7 +  If (  frm_CreateDeal.nFlExtend = 2 ) AND (  frm_CreateDeal.nDPU_GEN = NUMBER_Null )
.head 8 -  Call frm_CreateDeal.F_HIDE_SHOW('GEN_IR')
.head 7 +  Else
.head 8 -  Call frm_CreateDeal.F_HIDE_SHOW ('REFRESH_RATES')
.head 8 -  ! Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 5 +  On SAM_User
.head 6 -  Call cmbVIDD.Init(hWndItem)
.head 6 -  Call cmbVIDD.Populate( hSql(), "VIDD", "NAME", "DPU_VIDD",
" WHERE flag = 1 "
|| IifS(frm_Open.dfTYPEID!= NUMBER_Null AND frm_Open.dfTYPEID!= 0, " AND type_id = "||Str(frm_Open.dfTYPEID), "")
|| IifS(frm_Open.dfKV    != NUMBER_Null AND frm_Open.dfKV    != 0, " AND kv      = "||Str(frm_Open.dfKV),     "")
|| " AND bsd IN (SELECT nbs FROM dpu_nbs4cust WHERE k013 = " || IifS(frm_Open.dfK013  = STRING_Null, "0", frm_Open.dfK013) || ")
 ORDER BY vidd ")
.head 6 -  ! !!Call cmbVIDD.Populate(hSql(), "VIDD", "NAME", "DPU_VIDD",
  " WHERE flag = 1 "
||IifS(frm_Open.dfTYPEID!= NUMBER_Null AND frm_Open.dfTYPEID!= 0, " AND type_id = "||Str(frm_Open.dfTYPEID), "")
||IifS(frm_Open.dfKV    != NUMBER_Null AND frm_Open.dfKV    != 0, " AND kv      = "||Str(frm_Open.dfKV),     "")
||IifS(frm_Open.dfK013  != STRING_Null, " AND bsd IN (SELECT nbs FROM dpu_nbs4cust WHERE k013 = "||frm_Open.dfK013||")", "")
||" ORDER BY vidd")
.head 6 -  Call cmbVIDD.SetSelectById(dfVIDD)
.head 3 -  ! ! П А Р А М Е Т Р Ы
.head 3 +  Picture: picParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.786"
.head 5 -  Width:  6.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.56"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Параметры
.head 4 -  Resource Id: 25721
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    1.679"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Номер договору:
.head 4 -  Resource Id: 25722
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    1.988"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Royal Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.25"
.head 6 -  Top:    1.964"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If frm_CreateDeal.pDPU_GEN != NUMBER_Null AND frm_CreateDeal.nDPU_ID = NUMBER_Null AND NOT SalStrToNumber(dfND)
.head 7 -  ! Номер доп.соглашения НЕ должен содержать символы
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrNomDopSogl'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Сумма договора:
.head 4 -  Resource Id: 25723
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.25"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.25"
.head 6 -  Top:    2.226"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If frm_CreateDeal.nDPU_ID = NUMBER_Null
.head 7 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 6 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Неснижаемый остаток:
.head 4 -  Resource Id: 25724
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.488"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMIN_SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMIN_SUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.25"
.head 6 -  Top:    2.488"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfSUM  != NUMBER_Null AND
dfMIN_SUM != NUMBER_Null AND
dfMIN_SUM >  dfSUM
.head 7 -  ! Неснижаемый остаток превышает сумму по договору!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrMinSum'),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 -  Background Text: Выплата процентов:
.head 4 -  Resource Id: 25725
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.774"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFREQ_V
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFREQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.317"
.head 6 -  Top:    2.94"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbFREQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.25"
.head 5 -  Top:    2.75"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.0"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbFREQ.Init(hWndItem)
.head 6 -  Call cmbFREQ.Populate(hSql(), "FREQ", "NAME", "FREQ", "ORDER BY 1")
.head 6 -  Call cmbFREQ.SetSelectById(dfFREQ)
.head 5 +  On SAM_Click
.head 6 -  Set dfFREQ = cmbFREQ.GetKey( SalListQuerySelection(cmbFREQ))
.head 3 -  Background Text: Штраф:
.head 4 -  Resource Id: 25726
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    3.012"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSTOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSTOPID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.217"
.head 6 -  Top:    3.024"
.head 6 -  Width:  0.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSTOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.25"
.head 5 -  Top:    3.012"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.0"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbSTOP.Init(hWndItem)
.head 6 -  Call cmbSTOP.Populate(hSql(), "ID", "NAME", "DPT_STOP", "WHERE MOD_CODE = 'DPU' OR MOD_CODE IS NULL ORDER BY 1")
.head 6 -  Call cmbSTOP.SetSelectById(dfSTOPID)
.head 5 +  On SAM_Click
.head 6 -  Set dfSTOPID = cmbSTOP.GetKey(SalListQuerySelection(cmbSTOP))
.head 3 -  ! ! Д А Т Ы
.head 3 +  Picture: picDates
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.467"
.head 5 -  Top:    1.786"
.head 5 -  Width:  3.167"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.786"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Даты
.head 4 -  Resource Id: 25727
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.6"
.head 5 -  Top:    1.679"
.head 5 -  Width:  0.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Оформления:
.head 4 -  Resource Id: 25728
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    1.929"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.2"
.head 6 -  Top:    1.905"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set dfDATZ = DptCorrectDate(dfKV, dfDATZ, dfDATZ + 1)
.head 6 -  Set dfBRDAT = dfDATZ
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Начала:
.head 4 -  Resource Id: 25729
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    2.19"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Purple
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.2"
.head 6 -  Top:    2.179"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfDATN < dfDATZ
.head 7 -  ! Некорректно задана дата!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrDat'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation)
.head 7 -  Set dfDATN = DATETIME_Null
.head 7 -  Call SalSetFocus(dfDATN)
.head 6 -  Set dfDATN = DptCorrectDate(dfKV, dfDATN, dfDATN + 1)
.head 6 +  If dfTERM != 0
.head 7 -  Set dfDATO = GetCloseDate(dfDATN, dfTERM, dfKV)
.head 6 +  If frm_CreateDeal.nDPU_ID = NUMBER_Null
.head 7 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Завершения:
.head 4 -  Resource Id: 25730
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    2.452"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.2"
.head 6 -  Top:    2.44"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If NOT frm_CreateDeal.F_VALIDATE( 'DATO' )
.head 7 -  ! Некорректно задана дата!
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrDat') || IifS(dfTERM = NUMBER_Null,'', (' err term: ' || Str(dfTERM) ) ),
                                  CurrentLangTable.GetAtomTitle('cTAt'),
                                  MB_IconExclamation)
.head 7 -  Set dfDATO = DATETIME_Null
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set dfDATV = DptCorrectDate(dfKV, dfDATO, dfDATO + 1)
.head 7 +  If frm_CreateDeal.nDPU_ID = NUMBER_Null
.head 8 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 7 -  Set dfKTDAY= F_CALC_KTDAYS(dfDATN, dfDATO)
.head 7 -  Return VALIDATE_Ok
.head 3 -  Background Text: Возврата:
.head 4 -  Resource Id: 25731
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    2.714"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDATV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.2"
.head 6 -  Top:    2.714"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfDATV < dfDATO OR dfDATV < dfDATZ OR dfDATV < dfDATN
.head 7 -  ! Некорректно задана дата!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrDat'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation)
.head 7 -  Set dfDATV = DATETIME_Null
.head 7 -  Call SalSetFocus(dfDATV)
.head 6 -  Set dfDATV = DptCorrectDate(dfKV, dfDATV, dfDATV + 1)
.head 6 -  Return VALIDATE_Ok
.head 3 -  ! !
.head 3 -  Background Text: к-ть днів:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 25732
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.85"
.head 5 -  Top:    3.0"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Chartreuse
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKTDAY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKTDAY
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.2"
.head 6 -  Top:    2.976"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! !
.head 3 -  Background Text: К-ть прол.:
.head 4 -  Resource Id: 25733
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.583"
.head 5 -  Top:    3.274"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDubl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDubl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.25"
.head 6 -  Top:    3.25"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: 3D Shadow Color
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! ! П Р О Ц Е Н Т Н А Я   С Т А В К А
.head 3 +  Picture: picRate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.983"
.head 5 -  Top:    4.869"
.head 5 -  Width:  4.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: %% ставка
.head 4 -  Resource Id: 25734
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.233"
.head 5 -  Top:    4.762"
.head 5 -  Width:  1.533"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbCOMPROC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: капитализация процентов
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    4.988"
.head 5 -  Width:  3.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call frm_CreateDeal.F_HIDE_SHOW('IR')
.head 3 +  Check Box: cbIR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: инд.
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    5.286"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call frm_CreateDeal.F_HIDE_SHOW ('CLICK_RATES')
.head 3 +  Data Field: dfIR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.067"
.head 6 -  Top:    5.31"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Индивидуальная % ставка
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Open.cFTipIR'))
.head 3 +  Data Field: dfBRDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.483"
.head 6 -  Top:    5.31"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Дата установки ставки
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Open.cFTipBRDAT'))
.head 3 -  Background Text: опер.
.head 4 -  Resource Id: 25735
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    5.583"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfOPID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.2"
.head 6 -  Top:    2.333"
.head 6 -  Width:  0.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: bgOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.067"
.head 5 -  Top:    5.571"
.head 5 -  Width:  2.717"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbOP.Init(hWndItem)
.head 6 -  Call cmbOP.Populate( hSql(), "OP", "SEMANTIC", "INT_OP", " ORDER BY OP")
.head 6 -  Call cmbOP.SetSelectById(dfOPID)
.head 5 +  On SAM_Click
.head 6 -  Set dfOPID = cmbOP.GetKey(SalListQuerySelection(hWndItem))
.head 3 +  Data Field: dfBRID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   14.183"
.head 6 -  Top:    1.833"
.head 6 -  Width:  0.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Check Box: cbBR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: баз.
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    5.845"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call frm_CreateDeal.F_HIDE_SHOW ('CLICK_RATES')
.head 3 +  Combo Box: cmbBR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.067"
.head 5 -  Top:    5.833"
.head 5 -  Width:  3.783"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbBR.Init(hWndItem)
.head 6 -  Call cmbBR.Populate(hSql(), "BR_ID", "NAME", "BRATES", "ORDER BY 1")
.head 6 -  Call cmbBR.SetSelectById(dfBRID)
.head 5 +  On SAM_Click
.head 6 -  Set dfBRID = cmbBR.GetKey(SalListQuerySelection(cmbBR))
.head 3 +  Pushbutton: pbIR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.95"
.head 5 -  Top:    5.31"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Рассчитать индивидуальную % ставку
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_Open.cBTipIr')
.head 5 +  On SAM_Click
.head 6 -  Set frm_CreateDeal.nTmp = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, TRUE)
.head 6 +  If frm_CreateDeal.nTmp != NUMBER_Null AND frm_CreateDeal.nTmp != 0
.head 7 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, TRUE)
.head 3 -  ! !
.head 3 +  Data Field: dfBRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    3.333"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTERM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.7"
.head 6 -  Top:    3.083"
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.167"
.head 6 -  Top:    0.56"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: f_getscalerate
.head 4 -  Description: Расчет ставки по шкале в зав-ти от условий договора
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: p_vidd
.head 5 -  Date/Time: p_dat_open
.head 5 -  Date/Time: p_dat_clos
.head 5 -  Number: p_sum
.head 5 -  Boolean: p_raise_err
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: n_rate
.head 5 -  String: s_errmsg
.head 4 +  Actions
.head 5 -  Set n_rate   = NUMBER_Null
.head 5 -  Set s_errmsg = STRING_Null
.head 5 -  ! проверка достаточности данных
.head 5 +  If p_vidd = NUMBER_Null
.head 6 -  Set s_errmsg = CurrentLangTable.GetAtomTitle('frm_Open.cTMessCalcRateErr1')
.head 5 +  Else If p_sum = NUMBER_Null 
.head 6 -  Set s_errmsg = CurrentLangTable.GetAtomTitle('frm_Open.cTMessCalcRateErr2')
.head 5 +  Else If p_dat_open = DATETIME_Null
.head 6 -  Set s_errmsg = CurrentLangTable.GetAtomTitle('frm_Open.cTMessCalcRateErr3')
.head 5 +  Else If p_dat_clos = DATETIME_Null
.head 6 -  Set s_errmsg = CurrentLangTable.GetAtomTitle('frm_Open.cTMessCalcRateErr4')
.head 5 +  Else
.head 6 +  If SqlPrepareAndExecute(hSql(),
   "SELECT dpu.f_calc_rate("||
           Str(p_vidd)||","||
           "to_date('"||SalFmtFormatDateTime(p_dat_open,'dd/MM/yyyy')||"','dd/mm/yyyy')"||","||
           "to_date('"||SalFmtFormatDateTime(p_dat_clos,'dd/MM/yyyy')||"','dd/mm/yyyy')"||","||
           Str(p_sum*100)||")
      INTO :n_rate FROM dual")
AND NOT SqlFetchNext(hSql(), frm_CreateDeal.nFetchRes)
.head 7 -  Set n_rate = NUMBER_Null
.head 6 +  If n_rate = NUMBER_Null
.head 7 -  ! не найдена ставка для заданных условий договора
.head 7 -  Set s_errmsg = CurrentLangTable.GetAtomTitle('frm_Open.cTMessCalcRateErr0')
.head 5 -  ! возвращаем значение ставки или ошибку 
.head 5 +  If p_raise_err and s_errmsg != STRING_Null
.head 6 -  Call SalMessageBox(s_errmsg, CurrentLangTable.GetAtomTitle('cTInfo'), MB_IconAsterisk)
.head 5 +  Else
.head 6 -  Return n_rate
.head 3 +  Function: F_CALC_KTDAYS
.head 4 -  Description: вирахування к-ті днів угоди за які буде нараховано %%
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Date/Time: p_dat_beg
.head 5 -  Date/Time: p_dat_end
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nKtDays
.head 4 +  Actions
.head 5 -  Set nKtDays=(p_dat_end - p_dat_beg - IifN(dfDubl>0, 0, 1))
.head 5 -  Return nKtDays
.head 3 +  Function: f_get_viddpar
.head 4 -  Description: ф-я повертаэ параметри виду депозитного договору
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), "
SELECT dpu_types.type_id, 
               dpu_types.type_name,
               tabval.kv, tabval.lcv, tabval.name, 
               dpu_vidd.SROK,  dpu_vidd.COMPROC,  nvl(dpu_vidd.FL_EXTEND, 0),
               freq.freq,         
               freq.name,
               brates.BR_ID,
               brates.name,  
               dpt_stop.id,
               dpt_stop.name
     INTO :dfTYPEID,  :cmbTYPE,  :dfKV,  :dfISO,  :cmbKV, 
          :dfTERM,   :cbCOMPROC, :nFlExtend
          :dfFREQ,   :cmbFREQ, 
          :dfBRID,   :cmbBR,
          :dfSTOPID, :cmbSTOP     
     FROM dpu_vidd,  dpu_types,
                freq,           dpt_stop,
                tabval,       brates  
    WHERE dpu_vidd.kv      = tabval.kv 
      AND dpu_vidd.freq_v  = freq.freq
      AND dpu_vidd.id_stop = dpt_stop.id
      AND dpu_vidd.type_id = dpu_types.type_id
      AND dpu_vidd.br_id   = brates.br_id(+)
      AND dpu_vidd.vidd    = "||Str(dfVIDD) )
And SqlFetchNext(hSql(), frm_CreateDeal.nFetchRes)
.head 6 -  ! Call F_HIDE_SHOW ('REFRESH_RATES')
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: f_populate
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNdGen
.head 5 -  String: sDatGen
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), "
SELECT c.rnk, c.nmk, c.okpo, c.adr, 
         (select substr(w.value, 1, 1) from customerw w  where w.tag = 'K013' and w.rnk = c.rnk),
          p.type_id, p.type_name, v.vidd, v.name,
          t.kv, t.lcv, t.name, nvl(d.cnt_dubl, 0),
          a.nls, d.nd, d.sum*power(10,-t.dig), nvl(d.min_sum,0)*power(10,-t.dig),
          f.freq, f.name, s.id, s.name,  
          d.datz, d.dat_begin, d.dat_end, d.datv, 
          d.comproc, r.bdat, r.ir, r.op, r.br,
          d.branch, d.dpu_gen, nvl(d.dpu_add, 0), v.FL_Extend, v.SROK
     INTO :dlg_DealGeneralParams.dfRNK,  :dlg_DealGeneralParams.dfNMK,  :dlg_DealGeneralParams.dfOKPO,  :dlg_DealGeneralParams.dfK013,
                 :dlg_DealGeneralParams.dfTYPEID,  :dlg_DealGeneralParams.cmbTYPE,  :dlg_DealGeneralParams.dfVIDD,  :dlg_DealGeneralParams.cmbVIDD,
                 :dlg_DealGeneralParams.dfKV,  :dlg_DealGeneralParams.dfISO,  :dlg_DealGeneralParams.cmbKV,  :dlg_DealGeneralParams.dfDubl,
                 :dlg_DealGeneralParams.dfNLS,  :dlg_DealGeneralParams.dfND,  :dlg_DealGeneralParams.dfSUM,  :dlg_DealGeneralParams.dfMIN_SUM,
                 :dlg_DealGeneralParams.dfFREQ,  :dlg_DealGeneralParams.cmbFREQ,  :dlg_DealGeneralParams.dfSTOPID,  :dlg_DealGeneralParams.cmbSTOP,
                 :dlg_DealGeneralParams.dfDATZ,  :dlg_DealGeneralParams.dfDATN,  :dlg_DealGeneralParams.dfDATO,  :dlg_DealGeneralParams.dfDATV,
                 :dlg_DealGeneralParams.cbCOMPROC,  :dlg_DealGeneralParams.dfBRDAT,  :dlg_DealGeneralParams.dfIR,  :dlg_DealGeneralParams.dfOPID,  :dlg_DealGeneralParams.dfBRID,
                 :dlg_DealGeneralParams.dfBRANCH,  :frm_CreateDeal.nDPU_GEN,  :frm_CreateDeal.nDPU_ADD, 
                 :frm_CreateDeal.nFlExtend,  :dlg_DealGeneralParams.dfTERM
     FROM dpu_deal  d, 
          dpu_vidd  v, 
          customer  c, 
          accounts  a,
          freq      f, 
          dpt_stop  s, 
          tabval    t, 
          dpu_types p,
          int_ratn  r, 
          banks     b1, 
          banks     b2 
    WHERE d.vidd    = v.vidd
      AND d.rnk     = c.rnk
      AND d.acc     = a.acc
      AND d.freqv   = f.freq   
      AND d.id_stop = s.id 
      AND v.kv      = t.kv
      AND v.type_id = p.type_id
      AND d.mfo_d   = b1.mfo(+) 
      AND d.mfo_p   = b2.mfo(+) 
      AND (r.acc, r.id, r.bdat) = (SELECT r1.acc, r1.id, max(r1.bdat) 
                                     FROM int_ratn r1
                                    WHERE r1.acc   = d.acc 
                                      AND r1.id    = 1 
                                      AND r1.bdat <= bankdate 
                                    GROUP BY r1.acc, r1.id)
      AND d.dpu_id  = :frm_CreateDeal.nDPU_ID")
.head 6 -  Call SqlFetchNext(hSql(),  frm_CreateDeal.nFetchRes)
.head 6 -  !
.head 6 -  Call frm_CreateDeal.F_HIDE_SHOW ('RATES')
.head 6 -  Set dlg_DealGeneralParams.dfKTDAY = dlg_DealGeneralParams.F_CALC_KTDAYS(dlg_DealGeneralParams.dfDATN, dlg_DealGeneralParams.dfDATO)
.head 6 -  ! заголовок
.head 6 +  If frm_CreateDeal.nDPU_ADD = 0
.head 7 -  ! Депозитный договор № dfND (#dfDPU_ID)
.head 7 -  Set dlg_DealGeneralParams.dfTITLE = CurrentLangTable.GetAtomTitle(' frm_CreateDeal.cTWndTitle1')
           || SalStrTrimX( dlg_DealGeneralParams.dfND)
           ||'(#' || SalNumberToStrX( frm_CreateDeal.nDPU_ID, 0) || ')'
.head 7 -  ! Якщо деп.лінія
.head 7 +  If frm_CreateDeal.nFlExtend = 2
.head 8 -  Call frm_CreateDeal.F_HIDE_SHOW('GEN_IR')
.head 6 +  Else
.head 7 -  ! Доп.соглашение № dfND к договору № sNdGen от sDatGen (#dfDPU_ID)
.head 7 +  If SqlPrepareAndExecute(hSql(), 
  "SELECT trim(nd), to_char(datz,'dd/MM/yyyy') 
     INTO :sNdGen, :sDatGen
     FROM dpu_deal 
    WHERE dpu_id = : frm_CreateDeal.nDPU_GEN")
.head 8 -  Call SqlFetchNext(hSql(), frm_CreateDeal.nFetchRes)
.head 7 -  Set dlg_DealGeneralParams.dfTITLE = CurrentLangTable.GetAtomTitle(' frm_CreateDeal.cTWndTitle2')
           || dlg_DealGeneralParams.dfND
           || ' '
           || CurrentLangTable.GetAtomTitle(' frm_CreateDeal.cTWndTitle2_')
           || ' '
           || '№'
           || sNdGen
           || ' '
           || CurrentLangTable.GetAtomTitle('AcrPay.cTNaznVid')
           ||' '
           || sDatGen
           ||' '
           ||' (#'||SalNumberToStrX( frm_CreateDeal.nDPU_ID, 0)||')'
.head 6 -  !
.head 6 -  ! ===============================================
.head 6 -  ! pbCombine
.head 6 -  ! ===============================================
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfTYPEID)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbTYPE)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbKV)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfVIDD)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cmbVIDD)
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.cbCOMPROC)
.head 6 -  ! номер доп.соглашения не редактируется
.head 6 -  ! If dfDPUADD > 0
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.dfND)
.head 6 -  !
.head 6 -  Call SalDisableWindow( dlg_DealGeneralParams.pbKlient)
.head 6 -  !
.head 6 +  If frm_CreateDeal.nDPU_ADD = 0 AND frm_CreateDeal.pDPU_GEN = NUMBER_Null
.head 7 -  Call SalDisableWindow(  frm_CreateDeal.pbSos)
.head 7 -  Call SalEnableWindow(  frm_CreateDeal.pbChilds)
.head 6 +  Else
.head 7 -  Call SalEnableWindow( frm_CreateDeal.pbSos)
.head 7 -  Call SalDisableWindow( frm_CreateDeal.pbChilds)
.head 6 -  !
.head 6 -  Call SalEnableWindow( frm_CreateDeal.pbPrint)
.head 6 -  Call SalEnableWindow( frm_CreateDeal.pbPasport)
.head 6 -  Call SalEnableWindow( frm_CreateDeal.pbAccounts)
.head 6 -  !
.head 6 +  If SqlPrepareAndExecute (hSql(), 
  "select dpu.subdeal_validation("||Str(  frm_CreateDeal.nDPU_ID)||") 
     into :frm_CreateDeal.nTmp 
     from dual") 
and SqlFetchNext(hSql(),  frm_CreateDeal.nFetchRes) 
and  frm_CreateDeal.nTmp = 1
.head 7 -  Call SalEnableWindow(  frm_CreateDeal.pbCombine)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(  frm_CreateDeal.pbCombine)
.head 6 -  ! < Тільки перегляд >
.head 6 +  If ( frm_CreateDeal.nMode = 2 or  frm_CreateDeal.nMode = 3)
.head 7 -  Call frm_CreateDeal.F_HIDE_SHOW ('ReadOnly')
.head 6 +  Else
.head 7 -  ! *** < Перевірка на можливість пролонгації договру > ***
.head 7 +  If ( dlg_DealGeneralParams.dfDATO <= GetBankDate() ) AND ( dlg_DealGeneralParams.dfDATO != DATETIME_Null)
.head 8 -  Call SalEnableWindow( frm_CreateDeal.pbDubl )
.head 7 +  Else
.head 8 -  Call SalDisableWindow( frm_CreateDeal.pbDubl )
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! << Підготовка форми для створення нової угоди >>
.head 4 +  If ( frm_CreateDeal.nDPU_ID = NUMBER_Null and  frm_CreateDeal.pDPU_GEN = NUMBER_Null )
.head 5 -  Call frm_CreateDeal.F_HIDE_SHOW ('PREPARE')
.head 4 -  ! << Перегляд угоди >>
.head 4 +  Else
.head 5 -  Call f_populate()
.head 1 +  Dialog Box: dlg_Additional_Options
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.517"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.31"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Додаткові параметри депозиту
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: ФИО:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21841
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.3"
.head 5 -  Width:  2.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTRUSTFIO
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.4"
.head 6 -  Top:    0.25"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Должность:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21842
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.53"
.head 5 -  Width:  2.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTRUSTPOS
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.4"
.head 6 -  Top:    0.5"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Документ:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 21843
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.786"
.head 5 -  Width:  2.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTRUSTDOC
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.4"
.head 6 -  Top:    0.75"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbTrustee
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledChilds
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Довір.особи
.head 4 -  Window Location and Size
.head 5 -  Left:   7.95"
.head 5 -  Top:    0.5"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.488"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\CUSTPERS.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Ответственные лица клиента'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipTrustee'))
.head 5 +  On SAM_Click
.head 6 +  If nRNK != NUMBER_Null
.head 7 -  Set sTrustId = STRING_Null
.head 7 -  Call FunNSIGetFiltered( "v_trustee_allow2sign", "id", " to_char(rnk) = "||Str(nRNK), sTrustId, sTmp )
.head 7 +  If sTrustId != STRING_Null
.head 8 -  Call f_populate_Trustee( sTrustId )
.head 6 +  Else
.head 7 -  ! 'Не указан клиент!'
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessNotClient'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 3 +  Multiline Field: mlCOMMENT
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 128
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    2.774"
.head 6 -  Width:  9.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.619"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb_Save
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Зберегти
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    3.488"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_Additional_Options.cTMessSaveChange' ),
                                       CurrentLangTable.GetAtomTitle( 'cTAt' ), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 7 -  Set sComment = mlCOMMENT
.head 7 -  ! Зберігаємо додаткові параметри договору
.head 7 -  Call p_SAVE_PARAMS()
.head 7 -  ! EXIT
.head 7 -  Call SalEndDialog( dlg_Additional_Options, TRUE)
.head 3 +  Pushbutton: pb_Cancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Відмінити
.head 4 -  Window Location and Size
.head 5 -  Left:   4.8"
.head 5 -  Top:    3.488"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Red
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlg_Additional_Options, FALSE)
.head 3 -  Group Box: Коментар
.head 4 -  Resource Id: 53577
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    2.571"
.head 5 -  Width:  9.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.9"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Group Box: Довірена особа
.head 4 -  Resource Id: 53578
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.083"
.head 5 -  Width:  9.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Child Table: tblParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    1.15"
.head 6 -  Width:  9.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.4"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: col_Name
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва додаткового параметру
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  6.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col_Value
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значення
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 250
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_DoubleClick
.head 8 +  If ( col_Tag = "IS_PLEDGE" )
.head 9 -  ! Пошук кред.дог. які належать власнику депозита, або по яких він є ЗАСТАВОДАВЦЕМ
.head 9 +  If FunNSIGetFiltered( "V_CREDIT_PRODUCTS_PORTFOLIO", "CONTRACT_ID", "CLIENT_ID = " || Str( frm_Open.dfRNK ) ||
" Or CONTRACT_ID in (select ND from PLEDGED_DEPOSITS where RNK = " || Str( frm_Open.dfRNK ) || " ) ",
sTmp, col_Value )
.head 10 -  Call SalTblSetRowFlags( dlg_Additional_Options.tblParams, SalTblQueryContext( dlg_Additional_Options.tblParams ), ROW_Edited, TRUE )
.head 10 -  Set sTmp = STRING_Null
.head 7 +  On SAM_SetFocus
.head 8 +  If ( col_Tag = "IS_PLEDGE" )
.head 9 -  Set sTmp = col_Value
.head 7 +  On SAM_AnyEdit
.head 8 +  If ( ( col_Tag = "IS_PLEDGE" ) AND ( col_Value != STRING_Null ) )
.head 9 -  Set col_Value = sTmp
.head 5 +  Column: col_Tag
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col_OldVal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 250
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 -  On SAM_Create
.head 2 +  Functions
.head 3 +  Function: f_populate_Trustee
.head 4 -  Description: Населення полів даними про довірену особу
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sTrustId
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  If SqlPrepareAndExecute( hSql(),
"SELECT id, fio, position, document 
        INTO :nTrustId, :dfTRUSTFIO, :dfTRUSTPOS, :dfTRUSTDOC 
     FROM v_trustee_allow2sign  
 WHERE to_char(id) = "||sTrustId ) AND SqlFetchNext( hSql(), nFetchRes )
.head 3 +  Function: p_SAVE_PARAMS
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRowCurr
.head 5 -  Number: nND
.head 5 -  Long String: sErrMsg
.head 4 +  Actions
.head 5 -  Set nRowCurr = TBL_MinRow
.head 5 +  While SalTblFindNextRow( tblParams, nRowCurr, ROW_Edited, 0)
.head 6 -  Call SalTblSetContext( tblParams, nRowCurr )
.head 6 +  If ( tblParams.col_Value != tblParams.col_OldVal )
.head 7 +  If ( tblParams.col_Tag =  "IS_PLEDGE" )
.head 8 +  If ( tblParams.col_Value = STRING_Null)
.head 9 -  ! Розблокування депозиту
.head 9 -  Set nND = NUMBER_Null
.head 8 +  Else
.head 9 -  ! блокування депозиту
.head 9 -  Set nND = Val( tblParams.col_Value )
.head 8 +  If SqlPLSQLCommand( hSql(), "bars.DPU.BLOCK_CONTRACT( frm_Open.dfDPU_ID, nND, sErrMsg )" ) AND ( sErrMsg = STRING_Null )
.head 9 -  Call SqlCommit( hSql() )
.head 8 +  Else
.head 9 -  Call SqlRollbackEx( hSql(), sErrMsg )
.head 9 -  Call MessageError( sErrMsg )
.head 7 +  Else
.head 8 +  If SqlPLSQLCommand( hSql(), "bars.DPU.set_parameters( frm_Open.dfDPU_ID, tblParams.col_Tag, tblParams.col_Value )" )
.head 9 -  Call SqlCommit( hSql() )
.head 8 +  Else
.head 9 -  Call SqlRollback( hSql() )
.head 3 +  Function: f_populate_Params
.head 4 -  Description: Населяєм таблицю дод. параметрів
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  When SqlError
.head 6 -  Call SalDisableWindow( tblParams )
.head 6 -  Return FALSE
.head 5 +  If SalTblPopulate( tblParams, hSql(),
"SELECT  f.tag, f.name, w.value, w.value
        INTO  :tblParams.col_Tag, :tblParams.col_Name, :tblParams.col_Value, :tblParams.col_OldVal
      FROM  bars.dpu_deal_field f
        LEFT OUTER JOIN bars.dpu_dealw w ON (w.tag = f.tag and  w.dpu_id =  :frm_Open.dfDPU_ID )
", TBL_FillAll )
.head 6 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nRNK
.head 3 -  Receive String: sComment
.head 3 -  Receive Number: nTrustId
.head 2 +  Window Variables
.head 3 -  String: sTrustId
.head 3 -  String: sTmp
.head 3 -  Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle( 'dlg_Additional_Options.cTWndTitle' ) )
.head 4 -  Call PrepareWindowEx( hWndForm )
.head 4 +  If nMode != 1
.head 5 -  Call SalDisableWindow( pbTrustee )
.head 5 -  Call SalDisableWindow( mlCOMMENT )
.head 5 -  Call SalHideWindow( pb_Save )
.head 5 -  Call SalHideWindow( pb_Cancel )
.head 4 -  ! < Довірені особи >
.head 4 +  If nTrustId = 0
.head 5 -  Call SalEnableWindow( pbTrustee )
.head 4 +  Else
.head 5 -  Call SalDisableWindow( pbTrustee )
.head 5 -  Call f_populate_Trustee( SalNumberToStrX(nTrustId, 0) )
.head 4 -  Set mlCOMMENT = sComment
.head 4 -  ! Населяєм таблицю дод. параметрів
.head 4 -  Call f_populate_Params()
.head 4 -  Call SalCenterWindow( hWndForm )
.head 1 +  Dialog Box: dlg_DealPayoutDetails
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  11.1"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.048"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  ! ! В И П Л А Т А   В І Д С О Т К І В
.head 3 +  Picture: picIntPay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.179"
.head 5 -  Width:  9.683"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbCustAcc
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.983"
.head 5 -  Top:    2.155"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Текущие счета клиента'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipCustAcc'))
.head 5 +  On SAM_Click
.head 6 +  If dlg_DealGeneralParams.dfRNK != NUMBER_Null AND dlg_DealGeneralParams.dfKV != NUMBER_Null
.head 7 -  ! 'Выбрать из справочника текущий счет клиента?'
.head 7 +  If SalMessageBox(
   CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessGetAcc'),
   CurrentLangTable.GetAtomTitle('cTAt'),
   MB_IconQuestion|MB_YesNo) = IDYES
.head 8 -  ! Set sAccId = STRING_Null
.head 8 -  Call FunNSIGetFiltered ("ACCOUNTS", "NLS", "RNK = " || Str(dlg_DealGeneralParams.dfRNK) ||" and NBS in ('2520','2523','2600','2650') and ACCOUNTS.KV = "
|| Str( dlg_DealGeneralParams.dfKV ), frm_CreateDeal.sTmp, dfNLSD)
.head 8 -  Set dfMFOP = Val(GetBankMfo())
.head 8 -  ! =====================
.head 8 +  If ( frm_CreateDeal.sTmp != STRING_Null ) AND ( NOT dlg_DealGeneralParams. cbCOMPROC )
.head 9 -  ! 'Занести выбране значення в параметри для виплаты %% ?'
.head 9 +  If SalMessageBox ( CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessSetDen'),
                               CurrentLangTable.GetAtomTitle('cTAt'),
                               MB_IconQuestion|MB_YesNo) = IDYES
.head 10 -  Set dfMFOP = dfMFOD
.head 10 -  Set dfNLSP = dfNLSD
.head 10 -  Set dfNMSP = dfNMSD
.head 10 -  Set dfNBP  = dfNBD
.head 6 +  Else
.head 7 -  ! IifS(dfRNK = NUMBER_Null, 'Не указан клиент!', 'Не указана валюта!')
.head 7 -  Call SalMessageBox
(IifS(dlg_DealGeneralParams.dfRNK = NUMBER_Null,
CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessNotClient'),
CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessNotKv')),
CurrentLangTable.GetAtomTitle('cTAt'),
 MB_IconExclamation)
.head 3 -  Background Text: Виплата відсотків
.head 4 -  Resource Id: 25736
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    0.071"
.head 5 -  Width:  2.617"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgReceiverP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: МФО:
.head 4 -  Resource Id: 25737
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.31"
.head 5 -  Width:  0.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMFOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.24"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfMFOP = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If NOT SalIsValidNumber( dfMFOP )
.head 7 -  Set dfMFOP = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If NOT SqlPrepareAndExecute( hSql(),
   "SELECT nb INTO :dfNBP FROM banks WHERE mfo = "||Str(dfMFOP))
OR NOT SqlFetchNext(hSql(), frm_CreateDeal.nFetchRes)
.head 7 -  Set dfNLSP = ''
.head 7 -  Set dfMFOP = NUMBER_Null
.head 7 -  ! Не нашли банка с МФО dfMFOP
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrMfo') ||' '||Str(dfMFOP),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation)
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set dfNLSP = ''
.head 6 +  If dfMFOP != Val(GetBankMfo())
.head 7 -  Call SalEnableWindow(dfNMSP)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Назва банку:
.head 4 -  Resource Id: 25738
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.45"
.head 5 -  Top:    0.31"
.head 5 -  Width:  1.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNBP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.4"
.head 6 -  Top:    0.512"
.head 6 -  Width:  5.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Рахунок:
.head 4 -  Resource Id: 25739
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.893"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    1.095"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfNLSP != ''
.head 7 +  If Vkrz2(Str(dfMFOP),dfNLSP) != dfNLSP
.head 8 -  ! Ошибка в контрольном разряде счета!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAcc'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation)
.head 8 -  Set dfNLSP = ''
.head 7 +  Else
.head 8 +  If dfMFOP = Val(GetBankMfo())
.head 9 +  If SqlPrepareAndExecute( hSql(),
   "SELECT a.rnk, substr(a.nms, 1, 38)
      INTO :nTmp, :dfNMSP
      FROM accounts a
     WHERE a.kv  = :dfKV
       AND a.nls = :dfNLSP
       AND a.dazs is null" )
and not SqlFetchNext(hSql(), frm_CreateDeal.nFetchRes)
.head 10 -  ! Счет не открыт!
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAccNotOpen'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation )
.head 10 -  Set dfNLSP = ''
.head 9 +  Else
.head 10 -  ! Счет открыт на другого клиента! Продолжить?
.head 10 +  If dlg_DealGeneralParams.dfRNK != frm_CreateDeal.nTmp AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessAccRnk'),
              CurrentLangTable.GetAtomTitle('cTAt'),
              MB_IconQuestion|MB_YesNo) = IDNO
.head 11 -  Set dfNLSP = ''
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Отримувач:
.head 4 -  Resource Id: 25740
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.35"
.head 5 -  Top:    0.81"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNAMEP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNMSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    1.012"
.head 6 -  Width:  5.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: ЄДРПОУ:
.head 4 -  Resource Id: 25741
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.95"
.head 5 -  Top:    0.893"
.head 5 -  Width:  1.333"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOKPOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOKPOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.883"
.head 6 -  Top:    1.095"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! ! В О З В Р А Т   Д Е П О З И Т А
.head 3 +  Picture: picDepPay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.702"
.head 5 -  Width:  10.183"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.119"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Повернення депозиту
.head 4 -  Resource Id: 25742
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    1.595"
.head 5 -  Width:  2.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgReceiverD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: МФО:
.head 4 -  Resource Id: 25743
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.845"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMFOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.24"
.head 6 -  Top:    2.048"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfMFOD = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If NOT SalIsValidNumber(dfMFOD)
.head 7 -  Set dfMFOP = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 +  If NOT SqlPrepareAndExecute( hSql(),
   "SELECT nb INTO :dfNBD FROM banks WHERE mfo = "||Str(dfMFOD))
OR NOT SqlFetchNext(hSql(), frm_CreateDeal.nFetchRes)
.head 7 -  Set dfNLSD = ''
.head 7 -  Set dfMFOD = NUMBER_Null
.head 7 -  ! Не нашли банка с МФО dfMFOD
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrMfo') ||' '||Str(dfMFOD),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation)
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set dfNLSD = ''
.head 6 +  If dfMFOD != Val(GetBankMfo())
.head 7 -  Call SalEnableWindow(dfNMSD)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Назва банку:
.head 4 -  Resource Id: 25744
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.45"
.head 5 -  Top:    1.845"
.head 5 -  Width:  1.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.4"
.head 6 -  Top:    2.048"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Рахунок:
.head 4 -  Resource Id: 25745
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    2.262"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    2.464"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfNLSD != ''
.head 7 +  If Vkrz2(Str(dfMFOD),dfNLSD) != dfNLSD
.head 8 -  ! Ошибка в контрольном разряде счета!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAcc'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation)
.head 8 -  Set dfNLSD = ''
.head 7 +  Else
.head 8 +  If dfMFOD = Val(GetBankMfo())
.head 9 +  If SqlPrepareAndExecute( hSql(),
   "SELECT a.rnk, substr(a.nms, 1, 38)
      INTO :nTmp, :dfNMSD
      FROM accounts a
     WHERE a.kv  = :dfKV
       AND a.nls = :dfNLSD
       AND a.dazs is null")
and not SqlFetchNext( hSql(), frm_CreateDeal.nFetchRes)
.head 10 -  ! Счет не открыт!
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAccNotOpen'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation)
.head 10 -  Set dfNLSD = ''
.head 9 +  Else
.head 10 -  ! Счет открыт на другого клиента! Продолжить?
.head 10 +  If dlg_DealGeneralParams.dfRNK != frm_CreateDeal.nTmp AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessAccRnk'),
              CurrentLangTable.GetAtomTitle('cTAt'),
              MB_IconQuestion|MB_YesNo) = IDNO
.head 11 -  Set dfNLSD = ''
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Отримувач:
.head 4 -  Resource Id: 25746
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.25"
.head 5 -  Top:    2.262"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNAMED
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNMSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    2.464"
.head 6 -  Width:  5.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.26"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! ! К О М М Е Н Т А Р И Й
.head 3 +  Data Field: bgCOMMENTS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb_Save
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Зберегти
.head 4 -  Window Location and Size
.head 5 -  Left:   0.067"
.head 5 -  Top:    3.095"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlg_Additional_Options, TRUE)
.head 3 +  Pushbutton: pb_Cancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Відмінити
.head 4 -  Window Location and Size
.head 5 -  Left:   4.767"
.head 5 -  Top:    3.095"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Red
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlg_Additional_Options, FALSE)
.head 2 +  Functions
.head 3 +  Function: f_populate
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNdGen
.head 5 -  String: sDatGen
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(), "
SELECT d.mfo_d, b1.nb, d.nls_d, d.nms_d, 
                  d.mfo_p, b2.nb, d.nls_p, d.nms_p, nvl(d.okpo_p, c.okpo),  
                  d.comments
     INT  :dlg_DealPayoutDetails.dfMFOD,  :dlg_DealPayoutDetails.dfNBD,  :dlg_DealPayoutDetails.dfNLSD,  :dlg_DealPayoutDetails.dfNMSD, 
                 :dlg_DealPayoutDetails.dfMFOP,  :dlg_DealPayoutDetails.dfNBP,  :dlg_DealPayoutDetails.dfNLSP,  :dlg_DealPayoutDetails.dfNMSP,  :dlg_DealPayoutDetails.dfOKPOP, 
                 :dlg_DealPayoutDetails.dfCOMMENTS
     FROM dpu_deal  d
    WHERE d.dpu_id  = :frm_CreateDeal.nDPU_ID")
.head 6 -  Call SqlFetchNext(hSql(), frm_CreateDeal.nFetchRes)
.head 6 -  ! Управління доступністю полів для вказання отрмувача %%
.head 6 -  Call frm_CreateDeal.F_HIDE_SHOW( 'COMPROC' )
.head 6 -  ! < Тільки перегляд >
.head 6 +  If ( frm_CreateDeal.nMode = 2 or  frm_CreateDeal.nMode = 3)
.head 7 -  Call frm_CreateDeal.F_HIDE_SHOW ('ReadOnly')
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 -  Message Actions
.head 1 +  Form Window: frm_Product
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   2.188"
.head 4 -  Top:    1.823"
.head 4 -  Width:  11.1"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.024"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.5"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.15"
.head 6 -  Top:    0.1"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Обновить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pbRefresh' )
.head 6 +  On SAM_Click
.head 7 -  Call frm_Product.F_POPULATE()
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.65"
.head 6 -  Top:    0.1"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pbUpdate' )
.head 6 +  On SAM_Click
.head 7 +  If ( ( dfMETR != 0 ) AND ( SalIsNull( dfBRID ) ) )
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessErrorBRID' ),
                    CurrentLangTable.GetAtomTitle( 'cTErr' ),  MB_IconStop )
.head 7 +  Else If ( SalIsNull( dfSHABLON ) )
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessErrorSHABLON' ),
                    CurrentLangTable.GetAtomTitle( 'cTErr' ),  MB_IconStop )
.head 7 +  Else
.head 8 +  If SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.pbUpdate' ) || '?',
                  CurrentLangTable.GetAtomTitle( 'cTAt' ), MB_IconQuestion | MB_YesNo) = IDYES
.head 9 -  Call p_SAVE( )
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.0"
.head 6 -  Top:    0.1"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Завершить
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pbCancel' )
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Pushbutton: pbExport
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.15"
.head 6 -  Top:    0.1"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\saved.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! экспорт в SQL-сценарий
.head 7 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_Product.pbExport' ) )
.head 6 +  On SAM_Click
.head 7 -  Call p_GenScript( )
.head 4 +  Pushbutton: pbDetail
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.15"
.head 6 -  Top:    0.1"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call FunNSIEditFFiltered( "DPU_TYPES_OB22", 0, " DPU_TYPES_OB22.TYPE_ID =  " || Str( dfTYPE_CODE ) )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pbDetail' )
.head 4 +  Pushbutton: pbPercent
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.65"
.head 6 -  Top:    0.1"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\A_PROC.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pbPercent' )
.head 6 +  On SAM_Click
.head 7 -  Call FunNSIEditFFiltered( "DPU_VIDD_RATE", 0, "DPU_VIDD_RATE.TYPE_ID =  " || Str( dfTYPE_CODE ) )
.head 4 +  Pushbutton: pbSynchronize
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.65"
.head 6 -  Top:    0.1"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Синхронізація параметрів продукту з видами депозитів
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pbSynchronize' )
.head 6 +  On SAM_Click
.head 7 -  Call p_SyncVidds()
.head 4 +  Pushbutton: pbListActiveVidds
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.15"
.head 6 -  Top:    0.1"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Список активних видів депозитів продукту
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pbListActiveVidds' )
.head 6 +  On SAM_Click
.head 7 -  Call FunNSIEditFFiltered( "DPU_VIDD", 1, "DPU_VIDD.TYPE_ID =  " || Str( dfTYPE_CODE ) || " AND DPU_VIDD.FLAG = 1" )
.head 4 +  Pushbutton: pbVERSION
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbHelp
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.15"
.head 6 -  Top:    0.1"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call get_LibraryVersion()
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 5461624F7269656E 746174696F6E0001 000000546162546F 704D617267696E00
0020: 0200300000546162 466F726D50616765 7300030009090000 5461624472617753
0040: 74796C65000B0057 696E39355374796C 6500005461625269 6768744D61726769
0060: 6E00020030000054 61624E616D657300 12004E616D653009 4E616D6531094E61
0080: 6D65320000546162 4C6162656C730026 0050726F64756374 5F4F7074696F6E73
00A0: 0950726F64756374 5F0950726F647563 745F5465726D0000 5461625061676543
00C0: 6F756E7400020031 0000546162426F74 746F6D4D61726769 6E00020030000054
00E0: 616243757272656E 740006004E616D65 3200005461624C65 66744D617267696E
0100: 0002003000000000 0000000000000000 0000000000000000 00000000
.enddata
.data CLASSPROPSSIZE
0000: 1C01
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Yes
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call picTabs.SetLabel(0, ' ' || CurrentLangTable.GetAtomTitle( 'frm_Product.cTab0' ) || ' ', TRUE)
.head 6 -  Call picTabs.SetLabel(1, ' ' || CurrentLangTable.GetAtomTitle( 'frm_Product.cTab1' ) || ' ', TRUE)
.head 6 -  Call picTabs.SetLabel(2, ' ' || CurrentLangTable.GetAtomTitle( 'frm_Product.cTab2' ) || ' ', TRUE)
.head 6 -  Call picTabs.BringToTop( 0,TRUE )
.head 3 -  Background Text: Продукт (тип депозиту)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 16996
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.4"
.head 5 -  Width:  3.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTYPE_CODE
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    0.595"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Код продукту
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Product.cFTipTypeCode') )
.head 3 +  Data Field: dfTYPE_NAME
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.533"
.head 6 -  Top:    0.595"
.head 6 -  Width:  8.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Назва продукту
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Product.cFTipTypeName') )
.head 3 -  Background Text: Суми договору
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 16997
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.05"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: MIN. сума депозиту:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 16998
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.37"
.head 5 -  Top:    1.298"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSUM_MIN
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    1.25"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfSUM_MIN <= 0 OR SalIsNull( dfSUM_MIN )
.head 7 -  ! Мінімальна сума не може бути меншою або рівною нулю
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Product.cTErrMinSum'),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If dfSUM_MAX > 0 AND dfSUM_MIN > 0 AND dfSUM_MAX < dfSUM_MIN
.head 7 -  ! Максимальная сумма не может быть меньше минимальной!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle( 'frm_Product.cTErrMinMaxSum' ),
                   CurrentLangTable.GetAtomTitle('cTErr'),
                   MB_IconStop)
.head 7 -  Return VALIDATE_Cancel
.head 3 -  Background Text: MAX. сума депозиту:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 16999
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    1.65"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSUM_MAX
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    1.6"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfSUM_MAX > 0 AND dfSUM_MIN > 0 AND dfSUM_MAX < dfSUM_MIN
.head 7 -  ! Максимальная сумма не может быть меньше минимальной!
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTErrMinMaxSum' ),
                                            CurrentLangTable.GetAtomTitle( 'cTErr' ),  MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 3 -  Background Text: Поповнення
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17005
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.55"
.head 5 -  Top:    1.05"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: MIN. сума поповнення:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17006
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.55"
.head 5 -  Top:    1.65"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSUM_ADD
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.4"
.head 6 -  Top:    1.6"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Validate
.head 6 -  Set nMinSumAdd = dfMINSUMADD * 100
.head 3 +  Check Box: chkAdd
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Поповнення депозиту
.head 4 -  Window Location and Size
.head 5 -  Left:   5.7"
.head 5 -  Top:    1.25"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_SET_AVAILABILITY( 'ADDITION' )
.head 3 -  Background Text: Базова ставка відсотка:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17007
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.37"
.head 5 -  Top:    2.988"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfBRID
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    2.929"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbBRATE
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.4"
.head 5 -  Top:    2.929"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.631"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbBRATE.Init(hWndItem)
.head 6 -  Call cmbBRATE.Populate(hSql(), "BR_ID", "NAME", "BRATES", "WHERE BR_ID > 0 ORDER BY 1")
.head 6 -  Call cmbBRATE.Add(NUMBER_Null, '')
.head 6 -  Call cmbBRATE.SetSelectById(NUMBER_Null)
.head 6 -  Call cmbBRATE.SetSelectById(dfBRID)
.head 5 +  On SAM_Click
.head 6 -  Set dfBRID = cmbBRATE.GetKey(SalListQuerySelection(cmbBRATE))
.head 6 +  If cmbBRATE = STRING_Null
.head 7 -  Set dfBRID = NUMBER_Null
.head 3 -  Background Text: Штраф за дострокове розірвання:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17008
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.37"
.head 5 -  Top:    2.286"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSTOPID
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    2.238"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSTOP
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.4"
.head 5 -  Top:    2.238"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.631"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbSTOP.Init(hWndItem)
.head 6 -  Call cmbSTOP.Populate(hSql(), "ID", "NAME", "DPT_STOP", "WHERE MOD_CODE = 'DPU' OR MOD_CODE IS NULL ORDER BY 1")
.head 6 -  Call cmbSTOP.SetSelectById(dfSTOPID)
.head 5 +  On SAM_Click
.head 6 -  Set dfSTOPID = cmbSTOP.GetKey(SalListQuerySelection(cmbSTOP))
.head 3 +  Check Box: chkAutoExt
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Автопролонгація
.head 4 -  Window Location and Size
.head 5 -  Left:   3.4"
.head 5 -  Top:    3.274"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call F_SET_AVAILABILITY( 'PROLONGATION' )
.head 3 +  Check Box: chkComproc
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Капіталізація відсотків
.head 4 -  Window Location and Size
.head 5 -  Left:   6.833"
.head 5 -  Top:    3.274"
.head 5 -  Width:  3.217"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Метод переоформлення:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17009
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.37"
.head 5 -  Top:    3.631"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfMETHOD
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    3.583"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbMETHOD
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.4"
.head 5 -  Top:    3.583"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.631"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbMETHOD.Init(hWndItem)
.head 6 -  Call cmbMETHOD.Populate(hSql(), "METHOD", "NAME", "DPT_EXTENSION_METHOD", "ORDER BY 1")
.head 6 -  Call cmbMETHOD.SetSelectById( dfMETHOD )
.head 5 +  On SAM_Click
.head 6 -  Set dfMETHOD = cmbMETHOD.GetKey(SalListQuerySelection(cmbMETHOD))
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17011
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.15"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.85"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17012
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    2.131"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.9"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Метод нарахування відсотків:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 12746
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.37"
.head 5 -  Top:    2.631"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfMETR
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.4"
.head 6 -  Top:    2.583"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbMETR
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.4"
.head 5 -  Top:    2.583"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.44"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbMETR.Init(hWndItem)
.head 6 -  Call cmbMETR.Populate(hSql(),"METR", "NAME", "INT_METR", "WHERE METR in ( 0, 1 ) ORDER BY 1")
.head 6 -  Call cmbMETR.SetSelectById(dfMETR)
.head 5 +  On SAM_Click
.head 6 -  Set dfMETR = cmbMETR.GetKey(SalListQuerySelection(cmbMETR))
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17014
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.5"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17016
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.45"
.head 5 -  Top:    1.15"
.head 5 -  Width:  4.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.85"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Child Table: tblCurrencyUsed
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    0.65"
.head 6 -  Width:  4.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.16"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: col_KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Child Table: tblCurAvailable
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.6"
.head 6 -  Top:    0.65"
.head 6 -  Width:  4.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.16"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: col_KV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 35
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 -  Frame
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Resource Id: 17017
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.5"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Валюта продукту
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 17018
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.4"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb_CurrADD
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.05"
.head 5 -  Top:    0.8"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Arr2tol.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Додати обрану валютe до продукту
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pb_CurrADD' )
.head 5 +  On SAM_Click
.head 6 -  Set nRowCurr = TBL_MinRow
.head 6 +  While SalTblFindNextRow( tblCurAvailable, nRowCurr, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext( tblCurAvailable, nRowCurr )
.head 7 +  If SqlPrepareAndExecute( hSql(),
"INSERT INTO bars.DPU_TYPES_CURRENCY ( TYPE_ID, CURR_ID )
 VALUES ( :dfTYPE_CODE, :tblCurAvailable.col_KV ) " )
.head 8 -  Call SqlCommitEx( hSql(), "Додано валюту з кодом " || Str(tblCurAvailable.col_KV) || " до продукту № " || Str( dfTYPE_CODE ) )
.head 7 +  Else
.head 8 -  Call SqlRollback( hSql() )
.head 6 -  Call F_CURRENCY()
.head 3 +  Pushbutton: pb_CurrDEL
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.05"
.head 5 -  Top:    1.3"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\ARR1TOR.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Вилучити валюти з продукту
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pb_CurrDEL' )
.head 5 +  On SAM_Click
.head 6 -  Set nRowCurr = TBL_MinRow
.head 6 +  While SalTblFindNextRow( tblCurrencyUsed, nRowCurr, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext( tblCurrencyUsed, nRowCurr )
.head 7 +  If SqlPrepareAndExecute( hSql(),
"DELETE FROM bars.DPU_TYPES_CURRENCY WHERE TYPE_ID = :dfTYPE_CODE AND CURR_ID = :tblCurrencyUsed.col_KV" )
.head 8 -  Call SqlCommitEx( hSql(), "Вилучено валюту з кодом " || Str(tblCurrencyUsed.col_KV) || " з продукту № " || Str( dfTYPE_CODE ) )
.head 7 +  Else
.head 8 -  Call SqlRollback( hSql() )
.head 6 -  Call F_CURRENCY()
.head 3 +  Child Table: tblFreqUsed
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    2.25"
.head 6 -  Width:  4.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.8"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: col_FREQ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 35
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Child Table: tblFreqAvailable
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.6"
.head 6 -  Top:    2.25"
.head 6 -  Width:  4.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.8"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: col_FREQ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 35
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 -  Frame
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Resource Id: 64467
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    2.1"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.1"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Періодичність виплати відсотків
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 64468
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    2.0"
.head 5 -  Width:  4.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb_FreqADD
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.05"
.head 5 -  Top:    2.7"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Arr2tol.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Додати обрану періодичність виплати до продукту
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pb_FreqADD' )
.head 5 +  On SAM_Click
.head 6 -  Set nRowCurr = TBL_MinRow
.head 6 +  While SalTblFindNextRow( tblFreqAvailable, nRowCurr, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext( tblFreqAvailable, nRowCurr )
.head 7 +  If SqlPrepareAndExecute( hSql(),
"INSERT INTO bars.DPU_TYPES_FREQ ( TYPE_ID, FREQ_ID )
 VALUES ( :dfTYPE_CODE, :tblFreqAvailable.col_FREQ ) " )
.head 8 -  Call SqlCommitEx( hSql(), "Додано періодичність виплати з кодом " || Str(tblFreqAvailable.col_FREQ) || " до продукту № " || Str( dfTYPE_CODE ) )
.head 7 +  Else
.head 8 -  Call SqlRollback( hSql() )
.head 6 -  Call F_FREQ()
.head 3 +  Pushbutton: pb_FreqDEL
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.05"
.head 5 -  Top:    3.2"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\ARR1TOR.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Вилучити обрану періодичність виплати з продукту
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle( 'frm_Product.pb_FreqDEL' )
.head 5 +  On SAM_Click
.head 6 -  Set nRowCurr = TBL_MinRow
.head 6 +  While SalTblFindNextRow( tblFreqUsed, nRowCurr, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext( tblFreqUsed, nRowCurr )
.head 7 +  If SqlPrepareAndExecute( hSql(),
"DELETE FROM bars.DPU_TYPES_FREQ  WHERE  TYPE_ID = :dfTYPE_CODE AND FREQ_ID = :tblFreqUsed.col_FREQ" )
.head 8 -  Call SqlCommitEx( hSql(), "Вилучено  періодичність виплати з кодом " || Str(tblFreqUsed.col_FREQ) || " з продукту № " || Str( dfTYPE_CODE ) )
.head 7 +  Else
.head 8 -  Call SqlRollback( hSql() )
.head 6 -  Call F_FREQ()
.head 3 -  Background Text: Термін дії договору
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 55242
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.6"
.head 5 -  Top:    1.0"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: MIN. к-ть місяців:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 55252
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.533"
.head 5 -  Top:    1.226"
.head 5 -  Width:  2.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTERM_MIN_M
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.733"
.head 6 -  Top:    1.179"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull( dfTERM_MIN_M ) AND dfTERM_MIN_M < 0
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: + днів
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 55251
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.583"
.head 5 -  Top:    1.226"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTERM_MIN_D
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.333"
.head 6 -  Top:    1.179"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull( dfTERM_MIN_D ) AND (dfTERM_MIN_D < 0 OR ( dfTERM_MIN_D > 0  AND dfTERM_MIN_M > 0 ) )
.head 7 -  Call SalMessageBox( 'Термін необхідно вказати або у МІСЯЦЯХ або у ДНЯХ !', 
                                            CurrentLangTable.GetAtomTitle( 'cTErr' ),  MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 -  Background Text: MAX. к-ть місяців:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 55250
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.533"
.head 5 -  Top:    1.571"
.head 5 -  Width:  2.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTERM_MAX_M
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.733"
.head 6 -  Top:    1.536"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsNull( dfTERM_MAX_M ) AND ( ( dfTERM_MAX_M < 0 ) OR ( dfTERM_MAX_M < dfTERM_MIN_M ) )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: + днів
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 55249
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.583"
.head 5 -  Top:    1.571"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTERM_MAX_D
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.333"
.head 6 -  Top:    1.536"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If ( Not SalIsNull( dfTERM_MAX_D ) )
.head 7 +  If ( dfTERM_MAX_D < 0 )
.head 8 -  Call SalMessageBox( 'Термін має бути БІЛЬШЕ НУЛЯ !', 
                                            CurrentLangTable.GetAtomTitle( 'cTErr' ),  MB_IconStop )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If ( dfTERM_MAX_D > 0 AND dfTERM_MAX_M > 0 )
.head 8 -  Call SalMessageBox( 'Термін необхідно вказати або у МІСЯЦЯХ або у ДНЯХ !', 
                                            CurrentLangTable.GetAtomTitle( 'cTErr' ),  MB_IconStop )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If ( dfTERM_MAX_D < dfTERM_MIN_D )
.head 8 -  Call SalMessageBox( 'Максимальний термін має бути більшим від МІНІМАЛЬНОГО !', 
                                            CurrentLangTable.GetAtomTitle( 'cTErr' ),  MB_IconStop )
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 55248
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.5"
.head 5 -  Top:    1.1"
.head 5 -  Width:  4.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.85"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 55247
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    0.5"
.head 5 -  Width:  9.983"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Шаблон договору
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 55246
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    4.083"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSHABLON
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 35
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.45"
.head 6 -  Top:    4.286"
.head 6 -  Width:  3.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSHABLON 
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_StrId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.4"
.head 5 -  Top:    4.286"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.774"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbSHABLON.Init(hWndItem)
.head 6 -  Call cmbSHABLON.Populate(hSql(), "ID", "NAME", "DOC_SCHEME",
                                 " WHERE id IN 
                                          (SELECT r.id 
                                             FROM doc_root r, cc_vidd v 
                                            WHERE r.vidd     = v.vidd
                                              AND v.custtype = 2 
                                              AND v.tipd     = 2) 
                                   ORDER BY 1")
.head 6 -  !
.head 6 -  Call cmbSHABLON.Add('', '')
.head 6 -  Call cmbSHABLON.SetSelectById('')
.head 6 -  Call cmbSHABLON.SetSelectById(dfSHABLON)
.head 5 +  On SAM_Click
.head 6 -  Set dfSHABLON = cmbSHABLON.GetKey(SalListQuerySelection(cmbSHABLON))
.head 3 -  Frame
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
.head 4 -  Resource Id: 55245
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    4.179"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 55244
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.1"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.1"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Допустимі терміни депозиту
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 55243
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.0"
.head 5 -  Width:  3.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbTermFixed
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Фіксований
.head 4 -  Window Location and Size
.head 5 -  Left:   0.6"
.head 5 -  Top:    0.6"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Фіксований 
.head 6 -  Call F_CHOICE_TERM( 1 )
.head 3 +  Radio Button: rbTermRange
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Діапазон
.head 4 -  Window Location and Size
.head 5 -  Left:   5.8"
.head 5 -  Top:    0.6"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Діапазон
.head 6 -  Call F_CHOICE_TERM( 2 )
.head 3 +  Child Table: tblTerms
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.0"
.head 6 -  Top:    1.25"
.head 6 -  Width:  4.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.8"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: col_TERM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Термін
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col_TYPE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: col_TYPE
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cmbNAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cGenColComboBox_NumId
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Одиниця виміру
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_Create
.head 8 -  Call cmbNAME.Init( hWndItem )
.head 8 -  Call cmbNAME.Add( 0, "Днів")
.head 8 -  Call cmbNAME.Add( 1, "Місяців")
.head 8 -  ! Call cmbNAME.SetSelectById( tblTerms.col_TYPE )
.head 8 -  ! Call SalListSetSelect( hWndItem, 0 )
.head 8 -  ! Call SalSendMsg( hWndItem, SAM_Click, 0, 0)
.head 7 +  On SAM_User
.head 8 -  Call cmbNAME.Init( hWndItem )
.head 8 -  Call cmbNAME.Add( 0, "Днів" )
.head 8 -  Call cmbNAME.Add( 1, "Місяців" )
.head 7 +  On SAM_AnyEdit
.head 8 -  Set tblTerms.col_TYPE = cmbNAME.GetKey( SalListQuerySelection( tblTerms.cmbNAME ) )
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 -  On SAM_Create
.head 5 +  On SAM_FetchRowDone
.head 6 +  If ( col_TERM < 1)
.head 7 -  Set col_TERM = (col_TERM * 10000 )
.head 7 -  Set col_TYPE = 0
.head 6 +  Else
.head 7 -  Set col_TYPE = 1
.head 6 -  Call tblTerms.cmbNAME.SetSelectById( tblTerms.col_TYPE )
.head 5 +  On SAM_User
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalTblPopulate( tblTerms, hSql(),
"SELECT  term_id  INTO :tblTerms.col_TERM 
      FROM  BARS.DPU_TYPES_TERM WHERE type_id = :dfTYPE_CODE ", TBL_FillAll )
.head 6 -  Call SalTblSetContext(hWndItem, 0)
.head 6 -  Call SalTblSetFocusRow(hWndItem, 0)
.head 6 -  Call WaitCursorOff()
.head 3 +  Pushbutton: pb_TermADD
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.45"
.head 5 -  Top:    1.3"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Добавить новую запись
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('cBTipNewRecord')
.head 5 +  On SAM_Click
.head 6 -  Set nRow = SalTblInsertRow( tblTerms, TBL_MaxRow)
.head 6 +  If nRow != TBL_Error
.head 7 -  Call SalTblSetFocusRow( tblTerms, nRow )
.head 7 -  Call SalTblSetContext( tblTerms, nRow )
.head 7 -  Call SalSendMsg( tblTerms, SAM_RowSetContext, 0, 0 )
.head 3 +  Pushbutton: pb_TermDEL
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.45"
.head 5 -  Top:    1.75"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Пометить выделенные записи на удаление
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('cBTipMarkDel')
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetFlagsAnyRows( tblTerms, ROW_MarkDeleted, TRUE, ROW_Selected, 0 )
.head 3 +  Pushbutton: pb_TermSAVE
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.45"
.head 5 -  Top:    2.65"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call p_SAVE_TERM()
.head 3 +  Pushbutton: pb_TermREFRESH
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbRefresh
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.45"
.head 5 -  Top:    2.2"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tblTerms, SAM_User, 0, 0 )
.head 2 +  Functions
.head 3 +  Function: F_POPULATE
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute( hSql(),
"SELECT  t.TYPE_ID, t.TYPE_NAME, t.COMPROC, nvl(t.TERM_TYPE,2),
                     trunc(t.term_min), (t.term_min - trunc(t.term_min)) * 10000,
                     trunc(t.term_max), (t.term_max - trunc(t.term_max)) * 10000,  
                     t.sum_min/100, t.sum_max/100, t.sum_add/100,
                     s.id,  s.name,  m.metr,  m.name,  r.br_id,  r.name,  d.id,  d.name
        INTO  :dfTYPE_CODE, :dfTYPE_NAME,  :chkComproc, :nTermType,
                     :dfTERM_MIN_M,  :dfTERM_MIN_D,
                     :dfTERM_MAX_M,  :dfTERM_MAX_D,
                     :dfSUM_MIN,  :dfSUM_MAX,  :dfSUM_ADD,
                     :dfSTOPID,  :cmbSTOP,  :dfMETR,  :cmbMETR,
                     :dfBRID,  :cmbBRATE,  :dfSHABLON,  :cmbSHABLON
      FROM  bars.DPU_TYPES  t,
                     bars.DPT_STOP    s,
                     bars.INT_METR     m,
                     bars.BRATES          r,
                     bars.doc_scheme d
  WHERE  t.type_id  = :nTypeID
         AND  t.stop_id  = s.id
         AND  t.metr_id  = m.metr
         AND  t.br_id       = r.br_id(+)
         AND  t.shablon = d.id(+) " ) And SqlFetchNext( hSql(), nFetchRes )
.head 6 -  ! Call SaveInfoToLog( "POPULATE_FINISH" )
.head 6 -  Call F_CURRENCY()
.head 6 -  ! Call SaveInfoToLog( "CURRENCY" )
.head 6 -  Call F_FREQ()
.head 6 -  ! Call SaveInfoToLog( "FREQ" )
.head 6 +  If SalIsNull( dfSUM_ADD )
.head 7 -  Set chkAdd = 0
.head 6 +  If SalIsNull( dfMETHOD )
.head 7 -  Set chkAutoExt = 0
.head 6 -  !
.head 6 -  Call F_SET_AVAILABILITY( 'ADDITION' )
.head 6 -  Call F_SET_AVAILABILITY( 'PROLONGATION' )
.head 6 -  Call F_CHOICE_TERM( nTermType )
.head 5 +  Else
.head 6 -  Call SaveInfoToLog( "POPULATE_ERROR" )
.head 6 -  Call MessageError( 'Помилка наповнення форми' )
.head 3 +  Function: F_CURRENCY
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Валюти продукту
.head 5 -  Call SalTblPopulate( tblCurrencyUsed, hSql(),
"SELECT tv.kv, tv.name 
        INTO :tblCurrencyUsed.col_KV,  :tblCurrencyUsed.col_NAME
      FROM bars.TABVAL$GLOBAL tv
  WHERE tv.kv IN ( select CURR_ID from DPU_TYPES_CURRENCY where TYPE_ID = :dfTYPE_CODE ) ", TBL_FillAll )
.head 5 -  ! Валюти доступні для вибору
.head 5 -  Call SalTblPopulate( tblCurAvailable, hSql(),
"SELECT tv.kv, tv.name 
        INTO :tblCurAvailable.col_KV, :tblCurAvailable.col_NAME
      FROM bars.TABVAL$GLOBAL tv
  WHERE tv.kv IN ( 980, 643, 840, 978 ) 
         AND tv.kv Not IN ( select CURR_ID from DPU_TYPES_CURRENCY where TYPE_ID = :dfTYPE_CODE ) ", TBL_FillAll )
.head 3 +  Function: p_GenScript
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: hFile
.head 5 -  String: sFileName
.head 5 -  Long String: sText
.head 4 +  Actions
.head 5 +  If SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessExportQuestion' ),
                                       CurrentLangTable.GetAtomTitle( 'cTAt' ),
                                       MB_IconQuestion|MB_YesNo) = IDYES
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  ! Створення файлу
.head 6 -  Set sFileName = GetPrnDir(  ) || '\\dpu_type_' || Str( dfTYPE_CODE ) || '.sql'
.head 6 +  If not SalFileOpen(hFile, sFileName, OF_Create | OF_ReadWrite)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessOpenFileFailed' )||sFileName||"!",
                    CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop )
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute( hSql(), "SELECT  column_value  INTO  :sText  FROM  table ( dpu_utils.gen_script4types( :dfTYPE_CODE ) )" )
.head 8 +  While SqlFetchNext( hSql(), nFetchRes )
.head 9 -  Call SalFileWrite(hFile, sText, Len(sText))
.head 8 -  Call SalFileClose(hFile)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  ! Сценарий сохранен в sFileName
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessExportDone' )||" "||sFileName,
                    CurrentLangTable.GetAtomTitle('cTAt'),
                    MB_IconInformation )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  ! Помилка експорту даних у сценарій
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessCreateFileFailed' ),
                    CurrentLangTable.GetAtomTitle( 'cTErr' ),
                    MB_IconStop )
.head 8 -  Return FALSE
.head 3 +  Function: p_SAVE
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTotalTermMin
.head 5 -  Number: nTotalTermMax
.head 4 +  Actions
.head 5 -  Set nTotalTermMin = dfTERM_MIN_M + ( dfTERM_MIN_D / 10000 )
.head 5 -  Set nTotalTermMax = dfTERM_MAX_M + ( dfTERM_MAX_D / 10000 )
.head 5 +  If SqlPrepareAndExecute( hSql(),
"UPDATE BARS.dpu_types
           SET SUM_MIN      = (:dfSUM_MIN * 100),
                     SUM_MAX     = (:dfSUM_MAX * 100),
                     SUM_ADD     = (:dfSUM_ADD * 100),
                     TERM_MIN   = :nTotalTermMin,
                     TERM_MAX  = :nTotalTermMax,
                     COMPROC    = :chkComproc,
                     STOP_ID        = :dfSTOPID,
                     BR_ID              = :dfBRID,
                     METR_ID       = :dfMETR,
                     shablon           = :dfSHABLON,
                     TERM_TYPE = :nTermType
   WHERE type_id = :dfTYPE_CODE " ) And 
SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessUpdated' ) || " № " || Str( dfTYPE_CODE ) )
.head 6 +  If ( nTermType = 1)
.head 7 -  Call p_SAVE_TERM()
.head 6 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessUpdated') || " № " || Str( dfTYPE_CODE ),
                                            CurrentLangTable.GetAtomTitle('cTAt'), 
                                            MB_IconExclamation)
.head 6 -  Call F_POPULATE()
.head 3 +  Function: F_SET_AVAILABILITY
.head 4 -  Description: Управління доступністю елементів на формі
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sType
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Поповнення депозиту
.head 5 +  If ( sType = 'ADDITION' )
.head 6 +  If ( chkAdd = 1)
.head 7 -  Call SalEnableWindow( dfSUM_ADD )
.head 7 -  Call SalSetFocus( dfSUM_ADD )
.head 6 +  Else
.head 7 -  Set dfSUM_ADD = NUMBER_Null
.head 7 -  Call SalDisableWindow( dfSUM_ADD )
.head 5 +  If ( sType = 'PROLONGATION' )
.head 6 +  If ( chkAutoExt = 1)
.head 7 -  Call SalEnableWindow( cmbMETHOD )
.head 6 +  Else
.head 7 -  Set dfMETHOD = NUMBER_Null
.head 7 -  Set cmbMETHOD = STRING_Null
.head 7 -  Call SalDisableWindow( cmbMETHOD )
.head 3 +  Function: F_FREQ
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Обрані види періодичності виплати %%
.head 5 -  Call SalTblPopulate( tblFreqUsed, hSql(),
"SELECT f.freq, f.name 
        INTO :tblFreqUsed.col_FREQ,  :tblFreqUsed.col_NAME
      FROM bars.FREQ f
  WHERE f.freq IN ( select FREQ_ID from BARS.DPU_TYPES_FREQ where TYPE_ID = :frm_Product.dfTYPE_CODE ) ", TBL_FillAll )
.head 5 -  ! Види періодичності доступні для вибору
.head 5 -  Call SalTblPopulate( tblFreqAvailable, hSql(),
"SELECT  f.freq, f.name 
        INTO  :tblFreqAvailable.col_FREQ, :tblFreqAvailable.col_NAME
      FROM  bars.FREQ f
  WHERE  f.freq IN ( 3, 5, 7, 180, 360, 400 )
         AND  f.freq Not IN ( select FREQ_ID from BARS.DPU_TYPES_FREQ where TYPE_ID = :frm_Product.dfTYPE_CODE ) ", TBL_FillAll )
.head 3 +  Function: p_SyncVidds
.head 4 -  Description: Синхронізація параметрів продукту з видами депозитів
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessSyncQuestion' ),
                                       CurrentLangTable.GetAtomTitle( 'cTAt' ),
                                       MB_IconQuestion|MB_YesNo) = IDYES
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If SqlPLSQLCommand( hSql(), "BARS.dpu_utils.TYPE_CONSTRUCTOR( dfTYPE_CODE )" )
.head 7 -  Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessSyncDone' ) )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessSyncDone' ),
                                            CurrentLangTable.GetAtomTitle('cTAt'),  MB_IconInformation )
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'frm_Product.cTMessSyncFailed' ),
                                            CurrentLangTable.GetAtomTitle( 'cTErr' ),  MB_IconStop )
.head 7 -  Return FALSE
.head 3 +  Function: F_CHOICE_TERM
.head 4 -  Description: Вибір типу терміну депозитного продукту
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nTerm
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nTermType = nTerm
.head 5 +  If ( nTerm = 1)
.head 6 -  ! << Фіксований >>
.head 6 -  Set rbTermFixed = TRUE
.head 6 -  Set dfTERM_MIN_M = 0
.head 6 -  Set dfTERM_MIN_D = 0
.head 6 -  Set dfTERM_MAX_M = 0
.head 6 -  Set dfTERM_MAX_D = 0
.head 6 -  !
.head 6 -  Call SalDisableWindow( dfTERM_MIN_M )
.head 6 -  Call SalDisableWindow( dfTERM_MIN_D )
.head 6 -  Call SalDisableWindow( dfTERM_MAX_M )
.head 6 -  Call SalDisableWindow( dfTERM_MAX_D )
.head 6 -  !
.head 6 -  Call SalEnableWindow( tblTerms )
.head 6 -  Call SalEnableWindow( pb_TermADD )
.head 6 -  Call SalEnableWindow( pb_TermDEL )
.head 6 -  Call SalEnableWindow( pb_TermREFRESH )
.head 6 -  Call SalEnableWindow( pb_TermSAVE )
.head 6 -  !
.head 6 -  Call SalSendMsg( tblTerms, SAM_User, 0, 0 )
.head 5 +  Else
.head 6 -  ! << Діапазон >>
.head 6 -  Set rbTermRange = TRUE
.head 6 +  If ( ( dfTERM_MIN_M = 0 ) AND ( dfTERM_MIN_D = 0 ) )
.head 7 -  Set dfTERM_MIN_M = 1
.head 6 +  If ( ( dfTERM_MAX_M = 0 ) AND ( dfTERM_MAX_D = 0 ) )
.head 7 -  Set dfTERM_MAX_M = 36
.head 6 -  !
.head 6 -  Call SalEnableWindow( dfTERM_MIN_M )
.head 6 -  Call SalEnableWindow( dfTERM_MIN_D )
.head 6 -  Call SalEnableWindow( dfTERM_MAX_M )
.head 6 -  Call SalEnableWindow( dfTERM_MAX_D )
.head 6 -  !
.head 6 -  Call SalDisableWindow( tblTerms )
.head 6 -  Call SalDisableWindow( pb_TermADD )
.head 6 -  Call SalDisableWindow( pb_TermDEL )
.head 6 -  Call SalDisableWindow( pb_TermREFRESH )
.head 6 -  Call SalDisableWindow( pb_TermSAVE )
.head 6 -  !
.head 6 -  Call SalTblReset( tblTerms )
.head 3 +  Function: p_SAVE_TERM
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTerm
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( tblTerms, nRow, ROW_New | ROW_MarkDeleted, 0)
.head 6 -  Call SalTblSetContext( tblTerms, nRow )
.head 6 -  Set nTerm = IifN( ( tblTerms.col_TYPE = 0 ), ( tblTerms.col_TERM / 10000 ), tblTerms.col_TERM )
.head 6 -  ! Вставка
.head 6 +  If SalTblQueryRowFlags( tblTerms, nRow, ROW_New)
.head 7 +  If SqlPrepareAndExecute( hSql(), "INSERT INTO BARS.dpu_types_term ( TYPE_ID, TERM_ID ) VALUES ( :dfTYPE_CODE, :nTerm )" )
.head 8 -  Call SqlCommitEx( hSql(), "Додано новий термін для продукту № " || Str( dfTYPE_CODE ) )
.head 7 +  Else
.head 8 -  Call SqlRollback( hSql() )
.head 6 -  ! Видалення
.head 6 +  If SalTblQueryRowFlags( tblTerms, nRow, ROW_MarkDeleted)
.head 7 +  If SqlPrepareAndExecute( hSql(), "DELETE FROM BARS.dpu_types_term WHERE TYPE_ID = :dfTYPE_CODE AND TERM_ID = :nTerm " )
.head 8 -  Call SqlCommitEx( hSql(), "Додано новий термін для продукту № " || Str( dfTYPE_CODE ) )
.head 7 +  Else
.head 8 -  Call SqlRollback( hSql() )
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SalSendMsg( tblTerms, SAM_User, 0, 0 )
.head 2 +  Window Parameters
.head 3 -  ! Код типу деп.договору
.head 3 -  Number: nTypeID
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  Number: nRowCurr
.head 3 -  Number: nRow
.head 3 -  Number: nTermType
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle( 'frm_Product.cTWndTitle' ) )
.head 4 -  Call PrepareWindowEx( hWndForm)
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  ! Call XSalTooltipSetUserDefault()
.head 4 -  Call SaveInfoToLog( "Відкрито форму: Параметри депозитного продукту №" || Str( nTypeID ) )
.head 4 -  Call SalSendMsg( tblTerms.cmbNAME, SAM_User, 0, 0 )
.head 4 +  If ( nTypeID > 0 )
.head 5 -  Call F_POPULATE()
.head 4 +  Else
.head 5 -  Set dfTYPE_CODE = NUMBER_Null
.head 4 -  Call SalHideWindow( pbExport )
.head 1 +  Table Window: DPU_PLEDGED
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Зтягнення простроченої заборгованості за рахунок депозиту в переданого в заставу
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.938"
.head 4 -  Top:    0.781"
.head 4 -  Width:  15.517"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.226"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description: Зтягнення простроченої заборгованості за рахунок депозиту в переданого в заставу
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.476"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.783"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.917"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45278
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.75"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  2.75"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.05"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.6"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRunRepayment
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.1"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Currconv.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Виконати погашення за рахунок депозиту?
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle( 'DPU_PLEDGED.cBTipRunRepayment' )
.head 6 +  On SAM_Click
.head 7 +  If not SalIsNull( DPU_ID )
.head 8 +  If SalMessageBox( CurrentLangTable.GetAtomTitle( 'DPU_PLEDGED.cBTipRunRepayment' ) || " № " || DPU_NUM || " ?",
                                       CurrentLangTable.GetAtomTitle( 'cTAt' ), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 9 -  Call f_RepaymentPledge( DPU_ID, DPU_NUM )
.head 9 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45279
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.683"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  1.683"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   14.617"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 45280
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  14.5"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  14.5"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: DPU_GEN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
ген.
договору
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф.
депозиту
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_NUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
депозитного
договору
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: РНК
власника
депозиту
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_ACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ACC
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_DAT_BEG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заключення
депозиту
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_DAT_END
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
завершення
депозиту
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_STOP_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: STOP_ID
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CRD_PRODUCT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кредитний
продукт
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: String
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CRD_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CRD_ID
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.633"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CRD_NUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
кредитного
договору
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CRD_OST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
боргу
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: ###000
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CRD_DAT_BEG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
заключення
кредиту
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CRD_DAT_END
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
завершення
кредиту
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CRD_RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: РНК
власника
кредиту
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: f_RepaymentPledge
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nDPUID
.head 5 -  String: sDealNum
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Long String: sErrMsg
.head 4 +  Actions
.head 5 +  If SqlPLSQLCommand( hSql(), "dpu.repayment_pledge( nDPUID, sErrMsg )" ) AND ( sErrMsg = STRING_Null )
.head 6 -  Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle( 'DPU_PLEDGED.cTMessRepaymentOk' ) )
.head 6 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'DPU_PLEDGED.cTMessRepaymentOk' ) || " #" || Str( nDPUID ),
                                            CurrentLangTable.GetAtomTitle( 'cTMessage' ), MB_Ok | MB_IconExclamation )
.head 5 +  Else
.head 6 -  Call SqlRollbackEx( hSql(), sErrMsg )
.head 6 -  Call MessageError( CurrentLangTable.GetAtomTitle( 'DPU_PLEDGED.cTMessRepaymentErr' ) || 
" N " || sDealNum || " (#" || Str( nDPUID ) || "): " || sErrMsg )
.head 2 +  Window Parameters
.head 3 -  String: sPar  !! ( "CRD" - кредити / "OVR" - овердрафти)
.head 3 -  Number: nDPU_ID  !! ідентифікатор депозиту
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle( 'DPU_PLEDGED.cTWndTitle' ) )
.head 4 -  Call PrepareWindowEx( hWndForm )
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  Set DPU_PLEDGED.strFilterTblName = 'DPU_PLEDGED'
.head 4 -  Set DPU_PLEDGED.strPrintFileName = 'DPU_PLEDGED'
.head 4 -  Set DPU_PLEDGED.nTabInstance = 1
.head 4 -  !
.head 4 -  Call SalHideWindow( CRD_OST )
.head 4 -  ! Претенденти на погашення КРЕДИТНОЇ ЗАБОРГОВАНОСТІ
.head 4 -  Set DPU_PLEDGED.strSqlPopulate = 
"select  dd.dpu_gen,  dd.dpu_id,  dd.nd,  dd.rnk,  dd.acc,  dd.dat_begin,  dd.dat_end,  dd.id_stop,
                cd.PRODUCT_NAME,  cd.CONTRACT_ID,  cd.CONTRACT_NUMBER,
                cd.CONTRACT_DATE,  cd.CONTRACT_DATE_EXPIRY,  cd.CLIENT_ID
   INTO  :DPU_GEN,  :DPU_ID,  :DPU_NUM,  :DPU_RNK,  :DPU_ACC,
                :DPU_DAT_BEG,  :DPU_DAT_END,  :DPU_STOP_ID,
                :CRD_PRODUCT,  :CRD_ID,  :CRD_NUM,  :CRD_DAT_BEG,  :CRD_DAT_END,  :CRD_RNK
    From  DPU_DEAL  dd,  DPU_DEALW dw,  V_CREDIT_PRODUCTS_PORTFOLIO cd
 Where  dw.TAG = 'IS_PLEDGE'  And dw.VALUE is Not Null
      And  dd.DPU_ID = dw.DPU_ID  And dd.CLOSED = 0
      And  cd.CONTRACT_ID = to_number(dw.VALUE) "
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 7 )
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblPopulate( hWndForm, hSql(), DPU_PLEDGED.strSqlPopulate, TBL_FillAll )
.head 4 -  Call SalSendMsg( hWndForm, SAM_RowSetContext, 0, 0 )
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If ( DPU_RNK != CRD_RNK )
.head 5 -  Call SetTblRowColor( hWndForm, COLOR_DarkGray )
.head 1 +  Dialog Box: dlg_AgreementCreate
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Створення Додаткових Угод до депозитного договору
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  11.3"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.631"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Заключення Додаткових Угод до депозитного договору
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Bottom
.head 4 -  Visible? Yes
.head 4 -  Size: 0.571"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb_Create
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cPushButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Створити
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.1"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.4"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementCreate.cTMessCreateAgreement' ) || dfAgreementNumber || "?",
                  CurrentLangTable.GetAtomTitle( 'cTAt' ), 
                  MB_IconQuestion|MB_YesNo ) = IDYES
.head 8 -  Call p_Create_Agreement()
.head 8 -  ! EXIT
.head 8 -  ! Call SalEndDialog( dlg_AgreementCreate, TRUE )
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Створити додаткову угоду' )
.head 4 +  Pushbutton: pb_Exit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cPushButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Вихід
.head 5 -  Window Location and Size
.head 6 -  Left:   7.6"
.head 6 -  Top:    0.1"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.4"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalEndDialog( dlg_AgreementCreate, FALSE )
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Вихід без збереження змін' )
.head 4 +  Pushbutton: pb_Print
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cPushButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Друк
.head 5 -  Window Location and Size
.head 6 -  Left:   3.85"
.head 6 -  Top:    0.1"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.4"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementCreate.cTMessPrintAgreement' ) || dfAgreementNumber || "?",
                  CurrentLangTable.GetAtomTitle( 'cTAt' ), 
                  MB_IconQuestion|MB_YesNo ) = IDYES
.head 8 -  Call p_Print_Agreement()
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Друк додаткової угоди' )
.head 2 +  Contents
.head 3 -  Background Text: Додаткова угода №
.head 4 -  Resource Id: 55793
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.6"
.head 5 -  Top:    0.15"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAgreementNumber
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.7"
.head 6 -  Top:    0.13"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If ( SalIsNull(dfAgreementNumber) )
.head 7 -  ! Номер дод.угоди не може бути порожнім
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrNomDopSogl'), 
                    CurrentLangTable.GetAtomTitle('cTAt'), 
                    MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Group Box: Реквізити ДУ
.head 4 -  Resource Id: 55786
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.821"
.head 5 -  Width:  11.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.083"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Background Text: Вид додаткової угоди:
.head 4 -  Resource Id: 55787
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.17"
.head 5 -  Top:    1.06"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAgreementTypeId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    1.024"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbAgreementTypes
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.95"
.head 5 -  Top:    1.036"
.head 5 -  Width:  7.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: 35
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If ( cmbAgreementTypes = STRING_Null )
.head 7 -  Call cmbAgreementTypes.Init( hWndItem )
.head 7 -  Call cmbAgreementTypes.Populate( hSql(), 'ID', 'NAME', 'DPU_AGREEMENT_TYPES', 'where ACTIVE = 1 order by ID' )
.head 7 -  Call cmbAgreementTypes.SetSelectById( dfAgreementTypeId )
.head 5 +  On SAM_Click
.head 6 -  Set dfAgreementTypeId = cmbAgreementTypes.GetKey( SalListQuerySelection( cmbAgreementTypes ) )
.head 6 -  Call f_HIDE_SHOW( 'SELECT' )
.head 3 -  Background Text: Сума договору:
.head 4 -  Resource Id: 55788
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.17"
.head 5 -  Top:    1.357"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAMOUNT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    1.333"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Validate
.head 6 +  If frm_CreateDeal.nDPU_ID = NUMBER_Null
.head 7 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 6 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Дата завершення:
.head 4 -  Resource Id: 55789
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.17"
.head 5 -  Top:    1.655"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDATO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    1.631"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If ( dfAgreementTypeId = 5 )
.head 7 -  ! Перевірка нового терміну договору на відповідність умовам виду депозиту
.head 7 +  If NOT SalIsNull( dfDATO )
.head 8 +  ! If NOT F_VALIDATE( 'DATO' )
.head 9 -  ! Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 9 -  Set dfDATO = GetCloseDate(dfDATN, dfTERM, dfKV)
.head 9 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Виплата відсотків:
.head 4 -  Resource Id: 55790
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.17"
.head 5 -  Top:    2.262"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFREQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    2.214"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbFREQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.95"
.head 5 -  Top:    2.226"
.head 5 -  Width:  7.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbFREQ.Init(hWndItem)
.head 6 -  Call cmbFREQ.Populate(hSql(), "FREQ", "NAME", "FREQ", "WHERE FREQ >=0 AND FREQ <> :frm_Open.dfFREQ ORDER BY 1")
.head 6 -  Call cmbFREQ.SetSelectById(dfFREQ)
.head 5 +  On SAM_Click
.head 6 -  Set dfFREQ = cmbFREQ.GetKey( SalListQuerySelection(cmbFREQ))
.head 3 -  Background Text: Штраф:
.head 4 -  Resource Id: 55792
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.17"
.head 5 -  Top:    2.56"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSTOPID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    2.512"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSTOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.95"
.head 5 -  Top:    2.524"
.head 5 -  Width:  7.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmbSTOP.Init(hWndItem)
.head 6 -  Call cmbSTOP.Populate(hSql(), "ID", "NAME", "DPT_STOP", "where (MOD_CODE='DPU' or MOD_CODE IS NULL) and ID >= 0 and ID <> :frm_Open.dfSTOPID ORDER BY ID")
.head 6 -  Call cmbSTOP.SetSelectById(dfSTOPID)
.head 5 +  On SAM_Click
.head 6 -  Set dfSTOPID = cmbSTOP.GetKey(SalListQuerySelection(cmbSTOP))
.head 3 -  Background Text: Відсоткова ставка:
.head 4 -  Resource Id: 55791
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    1.952"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfRATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    1.917"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Индивидуальная % ставка 
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Open.cFTipIR'))
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( dfRATE ) OR ( dfRATE <= 0 )
.head 7 -  ! ВІДСОТКОВА СТАВКЕ МАЄ БУТИ БІЛЬШЕ НУЛЯ
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrMinRate'),
                    CurrentLangTable.GetAtomTitle('cTErr'), 
                    MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else If ( dfRATE >= 100 )
.head 7 -  ! ВІДСОТКОВА СТАВКЕ МАЄ БУТИ МЕНШЕ СТА
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrMaxRate'),
                    CurrentLangTable.GetAtomTitle('cTErr'),
                    MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 +  Child Table: tbl_Agreements
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    3.988"
.head 6 -  Width:  11.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: col_AgreementId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ідентифікатор
ДУ
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col_AgreementNumber
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
ДУ
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col_AgreementDate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
ДУ
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col_AgreementName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва
ДУ
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  5.25"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col_AgreememtState
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 -  On SAM_Create
.head 5 +  On SAM_FetchRowDone
.head 6 +  If ( col_AgreememtState = -1 )
.head 7 -  Call SetTblRowColor(hWndForm, COLOR_Red )
.head 6 +  If ( col_AgreememtState = 0 )
.head 7 -  Call SetTblRowColor(hWndForm, COLOR_DarkBlue )
.head 6 +  If ( col_AgreememtState = NUMBER_Null )
.head 7 -  Call SetTblRowColor(hWndForm, COLOR_Yellow )
.head 6 +  If ( col_AgreememtState = 1 )
.head 7 -  Call SetTblRowColor(hWndForm, COLOR_DarkGreen )
.head 3 +  Pushbutton: pbCustAcc
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.2"
.head 5 -  Top:    3.167"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.274"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Текущие счета клиента'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipCustAcc'))
.head 5 +  On SAM_Click
.head 6 -  ! 'Выбрать из справочника текущий счет клиента?'
.head 6 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessGetAcc'),
                  CurrentLangTable.GetAtomTitle('cTAt'),
                  MB_IconQuestion|MB_YesNo) = IDYES
.head 7 -  Set sTmp = STRING_Null
.head 7 -  Call FunNSIGetFiltered( "ACCOUNTS", "NLS", "RNK = " || Str(frm_Open.dfRNK) ||
                        " and NBS in ('2520','2523','2600','2650') and ACCOUNTS.KV = "||Str(frm_Open.dfKV), sTmp, dfNLSD )
.head 7 +  If ( sTmp != STRING_Null )
.head 8 +  If ( frm_Open.dfNLSD = dlg_AgreementCreate.dfNLSD )
.head 9 -  Call SalMessageBox( "Обраний рахунок вже вказаний як рахунок виплати!",
                    CurrentLangTable.GetAtomTitle('cTErr' ), MB_IconStop )
.head 9 -  Set dfNLSD = STRING_Null
.head 8 +  Else
.head 9 -  Set dfNMSD = get_OneStringValue( "select NMS into :sResult from BARS.ACCOUNTS where ACC = "||sTmp )
.head 3 +  Picture: picDepPay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.821"
.head 5 -  Width:  10.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.98"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    2.881"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If ( SalIsNull(dfMFOD) OR NOT SalIsValidNumber(dfMFOD) )
.head 7 -  Call SalMessageBox( 'Invalid number value', 'Validate Error', MB_Ok )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 +  If NOT SqlPrepareAndExecute( hSql(), "SELECT nb INTO :dfNBD FROM banks WHERE mfo = "||Str(dfMFOD))
OR NOT SqlFetchNext(hSql(), frm_Open.nFetchRes )
.head 8 -  Set dfMFOD = NUMBER_Null
.head 8 -  ! Не нашли банка с МФО dfMFOD
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrMfo') ||' '||Str(dfMFOD),
                    CurrentLangTable.GetAtomTitle('cTAt'),
                    MB_IconExclamation )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 +  If ( dfMFOD != Val(GetBankMfo()) )
.head 9 -  Call SalEnableWindow( dfNLSD )
.head 9 -  Call SalEnableWindow( dfNMSD )
.head 9 -  Call SalDisableWindow( pbCustAcc )
.head 8 +  Else
.head 9 -  Call SalDisableWindow( dfNLSD )
.head 9 -  Call SalDisableWindow( dfNMSD )
.head 9 -  Call SalEnableWindow( pbCustAcc )
.head 8 -  Return VALIDATE_Ok
.head 6 -  ! Return VALIDATE_Ok
.head 5 -  On SAM_KillFocus
.head 3 -  Background Text: Банк отримувача:
.head 4 -  Resource Id: 28908
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.27"
.head 5 -  Top:    2.905"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.24"
.head 6 -  Top:    2.881"
.head 6 -  Width:  6.66"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Рахунок отримувача:
.head 4 -  Resource Id: 28907
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.27"
.head 5 -  Top:    3.202"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    3.167"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfNLSD != ''
.head 7 +  If Vkrz2(Str(dfMFOD),dfNLSD) != dfNLSD
.head 8 -  ! Ошибка в контрольном разряде счета!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAcc'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation)
.head 8 -  Set dfNLSD = ''
.head 7 +  Else
.head 8 +  If dfMFOD = Val(GetBankMfo())
.head 9 +  If SqlPrepareAndExecute( hSql(),
   "SELECT a.rnk, substr(a.nms, 1, 38)
      INTO :nTmp, :dfNMSD
      FROM accounts a
     WHERE a.kv  = :dfKV
       AND a.nls = :dfNLSD
       AND a.dazs is null")
and not SqlFetchNext( hSql(), frm_CreateDeal.nFetchRes)
.head 10 -  ! Счет не открыт!
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAccNotOpen'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation)
.head 10 -  Set dfNLSD = ''
.head 9 +  Else
.head 10 -  ! Счет открыт на другого клиента! Продолжить?
.head 10 +  If dlg_DealGeneralParams.dfRNK != frm_CreateDeal.nTmp AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessAccRnk'),
              CurrentLangTable.GetAtomTitle('cTAt'),
              MB_IconQuestion|MB_YesNo) = IDNO
.head 11 -  Set dfNLSD = ''
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNMSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    3.452"
.head 6 -  Width:  7.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Назва отримувача:
.head 4 -  Resource Id: 28909
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.27"
.head 5 -  Top:    3.488"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Дата початку дії дод. угоди
.head 4 -  Resource Id: 28910
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.6"
.head 5 -  Top:    0.48"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDueDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.7"
.head 6 -  Top:    0.45"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If NOT SalIsNull( dfDueDate )
.head 7 +  If NOT f_VALIDATE( 'DueDate' ) 
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Return VALIDATE_Ok
.head 6 -  Return VALIDATE_Cancel
.head 2 +  Functions
.head 3 +  Function: f_Populate_Agreements
.head 4 -  Description: Населяєм таблицю наявними ДУ договору
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  When SqlError
.head 6 -  Call SalDisableWindow( tbl_Agreements )
.head 6 -  Call MessageError( "Table Populate Error!" )
.head 6 -  Return FALSE
.head 5 +  If SalTblPopulate( tbl_Agreements, hSql(),
"select AGRMNT_ID, AGRMNT_TYPE_NAME, AGRMNT_NUMBER, AGRMNT_BDATE, AGRMNT_STATE
   INTO :tbl_Agreements.col_AgreementId,   :tbl_Agreements.col_AgreementName, :tbl_Agreements.col_AgreementNumber,
        :tbl_Agreements.col_AgreementDate, :tbl_Agreements.col_AgreememtState
   from V_DPU_AGREEMENTS
  where AGRMNT_DPU_ID = :dlg_AgreementCreate.pDPU_ID
  order by AGRMNT_ID desc
", TBL_FillAll )
.head 6 -  Return TRUE
.head 3 +  Function: p_Create_Agreement
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Long String: sDetails
.head 5 -  Number: nAMOUNT
.head 5 -  Date/Time: dBEGIN_DATE
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If f_VALIDATE('ALL') 
.head 6 +  If ( dfAgreementTypeId = 1 )
.head 7 -  ! Додаткова угода про зміну суми договору
.head 7 -  Set nAMOUNT = dfAMOUNT * 100
.head 6 +  If ( dfAgreementTypeId = 4 )
.head 7 -  ! Додаткова угода про зміну рахунку повернення депозиту
.head 7 -  Set sDetails = "<details>"
.head 7 -  Set sDetails = sDetails || "<dep><mfo>"||Str(dfMFOD)||"</mfo><nls>"||dfNLSD||"</nls><nmk>"||dfNMSD||"</nmk><okpo></okpo></dep>"
.head 7 +  If ( ( frm_Open.dfK013 != '1' ) OR ( NOT frm_Open.cbCOMPROC ) )
.head 8 -  ! для всіх типів клієнтів окрім Бюджетних Установ та депозитів без капіталізації
.head 8 -  Set sDetails = sDetails || "<int><mfo>"||Str(dfMFOD)||"</mfo><nls>"||dfNLSD||"</nls><nmk>"||dfNMSD||"</nmk><okpo></okpo></int>"
.head 7 -  Set sDetails = sDetails || "</details>"
.head 6 +  If ( dfAgreementTypeId = 7 )
.head 7 -  ! Додаткова угода про пролонгацію договору
.head 7 +  If ( sDptBankType = 'SBER' )
.head 8 -  Set dBEGIN_DATE = frm_Open.dfDATV
.head 7 +  Else
.head 8 -  Set dBEGIN_DATE = frm_Open.dfDATO
.head 6 +  If SqlPLSQLCommand( hSql(), "DPU_AGR.CREATE_AGREEMENT( pDPU_ID, dfAgreementTypeId, dfAgreementNumber,
                    dfDueDate, nAMOUNT, dfRATE, dfFREQ, dBEGIN_DATE, dfDATO, dfSTOPID, sDetails, nAgreementId )" )
.head 7 -  Call SqlCommit( hSql() )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementCreate.cTMessCreateAgreementDone') || ' #' || Str(nAgreementId),
                    CurrentLangTable.GetAtomTitle( 'cTAt' ),
                    MB_IconInformation )
.head 7 -  Call SalEnableWindow( pb_Print )
.head 7 -  Call SalDisableWindow( pb_Create )
.head 7 -  ! refresh grid 
.head 7 -  Call f_Populate_Agreements()
.head 6 +  Else
.head 7 -  Call SqlRollback( hSql() )
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: f_HIDE_SHOW
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sName
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If ( sName = 'START' )
.head 6 -  Set dfDueDate = GetBankDate()
.head 6 -  Set dfAMOUNT  = NUMBER_Null
.head 6 -  Set dfDATO    = DATETIME_Null
.head 6 -  Set dfRATE    = NUMBER_Null
.head 6 -  Set dfFREQ    = NUMBER_Null
.head 6 -  Set dfSTOPID  = NUMBER_Null
.head 6 -  Set dfMFOD    = NUMBER_Null
.head 6 -  Set dfNBD     = STRING_Null
.head 6 -  Set dfNLSD    = STRING_Null
.head 6 -  Set dfNMSD    = STRING_Null
.head 6 -  !
.head 6 -  Call SalDisableWindow( dfDueDate )
.head 6 -  Call SalDisableWindow( dfAMOUNT )
.head 6 -  Call SalDisableWindow( dfDATO )
.head 6 -  Call SalDisableWindow( dfRATE )
.head 6 -  Call SalDisableWindow( cmbFREQ )
.head 6 -  Call SalDisableWindow( cmbSTOP )
.head 6 -  Call SalDisableWindow( dfMFOD )
.head 6 -  Call SalDisableWindow( dfNLSD )
.head 6 -  Call SalDisableWindow( dfNMSD )
.head 6 -  Call SalDisableWindow( pbCustAcc )
.head 5 +  If ( sName = 'SELECT' )
.head 6 -  Call f_HIDE_SHOW( 'START' )
.head 6 +  Select Case ( dfAgreementTypeId )
.head 7 +  Case 1
.head 8 -  ! ДУ про зміну суми договору
.head 8 -  Call SalEnableWindow( dfAMOUNT )
.head 8 -  Break
.head 7 +  Case 2
.head 8 -  ! ДУ про зміну відсоткової ставки по договору
.head 8 -  Call SalEnableWindow( dfDueDate )
.head 8 -  Call SalEnableWindow( dfRATE )
.head 8 -  Set dfRATE = frm_Open.dfIR
.head 8 -  Break
.head 7 +  Case 3
.head 8 -  ! ДУ про зміну періодичності виплати відсотків
.head 8 -  Call SalEnableWindow( cmbFREQ )
.head 8 -  Break
.head 7 +  Case 4
.head 8 -  ! ДУ про зміну рахунку повернення депозиту та нарахованих відсотків
.head 8 -  ! << Для власного МФО лише вибір рахунка з довідника >>
.head 8 -  Call SalEnableWindow( dfMFOD )
.head 8 -  Call SalEnableWindow( pbCustAcc )
.head 8 -  Set dfMFOD = SalStrToNumber(GetBankMfo())
.head 8 -  Set dfNBD  = GetBankName()
.head 8 -  Break
.head 7 +  Case 5
.head 8 -  ! ДУ про зміну терміну договору
.head 8 -  Call SalEnableWindow( dfDATO )
.head 7 +  Case 7
.head 8 -  ! Додаткова угода про пролонгацію договору
.head 8 -  ! Call SalEnableWindow( dfDueDate )
.head 8 -  Call SalEnableWindow( dfDATO )
.head 8 -  Call SalEnableWindow( dfRATE ) 
.head 8 +  If ( sDptBankType = 'SBER' )
.head 9 -  ! Якщо дата повернення менша за банкківську (лонгація навздогін)
.head 9 -  Set dfDueDate = IifD( frm_Open.dfDATV < dfDueDate, dfDueDate, frm_Open.dfDATV )
.head 8 +  Else
.head 9 -  ! Якщо дата завершення менша за банкківську (лонгація навздогін)
.head 9 -  Set dfDueDate = IifD( frm_Open.dfDATO < dfDueDate, dfDueDate, frm_Open.dfDATO )
.head 8 -  Set dfRATE = frm_Open.dfIR
.head 8 -  Set dfDATO = frm_Open.f_GetNewDateClose( pDPU_ID )
.head 8 -  Break
.head 7 +  Case 6
.head 8 -  ! ДУ про зміну умов дострокового повернення коштів
.head 8 -  Call SalEnableWindow( cmbSTOP )
.head 8 -  Break
.head 7 -  Default
.head 3 +  Function: p_Print_Agreement
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTemplate
.head 4 +  Actions
.head 5 -  Set sTemplate = get_OneStringValue( "select TEMPLATE into :sResult from bars.dpu_agreement_types where ID = :dlg_AgreementCreate.dfAgreementTypeId" )
.head 5 -  Set sTemplate = GetTemplateDir() || "\\" || sTemplate
.head 5 -  Call SalMessageBox( sTemplate, sTemplate,MB_Ok )
.head 5 -  Call PrintTemplate(SqlDatabase,SqlUser,SqlPassword, sTemplate )
.head 3 +  Function: f_VALIDATE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sParName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErrorList
.head 5 -  Number: nErrorCount
.head 5 -  !
.head 5 -  Number: l_mnth
.head 5 -  Number: l_days
.head 5 -  Number: l_actrate
.head 5 -  Number: l_maxrate
.head 5 -  Number: l_recid
.head 4 +  Actions
.head 5 +  If ( sParName = 'ALL' )
.head 6 -  Set sErrorList = ''
.head 6 -  Set nErrorCount = 0
.head 6 +  ! If SalIsNull(dfSUM)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)    ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')       ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipSUM')||'>'||PutCrLf()
.head 6 +  ! If SalIsNull(dfFREQ)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')    ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipCmbFREQ_V')||'>'||PutCrLf()
.head 6 +  ! If SalIsNull(dfSTOPID)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)     ||': ' 
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')        ||' <'
                || CurrentLangTable.GetAtomTitle('frm_Open.cFTipSTOP')||'>'||PutCrLf()
.head 6 +  If ( dfAgreementTypeId = 2 AND SalIsNull(dfRATE) )
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)  ||': '
              || CurrentLangTable.GetAtomTitle('_cTErrRekv')     ||' <'
              || CurrentLangTable.GetAtomTitle('dlg_AgreementCreate.cTRate')||'>'||PutCrLf()
.head 6 +  If ( dfAgreementTypeId = 4 AND ( SalIsNull(dfMFOD) OR SalIsNull(dfNLSD) OR SalIsNull(dfNMSD) ) )
.head 7 -  ! Не вказані реквізити для поверненню депозиту
.head 7 -  Set nErrorCount  = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle( 'dlg_AgreementCreate.cTErrListMFOD') || PutCrLf()
.head 6 +  If ( nErrorCount > 0 )
.head 7 -  ! Помилка заповнення реквізитів
.head 7 -  Call SalMessageBox( sErrorList, CurrentLangTable.GetAtomTitle('_cTErrCheck'), MB_Ok )
.head 7 -  Return FALSE
.head 6 -  !
.head 6 +  If NOT f_VALIDATE('MaxRate')
.head 7 -  ! Введенная ставка превышает макс.допустимую ставку для договоров данного типа
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_AgreementCreate.cTMessCheckRateErr'), 
                    CurrentLangTable.GetAtomTitle('cTErr'), 
                    MB_Ok)
.head 7 -  Return FALSE
.head 6 -  Return TRUE
.head 5 +  Else If ( sParName = 'MaxRate' )
.head 6 -  Set l_mnth   = NUMBER_Null
.head 6 -  Set l_days   = NUMBER_Null
.head 6 +  If SqlPLSQLCommand(hSql(), 
"dpu.get_scalerate( frm_Open.dfTYPEID,  frm_Open.dfKV,   frm_Open.dfVIDD,
                    frm_Open.dfSUM*100, frm_Open.dfDATN, frm_Open.dfDATO,
                    l_mnth,    l_days,  l_actrate, l_maxrate, l_recid )" )
.head 7 +  If ( l_maxrate > 0 AND dfRATE > l_maxrate )
.head 8 -  Return FALSE
.head 6 -  Return TRUE
.head 5 +  Else If ( sParName = 'DueDate' )
.head 6 -  ! Для ДУ про зміну %% перевірка що дата встановлення більша від дати по яку вже нараховано %%
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 2 +  Window Parameters
.head 3 -  Number: pDPU_ID
.head 2 +  Window Variables
.head 3 -  Number: nAgreementId
.head 3 -  String: sTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle( 'dlg_AgreementCreate.cTWndTitle' ) || 
                                 frm_Open.dfND || '(#' || Str(pDPU_ID) || ')' )
.head 4 -  Call PrepareWindowEx( hWndForm )
.head 4 +  If ( frm_Open.nMode != 1 )
.head 5 -  Call SalHideWindow( pb_Create )
.head 5 -  Call SalHideWindow( pb_Exit )
.head 4 +  Else
.head 5 -  Set dfAgreementNumber = Str(dlg_AgreementCreate.pDPU_ID) || "/" || 
                        get_OneStringValue( "select count(1) + 1 INTO :sResult FROM bars.dpu_agreements where DPU_ID = :dlg_AgreementCreate.pDPU_ID" )
.head 4 -  Call f_HIDE_SHOW( 'START' )
.head 4 -  Call f_Populate_Agreements()
.head 4 -  ! *** Поки не реалізовано друк ДУ кнопка pb_Print неактивна ***
.head 4 -  Call SalDisableWindow( pb_Print )
.head 4 -  ! *************************************************************
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalStatusSetText ( hWndForm, sLibraryVersion )
.head 4 -  Call SalStatusSetVisible( hWndForm, TRUE )
.head 1 +  Table Window: DPU_AGREEMENTS_PROCESSING
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Перегляд та обробка ДУ до депозитних договорів ЮО
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  21.217"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.155"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description: Перегляд та обробка ДУ до депозитних договорів ЮО
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.583"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.017"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.15"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.183"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61412
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.55"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  2.55"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.45"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.283"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.717"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Додаткові параметри
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('DPU_AGREEMENTS_PROCESSING.cBTipAgreementDetails')
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog( dlg_AgreementProcessing, hWndForm, nMode, AGR_ID )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.95"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61413
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.883"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  1.883"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.017"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61414
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  10.5"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  10.5"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: AGR_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ідентифікатор
ДУ
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: AGR_NUM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
ДУ
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: AGR_TYPE_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ДУ
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: AGR_TYPE_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва
ДУ
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.517"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: AGR_STATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Статус
ДУ
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DUE_DATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
Виконання
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BANK_DATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
Створення
(банківська)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CREATE_DATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
Створення
(календарна)
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: DateTime
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CREATOR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Автор
Створення
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PRCDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
Обробки
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: DateTime
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PRCUSER
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Автор
Обробки
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: AGR_DPU_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ідентифікатор
Депозитного
Договору
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DPU_BRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Бранч
Депозитного
Договору
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.433"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CUST_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реєстраційний
Номер
Клієнта
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  ! nMode = 1 - Візування ДУ
.head 3 -  ! nMode = 3 - Перегляд ДУ
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('DPU_AGREEMENTS_PROCESSING.WindowTitle') ||IifS(nMode=1," (Візування)"," (Перегляд)") )
.head 4 -  Call PrepareWindowEx( hWndForm )
.head 4 -  Call SalMapEnterToTab( TRUE )
.head 4 -  Set DPU_AGREEMENTS_PROCESSING.strFilterTblName = 'V_DPU_AGREEMENTS'
.head 4 -  Set DPU_AGREEMENTS_PROCESSING.strPrintFileName = 'DPU_AGREEMENTS'
.head 4 -  Set DPU_AGREEMENTS_PROCESSING.nTabInstance = 1
.head 4 -  Set DPU_AGREEMENTS_PROCESSING.strSqlPopulate = "
SELECT AGRMNT_ID,       AGRMNT_NUMBER,  AGRMNT_TYPE_ID,      AGRMNT_TYPE_NAME, AGRMNT_STATE,
       AGRMNT_BDATE,    AGRMNT_CRDATE,  AGRMNT_CREATOR_NAME, 
       AGRMNT_DUE_DATE, AGRMNT_PRCDATE, AGRMNT_HANDLER_NAME,
       AGRMNT_DPU_ID,   CNTRCT_BRANCH,  CNTRCT_CUST_ID
  INTO :AGR_ID,        :AGR_NUM,       :AGR_TYPE_ID, :AGR_TYPE_NAME, :AGR_STATE,
       :BANK_DATE,     :CREATE_DATE,   :CREATOR,
       :DUE_DATE,      :PRCDATE,       :PRCUSER,
       :AGR_DPU_ID,    :DPU_BRANCH,    :CUST_ID
  FROM BARS.V_DPU_AGREEMENTS
 WHERE CNTRCT_BRANCH like sys_context('bars_context','user_branch_mask')
" || IifS( nMode=1,"   AND AGRMNT_STATE = 0","" ) || "
 ORDER BY AGRMNT_ID DESC"
.head 4 -  !
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 4 )
.head 4 +  If ( nMode = 1 )
.head 5 -  ! Hide fields
.head 5 -  Call SalHideWindow( PRCDATE )
.head 5 -  Call SalHideWindow( PRCUSER )
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On SAM_FetchRowDone
.head 4 +  Select Case ( AGR_STATE )
.head 5 +  Case 1
.head 6 -  Call SetTblRowColor( hWndForm, COLOR_DarkGreen )
.head 6 -  Break
.head 5 +  Case 0
.head 6 -  Call SetTblRowColor( hWndForm, COLOR_DarkBlue )
.head 6 -  Break
.head 5 +  Case nNegativeValue
.head 6 -  Call SetTblRowColor( hWndForm, COLOR_Red )
.head 6 -  Break
.head 5 +  Default
.head 6 -  ! AGR_STATE = NUMBER_Null
.head 6 -  Call SetTblRowColor( hWndForm, COLOR_Yellow )
.head 3 +  On SAM_FetchDone
.head 4 +  If Not SalTblAnyRows( DPU_AGREEMENTS_PROCESSING, 0, 0 )
.head 5 -  Call SalDisableWindow( pbFilter  )
.head 5 -  Call SalDisableWindow( pbDetails )
.head 5 -  Call SalStatusSetText( hWndForm, sLibraryVersion )
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg( pbDetails, SAM_Click, 0, 0 )
.head 1 +  Dialog Box: dlg_AgreementProcessing
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Додаткова Угода до депозиту
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  11.3"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.155"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Заключення Додаткових Угод до депозитного договору
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Bottom
.head 4 -  Visible? Yes
.head 4 -  Size: 0.571"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb_Confirm
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cPushButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Погодити
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.1"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.4"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 -  On SAM_Create
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementProcessing.cTMessConfirmAgreement' ) || dfAgreementNumber || "?",
                  CurrentLangTable.GetAtomTitle( 'cTAt' ), 
                  MB_IconQuestion|MB_YesNo ) = IDYES
.head 8 -  Call f_Confirm_Agreement()
.head 8 -  Call SalEndDialog( dlg_AgreementProcessing, TRUE )
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Підтвердити заключення даної угоди' )
.head 4 +  Pushbutton: pb_Exit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cPushButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Вихід
.head 5 -  Window Location and Size
.head 6 -  Left:   7.6"
.head 6 -  Top:    0.1"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.4"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalEndDialog( dlg_AgreementProcessing, FALSE )
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Вихід без збереження змін' )
.head 4 +  Pushbutton: pb_Refuse
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cPushButtonLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Відмовити
.head 5 -  Window Location and Size
.head 6 -  Left:   3.85"
.head 6 -  Top:    0.1"
.head 6 -  Width:  3.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.4"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementProcessing.cTMessRefuseAgreement' ) || dfAgreementNumber || "?",
                  CurrentLangTable.GetAtomTitle( 'cTAt' ), 
                  MB_IconQuestion|MB_YesNo ) = IDYES
.head 8 +  If f_Refuse_Agreement()
.head 9 -  Call SalEndDialog( dlg_AgreementProcessing, TRUE )
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Відмовити в заключенні додаткової угоди' )
.head 2 +  Contents
.head 3 -  Background Text: Додаткова угода №
.head 4 -  Resource Id: 50673
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.6"
.head 5 -  Top:    0.15"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAgreementNumber
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.7"
.head 6 -  Top:    0.13"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If ( SalIsNull(dfAgreementNumber) )
.head 7 -  ! Номер дод.угоди не може бути порожнім
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrNomDopSogl'), 
                    CurrentLangTable.GetAtomTitle('cTAt'), 
                    MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_Ok
.head 3 -  Group Box: Реквізити ДУ
.head 4 -  Resource Id: 50674
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.738"
.head 5 -  Width:  11.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 3.083"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAgreementTypeName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.95"
.head 6 -  Top:    0.94"
.head 6 -  Width:  7.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Вид додаткової угоди:
.head 4 -  Resource Id: 50675
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.17"
.head 5 -  Top:    0.976"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAgreementTypeId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    0.94"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Сума договору:
.head 4 -  Resource Id: 50676
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.17"
.head 5 -  Top:    1.274"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAMOUNT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    1.25"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Validate
.head 6 +  If frm_CreateDeal.nDPU_ID = NUMBER_Null
.head 7 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 6 -  Call SalSendMsg(cmbVIDD, SAM_User, 0, 0)
.head 6 -  Return VALIDATE_Ok
.head 3 -  Background Text: Дата завершення:
.head 4 -  Resource Id: 50677
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.17"
.head 5 -  Top:    1.571"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDATO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    1.548"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Validate
.head 6 +  If NOT SalIsNull( dfDATO )
.head 7 +  If NOT F_VALIDATE( 'DATO' ) 
.head 8 -  ! для НАДРА 
.head 8 +  If ( sDptBankType = 'NADRA' )
.head 9 +  If SalMessageBox( 'Вказана дата порушує строковість рахунку депозиту!' || Chr(10) || Chr(10) ||
                                       'Ви хочете залишити НЕВІРНУ ДАТУ завершення договору?',
                                       CurrentLangTable.GetAtomTitle('cTAt'), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 10 +  If SalMessageBox( 'Ви дійсно хочете залишити невірну дату завершення?',
                                       CurrentLangTable.GetAtomTitle('cTAt'), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 11 -  Set dfDATV = f_GetDateReturn()
.head 11 -  Return VALIDATE_Ok
.head 9 -  Set dfDATO = DATETIME_Null
.head 9 -  Return VALIDATE_Cancel
.head 8 -  ! нормальні банки
.head 8 +  Else 
.head 9 -  ! Некорректно задана дата!
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrDat') || 
                    IifS(dfTERM = NUMBER_Null,'', "Термін депозиту має бути в межах від " || 
                    IifS( dfTERM < 12,  Str(dfTERM) || " до 12 міс.",  "12 міс. до " || Str(dfTERM) ) ), 
                    CurrentLangTable.GetAtomTitle('cTAt'), 
                    MB_IconExclamation )
.head 9 -  Set dfDATO = GetCloseDate(dfDATN, dfTERM, dfKV)
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else 
.head 8 -  Set dfDATV = f_GetDateReturn()
.head 8 +  If dfDPU_ID = NUMBER_Null
.head 9 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 8 -  Return VALIDATE_Ok
.head 6 -  Return VALIDATE_Cancel
.head 3 -  Background Text: Виплата відсотків:
.head 4 -  Resource Id: 50678
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.17"
.head 5 -  Top:    2.179"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFREQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    2.131"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbFREQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.95"
.head 5 -  Top:    2.143"
.head 5 -  Width:  7.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Call cmbFREQ.Init(hWndItem)
.head 6 -  Call cmbFREQ.Populate(hSql(), "FREQ", "NAME", "FREQ", "WHERE FREQ <> :frm_Open.dfFREQ ORDER BY 1")
.head 6 -  Call cmbFREQ.SetSelectById(dfFREQ)
.head 5 +  ! On SAM_Click
.head 6 -  Set dfFREQ = cmbFREQ.GetKey( SalListQuerySelection(cmbFREQ))
.head 3 -  Background Text: Штраф:
.head 4 -  Resource Id: 50679
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.17"
.head 5 -  Top:    2.476"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSTOPID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    2.429"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSTOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.95"
.head 5 -  Top:    2.44"
.head 5 -  Width:  7.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Call cmbSTOP.Init(hWndItem)
.head 6 -  Call cmbSTOP.Populate(hSql(), "ID", "NAME", "DPT_STOP", "WHERE MOD_CODE = 'DPU' OR MOD_CODE IS NULL AND ID <> :frm_Open.dfSTOPID ORDER BY ID")
.head 6 -  Call cmbSTOP.SetSelectById(dfSTOPID)
.head 5 +  ! On SAM_Click
.head 6 -  Set dfSTOPID = cmbSTOP.GetKey(SalListQuerySelection(cmbSTOP))
.head 3 -  Background Text: Відсоткова ставка:
.head 4 -  Resource Id: 50680
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    1.869"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfRATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    1.833"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Индивидуальная % ставка 
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_Open.cFTipIR'))
.head 3 +  Pushbutton: pbCustAcc
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.2"
.head 5 -  Top:    3.083"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.274"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! 'Текущие счета клиента'
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_OpenM.cBTipCustAcc'))
.head 5 +  On SAM_Click
.head 6 -  ! 'Выбрать из справочника текущий счет клиента?'
.head 6 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('frm_OpenM.cTMessGetAcc'),
                  CurrentLangTable.GetAtomTitle('cTAt'),
                  MB_IconQuestion|MB_YesNo) = IDYES
.head 7 -  Set sTmp = STRING_Null
.head 7 -  Call FunNSIGetFiltered( "ACCOUNTS", "NLS", "RNK = " || Str(nRNK) ||
                        " and NBS in ('2520','2523','2600','2650') and ACCOUNTS.KV = "||Str(nKV), sTmp, dfNLSD )
.head 7 -  ! Set dfMFOP = Val(GetBankMfo())
.head 3 +  Picture: picDepPay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    2.738"
.head 5 -  Width:  10.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.98"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Data Field: dfMFOD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    2.798"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If ( SalIsNull(dfMFOD) OR NOT SalIsValidNumber(dfMFOD) )
.head 7 -  Call SalMessageBox( 'Invalid number value', 'Validate Error', MB_Ok )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 +  If NOT SqlPrepareAndExecute( hSql(), "SELECT nb INTO :dfNBD FROM banks WHERE mfo = "||Str(dfMFOD))
OR NOT SqlFetchNext(hSql(), nFetchRes )
.head 8 -  Set dfMFOD = NUMBER_Null
.head 8 -  ! Не нашли банка с МФО dfMFOD
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrMfo') ||' '||Str(dfMFOD),
                    CurrentLangTable.GetAtomTitle('cTAt'),
                    MB_IconExclamation )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 +  If ( dfMFOD != Val(GetBankMfo()) )
.head 9 -  Call SalEnableWindow( dfNLSD )
.head 9 -  Call SalEnableWindow( dfNMSD )
.head 9 -  Call SalDisableWindow( pbCustAcc )
.head 8 +  Else
.head 9 -  Call SalDisableWindow( dfNLSD )
.head 9 -  Call SalDisableWindow( dfNMSD )
.head 9 -  Call SalEnableWindow( pbCustAcc )
.head 8 -  Return VALIDATE_Ok
.head 6 -  ! Return VALIDATE_Ok
.head 5 -  On SAM_KillFocus
.head 3 -  Background Text: Банк отримувача:
.head 4 -  Resource Id: 50681
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.27"
.head 5 -  Top:    2.821"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.24"
.head 6 -  Top:    2.798"
.head 6 -  Width:  6.66"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Рахунок отримувача:
.head 4 -  Resource Id: 50682
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.27"
.head 5 -  Top:    3.119"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    3.083"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfNLSD != ''
.head 7 +  If Vkrz2(Str(dfMFOD),dfNLSD) != dfNLSD
.head 8 -  ! Ошибка в контрольном разряде счета!
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAcc'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation)
.head 8 -  Set dfNLSD = ''
.head 7 +  Else
.head 8 +  If dfMFOD = Val(GetBankMfo())
.head 9 +  If SqlPrepareAndExecute( hSql(),
   "SELECT a.rnk, substr(a.nms, 1, 38)
      INTO :nTmp, :dfNMSD
      FROM accounts a
     WHERE a.kv  = :dfKV
       AND a.nls = :dfNLSD
       AND a.dazs is null")
and not SqlFetchNext( hSql(), nFetchRes )
.head 10 -  ! Счет не открыт!
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('_cTErrAccNotOpen'),
                   CurrentLangTable.GetAtomTitle('cTAt'),
                   MB_IconExclamation)
.head 10 -  Set dfNLSD = ''
.head 9 +  Else
.head 10 -  ! Счет открыт на другого клиента! Продолжить?
.head 10 +  If dlg_DealGeneralParams.dfRNK != nTmp AND
SalMessageBox(CurrentLangTable.GetAtomTitle('_cTMessAccRnk'),
              CurrentLangTable.GetAtomTitle('cTAt'),
              MB_IconQuestion|MB_YesNo) = IDNO
.head 11 -  Set dfNLSD = ''
.head 6 -  Return VALIDATE_Ok
.head 3 +  Data Field: dfNMSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    3.369"
.head 6 -  Width:  7.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Назва отримувача:
.head 4 -  Resource Id: 50683
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.27"
.head 5 -  Top:    3.405"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Дата початку дії дод. угоди
.head 4 -  Resource Id: 50684
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.6"
.head 5 -  Top:    0.48"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDueDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.7"
.head 6 -  Top:    0.45"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Validate
.head 6 +  If NOT SalIsNull( dfDATO )
.head 7 +  If NOT F_VALIDATE( 'DATO' ) 
.head 8 -  ! для НАДРА 
.head 8 +  If ( sDptBankType = 'NADRA' )
.head 9 +  If SalMessageBox( 'Вказана дата порушує строковість рахунку депозиту!' || Chr(10) || Chr(10) ||
                                       'Ви хочете залишити НЕВІРНУ ДАТУ завершення договору?',
                                       CurrentLangTable.GetAtomTitle('cTAt'), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 10 +  If SalMessageBox( 'Ви дійсно хочете залишити невірну дату завершення?',
                                       CurrentLangTable.GetAtomTitle('cTAt'), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 11 -  Set dfDATV = f_GetDateReturn()
.head 11 -  Return VALIDATE_Ok
.head 9 -  Set dfDATO = DATETIME_Null
.head 9 -  Return VALIDATE_Cancel
.head 8 -  ! нормальні банки
.head 8 +  Else 
.head 9 -  ! Некорректно задана дата!
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrDat') || 
                    IifS(dfTERM = NUMBER_Null,'', "Термін депозиту має бути в межах від " || 
                    IifS( dfTERM < 12,  Str(dfTERM) || " до 12 міс.",  "12 міс. до " || Str(dfTERM) ) ), 
                    CurrentLangTable.GetAtomTitle('cTAt'), 
                    MB_IconExclamation )
.head 9 -  Set dfDATO = GetCloseDate(dfDATN, dfTERM, dfKV)
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else 
.head 8 -  Set dfDATV = f_GetDateReturn()
.head 8 +  If dfDPU_ID = NUMBER_Null
.head 9 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 8 -  Return VALIDATE_Ok
.head 6 -  Return VALIDATE_Cancel
.head 3 +  Data Field: dfCrUserID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    4.0"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Индивидуальная % ставка 
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_AgreementProcessing.cFTipCrUserID') )
.head 3 +  Data Field: dfCrUserNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.24"
.head 6 -  Top:    4.0"
.head 6 -  Width:  6.66"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Индивидуальная % ставка 
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_AgreementProcessing.cFTipCrUserNAME') )
.head 3 -  Group Box: Створена:
.head 4 -  Resource Id: 24972
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    3.85"
.head 5 -  Width:  11.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfCrUserDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.6"
.head 6 -  Top:    4.0"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Validate
.head 6 +  If NOT SalIsNull( dfDATO )
.head 7 +  If NOT F_VALIDATE( 'DATO' ) 
.head 8 -  ! для НАДРА 
.head 8 +  If ( sDptBankType = 'NADRA' )
.head 9 +  If SalMessageBox( 'Вказана дата порушує строковість рахунку депозиту!' || Chr(10) || Chr(10) ||
                                       'Ви хочете залишити НЕВІРНУ ДАТУ завершення договору?',
                                       CurrentLangTable.GetAtomTitle('cTAt'), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 10 +  If SalMessageBox( 'Ви дійсно хочете залишити невірну дату завершення?',
                                       CurrentLangTable.GetAtomTitle('cTAt'), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 11 -  Set dfDATV = f_GetDateReturn()
.head 11 -  Return VALIDATE_Ok
.head 9 -  Set dfDATO = DATETIME_Null
.head 9 -  Return VALIDATE_Cancel
.head 8 -  ! нормальні банки
.head 8 +  Else 
.head 9 -  ! Некорректно задана дата!
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrDat') || 
                    IifS(dfTERM = NUMBER_Null,'', "Термін депозиту має бути в межах від " || 
                    IifS( dfTERM < 12,  Str(dfTERM) || " до 12 міс.",  "12 міс. до " || Str(dfTERM) ) ), 
                    CurrentLangTable.GetAtomTitle('cTAt'), 
                    MB_IconExclamation )
.head 9 -  Set dfDATO = GetCloseDate(dfDATN, dfTERM, dfKV)
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else 
.head 8 -  Set dfDATV = f_GetDateReturn()
.head 8 +  If dfDPU_ID = NUMBER_Null
.head 9 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 8 -  Return VALIDATE_Ok
.head 6 -  Return VALIDATE_Cancel
.head 3 +  Data Field: dfPrcUserDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.6"
.head 6 -  Top:    4.5"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  ! On SAM_Validate
.head 6 +  If NOT SalIsNull( dfDATO )
.head 7 +  If NOT F_VALIDATE( 'DATO' ) 
.head 8 -  ! для НАДРА 
.head 8 +  If ( sDptBankType = 'NADRA' )
.head 9 +  If SalMessageBox( 'Вказана дата порушує строковість рахунку депозиту!' || Chr(10) || Chr(10) ||
                                       'Ви хочете залишити НЕВІРНУ ДАТУ завершення договору?',
                                       CurrentLangTable.GetAtomTitle('cTAt'), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 10 +  If SalMessageBox( 'Ви дійсно хочете залишити невірну дату завершення?',
                                       CurrentLangTable.GetAtomTitle('cTAt'), 
                                       MB_IconQuestion|MB_YesNo ) = IDYES
.head 11 -  Set dfDATV = f_GetDateReturn()
.head 11 -  Return VALIDATE_Ok
.head 9 -  Set dfDATO = DATETIME_Null
.head 9 -  Return VALIDATE_Cancel
.head 8 -  ! нормальні банки
.head 8 +  Else 
.head 9 -  ! Некорректно задана дата!
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('_cTErrDat') || 
                    IifS(dfTERM = NUMBER_Null,'', "Термін депозиту має бути в межах від " || 
                    IifS( dfTERM < 12,  Str(dfTERM) || " до 12 міс.",  "12 міс. до " || Str(dfTERM) ) ), 
                    CurrentLangTable.GetAtomTitle('cTAt'), 
                    MB_IconExclamation )
.head 9 -  Set dfDATO = GetCloseDate(dfDATN, dfTERM, dfKV)
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else 
.head 8 -  Set dfDATV = f_GetDateReturn()
.head 8 +  If dfDPU_ID = NUMBER_Null
.head 9 -  Set dfIR = f_getscalerate(dfVIDD, dfDATN, dfDATO, dfSUM, FALSE)
.head 8 -  Return VALIDATE_Ok
.head 6 -  Return VALIDATE_Cancel
.head 3 -  Group Box: Оброблена:
.head 4 -  Resource Id: 24973
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    4.35"
.head 5 -  Width:  11.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.6"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Group Box: Коментар
.head 4 -  Resource Id: 24974
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickGroupBox
.head 4 -  Window Location and Size
.head 5 -  Left:   0.2"
.head 5 -  Top:    5.036"
.head 5 -  Width:  10.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.8"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Multiline Field: mlCOMMENT
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 128
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.3"
.head 6 -  Top:    5.238"
.head 6 -  Width:  10.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPrcUserID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.22"
.head 6 -  Top:    4.5"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Индивидуальная % ставка 
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_AgreementProcessing.cFTipPrcUserID') )
.head 3 +  Data Field: dfPrcUserNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.24"
.head 6 -  Top:    4.5"
.head 6 -  Width:  6.66"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  ! Индивидуальная % ставка 
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'dlg_AgreementProcessing.cFTipPrcUserNAME' ) )
.head 2 +  Functions
.head 3 +  Function: f_HIDE_SHOW
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sName
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If ( sName = 'START' )
.head 6 -  Call SalDisableWindow( dfDueDate )
.head 6 -  Call SalDisableWindow( dfAMOUNT )
.head 6 -  Call SalDisableWindow( dfDATO )
.head 6 -  Call SalDisableWindow( dfRATE )
.head 6 -  Call SalDisableWindow( cmbFREQ )
.head 6 -  Call SalDisableWindow( cmbSTOP )
.head 6 -  Call SalDisableWindow( dfMFOD )
.head 6 -  Call SalDisableWindow( dfNLSD )
.head 6 -  Call SalDisableWindow( dfNMSD )
.head 6 -  Call SalDisableWindow( pbCustAcc )
.head 5 +  If ( sName = 'SELECT' )
.head 6 -  Call f_HIDE_SHOW( 'START' )
.head 6 +  Select Case ( dfAgreementTypeId )
.head 7 +  Case 1
.head 8 -  ! ДУ про зміну суми договору
.head 8 -  Call SalEnableWindow( dfAMOUNT )
.head 8 -  Break
.head 7 +  Case 2
.head 8 -  ! ДУ про зміну відсоткової ставки по договору
.head 8 -  Call SalEnableWindow( dfDueDate )
.head 8 -  Call SalEnableWindow( dfRATE )
.head 8 -  Break
.head 7 +  Case 3
.head 8 -  ! ДУ про зміну періодичності виплати відсотків
.head 8 -  Call SalEnableWindow( cmbFREQ )
.head 8 -  Break
.head 7 +  Case 4
.head 8 -  ! ДУ про зміну рахунку повернення депозиту та нарахованих відсотків
.head 8 -  Call SalEnableWindow( dfMFOD )
.head 8 -  Break
.head 7 +  Case 5
.head 8 -  ! ДУ про зміну терміну договору
.head 7 +  Case 7
.head 8 -  ! Додаткова угода про пролонгацію договору
.head 8 -  Call SalEnableWindow( dfDueDate )
.head 8 -  Call SalEnableWindow( dfDATO )
.head 8 -  Break
.head 7 +  Case 6
.head 8 -  ! ДУ про зміну умов дострокового повернення коштів
.head 8 -  Call SalEnableWindow( cmbSTOP )
.head 8 -  Break
.head 7 -  Default
.head 3 +  Function: f_Confirm_Agreement
.head 4 -  Description: Підтвердження (візування) 
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If SqlPLSQLCommand( hSql(), "DPU_AGR.CONFIRM_AGREEMENT( pAgreementId )" )
.head 6 -  Call SqlCommit( hSql() )
.head 6 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementProcessing.cTMessConfirmAgreementDone' ) || ' #' || Str(pAgreementId),
                    CurrentLangTable.GetAtomTitle( 'cTAt' ),
                    MB_IconInformation )
.head 5 +  Else
.head 6 -  Call SqlRollback( hSql() )
.head 6 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementProcessing.cTMessConfirmAgreementError' ) || ' #' || Str(pAgreementId),
                    CurrentLangTable.GetAtomTitle( 'cTErr' ),
                    MB_IconStop )
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: f_Populate_Agreement
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  When SqlError
.head 6 -  Call MessageError( "Form Populate Error!" )
.head 6 -  Return FALSE
.head 5 +  If SqlPrepareAndExecute( hSql(),
"select AGRMNT_NUMBER, AGRMNT_DUE_DATE, AGRMNT_TYPE_ID, AGRMNT_TYPE_NAME,
        AGRMNT_AMOUNT/100, AGRMNT_RATE,     AGRMNT_FREQ,    AGRMNT_STOP_ID,
        AGRMNT_DPU_ID, CNTRCT_CUST_ID,  AGRMNT_STATE,
        AGRMNT_CREATOR_ID, AGRMNT_CREATOR_NAME, AGRMNT_CRDATE,
        AGRMNT_HANDLER_ID, AGRMNT_HANDLER_NAME, AGRMNT_PRCDATE
   into :dfAgreementNumber, :dfDueDate, :dfAgreementTypeId, :dfAgreementTypeName,
        :dfAMOUNT, :dfRATE, :dfFREQ, :dfSTOPID,
        :nDPU_ID,  :nRNK, :nState,
        :dfCrUserID, :dfCrUserNAME, :dfCrUserDATE, :dfPrcUserID, :dfPrcUserNAME, :dfPrcUserDATE
   from BARS.V_DPU_AGREEMENTS
  where AGRMNT_ID = :pAgreementId" )
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  Select Case ( dfAgreementTypeId )
.head 7 +  Case 1
.head 8 -  ! ДУ про зміну суми договору
.head 8 -  ! Call SalEnableWindow( dfAMOUNT )
.head 8 -  Break
.head 7 +  Case 2
.head 8 -  ! ДУ про зміну відсоткової ставки по договору
.head 8 -  ! Call SalEnableWindow( dfDueDate )
.head 8 -  ! Call SalEnableWindow( dfRATE )
.head 8 -  Break
.head 7 +  Case 3
.head 8 -  ! ДУ про зміну періодичності виплати відсотків
.head 8 -  ! Call SalEnableWindow( cmbFREQ )
.head 8 -  Set cmbFREQ = get_OneStringValue( "select NAME into :sResult from BARS.FREQ where FREQ = " || Str(dfFREQ) )
.head 8 -  Break
.head 7 +  Case 4
.head 8 -  ! ДУ про зміну рахунку повернення депозиту та нарахованих відсотків
.head 8 -  ! Call SalEnableWindow( dfMFOD )
.head 8 -  ! Call SalEnableWindow( pbCustAcc )
.head 8 +  If SqlPrepareAndExecute( hSql(),
"select extractValue( t.XMLDATA,'/details/dep/mfo/text()') as mfo_d
      , extractValue( t.XMLDATA,'/details/dep/nls/text()') as nls_d
      , extractValue( t.XMLDATA,'/details/dep/nmk/text()') as nmk_d
   into :dfMFOD, :dfNLSD, :dfNMSD
   from ( select DPU_ID, AGRMNT_ID, XMLType(PAYMENT_DETAILS) as XMLDATA 
          from DPU_AGREEMENTS
         where AGRMNT_ID = :pAgreementId
           and AGRMNT_TYPE = 4
       ) t" )
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set dfNBD = get_OneStringValue( "select NB into :sResult from BARS.BANKS$BASE where MFO = " || Str(dfMFOD) )
.head 8 -  Break
.head 7 +  Case 5
.head 8 -  ! ДУ про зміну терміну договору
.head 7 +  Case 7
.head 8 -  ! Додаткова угода про пролонгацію договору
.head 8 -  ! Call SalEnableWindow( dfDueDate )
.head 8 -  ! Call SalEnableWindow( dfDATO )
.head 8 -  ! Call SalEnableWindow( dfRATE ) 
.head 8 -  Break
.head 7 +  Case 6
.head 8 -  ! ДУ про зміну умов дострокового повернення коштів
.head 8 -  ! Call SalEnableWindow( cmbSTOP )
.head 8 -  Set cmbSTOP = get_OneStringValue( "select NAME into :sResult from BARS.DPT_STOP where ID = " || Str(dfSTOPID) )
.head 8 -  Break
.head 7 -  Default
.head 3 +  Function: f_Refuse_Agreement
.head 4 -  Description: Відмова (сторнування)
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bPar
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If f_VALIDATE('COMMENT') 
.head 6 +  If SqlPLSQLCommand( hSql(), "DPU_AGR.REFUSE_AGREEMENT( pAgreementId, mlCOMMENT )" )
.head 7 -  Call SqlCommit( hSql() )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementProcessing.cTMessRefuseAgreementDone' ) || ' #' || Str(pAgreementId),
                    CurrentLangTable.GetAtomTitle( 'cTAt' ),
                    MB_IconInformation )
.head 7 -  Set bPar = TRUE
.head 6 +  Else
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementProcessing.cTMessRefuseAgreementError' ) || ' #' || Str(pAgreementId),
                    CurrentLangTable.GetAtomTitle( 'cTErr' ),
                    MB_IconStop )
.head 7 -  Set bPar = FALSE
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return bPar
.head 3 +  Function: f_VALIDATE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sParName
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If ( sParName = 'COMMENT' )
.head 6 +  If ( SalIsNull(mlCOMMENT) )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementProcessing.cTMessCommentIsNull' ), 
                    CurrentLangTable.GetAtomTitle( '_cTErrCheck' ), MB_Ok )
.head 7 -  Return FALSE
.head 6 +  If ( Len(mlCOMMENT) < 15 )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementProcessing.cTMessCommentInsufficientLength' ),
                    CurrentLangTable.GetAtomTitle( '_cTErrCheck' ), MB_Ok )
.head 7 -  Return FALSE
.head 6 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  ! nMode = 1 - Візування ДУ
.head 3 -  ! nMode = 3 - Перегляд  ДУ
.head 3 -  Number: pAgreementId
.head 2 +  Window Variables
.head 3 -  Number: nDPU_ID
.head 3 -  Number: nRNK
.head 3 -  Number: nState
.head 3 -  Number: nKV
.head 3 -  Number: nTmp
.head 3 -  String: sTmp
.head 3 -  Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle( 'dlg_AgreementProcessing.cTWndTitle' ) || ' #' || Str(pAgreementId) )
.head 4 -  Call PrepareWindowEx( hWndForm )
.head 4 -  Call f_HIDE_SHOW( 'START' )
.head 4 -  Call f_Populate_Agreement()
.head 4 +  If ( nMode = 3 )
.head 5 -  Call SalDisableWindow( pb_Confirm )
.head 5 -  Call SalDisableWindow( pb_Refuse )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalStatusSetText ( hWndForm, sLibraryVersion )
.head 4 -  Call SalStatusSetVisible( hWndForm, TRUE )
.head 3 +  On SAM_CreateComplete
.head 4 +  If ( ( nMode < 3 ) AND ( dfCrUserID = GetUserId() ) )
.head 5 -  Call SalDisableWindow( pb_Confirm )
.head 5 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_AgreementProcessing.cTMessDeniedСonfirmAgreement' ),
                    CurrentLangTable.GetAtomTitle( 'cTErr' ),
                    MB_IconStop )
.head 3 +  On SAM_Destroy
.head 4 -  Call SalSendMsg( DPU_AGREEMENTS_PROCESSING.pbRefresh, SAM_Click, 0, 0 )
.head 1 +  Dialog Box: dlg_DealPayOutSwiftDetails
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.3"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.774"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8179
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    0.119"
.head 5 -  Width:  9.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.726"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb_SW56_BANKS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.05"
.head 5 -  Top:    0.86"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Вибір банку-посередника')
.head 6 -  ! Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_Open.cFTipBranchName' ) )
.head 5 +  On SAM_Click
.head 6 +  If FunNSIGet( "SW_BANKS", "NAME", dfSW56_Code, dfSW56_Name )
.head 7 -  Set dfSW56_Adr = get_OneStringValue("select SubStr(OFFICE,1,50) into :sResult from SW_BANKS where BIC = :dfSW57_Code")
.head 6 +  Else
.head 7 -  ! << Не вибрано жодного значення з довідника >>
.head 7 -  ! Set dfSW56_Code = STRING_Null
.head 7 -  ! Set dfSW57_Name = STRING_Null
.head 3 -  Background Text: Банк-посредник (56)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8180
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.0"
.head 5 -  Width:  2.817"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.238"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Название:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8181
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    0.298"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSW56_Name
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    0.298"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW56_Name') )
.head 3 -  Background Text: Адрес:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8182
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    0.56"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSW56_Adr
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    0.6"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW56_Adr') )
.head 3 -  Background Text: SWIFT-код:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8183
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    0.821"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSW56_Code
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 11
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    0.89"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW56_Code') )
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8184
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    1.321"
.head 5 -  Width:  9.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.44"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb_SW57_BANKS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbGetValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.05"
.head 5 -  Top:    2.05"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Вибір Бранчу Договору')
.head 6 -  ! Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle( 'frm_Open.cFTipBranchName' ) )
.head 5 +  On SAM_Click
.head 6 -  If FunNSIGet( "SW_BANKS", "NAME", dfSW57_Code, dfSW57_Name )
.head 6 -  Set dfSW57_Adr = get_OneStringValue("select SubStr(OFFICE,1,50) into :sResult from SW_BANKS where BIC = :dfSW57_Code")
.head 3 -  Background Text: Банк-Бенефициар (57)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8185
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    1.202"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.238"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Название:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8186
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    1.524"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSW57_Name
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    1.524"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW57_Name') )
.head 3 -  Background Text: Адрес:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8187
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    1.774"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSW57_Adr
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    1.79"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW57_Adr') )
.head 3 -  Background Text: SWIFT-код:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8188
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    2.024"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSW57_Code
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 11
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    2.06"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.3"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW57_Code') )
.head 3 -  Background Text: Счет:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8189
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    2.274"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSW57_Acc
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    2.35"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.27"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW57_Acc') )
.head 3 -  Background Text: (банка-бенефициара в банке-посреднике)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8190
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.1"
.head 5 -  Top:    2.35"
.head 5 -  Width:  4.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Бенефициар (59)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8191
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    2.631"
.head 5 -  Width:  2.417"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.238"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Название:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8192
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    2.952"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSW59_Name
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    2.952"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW59_Name') )
.head 3 -  Background Text: Адрес:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8193
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    3.202"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSW59_Adr
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    3.202"
.head 6 -  Width:  6.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW59_Adr') )
.head 3 -  Background Text: Счет:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 8194
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    3.452"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSW59_Acc
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.467"
.head 6 -  Top:    3.452"
.head 6 -  Width:  2.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam,CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW59_Acc'))
.head 3 +  Pushbutton: pb_Save
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Зберегти
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    3.929"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.pb_Save') )
.head 5 +  On SAM_Click
.head 6 +  If SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_DealPayOutSwiftDetails.cTMessSaveChange' ),
                  CurrentLangTable.GetAtomTitle( 'cTAt' ), 
                  MB_IconQuestion|MB_YesNo ) = IDYES
.head 7 -  ! Зберігаємо SWIFT реквізити
.head 7 +  If F_VALIDATE('ALL')
.head 8 -  Call p_Save()
.head 7 -  ! EXIT
.head 7 -  Call SalEndDialog( dlg_DealPayOutSwiftDetails, TRUE)
.head 3 +  Pushbutton: pb_Cancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Відмінити
.head 4 -  Window Location and Size
.head 5 -  Left:   5.267"
.head 5 -  Top:    3.929"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Red
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.pb_Cancel') )
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlg_DealPayOutSwiftDetails, FALSE)
.head 2 +  Functions
.head 3 +  Function: p_Save
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If SqlPLSQLCommand( hSql(), 
"dpu.set_dealswtags( nDPU_ID, dfSW56_Name, dfSW56_Adr, dfSW56_Code,
                              dfSW57_Name, dfSW57_Adr, dfSW57_Code, dfSW57_Acc,
                              dfSW59_Name, dfSW59_Adr,              dfSW59_Acc )" )
.head 6 -  Call SqlCommit( hSql() )
.head 6 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'dlg_DealPayOutSwiftDetails.cTMessSaveSwiftDetailsDone'),
                    CurrentLangTable.GetAtomTitle( 'cTAt' ),
                    MB_IconInformation )
.head 5 +  Else
.head 6 -  Call SqlRollback( hSql() )
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: f_Populate
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute(hSql(), 
"SELECT tag56_name, tag56_adr, tag56_code,   
        tag57_name, tag57_adr, tag57_code, tag57_acc,   
        tag59_name, tag59_adr, tag59_acc
   INTO :dfSW56_Name, :dfSW56_Adr, :dfSW56_Code,
        :dfSW57_Name, :dfSW57_Adr, :dfSW57_Code, :dfSW57_Acc,
        :dfSW59_Name, :dfSW59_Adr,               :dfSW59_Acc
   FROM dpu_deal_swtags 
  WHERE dpu_id = :nDPU_ID" )
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes )
.head 5 +  If ( SalIsNull( dfSW59_Name ) AND SalIsNull( dfSW59_Adr ) AND SalIsNull( dfSW59_Acc ) )
.head 6 -  Set dfSW59_Acc = frm_Open.dfNLSD
.head 6 +  If SqlPrepareAndExecute(hSql(), 
"SELECT SubStr(coalesce(NMKV,F_TRANSLATE_KMU(NMK)),1,100), SubStr(F_TRANSLATE_KMU(ADR),1,50)
   INTO :dfSW59_Name, :dfSW59_Adr
   FROM BARS.CUSTOMER
  WHERE rnk = :frm_Open.dfRNK" )
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes )
.head 3 +  Function: F_VALIDATE
.head 4 -  Description: Преревірка заповнення полів
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sParName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sErrorList
.head 5 -  Number: nErrorCount
.head 4 +  Actions
.head 5 +  If ( sParName = 'ALL' )
.head 6 -  Set sErrorList = ''
.head 6 -  Set nErrorCount = 0
.head 6 -  ! sErrorList = Не заполнен реквизит <...>
.head 6 +  If nDPU_ID = NUMBER_Null
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)   ||': '
                || CurrentLangTable.GetAtomTitle('_cTErrRekv')      ||' <'
                || CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipND')||'>'||PutCrLf()
.head 6 -  ! < Банк-Посередник (56) >
.head 6 +  If NOT SalIsNull(dfSW57_Acc)
.head 7 -  ! Вказано Рахунок Банку-Бенефіціара в Банку-Посереднику і
.head 7 +  If SalIsNull(dfSW56_Name)
.head 8 -  ! Не вказано Назву Банка-Посередника
.head 7 +  If SalIsNull(dfSW56_Adr)
.head 8 -  ! Не вказано Адресу Банка-Посередника
.head 7 +  If SalIsNull(dfSW56_Code)
.head 8 -  ! Не вказано SWIFT-код Банка-Посередника
.head 6 -  ! < Банк-Бенефіціар (57) >
.head 6 +  If SalIsNull(dfSW57_Name)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)   ||': ' 
                 || CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'
                 || CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW57_Name')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfSW57_Adr)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)   ||': '
                 || CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'
                 || CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW57_Adr')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfSW57_Code)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0)   || ': '
                 || CurrentLangTable.GetAtomTitle('_cTErrRekv') ||' <'
                 || CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW57_Code')||'>'||PutCrLf()
.head 6 +  If SalIsNull(dfSW57_Acc) AND NOT ( SalIsNull(dfSW56_Name) AND SalIsNull(dfSW56_Adr) AND SalIsNull(dfSW56_Code) )
.head 7 -  ! Не вказано Рахунок Банку-Бенефіціара в Банку-Посереднику (якщо вказані реквізити Банка-Посередника)
.head 7 -  Set nErrorCount = nErrorCount + 1
.head 7 -  Set sErrorList = sErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cFTipSW57_Acc') || PutCrLf()
.head 6 -  ! < Бенефіціар (59) >
.head 6 -  ! ---------------------
.head 6 +  If ( nErrorCount > 0 )
.head 7 -  ! Ошибка заполнения реквизитов
.head 7 -  Call SalMessageBox( sErrorList
                  , CurrentLangTable.GetAtomTitle('_cTErrCheck')
                  , MB_Ok )
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: nDPU_ID
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dlg_DealPayOutSwiftDetails.cTWndTitle') || 
                                 frm_Open.dfND || '(#' || Str(nDPU_ID) || ')' )
.head 4 -  Call PrepareWindowEx( hWndForm )
.head 4 +  If ( frm_Open.nMode != 1 )
.head 5 -  Call SalHideWindow( pb_Save )
.head 5 -  Call SalHideWindow( pb_Cancel )
.head 4 -  Call f_Populate()
.head 4 -  ! *************************************************************
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalStatusSetText ( hWndForm, sLibraryVersion )
.head 4 -  Call SalStatusSetVisible( hWndForm, TRUE )
