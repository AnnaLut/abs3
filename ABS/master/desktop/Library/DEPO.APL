Application Description: Centura  Builder starter application
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650200010000
0020: 0000000000000000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFDEFFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773084649
0080: 4E5F4F4B504F
.enddata
.data DT_MAKERUNDLG
0000: 02000000001A433A 5C6261727339385C 4C4942524152595C 4445504F2E657865
0020: 1A433A5C62617273 39385C4C49425241 52595C4445504F2E 646C6C1A433A5C62
0040: 61727339385C4C49 42524152595C4445 504F2E6170630000 0101011A433A5C62
0060: 61727339385C4C49 42524152595C4445 504F2E72756E1A43 3A5C626172733938
0080: 5C4C494252415259 5C4445504F2E646C 6C1A433A5C626172 7339385C4C494252
00A0: 4152595C4445504F 2E61706300000101 01145C6261727339 385C42494E5C4445
00C0: 504F2E617064145C 6261727339385C42 494E5C4445504F2E 646C6C145C626172
00E0: 7339385C42494E5C 4445504F2E617063 00000101011A433A 5C6261727339385C
0100: 4C4942524152595C 4445504F2E61706C 1A433A5C62617273 39385C4C49425241
0120: 52595C4445504F2E 646C6C1A433A5C62 61727339385C4C49 42524152595C4445
0140: 504F2E6170630000 010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		Dynalib: Global.apd
		Dynalib: Absapi.apd
		Dynalib: Nsiapi.apd
		Dynalib: Otcn.apd
		Dynalib: Custacnt.apd
		Dynalib: Docview.apd
		Dynalib: Bars020.apd
		Dynalib: Bars017.apd
		File Include: Gentbl.apl
		File Include: Genlist.apl
		File Include: Constant.apl
		File Include: Genbutn.apl
		File Include: qckdvc.apl
		File Include: Xsalcpt.apl
		File Include: Vtfile.apl
		File Include: Vtdos.apl
		File Include: Docfun6.apl
		File Include: msoffice.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Number: ####0000
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
		Resources
		Variables
.data RESOURCE 0 0 1 3093821895
0000: 380000001D000000 0000000000000000 02000002000000E2 000000E0010D0000
0020: 00FF3FEF00800000 0204000000FFFF
.enddata
			! ! Kod методики по анализу фин состояния  2-Банк Киев, 3-Банк АЖИО'
					  из PARAMS
			String: sOKPO_
			String: mFin
			Number: nTip_Kl_G
			Number: nPR_30
			Number: nPR_70
			! !
			Number: nFetchRes
			String: sComm
			String: sVal
			Window Handle: h_T8
			Window Handle: hW_1
			Window Handle: hKV5
			Window Handle: hDELO
			Window Handle: hDELO1
			Window Handle: hFIN
			Window Handle: hFINS
			Window Handle: hFINS_expl
			! Window Handle: hRNK
			Number: nOKPO
			Window Handle: hF0
			Window Handle: hF1
			Window Handle: hF2
			Window Handle: hF3
			Window Handle: hF4
			Window Handle: hLOG
			Window Handle: hKOEF
			Window Handle: hMOS
			Window Handle: hMOS1
			Window Handle: hW57
		Internal Functions
			Function: DEPO                               ! __exported
				Description:
				Returns
				Parameters
					Window Handle: hW
					Number: nPar1
					Number: nPar2
				Static Variables
				Local variables
				Actions
					! Call Debug(' nPar1='||Str(nPar1))
					! Call Debug(' nPar2='||Str(nPar2))
					! Перенесення залишків рахунків на інші з закриттям старих
					If nPar1 = 1
						If not IsWindow(hW_1)
							Set hW_1 = SalCreateWindow(TB, hW, nPar1, nPar2)
						Else
							Call SalBringWindowToTop ( hW_1 )
					! -----------------
					! Архів кореспонденцій
					Else If nPar1 = 77
						If not IsWindow(hDELO)
							Set hDELO = SalCreateWindow(DELO, hW, nPar1, nPar2)
						Else
							Call SalBringWindowToTop ( hDELO )
					! -----------------
					! Дополнительные реквизиты кредитных договоров
					Else If nPar1 = 55
						If not IsWindow(hMOS)
							Set hMOS = SalCreateWindow(MOS, hW, nPar1, nPar2)
						Else
							Call SalBringWindowToTop ( hMOS )
					! Формирование и выгрузка в Excel отчета для МОСКВЫ
					Else If nPar1 = 56
						Call SalModalDialog( Dlg_EX, hWndForm, nPar1, nPar2 )
					! Управление заблокированніми отв.платежами
					Else If nPar1 = 57
						If not IsWindow(hW57)
							Set hW57 = SalCreateWindow(TSG, hW, nPar1, nPar2)
						Else
							Call SalBringWindowToTop ( hW57 )
					!
					! ////////////////////////////////////
					Set mFin = GetGlobalOption('FIN_STAN')
					If mFin = STRING_Null
						Set mFin = '2'
					! Фінансові звіти клієнтів (ЮО)
					If nPR_30 = NUMBER_Null 
							OR nPR_70 = NUMBER_Null 
							OR nPR_30+nPR_70 != 100
						Set nPR_30 = 30
						If SqlPrepareAndExecute(hSql(), 
								"SELECT pr into :nPR_30 from fin_pok_vid where vid=2 and pr >0 ")
								and SqlFetchNext(hSql(), nFetchRes)
						Set nPR_70 = 100 - nPR_30
					If nPar1 = 60
						If not IsWindow(hFIN)
							Set hFIN = SalCreateWindow( FIN_OKPO, hW, 2, nPar2)
						Else
							Call SalBringWindowToTop ( hFIN )
					! Фінансові звіти клієнтів (ФО)
					If nPar1 = 63
						If not IsWindow(hFIN)
							Set hFIN = SalCreateWindow(FIN_OKPO, hW, 3, nPar2)
						Else
							Call SalBringWindowToTop ( hFIN )
					! Фінансові звіти клієнтів (СПД = ЧП)
					If nPar1 = 64
						If not IsWindow(hFIN)
							Set hFIN = SalCreateWindow(FIN_OKPO, hW, 23, nPar2)
						Else
							Call SalBringWindowToTop ( hFIN )
					! ////////////////////////////////////
					! !!!! NMK - Аналіз фінансового стану
					If nPar1 = 0 or nPar1 = -1
						If IsWindow(h_T8)
							Call SalDestroyWindow(h_T8)
						! Call Debug('mFin='||mFin)
						If mFin='3'
							Set h_T8 = SalCreateWindow(FIN3, hW, nPar1, nPar2)
						Else If mFin='2' OR mFin='4'
							Set h_T8 = SalCreateWindow(T8, hW, nPar1, nPar2)
					!
					! ! оценка фин.состояния для SEB (Маша)
					If nPar1 = 65 or nPar1 = 66 or nPar1 = 67
						! вызов в режиме редактирования или в режиме просмотра истории, соотв.
						If not IsWindow(hFINS)
							Set hFINS = SalCreateWindow(FINS_main, hW, nPar1-65)
						Else
							Call SalBringWindowToTop(hFINS)
			Function: FIN_LOGK                           ! __exported
				Description:
				Returns
				Parameters
					Window Handle: hW
					Date/Time: DAT
					Number: RNK
					String: FZ
					Number: nForm
					String: sForm
				Static Variables
				Local variables
				Actions
					If not IsWindow(hLOG)
						If nForm = 1 or nForm = 2
							Set hLOG = SalCreateWindow(FIN_L, hWndMDI,DAT,RNK,FZ,nForm,sForm )
						! Else If nForm = 2
							                                                                                                                                                   Set hLOG = SalCreateWindow(FIN_L2, hWndMDI,DAT,RNK,FZ,nForm,sForm )
						Else
							Return FALSE
					Else
						Call SalBringWindowToTop ( hLOG )
			Function: DOP_MOS                             ! __exported
				Description:
				Returns
				Parameters
					Number: ND
					String: CC_ID
					String: NMK
					String: sPar1
				Static Variables
				Local variables
				Actions
					If not IsWindow(hMOS1)
						Set hMOS1 = SalCreateWindow(MOS1, hWndMDI, ND, CC_ID, NMK, sPar1)
					Else
						Call SalDestroyWindow( hMOS1)
						Set hMOS1 = SalCreateWindow( MOS1, hWndMDI, ND,  CC_ID, NMK, sPar1)
			Function: F_Fi_Ex       ! __exported
				Description:
				Returns
				Parameters
					Number: nFi
					String: strTip
					Number: nTip_Kl
					Number: RNK
					String: OKPO
					String: NMK
					Date/Time: FDAT
				Static Variables
				Local variables
					Window Handle: hFi 
					String: FZ
					Number: nOKPO
					Date/Time: oDAT
				Actions
					Set nOKPO = Val(OKPO)
					If nFi = 0
						If mFin='3' 
							If not IsWindow(hF0)
								Set hF0 = SalCreateWindow( FORMA0, hWndMDI, nTip_Kl, nOKPO, 0, strTip, NMK, oDAT, 1 )
							Else
								Call SalBringWindowToTop ( hF0 )
						Else ! КИЕВ
							If not IsWindow( hF0 )
								Set hF0 = SalCreateWindow( FORMA, hWndMDI, 
										nTip_Kl, '', RNK, nOKPO, IifN(nTip_Kl=2,0,10), strTip, NMK, DATETIME_Null, 0 )
							Else
								Call SalBringWindowToTop ( hF0 )
					Else
						Set hFi = IifW(nFi=1,hF1, IifW(nFi=2,hF2, IifW(nFi=3,hF3,hF4) ) )
						If not IsWindow(hFi)
							If nFi=1 OR nFi=2
								If SqlPrepareAndExecute( hSql(),
										"SELECT f.FM,f.fdat  INTO :FZ,:oDAT FROM FIN_FM f 
										 WHERE f.okpo=:nOKPO and (f.okpo,f.fdat)=
										(select okpo,max(fdat) from FIN_FM 
										 where okpo=f.OKPO and fdat <= :FDAT group by okpo )"  )
										and SqlFetchNext(hSql(), nFetchRes)
							Set hFi = SalCreateWindow( FORMA, hWndMDI,
									 nTip_Kl, FZ, RNK, nOKPO, nFi, strTip, NMK, oDAT, 1 )
						Else
							Call SalBringWindowToTop ( hFi )
			Function: F_CLOSE_FORMA
				Description:
				Returns
				Parameters
					Number: nOKPO1
				Static Variables
				Local variables
				Actions
					If nOKPO != NUMBER_Null and nOKPO1 != nOKPO
						If IsWindow( hF0 )
							Call SalDestroyWindow(hF0 )
						If IsWindow( hF1 )
							Call SalDestroyWindow(hF1 )
						If IsWindow( hF2 )
							Call SalDestroyWindow(hF2 )
						If IsWindow( hF3 )
							Call SalDestroyWindow(hF3 )
						If IsWindow( hF4 )
							Call SalDestroyWindow(hF4 )
						Set nOKPO = nOKPO1
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 3922564840
0000: 9E02000049010000 0000000000000000 0200000400FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F61003C00 000B5F005F457272
0040: 6F72426100736556 0100000D003C0000 010DFA0000FF6F0D 00EE0100FF3F1A00
0060: B800000100FFFFE0 2700000001FE00FF 03340000000204F8 000000FF0F380000
0080: 00EE0200FF3F3C00 B800000200FFFF80 40000000030400FE 00FF834400000002
00A0: FB00FF0F48000000 EE0200FF3F4C00B8 00000300FFFFE050 00000003FE00FF83
00C0: 5400000001FB00FF 0F01800D00110001 0000065F005F466C 61671E0000EC0001
00E0: 00D9010D00FF7F01 08801A0000020000 00000B6351756963 6B805461626C6538
0100: 00EC000200D9010D 00FF7F0D73000100 FFFF010180220000 0003000000000A63
0120: 47656E0046696C74 65727400D8000004 003302040001FA00 00078001000000FF
0140: C60400010DFE00FF 831100000002FB00 FF0F15000000EE01 00FF3F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbChilds
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
			On SAM_AppStartup
	Table Window: FIN_OKPO
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Фінансові звіти клієнтів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.738"
				Top:    0.417"
				Width:  13.217"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.845"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = ' Вилучити "звітні дані" ТЕСТОВОГО позичальника ' || UF
						On SAM_Click
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
								If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
									Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
											     not SalTblQueryRowFlags(hWndForm, nRow,
											     ROW_MarkDeleted))
									If FIN_OKPO.nOrd = 1
										If SqlPrepareAndExecute( hSqlAux2(),"DELETE from FIN_RNK where OKPO=:FIN_OKPO.OKPO " )
												and SqlPrepareAndExecute(hSqlAux2(),"DELETE from FIN_CUST where OKPO=:FIN_OKPO.OKPO " )
												and SqlCommit( hSqlAux2() )
											Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = ' Зберегти ТЕСТОВОГО позичальника, як ' || UF
						On SAM_Click
							If SqlPrepareAndExecute( hSqlAux2(),
									  "SELECT c.isp, 'T:'||c.nmk, s.fio 
									   INTO :nTmp, :sTmp, :sFio 
									   from fin_cust c, staff s 
									   where c.okpo=:FIN_OKPO.OKPO1 and Nvl(c.isp,0)=s.ID(+) 
									   union all
									   SELECT c.isp, 'R:'||c.nmk, s.fio  
									   from customer c, staff s 
									   where c.okpo=:FIN_OKPO.OKPO1 and Nvl(c.isp,0)=s.ID(+) 
									     and c.DATE_OFF is null" )
									and not SqlFetchNext( hSqlAux2(), nFetchRes )
								If SqlPrepareAndExecute( hSqlAux2(),
										  "INSERT INTO FIN_CUST(nmk,okpo,custtype) values (:FIN_OKPO.NMK1,:FIN_OKPO.OKPO1,:FIN_OKPO.nTip_Kl)" )
										and SqlCommit( hSqlAux2() )
							Else
								Call SalMessageBox (
										"Клиент " || OKPO1 || " " || sTmp ||" 
										уже введен исполнителем " || Str(nTmp) || " " ||sFio,
										"Внимание ! Ограничение доступа.", MB_IconStop)
				Line
					Resource Id: 29619
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pb_Fit_Test
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FILTER.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = ' Фільтр для ТЕСTОВИХ позичальників ' || UF
						On SAM_Click
							If SetQueryFilter( cF_TEST )
								Set sF_TEST = cF_TEST.GetFilterWhereClause( FALSE )
							Else
								Set sF_TEST =''
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = ' Фільтр для РЕАЛЬНИХ позичальників ' || UF
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Реєстраційна карта клієнта ' || UF
						On SAM_Click
							If not SalIsNull(hWndForm.FIN_OKPO.RNK)
								If FIN_OKPO.nTip_Kl=2
									Call EditCustCorps( FIN_OKPO.RNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
								Else If nTip_Kl=3 or nTip_Kl=23
									Call EditCustPerson( FIN_OKPO.RNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29620
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29621
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Pushbutton: pb_0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F5
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF5_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Yellow
					Message Actions
						On SAM_Create
							Set strTip = ' Загальна інформація ' || UF
						On SAM_Click
							If not SalIsNull(hWndForm.FIN_OKPO.OKPO) 
								If mFin ='3' OR mFin ='4' ! АЖИО или ПЕТРОКОМ
									If not IsWindow( hF0 )
										Set hF0 = 
												SalCreateWindow( FORMA0, hWndMDI, nTip_Kl, Val(OKPO), 0, strTip, NMK, DATETIME_Null, 0 )
									Else
										Call SalBringWindowToTop ( hF0 )
								Else ! КИЕВ
									If not IsWindow( hF0 )
										Set hF0 = SalCreateWindow( FORMA, hWndMDI, 
												nTip_Kl, '', RNK, Val(OKPO), IifN(nTip_Kl=2,0,10), strTip, NMK, DATETIME_Null, 0 )
									Else
										Call SalBringWindowToTop ( hF0 )
				Pushbutton: pb_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F1
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF1.BMP
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Cyan
					Background Color: Cyan
					Message Actions
						On SAM_Create
							Set strTip = ' "Баланс" ' || UF ||'. Форма № 1 '
							! Set strTip = 'Форма № 1(м). "Баланс" ' || UF
						On SAM_Click
							If not SalIsNull(hWndForm.FIN_OKPO.OKPO) 
								If not IsWindow( hF1 )
									Set hF1 = 
											SalCreateWindow( FORMA, hWndMDI, nTip_Kl, FIN_OKPO.FZ, RNK, Val(OKPO), 1, strTip, NMK, DATETIME_Null, 0 )
								Else
									Call SalBringWindowToTop ( hF1 )
				Pushbutton: pb_2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F2
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF2.BMP
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Green
					Message Actions
						On SAM_Create
							Set strTip = '"Фiнансовi результати" '|| UF ||'. Форма № 2 '
						On SAM_Click
							If not SalIsNull(hWndForm.FIN_OKPO.OKPO) 
								If not IsWindow( hF2 )
									Set hF2 = 
											SalCreateWindow( FORMA, hWndMDI,nTip_Kl, FIN_OKPO.FZ, RNK, Val(OKPO), 2, strTip, NMK, DATETIME_Null, 0 )
								Else
									Call SalBringWindowToTop ( hF2 )
				Pushbutton: pb_3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F3
					Font Name: Arial Narrow
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF3_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Light Periwinkle
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Додатковi данi про "Грошові потоки" '|| UF
						On SAM_Click
							If not SalIsNull(hWndForm.FIN_OKPO.OKPO) 
								If not IsWindow( hF3 )
									Set hF3 = 
											SalCreateWindow( FORMA, hWndMDI,nTip_Kl,'', RNK, Val(OKPO), 3, strTip, NMK, DATETIME_Null, 0 )
								Else
									Call SalBringWindowToTop ( hF3 )
				Pushbutton: pb_4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F4
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF4_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Orchid
					Message Actions
						On SAM_Create
							Set strTip = 'Початкові данi про "Кредит" ' || UF
						On SAM_Click
							If not SalIsNull(hWndForm.FIN_OKPO.OKPO) 
								If not IsWindow( hF4 )
									Set hF4 = 
											SalCreateWindow( FORMA, hWndMDI,nTip_Kl, '', RNK, Val(OKPO), 4, strTip, NMK, DATETIME_Null, 0 )
								Else
									Call SalBringWindowToTop ( hF4 )
				!
				Pushbutton: pb_Koef
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							If nTip_Kl = 2
								Set strTip = 'Показники фінінсово-господарської діяльності '|| UF
							Else If nTip_Kl = 3
								Set strTip = 'Оцінка фінасового стану ФО'
						On SAM_Click
							If not SalIsNull(hWndForm.FIN_OKPO.OKPO) 
								If not IsWindow(hKOEF)
									Set hKOEF = SalCreateWindow( KOEF, hWndMDI,
											 FIN_OKPO.nTip_Kl, Val(FIN_OKPO.OKPO), FIN_OKPO.FZ, strTip, FIN_OKPO.NMK, DATETIME_Null )
								Else
									Call SalBringWindowToTop ( KOEF )
				Pushbutton: pb_T8
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Розрахунок ІНТЕГРОВАНОГО показника фін/стану ' || UF
						On SAM_Click
							If not SalIsNull(hWndForm.FIN_OKPO.OKPO) 
								Set sOKPO_ = FIN_OKPO.OKPO
								Call DEPO( hWndMDI, 0, Val(FIN_OKPO.OKPO) )
				Frame
					Resource Id: 29622
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.783"
						Top:    0.071"
						Width:  5.6"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Light Gray
				Pushbutton: pb_XML
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_OUT.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Загрузка з XML '
						On SAM_Click
							Call Debug('Пока в отладке !')
							! Call Imp_XML()
				Frame
					Resource Id: 29623
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.483"
						Top:    0.071"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Light Green
				Frame
					Resource Id: 29624
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   9.683"
						Top:    0.071"
						Width:  3.7"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Maize
				Pushbutton: pbReal
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Arr2tor.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Збереження тестового клієнта як реального'
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
								Set nRow = TBL_MinRow
								While SalTblFindNextRow( hWndForm, nRow, ROW_Selected, 0 )
									If FIN_OKPO.nOrd = 1
										If SqlPrepareAndExecute( hSqlAux2(),
												  "SELECT c.rnk, fc.isp, c.nmk, fc.fz 
												   INTO :nTmp, :nnTmp, :sTmp , :sFz
												   from fin_cust fc,  customer c
												   where fc.okpo=:FIN_OKPO.OKPO and  fc.okpo=c.okpo and fc.custtype=c.custtype
												   " ) and SqlFetchNext (hSqlAux2(),nFetchRes)
											If SqlPrepareAndExecute(hSqlAux2(),"DELETE from FIN_CUST where OKPO=:FIN_OKPO.OKPO " )
													and SqlCommit( hSqlAux2() )
												Call SalMessageBox("Данные клиента "||sTmp|| " перенесены!",
														"В Н И М А Н И Е !", MB_Ok)
												Call SalSendMsg(pbRefresh,SAM_Click,0,0)
										Else
											Call SalMessageBox("Клиент не зарегистрирован!",
													"В Н И М А Н И Е !", MB_Ok)
							Else
								Call SalMessageBox(
										 "Выберите клиента!" ,
										 "В Н И М А Н И Е ! ", MB_Ok )
							Call SalWaitCursor(FALSE)
				Pushbutton: pbArx_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.05"
						Top:    0.179"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: C:\bars98\RESOURCE\BMP\VIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перегляд архіву розрахунку по 1 клієнту'
						On SAM_Click
							Call Sel020( hWndMDI, 503, 2, SalFmtFormatDateTime( oDAT, 'dd/MM/yyyy'), 
									"customer.okpo='"||OKPO||"'" )
				Pushbutton: pbArx_2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: C:\bars98\RESOURCE\BMP\BOOKS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Архів всіх розрахунків'
						On SAM_Click
							Call Sel020( hWndMDI, 503, 2, SalFmtFormatDateTime( oDAT, 'dd/MM/yyyy'), "" )
				Data Field: oDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.155"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pb_Xol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.155"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Створити Ф1 та Ф2 Холдингу'
						On SAM_Click
							If not SalIsNull(hWndForm.FIN_OKPO.OKPO) and 
									FIN_OKPO.RNK = FIN_OKPO.RNKP and FIN_OKPO.RNK >0 
								If SqlPrepareAndExecute( hSqlAux2(),
										  "INSERT INTO FIN_CUST(nmk,okpo,custtype) 
										   select :FIN_OKPO.NMK, - :FIN_OKPO.OKPO, 2 from dual 
										   where  NOT EXISTS (select 1 from FIN_CUST where -okpo=:FIN_OKPO.OKPO) ") 
									If SqlPrepareAndExecute( hSqlAux2(),
											  "INSERT INTO FIN_FM(okpo,fdat, fm ) 
											   select -okpo,fdat,fm  from FIN_FM 
											   where okpo =:FIN_OKPO.OKPO and (-okpo,fdat) NOT in 
											 (select okpo,fdat from FIN_FM where -okpo=:FIN_OKPO.OKPO) ") 
										If SqlPrepareAndExecute( hSqlAux2(),
												  "INSERT INTO FIN_RNK(OKPO, FDAT, IDF, KOD,S) 
												   SELECT  - :FIN_OKPO.OKPO, fr.FDAT, fr.IDF, fr.KOD, sum(fr.S) 
												   FROM FIN_RNK fr, customer c 
												   WHERE c.okpo = substr('00000000'||fr.OKPO,-8) 
												     and c.rnkp=:FIN_OKPO.RNK AND fr.idf IN (1,2) 
												     and NOT EXISTS (select 1 from FIN_RNK 
												                     where -okpo=:FIN_OKPO.OKPO and fdat=fr.FDAT 
												                       and idf=fr.IDF) 
												     and EXISTS     (select 1 from fin_fm 
												                     where okpo=:FIN_OKPO.OKPO and fdat=fr.FDAT 
												                       and fm=:FIN_OKPO.FZ ) 
												   GROUP BY fr.FDAT, fr.IDF, fr.KOD " )
											If SqlCommit( hSqlAux2() )
												Call SalMessageBox(
														'Створено консолідовані звіти Ф.1 та Ф.2 ',
														'Для клієнта - '||FIN_OKPO.OKPO,
														 MB_OK)
				Data Field: sMetodyka
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.783"
							Top:    0.571"
							Width:  5.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: ISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						исп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ФИО
						исполнителя
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєст.
						№
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNKP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєст.
						№ холд.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ід.Код
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set FIN_OKPO.sTmpR = FIN_OKPO.OKPO
					On SAM_AnyEdit
						If nOrd >0
							Set FIN_OKPO.OKPO = FIN_OKPO.sTmpR
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Call SalSetFocus( pbDetails )
					On SAM_KillFocus
						If nOrd = 0
							Set FIN_OKPO.OKPO1 =  FIN_OKPO.OKPO
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						 позичальника
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set FIN_OKPO.sTmpR = FIN_OKPO.NMK
					On SAM_AnyEdit
						If nOrd >0
							Set FIN_OKPO.NMK = FIN_OKPO.sTmpR
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Call SalSetFocus( pbDetails )
					On SAM_KillFocus
						If nOrd = 0
							Set FIN_OKPO.NMK1 =  FIN_OKPO.NMK
			Column: FZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Звіт
				Visible? Yes
				Editable? No
				Maximum Data Length: 1
				Data Type: String
				Justify: Left
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RUK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Керівник
						фірми
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FIN_STAN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фін.Стан
						з БД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FINR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фін.Стан
						розрахунковий
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: F0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Загальна
						інформ. 
						Форма № 5
						на
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Звіт 
						"БАЛАНС"
						Форма № 1
						на
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.117"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Звіт про
						Дох/Витр
						Форма № 2
						на
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.267"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: "Грошові
						потоки"
						Форма № 3 
						на
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.133"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: "Дані про
						кред"
						Форма № 4
						 на
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.133"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nOrd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєст.
						№
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: Imp_XML
				Description: Принять 1 файл  по выбору
				Returns
					Number: nn
				Parameters
				Static Variables
				Local variables
					String: strFilters[*]
					String: strFileName
					String: strFilePath
					Number: nIndex
					Number: nSize
					String: sSPECIFIC
					!
					File Handle: inFile
					Long String: sTiket
					String: sFileM[*]
					Number: nNumFiles
					Number: nRet
				Actions
					Set strFilters[0] = 'XML-документ'
					! Set strFilters[1] = '*'||SalStrRightX( SalStrTrimX( sSPECIFIC ) , 5 )
					Set strFilters[1] = '*.*'
					Set nIndex = 1
					Set nRet = -1
					If not SalDlgOpenFile ( hWndForm, 'Вибір XML-документу', strFilters, 2, nIndex, strFileName, sSPECIFIC )
						Return nRet
					!
					Call SalWaitCursor(FALSE)
					Set strFileName = SalStrUpperX( strFileName )
					!
					If SalFileOpen ( inFile, strFileName, OF_Read )
						Set nSize = VisFileGetSize( strFileName )
						If SalFileRead( inFile, sTiket, nSize ) > 0
								and SqlPrepareAndExecute( hSql(), "delete from FIN_TMP ")
								and SqlPrepare( hSql(),"INSERT INTO FIN_TMP (STIKET, F_size ) values (:sTiket, :nSize )")
								and SqlSetLongBindDatatype(2, BLOB_BYTE)
								and SqlExecute(hSql())
								and SqlPLSQLCommand( hSql(), "Fin_2.P_XML( nSize )" )
								and SqlPrepareAndExecute( hSql(), 'COMMIT')
							Set nRet = 1
							! Set F_SIZE = nSize
							Call SalMessageBox ('Файл ' || strFileName || ' прийнято', 'Повідомлення', MB_Ok | MB_IconExclamation)
						Else
							Call SqlPrepareAndExecute( hSql(), 'ROLL')
						!
						Call SalFileClose( inFile )
					Return nRet
		Window Parameters
			Number: nTip_Kl
			Number: nPar2  ! = 0 тест (все) + реал (все), 
					                 =10 тест(свои) + реал (по ТОБО)
					                 = 1 тест(все) 
					                 =11 тест(свои) 
					
		Window Variables
			String: sTOBO
			String: sFilter
			String: sTmpR
			String: TEST_UF
			String: UF
			!
			String: OKPO1
			String: NMK1
			Number: nRow
			Number: nIsp
			Number: nTmp
			Number: nnTmp
			String: sTmp
			String: sFz
			String: sFio
			String: sFilterI
			: cF_TEST
				Class: cGenFilter
			String: sF_TEST
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Set nIsp = GetUserId()
				! nPar2  ! = 0 тест (все) + реал (все), 
						                 =10 тест(свои) + реал (по ТОБО)
						                 = 1 тест(все) 
						                 =11 тест(свои) 
				If nPar2 =10
					If SqlPrepareAndExecute( hSql(),
							"SELECT nvl(tobo,'0') INTO :sTOBO from staff where id=:nIsp" ) 
							and SqlFetchNext( hSql(), nFetchRes )
				!
				If SqlPrepareAndExecute( hSql(),"SELECT trunc(sysdate,'Q') INTO :oDAT from dual" ) 
						and SqlFetchNext( hSql(), nFetchRes )
				Set nTip_Kl_G = nTip_Kl
				If nPar2 != 0 and nPar2 != 10
					Call SalHideWindow( pbReal )
				Set sF_TEST = ""
				Set sFilterI = ""
				If (nPar2 =1 or nPar2 =11  ) ! только тестовые
					Call SalDisableWindow( pbFilter )
					Call SalHideWindow( RNK )
					If nPar2 = 11  ! только свои тестовые
						Call SalHideWindow( ISP )
						Call SalHideWindow( FIO )
						Set sFilterI =" FIN_CUST.isp=:FIN_OKPO.nIsp AND "
				Else
					If nPar2 =10 ! и тестовые СВОИ
						Set sFilterI =" FIN_CUST.isp=:FIN_OKPO.nIsp AND "
				!
				Call cF_TEST.Init('FIN_CUST','FIN_CUST')
				If nTip_Kl = 2
					Set UF = 'ЮО'
					If mFin != '3'
						Call SalHideWindow( pbArx_1 )
						Call SalHideWindow( pbArx_2 )
				Else
					Call SalHideWindow( pb_XML )
					Call SalHideWindow( pb_1 )
					Call SalHideWindow( pb_2 )
					!
					Call SalHideWindow( F1 )
					Call SalHideWindow( F2 )
					If nTip_Kl = 23
						Set UF = 'СПД'
					Else If nTip_Kl = 3
						Call SalHideWindow( pb_3 )
						Call SalHideWindow( F3 )
						Set UF = 'ФО'
						Call SalTblSetColumnTitle( FIN_OKPO.RUK, "Вік,
								Дата нар." )
				Set TEST_UF = 'ТЕСТОВИЙ позичальник ' || UF
				Call SalSetWindowText( hWndForm, "Фінансові звіти клієтнтів " ||UF )
				If mFin != '3' ! В новой методике КИЕВ по ФЛ+ЮЛ только одна форма 5
					Call SalHideWindow( pb_4 )
					Call SalHideWindow( F4 )
					Call SalHideWindow( pb_3 )
					Call SalHideWindow( F3 )
				Set sMetodyka = "Методика-"|| mFin || " (типу банку " || 
						IifS(mFin = '2', "КИЕВ", 
						IifS(mFin = '4', "ПЕТРОКОМЕРЦ",
						IifS(mFin = '3', "СЕБ","???")
						) ) || ")"
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 8 )
				Set FIN_OKPO.strPrintFileName = 'FIN_OKPO'
				Set FIN_OKPO.strFilterTblName = 'CUSTOMER'
				Call SalColorSet( pb_3, COLOR_IndexWindow, SalColorFromRGB( 255,220,220) )
				Set FIN_OKPO.fFilterAtStart = 1
				Set FIN_OKPO.nTabInstance = 1
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				! sF_TESRT
				If FIN_OKPO.fFilterAtStart
					Set FIN_OKPO.fFilterAtStart = NOT FIN_OKPO.fFilterAtStart
					If (nPar2=1 or nPar2=11 ) and NOT SetQueryFilter( cF_TEST ) or
							   nPar2  = 0 and NOT SetQueryFilter( cF )
						Call SalDestroyWindow( hWndForm )
				!
				Call SalWaitCursor(TRUE)
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				!
				Set sF_TEST = ""
				Set sF_TEST = cF_TEST.GetFilterWhereClause( FALSE )
				! Методика ПЕРРОКОМЕРЦ ( бывш.КИЕВ)
				If mFin = '2' OR mFin='4'
					If nTip_Kl = 2
						! Методтка Киев - ЮЛ
						! nPar2  ! = 0 тест (все) + реал (все), 
								                 =10 тест(свои) + реал (по ТОБО)
								                 = 1 тест(все) 
								                 =11 тест(свои) 
						Set FIN_OKPO.strSqlPopulate = 
								"SELECT 0, to_number(null),to_number(null), to_char(null),
								        substr(:TEST_UF,1,70) NMK,'Керівник', to_char(null),
								        to_date(null),to_date(null),to_date(null),to_date(null), to_date(null)
								 INTO :FIN_OKPO.nOrd, :FIN_OKPO.RNK, :FIN_OKPO.RNKP, :FIN_OKPO.OKPO,
								      :FIN_OKPO.NMK , :FIN_OKPO.RUK, :FIN_OKPO.FIN_STAN,
								      :FIN_OKPO.F0, :FIN_OKPO.F1, :FIN_OKPO.F2, :FIN_OKPO.F3, :FIN_OKPO.F4
								  FROM dual
								UNION ALL
								  SELECT 1,to_number(null),to_number(null),FIN_CUST.okpo, FIN_CUST.nmk,'', '',f0.FDAT,f1.FDAT,f2.FDAT,f3.FDAT,f4.FDAT
								  FROM FIN_CUST ,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=0 group by OKPO) F0,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=1 group by OKPO) F1,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=2 group by OKPO) F2,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=3 group by OKPO) F3,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=4 group by OKPO) F4
								  WHERE "|| sFilterI || IifS(sF_TEST="", "", sF_TEST ||" AND " ) ||
								  " FIN_CUST.OKPO = f0.OKPO(+) and FIN_CUST.OKPO = f1.OKPO(+) and
								    FIN_CUST.OKPO = f2.OKPO(+) and FIN_CUST.OKPO = f3.OKPO(+) and
								    FIN_CUST.OKPO = f4.OKPO(+) and NVL(FIN_CUST.custtype,2) = 2 "||
								IifS ( nPar2=1 or nPar2=11, "", "
								UNION ALL
								  SELECT  2, customer.rnk, customer.rnkp,
								          customer.okpo, customer.nmk, p.RUK, s.NAME,
								          f0.FDAT,f1.FDAT,f2.FDAT,f3.FDAT,f4.FDAT
								  FROM customer, corps p,  stan_fin S, 
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=0 group by OKPO) F0,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=1 group by OKPO) F1,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=2 group by OKPO) F2,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=3 group by OKPO) F3,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=4 group by OKPO) F4
								  WHERE "|| IifS (sFilter = "", "", sFilter||" AND " ) || 
								            IifS (nPar2  != 10, "", " customer.TOBO=:sTOBO AND " ) || 
								  " customer.OKPO = f0.OKPO(+) and customer.OKPO = f1.OKPO(+) and
								    customer.OKPO = f2.OKPO(+) and customer.OKPO = f3.OKPO(+) and
								    customer.OKPO = f4.OKPO(+) and customer.RNK = p.RNK (+) and
								    customer.DATE_OFF is null and     
								    NVL(customer.crisk,0) = s.FIN (+) and customer.custtype =2 " ) || "
								ORDER BY 1,2,3 "
					Else If nTip_Kl = 3 OR nTip_Kl = 23
						! Методтка Киев - ФЛ
						Set FIN_OKPO.strSqlPopulate = "
								  SELECT 0,to_number(null),to_char(null), substr(:TEST_UF,1,70) NMK,'', to_char(null),to_date(null), to_date(null)
								INTO :FIN_OKPO.nOrd,:FIN_OKPO.RNK,:FIN_OKPO.OKPO,:FIN_OKPO.NMK,:FIN_OKPO.RUK,:FIN_OKPO.FIN_STAN,:FIN_OKPO.F0,:FIN_OKPO.F4
								  FROM dual
								UNION ALL
								  SELECT 1,to_number(null),FIN_CUST.okpo, FIN_CUST.nmk, '', '', f10.FDAT, f4.FDAT
								  FROM FIN_CUST ,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=10 group by OKPO) F10 ,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=10 group by OKPO) F4
								  WHERE "|| sFilterI ||IifS (sF_TEST="", "", sF_TEST ||" AND " ) ||
								  " FIN_CUST.OKPO=f10.OKPO(+) AND FIN_CUST.OKPO=f4.OKPO(+) and FIN_CUST.custtype =:nTip_Kl "||
								IifS (nPar2=1 or nPar2=11, "", "
								UNION ALL
								  SELECT 2,customer.rnk,customer.okpo,customer.nmk,to_char( ROUND( (bankdate-p.BDAY)/365,0) ) ||'  '|| to_char(p.BDAY,'dd-mm-yyyy'),
								     s.NAME,f10.FDAT, f4.FDAT
								  FROM customer, person p,  stan_fin S,
								    (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=10 group by OKPO) F10,
								    (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=4 group by OKPO) F4
								  WHERE "|| IifS (sFilter = "", "", sFilter||" AND " ) ||
								            IifS (nPar2  != 10, "", " customer.TOBO=:sTOBO AND " ) || 
								    " customer.OKPO =f10.OKPO(+) AND customer.OKPO = f4.OKPO(+) and
								     NVL(customer.crisk,0) = s.FIN (+) and
								     customer.DATE_OFF is null and
								     customer.RNK = p.RNK (+)  and customer.custtype =3 and
								    NVL(customer.sed,0)" ||IifS(nTip_Kl=23,"=","<>") || "91 ") || "
								ORDER BY 1,2,3"
					! Else If nTip_Kl = 23
						! Методтка Киев - ФЛ
						                                      Set FIN_OKPO.strSqlPopulate = "
								  SELECT 0,to_number(null),to_char(null), substr(:TEST_UF,1,70) NMK,'', to_char(null),to_date(null), to_date(null)
								INTO :FIN_OKPO.nOrd,:FIN_OKPO.RNK,:FIN_OKPO.OKPO,:FIN_OKPO.NMK,:FIN_OKPO.RUK,:FIN_OKPO.FIN_STAN,:FIN_OKPO.F0,:FIN_OKPO.F4
								  FROM dual
								UNION ALL
								  SELECT 1,to_number(null),FIN_CUST.okpo, FIN_CUST.nmk, '', '', f10.FDAT, f4.FDAT
								  FROM FIN_CUST ,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=10 group by OKPO) F10 ,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=10 group by OKPO) F4
								  WHERE "|| sFilterI ||IifS (sF_TEST="", "", sF_TEST ||" AND " ) ||
								  " FIN_CUST.OKPO=f10.OKPO(+) AND FIN_CUST.OKPO=f4.OKPO(+) and FIN_CUST.custtype =3 "||
								IifS (nPar2=1 or nPar2=11, "", "
								UNION ALL
								  SELECT 2,customer.rnk,customer.okpo,customer.nmk,to_char( ROUND( (bankdate-p.BDAY)/365,0) ) ||'  '|| to_char(p.BDAY,'dd-mm-yyyy'),
								     s.NAME,f10.FDAT, f4.FDAT
								  FROM customer, person p,  stan_fin S,
								    (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=10 group by OKPO) F10,
								    (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=4 group by OKPO) F4
								  WHERE "|| IifS (sFilter = "", "", sFilter||" AND " ) ||
								    " customer.OKPO =f10.OKPO(+) AND customer.OKPO = f4.OKPO(+) and
								     NVL(customer.crisk,0) = s.FIN (+) and
								     customer.DATE_OFF is null and
								     customer.RNK = p.RNK (+)  and customer.custtype =3 ") || "
								ORDER BY 1,2,3"
					! В новой методике КИЕВ по ФЛ+ЮЛ только одна форма 5
					Call SalHideWindow( F4 )
					Call SalHideWindow( F3 )
				! Методика АЖИО
				Else If mFin = '3'
					If nTip_Kl = 2
						! Методтка АЖИО - ЮЛ
						Set FIN_OKPO.strSqlPopulate = 
								"SELECT 0, to_number(null),to_number(null),to_char(null),substr(:TEST_UF,1,70) NMK,'Керівник', to_char(null),
								     to_date(null), to_date(null), to_date(null), to_date(null), to_date(null)
								INTO :FIN_OKPO.nOrd,:FIN_OKPO.RNK,:FIN_OKPO.RNKP,:FIN_OKPO.OKPO,:FIN_OKPO.NMK,:FIN_OKPO.RUK, :FIN_OKPO.FIN_STAN,
								     :FIN_OKPO.F0,  :FIN_OKPO.F1, :FIN_OKPO.F2, :FIN_OKPO.F3, :FIN_OKPO.F4
								  FROM dual
								UNION ALL
								  SELECT 1, to_number(null),to_number(null), FIN_CUST.okpo, FIN_CUST.nmk, '', '',f0.FDAT, f1.FDAT, f2.FDAT, f3.FDAT, f4.FDAT
								  FROM FIN_CUST ,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=0 group by OKPO) F0,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=1 group by OKPO) F1,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=2 group by OKPO) F2,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=3 group by OKPO) F3,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=4 group by OKPO) F4
								  WHERE "|| sFilterI || IifS(sF_TEST="", "", sF_TEST ||" AND " ) ||
								  " FIN_CUST.OKPO=f0.OKPO(+) and FIN_CUST.OKPO=f1.OKPO(+) and
								    FIN_CUST.OKPO= f2.OKPO(+) and FIN_CUST.OKPO=f3.OKPO(+) and
								    FIN_CUST.OKPO= f4.OKPO(+) and NVL(FIN_CUST.custtype,2) = 2 " ||
								IifS (nPar2=1 or nPar2=11, "", "
								UNION ALL
								  SELECT  2, customer.rnk, customer.rnkp,customer.okpo, customer.nmk, p.RUK, s.NAME,
								          f0.FDAT, f1.FDAT, f2.FDAT, f3.FDAT, f4.FDAT
								  FROM customer, corps p,  stan_fin S,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=0 group by OKPO) F0,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=1 group by OKPO) F1,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=2 group by OKPO) F2,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=3 group by OKPO) F3,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=4 group by OKPO) F4
								  WHERE "|| IifS (sFilter = "", "", sFilter||" AND " ) ||
								  " customer.OKPO=f0.OKPO(+) and customer.OKPO = f1.OKPO(+) and
								    customer.OKPO=f2.OKPO(+) and customer.OKPO = f3.OKPO(+) and
								    customer.OKPO=f4.OKPO(+) and customer.rnk = p.RNK (+) and
								    customer.DATE_OFF is null and
								    NVL(customer.crisk,0) = s.FIN (+) and customer.custtype =2 " )|| "
								ORDER BY 1,2,3 "
					Else If nTip_Kl = 3 or nTip_Kl = 23
						Set FIN_OKPO.strSqlPopulate ="
								  SELECT 0,to_number(null),to_char(null), substr(:TEST_UF,1,70) NMK,'', to_char(null),to_date(null),to_date(null)
								INTO :FIN_OKPO.nOrd, :FIN_OKPO.RNK,  :FIN_OKPO.OKPO,:FIN_OKPO.NMK,:FIN_OKPO.RUK,
								     :FIN_OKPO.FIN_STAN,:FIN_OKPO.F0,:FIN_OKPO.F4
								  FROM dual
								UNION ALL
								  SELECT 1,to_number(null), FIN_CUST.okpo, FIN_CUST.nmk, '', '', f0.FDAT, f4.FDAT
								  FROM FIN_CUST ,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=0 group by OKPO) F0 ,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=0 group by OKPO) F4
								  WHERE "|| sFilterI || IifS(sF_TEST="", "", sF_TEST  ||" AND " ) ||
								  " FIN_CUST.OKPO=f0.OKPO(+) AND FIN_CUST.OKPO=f4.OKPO(+) and FIN_CUST.custtype=:nTip_Kl "||
								IifS (nPar2=1 or nPar2=11, "", "
								UNION ALL
								  SELECT 2,customer.rnk,customer.okpo,customer.nmk,
								    to_char( ROUND( (bankdate-p.BDAY)/365,0) ) ||'  '|| to_char(p.BDAY,'dd-mm-yyyy'),
								    s.NAME,f0.FDAT, f4.FDAT
								  FROM customer, person p,  stan_fin S,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=0 group by OKPO) F0,
								   (select OKPO, max(FDAT) FDAT from FIN_RNK where IDF=4 group by OKPO) F4
								  WHERE "|| IifS (sFilter = "", "", sFilter||" AND " ) ||
								  " customer.country=804 and customer.OKPO =f0.OKPO(+) AND customer.OKPO = f4.OKPO(+) and
								    NVL(customer.crisk,0)=s.FIN (+) and customer.rnk=p.rnk (+) and customer.custtype=3 and
								    customer.DATE_OFF is null and
								    NVL(customer.sed,0)" ||IifS(nTip_Kl=23,"=","<>") || "91 " )|| "
								ORDER BY 1,2,3"
				If nTip_Kl != 2
					Call SalHideWindow( F1 )
					Call SalHideWindow( F2 )
					Call SalHideWindow( FIN_OKPO.RNKP )
					Call SalHideWindow( pb_Xol )
					If nTip_Kl = 3
						Call SalHideWindow( F3 )
						!
				Call SalTblPopulate(hWndForm, hSql(), FIN_OKPO.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If FIN_OKPO.F0 != DATETIME_Null
					Call XSalTblSetCellBackColor( F0, SalColorGet( pb_0, COLOR_IndexWindow ) )
				If FIN_OKPO.F1 != DATETIME_Null
					Call XSalTblSetCellBackColor( F1, SalColorGet( pb_1, COLOR_IndexWindow ) )
					If SqlPrepareAndExecute( hSqlAux2(),
							 "select substr(fin_2.F_FM(to_number(:FIN_OKPO.OKPO),:FIN_OKPO.F1),1,1) 
							  into :FIN_OKPO.FZ from dual")
							and SqlFetchNext( hSqlAux2(), nFetchRes )
				If FIN_OKPO.F2 != DATETIME_Null
					Call XSalTblSetCellBackColor( F2, SalColorGet( pb_2, COLOR_IndexWindow ) )
				If FIN_OKPO.F3 != DATETIME_Null
					Call XSalTblSetCellBackColor( F3, SalColorGet( pb_3, COLOR_IndexWindow ) )
				If FIN_OKPO.F4 != DATETIME_Null
					Call XSalTblSetCellBackColor( F4, SalColorGet( pb_4, COLOR_IndexWindow ) )
				!
				If nTip_Kl = 2
					If FIN_OKPO.RNK = FIN_OKPO.RNKP and FIN_OKPO.RNK > 0
						Call XSalTblSetCellBackColor( NMK, COLOR_LightGray )
						Call XSalTblSetCellBackColor( OKPO, COLOR_LightGray )
						Call XSalTblSetCellBackColor( RNK, COLOR_LightGray )
						Call XSalTblSetCellBackColor( RNKP, COLOR_LightGray )
				If nOrd = 0
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 ) )
				Else If nOrd= 1
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 220,255,255 )  )
					If nPar2 != 11
						If SqlPrepareAndExecute( hSqlAux2(),
								"SELECT c.isp, s.fio INTO :FIN_OKPO.ISP, :FIN_OKPO.FIO
								 FROM fin_cust c, staff s where c.okpo=:FIN_OKPO.OKPO and c.isp=s.id " )
								and SqlFetchNext( hSqlAux2(), nFetchRes )
				! Подселить РАСЧЕТНыЙ FINR
				If nOrd> 0
					If nTip_Kl = 2
						If F0 != DATETIME_Null and F1 != DATETIME_Null
								and F2 != DATETIME_Null and (F3 != DATETIME_Null or mFin='3')
							If SqlPrepareAndExecute( hSqlAux2(),
									"SELECT NAME INTO :FINR FROM stan_fin where fin=fin_2.STANF(5,:F1,:OKPO) " )
									and SqlFetchNext( hSqlAux2(), nFetchRes )
					Else
						! If nTip_Kl = 23
						! Else If nTip_Kl = 3
						If F0 != DATETIME_Null 
							If SqlPrepareAndExecute( hSqlAux2(),
									"SELECT NAME INTO :FINR FROM stan_fin where fin=fin_2.STANF(:nTip_Kl,:F0,:OKPO) " )
									and SqlFetchNext( hSqlAux2(), nFetchRes )
					If FINR != STRING_Null and FIN_STAN != STRING_Null and FINR != FIN_STAN
						Call XSalTblSetCellBackColor( FIN_OKPO.FIN_STAN, COLOR_Red )
			On SAM_TblDoDetails
				Set sOKPO_ = OKPO
				Call F_CLOSE_FORMA(Val(OKPO))
				!
				! !! Зберегти
				If nOrd =0
					Call SalEnableWindow( pbUpdate )
					Call SalDisableWindow( pb_0 )
					Call SalDisableWindow( pb_1 )
					Call SalDisableWindow( pb_2 )
					Call SalDisableWindow( pb_3 )
					Call SalDisableWindow( pb_4 )
					Call SalDisableWindow( pb_Koef )
					Call SalDisableWindow( pb_T8 )
				Else
					Call SalDisableWindow( pbUpdate )
					Call SalEnableWindow( pb_0 )
					Call SalEnableWindow( pb_1 )
					Call SalEnableWindow( pb_2 )
					Call SalEnableWindow( pb_3 )
					Call SalEnableWindow( pb_4 )
					Call SalEnableWindow( pb_Koef )
					Call SalEnableWindow( pb_T8 )
				! !! Вилучити
				If nOrd =1
					Call SalEnableWindow( pbDel )
				Else
					Call SalDisableWindow( pbDel )
				! Карточка
				If nOrd = 2
					Call SalEnableWindow( pbDetails )
				Else
					Call SalDisableWindow( pbDetails )
				!
				If FIN_OKPO.RNK = FIN_OKPO.RNKP and FIN_OKPO.RNK > 0 
					Call SalEnableWindow( pb_Xol )
				Else
					Call SalDisableWindow( pb_Xol )
	Table Window: FORMA0
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.113"
				Top:    0.01"
				Width:  16.967"
				Width Editable? Class Default
				Height: 7.333"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Відкрити нову дату '
						On SAM_Click
							If mFin='3'
								Set sIns =
										"Insert into FIN_RNK(OKPO,FDAT,IDF,kod)
										 select :OKPO, :oDAT, 0, pok  from fin_pok
										 where TYPE=:nTip_Kl and grp=3 and (:OKPO,:oDAT,0,pok) not in
										(select OKPO,FDAT,IDF,kod from FIN_RNK)"
							Else If mFin='4'
								Set sIns =
										"Insert into FIN_RNK(OKPO,FDAT,IDF,kod)
										 select :OKPO,:oDAT,0,kod  from fin_FORMA0 
										 where kod is not null AND 
										       (:OKPO,:oDAT,0,kod) not in
										(select OKPO,FDAT,IDF,kod from FIN_RNK)"
							!
							If SqlPrepareAndExecute( hSql(),sIns ) and SqlCommit( hSql())
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вилучити помилково відкриту дату '
						On SAM_Click
							If SalMessageBox(strTip || SalFmtFormatDateTime( oDAT, 'dd/MM/yyyy') || ' ?',
									'У В А Г А !', MB_IconQuestion | MB_YesNo) = IDYES
								If SqlPrepareAndExecute( hSql(),
										"Delete from FIN_RNK
										 where OKPO =:OKPO and fdat=:oDAT and idf =0")
										and SqlCommit( hSql() )
									Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29625
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29626
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29627
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.7"
						Begin Y:  Class Default
						End X:  2.7"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: oDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.583"
							Top:    0.071"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dTXT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.783"
							Top:    0.071"
							Width:  4.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Check Box: cb_F
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Подсказки
					Window Location and Size
						Left:   10.683"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If cb_F = FALSE 
								Call SalHideWindow( ABS )
							Else
								Call SalShowWindow( ABS )
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата оцінки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Найменування показника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						рядка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вибрана оцінка
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If FDAT=DATETIME_Null
							Call SalMessageBox("Не установлено звітну дату",
									'Увага !', MB_IconStop)
							Call SalSetFocus( pbIns )
					On SAM_Validate
						Set nTmp = SalListQuerySelection(hWndItem)
						If nTmp < 0
							Set S = Val(SS)
						Else
							Set S =  mBAL[nTmp]
						Return VALIDATE_Ok
			!
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BAL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бали
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ABS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Подсказка из АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: 250
				Data Type: String
				Justify: Left
				Width:  5.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If SqlPrepareAndExecute( hSql(),
								"SELECT substr(fin_help(0, :KOD, :oDAT, :sOKPO_ ),1,250 ) into :ABS from dual" ) 
								and SqlFetchNext( hSql(), nFetchRes )
		Functions
		Window Parameters
			Number: nTip_Kl
			Number: OKPO
			Number: nForm
			String: sForm
			String: NMK
			Date/Time: DAT
			Number: nEdit
		Window Variables
			String: sFilter
			Number: nTmp
			String: sTmp
			String: sIns
			Number: nBAL
			Number: mBAL[*]
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Set cb_F = FALSE
				Call SalHideWindow( ABS )
				If nEdit != 0
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				If sOKPO_ = STRING_Null
					Set sOKPO_ = Str(OKPO)
				Set dTXT =  sOKPO_  || ' ' ||NMK ||' '|| sForm
				Call SalSetWindowText( hWndForm, "Ф."||Str(nForm)||' '|| dTXT )
				Call SalTblSetLockedColumns( hWndForm, 3 )
				Set FORMA0.strPrintFileName = 'FORMA_' ||Str(nForm)
				Set FORMA0.strFilterTblName = 'FIN_RNK'
				Set FORMA0.nTabInstance = 1
				! последняя квартальная дата
				Set oDAT  = IifD ( DAT = DATETIME_Null, SalDateQuarterBegin( GetBankDate() ) , DAT)
				!
				Set FORMA0.strSqlUpdate =
						"UPDATE FIN_RNK set S=:FORMA0.S
						 where FDAT=:FORMA0.FDAT and kod=:FORMA0.KOD and OKPO=:FORMA0.OKPO and idf=0 "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				If cb_F = FALSE 
					Call SalHideWindow( ABS )
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				If mFin='3'
					Set FORMA0.strSqlPopulate = "
							SELECT FIN_RNK.FDAT, f.name, f.pok, FIN_RNK.s, FIN_RNK.name , FIN_RNK.BAL
							INTO :FORMA0.FDAT, :FORMA0.NAME,:FORMA0.KOD, :FORMA0.S, :FORMA0.SS, :FORMA0.BAL
							FROM FIN_POK f ,
							   (select r.FDAT, r.KOD, r.S, b.NAME, b.BAL
							    from  FIN_RNK r, FIN_BAL b
							    where r.IDF=0 and r.kod=b.pok(+) 
							      and r.OKPO=:FORMA0.OKPO and r.S=b.ORD(+) ) FIN_RNK
							WHERE f.TYPE=:FORMA0.nTip_Kl and f.grp=3 and f.POK = FIN_RNK.KOD (+) " ||
							IifS(sFilter = "", "", " and "|| sFilter ) ||" 
							ORDER BY f.pok, FIN_RNK.FDAT "
				Else If mFin='4'
					Set FORMA0.strSqlPopulate = "
							SELECT FIN_RNK.FDAT, f.name, f.kod, FIN_RNK.s, FIN_RNK.name , FIN_RNK.BAL
							INTO :FORMA0.FDAT, :FORMA0.NAME,:FORMA0.KOD, :FORMA0.S, :FORMA0.SS, :FORMA0.BAL
							FROM FIN_FORMA0 f ,
							   (select r.FDAT, r.KOD, r.S, 
							           decode( Substr(r.KOD,1,2),'84',to_char(r.S), '85', to_char(r.S), b.NAME) NAME,
							           b.BAL
							    from  FIN_RNK r, FIN_BAL b
							    where r.IDF=0 and r.kod=b.pok(+) 
							     and r.OKPO=:FORMA0.OKPO and r.S=b.ORD(+) 
							   ) FIN_RNK
							WHERE f.Kod = FIN_RNK.KOD (+) " ||
							IifS(sFilter = "", "", " and "|| sFilter ) ||" 
							ORDER BY f.ord, FIN_RNK.FDAT "
				Call SalTblPopulate(hWndForm, hSql(), FORMA0.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If cb_F = TRUE
					If mFin='3' and (KOD ='210' or KOD ='200' or KOD ='250') 
							OR mFin='4' and (KOD ='841' or KOD ='842' or KOD ='851' or KOD ='811' ) 
						If SqlPrepareAndExecute( hSqlAux2(),
								"SELECT substr(fin_help(0, :KOD, :oDAT, :sOKPO_ ),1,250 ) into :ABS from dual" ) 
								and SqlFetchNext( hSqlAux2(), nFetchRes )
			On SAM_TblDoDetails
				Call SalArraySetUpperBound(mBAL, 1, -1)
				Call SalListClear(SS)
				Set nTmp=0
				If mFin='4' and KOD >'840'
					Call SalListAdd( SS, SalNumberToStrX(0,2) )
					Set mBAL[0] = 0
				Else
					If SqlPrepareAndExecute(hSql(),
							 " SELECT name,ord INTO :sTmp,:nBAL FROM FIN_BAL WHERE pok=:KOD
							   ORDER by ORD ")
						While SqlFetchNext(hSql(), nFetchRes)
							Call SalListAdd( SS, sTmp )
							Set mBAL[nTmp] = nBAL
							Set nTmp = nTmp + 1
	Table Window: FORMA
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.113"
				Top:    0.01"
				Width:  15.533"
				Width Editable? Class Default
				Height: 7.333"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.702"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Data Field: oDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.583"
							Top:    0.071"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Нова дата звіту')
						! On SAM_Validate
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Відкрити нову дату звіту '
						On SAM_Click
							Call F_New()
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вилучити помилково відкритий звіт за дату '
						On SAM_Click
							If SalMessageBox(strTip || SalFmtFormatDateTime( oDAT, 'dd/MM/yyyy') || ' ?',
									'У В А Г А !', MB_IconQuestion | MB_YesNo) = IDYES
								If SqlPrepareAndExecute( hSql(),
										"Delete from FIN_RNK where
										    OKPO =:OKPO and fdat=:oDAT and idf =:nForm")
										and SqlCommit( hSql() )
									Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29628
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Динаміка показників.'||sForm||'. Таблиця за 5 кв.'
						On SAM_Click
							If not IsWindow(hKV5)
								Set hKV5 = SalCreateWindow( KV5, hWndMDI, OKPO, STRING_Null, nForm, strTip, NMK, oDAT )
							Else
								Call SalBringWindowToTop ( hKV5 )
				Data Field: dERR_D
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.683"
							Top:    0.405"
							Width:  3.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 
									'Помилки Динаміки показників. 
									'||sForm||'. Таблиця за 5 кв.')
				!
				Pushbutton: pb_LOG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\QUERY.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip =
									'Перехресний(арифметичний) контроль введених даних звіту
									 '|| sForm ||' на дату '
						On SAM_Click
							If nForm = 1 or nForm = 2
								Call FIN_LOGK( hWndForm,oDAT, OKPO, STRING_Null, nForm, sForm )
				Data Field: dERR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.683"
							Top:    0.405"
							Width:  3.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 
									'Помилки перехресного(арифметичного) контролю введених даних звіту
									 '|| sForm||' на дату ')
				!
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.683"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29629
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29630
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.7"
						Begin Y:  Class Default
						End X:  2.7"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dTXT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.083"
							Top:    0.071"
							Width:  5.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dFORMA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.383"
							Top:    0.405"
							Width:  4.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Check Box: cb_F
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Подсказки
					Window Location and Size
						Left:   12.583"
						Top:    0.405"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If cb_F = FALSE 
								Call SalHideWindow( ABS )
							Else
								Call SalShowWindow( ABS )
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: KURS_USD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.583"
							Top:    0.071"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: FZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Звіт
				Visible? Yes
				Editable? No
				Maximum Data Length: 1
				Data Type: String
				Justify: Left
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата звіту
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стаття
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  7.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						рядка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If FDAT=DATETIME_Null
							Call SalMessageBox("Не установлено звітну дату",
									'Увага !', MB_IconStop)
							Call SalSetFocus( pbIns )
					On SAM_Validate
						Call f_Tochka ( S)
			Column: SQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
						в USD
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ORD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: POB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Признак
						обов`язков
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ABS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Подсказка из АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: 250
				Data Type: String
				Justify: Left
				Width:  5.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If SqlPrepareAndExecute( hSql(),
								"SELECT substr(fin_help(:nForm, :KOD, :oDAT, :sOKPO_ ),1,250 ) into :ABS from dual" ) 
								and SqlFetchNext( hSql(), nFetchRes )
		Functions
			Function: f_Tochka
				Description:
				Returns
				Parameters
					Window Handle: hWnd
				Static Variables
					String: sTmp
				Local variables
				Actions
					Set sTmp=SalStrRepeatX( ' ', 20 )
					Call SalGetWindowText ( hWnd, sTmp, 20 )
					While SalStrScan(sTmp, sDecimal2) > 0
						Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
					Call SalFmtStrToField ( hWnd, sTmp, TRUE)
			Function: F_New
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nMes
				Actions
					If nForm =1 or nForm =2
						Set nMes = SalDateMonth( oDAT )
						If SalDateDay( oDAT ) != 1 
								Or ( nMes != 4 and nMes != 7 and nMes != 10 and nMes != 1 ) 
							Call SalMessageBox('Допустимі дати: 
									01/04/рік, 01/07/рік, 01/10/рік, 01/01/рік+1',
									'Помилка звітної дати', MB_IconStop)
							Set oDAT = oDAT_Old 
							Return FALSE
						!
						If SqlPrepareAndExecute(hSql(),"select substr(fin_2.F_FM(:OKPO,:oDAT),1,1) into :M from dual") 
								and SqlFetchNext(hSql(), nFetchRes )
							If SalMessageBox(
									'Увага ! 
									Форма звіту '|| M ||' залишається ?',
									'Попередня форма звіту = '|| IifS( M = ' ', 'ПОВНА', 'Cкорочена(М)' ), 
									 MB_IconQuestion | MB_YesNo) != IDYES
								Set M = IifS( M=' ', 'M', ' ' )
							If SqlPrepareAndExecute( hSql(),"delete from FIN_FM where okpo=:OKPO and fdat=:oDAT")
									and SqlPrepareAndExecute(hSql(),"insert into FIN_FM (okpo,fdat,fm) values (:OKPO,:oDAT,:M)")
							If SqlPrepareAndExecute( hSql(),
									  "INSERT into FIN_RNK(OKPO,FDAT,IDF,kod)
									   SELECT :OKPO, :oDAT, :nForm, kod
									   FROM fin_forma"||Str(nForm)|| M || "
									   WHERE kod is not null and (:OKPO,:oDAT,:nForm,kod)
									    not in (select OKPO,FDAT,IDF,kod from FIN_RNK)" ) 
					Else
						If SqlPrepareAndExecute( hSql(),
								  "INSERT into FIN_RNK(OKPO,FDAT,IDF,kod)
								   SELECT :OKPO, :oDAT, :nForm, kod
								   FROM fin_forma"||Str(nForm)|| "
								   WHERE kod is not null and (:OKPO,:oDAT,:nForm,kod)
								    not in (select OKPO,FDAT,IDF,kod from FIN_RNK)" )
					If SqlCommit( hSql())
						Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Window Parameters
			Number: nTip_Kl
			String: sReserv
			Number: RNK
			Number: OKPO
			Number: nForm
			String: sForm
			String: NMK
			Date/Time: DAT
			Number: nEdit
		Window Variables
			String: sDecimal2  ! симв десятичной точки alt
			String: sDecimal   ! симв десятичной точки
			Number: nEr
			String: M
			String: sFilter
			Date/Time: oDAT_Old
			! String: sSqlM
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Set cb_F = FALSE
				If sOKPO_ = STRING_Null
					Set sOKPO_ = Str(OKPO)
				Set dTXT = sOKPO_ || ' ' || NMK 
				Set dFORMA = sForm 
				Call SalHideWindow( ABS )
				! Разное для 1-2 и 3-4
				If nForm =1 or nForm =2
					Set dFORMA = sForm 
					Call SalSetWindowText( hWndForm, "Ф."||Str(nForm)||' '|| dTXT )
					Call SalHideWindow( cb_F )
				Else
					Call SalSetWindowText( hWndForm, "Ф."||Str(nForm)|| ' '|| dTXT )
					Call SalDisableWindow( pb_LOG )
					Call SalHideWindow( dERR )
					Call SalHideWindow( dERR_D )
				If nEdit != 0
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
				Set sDecimal =SalStrMidX(SalNumberToStrX(1.1,1),1,1)
				Set sDecimal2 = IifS ( sDecimal = '.', ',', '.' )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 3 )
				Set hWndForm.FORMA.strPrintFileName = 'FORMA_' ||Str(nForm)
				Set hWndForm.FORMA.strFilterTblName = 'FIN_RNK'
				Set hWndForm.FORMA.nTabInstance = 1
				! последняя квартальная дата
				Set oDAT  = IifD ( DAT = DATETIME_Null, SalDateQuarterBegin( GetBankDate() ) , DAT)
				Set oDAT_Old  = oDAT
				!
				!
				Set hWndForm.FORMA.strSqlUpdate =
						"UPDATE FIN_RNK set S=:hWndForm.FORMA.S
						 where FDAT=:hWndForm.FORMA.FDAT and kod=:hWndForm.FORMA.KOD
						   and OKPO=:hWndForm.FORMA.OKPO and idf=:hWndForm.FORMA.nForm "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				If cb_F = FALSE or nForm =1 or nForm =2
					Set cb_F = FALSE
					Call SalHideWindow( ABS )
				Else
					Call SalShowWindow( ABS )
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				If (nForm =1 OR nForm =2)
					Call SalShowWindow( SQ )
					Call SalShowWindow( KURS_USD )
					Set hWndForm.FORMA.strSqlPopulate =
							"SELECT  ' ' FM, FIN_RNK.FDAT, NVL(f.ord,0), f.pob, f.name, f.kod, 
							   FIN_RNK.s,
							   Round(gl.p_Ncurval( 840, FIN_RNK.s*100000, FIN_RNK.FDAT)/100000, 2) SQ 
							 FROM  FIN_RNK, fin_forma"||Str(nForm)||" f 
							 WHERE FIN_RNK.IDF =:hWndForm.FORMA.nForm
							   and f.kod = FIN_RNK.kod 
							   and FIN_RNK.OKPO=:hWndForm.FORMA.OKPO 
							   and substr(fin_2.F_FM(FIN_RNK.OKPO,FIN_RNK.FDAT),1,1)=' ' " ||
							   IifS (sFilter = "", "", " AND "|| sFilter ) || "
							union all 
							 SELECT  ' ' , to_date(null), NVL(ord,0), pob, name, kod, 
							    to_number(null), to_number(null)
							 from fin_forma"||Str(nForm)||" f 
							 where kod is null and exists (select 1 from fin_fm where okpo=:hWndForm.FORMA.OKPO AND FM=' ')
							union all 
							 SELECT  'M',   FIN_RNK.FDAT, NVL(f.ord,0), f.pob, f.name, f.kod, 
							   FIN_RNK.s , 
							  Round(gl.p_Ncurval( 840, FIN_RNK.s*100000, FIN_RNK.FDAT)/100000, 2) SQ 
							 FROM FIN_RNK, fin_forma"||Str(nForm)||"M f 
							 WHERE FIN_RNK.IDF =:hWndForm.FORMA.nForm
							   and f.kod = FIN_RNK.kod 
							   and FIN_RNK.OKPO=:hWndForm.FORMA.OKPO 
							   and substr(fin_2.F_FM(FIN_RNK.OKPO,FIN_RNK.FDAT),1,1)='M' " ||
							   IifS (sFilter = "", "", " AND "|| sFilter ) || "
							union all 
							 SELECT 'M' , to_date(null), NVL(ord,0), pob, name, kod, 
							  to_number(null), to_number(null) 
							 from fin_forma"||Str(nForm)||"M f 
							 where kod is null and exists (select 1 from fin_fm where okpo=:hWndForm.FORMA.OKPO AND FM='M')
							ORDER BY 1, 3, 2 
							INTO :hWndForm.FORMA.FZ, :hWndForm.FORMA.FDAT,:hWndForm.FORMA.ORD,
							      :hWndForm.FORMA.POB,:hWndForm.FORMA.NAME,:hWndForm.FORMA.KOD, 
							:hWndForm.FORMA.S, :hWndForm.FORMA.SQ"
				Else
					Call SalHideWindow( SQ )
					Call SalHideWindow( KURS_USD )
					Set hWndForm.FORMA.strSqlPopulate =
							"SELECT  FIN_RNK.FDAT, f.ord, f.pob, f.name, f.kod,FIN_RNK.s 
							 FROM FIN_RNK, fin_forma"||Str(nForm)||" f 
							 WHERE FIN_RNK.IDF (+) =:hWndForm.FORMA.nForm" ||
							   IifS (sFilter = "", "", " AND "|| sFilter ) || " and f.kod is not null 
							   and f.kod = FIN_RNK.kod (+) and FIN_RNK.OKPO (+) =:hWndForm.FORMA.OKPO
							   and exists (select 1 from FIN_RNK where idf=:nForm and OKPO=:hWndForm.FORMA.OKPO )"|| 
							IifS( nTip_Kl=3," and f.ord<960 ", "") ||"    
							union all 
							 SELECT  to_date(null), NVL(ord,0), pob, name, kod, to_number(null)
							 from fin_forma"||Str(nForm)||" f 
							 where kod is null "|| IifS( nTip_Kl=3," and f.ord<960 ", "") ||"    
							 ORDER BY 2, 1
							INTO :hWndForm.FORMA.FDAT,:hWndForm.FORMA.ORD, :hWndForm.FORMA.POB,
							     :hWndForm.FORMA.NAME,:hWndForm.FORMA.KOD,
							     :hWndForm.FORMA.S"
				! Call SalSendClassMessage(UM_Populate, 0, 0)
				Call SalTblPopulate(hWndForm, hSql(), hWndForm.FORMA.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				If nForm = 1 or nForm = 2
					If SqlPrepareAndExecute( hSql(),
							  "SELECT fin_2.LOGK(:oDAT,:OKPO,:nForm),
							          gl.p_icurval(840,100000,:oDAT)/100000
							   INTO :nEr,:KURS_USD FROM dual" )
							and SqlFetchNext( hSql(), nFetchRes )
						Set dERR = 'Арифметичних нерівностей '||Str(nEr)
						Call SalColorSet( dERR, COLOR_IndexWindowText, IifN(nEr >0,COLOR_Red,COLOR_Blue ))
				If nForm = 2
					If SqlPrepareAndExecute( hSql(),
							  "SELECT fin_2.LOGK_D(:oDAT,:OKPO,:nForm) INTO :nEr FROM dual" )
							and SqlFetchNext( hSql(), nFetchRes )
						Set dERR_D = 'Нерівностей динаміки '||Str(nEr)
						Call SalColorSet( dERR_D, COLOR_IndexWindowText, IifN(nEr >0,COLOR_Red,COLOR_Blue ))
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If KOD != STRING_Null
					If POB = 1
						Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,255 ) )
					Else
						Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 230,255,230 ) )
					! Подсказки из АБС
					If cb_F = TRUE
						! Методика КИЕВ
						If mFin = '2' OR mFin='4'
							If nForm = 0 and ( KOD ='410' or KOD ='411' or KOD ='412' or KOD='361') 
									or nForm = 10 and  KOD ='952'  
								If SqlPrepareAndExecute( hSqlAux2(),
										"SELECT substr(fin_help(:nForm, :KOD, :FDAT, :sOKPO_ ),1,250 ) into :ABS from dual" ) 
										and SqlFetchNext( hSqlAux2(), nFetchRes )
						! Методика AGIO
						Else
							If nForm = 4 and ( KOD ='010' or KOD ='011' or KOD ='012') 
									or nForm = 3 and ( KOD ='061' or KOD ='070' ) 
								If SqlPrepareAndExecute( hSqlAux2(),
										"SELECT substr(fin_help(:nForm, :KOD, :FDAT, :sOKPO_ ),1,250 ) into :ABS from dual" ) 
										and SqlFetchNext( hSqlAux2(), nFetchRes )
	Table Window: KV5
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.038"
				Top:    0.073"
				Width:  17.267"
				Width Editable? Class Default
				Height: 7.679"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.417"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29631
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.517"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29632
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29633
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.3"
						Begin Y:  Class Default
						End X:  2.3"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: oDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.583"
							Top:    0.071"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call fYear ()
				Data Field: dTXT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.483"
							Top:    0.071"
							Width:  9.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Radio Button: rb_980
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: в грн
					Window Location and Size
						Left:   14.283"
						Top:    0.071"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rb_840
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: в USD
					Window Location and Size
						Left:   15.283"
						Top:    0.071"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
		Contents
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.133"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: За кв.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.217"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: За кв.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.167"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Приріст
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.167"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: За кв.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Приріст
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.167"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: За кв.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Приріст
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: За кв.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: R0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Приріст
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ORD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: fYear
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set D0 = oDAT
					Set D1 = AddMonths( D0, -3 )
					Set D2 = AddMonths( D0, -6 )
					Set D3 = AddMonths( D0, -9 )
					Set D4 = AddMonths( D0, -12 )
					!
					If nForm = 2
						Call SalTblSetColumnTitle( K0 ,"За кв.
								"|| Str(SalDateQuarter(D0-1))||"
								"|| Str(SalDateYear(   D0-1))
								 )
						!
						Call SalTblSetColumnTitle( K1 ,"За кв.
								"|| Str(SalDateQuarter(D1-1 ))||"
								"|| Str(SalDateYear(   D1-1))
								 )
						!
						Call SalTblSetColumnTitle( K2 ,"За кв.
								"|| Str(SalDateQuarter(D2-1 )) ||"
								"|| Str(SalDateYear(   D2-1)))
						!
						Call SalTblSetColumnTitle( K3 ,"За кв.
								"|| Str(SalDateQuarter(D3-1 ))||"
								"|| Str(SalDateYear(   D3-1)) )
						!
						Call SalTblSetColumnTitle( K4 ,"За кв.
								"|| Str(SalDateQuarter(D4-1 ))||"
								"|| Str(SalDateYear(   D4-1)))
						Call SalShowWindow( K0 )
						Call SalShowWindow( K1 )
						Call SalShowWindow( K2 )
						Call SalShowWindow( K3 )
						Call SalShowWindow( K4 )
					Else
						Call SalHideWindow( K0 )
						Call SalHideWindow( K1 )
						Call SalHideWindow( K2 )
						Call SalHideWindow( K3 )
						Call SalHideWindow( K4 )
					! !!!!
					If nForm=1 or nForm=2
						If SqlPrepareAndExecute( hSqlAux2(),
								 "select 
								   substr(fin_2.F_FM(to_number(:OKPO),:D0),1,1),
								   substr(fin_2.F_FM(to_number(:OKPO),:D1),1,1),
								   substr(fin_2.F_FM(to_number(:OKPO),:D2),1,1),
								   substr(fin_2.F_FM(to_number(:OKPO),:D3),1,1),
								   substr(fin_2.F_FM(to_number(:OKPO),:D4),1,1)
								  into :M0,:M1,:M2,:M3,:M4 from dual")
								and SqlFetchNext( hSqlAux2(), nFetchRes )
							If M0 != M4 
								Call SalHideWindow( S4 )
								Call SalHideWindow( K4 )
							If M0 != M3
								Call SalHideWindow( S3 )
								Call SalHideWindow( K3 )
								Call SalHideWindow( R3 )
							If M0 != M2
								Call SalHideWindow( S2 )
								Call SalHideWindow( K2 )
								Call SalHideWindow( R2 )
							If M0 != M1
								Call SalHideWindow( S1 )
								Call SalHideWindow( K1 )
								Call SalHideWindow( R1 )
								Call SalHideWindow( R0 )
					!
					Call SalTblSetColumnTitle( S0 ,
							M0||"
							Показник
							"|| SalFmtFormatDateTime( D0, 'dd/MM/yyyy' ) )
					!
					Call SalTblSetColumnTitle( S1 ,
							M1||"
							Показник
							"|| SalFmtFormatDateTime( D1, 'dd/MM/yyyy' ) )
					!
					Call SalTblSetColumnTitle( S2 ,
							M2||"
							Показник
							"|| SalFmtFormatDateTime( D2, 'dd/MM/yyyy' ) )
					!
					Call SalTblSetColumnTitle( S3 ,
							M3||"
							Показник
							"|| SalFmtFormatDateTime( D3, 'dd/MM/yyyy' ) )
					!
					Call SalTblSetColumnTitle( S4 ,
							M4||"
							Показник
							"|| SalFmtFormatDateTime( D4, 'dd/MM/yyyy' ) )
					! !!!!!!!!!!!!!!
					Call SalTblSetColumnTitle( R0 ,"Приріст
							"|| Str(SalDateQuarter(D0-1))||"
							"|| Str(SalDateYear(   D0-1))
							 )
					!
					Call SalTblSetColumnTitle( R1 ,"Приріст
							"|| Str(SalDateQuarter(D1-1 ))||"
							"|| Str(SalDateYear(   D1-1))
							 )
					!
					Call SalTblSetColumnTitle( R2 ,"Приріст
							"|| Str(SalDateQuarter(D2-1 )) ||"
							"|| Str(SalDateYear(   D2-1)))
					!
					Call SalTblSetColumnTitle( R3 ,"Приріст
							"|| Str(SalDateQuarter(D3-1 ))||"
							"|| Str(SalDateYear(   D3-1)) )
					!
		Window Parameters
			Number: OKPO
			String: sRezerv !! FZ
			Number: nForm
			String: sForm
			String: NMK
			Date/Time: DAT
		Window Variables
			Date/Time: D0
			Date/Time: D1
			Date/Time: D2
			Date/Time: D3
			Date/Time: D4
			String: M0
			String: M1
			String: M2
			String: M3
			String: M4
			String: M
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 2 )
				Set hWndForm.KV5.strPrintFileName = 'KV5'
				Set hWndForm.KV5.nTabInstance = 1
				Set dTXT = IifS( sOKPO_ = STRING_Null, Str(OKPO), sOKPO_ ) || ' ' ||NMK ||' '|| sForm
				Call SalSetWindowText( hWndForm, dTXT )
				Set rb_980=TRUE
				Set rb_840=FALSE
				If NOT (nForm=1 or nForm=2)
					Call SalHideWindow( rb_980 )
					Call SalHideWindow( rb_840 )
				! последняя квартальная дата
				Set oDAT  = IifD( DAT = DATETIME_Null, SalDateQuarterBegin( GetBankDate() ) , DAT)
				!
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call fYear ()
				Set M = IifS (nForm=1 or nForm=2, M0,'' )
				!
				If rb_980
					Set hWndForm.KV5.strSqlPopulate =
							"SELECT f.name, NVL(f.ord,0), f.kod, k4.S, k3.S, k2.S, k1.s, k0.s
							 INTO :hWndForm.KV5.NAME, :hWndForm.KV5.ORD, :hWndForm.KV5.KOD,
							      :hWndForm.KV5.S4,   :hWndForm.KV5.S3,  :hWndForm.KV5.S2, 
							      :hWndForm.KV5.S1,   :hWndForm.KV5.S0
							 FROM FIN_RNK k4, FIN_RNK k3, FIN_RNK k2, FIN_RNK k1, FIN_RNK k0,
							      fin_forma"||Str(nForm)||M ||" f
							 WHERE K4.IDF (+) =:hWndForm.KV5.nForm and f.kod=K4.kod (+) 
							   and K4.OKPO(+) =:hWndForm.KV5.OKPO  and K4.FDAT (+) =:hWndForm.KV5.D4 
							   and K3.IDF (+) =:hWndForm.KV5.nForm and f.kod=K3.kod (+) 
							   and K3.OKPO(+) =:hWndForm.KV5.OKPO  and K3.FDAT (+) =:hWndForm.KV5.D3
							   and K2.IDF (+) =:hWndForm.KV5.nForm and f.kod=K2.kod (+) 
							   and K2.OKPO(+) =:hWndForm.KV5.OKPO  and K2.FDAT (+) =:hWndForm.KV5.D2
							   and K1.IDF (+) =:hWndForm.KV5.nForm and f.kod=K1.kod (+) 
							   and K1.OKPO(+) =:hWndForm.KV5.OKPO  and K1.FDAT (+) =:hWndForm.KV5.D1
							   and K0.IDF (+) =:hWndForm.KV5.nForm and f.kod=K0.kod (+) 
							   and K0.OKPO(+) =:hWndForm.KV5.OKPO  and K0.FDAT (+) =:hWndForm.KV5.D0
							 ORDER BY NVL(f.ord,0) "
				Else
					Set hWndForm.KV5.strSqlPopulate =
							"SELECT f.name, NVL(f.ord,0), f.kod, 
							    gl.p_Ncurval(840,k4.S*100000,:hWndForm.KV5.D4)/100000,
							    gl.p_Ncurval(840,k3.S*100000,:hWndForm.KV5.D3)/100000,
							    gl.p_Ncurval(840,k2.S*100000,:hWndForm.KV5.D2)/100000,
							    gl.p_Ncurval(840,k1.S*100000,:hWndForm.KV5.D1)/100000,
							    gl.p_Ncurval(840,k0.S*100000,:hWndForm.KV5.D0)/100000 
							 INTO :hWndForm.KV5.NAME, :hWndForm.KV5.ORD, :hWndForm.KV5.KOD,
							      :hWndForm.KV5.S4,   :hWndForm.KV5.S3,  :hWndForm.KV5.S2, 
							      :hWndForm.KV5.S1,   :hWndForm.KV5.S0
							 FROM FIN_RNK k4, FIN_RNK k3, FIN_RNK k2, FIN_RNK k1, FIN_RNK k0,
							      fin_forma"||Str(nForm)||M ||" f
							 WHERE K4.IDF (+) =:hWndForm.KV5.nForm and f.kod=K4.kod (+) 
							   and K4.OKPO(+) =:hWndForm.KV5.OKPO  and K4.FDAT (+) =:hWndForm.KV5.D4 
							   and K3.IDF (+) =:hWndForm.KV5.nForm and f.kod=K3.kod (+) 
							   and K3.OKPO(+) =:hWndForm.KV5.OKPO  and K3.FDAT (+) =:hWndForm.KV5.D3
							   and K2.IDF (+) =:hWndForm.KV5.nForm and f.kod=K2.kod (+) 
							   and K2.OKPO(+) =:hWndForm.KV5.OKPO  and K2.FDAT (+) =:hWndForm.KV5.D2
							   and K1.IDF (+) =:hWndForm.KV5.nForm and f.kod=K1.kod (+) 
							   and K1.OKPO(+) =:hWndForm.KV5.OKPO  and K1.FDAT (+) =:hWndForm.KV5.D1
							   and K0.IDF (+) =:hWndForm.KV5.nForm and f.kod=K0.kod (+) 
							   and K0.OKPO(+) =:hWndForm.KV5.OKPO  and K0.FDAT (+) =:hWndForm.KV5.D0
							 ORDER BY NVL(f.ord,0) "
				!
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				!
				Call SalTblPopulate(hWndForm, hSql(), hWndForm.KV5.strSqlPopulate, TBL_FillAll )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				! голубой
				Call XSalTblSetCellBackColor( S0, SalColorFromRGB( 220,255,255 ) )
				Call XSalTblSetCellBackColor( K0, SalColorFromRGB( 220,255,255 ) )
				Call XSalTblSetCellBackColor( R0, SalColorFromRGB( 220,255,255 ) )
				! желтый
				Call XSalTblSetCellBackColor( S1, SalColorFromRGB( 255,255,220 ) )
				Call XSalTblSetCellBackColor( K1, SalColorFromRGB( 255,255,220 ) )
				Call XSalTblSetCellBackColor( R1, SalColorFromRGB( 255,255,220 ) )
				! бледнозеленый
				Call XSalTblSetCellBackColor( S2, SalColorFromRGB( 230,255,230 ) )
				Call XSalTblSetCellBackColor( K2, SalColorFromRGB( 230,255,230 ) )
				Call XSalTblSetCellBackColor( R2, SalColorFromRGB( 230,255,230 ) )
				! розовый
				Call XSalTblSetCellBackColor( S3, SalColorFromRGB( 255,240,255 ) )
				Call XSalTblSetCellBackColor( K3, SalColorFromRGB( 255,240,255 ) )
				Call XSalTblSetCellBackColor( R3, SalColorFromRGB( 255,240,255 ) )
				! серый
				Call XSalTblSetCellBackColor( S4, SalColorFromRGB( 250,250,250  ) )
				Call XSalTblSetCellBackColor( K4, SalColorFromRGB( 250,250,250  ) )
				! Set nCol[3]= SalColorFromRGB( 230,245,240 ) ! бледнофиолет
				If nForm = 2
					If M0=M1 
						If S0 != NUMBER_Null
							If SalDateQuarter(D0-1) > 1
								If S1 != NUMBER_Null 
									Set K0 = S0 -  S1 
								Else
									Set K0 = S0/ SalDateQuarter(D0-1)
							Else
								Set K0 = S0 
					If M1=M2 
						If S1 != NUMBER_Null
							If SalDateQuarter(D1-1) > 1
								If S2 != NUMBER_Null 
									Set K1 = S1 -  S2 
								Else
									Set K1 = S1/ SalDateQuarter(D1-1)
							Else
								Set K1 = S1 
					If M2=M3 
						If S2 != NUMBER_Null
							If SalDateQuarter(D2-1) > 1
								If S3 != NUMBER_Null 
									Set K2 = S2 -  S3 
								Else
									Set K2 = S2/ SalDateQuarter(D2-1)
							Else
								Set K2 = S2
					!
					If M3=M4 
						If S3 != NUMBER_Null
							If SalDateQuarter(D3-1) > 1
								If S4 != NUMBER_Null 
									Set K3 = S3 -  S4 
								Else
									Set K3 = S3/ SalDateQuarter(D3-1)
							Else
								Set K3 = S3
					!
					If S4 != NUMBER_Null
						If SalDateQuarter(D4-1) > 1
							Set K4 = S4/ SalDateQuarter(D4-1)
						Else
							Set K4 = S4
				! Прирiст для Ф1
				If nForm = 1
					If M0=M1 
						If S0 != NUMBER_Null
							If S1 != NUMBER_Null 
								Set R0 = S0 -  S1 
					If M1=M2 
						If S1 != NUMBER_Null
							If S2 != NUMBER_Null 
								Set R1 = S1 -  S2 
					If M2=M3 
						If S2 != NUMBER_Null
							If S3 != NUMBER_Null 
								Set R2 = S2 -  S3 
					If M3=M4 
						If S3 != NUMBER_Null
							If S4 != NUMBER_Null 
								Set R3 = S3 -  S4 
				! Прирiст для Ф2
				If nForm = 2
					If M0=M1 
						If K0 != NUMBER_Null
							If K1 != NUMBER_Null 
								Set R0 = K0 -  K1 
					If M1=M2 
						If K1 != NUMBER_Null
							If K2 != NUMBER_Null 
								Set R1 = K1 -  K2 
					If M2=M3 
						If K2 != NUMBER_Null
							If K3 != NUMBER_Null 
								Set R2 = K2 -  K3 
					If M3=M4 
						If K3 != NUMBER_Null
							If K4 != NUMBER_Null 
								Set R3 = K3 -  K4 
				!
	Table Window: KOEF
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.913"
				Top:    0.208"
				Width:  17.267"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.679"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29634
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.517"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29635
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29636
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.3"
						Begin Y:  Class Default
						End X:  2.3"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: oDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.583"
							Top:    0.071"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call KOEF.fYear ()
				Data Field: dTXT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.983"
							Top:    0.071"
							Width:  9.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dTXT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.583"
							Top:    0.405"
							Width:  3.9"
							Width Editable? Yes
							Height: 0.238"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: ####0000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: O4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оцінка
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: ####0000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: O3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оцінка
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.933"
				Width Editable? Yes
				Format: ####0000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: O2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оцінка
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: ####0000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: O1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оцінка
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Показник
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: ####0000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: O0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оцінка
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.817"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фактор на
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ORD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: fYear
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Date/Time: D0
					Date/Time: D1
					Date/Time: D2
					Date/Time: D3
					Date/Time: D4
					String: sTmp1
					String: sTmp2
				Actions
					Set D0 = KOEF.oDAT
					Set D1 = AddMonths( D0, -3 )
					Set D2 = AddMonths( D0, -6 )
					Set D3 = AddMonths( D0, -9 )
					Set D4 = AddMonths( D0, -12 )
					Set sTmp1 = 'Показник на
							'
					Call SalTblSetColumnTitle( KOEF.S0 , sTmp1|| SalFmtFormatDateTime( D0, 'dd/MM/yy' ) )
					Call SalTblSetColumnTitle( KOEF.S1 , sTmp1|| SalFmtFormatDateTime( D1, 'dd/MM/yy' ) )
					Call SalTblSetColumnTitle( KOEF.S2 , sTmp1|| SalFmtFormatDateTime( D2, 'dd/MM/yy' ) )
					Call SalTblSetColumnTitle( KOEF.S3 , sTmp1|| SalFmtFormatDateTime( D3, 'dd/MM/yy' ) )
					Call SalTblSetColumnTitle( KOEF.S4 , sTmp1|| SalFmtFormatDateTime( D4, 'dd/MM/yy' ) )
					If mFin = '3'
						Set sTmp2 = 'Бали на
								'
						Call SalTblSetColumnTitle( KOEF.TXT,sTmp1|| SalFmtFormatDateTime( D0, 'dd/MM/yyyy' ) )
					Else If mFin = '2'  OR mFin='4'
						Set sTmp2 = 'Оцін.на
								' 
					Call SalTblSetColumnTitle( KOEF.O0 , sTmp2|| SalFmtFormatDateTime( D0, 'dd/MM/yy' ) )
					Call SalTblSetColumnTitle( KOEF.O1 , sTmp2|| SalFmtFormatDateTime( D1, 'dd/MM/yy' ) )
					Call SalTblSetColumnTitle( KOEF.O2 , sTmp2|| SalFmtFormatDateTime( D2, 'dd/MM/yy' ) )
					Call SalTblSetColumnTitle( KOEF.O3 , sTmp2|| SalFmtFormatDateTime( D3, 'dd/MM/yy' ) )
					Call SalTblSetColumnTitle( KOEF.O4 , sTmp2|| SalFmtFormatDateTime( D4, 'dd/MM/yy' ) )
		Window Parameters
			Number: nTip_Kl
			Number: OKPO
			String: FZ
			String: sForm
			String: NMK
			Date/Time: DAT
		Window Variables
			Number: nCol [13]
			Number: nF
			String: sSql
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Set KOEF.nCol[0]= SalColorFromRGB( 220,255,255 ) ! голубой
				Set KOEF.nCol[1]= SalColorFromRGB( 220,255,255 ) ! голубой
				Set KOEF.nCol[2]= SalColorFromRGB( 255,255,220)  !  желтій
				Set KOEF.nCol[3]= SalColorFromRGB( 230,245,240 ) ! бледнфиолет
				Set KOEF.nCol[4]= SalColorFromRGB( 230,255,230 ) ! бледнозеленый
				Set KOEF.nCol[5]= SalColorFromRGB( 220,255,255 ) ! голубой
				Set KOEF.nCol[6]= SalColorFromRGB( 250,250,250 ) ! серый
				Set KOEF.nCol[7]= SalColorFromRGB( 255,210,255 ) ! розовій
				! Set KOEF.nCol[8]= SalColorFromRGB( 255,255,220)  !  желтій
				! Set KOEF.nCol[9]= SalColorFromRGB( 230,245,240 ) ! бледнфиолет
				Set KOEF.nCol[8]= SalColorFromRGB( 230,255,230 ) ! бледнозеленый
				Set KOEF.nCol[9]= SalColorFromRGB( 220,255,255 ) ! голубой
				!
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 2 )
				Set KOEF.strPrintFileName = 'KOEF'
				Set KOEF.strFilterTblName = 'FIN_POK'
				Set KOEF.nTabInstance = 1
				Set dTXT = IifS( sOKPO_ = STRING_Null, Str(OKPO), sOKPO_ ) || ' ' || KOEF.NMK ||' '|| KOEF.sForm
				If nTip_Kl = 2
					Set dTXT1 = 'Форми звітів №1, №2 '|| FZ
				Else
					Call SalHideWindow( dTXT1 )
				! If SqlPLSQLCommand( hSql(), "Fin_2.P_FZ( KOEF.FZ )" )
				Call SalSetWindowText( hWndForm, dTXT )
				! последняя квартальная дата
				Set oDAT  = IifD ( DAT = DATETIME_Null, SalDateQuarterBegin( GetBankDate() ) , DAT)
				Call KOEF.fYear ()
				!
				If mFin = '2' OR mFin='4'
					Call SalHideWindow( TXT )
					If nTip_Kl = 2
						Set KOEF.strSqlPopulate =
								"SELECT name, ord, pok,
								   FIN_2.pok25(ORD, :KOEF.oDAT, 12, :KOEF.OKPO ),
								   FIN_2.OCI17(ORD, :KOEF.oDAT, 12, :KOEF.OKPO ),
								   FIN_2.pok25(ORD, :KOEF.oDAT, 9, :KOEF.OKPO ),
								   FIN_2.OCI17(ORD, :KOEF.oDAT, 9, :KOEF.OKPO ),
								   FIN_2.pok25(ORD, :KOEF.oDAT, 6, :KOEF.OKPO ),
								   FIN_2.OCI17(ORD, :KOEF.oDAT, 6, :KOEF.OKPO ),
								   FIN_2.pok25(ORD, :KOEF.oDAT, 3, :KOEF.OKPO ),
								   FIN_2.OCI17(ORD, :KOEF.oDAT, 3, :KOEF.OKPO ),
								   FIN_2.pok25(ORD, :KOEF.oDAT, 0, :KOEF.OKPO ),
								   FIN_2.OCI17(ORD, :KOEF.oDAT, 0, :KOEF.OKPO )
								 INTO :KOEF.NAME,:KOEF.ORD,:KOEF.KOD,
								      :KOEF.S4, :KOEF.O4, :KOEF.S3, :KOEF.O3, :KOEF.S2,:KOEF.O2,
								      :KOEF.S1, :KOEF.O1, :KOEF.S0, :KOEF.O0
								 FROM FIN_pok  WHERE  ORD <900
								 ORDER BY ord"
					Else If nTip_Kl = 3 or nTip_Kl = 23
						Set KOEF.strSqlPopulate =
								"SELECT name, ord, pok,
								   FIN_2.pok25(ORD, :KOEF.oDAT, 12, :KOEF.OKPO ),
								   FIN_2.OCI17(ORD, :KOEF.oDAT, 12, :KOEF.OKPO ),
								   FIN_2.pok25(ORD, :KOEF.oDAT, 9, :KOEF.OKPO ),
								   FIN_2.OCI17(ORD, :KOEF.oDAT, 9, :KOEF.OKPO ),
								   FIN_2.pok25(ORD, :KOEF.oDAT, 6, :KOEF.OKPO ),
								   FIN_2.OCI17(ORD, :KOEF.oDAT, 6, :KOEF.OKPO ),
								   FIN_2.pok25(ORD, :KOEF.oDAT, 3, :KOEF.OKPO ),
								   FIN_2.OCI17(ORD, :KOEF.oDAT, 3, :KOEF.OKPO ),
								   FIN_2.pok25(ORD, :KOEF.oDAT, 0, :KOEF.OKPO ),
								   FIN_2.OCI17(ORD, :KOEF.oDAT, 0, :KOEF.OKPO )
								 INTO :KOEF.NAME,:KOEF.ORD,:KOEF.KOD,
								      :KOEF.S4, :KOEF.O4, :KOEF.S3, :KOEF.O3, :KOEF.S2,:KOEF.O2,
								      :KOEF.S1, :KOEF.O1, :KOEF.S0, :KOEF.O0
								 FROM FIN_pok  WHERE  ORD >=800 "||
								IifS(nTip_Kl = 3," and ord<960 ","") || "
								 ORDER BY ord"
				Else If mFin = '3'
					If KOEF.nTip_Kl = 3
						Call SalHideWindow( KOEF.S4 )
						Call SalHideWindow( KOEF.S3 )
						Call SalHideWindow( KOEF.S2 )
						Call SalHideWindow( KOEF.S1 )
						Call SalHideWindow( KOEF.S0 )
					Set KOEF.strSqlPopulate =
							"SELECT name, GRP*100, pok,
							   FIN_2.pok25(POK, :KOEF.oDAT, 12, :KOEF.OKPO ),
							   FIN_2.BAL3 (POK, :KOEF.oDAT, 12, :KOEF.OKPO ),
							   FIN_2.pok25(POK, :KOEF.oDAT,  9, :KOEF.OKPO ),
							   FIN_2.BAL3 (POK, :KOEF.oDAT,  9, :KOEF.OKPO ),
							   FIN_2.pok25(POK, :KOEF.oDAT,  6, :KOEF.OKPO ),
							   FIN_2.BAL3 (POK, :KOEF.oDAT,  6, :KOEF.OKPO ),
							   FIN_2.pok25(POK, :KOEF.oDAT,  3, :KOEF.OKPO ),
							   FIN_2.BAL3 (POK, :KOEF.oDAT,  3, :KOEF.OKPO ),
							   FIN_2.pok25(POK, :KOEF.oDAT,  0, :KOEF.OKPO ),
							   FIN_2.BAL3 (POK, :KOEF.oDAT,  0, :KOEF.OKPO )
							 INTO :KOEF.NAME,:KOEF.ORD,:KOEF.KOD,
							      :KOEF.S4, :KOEF.O4, :KOEF.S3, :KOEF.O3, :KOEF.S2,:KOEF.O2,
							      :KOEF.S1, :KOEF.O1, :KOEF.S0, :KOEF.O0
							 FROM FIN_pok  where type = :KOEF.nTip_Kl
							 ORDER BY POK "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				Set KOEF.nF = SalNumberTruncate( KOEF.ORD/100, 1, 1 )
				Call XSalTblSetCellBackColor( KOEF.NAME, KOEF.nCol[KOEF.nF] )
				Call XSalTblSetCellBackColor( KOEF.KOD, KOEF.nCol[KOEF.nF] )
				! Call XSalTblSetRowBackColor( hWndForm, lParam,  KOEF.nCol[KOEF.nF])
				If mFin='3'
					! серый
					Call XSalTblSetCellBackColor( KOEF.S4, COLOR_LightGray )
					Call XSalTblSetCellBackColor( KOEF.O4, COLOR_LightGray )
					! желтій
					Call XSalTblSetCellBackColor( KOEF.S3, SalColorFromRGB( 255,255,220) )
					Call XSalTblSetCellBackColor( KOEF.O3, SalColorFromRGB( 255,255,220) )
					! голубой
					Call XSalTblSetCellBackColor( KOEF.S2, COLOR_Sky )
					Call XSalTblSetCellBackColor( KOEF.O2, COLOR_Sky )
					! - РОЗОВІЙ
					Call XSalTblSetCellBackColor( KOEF.S1, SalColorFromRGB( 255,210,250 ) )
					Call XSalTblSetCellBackColor( KOEF.O1, SalColorFromRGB( 255,210,250 ) )
					! - ЗЕЛЕНЫЙ
					Call XSalTblSetCellBackColor( KOEF.S0, COLOR_LightGreen )
					Call XSalTblSetCellBackColor( KOEF.O0, COLOR_LightGreen )
					Call XSalTblSetCellBackColor( KOEF.TXT,COLOR_LightGreen )
					!
					If KOEF.S0 != NUMBER_Null and KOEF.O0 != NUMBER_Null and KOEF.KOD != STRING_Null and
							( KOEF.nF = 1 or KOEF.nF = 2 or KOEF.nF = 3)
						If KOEF.nF = 1
							Set sSql = "SELECT substr(FIN_2.TXT1(:KOEF.KOD, :KOEF.S0),1,10) into :KOEF.TXT from dual"
						Else If KOEF.nF = 2
							Set sSql =
									"SELECT d.name into :KOEF.TXT from fin_dyn d, fin_bal b where b.pok=:KOEF.KOD and b.ord=d.ord and b.bal="||Str(KOEF.O0)
						Else If KOEF.nF = 3
							Set sSql = "SELECT name into :KOEF.TXT from fin_bal where pok=:KOEF.KOD and ord="||Str(KOEF.S0)
							Set S4 = NUMBER_Null
							Set S3 = NUMBER_Null
							Set S2 = NUMBER_Null
							Set S1 = NUMBER_Null
							Set S0 = NUMBER_Null
						If SqlPrepareAndExecute( hSqlAux2(), sSql) and SqlFetchNext( hSqlAux2(), nFetchRes )
	Table Window: FIN3
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -1.063"
				Top:    -0.01"
				Width:  17.267"
				Width Editable? Class Default
				Height: 8.095"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Left
				Visible? Class Default
				Size: 4.75"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Зберегти Розрахункове значенння як фактичне '
						On SAM_Click
							Call F_TXT()
				Line
					Resource Id: 29637
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.517"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Друк Висновку'
						On SAM_Click
							Call F_PRINT_V()
				Line
					Resource Id: 29638
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
				!
				Line
					Resource Id: 29639
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.2"
						Begin Y:  Class Default
						End X:  2.2"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: oDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.071"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата розрахунку' )
						On SAM_Validate
							Set oDAT = SalDateQuarterBegin( oDAT ) 
				Pushbutton: pb_0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F5
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF5_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = ' "Загальна інформація" '
						On SAM_Click
							If mFin='3' 
								If not IsWindow(hF0)
									Set hF0 = SalCreateWindow( FORMA0, hWndMDI, nTip_Kl, OKPO, 0, strTip, NMK, DATETIME_Null, nEdit )
								Else
									Call SalBringWindowToTop ( hF0 )
				!
				Pushbutton: pb_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F1
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Cyan
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = '"Баланс". Форма № 1 '|| FZ
						On SAM_Click
							Call F_Fi ( hF1, 1, strTip )
				Pushbutton: pb_2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F2
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF2.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = '"Фiнансовi результати". Форма № 2 '||FZ
						On SAM_Click
							Call F_Fi ( hF2, 2, strTip )
				Pushbutton: pb_3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F3
					Font Name: Arial Narrow
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF3_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Light Periwinkle
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Додатковi данi про "Грошові потоки" '
						On SAM_Click
							Call F_Fi ( hF3, 3, strTip)
				Pushbutton: pb_4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F4
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF4_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Початкові данi про "Кредит" '
						On SAM_Click
							Call F_Fi ( hF4, 4, strTip )
				!
				Pushbutton: pb_Koef
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Показники фінінсово-господарської діяльності'
						On SAM_Click
							If OKPO > 0
								If not IsWindow(hKOEF)
									Set hKOEF = SalCreateWindow( KOEF, hWndMDI,
											nTip_Kl, OKPO, FZ, strTip, NMK, oDAT )
								Else
									Call SalBringWindowToTop ( KOEF )
				!
				Child Table: TF1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    2.155"
							Width:  4.5"
							Width Editable? Yes
							Height: 1.667"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						View: Table
						Allow Row Sizing? No
						Lines Per Row: Default
					Memory Settings
						Maximum Rows in Memory: Default
						Discardable? Yes
					Contents
						Column: FIN
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: №
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  0.45"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: NAM
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Клас
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  2.517"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: ZIP
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Поріг
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  1.117"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
					Functions
					Window Variables
					Message Actions
						On SAM_FetchRowDone
							If nIP1 >= TF1.ZIP and nIP1 < ZIP1
								Call XSalTblSetRowBackColor( TF1, lParam, nCol[7] )
								Set sStan = TF1.NAM
								Set FIN1 = TF1.FIN
								Set FIN_STAN_R = sStan
							Set ZIP1 = TF1.ZIP
				Data Field: NMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    1.571"
							Width:  4.5"
							Width Editable? Yes
							Height: 0.238"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Найменування клієнту' )
				Data Field: dTXT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    1.821"
							Width:  4.5"
							Width Editable? Yes
							Height: 0.238"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Форми звітів клієнту' )
				Data Field: FIN_STAN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    1.071"
							Width:  4.5"
							Width Editable? Yes
							Height: 0.238"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold-Italic
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Клас фін.стану клієнту на дату' )
				Data Field: FIN_STAN_R
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.988"
							Width:  5.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold-Italic
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: sTYPE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.783"
							Top:    1.321"
							Width:  2.9"
							Width Editable? Yes
							Height: 0.238"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold-Italic
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Тип клієнту' )
				Data Field: sOKPO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    1.321"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.238"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold-Italic
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Ід.код клієнту' )
				Multiline Field: ml_TXT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						String Type: Long String
						Editable? Yes
					Display Settings
						Border? Yes
						Word Wrap? No
						Vertical Scroll? Yes
						Window Location and Size
							Left:   0.183"
							Top:    3.821"
							Width:  4.5"
							Width Editable? Yes
							Height: 3.5"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
					Message Actions
				Background Text: Методика-3 ("АЖІО")
					Resource Id: 29640
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.183"
						Top:    0.845"
						Width:  4.5"
						Width Editable? Yes
						Height: 0.238"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
		Contents
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва показника
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: POK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Значення
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.567"
				Width Editable? Yes
				Format: ####0000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: O0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бали
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фактор вибору
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: GRP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Значення
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.533"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SVID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.35"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
			Function: F_Fi
				Description:
				Returns
				Parameters
					Window Handle: hFi
					Number: nFi
					String: strTip
				Static Variables
				Local variables
				Actions
					If nEdit = 0
						If not IsWindow(hFi)
							Set hFi = SalCreateWindow( FORMA, hWndMDI, nTip_Kl, FZ, RNK, OKPO, nFi, strTip, NMK, DATETIME_Null, 0 )
						Else
							Call SalBringWindowToTop ( hFi )
					Else
						If not IsWindow(hFi)
							Set hFi = SalCreateWindow( KV5, hWndMDI, OKPO, FZ, nFi, strTip, NMK, oDAT )
						Else
							Call SalBringWindowToTop ( hFi )
			Function: F_TXT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
				Actions
					Set sTmp =
							"Зберегти зміни в висновких та Розрахунковий клас фін.стану по OKPO =" || Str(OKPO)
					If SalMessageBox(sTmp || ' ?', 'Увага !', MB_IconQuestion | MB_YesNo) = IDYES
						If 
								SqlPrepareAndExecute( hSql(), "UPDATE customer set crisk=:FIN1 where rnk=:RNK " )
								and
								(b_TXT and
								 SqlPrepareAndExecute( hSql(),"UPDATE fin_txt set txt=:ml_TXT, userid=USER_ID where OKPO=:OKPO and fdat=:oDAT " )
								 or
								 not b_TXT and
								 SqlPrepareAndExecute(hSql(),"INSERT into fin_txt (OKPO,fdat,txt, userid) values (:OKPO,:oDAT,:ml_TXT, USER_ID)" )
								 )
								and SqlCommitEx( hSql(), sTmp )
							Set b_TXT = TRUE
							Set FIN_STAN = sStan
							Call MessageNoWait( sTmp ,'Повідомлення',3,0)
			Function: F_TXT0
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set b_TXT=
							SqlPrepareAndExecute(hSql(),
							"SELECT txt into :ml_TXT from fin_txt where OKPO=:OKPO and fdat=:oDAT")
							and SqlFetchNext(hSql(), nFetchRes)
					Call SalSetFocus(ml_TXT)
			Function: F_PRINT_V
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: strFa
					String: strREP
					String: strCEN
					String: strQRP
					Number: nInd
				Actions
					! вызов функции печати
					Call SalWaitCursor(TRUE)
					Set strFa = GetPrnDir() || "\\" || Str(OKPO) || ".rtf"
					Set strREP = 'NMK,oDAT,NAME,POK,RZ,OK,ml_TXT,FIN_STAN,FIN_STAN_R,oDAT1,RZ1,OK1,oDAT2,RZ2,OK2,FIO1,FIO2,OKPO,FIO3'
					Set strCEN = 'NMK,oDAT,NAME,nPOK,sRZ,O0,ml_TXT,FIN_STAN,FIN_STAN_R,oDAT1,sRZ1,OK1,oDAT2,sRZ2,OK2,FIO1,FIO2,sOKPO,FIO3'
					Set strQRP = GetTemplateDir() || "\\FIN_S3.QRP"
					! rtf
					Call SalReportPrintToFile(hWndForm,
							     strQRP,
							     strFa,
							     strCEN, strREP, 1, RPT_PrintAll, 1, 1, TRUE,
							     nInd)
					Call SalWaitCursor(FALSE)
					Call SalLoadApp (GetEditorPath(), strFa)
		Window Parameters
			Number: nEdit
			Number: OKPO
			!
		Window Variables
			Boolean: b_TXT
			Number: nCol[13]
			Number: RNK
			Number: nIP1
			Number: nIP1o
			Number: nIP1s
			Number: nRow
			Number: ZIP1
			Number: FIN1
			!
			Number: nTip_Kl
			String: sStan
			String: FZ
			String: sSql
			Number: i
			String: sRZ
			Date/Time: oDAT1
			String: sRZ1
			Number: OK1
			Number: nX
			Date/Time: oDAT2
			String: sRZ2
			Number: OK2
			Number: nPOK
			String: FIO1
			String: FIO2
			String: FIO3
			!
			String: sSql1
			String: sSql2
			! String: sOKPO
		Message Actions
			On SAM_Create
				Call F_CLOSE_FORMA(OKPO)
				Set nCol[0] = SalColorFromRGB(220,255,255) ! голубой
				Set nCol[1] = SalColorFromRGB(220,255,255) ! голубой
				Set nCol[2] = SalColorFromRGB(255,255,220) ! желтій
				Set nCol[3] = SalColorFromRGB(230,245,240) ! бледнфиолет
				Set nCol[4] = SalColorFromRGB(230,255,230) ! бледнозеленый
				Set nCol[5] = SalColorFromRGB(220,255,255) ! голубой
				Set nCol[6] = SalColorFromRGB(250,250,250) ! серый
				Set nCol[7] = SalColorFromRGB(255,210,255) ! розовій
				Set nCol[8] = SalColorFromRGB(255,255,220) ! желтій
				Set nCol[9] = SalColorFromRGB(230,245,240) ! бледнфиолет
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns(hWndForm, 2)
				Set hWndForm.FIN3.strPrintFileName = 'FIN3'
				Set hWndForm.FIN3.nTabInstance = 1
				!
				! Call Debug( 'nEdit='|| Str(nEdit ) )
				If nEdit != 0
					Call SalDisableWindow( pbUpdate )
				Call SalWaitCursor(TRUE)
				! разное
				If OKPO < 10000000
					Set sOKPO = SalStrRightX( '00000000'||Str(OKPO),8)
				Else If OKPO < 100000000
					Set sOKPO = Str(OKPO)
				Else
					Set sOKPO = SalStrRightX( '00'||Str(OKPO),10)
				If nTip_Kl_G = NUMBER_Null
					Set nTip_Kl_G = 0
				Set sSql1 =
						"SELECT decode(c.custtype,2,2,decode(c.sed,91,23,3)), c.nmk, f.name, t.name,
						        DECODE( UPPER( NVL(w.value,' ')),'M','M',''), c.rnk
						 INTO :nTip_Kl, :NMK, :FIN_STAN, :sTYPE, :FZ, :RNK
						 FROM customer c, stan_fin f, fin_type t, customerW w
						 WHERE t.type=decode(c.custtype,2,2,decode(c.sed,91,23,3)) 
						   AND c.rnk=w.rnk(+) AND w.tag(+)='FZ' AND c.custtype in (2,3) 
						   AND c.OKPO=:sOKPO AND c.crisk=f.Fin(+) AND rownum=1 AND (c.date_off IS NULL OR c.date_off>bankdate)" ||
						IifS(nTip_Kl_G=0,""," AND decode(c.custtype,2,2,decode(c.sed,91,23,3))=:nTip_Kl_G")
				Set sSql2 =
						"SELECT c.custtype, c.nmk, t.name, c.FZ INTO :nTip_Kl, :NMK, :sTYPE, :FZ
						 FROM fin_cust c, fin_type t
						 WHERE t.type=c.custtype AND c.OKPO=:sOKPO AND rownum =1 "
				If SqlPrepareAndExecute(hSql(),sSql1) and not SqlFetchNext(hSql(), nFetchRes)
					Set RNK = NUMBER_Null
					If SqlPrepareAndExecute(hSql(),sSql2) and not SqlFetchNext(hSql(), nFetchRes)
						Call SalMessageBox(" Відсутні дані ! ", 
								"Увага ! ", MB_IconStop)
						! Call SalDestroyWindow(hWndForm)
						! Return FALSE
				! If SqlPLSQLCommand(hSql(), "Fin_2.P_FZ( FZ )")
				! Установка даты
				If SqlPrepareAndExecute(hSql(), "SELECT max(fdat) into :oDAT from fin_rnk where okpo=:OKPO")
						and SqlFetchNext(hSql(), nFetchRes)
				If oDAT = DATETIME_Null
					Call SalMessageBox(" Відсутні первинні дані для розрахунку ! ", 
							"Увага ! ", MB_IconStop)
					Set oDAT = SalDateQuarterBegin(GetBankDate())
				!
				Call SalSetWindowText(hWndForm, Str(OKPO) || ' ' || NMK || '. Аналіз фінансового стану')
				Call PrepareWindowEx(hWndForm)
				If nTip_Kl = 2
					Set dTXT1 = 'Форми звітів №1, №2 '|| FZ
				Else
					Call SalHideWindow(dTXT1)
				!
				If nTip_Kl = 3
					Call SalHideWindow(pb_1)
					Call SalHideWindow(pb_2)
					Call SalHideWindow(pb_3)
					Call SalHideWindow(S0)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call F_TXT0()
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Set nIP1 = 0
				Set nIP1o = 0
				Set nIP1s = 0
				Call SalTblPopulate(hWndForm, hSql(),
						"SELECT f.name, f.GRP, f.pok,
						        FIN_2.pok25(f.POK, :oDAT, 0, :OKPO), 
						        FIN_2.BAL3 (f.POK, :oDAT, 0, :OKPO), f.vid, v.name
						 INTO :NAME, :GRP, :POK, :S0, :O0, :VID, :SVID
						 FROM FIN_pok f , fin_pok_vid v 
						 WHERE f.type=:nTip_Kl and f.vid = v.vid (+) 
						 ORDER BY f.POK", TBL_FillAll)
				If nIP1 < 0
					Set nIP1 = 0
				!
				Call SalTblDefineSplitWindow(hWndForm, 3, TRUE)
				If nTip_Kl= 2
					Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
					Call SalTblSetContext (hWndForm, nRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Set NAME = 'Сума балів по об`єктивним показникам'
					Set POK  = '***'
					Set O0   = nIP1o
					!
					Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
					Call SalTblSetContext (hWndForm, nRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Set NAME = 'Сума балів по суб`єктивним показникам'
					Set POK  = '***'
					Set O0   = nIP1s
					! nIP1o - 70
					! nIP1s (nX) - 30
					Set nX = SalNumberRound( nIP1o*nPR_30 / nPR_70 )
					Set nIP1s = SalNumberMin( nIP1s, nX )
					Set nIP1 = nIP1o + nIP1s
				!
				Set ZIP1 = 100000000
				Call SalTblPopulate(TF1, hSql(),
						"SELECT fin, name, ip INTO :TF1.FIN, :TF1.NAM, :TF1.ZIP
						 FROM STAN_FIN order by FIN", TBL_FillAll)
				!
				Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
				Call SalTblSetContext (hWndForm, nRow)
				Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
				Set NAME = 'Фінальна Сума балів та Фінансовий стан'
				!
				Set POK  = '***'
				Set O0   = nIP1
				Set TXT  = sStan
				Call XSalTblSetCellBackColor(TXT,  nCol[7])
				Call XSalTblSetCellBackColor(NAME, nCol[7])
				Call XSalTblSetCellBackColor(O0,   nCol[7])
				!
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				!
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Call XSalTblSetRowBackColor(hWndForm, lParam, nCol[GRP])
				If nTip_Kl= 2
					If VID =1 
						Set nIP1o = nIP1o + O0
					Else
						Set nIP1s = nIP1s + O0
				Else
					Set nIP1 = nIP1 + O0
				! - ЗЕЛЕНЫЙ
				Call XSalTblSetCellBackColor(S0, COLOR_LightGreen )
				Call XSalTblSetCellBackColor(O0, COLOR_LightGreen )
				Call XSalTblSetCellBackColor(TXT,COLOR_LightGreen )
				!
				If S0 != NUMBER_Null and O0 != NUMBER_Null and POK != STRING_Null
					If GRP = 1
						Set sSql = "SELECT substr(FIN_2.TXT1(:POK, :S0),1,10) into :TXT from dual"
					Else If GRP = 2
						Set sSql =
								"SELECT d.name into :TXT from fin_dyn d, fin_bal b where b.pok=:POK and b.ord=d.ord and b.bal="||Str(O0)
					Else If GRP = 3
						Set sSql = "SELECT name into :TXT from fin_bal where pok=:POK and ord="||Str(S0)
						Set S0 = NUMBER_Null
					If SqlPrepareAndExecute(hSqlAux2(), sSql) and SqlFetchNext(hSqlAux2(), nFetchRes)
			!
			On SAM_ReportStart
				Set oDAT1 = AddMonths( oDAT, -3 )
				Set oDAT2 = AddMonths( oDAT, -6 )
				Set FIO1=GetUserRealName()
				Set FIO2=''
				If SqlPrepareAndExecute(hSql(),"SELECT s.fio into :FIO3 from staff s, fin_txt f where f.okpo=:OKPO and f.userid=s.id 
						                                                                          and fdat = (select max(fdat) from fin_txt where okpo=:OKPO and fdat <= :oDAT) ")
						and SqlFetchNext( hSql(), nFetchRes )
				Set i = TBL_MinRow
			On SAM_ReportFetchInit
				Return TRUE
			! On SAM_ReportFetchNext
				                             While SalTblFindNextRow(hWndForm, i, 0, 0)
					                             Call SalTblFetchRow(hWndForm, i)
					! If POK != '***'
					                             Set nPOK = Val(POK)
					                             If POK != STRING_Null
						                             If GRP = 1
							                             Set sRZ=Str(S0)
						                             Else If GRP = 2
							                             Set sRZ = Str(S0) || ' - '|| TXT
						                             Else If GRP = 3
							                             Set sRZ = TXT
					                             Else 
						                             Set sRZ = STRING_Null
						                             Set sRZ1 = STRING_Null
						                             Set sRZ2 = STRING_Null
						                             Set OK1 = NUMBER_Null
						                             Set OK2 = NUMBER_Null
					                             Return TRUE
				                             Return FALSE
			On SAM_ReportFetchNext
				While SalTblFindNextRow(hWndForm, i, 0, 0)
					Call SalTblFetchRow(hWndForm, i)
					If POK != '***'
						Set nPOK = Val(POK)
						If POK != STRING_Null
							If GRP = 1
								Set sRZ=Str(S0)
							Else If GRP = 2
								Set sRZ = Str(S0) || ' - '|| TXT
							Else If GRP = 3
								Set sRZ = TXT
						Else
							Set sRZ = STRING_Null
							Set sRZ1 = STRING_Null
							Set sRZ2 = STRING_Null
							Set OK1 = NUMBER_Null
							Set OK2 = NUMBER_Null
						Return TRUE
				Return FALSE
			On SAM_ReportFinish
				Call SalWaitCursor(FALSE)
				! Call DosDirectPrint(strFa)
	Table Window: T8
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.213"
				Top:    0.156"
				Width:  16.55"
				Width Editable? Class Default
				Height: 8.095"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.524"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Зберегти Розрахункове значенння як фактичне '
						On SAM_Click
							Call T8.F_TXT()
				Line
					Resource Id: 29641
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.517"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Друк Висновку'
						On SAM_Click
							If mFin='4' ! Методика Петрокомерц
								Call T8.F_PRINT_P()
							Else
								Call T8.F_PRINT_K()
				Line
					Resource Id: 29642
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
				!
				Line
					Resource Id: 29643
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.2"
						Begin Y:  Class Default
						End X:  2.2"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F5
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF5_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = ' "Загальна інформація" '
						On SAM_Click
							If nEdit = 0
								If not IsWindow( hF0 )
									If mFin='4' 
										If not IsWindow(hF0)
											Set hF0 = SalCreateWindow( FORMA0, hWndMDI, nTip_Kl, OKPO, 0, strTip, NMK, DATETIME_Null, nEdit )
									Else
										Set hF0 =  SalCreateWindow( FORMA, hWndMDI, nTip_Kl, '', RNK, OKPO, IifN(nTip_Kl=2,0,10), strTip, NMK, DATETIME_Null, 0 )
								Else
									Call SalBringWindowToTop ( hF0 )
							Else
								If not IsWindow(hKV5)
									Set hKV5 = SalCreateWindow( KV5, hWndMDI, OKPO, '', IifN(nTip_Kl=2,0,10),strTip, NMK, oDAT )
								Else
									Call SalBringWindowToTop ( hKV5 )
				Pushbutton: pb_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F1
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Cyan
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = '"Баланс". Форма № 1 '|| FZ
						On SAM_Click
							If nEdit = 0
								If not IsWindow( hF1 )
									Set hF1 = 
											 SalCreateWindow( FORMA, hWndMDI, nTip_Kl, FZ , RNK, OKPO, 1, strTip, NMK, DATETIME_Null, 0 )
								Else
									Call SalBringWindowToTop ( hF1 )
							Else
								If not IsWindow(hKV5)
									Set hKV5 = SalCreateWindow( KV5, hWndMDI, OKPO, FZ, 1, strTip, NMK, oDAT )
								Else
									Call SalBringWindowToTop ( hKV5 )
				Pushbutton: pb_2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F2
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF2.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = '"Фiнансовi результати". Форма № 2 '||FZ
						On SAM_Click
							If nEdit = 0
								If not IsWindow( hF2 )
									Set hF2 = 
											 SalCreateWindow( FORMA, hWndMDI, nTip_Kl, FZ , RNK, OKPO, 2, strTip, NMK, DATETIME_Null, 0 )
								Else
									Call SalBringWindowToTop ( hF2 )
							Else
								If not IsWindow(hKV5)
									Set hKV5 = SalCreateWindow( KV5, hWndMDI, OKPO, FZ, 2, strTip, NMK, oDAT )
								Else
									Call SalBringWindowToTop ( hKV5 )
				Pushbutton: pb_3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: F3
					Font Name: Arial Narrow
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF3_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Light Periwinkle
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Додатковi данi про "Грошові потоки" '
						On SAM_Click
							If nEdit = 0
								If not IsWindow( hF3 )
									Set hF3 = 
											 SalCreateWindow( FORMA, hWndMDI, nTip_Kl, '', RNK, OKPO, 3, strTip, NMK, DATETIME_Null, 0 )
								Else
									Call SalBringWindowToTop ( hF3 )
							Else
								If not IsWindow(hKV5)
									Set hKV5 = SalCreateWindow( KV5, hWndMDI, OKPO, '', 3, strTip, NMK, oDAT )
								Else
									Call SalBringWindowToTop ( hKV5 )
				Pushbutton: pb_4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: F4
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF4_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'Початкові данi про "Кредит" '
						On SAM_Click
							If nEdit = 0
								If not IsWindow( hF4 )
									Set hF4 = 
											 SalCreateWindow( FORMA, hWndMDI, nTip_Kl, '', RNK, OKPO, 4, strTip, NMK, DATETIME_Null, 0 )
								Else
									Call SalBringWindowToTop ( hF4 )
							Else
								If not IsWindow(hKV5)
									Set hKV5 = SalCreateWindow( KV5, hWndMDI, OKPO, '', 4, strTip, NMK, oDAT )
								Else
									Call SalBringWindowToTop ( hKV5 )
				Pushbutton: pb_Koef
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_FINS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Показники фінінсово-господарської діяльності'
						On SAM_Click
							If T8.OKPO > 0
								If not IsWindow(hKOEF)
									Set hKOEF = SalCreateWindow( KOEF, hWndMDI, T8.nTip_Kl, T8.OKPO, FZ, strTip, T8.NMK, T8.oDAT )
								Else
									Call SalBringWindowToTop ( KOEF )
				Data Field: oDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.071"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата розрахунку' )
				Child Table: TF1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left:   5.583"
							Top:    -0.012"
							Width:  4.1"
							Width Editable? Yes
							Height: 1.5"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Sky
						View: Table
						Allow Row Sizing? No
						Lines Per Row: Default
					Memory Settings
						Maximum Rows in Memory: Default
						Discardable? Yes
					Contents
						Column: FIN
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: №
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  0.45"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: NAM
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Клас
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  2.517"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: ZIP
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Поріг
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  0.833"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
					Functions
					Window Variables
					Message Actions
						On SAM_FetchRowDone
							If T8.nIP1 >= T8.TF1.ZIP and T8.nIP1 <  T8.ZIP1
								Call XSalTblSetRowBackColor( T8.TF1, lParam, T8.nCol[7] )
								Set T8.FIN1 = T8.TF1.FIN
								Set sStan = T8.TF1.NAM
								! Set FIN_STAN_R = sStan
								Set cmbFIN = sStan
								Set nFin = FIN1
							Set T8.ZIP1 = T8.TF1.ZIP
				! Data Field: FIN_STAN_R
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.988"
							Width:  5.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold-Italic
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					               Message Actions 
				Multiline Field: ml_TXT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 2000
						String Type: Long String
						Editable? Yes
					Display Settings
						Border? Yes
						Word Wrap? No
						Vertical Scroll? Yes
						Window Location and Size
							Left:   9.783"
							Top:    -0.012"
							Width:  6.3"
							Width Editable? Yes
							Height: 1.5"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Висновки' )
				Data Field: dTXT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.083"
							Top:    1.238"
							Width:  3.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold-Italic
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код формы' )
						On SAM_Create
							If mFin='4' ! Методика Петрокомерц
								Call SalHideWindow( dTXT1 )
				Data Field: dCusttype
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.483"
							Top:    0.988"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold-Italic
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Тип кл.' )
						On SAM_Create
							If mFin='4' ! Методика Петрокомерц
								Call SalHideWindow( dCusttype )
				Data Field: tPet
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.738"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Методика' )
							If mFin='4' ! Методика Петрокомерц
								Call SalHideWindow( tPet )
				Combo Box: cmbFIN
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   0.183"
						Top:    0.405"
						Width:  4.9"
						Width Editable? Class Default
						Height: 0.881"
						Height Editable? Class Default
					Visible? Yes
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: 35
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Финанс.состояние заемщика' )
						On SAM_Create
							If mFin='4' ! Методика Петрокомерц
								Call cmbFIN.Init(hWndItem)
								Call cmbFIN.Populate(hSql(), "FIN","NAME",
										     "STAN_FIN",
										     "ORDER BY FIN")
							Else
								Call SalHideWindow( cmbFIN )
						On SAM_Click
							Set nFin = FIN1
							Set FIN1 = cmbFIN.GetKey(SalListQuerySelection(hWndItem))
							Set sStan = cmbFIN
				Combo Box: cmbOBS
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   0.183"
						Top:    0.655"
						Width:  4.9"
						Width Editable? Class Default
						Height: 0.881"
						Height Editable? Class Default
					Visible? Yes
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: 35
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Состояние обсуживания долга' )
						On SAM_Create
							If mFin='4' ! Методика Петрокомерц
								Call cmbOBS.Init(hWndItem)
								Call cmbOBS.Populate(hSql(), "OBS","NAME",
										     "STAN_OBS",     "ORDER BY OBS")
							Else
								Call SalHideWindow( cmbOBS )
						On SAM_Click
							Set nOBS = cmbOBS.GetKey(SalListQuerySelection(hWndItem))
							Call F_s080(FIN1, nOBS, S080, sRISK )
							Set ml_TXT = ml_TXT || " 
									Состояние обслуж.долга=" || cmbOBS || " 
									Категория риска = (" || S080 || ") "||  sRISK
				Data Field: NMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    1.155"
							Width:  4.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Клиент' )
				Data Field: FIN_STAN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.483"
							Top:    0.905"
							Width:  2.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold-Italic
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Класс заемщика из БД' )
				Data Field: S080
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.905"
							Width:  0.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold-Italic
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'S080-категория риска' )
						On SAM_Create
							If mFin != '4' ! Методика Петрокомерц
								Call SalHideWindow( S080 )
				Data Field: sRISK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.583"
							Top:    0.905"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold-Italic
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование S080-категория риска' )
						On SAM_Create
							If mFin != '4' ! Методика Петрокомерц
								Call SalHideWindow( sRISK )
		Contents
			Column: GRP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Група
						
						А
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sGRP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Група
						
						А
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: POK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						
						2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Числове 
						значення 
						3
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: ####0000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оцінка
						коефіц.
						6
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.917"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: VZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вагоме
						значення
						4
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VKG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ваг.коеф.
						групи
						5
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.95"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Інтегрований
						показник
						6 =  4 х 5
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.333"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Не 
						быльше
						7
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NSTR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: NSTR
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.533"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SVID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.35"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_TXT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTmp
				Actions
					Set sTmp =
							"По ОКПО=" || Str(OKPO)|| " 
							Зберегти зміни в висновких 
							та 
							Розрахунковий клас фін.стану = " || sStan || " 
							"
					If SalMessageBox(sTmp || ' ?', 'Увага !', MB_IconQuestion | MB_YesNo) = IDYES
						If 
								SqlPrepareAndExecute( hSql(), "UPDATE customer set crisk=:FIN1 where rnk=:RNK " )
								and
								(b_TXT and
								 SqlPrepareAndExecute( hSql(),"UPDATE fin_txt set txt=:ml_TXT where OKPO=:OKPO and fdat=:oDAT " )
								 or
								 not b_TXT and
								 SqlPrepareAndExecute(hSql(),"INSERT into fin_txt (OKPO,fdat,txt) values (:OKPO,:oDAT,:ml_TXT)" )
								 )
								and SqlCommitEx( hSql(), sTmp )
							Set b_TXT = TRUE
							Set FIN_STAN = sStan
							Call MessageNoWait( sTmp ,'Повідомлення',3,0)
					Else
						Set sStan = FIN_STAN 
						Set cmbFIN = sStan
						Set FIN1= nFin 
			Function: F_TXT0
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set b_TXT =
							SqlPrepareAndExecute( hSql(),
							"SELECT txt into :ml_TXT from fin_txt where OKPO=:OKPO and fdat=:oDAT" )
							and SqlFetchNext( hSql(), nFetchRes )
					Call SalSetFocus( ml_TXT )
			! Function: F_PRINT_P ! mFin='4' ! Методика Петрокомерц
				   Description: 
				   Returns 
					   Boolean: 
				   Parameters 
				   Static Variables 
				   Local variables 
					   String: s9
					   String: pShablon
					! String: Shablon
					   String: Pref
					   String: rPref
					   String: strFa
					   Number: nRow
					   Number: i 
					   Number: oN2
					   Number: oN1
					   Date/Time: oD2
					   Date/Time: oD1
					!
				   Actions 
					   Call SalWaitCursor(TRUE)
					! Set s9 =  SalNumberToChar( 9 )
					! Полное имя шаблона
					   If T8.nTip_Kl = 2
						   Set Pref = "U"
						   Set rPref = "ЮО"
					   Set pShablon = GetTemplateDir() || "\\" ||"FIN_ST_"|| Pref ||".XLS" 
					   Set strFa = GetPrnDir() || "\\"|| Pref || SalStrLeftX( Str(10000000000 + OKPO) , 7 ) ||".XLS"
					   Set i = VisFileCopy( pShablon, strFa )
					   If i !=1 
						   Call SalWaitCursor(FALSE)
						   Call SalMessageBox( 
								"Не удалось скопировать файл. Код ош.="||Str(i), 
								pShablon ||"->"|| strFa,
								MB_IconStop)
						   Return FALSE
					!
					! говорим что хотим работать с Excel
					   Set excel.nTargetApp = atExcel
					! создаем excel
					   If excel.OpenApplication()
						! загружаем туда шаблон с диска
						   Call excel.LoadDoc( strFa )
						! пример заполнения отдельной ячейки (X=1, Y=3)
						!
						   Set OKPO_P =  SalStrRightX( '0000000000'||Str(OKPO), IifN(T8.nTip_Kl = 3,10,8) )
						   Call excel.SetTableCell(1,2, NAME_P  )
						   Call excel.SetTableCell(1,3,'Код ЕГРПОУ     : '||OKPO_P  )
						   Call excel.SetTableCell(1,4,'Дата расчета   : '||SalFmtFormatDateTime( SalDateCurrent( ), 'dd/MM/yyyy' ) )  
						   Call excel.SetTableCell(1,5,'Отчетный период: '||SalFmtFormatDateTime( oDAT, 'dd/MM/yyyy' ) )  
						   Call excel.SetTableCell(1,6,'Отрасль:  '||sGal )  
						   If Pref = "U"
							   Set oD2 = AddMonths(oDAT,-6)
							   Set oD1 = AddMonths(oDAT,-3)
							   Call excel.SetTableCell(3,8,SalFmtFormatDateTime( oD2, 'dd/MM/yyyy' )  )
							   Call excel.SetTableCell(4,8,SalFmtFormatDateTime( oD1, 'dd/MM/yyyy' )  )
							   Call excel.SetTableCell(5,8,SalFmtFormatDateTime(oDAT, 'dd/MM/yyyy' )  )
							   Call excel.SetTableCell(8,8,SalFmtFormatDateTime(oDAT, 'dd/MM/yyyy' )  )
						!
						   Set nRow = TBL_MinRow
						   While SalTblFindNextRow( hWndForm, nRow, 0, 0)
							   Call SalTblSetContext(hWndForm, nRow)
							   If NSTR != NUMBER_Null and NSTR > 0
								! Call Debug (Str(IP) )
								   If POK != STRING_Null and POK != '***' 
									   Call excel.SetTableCell(5,NSTR,SalNumberToStrX(RZ,2 ) )  
									   Call excel.SetTableCell(6,NSTR,Str(VZ) )  
									   If Pref = "U"
										   Call excel.SetTableCell(7,NSTR,Str(VKG*100) )  
										   If POK>='610' and POK<'700'
											   Set nPOK = Val(POK)
											   If SqlPrepareAndExecute( hSql(), 
													"SELECT FIN_2.pok25(:nPOK,:oD2,0,:T8.OKPO),
													        FIN_2.pok25(:nPOK,:oD1,0,:T8.OKPO )
													 INTO :oN2, :oN1 from dual " )
													and  SqlFetchNext( hSql(), nFetchRes )
												   Call excel.SetTableCell(3,NSTR,SalNumberToStrX(oN2,2) )  
												   Call excel.SetTableCell(4,NSTR,SalNumberToStrX(oN1,2) )  
										! Call excel.SetTableCell(6,NSTR,Str(IP) )  
									   Set i = NSTR
						!
						   Call excel.SetTableCell(3,55,SalFmtFormatDateTime( oD2, 'dd/MM/yyyy' )  )
						   Call excel.SetTableCell(4,55,SalFmtFormatDateTime( oD1, 'dd/MM/yyyy' )  )
						   Call excel.SetTableCell(5,55,SalFmtFormatDateTime(oDAT, 'dd/MM/yyyy' )  )
						   Call excel.SetTableCell(5,56,sStan )  
						   Call excel.SetTableCell(5,57,cmbOBS ) 
						   Call excel.SetTableCell(5,58,sRISK )
						   Call excel.SetTableCell(5,60, GetUserRealName() )  
						!
						! показываем excel на экран
						   Call SalWaitCursor(FALSE)
						   Call excel.ShowApplication()
						   Return TRUE
					   Return FALSE
			Function: F_PRINT_P ! mFin='4' ! Методика Петрокомерц
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: s9
					String: pShablon
					! String: Shablon
					String: Pref
					String: rPref
					String: strFa
					Number: nRow
					Number: i 
					Number: oN2
					Number: oN1
					Date/Time: oD2
					String: sD2
					Date/Time: oD1
					String: sD1
					String: sDAT
					!
				Actions
					Call SalWaitCursor(TRUE)
					! Set s9 =  SalNumberToChar( 9 )
					! Полное имя шаблона
					If T8.nTip_Kl = 2
						Set Pref = "U"
						Set rPref = "ЮО"
					Set pShablon = GetTemplateDir() || "\\" ||"FIN_ST_"|| Pref ||".XLS" 
					Set strFa = GetPrnDir() || "\\"|| Pref || SalStrLeftX( Str(10000000000 + OKPO) , 7 ) ||".XLS"
					Set i = VisFileCopy( pShablon, strFa )
					If i !=1 
						Call SalWaitCursor(FALSE)
						Call SalMessageBox( 
								"Не удалось скопировать файл. Код ош.="||Str(i), 
								pShablon ||"->"|| strFa,
								MB_IconStop)
						Return FALSE
					! говорим что хотим работать с Excel
					Set excel.nTargetApp = atExcel
					! создаем excel
					If excel.OpenApplication()
						! загружаем туда шаблон с диска
						Call excel.LoadDoc( strFa )
						! пример заполнения отдельной ячейки (X=1, Y=3)
						!
						Set OKPO_P =  SalStrRightX( '0000000000'||Str(OKPO), IifN(T8.nTip_Kl = 3,10,8) )
						Call excel.SetTableCell(1,2, NAME_P  )
						Call excel.SetTableCell(1,3,'Код ЕГРПОУ     : '||OKPO_P  )
						Call excel.SetTableCell(1,4,'Дата расчета   : '||SalFmtFormatDateTime( SalDateCurrent( ), 'dd/MM/yyyy' ) )  
						Call excel.SetTableCell(1,5,'Отчетный период: '||SalFmtFormatDateTime( oDAT, 'dd/MM/yyyy' ) )  
						Call excel.SetTableCell(1,6,'Отрасль:  '||sGal )  
						If Pref = "U"
							Set oD2 = AddMonths(oDAT,-2)
							Set sD2 = SalFmtFormatDateTime( oD2, 'dd/MM/yyyy' )
							Call excel.SetTableCell(3,8,sD2  )
							Call excel.SetTableCell(3,55,sD2  )
							!
							Set oD1 = AddMonths(oDAT,-1)
							Set sD1 = SalFmtFormatDateTime( oD1, 'dd/MM/yyyy' )
							Call excel.SetTableCell(4,8,sD1  )
							Call excel.SetTableCell(4,55,sD1  )
							!
							Set sDAT = SalFmtFormatDateTime(oDAT, 'dd/MM/yyyy' )
							Call excel.SetTableCell(5,8,sDAT )
							Call excel.SetTableCell(8,8,sDAT )
							Call excel.SetTableCell(5,55,sDAT  )
							!
						!
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( hWndForm, nRow, 0, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If NSTR != NUMBER_Null and NSTR > 0
								! Call Debug (Str(IP) )
								If POK != STRING_Null and POK != '***' 
									Call excel.SetTableCell(5,NSTR,SalNumberToStrX(RZ,2 ) )  
									Call excel.SetTableCell(6,NSTR,Str(VZ) )  
									If Pref = "U"
										Call excel.SetTableCell(7,NSTR,Str(VKG*100) )  
										! If POK>='610' and POK<'700'
										Set nPOK = Val(POK)
										If SqlPrepareAndExecute( hSql(), 
												"SELECT FIN_2.pok25(:nPOK,:oD2,0,:T8.OKPO),
												        FIN_2.pok25(:nPOK,:oD1,0,:T8.OKPO )
												 INTO :oN2, :oN1 from dual " )
												and  SqlFetchNext( hSql(), nFetchRes )
											Call excel.SetTableCell(3,NSTR,SalNumberToStrX(oN2,2) )  
											Call excel.SetTableCell(4,NSTR,SalNumberToStrX(oN1,2) )  
										! Call excel.SetTableCell(6,NSTR,Str(IP) )  
									Set i = NSTR
						!
						! Call excel.SetTableCell(3,55,sD2  )
						! Call excel.SetTableCell(4,55,sD1  )
						! Call excel.SetTableCell(5,55,sDAT  )
						!
						Call excel.SetTableCell(5,56,sStan )  
						Call excel.SetTableCell(5,57,cmbOBS ) 
						Call excel.SetTableCell(5,58,sRISK )
						Call excel.SetTableCell(5,60, GetUserRealName() )  
						!
						! показываем excel на экран
						Call SalWaitCursor(FALSE)
						Call excel.ShowApplication()
						Return TRUE
					Return FALSE
			Function: F_PRINT_K ! 
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: s9
					String: pShablon
					! String: Shablon
					String: Pref
					String: rPref
					String: strFa
					Number: nRow
					Number: i
					!
					Number: nOK1
					Number: nOK2
				Actions
					Call SalWaitCursor(TRUE)
					! Set s9 =  SalNumberToChar( 9 )
					! Полное имя шаблона
					If T8.nTip_Kl = 2
						Set Pref = "U"
						Set rPref = "ЮО"
					Else If T8.nTip_Kl = 23
						Set Pref = "S"
						Set rPref = "СПД"
					If T8.nTip_Kl = 3
						Set Pref = "F"
						Set rPref = "ФО"
					Set pShablon = GetTemplateDir() || "\\" ||"FIN_ST_"|| Pref ||".XLS" 
					Set strFa = GetPrnDir() || "\\"|| Pref || SalStrLeftX( Str(10000000000 + OKPO) , 7 ) ||".XLS"
					Set i = VisFileCopy( pShablon, strFa )
					If i !=1 
						Call SalWaitCursor(FALSE)
						Call SalMessageBox( 
								"Не удалось скопировать файл. Код ош.="||Str(i), 
								pShablon ||"->"|| strFa,
								MB_IconStop)
						Return FALSE
					!
					! говорим что хотим работать с Excel
					Set excel.nTargetApp = atExcel
					! создаем excel
					If excel.OpenApplication()
						! загружаем туда шаблон с диска
						Call excel.LoadDoc( strFa )
						! пример заполнения отдельной ячейки (X=1, Y=3)
						Set OKPO_P = rPref || 
								', Ідентифікаційний код '|| SalStrRightX( '0000000000'||Str(OKPO), IifN(T8.nTip_Kl = 3,10,8) )
						Call excel.SetTableCell(2,3,NAME_P  )
						Call excel.SetTableCell(4,3,OKPO_P  )
						Call excel.SetTableCell(2,5,'Дата складання висковку:'||SalFmtFormatDateTime( SalDateCurrent( ), 'dd.MM.yyyy' ) )  
						If Pref = "U"
							Call excel.SetTableCell(6,7,SalFmtFormatDateTime(oDAT, 'dd/MM/yyyy' )  )
							Call excel.SetTableCell(7,7,SalFmtFormatDateTime( AddMonths(oDAT,-3), 'dd/MM/yyyy' )  )
							Call excel.SetTableCell(8,7,SalFmtFormatDateTime( AddMonths(oDAT,-6), 'dd/MM/yyyy' )  )
						Else
							Call excel.SetTableCell(5,7,SalFmtFormatDateTime(oDAT, 'dd/MM/yyyy' )  )
							Call excel.SetTableCell(6,7,SalFmtFormatDateTime( AddMonths(oDAT,-3), 'dd/MM/yyyy' )  )
							Call excel.SetTableCell(7,7,SalFmtFormatDateTime( AddMonths(oDAT,-6), 'dd/MM/yyyy' )  )
						!
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( hWndForm, nRow, 0, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If NSTR != NUMBER_Null and NSTR > 0
								! Call Debug (Str(IP) )
								If POK != STRING_Null and POK != '***' 
										and (POK > '960' and T8.nTip_Kl = 23 OR POK < '960'  )
									! Текущий кв
									Call excel.SetTableCell(3,NSTR,Str(RZ) )  
									Call excel.SetTableCell(4,NSTR,Str(VZ) )  
									Set nPOK = Val(POK)
									If SqlPrepareAndExecute( hSql(), 
											"SELECT FIN_2.OCI17(:nPOK, :T8.oDAT, 3, :T8.OKPO ),
											        FIN_2.OCI17(:nPOK, :T8.oDAT, 6, :T8.OKPO ) 
											 INTO :nOK1, :nOK2  from dual ")
											and  SqlFetchNext( hSql(), nFetchRes )
									! 2 прошлых кв
									If Pref = "U"
										Call excel.SetTableCell(5,NSTR,Str(VKG) )  
										Call excel.SetTableCell(6,NSTR,Str(IP) )  
										Call excel.SetTableCell(7,NSTR,Str( nOK1 * T8.VKG ) )  
										Call excel.SetTableCell(8,NSTR,Str( nOK2 * T8.VKG ) )  
									Else
										Call excel.SetTableCell(5,NSTR,Str(IP) )  
										Call excel.SetTableCell(6,NSTR,Str( nOK1 * T8.VZ ) )  
										Call excel.SetTableCell(7,NSTR,Str( nOK2 * T8.VZ ) )  
									Set i = NSTR
						! Call excel.SetTableCell(6,39,Str(IP) )  
						Call excel.SetTableCell(2, i+4, ml_TXT )  
						Call excel.SetTableCell(3, i+7, FIN_STAN )  
						Call excel.SetTableCell(3, i+8, sStan )  
						! Call excel.SetTableCell(2,i+9, "Виконавець           ____________________ / ________________/" )  
						! Call excel.SetTableCell(3,i+10,"Керівник підрозділу  ____________________ / ________________/")  
						! !
						! показываем excel на экран
						Call SalWaitCursor(FALSE)
						Call excel.ShowApplication()
						Return TRUE
					Return FALSE
		Window Parameters
			Number: nEdit
			Number: OKPO
			!
		Window Variables
			Boolean: b_TXT
			! Number: nSPD ! Сумма балов по показателям для СПД
			Number: nCol[13]
			Number: RNK
			String: sGal
			Number: nIP1
			Number: nIP1o
			Number: nIP1s
			Number: nX
			Number: IP_1
			Number: IP_2
			Number: RZ_1
			Number: RZ_2
			Number: OK_1
			Number: OK_2
			Number: nRow
			Number: ZIP1
			Number: nFin
			Number: FIN1
			Number: FIN2
			Number: nOBS
			!
			Number: nTip_Kl
			String: sStan
			String: FZ
			: excel
				Class: cReportConstructor
			!
			Number: i
			String: sRZ
			Date/Time: oDAT1
			String: sRZ1
			Number: OK1
			Date/Time: oDAT2
			String: sRZ2
			Number: OK2
			Number: nPOK
			String: FIO1
			String: FIO2
			String: sSql1
			String: sSql2
			! !
			String: OKPO_P
			String: NAME_P
		Message Actions
			On SAM_Create
				Call F_CLOSE_FORMA( OKPO )
				Set T8.nCol[0]= SalColorFromRGB( 220,255,255 ) ! голубой
				Set T8.nCol[1]= SalColorFromRGB( 220,255,255 ) ! голубой
				Set T8.nCol[2]= SalColorFromRGB( 255,255,220)  !  желтій
				Set T8.nCol[3]= SalColorFromRGB( 230,245,240 ) ! бледнфиолет
				Set T8.nCol[4]= SalColorFromRGB( 230,255,230 ) ! бледнозеленый
				Set T8.nCol[5]= SalColorFromRGB( 220,255,255 ) ! голубой
				Set T8.nCol[6]= SalColorFromRGB( 250,250,250 ) ! серый
				Set T8.nCol[7]= SalColorFromRGB( 255,210,255 ) ! розовій
				Set T8.nCol[8]= SalColorFromRGB( 230,255,230 ) ! бледнозеленый
				Set T8.nCol[9]= SalColorFromRGB( 220,255,255 ) ! голубой
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 4 )
				Set T8.strPrintFileName = 'T_8'
				Set T8.nTabInstance = 1
				!
				If T8.nEdit != 0
					Call SalDisableWindow( pbUpdate )
				Call SalWaitCursor( TRUE )
				!
				! разное
				Set sSql1 =
						"SELECT decode(c.custtype,2,2,decode(c.sed,91,23,3)),
						        trunc(sysdate,'Q'), c.nmk, f.name,
						        DECODE( UPPER( NVL(w.value,' ')),'M','M',''), c.rnk
						 INTO :nTip_Kl, :oDAT, :NMK, :FIN_STAN,  :FZ, :RNK
						 FROM customer c,  stan_fin f , customerW w
						 WHERE c.rnk=w.rnk(+) and
						   w.tag(+)='FZ' and c.custtype in (2,3) and to_number(c.OKPO)=:OKPO and c.crisk=f.Fin(+) and rownum=1 
						   and (c.date_off is null or c.date_off>bankdate)"
				Set sSql2 =
						"SELECT c.custtype, trunc(sysdate,'Q'), c.nmk, c.FZ
						 INTO :nTip_Kl,:oDAT,:NMK,:FZ
						 FROM fin_cust c WHERE to_number(c.OKPO)=:OKPO and rownum =1 "
				If SqlPrepareAndExecute( hSql(),sSql1 ) and not SqlFetchNext( hSql(), nFetchRes )
					Set RNK= NUMBER_Null
					If SqlPrepareAndExecute(hSql(),sSql2) and not SqlFetchNext( hSql(), nFetchRes )
						Call SalDestroyWindow(hWndForm)
				If SqlPrepareAndExecute(hSql(),"SELECT max(fdat) into :oDAT from fin_rnk where okpo=:OKPO")
						and SqlFetchNext( hSql(), nFetchRes )
				Set NAME_P = NMK
				Set NMK = Str(OKPO) ||' '|| NMK
				Call SalSetWindowText( T8, NMK || '. Аналіз фінансового стану'  )
				!
				If mFin='4' ! Методика Петрокомерц
					Call SalTblSetColumnTitle( T8.VKG, 
							"Вес 
							показ.
							5" )
					Set tPet= 'Мет.4 ("Петроком")'
					If SqlPrepareAndExecute( hSql(),
							  "SELECT g.name INTO :sGal FROM fin_rnk f, fin_gal g 
							   WHERE f.idf=0 and f.OKPO=:T8.OKPO and FDAT=:T8.oDAT and f.kod='000' 
							     and Nvl(f.S,99)= g.gal") 
							and SqlFetchNext( hSql(), nFetchRes )
					Set T8.strSqlPopulate =
							"SELECT g.NAME, f.GRP, to_number(f.TZ)/100, 
							        f.POK, f.NAME, f.TZ, f.VZ,
							        f.vid, v.name,
							       FIN_2.pok25(f.ORD, :T8.oDAT, 0, :T8.OKPO ),
							       FIN_2.OCI17(f.ORD, :T8.oDAT, 0, :T8.OKPO ),
							       f.nstr
							 INTO :T8.sGRP,:T8.GRP,  :T8.VKG,
							      :T8.POK,:T8.NAME, :T8.TZ, :T8.VZ,
							      :T8.VID, :T8.SVID,
							      :T8.RZ, :T8.OK, 
							      :T8.NSTR
							 FROM FIN_pok f, FIN_GRP g, FIN_POK_VID v 
							 WHERE f.vid = v.vid (+) and g.ORD = f.GRP and " ||
							 IifS(T8.nTip_Kl=3, "f.ORD>=900 and f.ORD<960", 
							 IifS(T8.nTip_Kl=23,"f.ORD>=900","f.ORD<900") ) || "
							 ORDER BY g.ORD, f.ord"
				If mFin='2' ! Методика Киев
					Set tPet= 'Мет.2 ("КИЇВ")'
					Set T8.strSqlPopulate =
							"SELECT g.NAME, f.GRP, g.VK,  f.POK, f.NAME, f.TZ, f.VZ, f.vid, v.name,
							       FIN_2.pok25(f.ORD, :T8.oDAT, 0, :T8.OKPO ),
							       FIN_2.OCI17(f.ORD, :T8.oDAT, 0, :T8.OKPO ), f.nstr
							 INTO :T8.sGRP,:T8.GRP,  :T8.VKG,:T8.POK,:T8.NAME, :T8.TZ, :T8.VZ,
							      :T8.VID, :T8.SVID, :T8.RZ, :T8.OK, :T8.NSTR
							 FROM FIN_pok f, FIN_GRP g, FIN_POK_VID v 
							 WHERE f.vid = v.vid (+) and g.ORD = f.GRP and " ||
							 IifS(T8.nTip_Kl=3, "f.ORD>=900 and f.ORD<960", 
							 IifS(T8.nTip_Kl=23,"f.ORD>=900","f.ORD<900") ) || "
							 ORDER BY g.ORD, f.ord"
				If T8.nTip_Kl = 3 or T8.nTip_Kl = 23
					Call SalHideWindow( T8.dTXT1 )
					Call SalHideWindow( pb_1 )
					Call SalHideWindow( pb_2 )
					Call SalHideWindow( pb_3 )
					Call SalHideWindow( pb_4 )
					Call SalHideWindow( T8.VKG )
					Call SalHideWindow( T8.TZ)
					Call SalHideWindow( T8.sGRP )
					Call SalTblSetColumnTitle( T8.IP,
							"Інтегрований
							показник
							5 = 3 х  4" )
					!
				Else
					Set T8.dTXT1 = 'Форми звітів №1, №2 '|| T8.FZ
				Set dCusttype = IifS(T8.nTip_Kl=3, "ФО", IifS (T8.nTip_Kl=23,"СПД","ЮО") )
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call T8.F_TXT0()
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Set T8.nIP1 = 0
				Set T8.nIP1s = 0
				Set T8.nIP1o = 0
				Call SalTblPopulate(hWndForm, hSql(), T8.strSqlPopulate, TBL_FillAll)
				!
				Call SalTblDefineSplitWindow(hWndForm, 3, TRUE)
				If nTip_Kl= 2
					Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
					Call SalTblSetContext (hWndForm, nRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Set NAME = 'Сума балів по об`єктивним показникам'
					Set POK  = '***'
					Set T8.IP   = nIP1o
					!
					Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
					Call SalTblSetContext (hWndForm, nRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Set NAME = 'Сума балів по суб`єктивним показникам'
					Set POK  = '***'
					Set T8.IP   = nIP1s
					If mFin! ='4' ! HE  Методика Петрокомерц
						! nIP1o - 70
						! nIP1s (nX) - 30
						Set nX =  nIP1o*nPR_30 / nPR_70 
						! Set nX = SalNumberRound( nIP1o*nPR_30 / nPR_70 )
						Set nIP1s = SalNumberMin( nIP1s, nX )
					Set nIP1 = nIP1o + nIP1s
				!
				If T8.nIP1 < 0
					Set T8.nIP1 = 0
				!
				Set T8.nRow = SalTblInsertRow( hWndForm, TBL_MinRow  )
				Call SalTblSetContext ( hWndForm, T8.nRow )
				Call SalTblSetRowFlags( hWndForm, T8.nRow, ROW_New, FALSE )
				Set T8.NAME = 'Фінальний Інтегральний показник (S)'
				Set T8.POK = '***'
				Call XSalTblSetCellBackColor( T8.NAME, COLOR_LightAqua )
				Set T8.IP = T8.nIP1
				Call XSalTblSetCellBackColor( T8.IP, T8.nCol[7] )
				!
				Call SalTblSetContext( hWndForm, 0)
				Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
				!
				Set T8.ZIP1 = 100000000
				Call SalTblPopulate(T8.TF1,  hSql(),
						"SELECT fin, name, ip"|| IifS(T8.nTip_Kl=23,"23", IifS(T8.nTip_Kl=3,"3","")) || " 
						 INTO :T8.TF1.FIN, :T8.TF1.NAM, :T8.TF1.ZIP
						 FROM STAN_FIN order by FIN ", TBL_FillAll)
				! ! Сумма балов по показателям для СПД
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Call XSalTblSetRowBackColor( hWndForm, lParam, T8.nCol[T8.GRP] )
				!
				!
				If nTip_Kl= 2
					! Оценка * Ваг. зна гр
					!
					Set T8.VZ = T8.OK
					Set T8.IP =  T8.VZ * T8.VKG
					If VID =1 
						Set nIP1o = nIP1o + T8.IP
					Else
						Set nIP1s = nIP1s + T8.IP
				Else
					! Оценка * Ваг.зн 
					Set T8.RZ = T8.OK
					Set T8.IP =  T8.OK * T8.VZ
					Set nIP1 = nIP1 + T8.IP
				!
				If T8.IP = 0
					Set T8.IP = NUMBER_Null
			!
			On SAM_ReportStart
				Set oDAT1 = AddMonths( oDAT, -3 )
				Set oDAT2 = AddMonths( oDAT, -6 )
				Set FIO1=GetUserRealName()
				Set FIO2=''
				Set i = TBL_MinRow
			On SAM_ReportFetchInit
				Return TRUE
			On SAM_ReportFetchNext
				While SalTblFindNextRow(hWndForm, i, 0, 0)
					Call SalTblFetchRow(hWndForm, i)
					If T8.POK != '***'
						Set nPOK = Val(POK)
						If SqlPrepareAndExecute( hSql(),
								"SELECT FIN_2.pok25(:nPOK,:oDAT1,0,:OKPO ),
								        FIN_2.OCI17(:nPOK,:oDAT1,0,:OKPO ),
								        FIN_2.pok25(:nPOK,:oDAT2,0,:OKPO ),
								        FIN_2.OCI17(:nPOK,:oDAT2,0,:OKPO )
								 INTO :RZ_1, :OK_1,:RZ_2, :OK_2 from dual ")
								and SqlFetchNext( hSql(), nFetchRes )
						Set IP_1 = T8.VKG * (T8.VZ * RZ_1 + OK_1)
						Set IP_2 = T8.VKG * (T8.VZ * RZ_2 + OK_2)
						Return TRUE
				Return FALSE
			On SAM_ReportFinish
				Call SalWaitCursor(FALSE)
				! Call DosDirectPrint(strFa)
	Table Window: DELO
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Архів кореспонденцій
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.025"
				Top:    -0.01"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.833"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29645
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29646
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29647
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Run1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.583"
						Top:    0.071"
						Width:  0.45"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Загрузити документ в БД з елестронного носія'
						On SAM_Click
							If ID > 0
								Set nYES1 = Imp_File( SPECIFIC, ID, nYES1 )
				Pushbutton: pb_Run2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.083"
						Top:    0.071"
						Width:  0.45"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCVIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вигрузити документ з БД'
						On SAM_Click
							If ID > 0 and nYES1 = 1 and F_SIZE >0
								Call Exp_File( SPECIFIC, F_SIZE, ID )
				Option Button: pb_Clos
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    0.071"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \bars98\RESOURCE\BMP\TUDASUDA.BMP
					Picture Transparent Color: White
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Розкрити / Закрити допоміжне вікно' )
						On SAM_Click
							If pb_Clos
								Call SalHideWindow( DELO1 )
							Else
								Call SalShowWindow( DELO1 )
		Contents
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Систем
						 №
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT_SYS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Системна
						дата
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  0.883"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nYES1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Файл
						в БД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: DATE_ACT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						отримання
						(відправки)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 10
				Data Type: Date/Time
				Justify: Center
				Width:  1.117"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If DATE_ACT = DATETIME_Null
							Set DATE_ACT = SalDateCurrent( )
			Column: DATE_DOK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						документа
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.133"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If DATE_DOK = DATETIME_Null
							Set DATE_DOK = SalDateCurrent( )
			Column: NAPRAV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1 = In
						0 = Out
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If NAPRAV = NUMBER_Null
							Set NAPRAV = 1
			Column: NUM_DOK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № документа
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If NUM_DOK = STRING_Null
							Set NUM_DOK = '?'
			Column: CODE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						коресп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_SetFocus
						                                                                                                                                                                                                    If CODE = STRING_Null
							                                                                                                                                                                                                    Set CODE = sCODE
							                                                                                                                                                                                                    Set KORESP = sKORESP
					! On SAM_Validate
						                                                                                                                                                                                                    If CODE = STRING_Null
							                                                                                                                                                                                                    Set CODE = sCODE
							                                                                                                                                                                                                    Set KORESP = sKORESP
						                                                                                                                                                                                                    Else
							                                                                                                                                                                                                    If SqlPrepareAndExecute( hSql(), "SELECT KORESP into :KORESP FROM SABO_KORESP where CODE=:CODE " )
									and not SqlFetchNext( hSql(), nFetchRes )
								                                                                                                                                                                                                    Return VALIDATE_Cancel
						                                                                                                                                                                                                    Return VALIDATE_Ok
			Column: KORESP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						коресп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Set sTmp = CODE
						Call FunNSIGet('SABO_KORESP','KORESP', sTmp, KORESP )
						If CODE != sTmp
							Set CODE = sTmp
							If DELO.ID > 0
								! установитьфлаг кор
								Call SalTblSetRowFlags( DELO, SalTblQueryContext(  DELO  ), ROW_Edited, TRUE )
							! Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(  hWndForm  ), ROW_Edited, TRUE )
			Column: INFORM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Коротко:
						Зміст
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 250
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If INFORM = STRING_Null
							Set INFORM = '?'
			Column: SPECIFIC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Спеціифікація
						 файлу
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 70
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KONTROL_ON
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: На контролі
						з
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KONTROL_TO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: На контролі
						до
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KONTROL_OFF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Контроль
						закрито
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Примітка
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 250
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATE_OFF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						вилучення
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: USER_INS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вніс
						запис
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FIO_INS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ПІБ (хто вніс)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: USER_UPD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Змінив
						запис
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FIO_UPD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ПІБ (хто змінив)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F_SIZE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Розмір
						файлу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: Exp_File
				Description:
				Returns
					Boolean:
				Parameters
					String: sSPECIFIC
					Number: nSize
					Number: nId
				Static Variables
				Local variables
					String: strReport
					File Handle: hFile
					Long String: sTiket
					Number: nK
					String: MAS[*]
				Actions
					! прочитать из архива этот ID и его показать
					Set strReport= SalStrTrimX( sSPECIFIC )
					Set nK = SalStrTokenize( strReport, '', '\\', MAS )
					Set strReport = MAS[nK-1]
					!
					If SqlPrepareAndExecute( hSql(),
							  "SELECT STIKET INTO :sTiket from SABO_body where id=:nId and STIKET is not null " )
							and SqlFetchNext( hSql(), nFetchRes )
						Set strReport = GetPrnDir() ||'\\'|| strReport
						If SalFileOpen( hFile, strReport, 1 )
							Call SalFileWrite( hFile, sTiket, nSize )
							Call SalFileClose( hFile )
							If SalMessageBox("Бажаєте переглянути ? ",
									   'Файл ' || strReport || ' створено ',
									    MB_IconQuestion | MB_YesNo ) = IDYES
								Call SalLoadApp ( 'START', strReport )
					Else
						Call MessageNoWait("Неможливо знайти файл в архіві ! " ,'',2,1)
						Return FALSE
			Function: F1
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nColID
					Window Handle: hWndCol
					Number: nNewRow
					String: strColTag
					String: strColVal
					Number: nRow2
				Actions
					If not IsWindow(hDELO1)
						Set hDELO1 = SalCreateWindow( DELO1, hWndForm, DELO.ID, SalTblQueryContext( DELO ))
					Call SalSetWindowText( DELO1, 'Документ системний № = '|| Str(DELO.ID ))
					Call SalTblReset( DELO1 )
					Set nColID = 1
					Loop
						! хандлер колонки
						Set hWndCol = SalTblGetColumnWindow ( hWndForm, nColID, COL_GetID )
						If hWndCol = hWndNULL
							Return TRUE
						! Заголовок колонки
						Call SalTblGetColumnTitle( hWndCol, strColTag, 100 )
						! значение в Str колонки
						Call SalTblGetColumnText ( hWndForm, nColID, strColVal )
						Set nNewRow = SalTblInsertRow(  DELO1, TBL_MaxRow )
						Call SalTblSetContext(  DELO1, nNewRow )
						Call SalTblSetRowFlags( DELO1, nNewRow, ROW_New, FALSE )
						! Редактируемая колонка или нет
						If nColID = 9
							Set DELO1.RED = 2
						Else
							Set DELO1.RED = SalIsWindowEnabled( hWndCol )
						Call XSalTblSetCellBackColor( DELO1.VAL, DELO.nColor[DELO1.RED]  )
						Call XSalTblSetCellBackColor( hWndCol, DELO.nColor[DELO1.RED]  )
						Set DELO1.TAG = VisStrSubstitute( strColTag, PutCrLf(), ' ' )
						Set DELO1.VAL = strColVal
						! Set DELO1.nWN = SalWindowHandleToNumber( hWndCol )
						Set DELO1.NPP = nColID
						Set nColID = nColID + 1
			Function: Imp_File
				Description: Принять 1 файл  по выбору
				Returns
					Number: nn
				Parameters
					String: sSPECIFIC
					Number: nId
					Number: nYES
				Static Variables
				Local variables
					String: strFilters[*]
					String: strFileName
					String: strFilePath
					Number: nIndex
					Number: nSize
					!
					File Handle: inFile
					Long String: sTiket
					String: sFileM[*]
					Number: nNumFiles
					Number: nRet
				Actions
					Set strFilters[0] = 'Електронний документ'
					Set strFilters[1] = '*'||SalStrRightX( SalStrTrimX( sSPECIFIC ) , 5 )
					! Call Debug(strFilters[1])
					Set nIndex = 1
					Set nRet = -1
					If not SalDlgOpenFile ( hWndForm, 'Вибір електронного документу', strFilters, 2, nIndex, strFileName, sSPECIFIC )
						Return nRet
					!
					Call SalWaitCursor(FALSE)
					Set strFileName = SalStrUpperX( strFileName )
					If nYES
						If SalMessageBox ( "Документ " || strFileName || " уже прийнято. Замінити ?", 'Увагае !', MB_YesNo | MB_IconQuestion ) = IDNO
							Return nRet
						If SqlPrepareAndExecute( hSql(), "delete from SABO_body where ID=:nId ")
								and SqlCommit( hSql())
						Else
							Return nRet
					!
					If SalFileOpen ( inFile, strFileName, OF_Read )
						Set nSize = VisFileGetSize( strFileName )
						If SalFileRead( inFile, sTiket, nSize ) > 0
								and SqlPrepare( hSql(), "INSERT INTO SABO_body (ID, STIKET, F_size ) values (:nId, :sTiket, :nSize )")
								and SqlSetLongBindDatatype(2, BLOB_BYTE)
								and SqlExecute(hSql())
								and SqlPrepareAndExecute( hSql(), 'COMMIT')
							Set nRet = 1
							Set F_SIZE = nSize
							Call SalMessageBox ('Файл ' || strFileName || ' прийнято', 'Повідомлення', MB_Ok | MB_IconExclamation)
						Else
							Call SqlPrepareAndExecute( hSql(), 'ROLL')
						!
						Call SalFileClose( inFile )
					Return nRet
		Window Parameters
			Number: nPar1
			Number: nPar2
		Window Variables
			! Date/Time: bDat
			String: sCODE
			String: sKORESP
			String: sTmp
			Number: nColor [3]
		Message Actions
			On SAM_Create
				Set DELO.nColor[0] = SalColorFromRGB( 255,240,255 )  ! розовій
				Set DELO.nColor[1] = SalColorFromRGB( 230,255,230 ) ! бледнозеленый
				Set DELO.nColor[2] = SalColorFromRGB( 220,255,255 ) ! голубой
				Set DELO.fFilterAtStart = TRUE
				Set DELO.nTabInstance = 1
				If SqlPrepareAndExecute( hSql(),
						  "SELECT CODE,KORESP into :sCODE,:sKORESP FROM SABO_KORESP where CODE=(select min(CODE) from SABO_KORESP) " )
						and SqlFetchNext( hSql(), nFetchRes )
				!
				Set DELO.strSqlPopulate =
						"SELECT DATE_ACT, DATE_DOK, NUM_DOK, CODE, INFORM,
						        NAPRAV, SPECIFIC, DATE_OFF, KONTROL_ON, KONTROL_OFF,
						        PRIM, USER_INS, USER_UPD, KONTROL_TO, ID, DAT_SYS
						 INTO :DELO.DATE_ACT,:DELO.DATE_DOK, :DELO.NUM_DOK, :DELO.CODE, :DELO.INFORM,
						      :DELO.NAPRAV,  :DELO.SPECIFIC, :DELO.DATE_OFF,:DELO.KONTROL_ON, :DELO.KONTROL_OFF,
						      :DELO.PRIM,    :DELO.USER_INS, :DELO.USER_UPD,:DELO.KONTROL_TO, :DELO.ID,
						      :DELO.DAT_SYS
						 FROM SABO_REGISTR
						 order by DATE_ACT desc, CODE, NAPRAV desc, DATE_DOK desc, NUM_DOK "
				!
				If nPar2 =1
					Set DELO.strSqlUpdate =
							"UPDATE SABO_REGISTR
							 set DATE_ACT=:DELO.DATE_ACT, DATE_DOK=:DELO.DATE_DOK, NUM_DOK=:DELO.NUM_DOK,
							         CODE=:DELO.CODE,     INFORM  =:DELO.INFORM,   NAPRAV =:DELO.NAPRAV,
							     SPECIFIC=:DELO.SPECIFIC, DATE_OFF=:DELO.DATE_OFF, KONTROL_ON=:DELO.KONTROL_ON,
							         PRIM=:DELO.PRIM,   KONTROL_TO=:DELO.KONTROL_TO
							where ID=:DELO.ID "
					Set DELO.strSqlInsert =
							"insert into SABO_REGISTR
							   (DATE_ACT, DATE_DOK, NUM_DOK , KONTROL_ON,
							    CODE    , INFORM  , NAPRAV  , KONTROL_OFF,
							    SPECIFIC, DATE_OFF, PRIM    , KONTROL_TO  )
							 values
							 (:DELO.DATE_ACT,:DELO.DATE_DOK,:DELO.NUM_DOK, :DELO.KONTROL_ON,
							  :DELO.CODE,    :DELO.INFORM,  :DELO.NAPRAV , :DELO.KONTROL_OFF,
							  :DELO.SPECIFIC,:DELO.DATE_OFF,:DELO.PRIM   , :DELO.KONTROL_TO) "
				Else
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pb_Run1 )
				Set DELO.strFilterTblName = 'SABO_REGISTR'
				Call SalTblSetLockedColumns( hWndForm, 3 )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If SqlPrepareAndExecute( hSql(), "SELECT KORESP into :DELO.KORESP FROM SABO_KORESP WHERE CODE=:DELO.CODE " )
						and SqlFetchNext( hSql(), nFetchRes )
				If SqlPrepareAndExecute( hSql(), "SELECT FIO into :DELO.FIO_INS FROM staff WHERE id=:DELO.USER_INS " )
						and SqlFetchNext( hSql(), nFetchRes )
				If SqlPrepareAndExecute( hSql(), "SELECT FIO into :DELO.FIO_UPD FROM staff WHERE id=:DELO.USER_UPD " )
						and SqlFetchNext( hSql(), nFetchRes )
				If SqlPrepareAndExecute( hSql(),
						  "SELECT 1, NVL(F_SIZE,0) into :DELO.nYES1,:DELO.F_SIZE FROM SABO_body WHERE id=:DELO.ID  " )
						and SqlFetchNext( hSql(), nFetchRes )
			On SAM_TblDoDetails
				Call DELO.F1()
			On SAM_Destroy
				Call SalDestroyWindow(hDELO1)
				Call SalSendClassMessage(SAM_Destroy,0,0)
	Table Window: DELO1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   4.15"
				Top:    2.813"
				Width:  14.65"
				Width Editable? Class Default
				Height: 7.202"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.417"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Добавити запис в головну таблицю'
						On SAM_Click
							Call SalSendMsg(DELO.pbIns, SAM_Click, 0, 0 )
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Зберегти всі зміни головної таблиці'
						On SAM_Click
							Call SalSendMsg(DELO.pbUpdate, SAM_Click, 0, 0 )
				Line
					Resource Id: 29648
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCVIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29649
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29650
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.8"
						Begin Y:  Class Default
						End X:  2.8"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Run1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.071"
						Width:  0.45"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Загрузити документ в БД з елестронного носія'
						On SAM_Click
							Call SalSendMsg(DELO.pb_Run1, SAM_Click, 0, 0 )
				Pushbutton: pb_Run2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    0.071"
						Width:  0.45"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCVIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вигрузити документ з БД'
						On SAM_Click
							Call SalSendMsg(DELO.pb_Run2, SAM_Click, 0, 0 )
				Pushbutton: pb_Null
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    0.071"
						Width:  0.45"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						п/п
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RED
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ред
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TAG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Колонка
						осн.таблицы
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VAL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Значение
						колонки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  7.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If hWndForm.DELO1.RED  = 0
							Set hWndForm.DELO1.sTmpR = hWndForm.DELO1.VAL
					On SAM_AnyEdit
						If hWndForm.DELO1.RED = 0
							Set hWndForm.DELO1.VAL = hWndForm.DELO1.sTmpR
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Call SalSetFocus( hWndForm.DELO1.pb_Null )
					On SAM_Validate
						! хандлер колонки
						Set hWndCol = SalTblGetColumnWindow( DELO, hWndForm.DELO1.NPP, COL_GetID )
						Set nDataType = SalGetDataType ( hWndCol )
						If nDataType = DT_Number  and not SalIsValidInteger (hWndForm.DELO1.VAL)
								or nDataType = DT_DateTime and  not SalIsValidDateTime (hWndForm.DELO1.VAL)
							Call SalMessageBox( "Ошибка типа (формата) данных " , "Внимание ! ", MB_IconStop)
							Set hWndForm.DELO1.VAL = hWndForm.DELO1.sTmpR
						Else
							Call SalTblSetColumnText( DELO, hWndForm.DELO1.NPP, hWndForm.DELO1.VAL )
							If DELO.ID > 0
								! установитьфлаг кор
								Call SalTblSetRowFlags( DELO, SalTblQueryContext(  DELO  ), ROW_Edited, TRUE )
						Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
					On SAM_DoubleClick
						If hWndForm.DELO1.NPP = 9
							Set hWndForm.DELO1.sTmpE =  DELO.CODE
							Call FunNSIGet('SABO_KORESP','KORESP', hWndForm.DELO1.sTmpE, hWndForm.DELO1.VAL )
							If DELO.CODE != hWndForm.DELO1.sTmpE
								Set DELO.CODE = hWndForm.DELO1.sTmpE
								Call SalSendMsg(hWndForm.DELO1.VAL, SAM_Validate, 0, 0 )
		Functions
		Window Parameters
			Number: ID
			Number: nROW
		Window Variables
			String: sTmpR
			String: sTmpE
			Number: nDataType
			Window Handle: hWndCol
		Message Actions
			On SAM_Destroy
			On UM_Close
	Table Window: TB
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Перенесення залишків рахунків на інші з закриттям старих
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.025"
				Top:    -0.01"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.833"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Закрити рахунок з залишком = 0 '
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29651
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29652
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29653
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Run1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.967"
						Top:    0.071"
						Width:  0.45"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Перевести ВИБРАНІ рахунки '
						On SAM_Click
							Call NEW_NLSP(1, strTip )
				! ctb_pbRelation: pb_Run0
					                                                                                                                                                                                                                   Message Actions
						                                                                                                                                                                                                                   On SAM_Create
							                                                                                                                                                                                                                   Set strTip = 'Перевести ВСІ рахунки '
						                                                                                                                                                                                                                   On SAM_Click
							                                                                                                                                                                                                                   Call NEW_NLSP(0, strTip)
		Contents
			Column: NBS_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Новий
						БАЛ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Старий
						рахунок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						відкриття
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фактичний
						залишок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.483"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Плановий
						залишок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.483"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Майбутній
						залишок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Новий
						рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						рахунку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  5.35"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
						OLD
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: TIP
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
						NEW
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.9"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: NEW_NLSP
				Description:
				Returns
				Parameters
					Number: nMod
					String: strTip
				Static Variables
				Local variables
					Number: nRow
					Number: nCol
					Number: ACC_
					String: NLSN_
					Boolean: FL
				Actions
					If SalMessageBox(strTip || " ? ", " У В А Г А ! ", MB_IconQuestion | MB_YesNo) = IDYES
						Call SalWaitCursor(TRUE)
						Set FL = FALSE
						Set nCol = SalColorFromRGB( 230,255,230 )
						! Все счета
						If nMod = 0
							Set NLSN_ = STRING_Null
							Set ACC_  = NUMBER_Null
							If SqlPLSQLCommand( hSql(), "BARS.NEW_NLSP (0, s9900, NLSN_, ACC_) " )
								Call SqlCommitEx(  hSql(), strTip )
								Set FL = TRUE
							Else
								Call SqlRollback(hSql())
						! По вібранніи смчетам
						Else
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( hWndForm, nRow, ROW_Selected , 0 )
								Call SalTblSetContext( hWndForm, nRow )
								Call SalTblSetFocusRow( hWndForm, nRow )
								! Call DebugN(TB.ACC_OLD)
								Set NLSN_ = STRING_Null
								Set ACC_  = NUMBER_Null
								If TB.ACC_NEW = NUMBER_Null
									If SqlPLSQLCommand( hSql(), "BARS.NEW_NLSP(TB.ACC_OLD,s9900,NLSN_,ACC_) " )
										If NLSN_  != STRING_Null and ACC_ != NUMBER_Null
											Call SqlCommitEx(  hSql(),"Переведено "|| TB.NLS_OLD ||" на " || NLSN_ )
											Set TB.NLS_NEW = NLSN_
											Set TB.ACC_NEW = ACC_
											Call XSalTblSetCellBackColor(TB.NLS_NEW , nCol )
											Set FL = TRUE
										Else
											Call SqlRollback(hSql())
									Else
										Call SqlRollback(hSql())
						Call SalWaitCursor(FALSE)
						If FL
							Call MessageNoWait('Виконано ! '|| strTip,'Повідомлення',3,0)
							! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
		Window Parameters
			Number: nPar1
			Number: nPar2
		Window Variables
			String: s9900
			Date/Time: bDat
		Message Actions
			On SAM_Create
				Set TB.bDat = GetBankDate()
				! If SqlPrepareAndExecute( hSql(),
						"INSERT INTO new_ps1 (KV, NLS_OLD, ACC_OLD,NBS_NEW )
						 select a.kv, a.nls, a.acc, p.NBS_NEW
						 from accounts a, new_ps p
						 where a.nbs not like '___8' and
						       a.nbs=p.nbs and a.dazs is null and
						       a.acc not in (select acc_old from new_ps1)
						 UNION all
						 select a8.kv, a8.nls, a8.acc, p8.NBS_NEW
						 from accounts a8, new_ps p8
						 where a8.nbs like '___8' and
						       a8.nbs=p8.nbs and a8.dazs is null and
						       a8.acc not in (select acc_old from new_ps1) and
						       a8.acc in (select i.acra
						                  from accounts a , new_ps p , int_accn i
						                  where a.acc=i.acc and a.nbs=p.nbs )
						" )
						and SqlCommit( hSql() )
				If SqlPrepareAndExecute( hSql(),
						  "select nvl(NLSM, nlsk) into :s9900 from tts where tt='ZAL'")
						and SqlFetchNext( hSql(), nFetchRes )
				Set TB.fFilterAtStart = TRUE
				!
				Set TB.strSqlPopulate =
						"SELECT ACC_old, NLS_old, KV, daos, ostc/100, nms, nls_new,
						        ostb/100, (ostb+ostf)/100, NBS_NEW, TIP, ACC_NEW
						 INTO :TB.ACC_OLD, :TB.NLS_OLD, :TB.KV, :TB.DAOS, :TB.OSTC, :TB.NMS, :TB.NLS_NEW,
						      :TB.OSTB, :TB.OSTF, :TB.NBS_NEW, :TB.TIP, :TB.ACC_NEW
						 FROM new_psV
						 order by NLS_old, kv  "
				!
				Set TB.strSqlDelete =
						 "UPDATE accounts set dazs=:TB.bDat where acc=:TB.ACC_OLD and ostc=0 and ostb=0 and ostf=0 "
				!
				Set TB.strSqlUpdate =
						"UPDATE new_PS1 set nls_new=:TB.NLS_NEW where acc_old=:TB.ACC_OLD"
				Set TB.strFilterTblName = 'NEW_PSV'
				Call SalTblSetLockedColumns( hWndForm, 7 )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			! On UM_Update
				                                                                                                                                                                                                                      Call SqlPrepare(hSql(), TB.strSqlDelete)
				                                                                                                                                                                                                                      Call SalTblDoUpdates(hWndForm, hSql(),  ROW_MarkDeleted)
				!
				                                                                                                                                                                                                                      Call SqlPrepare(hSql(), TB.strSqlUpdate)
				                                                                                                                                                                                                                      Call SalTblDoUpdates (hWndForm, hSql(), TRUE)
				!
				                                                                                                                                                                                                                      Call SqlCommit(hSql())
				                                                                                                                                                                                                                      Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				                                                                                                                                                                                                                      Call SalWaitCursor(FALSE)
	Table Window: MOS1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Дополнительные реквизиты по ОДНОМУ КД
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.288"
				Top:    1.823"
				Width:  14.75"
				Width Editable? Class Default
				Height: 6.845"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.845"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29654
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  3.483"
						Begin Y:  0.655"
						End X:  3.55"
						End Y:  -0.012"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29655
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.883"
						Begin Y:  Class Default
						End X:  2.883"
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29656
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.283"
							Top:    0.071"
							Width:  0.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Референс (системный №) КД' )
				Data Field: dCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.283"
							Top:    0.321"
							Width:  4.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Идентификатор(пользовательский №) КД' )
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.283"
							Top:    0.571"
							Width:  4.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование заемщика ' )
				Data Field: d0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.483"
							Top:    0.071"
							Width:  5.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: White
						Input Mask: Unformatted
					Message Actions
				Data Field: d1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.483"
							Top:    0.321"
							Width:  5.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
				Data Field: d2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.483"
							Top:    0.571"
							Width:  5.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Orchid
						Input Mask: Unformatted
					Message Actions
				! Pushbutton: pb_Null
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.267"
						Top:    0.095"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: Esc
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
.end
					                                                                                                                                                                                                       Message Actions
				! Background Text: 0. Выбор одного "Значения"
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.345"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: White
.end
				! Background Text: 1. Выбор "Расшифровки" с наращ. и редактированием
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.548"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
.end
				! Background Text: 2. Выбор "Значения" с наращ. и редактированием
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.75"
						Width:  5.1"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Orchid
.end
		Contents
			Column: TAG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						ДОП.РЕКВ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: VALUE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Его Код-значение  по договору
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 250
				Data Type: String
				Justify: Left
				Width:  5.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set hWndForm.MOS1.sTmpR = hWndForm.MOS1.VALUE
					On SAM_AnyEdit
						If hWndForm.MOS1.PRZ = 1 or hWndForm.MOS1.PRZ = 2
							Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(  hWndForm  ),
									IifN( hWndForm.MOS1.YN = STRING_Null, ROW_New, ROW_Edited ),  TRUE )
						Else
							Set hWndForm.MOS1.VALUE = hWndForm.MOS1.sTmpR
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Call SalSetFocus( hWndForm.MOS1.pbDetails )
			!
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Его Расшифровка
				Visible? Yes
				Editable? No
				Maximum Data Length: 110
				Data Type: String
				Justify: Left
				Width:  7.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: YN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: YN
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  6.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						ред
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: ND
			String: CC_ID
			String: NMK
			String: sPar1
		Window Variables
			String: sTmp
			String: sTmpR
			String: sNEW
			!
			Number: nGol
			Number: nRoz
			Number: nZel
			Number: nCust
		Message Actions
			On SAM_Create
				Set hWndForm.MOS1.dND    = hWndForm.MOS1.ND
				Set hWndForm.MOS1.dCC_ID = hWndForm.MOS1.CC_ID
				Set hWndForm.MOS1.dNMK   = hWndForm.MOS1.NMK
				If SqlPrepareAndExecute( hSql(),
						"Select decode(vidd,1,2, 2,2, 3,2, 3) into :nCust 
						 from cc_deal where nd=:hWndForm.MOS1.dND " ) 
						and SqlFetchNext( hSql(), nFetchRes ) 
				!
				! Set hWndForm.MOS1.nGol = SalColorFromRGB( 220,255,255 ) ! голубой
				Set hWndForm.MOS1.nGol = COLOR_White ! белый
				Set hWndForm.MOS1.nZel = SalColorFromRGB( 230,255,230 ) ! бледнозеленый
				Set hWndForm.MOS1.nRoz = SalColorFromRGB( 255,240,255 ) ! розовый
				!
				Call SalColorSet( hWndForm.MOS1.d0, COLOR_IndexWindow, hWndForm.MOS1.nGol )
				Set hWndForm.MOS1.d0 = '0. Выбор одного "Значения" '
				Call SalColorSet( hWndForm.MOS1.d1, COLOR_IndexWindow, hWndForm.MOS1.nZel )
				Set hWndForm.MOS1.d1 = '1. Выбор "Расшифровки" с наращ. и редактированием '
				Call SalColorSet( hWndForm.MOS1.d2, COLOR_IndexWindow, hWndForm.MOS1.nRoz )
				Set hWndForm.MOS1.d2 = '2. Выбор "Значения" с наращ. и редактированием '
				If sPar1='ReadOnly'
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
				Call SalDisableWindow( hWndForm.MOS1.d0 )
				Call SalDisableWindow( hWndForm.MOS1.d1 )
				Call SalDisableWindow( hWndForm.MOS1.d2 )
				!
				Set hWndForm.MOS1.strSqlPopulate =
						"SELECT NVL(t.prz,0), t.tag, t.name, o.value, o.TAG
						 INTO :hWndForm.MOS1.PRZ, :hWndForm.MOS1.TAG, :hWndForm.MOS1.NAME,
						      :hWndForm.MOS1.VALUE, :hWndForm.MOS1.YN
						 FROM  MOS_TAG t,MOS_OPERW o
						 WHERE ( t.custtype="||Str(nCust) || " 
						  OR nvl(t.custtype,0) not in (2,3) 
						       )  AND 
						   NVL(t.prz,0) < 9 and
						       t.TAG = o.TAG (+) and o.nd (+) = " || Str(hWndForm.MOS1.ND) || "
						 ORDER BY t.name "
				!
				Set hWndForm.MOS1.strSqlDelete =
						   "DELETE from MOS_OPERW where nd=:hWndForm.MOS1.ND and tag=:hWndForm.MOS1.TAG "
				Set hWndForm.MOS1.strSqlUpdate =
						   "UPDATE MOS_OPERW set VALUE=:hWndForm.MOS1.VALUE
						    where nd=:hWndForm.MOS1.ND and tag=:hWndForm.MOS1.TAG "
				Set hWndForm.MOS1.strSqlInsert =
						   "INSERT into MOS_OPERW (nd,tag,value) values (:hWndForm.MOS1.ND,:hWndForm.MOS1.TAG,:hWndForm.MOS1.VALUE) "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If SqlPrepareAndExecute( hSqlAux2(),
						 "SELECT 1 FROM meta_tables WHERE tabname=:hWndForm.MOS1.TAG " )
						and SqlFetchNext( hSqlAux2(), nFetchRes ) 
					If SqlPrepareAndExecute( hSqlAux2(),
							 "SELECT txt into :hWndForm.MOS1.TXT FROM "|| hWndForm.MOS1.TAG ||"
							  WHERE KOD=:hWndForm.MOS1.VALUE " )
							and SqlFetchNext( hSqlAux2(), nFetchRes )
				! Set hWndForm.MOS1.YN = hWndForm.MOS1.VALUE
				If hWndForm.MOS1.PRZ = 0
					Call XSalTblSetRowBackColor( hWndForm, lParam, hWndForm.MOS1.nGol  )
				If hWndForm.MOS1.PRZ = 1
					Call XSalTblSetRowBackColor( hWndForm, lParam, hWndForm.MOS1.nZel )
				If hWndForm.MOS1.PRZ = 2
					Call XSalTblSetRowBackColor( hWndForm, lParam, hWndForm.MOS1.nRoz  )
			On SAM_DoubleClick
				Set hWndForm.MOS1.sTmp = hWndForm.MOS1.VALUE
				Call FunNSIGet(hWndForm.MOS1.TAG,'TXT', hWndForm.MOS1.sTmp, hWndForm.MOS1.TXT )
				If hWndForm.MOS1.PRZ = 1 or hWndForm.MOS1.PRZ = 2
					If hWndForm.MOS1.sTmp != STRING_Null
						Set hWndForm.MOS1.VALUE =
								 hWndForm.MOS1.VALUE ||
								 IifS(hWndForm.MOS1.VALUE !=STRING_Null, ';', '' ) ||
								 IifS( hWndForm.MOS1.PRZ = 1, hWndForm.MOS1.TXT,  hWndForm.MOS1.sTmp )
				Else
					If hWndForm.MOS1.sTmp != hWndForm.MOS1.VALUE
						Set hWndForm.MOS1.VALUE = hWndForm.MOS1.sTmp
				Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(  hWndForm  ),
						IifN( hWndForm.MOS1.YN = STRING_Null, ROW_New, ROW_Edited ),  TRUE )
	Table Window: MOS
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Дополнительные реквизиты кредитных договоров
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  16.45"
				Width Editable? Class Default
				Height: 8.0"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29657
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29658
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29659
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата нач
				Visible? Yes
				Editable? No
				Maximum Data Length: 10
				Data Type: Date/Time
				Justify: Center
				Width:  1.117"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата заверш
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.133"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № договора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег № кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						 доп.рекв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nPar1
			Number: nPar2
		Window Variables
		Message Actions
			On SAM_Create
				Set MOS.fFilterAtStart = TRUE
				!
				Set MOS.strFilterTblName = 'CC_V'
				Set MOS.strSqlPopulate =
						"SELECT cc_v.ND, cc_v.ABDATE, cc_v.DWDATE, cc_v.CC_ID, cc_v.RNK, cc_v.NAMK,
						      NVL(count( NVL(k.VALUE,'-') ),0)
						 INTO :MOS.ND, :MOS.DAT1, :MOS.DAT4, :MOS.CC_ID, :MOS.RNK, :MOS.NMK, :MOS.KOL
						 FROM  cc_v, MOS_OPERW k
						 WHERE cc_v.nd=k.nd (+)
						 GROUP BY cc_v.ND, cc_v.ABDATE, cc_v.DWDATE, cc_v.CC_ID, cc_v.RNK, cc_v.NAMK
						 ORDER BY cc_v.ND  "
				!
				! Set TB.strSqlDelete =
						 "UPDATE accounts set dazs=:TB.bDat where acc=:TB.ACC_OLD and ostc=0 and ostb=0 and ostf=0 "
				!
				! Set TB.strSqlUpdate =
						"UPDATE new_PS1 set nls_new=:TB.NLS_NEW where acc_old=:TB.ACC_OLD"
				! Call SalTblSetLockedColumns( hWndForm, 7 )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_DoubleClick
				If ND >0
					Call DOP_MOS (ND, CC_ID, NMK, 'All')
	Dialog Box: Dlg_EX
		Class:
		Property Template:
		Class DLL Name:
		Title: Формирование и выгрузка в Excel отчета для МОСКВЫ
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  10.6"
				Width Editable? Yes
				Height: 4.119"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: В таблице MOS2 
				Resource Id: 16613
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.583"
					Top:    0.095"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.983"
						Top:    0.071"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
					Input Mask: Unformatted
				Message Actions
			Background Text: записей
				Resource Id: 16614
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.983"
					Top:    0.095"
					Width:  1.167"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			!
			Background Text: Сформировать за период
				Resource Id: 29660
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.488"
					Width:  7.8"
					Width Editable? Yes
					Height: 0.274"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.083"
						Top:    0.905"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: <-->
				Resource Id: 29661
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.483"
					Top:    0.929"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: DAT2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.483"
						Top:    0.905"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			!
			Pushbutton: pb_77
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbDetail
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.683"
					Top:    0.905"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\DOC_TURN.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 
								'77) Подготовить массив документов за отчетный период (1 раз на отч.период) '
					On SAM_Click
						Call P_MOS2( -77, strTip )
			Pushbutton: pb_MOS_Del !! Очистит
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbExecute
				Property Template:
				Class DLL Name:
				Title: Очистить
				Window Location and Size
					Left:   0.083"
					Top:    1.571"
					Width:  1.0"
					Width Editable? Class Default
					Height: 1.583"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\DELETE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set sTmp = "99) P_MOS2 - Очистить"
						Call P_MOS2( -99, sTmp )
			Pushbutton: pb_MOS_Ul
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbExecute
				Property Template:
				Class DLL Name:
				Title: 1) + ЮЛ
				Window Location and Size
					Left:   1.083"
					Top:    1.655"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.452"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Custcorp.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set sTmp = "1) P_MOS2 + КП ЮЛ"
						Call P_MOS2( -1, sTmp )
			Pushbutton: pb_MOS_Ovr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbExecute
				Property Template:
				Class DLL Name:
				Title: 8) + ОВР
				Window Location and Size
					Left:   2.283"
					Top:    1.655"
					Width:  1.2"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set sTmp = "8) P_MOS2 + КП ОВР"
						Call P_MOS2( -8, sTmp )
			Pushbutton: pb_MOS_Gar
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbExecute
				Property Template:
				Class DLL Name:
				Title: 9) + Гарант
				Window Location and Size
					Left:   3.483"
					Top:    1.655"
					Width:  1.2"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\PACH.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set sTmp = "9) P_MOS2 + Гарантии(без 9023)"
						Call P_MOS2( -9, sTmp )
			Pushbutton: pb_MOS_Fl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbExecute
				Property Template:
				Class DLL Name:
				Title: 11) + ФЛ
				Window Location and Size
					Left:   4.683"
					Top:    1.655"
					Width:  1.2"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Custpers.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set sTmp = "11) P_MOS2 + КП ФЛ"
						Call P_MOS2( -11, sTmp )
			Pushbutton: pb_MOS_9023
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbExecute
				Property Template:
				Class DLL Name:
				Title: 19) + Вексель
				Window Location and Size
					Left:   5.883"
					Top:    1.655"
					Width:  1.2"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: C:\bars98\RESOURCE\BMP\DOC.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set sTmp = "19) P_MOS2 + Вексель(9023)"
						Call P_MOS2( -19, sTmp )
			Pushbutton: pb_MOS_Bez_FL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbExecute
				Property Template:
				Class DLL Name:
				Title: 20) +ЮЛ(1) +ОВР(8) +Гарант(9)  -ФЛ(11)  -Вексель(19)
				Window Location and Size
					Left:   1.083"
					Top:    2.155"
					Width:  4.8"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\SORT.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Sky
				Message Actions
					On SAM_Click
						Set sTmp = "P_MOS2 : + ЮЛ + ОВР + Гарантии  ( - ФЛ - Аваль)" 
						Call P_MOS2( -20, sTmp )
			Pushbutton: pb_MOS_All
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbExecute
				Property Template:
				Class DLL Name:
				Title: + 10) Все
				Window Location and Size
					Left:   5.883"
					Top:    2.155"
					Width:  1.2"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\SORT.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Cyan
				Message Actions
					On SAM_Click
						Set sTmp = "P_MOS2 : ЮЛ + ОВР + Гарантии + ФЛ"
						Call P_MOS2( -10, sTmp )
			!
			Pushbutton: pb_Imp_Dbf
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbExecute
				Property Template:
				Class DLL Name:
				Title: Добавть файл G<ffffff><M>.DBF филиала
				Window Location and Size
					Left:   1.083"
					Top:    2.655"
					Width:  6.0"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\NEWREC.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Maize
				Message Actions
					On SAM_Click
						! Set sTmp = Subs(Sep98md(DAT2),1,1)
						Call Imp_Dbf_Ret(hWndForm, sFile_Dbf )
						If SqlPrepareAndExecute( hSql(), 
								"INSERT into MOS2 select * FROM " || Subs( sFile_Dbf , 1, SalStrLength( sFile_Dbf ) - 4 ) )
								and SqlPLSQLCommand( hSql(), "P_MOS2( -88, '', DAT1 ,DAT2 ) ")
							Set sTmp = "Добавлена информация в таблицу MOS2 из файла "||sFile_Dbf
							Call SqlCommitEx( hSql(),sTmp )
							Call MessageNoWait( sTmp,'Сообщение',0.1,0)
							Call F_Kol()
						! Call Debug (sFile_Dbf)
			Background Text: С   №
				Resource Id: 16615
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.183"
					Top:    1.679"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: NPP1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.983"
						Top:    1.655"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
					Input Mask: Unformatted
				Message Actions
			Data Field: NPP2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.983"
						Top:    2.238"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
					Input Mask: Unformatted
				Message Actions
			Background Text: По   №
				Resource Id: 16616
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.183"
					Top:    2.262"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pb_MOS_Ex
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbExecute
				Property Template:
				Class DLL Name:
				Title: Выгрузить
				Window Location and Size
					Left:   7.783"
					Top:    2.655"
					Width:  Class Default
					Width Editable? Class Default
					Height: 0.417"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If F_NPP()
							Set sPar =
									SqlDatabase  || ' ' ||
									SqlUser      || ' ' ||
									SqlPassword  || ' ' ||
									Str(KODZ)    || ' ' ||
									SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy') || ' ' ||
									SalFmtFormatDateTime( DAT2, 'dd/MM/yyyy') || ' ' ||
									GetPrnDir(  )|| ' ' ||
									Str(NPP1)    || ' ' ||
									Str(NPP2)    || ' "" "" '
							Call SalLoadApp ( 'PK_XLS.EXE', sPar )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Выход
				Window Location and Size
					Left:   8.983"
					Top:    1.571"
					Width:  1.0"
					Width Editable? Yes
					Height: 1.583"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
			Data Field: NAM_KATZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.283"
						Top:    3.238"
						Width:  8.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: KODZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.083"
						Top:    3.238"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
		Functions
			Function: P_MOS2
				Description:
				Returns
				Parameters
					Number: MOD_
					String: sTxt
				Static Variables
				Local variables
				Actions
					If SalMessageBox(sTxt,'Внимание, вопрос ! ', MB_IconQuestion | MB_YesNo) = IDYES
						Call SalWaitCursor( TRUE )
						If SqlPLSQLCommand( hSql(), "P_MOS2( MOD_, '', DAT1 ,DAT2 ) ")
								and SqlCommitEx( hSql(), sTmp )
							Call F_Kol()
						Else
							Call SqlRollbackEx( hSql(), sTmp )
						Call SalWaitCursor( FALSE )
			Function: F_Kol
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(), 
							"SELECT count(*) into :NPP from mos2 where npp is not null" )
							and SqlFetchNext(hSql(), nFetchRes)
						Set NPP1 = 1
						If NPP >0 
							Set NPP1 = 1
							Set NPP2 = NPP
						Else
							Set NPP1 = 0
							Set NPP2 = 0
			Function: F_NPP
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If NPP = 0
							OR NPP1 = NUMBER_Null OR NPP1 < 1 OR NPP1 > NPP
							OR NPP2 = NUMBER_Null OR NPP2 < 1 OR NPP2 > NPP
							OR NPP1 > NPP2
						Call SalMessageBox( 'Ошибка в №  "С ... По" ', 'В Н И М А Н И Е  !', 0)
						Return FALSE
					Return TRUE
			Function: F_ERR
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: ND_BEG 
					String: ND_KOL 
					String: ND_MOD 
					String: ND_END 
					String: sTmp
					String: sTag
				Actions
					Set ND_BEG = '0'
					Set ND_KOL = '0' 
					Set ND_MOD ='-3333'
					Set ND_END ='YES' 
					If SqlPrepareAndExecute( hSql(), "select tag,value into :sTag,:sVal from mos_point")
						While SqlFetchNext(hSql(), nFetchRes)
							If sTag = 'ND_BEG' 
								Set ND_BEG = sVal
							Else If sTag = 'ND_KOL' 
								Set ND_KOL = sVal
							Else If sTag = 'ND_MOD' 
								Set ND_MOD = sVal
							Else If sTag = 'ND_END' 
								Set ND_END = sVal
						If ND_END != 'YES' 
							Call SalMessageBox( '
									Предыдущие формирования отчета в режиме '||ND_MOD||' 
									добавили и сохранили '||ND_KOL||' записей, 
									но закончились АВАРИЙНО ! 
									Рекомендуем пролоджить формирования отчета в режиме '||ND_MOD
									, 'В Н И М А Н И Е  !', 0)
					Return TRUE
		Window Parameters
			Number: nPar1
			Number: nPar2
		Window Variables
			String: sPar
			String: sTmp
			String: sFile_Dbf
		Message Actions
			On SAM_Create
				If SqlPrepareAndExecute( hSql(),
						  "SELECT z.kodz, z.name  INTO :KODZ, :NAM_KATZ
						   from params p, zapros z
						   where p.par='CC_KODZ' and to_number(p.val)=z.KODZ " )
						 and not SqlFetchNext(hSql(), nFetchRes)
					Call SalHideWindow( pb_MOS_Ex )
					Call MessageError
							( 'Не задан в глобальный параметр "PARAMS.CC_KODZ" ! ')
					Call SalEndDialog(hWndForm, 0)
				Call F_Kol()
			On SAM_CreateComplete
				Call F_ERR()
	Table Window: FIN_L
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.375"
				Top:    1.719"
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29662
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.05"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.55"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29663
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.017"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29664
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dTXT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.483"
							Top:    0.071"
							Width:  11.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: NOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
						
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стаття
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KODL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код рядка,
						що
						порівнюється
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						та його
						значення
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.167"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KODR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Коди рядків,
						з якими
						порівнюються
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						та їх сумарне
						значення
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.383"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DEL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 
						Відхилення
						
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.383"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: fIns
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set FIN_L.nRow = SalTblInsertRow( FIN_L, TBL_MaxRow )
					Call SalTblSetContext ( FIN_L, FIN_L.nRow )
					Call SalTblSetRowFlags( FIN_L, FIN_L.nRow, ROW_New, FALSE )
			Function: fCol
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nPP = nPP + 1
					Set NOM = nPP
					If SL != SR
						Call XSalTblSetCellBackColor( SL, SalColorFromRGB( 220,255,255 ) )
						Call XSalTblSetCellBackColor( SR, SalColorFromRGB( 230,255,230 ) )
						Call XSalTblSetCellBackColor( DEL,SalColorFromRGB( 255,210,255 ) )
						Set nER = nER + 1
						Set DEL = SL - SR
		Window Parameters
			Date/Time: DAT
			Number: OKPO
			String: sRezerv
			Number: nForm
			String: sForm
		Window Variables
			! Number: nL
			! Number: nR
			String: FZ
			Number: nRow
			Number: nPP
			Number: nER
		Message Actions
			On SAM_Create
				Set dTXT = 'Перехресний(ариф) контроль.'|| sForm || ' на ' ||SalFmtFormatDateTime(DAT,'dd/MM/yyyy' )
				Call SalSetWindowText( FIN_L, dTXT  )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 4 )
				Set strPrintFileName = 'L' ||Str(OKPO)
				Set nTabInstance = 1
				If SqlPrepareAndExecute( hSqlAux2(),
						 "select substr(fin_2.F_FM(to_number(:OKPO),:DAT),1,1) into :FZ from dual")
						and SqlFetchNext( hSqlAux2(), nFetchRes )
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				! Call DebugN(FIN_L.nForm)
				Call SalWaitCursor(TRUE)
				Set nPP = 0
				Set nER = 0
				If nForm = 1
					! 0
					Call fIns()
					Set NAME = '  залишкова вартiсть'
					Set KODL = '030'
					Set KODR = '031-032' 
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'030',S,0)), SUM(decode(KOD,'030',0, decode(KOD,'031',1,-1)*S) )
							 Into :SL, :SR from fin_rnk
							 where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('030','031','032')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 1
					Call fIns()
					Set NAME = 'Активи. Всього по розділу 1'
					Set KODL = '080'
					Set KODR = '010+020+030+040+045+050+060+065+070'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'080',S,0)), SUM(decode(KOD,'080',0,S))
							 Into :SL, :SR from fin_rnk
							 where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
							 kod in ('080','010','020','030','040','045','050','060','065','070')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 2
					Call fIns()
					Set NAME = 'Активи. Всього по розділу 2'
					Set KODL = '260'
					Set KODR = '100+110+120+130+140+150+160+170+180+190+200+210+220+230+240+250'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'260',S,0)), SUM(decode(KOD,'260',0,S))
							 Into :SL,:SR from fin_rnk
							 where OKPO=:FIN_L.OKPO and FDAT=:FIN_L.DAT and idf=:FIN_L.nForm and
							 kod in ('260','100','110','120','130','140','150','160','170',
							         '180','190','200','210','220','230','240','250')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 3
					Call fIns()
					Set FIN_L.NAME = 'Баланс'
					Set FIN_L.KODL = '280'
					Set FIN_L.KODR = '080+260+270'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'280',S,0)), SUM(decode(KOD,'280',0,S))
							 Into :FIN_L.SL,:FIN_L.SR  from fin_rnk
							 where OKPO=:FIN_L.OKPO and FDAT=:FIN_L.DAT and idf=:FIN_L.nForm and
							 kod in ('280', '080','260','270')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 4
					Call fIns()
					Set FIN_L.NAME = 'Пасиви. Всього по розділу 1'
					Set FIN_L.KODL = '380'
					Set FIN_L.KODR = '300+310+320+330+340+(-)350+(-360)+(-370)'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'380',S,0)), SUM(decode(KOD,'380',0,S))
							 Into :FIN_L.SL,:FIN_L.SR  from fin_rnk
							 where OKPO=:FIN_L.OKPO and FDAT=:FIN_L.DAT and idf=:FIN_L.nForm and
							 kod in ('380','300','310','320','330','340','350','360','370')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 5
					If FZ !='M'
						Call fIns()
						Set FIN_L.NAME = 'Пасиви. Всього по розділу 2'
						Set FIN_L.KODL = '430'
						Set FIN_L.KODR = '400+410+420'
						If SqlPrepareAndExecute( hSql(),
								"select SUM(decode(KOD,'430',S,0)), SUM(decode(KOD,'430',0,S))
								 Into :FIN_L.SL,:FIN_L.SR  from fin_rnk
								 where OKPO=:FIN_L.OKPO and FDAT=:FIN_L.DAT and idf=:FIN_L.nForm and
								 kod in ('430','400','410','420')" )
								and SqlFetchNext( hSql(), nFetchRes )
							Call fCol()
					! 6
					If FZ !='M'
						Call fIns()
						Set FIN_L.NAME = 'Пасиви. Всього по розділу 3'
						Set FIN_L.KODL = '480'
						Set FIN_L.KODR = '440+450+460+470'
						If SqlPrepareAndExecute( hSql(),
								"select SUM(decode(KOD,'480',S,0)), SUM(decode(KOD,'480',0,S))
								 Into :FIN_L.SL,:FIN_L.SR  from fin_rnk
								 where OKPO=:FIN_L.OKPO and FDAT=:FIN_L.DAT and idf=:FIN_L.nForm and
								 kod in ('480','440','450','460','470')" )
								and SqlFetchNext( hSql(), nFetchRes )
							Call fCol()
					! 7
					Call fIns()
					Set FIN_L.NAME = 'Пасиви. Всього по розділу 4'
					Set FIN_L.KODL = '620'
					Set FIN_L.KODR = '500+510+520+530+540+550+560+570+580+590+600+610'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'620',S,0)), SUM(decode(KOD,'620',0,S))
							 Into :FIN_L.SL,:FIN_L.SR  from fin_rnk
							 where OKPO=:FIN_L.OKPO and FDAT=:FIN_L.DAT and idf=:FIN_L.nForm and
							 kod in ('620','500','510','520','530','540','550',
							         '560','570','580','590','600','610')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 8
					Call fIns()
					Set FIN_L.NAME = 'Баланс'
					Set FIN_L.KODL = '640'
					Set FIN_L.KODR = '380+430+480+620+630'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'640',S,0)), SUM(decode(KOD,'640',0,S))
							 Into :FIN_L.SL,:FIN_L.SR  from fin_rnk
							 where OKPO=:FIN_L.OKPO and FDAT=:FIN_L.DAT and idf=:FIN_L.nForm and
							 kod in ('640','380','430','480','620','630')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
				Else If nForm = 2 and FZ ='M'
					Call fIns()
					Set NAME = 'Чистий дохiд (виручка) вiд реалiзацiї продукцiї'
					Set KODL = '030'
					Set KODR = '010-020'
					If SqlPrepareAndExecute( hSql(),
							"select SUM( decode(KOD,'030',S,0)),
							        SUM( decode(KOD,'030',0, Decode(KOD,'020',-1,1)*S) )
							 Into :SL,:SR from fin_rnk
							 where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and kod in ('030','010','020')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 2
					Call fIns()
					Set NAME = 'Разом чистi доходи '
					Set KODL = '070'
					Set KODR = '030+040+050+060'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'070',S,0)), SUM(decode(KOD,'070',0,S))
							 Into :SL,:SR from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
							 kod in ('070','030','040','050','060')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 3
					Call fIns()
					Set NAME = 'Разом витрати'
					Set KODL = '180'
					Set KODR = '090+100+110+120+130+140+150+080+160+170'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'180',S,0)), SUM(decode(KOD,'180',0,S))
							 Into :SL,:SR from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
							 kod in ('180','090','100','110','120','130','140','150','080','160','170' )" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
				Else If nForm = 2 and FZ !='M'
					Call fIns()
					Set NAME = 'Чистий дохiд (виручка) вiд реалiзацiї продукцiї'
					Set KODL = '035'
					Set KODR = '010–015–020–030'
					If SqlPrepareAndExecute( hSql(),
							"select SUM( decode(KOD,'035',S,0)),
							        SUM( decode(KOD,'035',0, Decode(KOD,'010',1,-1)*S) )
							 Into :SL,:SR from fin_rnk
							 where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and kod in
							('035',
							 '010','015','020','030')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 2
					Call fIns()
					Set NAME = 'Валовий прибуток'
					Set KODL = '050'
					Set KODR = '035–040+055'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'050',S,0)),
							        SUM(decode(KOD,'050',0,decode(KOD,'040',-1,1)*S))
							 Into :SL,:SR from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
							 kod in ('050',
							         '035','040','055')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 3
					Call fIns()
					Set NAME = 'Вiд операц.дiяльностi прибуток'
					Set KODL = '100'
					Set KODR = '050-055+060–070–080–090+105'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'100',S,0)),
							SUM(decode(KOD,'100',0,decode(kod,'050',1,'060',1,'105',1,-1)*S))
							 Into :SL,:SR from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
							 kod in ('100',
							         '050','055','060','070','080','090','105')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 4
					Call fIns()
					Set NAME = 'Від звич.дiяльностi прибуток до оподат.:'
					Set KODL = '170'
					Set KODR = '100-105+110+120+130–140–150–160+175'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'170',S,0)),
							SUM(decode(KOD,'170',0,decode(kod,'100',1,'110',1,'120',1,'130',1,'175',1,-1)*S))
							 Into :SL,:SR from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
							 kod in ('170',
							         '100','105','110','120','130','140','150','160','175' )" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 5
					Call fIns()
					Set NAME = 'Від звич.дiяльностi прибуток'
					Set KODL = '190'
					Set KODR = '170-175–180+195'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'190',S,0)),
							   SUM(decode(KOD,'190',0,decode(kod,'170',1,'195',1,-1)*S))
							 Into :SL,:SR from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
							 kod in ('190',
							         '170','175','180','195')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
					! 6
					Call fIns()
					Set NAME = 'Чистий прибуток'
					Set KODL = '220'
					Set KODR = '190-195+200–205-210+225'
					If SqlPrepareAndExecute( hSql(),
							"select SUM(decode(KOD,'220',S,0)),
							   SUM(decode(KOD,'220',0,decode(kod,'190',1,'200',1,'225',1,-1)*S))
							 Into :SL,:SR from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
							 kod in ('220',
							         '190','195','200','205','210','225')" )
							and SqlFetchNext( hSql(), nFetchRes )
						Call fCol()
				Call SalWaitCursor(FALSE)
	Table Window: FINS_main
		Class:
		Property Template:
		Class DLL Name:
		Title: Оценка финансового состояния контрагента по методике SEB
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Maximized
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.65"
				Top:    1.0"
				Width:  14.65"
				Width Editable? Yes
				Height: 7.226"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: 1
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? Yes
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 2.714"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Data Field: Okpo
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.783"
							Top:    0.071"
							Width:  1.683"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_KillFocus
							Call SqlPrepareAndExecute( cMain.hSql(),  "SELECT size_id, nmk FROM fins_cust INTO :tek_size, :Nmk WHERE okpo='"||Okpo||"'")
							If NOT SqlFetchNext(cMain.hSql(),nFetchRes)
								Set Nmk=''
								Call cmbSize.SetSelectById(0)
							Else
								Call cmbSize.SetSelectById(tek_size)
							! добавить вычитку наименования из базы, если он там есть
							Call SqlPrepareAndExecute( cMain.hSql(),  "SELECT nmk FROM customer INTO :Nmk WHERE okpo='"||Okpo||"'")
							Call SqlFetchNext(cMain.hSql(),nFetchRes)
							If pMode=2
								Call cmbDate.Populate(hSql(), 'data', "to_char(data, 'DD.MM.YYYY')", 'fins_hist', "WHERE okpo='"||Okpo||"' ORDER BY data")
				Background Text: ОКПО контрагента
					Resource Id: 44176
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   -0.017"
						Top:    0.095"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Background Text: Размер
					Resource Id: 44177
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.817"
						Top:    0.131"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: Nmk
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.783"
							Top:    0.321"
							Width:  5.583"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Наименование
					Resource Id: 44178
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.083"
						Top:    0.345"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.226"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Combo Box: cmbSize
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   4.683"
						Top:    0.071"
						Width:  2.683"
						Width Editable? Class Default
						Height: 1.19"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							If cmbSize.Init( hWndItem )
								Call cmbSize.Populate( hSql(), 'size_id', 'size_name', 'fins_size', 'ORDER BY size_id' )
						On SAM_FieldEdit
							Set tek_size = cmbSize.GetCurrentKey()
				Pushbutton: pbLoad
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.483"
						Top:    0.131"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( FINS_main, UM_Populate, 0, 0 )
						On SAM_Create
							Set strTip = "Загрузить текущую форму"
				Pushbutton: pbSaveTemp
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.083"
						Top:    0.131"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							! сохраним параметры самого пользователя
							If SalIsNull(Nmk)
								Set str1="NULL"
							Else
								Set str1="'"||Nmk||"'"
							Set str2=NumberToStr(tek_size)
							Call SqlPrepareAndExecute( cMain.hSql(), "begin Fins.UpdateCust('"||Okpo||"', "||str2||", "||str1||"); end;")
							!
							! сохраним измененные ответы с комментами	 (удаленных нет)
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( FINS_main, nRow, ROW_Edited, 0)
								Call SalTblSetContext( FINS_main, nRow )
								If SalIsNull(cRisk)
									Set str1 = "NULL"
								Else
									Set str1 = NumberToStr(cRisk)
								If SalIsNull(cComm)
									Set str2 = "NULL"
								Else
									Set str2 = "'"||cComm||"'"
								Call SqlPrepareAndExecute( cMain.hSql(), "begin Fins.Save_CustAns('"||Okpo||"', "||NumberToStr(cKod)||", "||str1||", "||str2||"); end;" )
							!
							! удалим ВСЕ аналоги, внеш.рейтинги и скоринги (за текущую дату), а потом добавим все, кроме отмеченных в таблицах как удаленные
							! за каждую дату (за которую проводилось сохранение) хранится полный набор всего, что должно быть, т.е. при офиц. сохранении берется все за 1 дату
							Call SqlPrepareAndExecute(hSql(), "delete from fins_tag_temp where okpo='"||Okpo||"' and data=gl.bd")
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( tblAnalog, nRow, 0, ROW_MarkDeleted)
								Call SalTblSetContext( tblAnalog, nRow )
								Call SqlPrepareAndExecute( cMain.hSql(), "begin Fins.Save_CustTag('"||Okpo||"', 'a', "||NumberToStr(tblAnalog.cAId)||", 0); end;" )
							!
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( tblOutrate, nRow, 0, ROW_MarkDeleted)
								Call SalTblSetContext( tblOutrate, nRow )
								Call SqlPrepareAndExecute( cMain.hSql(), "begin Fins.Save_CustTag('"||Okpo||"', 'r', "||NumberToStr(tblOutrate.cRId)||", 0); end;" )
							!
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( tblScoring, nRow, 0, ROW_MarkDeleted)
								Call SalTblSetContext( tblScoring, nRow )
								Call SqlPrepareAndExecute( cMain.hSql(), "begin Fins.Save_CustTag('"||Okpo||"', 's', "||NumberToStr(tblScoring.cSId)||", 0); end;" )
							!
							! для полного счастья сохраним большой коммент
							Call SalGetWindowText(mlComment, str1, 500)
							If SalIsNull(mlComment)
								Set str1="NULL"
							Else
								Call SalGetWindowText(mlComment, str1, 500)
								Set str1="'"||str1||"'"
							Call SqlPrepareAndExecute( cMain.hSql(), "begin Fins.Save_BigComm('"||Okpo||"', "||str1||"); end;")
							!
							! и обновляем
							Call SalSendMsg( FINS_main, UM_Populate, 0, 0 )
						On SAM_Create
							Set strTip = "Сохранить как рабочую информацию"
				Pushbutton: pbSaveOfficial
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.683"
						Top:    0.131"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							! чисто на всякий случай можем сохранить все "временно" еще раз
							Call SalSendMsg( pbSaveTemp, SAM_Click, 0, 0 )
							! официальное подтверждение введенного
							Call SqlPrepareAndExecute( cMain.hSql(), "begin Fins.Save_Official('"||Okpo||"'); end;" )
							! и обновляем (на случай, если до того они не сохранились)
							Call SalSendMsg( FINS_main, UM_Populate, 0, 0 )
						On SAM_Create
							Set strTip = "Сохранить как окончательное значение"
				Pushbutton: pbExplainAns
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.883"
						Top:    0.131"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							! вызов формы с объяснениями значений ответов
							Call SalTblQueryFocus( FINS_main, nRow, tCol )
							If not IsWindow(hFINS_expl)
								Set hFINS_expl = SalCreateWindow(FINS_expl, hFINS, tek_size, nRow+1)
							Else
								Call SalBringWindowToTop(hFINS_expl)
						On SAM_Create
							Set strTip = "Разъяснение вариантов ответа"
				Combo Box: cmbDate
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_DatId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   11.133"
						Top:    0.071"
						Width:  1.783"
						Width Editable? Class Default
						Height: 1.036"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							Call cmbDate.Init( hWndItem )
							If pMode<2
								Call cmbDate.Populate(hSql(), 'gl.bd', "to_char(gl.bd, 'DD.MM.YYYY')", 'dual', '')
								Call cmbDate.SetSelectById(cmbDate.GetKey(0))
						On SAM_KillFocus
							If pMode=2
								Call SqlPrepareAndExecute(cMain.hSql(), "SELECT fh.size_id, fh.nmk, s.fio FROM fins_hist fh, staff s INTO :tek_size, :Nmk, :User WHERE okpo='"||Okpo||"' and data=to_date('"|| cmbDate.GetName(SalListQuerySelection(cmbDate)) ||"','DD.MM.YYYY') 
										and s.id=fh.usid" )
								! Call SqlPrepareAndExecute(cMain.hSql(), "SELECT size_id, nmk, usid FROM fins_hist INTO :tek_size, :Nmk, :User WHERE okpo='"||Okpo||"' and data=to_date('"|| cmbDate.GetName(SalListQuerySelection(cmbDate)) ||"','DD.MM.YYYY')" )
								Call SqlFetchNext(cMain.hSql(), nFetchRes)
								Call cmbSize.SetSelectById(tek_size)
				Child Table: tblAnalog
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left:   0.517"
							Top:    1.321"
							Width:  13.567"
							Width Editable? Yes
							Height: 0.714"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						View: Table
						Allow Row Sizing? No
						Lines Per Row: Default
					Memory Settings
						Maximum Rows in Memory: Default
						Discardable? Yes
					Contents
						Column: cAId
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title:
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cAName
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cGenColComboBox_NumId
							Property Template:
							Class DLL Name:
							Title: Название компании
							Visible? Class Default
							Editable? Class Default
							Maximum Data Length: Class Default
							Data Type: Class Default
							Justify: Class Default
							Width:  2.95"
							Width Editable? Class Default
							Format: Unformatted
							Country: Class Default
							Input Mask: Class Default
							Cell Options
								Cell Type? Class Default
								Multiline Cell? Class Default
								Cell DropDownList
									Sorted? Class Default
									Vertical Scroll? Class Default
									Auto Drop Down? Class Default
									Allow Text Editing? Class Default
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Class Default
							List Values
							Message Actions
								On SAM_Click
									If tblAnalog.cAName.Init(hWndItem)
										Call tblAnalog.cAName.Populate( hSql(), 'id', 'name', 'fins_analog', "" )
								On SAM_AnyEdit
									Call SqlPrepareAndExecute(cMain.hSql(), "SELECT id, risk, profit, valmarg, ebitdam, clmarg, adequate, longact, shortact INTO :cAId, :cARisk, :cProfit, :cValmarg, :cEbitdam, :cClmarg, :cAdequate, :cLongact, :cShortact FROM fins_analog WHERE
											id=" ||NumberToStr(tblAnalog.cAName.GetKey(SalListQuerySelection(tblAnalog.cAName)) ))
									Call SqlFetchNext(cMain.hSql(),nFetchRes)
						Column: cARisk
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Класс риска
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cProfit
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Чистый доход
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  1.817"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cValmarg
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Валовая маржа
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  1.617"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cEbitdam
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: EBITDA маржа
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  1.617"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cClmarg
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Чистая маржа
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  1.617"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cAdequate
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Адекватность капитала
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  2.233"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cLongact
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Долгосрочные активы
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  2.167"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cShortact
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Краткосрочные активы
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  2.367"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
					Functions
					Window Variables
					Message Actions
						On SAM_Create
							Call SalTblSetTableFlags(tblAnalog, TBL_Flag_ShowVScroll, FALSE)
							Call SalTblDefineRowHeader(tblAnalog, "", 15, 9, hWndNULL)
				Pushbutton: pbAddAnalog
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.017"
						Top:    1.357"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nNewRow=SalTblInsertRow(tblAnalog,TBL_MaxRow)
						On SAM_Create
							Set strTip = "Добавить компанию-аналог"
				Pushbutton: pbDelAnalog
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDelete
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.017"
						Top:    1.69"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nRow=SalTblQueryContext(tblAnalog)
							Call SalTblSetRowFlags(tblAnalog, nRow, ROW_MarkDeleted, TRUE)
						On SAM_Create
							Set strTip = "Удалить компанию-аналог"
				Child Table: tblOutrate
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left:   1.017"
							Top:    2.107"
							Width:  5.5"
							Width Editable? Yes
							Height: 0.548"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						View: Table
						Allow Row Sizing? No
						Lines Per Row: Default
					Memory Settings
						Maximum Rows in Memory: Default
						Discardable? Yes
					Contents
						Column: cRId
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title:
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cAgency
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cGenColComboBox_StrId
							Property Template:
							Class DLL Name:
							Title: Рейтинговое агенство
							Visible? Class Default
							Editable? Class Default
							Maximum Data Length: Class Default
							Data Type: Class Default
							Justify: Class Default
							Width:  2.033"
							Width Editable? Class Default
							Format: Unformatted
							Country: Class Default
							Input Mask: Class Default
							Cell Options
								Cell Type? Class Default
								Multiline Cell? Class Default
								Cell DropDownList
									Sorted? Class Default
									Vertical Scroll? Class Default
									Auto Drop Down? Class Default
									Allow Text Editing? Class Default
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Class Default
							List Values
							Message Actions
								On SAM_Click
									If tblOutrate.cAgency.Init(hWndItem)
										Call tblOutrate.cAgency.Populate( hSql(), 'distinct agency', 'agency', 'fins_outrates', "" )
						Column: cRate
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cGenColComboBox_StrId
							Property Template:
							Class DLL Name:
							Title: Рейтинг
							Visible? Class Default
							Editable? Class Default
							Maximum Data Length: Class Default
							Data Type: Class Default
							Justify: Class Default
							Width:  1.1"
							Width Editable? Class Default
							Format: Unformatted
							Country: Default
							Input Mask: Class Default
							Cell Options
								Cell Type? Class Default
								Multiline Cell? Class Default
								Cell DropDownList
									Sorted? Class Default
									Vertical Scroll? Class Default
									Auto Drop Down? Class Default
									Allow Text Editing? Class Default
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Class Default
							List Values
							Message Actions
								On SAM_Click
									If tblOutrate.cRate.Init(hWndItem)
										Call tblOutrate.cRate.Populate( hSql(), 'rate', 'rate', 'fins_outrates', "WHERE agency='"||tblOutrate.cAgency.GetKey(SalListQuerySelection(tblOutrate.cAgency))||"'" )
								On SAM_AnyEdit
									Call SqlPrepareAndExecute(cMain.hSql(), "SELECT id, risk INTO :tblOutrate.cRId, :tblOutrate.cRRisk FROM fins_outrates WHERE agency='"||tblOutrate.cAgency.GetKey(SalListQuerySelection(tblOutrate.cAgency))||"' and
											rate='"||tblOutrate.cRate.GetKey(SalListQuerySelection(tblOutrate.cRate))||"'")
									Call SqlFetchNext(cMain.hSql(),nFetchRes)
						Column: cRRisk
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Эквивалент SEB
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  1.667"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
					Functions
					Window Variables
					Message Actions
						On SAM_Create
							Call SalTblSetTableFlags(tblOutrate, TBL_Flag_ShowVScroll, FALSE)
							Call SalTblDefineRowHeader(tblOutrate, "", 15, 9, hWndNULL)
				Pushbutton: pbAddOutrate
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.017"
						Top:    2.19"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nNewRow=SalTblInsertRow(tblOutrate,TBL_MaxRow)
						On SAM_Create
							Set strTip = "Добавить внешний рейтинг"
				Pushbutton: pbDelOutrate
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDelete
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.517"
						Top:    2.19"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nRow=SalTblQueryContext(tblOutrate)
							Call SalTblSetRowFlags(tblOutrate, nRow, ROW_MarkDeleted, TRUE)
						On SAM_Create
							Set strTip = "Удалить внешний рейтинг"
				Child Table: tblScoring
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left:   8.217"
							Top:    2.107"
							Width:  5.867"
							Width Editable? Yes
							Height: 0.548"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						View: Table
						Allow Row Sizing? No
						Lines Per Row: Default
					Memory Settings
						Maximum Rows in Memory: Default
						Discardable? Yes
					Contents
						Column: cSId
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title:
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cTool
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cGenColComboBox_StrId
							Property Template:
							Class DLL Name:
							Title: Скоринговый инструмент
							Visible? Class Default
							Editable? Class Default
							Maximum Data Length: Class Default
							Data Type: Class Default
							Justify: Class Default
							Width:  2.267"
							Width Editable? Class Default
							Format: Unformatted
							Country: Class Default
							Input Mask: Class Default
							Cell Options
								Cell Type? Class Default
								Multiline Cell? Class Default
								Cell DropDownList
									Sorted? Class Default
									Vertical Scroll? Class Default
									Auto Drop Down? Class Default
									Allow Text Editing? Class Default
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Class Default
							List Values
							Message Actions
								On SAM_Click
									If tblScoring.cTool.Init(hWndItem)
										Call tblScoring.cTool.Populate( hSql(), 'distinct tool', 'tool', 'fins_scoring', "" )
						Column: cScore
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cGenColComboBox_StrId
							Property Template:
							Class DLL Name:
							Title: Рез. скоринга
							Visible? Class Default
							Editable? Class Default
							Maximum Data Length: Class Default
							Data Type: Class Default
							Justify: Class Default
							Width:  1.367"
							Width Editable? Class Default
							Format: Unformatted
							Country: Class Default
							Input Mask: Class Default
							Cell Options
								Cell Type? Class Default
								Multiline Cell? Class Default
								Cell DropDownList
									Sorted? Class Default
									Vertical Scroll? Class Default
									Auto Drop Down? Class Default
									Allow Text Editing? Class Default
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Class Default
							List Values
							Message Actions
								On SAM_Click
									If tblScoring.cScore.Init(hWndItem)
										Call tblScoring.cScore.Populate( hSql(), 'score', 'score', 'fins_scoring', "WHERE tool='"||tblScoring.cTool.GetKey(SalListQuerySelection(tblScoring.cTool))||"'" )
								On SAM_AnyEdit
									Call SqlPrepareAndExecute(cMain.hSql(), "SELECT id, risk INTO :tblScoring.cSId, :tblScoring.cSRisk FROM fins_scoring WHERE tool='"||tblScoring.cTool.GetKey(SalListQuerySelection(tblScoring.cTool))||"' and
											score='"||tblScoring.cScore.GetKey(SalListQuerySelection(tblScoring.cScore))||"'")
									Call SqlFetchNext(cMain.hSql(),nFetchRes)
						Column: cSRisk
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Эквивалент SEB
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  1.533"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
					Functions
					Window Variables
					Message Actions
						On SAM_Create
							Call SalTblSetTableFlags(tblScoring, TBL_Flag_ShowVScroll, FALSE)
							Call SalTblDefineRowHeader(tblScoring, "", 15, 9, hWndNULL)
				Pushbutton: pbAddScoring
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.217"
						Top:    2.19"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nNewRow=SalTblInsertRow(tblScoring,TBL_MaxRow)
						On SAM_Create
							Set strTip = "Добавить результат скоринга"
				Pushbutton: pbDelScoring
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDelete
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.717"
						Top:    2.19"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nRow=SalTblQueryContext(tblScoring)
							Call SalTblSetRowFlags(tblScoring, nRow, ROW_MarkDeleted, TRUE)
						On SAM_Create
							Set strTip = "Удалить результат скоринга"
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.533"
						Top:    0.131"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Выход"
						On SAM_Click
							Call SalSendMsg( FINS_main, SAM_Close, 0, 0 )
				Data Field: User
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.133"
							Top:    0.321"
							Width:  2.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Create
							If pMode<2
								Call SqlPrepareAndExecute(cMain.hSql(), "SELECT fio INTO :User FROM staff where id=GetCurrentUserId")
								! Call SqlPrepareAndExecute(cMain.hSql(), "SELECT GetCurrentUserId INTO :User FROM dual")
								Call SqlFetchNext(cMain.hSql(), nFetchRes)
				Child Table: tblHistory
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.571"
							Width:  6.7"
							Width Editable? Yes
							Height: 0.714"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						View: Table
						Allow Row Sizing? No
						Lines Per Row: Default
					Memory Settings
						Maximum Rows in Memory: Default
						Discardable? Yes
					Contents
						Column: cSaveDate
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Дата сохранения
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  2.25"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cSaveRisk
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Класс риска
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: cSaveUser
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Автор
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  2.533"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
					Functions
					Window Variables
					Message Actions
				Multiline Field: mlComment
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 600
						String Type: String
						Editable? Yes
					Display Settings
						Border? Yes
						Word Wrap? Yes
						Vertical Scroll? Yes
						Window Location and Size
							Left:   7.183"
							Top:    0.571"
							Width:  6.1"
							Width Editable? Yes
							Height: 0.667"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
					Message Actions
					! Message Actions 
				Child Table: forRep
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left:   12.7"
							Top:    0.571"
							Width:  5.983"
							Width Editable? Yes
							Height: 0.833"
							Height Editable? Yes
						Visible? No
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						View: Table
						Allow Row Sizing? No
						Lines Per Row: Default
					Memory Settings
						Maximum Rows in Memory: Default
						Discardable? Yes
					Contents
						Column: R1
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title:
							Visible? Yes
							Editable? Yes
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: Risk
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title:
							Visible? Yes
							Editable? Yes
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  3.683"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: T1
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title:
							Visible? Yes
							Editable? Yes
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  3.683"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
					Functions
					Window Variables
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbPrint
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.283"
						Top:    0.131"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Распечатать отчет"
						On SAM_Click
							Call SalWaitCursor(TRUE)
							Set strtmp="begin fins.report('"||Okpo||"',"
							If pMode<2
								Set strtmp=strtmp||"0"
							Else
								Set strtmp=strtmp||"1"
							Set strtmp=strtmp||",to_date('"||cmbDate.GetName(SalListQuerySelection(cmbDate))||"','DD.MM.YYYY')); end;"
							Set str1=cmbSize.GetName(SalListQuerySelection(cmbSize))
							Set str2=cmbDate.GetName(SalListQuerySelection(cmbDate))
							Call SqlPrepareAndExecute(hSql(),strtmp)
							If pMode<2
								Set strtmp="(рабочий)"
							Else
								Set strtmp="(утвержденный)"
							Call SalTblPopulate(forRep, hSql(), "SELECT row_id,class,data INTO :R1, :Risk, :T1 FROM fins_temp ORDER BY row_id", TBL_FillAll)
							Call SalReportPrintToFile(hFINS,
									     GetTemplateDir() || "\\fins.qrp", GetPrnDir() || "\\f" || Okpo ||".rtf",
									     "forRep.R1,Nmk,str1,Okpo,forRep.Risk,forRep.T1,User,str2,strtmp", "R,N,K,O,C,T,AU,DATA,STATUS", 1, RPT_PrintAll, 1, 1, TRUE, nFetchRes)
							Call SalWaitCursor(FALSE)
							Call Debug("Отчет сформирован и помещен в файл "||GetPrnDir() || "\\f" || Okpo ||".rtf")
		Contents
			Column: cKod
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cQuestText
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вопрос
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cAnsText
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Варианты ответа
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.117"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Click
						If cAnsText.Init( hWndItem )
							Call cAnsText.Populate( hSql(), 'risk', 'text', 'fins_ansn', "where size_id="||NumberToStr(tek_size)||" and kod="||NumberToStr(cKod)||" ORDER BY risk" )
							Call cAnsText.Add(NUMBER_Null, "")
					On SAM_AnyEdit
						Call SalSendMsg( cAnsText, SAM_Click, 0, 0 )
						Set cRisk=cAnsText.GetKey(SalListQuerySelection(cAnsText))
						Set tek_risks[lParam+1] = cRisk
						Call CountRisks()
					On SAM_DoubleClick
						Call SalSendMsg( pbExplainAns, SAM_Click, 0, 0 )
			Column: cRisk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Класс (вручную)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cRiskAuto
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Класс (расчетный)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
				! List Values
				! Message Actions
			Column: cComm
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Комментарий
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  5.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: CountRisks
				Description: вычисление и вывод рассчетных рисков
				Returns
				Parameters
				Static Variables
				Local variables
					Number: sum
				Actions
					If tek_size=1
						! блок "бизнес-показатели для малых компаний"
						Call SalTblSetContext(FINS_main, 0)
						If tek_risks[2] != NUMBER_Null AND tek_risks[3] != NUMBER_Null AND tek_risks[4] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[2]+tek_risks[3]+tek_risks[4])/3)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[1] = cRiskAuto
						! блок "финансовые показатели для малых компаний"
						Call SalTblSetContext(FINS_main, 4)
						If tek_risks[6] != NUMBER_Null AND tek_risks[7] != NUMBER_Null AND tek_risks[8] != NUMBER_Null AND tek_risks[9] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[6]+tek_risks[7]+tek_risks[8]+tek_risks[9])/4)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[5] = cRiskAuto
						! и наконец собственно состояние
						Call SalTblSetContext(FINS_main, 9)
						If tek_risks[1] != NUMBER_Null AND tek_risks[5] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[1]+tek_risks[5])/2)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[10] = cRiskAuto
					Else
						! блок "категории для больших и средних"
						Call SalTblSetContext(FINS_main, 1)
						If tek_risks[3] != NUMBER_Null AND tek_risks[4] != NUMBER_Null AND tek_risks[5] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[5]+tek_risks[3]+tek_risks[4])/3)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[2] = cRiskAuto
						!
						Call SalTblSetContext(FINS_main, 5)
						If tek_risks[7] != NUMBER_Null AND tek_risks[8] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[7]+tek_risks[8])/2)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[6] = cRiskAuto
						!
						Call SalTblSetContext(FINS_main, 8)
						If tek_risks[10] != NUMBER_Null AND tek_risks[11] != NUMBER_Null AND tek_risks[12] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[10]+tek_risks[11]+tek_risks[12])/3)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[9] = cRiskAuto
						!
						Call SalTblSetContext(FINS_main, 13)
						If tek_risks[15] != NUMBER_Null AND tek_risks[16] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[15]+tek_risks[16])/2)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[14] = cRiskAuto
						!
						Call SalTblSetContext(FINS_main, 16)
						If tek_risks[18] != NUMBER_Null AND tek_risks[19] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[18]+tek_risks[19])/2)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[17] = cRiskAuto
						!
						Call SalTblSetContext(FINS_main, 19)
						If tek_risks[21] != NUMBER_Null AND tek_risks[22] != NUMBER_Null AND tek_risks[23] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[21]+tek_risks[22]+tek_risks[23])/3)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[20] = cRiskAuto
						! блок "финансовые и бизнес-показатели"
						Call SalTblSetContext(FINS_main, 0)
						If tek_risks[2] != NUMBER_Null AND tek_risks[6] != NUMBER_Null AND tek_risks[9] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[2]+tek_risks[6]+tek_risks[9])/3)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[1] = cRiskAuto
						!
						Call SalTblSetContext(FINS_main, 12)
						If tek_risks[14] != NUMBER_Null AND tek_risks[17] != NUMBER_Null AND tek_risks[20] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[14]+tek_risks[17]+tek_risks[20])/3)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[13] = cRiskAuto
						! и наконец собственно состояние
						Call SalTblSetContext(FINS_main, 23)
						If tek_risks[1] != NUMBER_Null AND tek_risks[13] != NUMBER_Null
							Set cRiskAuto=SalNumberRound((tek_risks[1]+tek_risks[13])/2)
						Else
							Set cRiskAuto=NUMBER_Null
						Set tek_risks[24] = cRiskAuto
					Call SalTblQueryFocus( FINS_main, nRow, tCol )
					Call SalTblSetContext( FINS_main, nRow)
		Window Parameters
			Number: pMode
			! 0 - полное редактирование, 1 - редактирование только рабочей информации, 2 - просмотр истории
		Window Variables
			Number: tek_size
			Number: nFetchRes
			Number: nRow
			Number: nNewRow
			: cMain
				Class: cABSConnect
			: cMain1
				Class: cABSConnect
			String: str1
			String: str2
			Number: tek_risks[1:*]
			Window Handle: tCol
			Long String: strtmp
			Number: kodz
		Message Actions
			On SAM_Create
				! сразу установить коннект
				Call XConnectGetParams( cMain )
				If NOT cMain.Connect()
					Call Debug('Невозможно установить коннект')
				Call XConnectGetParams( cMain1 )
				If NOT cMain1.Connect()
					Call Debug('Невозможно установить коннект')
				Call SalDisableWindow(User)
				If pMode<2
					Call SalDisableWindow(cmbDate)
					If pMode=1
						! кнопка официального сохранения недоступна
						Call SalDisableWindow(pbSaveOfficial)
				Else
					Call SalDisableWindow(pbSaveTemp)
					Call SalDisableWindow(pbSaveOfficial)
					Call SalDisableWindow(pbAddAnalog)
					Call SalDisableWindow(pbDelAnalog)
					Call SalDisableWindow(pbAddOutrate)
					Call SalDisableWindow(pbDelOutrate)
					Call SalDisableWindow(pbAddScoring)
					Call SalDisableWindow(pbDelScoring)
					Call SalDisableWindow(cmbSize)
					Call SalDisableWindow(Nmk)
					Set tCol = SalTblGetColumnWindow(FINS_main, 3, COL_GetID)
					Call SalTblSetColumnFlags(tCol, COL_Editable, FALSE)
					Set tCol = SalTblGetColumnWindow(FINS_main, 6, COL_GetID)
					Call SalTblSetColumnFlags(tCol, COL_Editable, FALSE)
					Set tCol = SalTblGetColumnWindow(tblAnalog, 2, COL_GetID)
					Call SalTblSetColumnFlags(tCol, COL_Editable, FALSE)
					Set tCol = SalTblGetColumnWindow(tblOutrate, 2, COL_GetID)
					Call SalTblSetColumnFlags(tCol, COL_Editable, FALSE)
					Set tCol = SalTblGetColumnWindow(tblOutrate, 3, COL_GetID)
					Call SalTblSetColumnFlags(tCol, COL_Editable, FALSE)
					Set tCol = SalTblGetColumnWindow(tblScoring, 2, COL_GetID)
					Call SalTblSetColumnFlags(tCol, COL_Editable, FALSE)
					Set tCol = SalTblGetColumnWindow(tblScoring, 3, COL_GetID)
					Call SalTblSetColumnFlags(tCol, COL_Editable, FALSE)
				Call SalTblSetTableFlags(FINS_main, TBL_Flag_ShowVScroll, FALSE)
				Call SalTblDefineRowHeader(FINS_main, "", 15, 9, hWndNULL)
				Call SqlPrepareAndExecute(cMain.hSql(),"select to_number(val) into :kodz from params where par='FINSKODZ'")
				Call SqlFetchNext(cMain.hSql(),nFetchRes)
			On UM_Populate
				If pMode<2
					Call SqlPrepareAndExecute(hSql(), "begin fins.create_views('"||Okpo||"', "||NumberToStr(tek_size)||"); end;")
				Else
					Call SqlPrepareAndExecute(hSql(), "begin fins.create_views('"||Okpo||"', "||NumberToStr(tek_size)||", 1, to_date('"|| cmbDate.GetName(SalListQuerySelection(cmbDate)) ||"','DD.MM.YYYY')); end;")
				Call SalWaitCursor(TRUE)
				Call SalTblPopulate(FINS_main, hSql(), T("select kod, quest, ans, risk, comm into :cKod, :cQuestText, :cAnsText, :cRisk, :cComm from fins_cust_qrac order by kod"), TBL_FillAll)
				Call SalTblPopulate(tblAnalog, hSql(), T("SELECT id, name, risk, profit, valmarg, ebitdam, clmarg, adequate, longact, shortact INTO :cAId, :cAName, :cARisk, :cProfit, :cValmarg, :cEbitdam, :cClmarg, :cAdequate, :cLongact, :cShortact FROM 
						fins_cust_an ORDER BY name"), TBL_FillAll)
				Call SalTblPopulate(tblOutrate, hSql(), T("SELECT id, agency, rate, risk INTO :cRId, :cAgency, :cRate, :cRRisk FROM fins_cust_out ORDER BY agency"), TBL_FillAll)
				Call SalTblPopulate(tblScoring, hSql(), T("SELECT id, tool, score, risk INTO :cSId, :cTool, :cScore, :cSRisk FROM fins_cust_sc ORDER BY tool"), TBL_FillAll)
				Call SalTblPopulate(tblHistory, hSql(), T("SELECT to_char(data1,'DD.MM.YYYY'), risk, fio INTO :cSaveDate, :cSaveRisk, :cSaveUser FROM fins_cust_hist ORDER BY data1"), TBL_FillAll)
				If pMode<2
					Set str1="SELECT bigcomm INTO :strtmp FROM fins_bigcomm_temp WHERE okpo='"||Okpo||"' and ddd in (select max(ddd) from fins_bigcomm_temp where okpo='"||Okpo||"' and ddd<=gl.bd)"
				Else
					Set str1="SELECT bigcomm INTO :strtmp FROM fins_bigcomm_hist WHERE okpo='"||Okpo||"' and ddd=to_date('"||cmbDate.GetName(SalListQuerySelection(cmbDate))||"','DD.MM.YYYY')"
				Call SqlPrepareAndExecute(cMain.hSql(),T(str1))
				Call SqlFetchNext(cMain.hSql(),nFetchRes)
				Set mlComment=strtmp
				Call SalWaitCursor(FALSE)
				Call CountRisks()
			On SAM_FetchRowDone
				Set tek_risks[lParam+1] = cRisk
			On SAM_ReportStart
				Set nRow = TBL_MinRow
			On SAM_ReportFetchInit
				Return TRUE
			On SAM_ReportFetchNext
				If SalTblFindNextRow(forRep, nRow, 0, 0)
					Call SalTblFetchRow(forRep, nRow)
					Return TRUE
				Return FALSE
			On SAM_ReportFinish
				Call SalWaitCursor(FALSE)
	Table Window: FINS_expl
		Class:
		Property Template:
		Class DLL Name:
		Title: Пояснения вариантов ответа
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  13.167"
				Width Editable? Yes
				Height: 6.393"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? Yes
			Lines Per Row: 4
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? Yes
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Column: cAns
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текст ответа
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cExpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Признаки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 1220
				Data Type: Long String
				Justify: Left
				Width:  9.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? Yes
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cOrd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Признаки
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  8.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? Yes
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: pSize
			Number: pKod
		Window Variables
			: cMain
				Class: cABSConnect
		Message Actions
			On SAM_Create
				! сразу установить коннект
				Call XConnectGetParams( cMain )
				If NOT cMain.Connect()
					Call Debug('Невозможно установить коннект')
				Call SalSendMsg( FINS_expl, UM_Populate, 0, 0 )
			On UM_Populate
				! Call SqlPrepareAndExecute(cMain.hSql(), "begin fins.create_views('"||Okpo||"', "||NumberToStr(tek_size)||"); end;")
				! Set strSqlPop = "select ans, expl into :cAns, :cExpl from fins_expl_ans order by ord"
				Call SalWaitCursor(TRUE)
				Call SalTblPopulate(FINS_expl, cMain.hSql(), T("select ord, ans, expl into :cOrd, :cAns, :cExpl from fins_expl_ans where size_id="||NumberToStr(pSize)||" and kod="||NumberToStr(pKod)||" order by ord"), TBL_FillAll)
				Call SalWaitCursor(FALSE)
	Table Window: TSG
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Блокированные документы 
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.55"
				Top:    0.688"
				Width:  15.783"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.226"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44824
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44825
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44826
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Pushbutton: pbAccept0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Просто Разблокировать выделенные строки '
						On SAM_Click
							If MessageQuestion('Разблокировать отмеченные документы ?') != IDYES
								Return FALSE
							If not UnlockSepDocs(0,0)
								Return FALSE
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Pushbutton: pbAccept1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Разблокировать выделенные строки с блокировкой лимита на сумму док.'
						On SAM_Click
							If MessageQuestion('Разблокировать отмеченные документы c 
									блокировкой счетов ?') != IDYES
								Return FALSE
							If not UnlockSepDocs(1,0)
								Return FALSE
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Pushbutton: pbAccept2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: C:\bars98\RESOURCE\BMP\QUERY.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Найти, Разблокировать, Перекредитовать ОДНУ выделенную строку '
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 ) and REC > 0 and S > 0
								Set nRef = 0
								If SalModalDialog
										( dlg_TSG, hWndForm, NLSB, KV, NMS,OKPO, S, NAZN, sTT, nVob, nRef ) 
										and nRef > 0
									! Call DebugN(nRef)
									If not UnlockSepDocs(0,REC)
										Return FALSE
									Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Multiline Field: mlDocDetail
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						String Type: String
						Editable? No
					Display Settings
						Border? Yes
						Word Wrap? Yes
						Vertical Scroll? Yes
						Window Location and Size
							Left:   2.083"
							Top:    0.071"
							Width:  12.5"
							Width Editable? Yes
							Height: 1.083"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: 3D Face Color
					Message Actions
		Contents
			Column: REC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFOA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО-A
				Visible? Yes
				Editable? No
				Maximum Data Length: 6
				Data Type: String
				Justify: Center
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAM_A
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Плательщик
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  1.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет-Б
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.56"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAM_B
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Получатель из док
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  2.067"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назначение платежа
				Visible? Yes
				Editable? No
				Maximum Data Length: 160
				Data Type: String
				Justify: Left
				Width:  3.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Получатель по счету
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  2.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
				Visible? Yes
				Editable? No
				Maximum Data Length: 38
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BIS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REC_A
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FN_A
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Имя
						файла
				Visible? No
				Editable? No
				Maximum Data Length: 12
				Data Type: String
				Justify: Left
				Width:  1.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT_A
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата файла
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.6"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: UnlockSepDocs
				Description: Разблокировать документы СЭП
				Returns
					Boolean:
				Parameters
					Number: nDop
					Number: nRec
				Static Variables
				Local variables
					String: strSql
					String: strRec
					Number: nRow
					Number: nTmp
				Actions
					Call WaitCursorOn()
					Set nRow = TBL_MinRow
					! главный цикл
					While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
						Call SalTblFetchRow(hWndForm, nRow)
						If nRec = 0 OR nRec = REC
							Set strRec = Str(REC)
							! Лочим запись ARC_RRP чтоб другие на схватили
							If SqlPrepareAndExecute(hSql(),
									  "SELECT rec INTO :nFetchRes FROM arc_rrp 
									   WHERE rec=:REC and blk=:nKod FOR UPDATE OF blk NOWAIT")
									and not SqlFetchNext(hSql(),nFetchRes)
								Call SqlRollback(hSql())
								Call MessageErrorEx('2909:Невозможно получить доступ к REC.'||strRec)
								Break
							!
							Set strSql = 'UPDATE Arc_rrp SET blk=0 WHERE fn_b IS NULL AND '
							If BIS
								Set nTmp = REC_A - BIS
								Set strSql = strSql || ' bis>0 AND
										(fn_a IS NOT NULL AND fn_a=:FN_A AND dat_a=:DAT_A AND rec_a-bis=:nTmp )'
							Else
								Set strSql = strSql || ' rec=:TSG.REC'
							If not SqlPrepareAndExecute(hSql(), strSql)
								Call SqlRollback(hSql())
								Break
							! ! Блокировка лимита
							If nDop = 1
								! Лочим запись ACCOUNTS чтоб другие на схватили
								If SqlPrepareAndExecute(hSql(),
										  "SELECT acc INTO :nFetchRes FROM accounts 
										   WHERE acc=:ACC FOR UPDATE OF lim NOWAIT")
										and not SqlFetchNext(hSql(),nFetchRes)
									Call SqlRollback(hSql())
									Call MessageErrorEx('2909:Невозможно получить доступ к ACC='||Str(ACC))
									Break
								Set nTmp = S*100
								If not SqlPrepareAndExecute(hSql(), "UPDATE accounts set lim=lim-:nTmp where acc=:ACC")
									Call SqlRollback(hSql())
									Break
							Else If nDop = 2
							!
							If not SqlCommitEx(hSql(), '2909:Разблокирование документа СЭП: ' || strRec||
									IifS(nDop = 1,' С блокировкой суммы документа на счете',''))
								Call SqlRollback(hSql())
								Break
							!
							Call SaveFInfoToLog('2909:Док # (' || strRec || ') - РАЗБЛОКИРОВАН')
					!
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
						If nRec = 0 OR nRec = REC
							Call SalTblDeleteRow(hWndForm, nRow, TBL_Adjust)
						Call SalTblFetchRow(hWndForm, nRow)
					Call WaitCursorOff()
					Return TRUE
		Window Parameters
			Number: nPar1
			Number: nKod
		Window Variables
			! Number: n980
			Number: nRef
			String: sTmp
			String: sTT
			Number: nVob
		Message Actions
			On SAM_Create
				!
				Set sTT='V07'
				Set nVob=133
				If SqlPrepareAndExecute( hSqlAux2(),
						"SELECT val into :sTmp from params where par='V07133' " )
						and SqlFetchNext( hSqlAux2(), nFetchRes )
					Set sTT = Subs(sTmp,1,3)
					Set nVob = Val(Subs(sTmp,4,3) )
				Set TSG.nTabInstance = 1
				! Set n980 = GetBaseVal()
				Set TSG.strFilterTblName = 'ARC_RRP'
				Set TSG.strSqlPopulate =
						"SELECT  /*+ INDEX (arc_rrp XPK_ARC_RRP) */
						   arc_rrp.fn_a,arc_rrp.dat_a,arc_rrp.bis, arc_rrp.kv, 
						   arc_rrp.REC, arc_rrp.MFOA, arc_rrp.S/100, arc_rrp.NLSB,
						   Substr(arc_rrp.NAM_A,1,38), Substr(arc_rrp.NAM_B,1,38),
						   Substr(arc_rrp.NAZN ,1,160)
						 INTO :TSG.FN_A,:TSG.DAT_A,:TSG.BIS,:TSG.KV,
						      :TSG.REC, :TSG.MFOA, :TSG.S, :TSG.NLSB,:TSG.NAM_A,:TSG.NAM_B,:TSG.NAZN
						 FROM arc_rrp, REC_que 
						 where arc_rrp.blk="||Str(nKod) || " and REC_que.rec=arc_rrp.rec  
						 order by arc_rrp.rec DESC"
				!
				Call SalTblSetLockedColumns( hWndForm,7 )
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If SqlPrepareAndExecute( hSqlAux2(),
						"SELECT a.acc,a.nms,c.okpo
						 INTO :ACC,:NMS, :OKPO 
						 FROM accounts a, cust_acc u, customer c 
						 WHERE a.kv=:KV AND a.nls=:NLSB and a.acc=u.acc and u.rnk=c.rnk " )
						and SqlFetchNext( hSqlAux2(), nFetchRes )
			On SAM_DoubleClick
				Call DocViewContents(hWndMDI, REC)
			On SAM_TblDoDetails
				Set mlDocDetail ='Отпрв.из док: ' || PadR(NAM_A,38) || 
						    PutCrLf() || 'Получ.из док: ' || PadR(NAM_B,38) || 
						    PutCrLf() || 'Получ.из АБС: ' || PadR(NMS,38)   || 
						    PutCrLf() || NAZN 
	Dialog Box: dlg_TSG
		Class:
		Property Template:
		Class DLL Name:
		Title: Поиск реального получателя и ПЕРЕкредитовка документа
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.488"
				Top:    2.073"
				Width:  11.283"
				Width Editable? Yes
				Height: 5.44"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: dNLSB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dNMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    0.071"
						Width:  4.5"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: dOKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.583"
						Top:    0.071"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						! If dAVA > nS
							                                                                                          Call SalMessageBox("Сумма аванса не может быть БОЛЬШЕ расчетной ! ",
									"Ошибка ! ", MB_IconStop)
							                                                                                          Set dAVA = nS
							                                                                                          Return VALIDATE_Cancel
			Data Field: dS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.483"
						Top:    0.071"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						! If dAVA > nS
							                                                                                          Call SalMessageBox("Сумма аванса не может быть БОЛЬШЕ расчетной ! ",
									"Ошибка ! ", MB_IconStop)
							                                                                                          Set dAVA = nS
							                                                                                          Return VALIDATE_Cancel
			Data Field: Perekred
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    0.571"
						Width:  2.5"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Multiline Field: dNAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.183"
						Top:    0.905"
						Width:  10.683"
						Width Editable? Yes
						Height: 0.583"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
			Pushbutton: pbOk	! Искать
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Искать 
				Window Location and Size
					Left:   7.383"
					Top:    1.571"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set dTxt = SalStrUpperX( SalStrTrimX( dTxt) )
						If SalStrLength( dTxt ) > 0
							Set dTxt = '%'|| VisStrSubstitute( dTxt, '*', '%' ) ||'%' 
							If SalTblPopulate(tbl,hSql(), 
									"SELECT a.daos,a.nls, a.nms, c.okpo 
									 into :tbl.DAOS,:tbl.NLSK,:tbl.NMSK,:tbl.OKPOK 
									 FROM accounts a, cust_acc u, customer c
									 WHERE a.tip='SG ' and a.dazs is null and a.acc=u.acc and u.rnk=c.rnk 
									   and a.kv=:KV and UPPER(a.NMS) like :dTxt ", TBL_FillAll )
			Pushbutton: pbClose	! Отменить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Отменить
				Window Location and Size
					Left:   8.683"
					Top:    1.571"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nRef = 0
						Call SalEndDialog( dlg_TSG, FALSE )
			Data Field: dTxt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.583"
						Top:    1.571"
						Width:  4.7"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    2.071"
						Width:  10.5"
						Width Editable? Yes
						Height: 2.917"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: NLSK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.133"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMSK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OKPOK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ОКПО
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: DAOS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата откр
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.467"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_DoubleClick
						If SalMessageBox(
								' Выполнять перекредитовку
								со счета ' || NLSB || '
								 ' || NMS  ||'
								на счет  ' || NLSK || '
								 ' || NMSK || '
								 ?' ,
								'Внимание ! ' ,
								 MB_IconQuestion | MB_YesNo) = IDYES
							Set nRef = NUMBER_Null
							Set nS = S *100
							Call cDoc.SetDoc( nRef, sTT, 1, nVob, Str(nRef), bDat, bDat, bDat, bDat,
									     NLSB, NMS , GetBankMfo(),'', KV, nS, OKPO,
									     NLSK, NMSK, GetBankMfo(),'', KV, nS, OKPOK ,
									     Subs(Perekred||dNAZN,1,160) ,'',GetIdOper(),'',NUMBER_Null, 0)
							If not cDoc.oDoc()
								Call SqlRollback( hSql() )
								Return FALSE
							Set nRef = cDoc.m_nRef
							Call SalEndDialog( dlg_TSG, TRUE )
		Functions
		Window Parameters
			String: NLSB
			Number: KV
			String: NMS
			String: OKPO
			Number: S
			String: NAZN
			String: sTT
			Number: nVob
			Receive Number: nRef
		Window Variables
			Date/Time: bDat
			Number: nS
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
				Set Perekred = 'Перекредитування: '
				Call SetWindowFont( hWndForm )
				Set dNLSB = NLSB
				Set dNMS = NMS
				Set dOKPO = OKPO
				Set dS = S
				Set dNAZN = NAZN
				Set bDat = GetBankDate()
				Call SalSetFocus( dTxt )
